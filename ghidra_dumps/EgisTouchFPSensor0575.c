#include "EgisTouchFPSensor0575.h"


undefined4 DAT_180018660;
undefined DAT_180018664;
undefined4 DAT_180018668;
ulonglong DAT_1800170a0;
int DAT_180018660;
int DAT_180018668;
undefined8 DAT_180017008;
undefined4 DAT_180017000;
undefined FUN_180003d7c;
longlong DAT_1800170a0;
uint DAT_180018c04;
undefined DAT_180002f20;
LPSTR DAT_18001aa30;
LPSTR DAT_180018678;
int DAT_180018670;
int DAT_180018c48;
int DAT_180017238;
undefined8 DAT_180018688;
PVOID DAT_180018688;
undefined4 DAT_18001721c;
undefined DAT_180017218;
undefined4 DAT_1800170b0;
undefined DAT_1800170b4;
undefined DAT_180017240;
undefined8 DAT_180018c70;
undefined *PTR_DAT_180017e70;
uint DAT_180017fd8;
undefined *PTR_DAT_180017b90;
undefined *PTR_LAB_180018010;
undefined *PTR_LAB_180018028;
undefined *PTR_LAB_180018020;
undefined *PTR_s_(null)_180017220;
undefined *PTR_u_(null)_180017228;
undefined DAT_180010270;
undefined DAT_180010290;
int DAT_180018c00;
undefined8 DAT_180018828;
undefined DAT_1800187c8;
undefined DAT_1800186a0;
undefined DAT_1800187b0;
undefined DAT_180018690;
undefined DAT_180018694;
undefined DAT_1800186a8;
undefined8 DAT_1800170a0;
undefined8 DAT_1800170a8;
undefined8 DAT_1800186b0;
pointer PTR_DAT_1800102f0;
undefined DAT_180018730;
undefined DAT_180017234;
undefined4 DAT_180017230;
undefined DAT_180010300;
undefined4 DAT_180017870;
undefined DAT_180017e80;
PVOID DAT_18001aa20;
undefined8 *DAT_180018c28;
undefined8 *DAT_180018c20;
LPVOID DAT_180018c18;
LPVOID DAT_180018c10;
LPVOID DAT_180019860;
LPVOID DAT_180019868;
undefined *DAT_18001aa10;
undefined DAT_18000f270;
undefined DAT_18000f278;
undefined DAT_18000f280;
undefined DAT_18000f2a8;
undefined FUN_180006778;
int DAT_180018c08;
undefined4 DAT_180018c48;
undefined1 DAT_180018c44;
PVOID DAT_18001aa18;
undefined DAT_18000f2b0;
undefined DAT_18000f2d0;
undefined DAT_18000f2d8;
undefined DAT_18000f2e0;
HANDLE DAT_180018c60;
undefined8 DAT_180018c60;
int DAT_18001aa08;
longlong DAT_1800198c0;
int DAT_18001aa28;
undefined1 DAT_180018f74;
byte *DAT_18001aa30;
undefined DAT_180018c30;
undefined8 *DAT_180018c10;
undefined DAT_180018c0c;
undefined DAT_180018e70;
ulonglong *DAT_180018678;
undefined DAT_18001aa2c;
ulonglong DAT_1800170a8;
ulonglong DAT_18001a900;
ulonglong DAT_18001a908;
ulonglong DAT_18001a910;
ulonglong DAT_18001a918;
ulonglong DAT_18001a920;
int DAT_180017298;
ulonglong DAT_18001a9e8;
undefined DAT_18001a928;
undefined DAT_18001a930;
undefined DAT_18001a938;
undefined DAT_18001a940;
undefined DAT_18001a948;
undefined DAT_18001a950;
undefined DAT_18001a958;
undefined DAT_18001a960;
undefined DAT_18001a968;
undefined DAT_18001a970;
undefined DAT_18001a978;
undefined DAT_18001a980;
undefined DAT_18001a988;
undefined DAT_18001a990;
undefined DAT_18001a998;
undefined DAT_18001a9a0;
undefined DAT_18001a9b0;
undefined DAT_18001a9a8;
undefined DAT_18001a9b8;
undefined DAT_18001a9c0;
undefined DAT_18001a9c8;
undefined DAT_18001a9d0;
undefined DAT_18001a9d8;
ulonglong DAT_18001a9e0;
undefined DAT_18001a9f0;
undefined DAT_18001a9f8;
undefined DAT_18001aa00;
uint DAT_180018f78;
undefined8 DAT_180015450;
undefined8 DAT_180015460;
undefined *DAT_18001a8e8;
undefined DAT_18001a8e0;
int DAT_1800198c8;
LPVOID DAT_1800198c0;
pointer PTR_DAT_1800172a0;
char DAT_180018c44;
uint DAT_18001aa08;
undefined DAT_180018f7c;
undefined DAT_180017ba4;
undefined *PTR_DAT_180017bb0;
pointer PTR_DAT_180018270;
undefined4 DAT_180018fa0;
undefined DAT_180017fd8;
undefined DAT_180018f80;
undefined DAT_180018f84;
undefined DAT_180018f98;
undefined DAT_180017660;
undefined1 DAT_180017770;
undefined DAT_180018f88;
int DAT_180018fa0;
undefined1 DAT_180017a98;
undefined4 DAT_180017aa0;
undefined DAT_180017ab0;
ulonglong DAT_180018fa8;
pointer PTR_LAB_180017fe0;
undefined8 DAT_180018030;
undefined4 DAT_180018038;
longlong DAT_180018c60;
LPCRITICAL_SECTION DAT_1800180d0;
undefined DAT_180018fb0;
int DAT_1800191e0;
undefined4 DAT_180010b40;
pointer PTR_u_R6002_-_floating_point_support_n_180010b48;
undefined DAT_18001942a;
undefined DAT_180011648;
undefined DAT_180011650;
undefined DAT_1800191ac;
undefined DAT_1800191f0;
undefined DAT_180019222;
IMAGE_DOS_HEADER IMAGE_DOS_HEADER_180000000;
undefined DAT_180019818;
undefined FUN_180008ee8;
PVOID DAT_180019820;
undefined8 DAT_180019820;
undefined DAT_180019828;
PVOID DAT_180019840;
undefined8 DAT_180019830;
undefined8 DAT_180019838;
undefined8 DAT_180019840;
undefined8 DAT_180019848;
undefined DAT_180019858;
int DAT_1800198b0;
HANDLE DAT_180018338;
void *StackLimit;
undefined *PTR_DAT_180018288;
undefined *PTR_DAT_180018290;
undefined *PTR_DAT_180018298;
undefined *PTR_DAT_1800182a0;
undefined *PTR_DAT_1800182a8;
undefined *PTR_DAT_1800182b0;
undefined *PTR_DAT_1800182b8;
undefined *PTR_DAT_1800182d8;
undefined *PTR_DAT_1800182e0;
undefined *PTR_DAT_1800182e8;
undefined *PTR_DAT_1800182f0;
undefined *PTR_DAT_1800182f8;
undefined *PTR_DAT_180018300;
undefined *PTR_DAT_180018270;
undefined *PTR_DAT_180018278;
undefined *PTR_DAT_180018280;
undefined *PTR_DAT_1800182c8;
undefined *PTR_DAT_1800182d0;
pointer PTR_DAT_180017e70;
int DAT_18001987c;
PVOID DAT_180019880;
PVOID DAT_180019888;
PVOID DAT_180019890;
PVOID DAT_1800198a0;
PVOID DAT_180019898;
byte DAT_180018330;
pointer PTR_DAT_180012e10;
undefined DAT_180012e18;
undefined DAT_180011fd0;
undefined FUN_18000d2a0;
undefined *PTR_LAB_180017fe8;
undefined FUN_18000d2e8;
undefined *PTR_LAB_180017fe0;
undefined *PTR_LAB_180017ff0;
undefined *PTR_LAB_180018008;
undefined *PTR_LAB_180017ff8;
undefined *PTR_LAB_180018000;
undefined *PTR_LAB_180018018;
undefined LAB_18000d1f8;
undefined LAB_18000d298;
undefined LAB_18000d2e0;
undefined LAB_18000d368;
undefined FUN_18000c744;
undefined FUN_18000c768;
undefined FUN_18000d200;
int DAT_180018364;
int DAT_180018368;
int DAT_180018360;
int DAT_18001835c;
int DAT_180018358;
int DAT_18001836c;
int DAT_18001837c;
int DAT_180018380;
int DAT_180018378;
int DAT_180018374;
int DAT_180018370;
int DAT_180018384;
undefined DAT_180018330;
byte DAT_1800198b8;
int DAT_180019878;
undefined *PTR_DAT_180017f88;
int DAT_180017230;

DWORD FUN_180001000(void)

{
  DWORD DVar1;
  LSTATUS LVar2;
  DWORD local_res8 [2];
  DWORD local_res10 [2];
  HKEY local_res18;
  
  DVar1 = RegOpenKeyA((HKEY)0xffffffff80000002,"SOFTWARE\\EgisSDKDBG",&local_res18);
  if (DVar1 == 0) {
    local_res8[0] = 4;
    LVar2 = RegQueryValueExA(local_res18,"EnableBlock",(LPDWORD)0x0,local_res10,&DAT_180018664,
                             local_res8);
    DVar1 = local_res8[0];
    if (LVar2 == 0) {
      DVar1 = 1;
    }
    local_res8[0] = 4;
    LVar2 = RegQueryValueExA(local_res18,"DisplayFlag ",(LPDWORD)0x0,local_res10,
                             (LPBYTE)&DAT_180018668,local_res8);
    if (LVar2 == 0) {
      DVar1 = 1;
    }
    RegCloseKey(local_res18);
    DAT_180018660 = 1;
  }
  return DVar1;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1800010e0(uint param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  DWORD DVar1;
  int iVar2;
  char *pcVar3;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined1 auStack_378 [32];
  uint local_358;
  uint local_350;
  uint local_348;
  uint local_340;
  DWORD local_338;
  DWORD local_330;
  longlong local_328;
  _SYSTEMTIME local_318;
  undefined1 local_308 [31];
  char cStack_2e9;
  undefined2 local_2e8;
  undefined1 auStack_2e6 [350];
  undefined1 local_188 [352];
  ulonglong local_28;
  
  local_28 = DAT_1800170a0 ^ (ulonglong)auStack_378;
  local_res18 = param_3;
  local_res20 = param_4;
  if (DAT_180018660 == 0) {
    FUN_180001000();
  }
  if (((_DAT_180018664 & param_1) != 0) && (param_2 != 0)) {
    GetLocalTime(&local_318);
    if (param_1 == 1) {
      pcVar3 = "EngineAdapter";
    }
    else {
      pcVar3 = "SensorAdapter";
      if (param_1 != 2) {
        pcVar3 = "WBF";
      }
    }
    FUN_180002b0c(local_308,0x1e,pcVar3);
    DVar1 = GetCurrentThreadId();
    local_338 = GetCurrentProcessId();
    local_340 = (uint)local_318.wMilliseconds;
    local_348 = (uint)local_318.wSecond;
    local_350 = (uint)local_318.wMinute;
    local_358 = (uint)local_318.wHour;
    local_330 = DVar1;
    local_328 = param_2;
    FUN_180002bdc(local_188,0x15e,0x18000f350,local_308);
    iVar2 = FUN_180002d58((undefined1 *)&local_2e8,0x15e,(longlong)local_188,&local_res18);
    if ((&cStack_2e9)[iVar2] != '\n') {
      *(undefined2 *)((longlong)&local_2e8 + (longlong)iVar2) = 0xa0d;
      auStack_2e6[iVar2] = 0;
    }
    if (0 < DAT_180018668) {
      OutputDebugStringA((LPCSTR)&local_2e8);
    }
    if (1 < DAT_180018668) {
      FUN_180001290(param_1,(LPCSTR)&local_2e8);
    }
  }
  FUN_180002e10(local_28 ^ (ulonglong)auStack_378);
  return;
}



void FUN_180001290(int param_1,LPCSTR param_2)

{
  DWORD nNumberOfBytesToWrite;
  BOOL BVar1;
  HANDLE hFile;
  char *pcVar2;
  undefined1 auStackY_198 [32];
  DWORD local_158 [2];
  undefined1 local_150 [40];
  CHAR local_128 [272];
  ulonglong local_18;
  
  if (param_2 != (LPCSTR)0x0) {
    local_18 = DAT_1800170a0 ^ (ulonglong)auStackY_198;
    if (param_1 == 1) {
      pcVar2 = "EngineAdapter";
    }
    else {
      pcVar2 = "SensorAdapter";
      if (param_1 != 2) {
        pcVar2 = "WBF";
      }
    }
    FUN_180002b0c(local_150,0x1e,pcVar2);
    FUN_180002bdc(local_128,0x104,0x18000f3c8,"C:\\Temp2\\WBF");
    hFile = CreateFileA(local_128,0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,4,0x80,(HANDLE)0x0);
    if (hFile != (HANDLE)0xffffffffffffffff) {
      SetFilePointer(hFile,0,(PLONG)0x0,2);
      nNumberOfBytesToWrite = lstrlenA(param_2);
      BVar1 = WriteFile(hFile,param_2,nNumberOfBytesToWrite,local_158,(LPOVERLAPPED)0x0);
      if (BVar1 == 0) {
        OutputDebugStringA("=SDK-DBG= Write File fail\r\n");
      }
      CloseHandle(hFile);
    }
    FUN_180002e10(local_18 ^ (ulonglong)auStackY_198);
  }
  return;
}



uint FUN_1800013d0(undefined8 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  BOOL BVar1;
  DWORD DVar2;
  uint uVar3;
  
  FUN_1800010e0(2,0x180010058,param_3,param_4);
  if (param_1 == (undefined8 *)0x0) {
    uVar3 = 0x80004003;
  }
  else if ((HANDLE)*param_1 == (HANDLE)0xffffffffffffffff) {
    uVar3 = 0x8009800f;
  }
  else {
    BVar1 = CancelIoEx((HANDLE)*param_1,(LPOVERLAPPED)0x0);
    uVar3 = 0;
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      uVar3 = 0;
      if ((DVar2 != 0x490) && ((DVar2 == 0x4c7 || (uVar3 = 0x80098036, DVar2 == 0x3e3)))) {
        uVar3 = 0x80098004;
      }
    }
  }
  FUN_1800010e0(2,0x180010070,(ulonglong)uVar3,param_4);
  return uVar3;
}



uint FUN_180001460(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  DWORD DVar1;
  HANDLE pvVar2;
  undefined8 *lpMem;
  
  FUN_1800010e0(2,0x18000f3f8,param_3,param_4);
  DVar1 = 0;
  if (param_1 == 0) {
    DVar1 = 0x80004003;
  }
  else if (*(longlong *)(param_1 + 0x30) == 0) {
    pvVar2 = GetProcessHeap();
    lpMem = (undefined8 *)HeapAlloc(pvVar2,8,0x60);
    if (lpMem == (undefined8 *)0x0) {
      DVar1 = 0x8007000e;
    }
    else {
      param_4 = 0;
      lpMem[5] = 0;
      lpMem[6] = 0;
      lpMem[7] = 0;
      lpMem[8] = 0;
      pvVar2 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
      *lpMem = pvVar2;
      if (pvVar2 == (HANDLE)0x0) {
        DVar1 = GetLastError();
        if (0 < (int)DVar1) {
          DVar1 = DVar1 & 0xffff | 0x80070000;
        }
        if ((int)DVar1 < 0) {
          pvVar2 = GetProcessHeap();
          HeapFree(pvVar2,0,lpMem);
        }
      }
      else {
        lpMem[4] = pvVar2;
        *(undefined8 **)(param_1 + 0x30) = lpMem;
      }
    }
  }
  else {
    DVar1 = 0x8009800f;
  }
  FUN_1800010e0(2,0x18000f410,(ulonglong)DVar1,param_4);
  return DVar1;
}



uint FUN_180001560(undefined8 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 *lpMem;
  LPVOID pvVar1;
  HANDLE pvVar2;
  longlong lVar3;
  char *pcVar4;
  uint uVar5;
  undefined1 *puVar6;
  
  pcVar4 = ">>> SensorAdapterDetach";
  FUN_1800010e0(2,0x18000f440,param_3,param_4);
  uVar5 = 0;
  if (param_1 == (undefined8 *)0x0) {
    uVar5 = 0x80004003;
  }
  else if (param_1[6] == 0) {
    uVar5 = 0x8009800f;
  }
  else {
    FUN_1800013d0(param_1,pcVar4,param_3,param_4);
    lpMem = (undefined8 *)param_1[6];
    param_1[6] = 0;
    if ((undefined1 *)lpMem[5] != (undefined1 *)0x0) {
      puVar6 = (undefined1 *)lpMem[5];
      for (lVar3 = lpMem[6]; lVar3 != 0; lVar3 = lVar3 + -1) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
      pvVar1 = (LPVOID)lpMem[5];
      if (pvVar1 != (LPVOID)0x0) {
        pvVar2 = GetProcessHeap();
        HeapFree(pvVar2,0,pvVar1);
      }
      lpMem[5] = 0;
      lpMem[6] = 0;
    }
    if ((undefined1 *)lpMem[7] != (undefined1 *)0x0) {
      puVar6 = (undefined1 *)lpMem[7];
      for (lVar3 = lpMem[8]; lVar3 != 0; lVar3 = lVar3 + -1) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
      pvVar1 = (LPVOID)lpMem[7];
      pvVar2 = GetProcessHeap();
      HeapFree(pvVar2,0,pvVar1);
      lpMem[7] = 0;
      lpMem[8] = 0;
    }
    if ((HANDLE)*lpMem != (HANDLE)0x0) {
      CloseHandle((HANDLE)*lpMem);
      *lpMem = 0;
    }
    pvVar2 = GetProcessHeap();
    HeapFree(pvVar2,0,lpMem);
  }
  FUN_1800010e0(2,0x18000f458,(ulonglong)uVar5,param_4);
  return uVar5;
}



uint FUN_180001670(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong lVar1;
  longlong lVar2;
  uint uVar3;
  undefined1 *puVar4;
  
  FUN_1800010e0(2,0x18000f488,param_3,param_4);
  if (param_1 == 0) {
    uVar3 = 0x80004003;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x30);
    if (lVar1 == 0) {
      uVar3 = 0x8009800f;
    }
    else {
      *(undefined4 *)(lVar1 + 0x48) = 0;
      if (*(undefined1 **)(lVar1 + 0x28) != (undefined1 *)0x0) {
        puVar4 = *(undefined1 **)(lVar1 + 0x28);
        for (lVar2 = *(longlong *)(lVar1 + 0x30); lVar2 != 0; lVar2 = lVar2 + -1) {
          *puVar4 = 0;
          puVar4 = puVar4 + 1;
        }
      }
      uVar3 = 0;
      if (*(undefined1 **)(lVar1 + 0x38) != (undefined1 *)0x0) {
        puVar4 = *(undefined1 **)(lVar1 + 0x38);
        for (lVar2 = *(longlong *)(lVar1 + 0x40); uVar3 = 0, lVar2 != 0; lVar2 = lVar2 + -1) {
          *puVar4 = 0;
          puVar4 = puVar4 + 1;
        }
      }
    }
  }
  FUN_1800010e0(2,0x18000f4a8,(ulonglong)uVar3,param_4);
  return uVar3;
}



void FUN_180001700(longlong *param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4)

{
  DWORD DVar1;
  BOOL BVar2;
  DWORD DVar3;
  uint uVar4;
  undefined1 auStackY_98 [32];
  DWORD local_58 [2];
  _OVERLAPPED local_50;
  undefined8 local_30;
  ulonglong local_28;
  undefined4 local_20;
  ulonglong local_18;
  
  local_18 = DAT_1800170a0 ^ (ulonglong)auStackY_98;
  FUN_1800010e0(2,0x18000f4e0,param_3,param_4);
  DVar1 = 0;
  local_58[0] = 0;
  local_30 = 0;
  local_28 = 0;
  local_20 = 0;
  local_50.Internal = 0;
  local_50.InternalHigh = 0;
  local_50.u.Pointer = (PVOID)0x0;
  local_50.hEvent = (HANDLE)0x0;
  if ((param_1 == (longlong *)0x0) || (param_2 == (undefined4 *)0x0)) {
    DVar1 = 0x80004003;
    goto LAB_1800018be;
  }
  if ((param_1[6] == 0) || (*param_1 == -1)) {
    DVar1 = 0x8009800f;
    goto LAB_1800018be;
  }
  param_4 = 0;
  local_50.hEvent = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
  if (local_50.hEvent == (HANDLE)0x0) {
LAB_1800017a6:
    DVar1 = GetLastError();
    if ((int)DVar1 < 1) {
      DVar1 = GetLastError();
    }
    else {
      DVar1 = GetLastError();
      DVar1 = DVar1 & 0xffff | 0x80070000;
    }
    goto LAB_1800018be;
  }
  param_4 = 0;
  BVar2 = DeviceIoControl((HANDLE)*param_1,0x440010,(LPVOID)0x0,0,&local_30,0x14,local_58,&local_50)
  ;
  if (BVar2 == 0) {
    DVar3 = GetLastError();
    if (DVar3 == 0x3e5) {
      SetLastError(0);
      param_4 = 1;
      uVar4 = GetOverlappedResult((HANDLE)*param_1,&local_50,local_58,1);
      if ((uVar4 == 0) || (local_58[0] != 0x14)) goto LAB_1800017a6;
      param_4 = 0x14;
      FUN_1800010e0(2,0x18000f500,(ulonglong)uVar4,0x14);
      goto LAB_18000185d;
    }
  }
  else {
LAB_18000185d:
    if (0x13 < local_58[0]) {
      *param_2 = (undefined4)local_28;
      FUN_1800010e0(2,0x18000f578,local_28 & 0xffffffff,param_4);
      goto LAB_1800018be;
    }
  }
  DVar1 = GetLastError();
  if ((DVar1 == 0x4c7) || (DVar1 == 0x3e3)) {
    DVar1 = 0x80098004;
  }
  else {
    DVar1 = 0x80098036;
  }
LAB_1800018be:
  if (local_50.hEvent != (HANDLE)0x0) {
    CloseHandle(local_50.hEvent);
  }
  FUN_1800010e0(2,0x18000f5a8,(ulonglong)DVar1,param_4);
  FUN_180002e10(local_18 ^ (ulonglong)auStackY_98);
  return;
}



uint FUN_180001910(longlong *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  DWORD DVar1;
  uint uVar2;
  BOOL BVar3;
  DWORD local_res8 [2];
  undefined8 local_res10;
  _OVERLAPPED local_28;
  
  FUN_1800010e0(2,0x18000f5e0,param_3,param_4);
  local_res10 = 0;
  local_res8[0] = 0;
  local_28.Internal = 0;
  local_28.InternalHigh = 0;
  local_28.u.Pointer = (PVOID)0x0;
  local_28.hEvent = (HANDLE)0x0;
  if (param_1 == (longlong *)0x0) {
    uVar2 = 0x80004003;
    goto LAB_180001a9a;
  }
  if ((param_1[6] == 0) || (*param_1 == -1)) {
    uVar2 = 0x8009800f;
    goto LAB_180001a9a;
  }
  param_4 = 0;
  local_28.hEvent = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
  if (local_28.hEvent == (HANDLE)0x0) {
LAB_180001988:
    DVar1 = GetLastError();
    if ((int)DVar1 < 1) {
      uVar2 = GetLastError();
    }
    else {
      DVar1 = GetLastError();
      uVar2 = DVar1 & 0xffff | 0x80070000;
    }
    goto LAB_180001a9a;
  }
  param_4 = 0;
  BVar3 = DeviceIoControl((HANDLE)*param_1,0x440008,(LPVOID)0x0,0,&local_res10,8,local_res8,
                          &local_28);
  if (BVar3 == 0) {
    DVar1 = GetLastError();
    if (DVar1 == 0x3e5) {
      SetLastError(0);
      param_4 = 1;
      uVar2 = GetOverlappedResult((HANDLE)*param_1,&local_28,local_res8,1);
      if ((uVar2 == 0) || (local_res8[0] != 8)) goto LAB_180001988;
      param_4 = 8;
      FUN_1800010e0(2,0x18000f600,(ulonglong)uVar2,8);
      goto LAB_180001a3b;
    }
  }
  else {
LAB_180001a3b:
    if (7 < local_res8[0]) {
      uVar2 = local_res10._4_4_;
      goto LAB_180001a9a;
    }
  }
  DVar1 = GetLastError();
  FUN_1800010e0(2,0x18000f670,(ulonglong)DVar1,param_4);
  DVar1 = GetLastError();
  if ((DVar1 == 0x4c7) || (DVar1 == 0x3e3)) {
    uVar2 = 0x80098004;
  }
  else {
    uVar2 = 0x80098036;
  }
LAB_180001a9a:
  if (local_28.hEvent != (HANDLE)0x0) {
    CloseHandle(local_28.hEvent);
  }
  FUN_1800010e0(2,0x18000f6b8,(ulonglong)uVar2,param_4);
  return uVar2;
}



uint FUN_180001ad0(longlong *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  
  FUN_1800010e0(2,0x18000f6e8,param_3,param_4);
  uVar1 = 0;
  if (param_1 == (longlong *)0x0) {
    uVar1 = 0x80004003;
  }
  else if ((param_1[6] == 0) || (*param_1 == -1)) {
    uVar1 = 0x8009800f;
  }
  FUN_1800010e0(2,0x18000f708,(ulonglong)uVar1,param_4);
  return uVar1;
}



uint FUN_180001b30(longlong *param_1,int param_2,undefined8 param_3,undefined8 param_4)

{
  DWORD DVar1;
  BOOL BVar2;
  uint uVar3;
  DWORD local_res8 [2];
  undefined8 local_res18;
  undefined8 local_res20;
  _OVERLAPPED local_28;
  
  FUN_1800010e0(2,0x18000f738,param_3,param_4);
  local_res8[0] = 0;
  local_28.Internal = 0;
  local_28.InternalHigh = 0;
  local_28.u.Pointer = (PVOID)0x0;
  local_28.hEvent = (HANDLE)0x0;
  local_res18 = 0;
  local_res20 = 0;
  if ((param_1 == (longlong *)0x0) || (param_2 == 0)) {
    DVar1 = 0x80004003;
    goto LAB_180001cdd;
  }
  if ((param_1[6] == 0) || (*param_1 == -1)) {
    DVar1 = 0x8009800f;
    goto LAB_180001cdd;
  }
  param_4 = 0;
  local_res18 = CONCAT44(param_2,8);
  local_28.hEvent = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
  if (local_28.hEvent == (HANDLE)0x0) {
LAB_180001bd0:
    DVar1 = GetLastError();
    if ((int)DVar1 < 1) {
      DVar1 = GetLastError();
    }
    else {
      DVar1 = GetLastError();
      DVar1 = DVar1 & 0xffff | 0x80070000;
    }
    goto LAB_180001cdd;
  }
  param_4 = 8;
  BVar2 = DeviceIoControl((HANDLE)*param_1,0x440024,&local_res18,8,&local_res20,8,local_res8,
                          &local_28);
  if (BVar2 == 0) {
    DVar1 = GetLastError();
    if (DVar1 == 0x3e5) {
      SetLastError(0);
      param_4 = 1;
      uVar3 = GetOverlappedResult((HANDLE)*param_1,&local_28,local_res8,1);
      if ((uVar3 == 0) || (local_res8[0] != 8)) goto LAB_180001bd0;
      param_4 = 8;
      FUN_1800010e0(2,0x18000f760,(ulonglong)uVar3,8);
      goto LAB_180001c8e;
    }
  }
  else {
LAB_180001c8e:
    if (7 < local_res8[0]) {
      DVar1 = local_res20._4_4_;
      goto LAB_180001cdd;
    }
  }
  DVar1 = GetLastError();
  if ((DVar1 == 0x4c7) || (DVar1 == 0x3e3)) {
    DVar1 = 0x80098004;
  }
  else {
    DVar1 = 0x80098036;
  }
LAB_180001cdd:
  if (local_28.hEvent != (HANDLE)0x0) {
    CloseHandle(local_28.hEvent);
  }
  FUN_1800010e0(2,0x18000f7d8,(ulonglong)DVar1,param_4);
  return DVar1;
}



void FUN_180001d10(longlong *param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4)

{
  DWORD DVar1;
  BOOL BVar2;
  uint uVar3;
  undefined1 auStackY_88 [32];
  DWORD local_48 [2];
  _OVERLAPPED local_40;
  undefined8 local_20;
  undefined4 local_18;
  ulonglong local_10;
  
  local_10 = DAT_1800170a0 ^ (ulonglong)auStackY_88;
  FUN_1800010e0(2,0x18000f818,param_3,param_4);
  local_48[0] = 0;
  local_40.Internal = 0;
  local_40.InternalHigh = 0;
  local_40.u.Pointer = (PVOID)0x0;
  local_40.hEvent = (HANDLE)0x0;
  local_20 = 0;
  local_18 = 0;
  if ((param_1 == (longlong *)0x0) || (param_2 == (undefined4 *)0x0)) {
    DVar1 = 0x80004003;
    goto LAB_180001eba;
  }
  if ((param_1[6] == 0) || (*param_1 == -1)) {
    DVar1 = 0x8009800f;
    goto LAB_180001eba;
  }
  param_4 = 0;
  *param_2 = 2;
  local_40.hEvent = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
  if (local_40.hEvent == (HANDLE)0x0) {
LAB_180001db1:
    DVar1 = GetLastError();
    if ((int)DVar1 < 1) {
      DVar1 = GetLastError();
    }
    else {
      DVar1 = GetLastError();
      DVar1 = DVar1 & 0xffff | 0x80070000;
    }
    goto LAB_180001eba;
  }
  param_4 = 0;
  BVar2 = DeviceIoControl((HANDLE)*param_1,0x440020,(LPVOID)0x0,0,&local_20,0xc,local_48,&local_40);
  if (BVar2 == 0) {
    DVar1 = GetLastError();
    if (DVar1 == 0x3e5) {
      SetLastError(0);
      param_4 = 1;
      uVar3 = GetOverlappedResult((HANDLE)*param_1,&local_40,local_48,1);
      if ((uVar3 == 0) || (local_48[0] != 0xc)) goto LAB_180001db1;
      param_4 = 0xc;
      FUN_1800010e0(2,0x18000f840,(ulonglong)uVar3,0xc);
      goto LAB_180001e64;
    }
  }
  else {
LAB_180001e64:
    if (0xb < local_48[0]) {
      DVar1 = local_20._4_4_;
      if (-1 < local_20) {
        *param_2 = local_18;
      }
      goto LAB_180001eba;
    }
  }
  DVar1 = GetLastError();
  if ((DVar1 == 0x4c7) || (DVar1 == 0x3e3)) {
    DVar1 = 0x80098004;
  }
  else {
    DVar1 = 0x80098036;
  }
LAB_180001eba:
  if (local_40.hEvent != (HANDLE)0x0) {
    CloseHandle(local_40.hEvent);
  }
  FUN_1800010e0(2,0x18000f8b8,(ulonglong)DVar1,param_4);
  FUN_180002e10(local_10 ^ (ulonglong)auStackY_88);
  return;
}



void FUN_180001f00(longlong *param_1,char param_2,undefined8 *param_3,ulonglong param_4)

{
  LPOVERLAPPED p_Var1;
  undefined8 *puVar2;
  uint *lpMem;
  uint uVar3;
  DWORD DVar4;
  BOOL BVar5;
  HANDLE pvVar6;
  LPVOID pvVar7;
  longlong lVar8;
  uint uVar9;
  char *pcVar11;
  undefined8 *puVar12;
  ulonglong uVar13;
  undefined1 auStackY_d8 [32];
  DWORD local_98;
  uint local_94;
  _OVERLAPPED local_90;
  undefined8 local_70;
  undefined8 local_68;
  undefined8 uStack_60;
  undefined8 uStack_58;
  undefined8 local_50;
  undefined8 local_48;
  ulonglong local_40;
  ulonglong uVar10;
  
  local_40 = DAT_1800170a0 ^ (ulonglong)auStackY_d8;
  puVar12 = param_3;
  FUN_1800010e0(2,0x18000f8f8,param_3,param_4);
  uVar10 = 0;
  local_94 = 6;
  local_70 = 0;
  local_68 = 0;
  uStack_60 = 0;
  uStack_58 = 0;
  local_98 = 0;
  local_90.Internal = 0;
  local_90.InternalHigh = 0;
  local_90.u.Pointer = (PVOID)0x0;
  local_90.hEvent = (HANDLE)0x0;
  if (((param_1 == (longlong *)0x0) || (param_2 == '\0')) || (param_3 == (undefined8 *)0x0)) {
    uVar3 = 0x80004003;
    goto LAB_180002538;
  }
  puVar2 = (undefined8 *)param_1[6];
  if ((puVar2 == (undefined8 *)0x0) || (*param_1 == -1)) {
LAB_180002123:
    uVar3 = 0x8009800f;
    goto LAB_180002538;
  }
  *param_3 = 0;
  uVar3 = FUN_180001700(param_1,&local_94,puVar12,param_4);
  uVar9 = local_94;
  if ((int)uVar3 < 0) goto LAB_180002538;
  uVar13 = (ulonglong)local_94;
  FUN_1800010e0(2,0x18000f920,uVar13,param_4);
  if (uVar9 == 5) {
    local_50 = 0;
    local_48 = 0;
    FUN_1800010e0(2,0x18000f970,5,param_4);
    param_4 = 0;
    local_90.hEvent = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
    if (local_90.hEvent != (HANDLE)0x0) {
      param_4 = 0;
      uVar13 = 0;
      BVar5 = DeviceIoControl((HANDLE)*param_1,0x44000c,(LPVOID)0x0,0,&local_50,0x10,&local_98,
                              &local_90);
      if (BVar5 == 0) {
        DVar4 = GetLastError();
        if (DVar4 == 0x3e5) {
          SetLastError(0);
          param_4 = 1;
          uVar3 = GetOverlappedResult((HANDLE)*param_1,&local_90,&local_98,1);
          if ((uVar3 == 0) || (local_98 != 0x10)) goto LAB_180002021;
          param_4 = 0x10;
          uVar13 = (ulonglong)uVar3;
          FUN_1800010e0(2,0x18000f9b0,uVar13,0x10);
        }
      }
      uVar3 = FUN_180001700(param_1,&local_94,uVar13,param_4);
      uVar9 = local_94;
      uVar13 = (ulonglong)local_94;
      FUN_1800010e0(2,0x18000fa20,uVar13,param_4);
      if ((int)uVar3 < 0) goto LAB_180002538;
      goto LAB_1800020fb;
    }
LAB_180002021:
    DVar4 = GetLastError();
    if ((int)DVar4 < 1) {
      uVar3 = GetLastError();
      goto LAB_180002538;
    }
  }
  else {
LAB_1800020fb:
    if (uVar9 == 4) {
      uVar3 = 0x80098010;
      goto LAB_180002538;
    }
    if (uVar9 != 3) {
      FUN_1800010e0(2,0x18000fa70,(ulonglong)uVar9,param_4);
      goto LAB_180002123;
    }
    if ((*(short *)((longlong)puVar2 + 0x4c) != 0) || (*(short *)((longlong)puVar2 + 0x4e) != 0)) {
LAB_1800022df:
      local_70._0_5_ = CONCAT14(param_2,0x20);
      local_70 = CONCAT26(*(undefined2 *)((longlong)puVar2 + 0x4c),(undefined6)local_70);
      local_68 = CONCAT62(local_68._2_6_,*(undefined2 *)((longlong)puVar2 + 0x4e));
      uStack_60 = *(undefined8 *)((longlong)puVar2 + 0x54);
      uStack_58 = CONCAT35(uStack_58._5_3_,0x2000000000);
      local_68 = CONCAT44(*(undefined4 *)(puVar2 + 10),(undefined4)local_68);
      uStack_58 = CONCAT44(uStack_58._4_4_,*(undefined4 *)((longlong)puVar2 + 0x5c));
      if (puVar2[5] == 0) {
        pvVar6 = GetProcessHeap();
        pvVar7 = HeapAlloc(pvVar6,8,0x18);
        puVar2[5] = pvVar7;
        if (pvVar7 == (LPVOID)0x0) {
          puVar2[6] = 0;
          uVar3 = 0x8007000e;
          goto LAB_180002538;
        }
        puVar2[6] = 0x18;
        p_Var1 = (LPOVERLAPPED)(puVar2 + 1);
        p_Var1->Internal = 0;
        puVar2[2] = 0;
        puVar2[3] = 0;
        puVar2[4] = 0;
        ResetEvent((HANDLE)*puVar2);
        puVar2[4] = *puVar2;
        param_4 = 0x20;
        BVar5 = DeviceIoControl((HANDLE)*param_1,0x440014,&local_70,0x20,(LPVOID)puVar2[5],
                                *(DWORD *)(puVar2 + 6),&local_98,p_Var1);
        if (BVar5 == 0) {
          DVar4 = GetLastError();
          if (DVar4 == 0x3e5) {
            SetLastError(0);
            param_4 = 1;
            uVar3 = GetOverlappedResult((HANDLE)*param_1,p_Var1,&local_98,1);
            if ((uVar3 == 0) || (local_98 != 4)) goto LAB_180002021;
            param_4 = 4;
            FUN_1800010e0(2,0x18000fb50,(ulonglong)uVar3,4);
          }
        }
        lpMem = (uint *)puVar2[5];
        if (((ulonglong)puVar2[6] < (ulonglong)*lpMem) &&
           (puVar2[6] = (ulonglong)*lpMem, lpMem != (uint *)0x0)) {
          pvVar6 = GetProcessHeap();
          HeapFree(pvVar6,0,lpMem);
          puVar2[5] = 0;
        }
        lVar8 = FUN_180002a70(puVar2[6]);
        puVar2[5] = lVar8;
        if (lVar8 == 0) {
          puVar2[6] = 0;
          uVar3 = 0x8007000e;
          goto LAB_180002538;
        }
      }
      else {
        pcVar11 = "SensorAdapterStartCapture : Call SensorAdapterClearContext";
        FUN_1800010e0(2,0x18000fbc8,uVar13,param_4);
        FUN_180001670((longlong)param_1,pcVar11,uVar13,param_4);
      }
      p_Var1 = (LPOVERLAPPED)(puVar2 + 1);
      p_Var1->Internal = 0;
      puVar2[2] = 0;
      puVar2[3] = 0;
      puVar2[4] = 0;
      ResetEvent((HANDLE)*puVar2);
      puVar2[4] = *puVar2;
      SetLastError(0);
      param_4 = 0x20;
      uVar3 = DeviceIoControl((HANDLE)*param_1,0x440014,&local_70,0x20,(LPVOID)puVar2[5],
                              *(DWORD *)(puVar2 + 6),&local_98,p_Var1);
      if (uVar3 == 0) {
        DVar4 = GetLastError();
        if (DVar4 != 0x3e5) {
          DVar4 = GetLastError();
          if ((DVar4 == 0x4c7) || (DVar4 == 0x3e3)) {
            uVar3 = 0x80098004;
          }
          else {
            uVar3 = 0x80098036;
          }
          goto LAB_180002538;
        }
      }
      DVar4 = GetLastError();
      param_4 = (ulonglong)uVar3;
      FUN_1800010e0(2,0x18000fc10,(ulonglong)DVar4,param_4);
      *param_3 = p_Var1;
      uVar3 = 0;
      goto LAB_180002538;
    }
    uVar3 = (**(code **)(param_1[4] + 0x38))(param_1,(longlong)puVar2 + 0x4c,puVar2 + 10);
    if ((int)uVar3 < 0) goto LAB_180002538;
    if (puVar2[7] == 0) {
      pvVar6 = GetProcessHeap();
      pvVar7 = HeapAlloc(pvVar6,8,0x62c);
      puVar2[7] = pvVar7;
      if (pvVar7 != (LPVOID)0x0) {
        puVar2[8] = 0x62c;
        goto LAB_1800021ab;
      }
      DVar4 = GetLastError();
      if ((int)DVar4 < 1) {
        uVar3 = GetLastError();
        goto LAB_180002538;
      }
    }
    else {
LAB_1800021ab:
      if (local_90.hEvent != (HANDLE)0x0) {
        CloseHandle(local_90.hEvent);
      }
      param_4 = 0;
      local_90.Internal = 0;
      local_90.InternalHigh = 0;
      local_90.u.Pointer = (PVOID)0x0;
      local_90.hEvent = (HANDLE)0x0;
      local_90.hEvent = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
      if (local_90.hEvent != (HANDLE)0x0) {
        BVar5 = DeviceIoControl((HANDLE)*param_1,0x440004,(LPVOID)0x0,0,(LPVOID)puVar2[7],
                                *(DWORD *)(puVar2 + 8),&local_98,&local_90);
        if (BVar5 == 0) {
          DVar4 = GetLastError();
          if (DVar4 == 0x3e5) {
            SetLastError(0);
            param_4 = 1;
            uVar3 = GetOverlappedResult((HANDLE)*param_1,&local_90,&local_98,1);
            if ((uVar3 == 0) || (param_4 = (ulonglong)local_98, local_98 != *(uint *)(puVar2 + 8)))
            goto LAB_180002021;
            FUN_1800010e0(2,0x18000fad0,(ulonglong)uVar3,param_4);
          }
        }
        uVar13 = puVar2[7];
        uVar3 = *(uint *)(uVar13 + 0x624);
        param_4 = (ulonglong)uVar3;
        uVar9 = 0;
        if (uVar3 != 0) {
          do {
            uVar9 = (uint)uVar10;
            if ((*(short *)(uVar13 + 0x628 + uVar10 * 4) == *(short *)((longlong)puVar2 + 0x4c)) &&
               (*(short *)(uVar13 + 0x62a + uVar10 * 4) == *(short *)((longlong)puVar2 + 0x4e)))
            break;
            uVar9 = uVar9 + 1;
            uVar10 = (ulonglong)uVar9;
          } while (uVar9 < uVar3);
        }
        if (uVar9 == uVar3) {
          *(undefined4 *)((longlong)puVar2 + 0x4c) = 0x401001b;
        }
        goto LAB_1800022df;
      }
      DVar4 = GetLastError();
      if ((int)DVar4 < 1) {
        uVar3 = GetLastError();
        goto LAB_180002538;
      }
    }
  }
  DVar4 = GetLastError();
  uVar3 = DVar4 & 0xffff | 0x80070000;
LAB_180002538:
  if (local_90.hEvent != (HANDLE)0x0) {
    CloseHandle(local_90.hEvent);
  }
  FUN_1800010e0(2,0x18000fc68,(ulonglong)uVar3,param_4);
  FUN_180002e10(local_40 ^ (ulonglong)auStackY_d8);
  return;
}



uint FUN_1800025b0(longlong *param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4)

{
  longlong lVar1;
  longlong lVar2;
  DWORD DVar3;
  BOOL BVar4;
  uint uVar5;
  ulonglong uVar6;
  undefined8 uVar7;
  DWORD local_res8 [2];
  
  FUN_1800010e0(2,0x18000fca0,param_3,param_4);
  local_res8[0] = 0;
  if ((param_1 == (longlong *)0x0) || (param_2 == (undefined4 *)0x0)) {
    uVar5 = 0x80004003;
  }
  else {
    lVar1 = param_1[6];
    if ((lVar1 == 0) || (*param_1 == -1)) {
      FUN_1800010e0(2,0x18000fcc0,param_3,param_4);
      uVar5 = 0x8009800f;
    }
    else {
      *param_2 = 0;
      DVar3 = GetLastError();
      FUN_1800010e0(2,0x18000fd00,(ulonglong)DVar3,param_4);
      SetLastError(0);
      param_4 = 1;
      BVar4 = GetOverlappedResult((HANDLE)*param_1,(LPOVERLAPPED)(lVar1 + 8),local_res8,1);
      if ((BVar4 == 0) || ((local_res8[0] != *(uint *)(lVar1 + 0x30) && (local_res8[0] != 0x18)))) {
        DVar3 = GetLastError();
        if (local_res8[0] == 4) {
          *param_2 = 7;
          uVar5 = 0x80098008;
        }
        else if ((DVar3 == 0x4c7) || (DVar3 == 0x3e3)) {
          uVar5 = 0x80098004;
        }
        else {
          uVar5 = 0x80098036;
        }
      }
      else {
        GetLastError();
        param_4 = *(undefined8 *)(lVar1 + 0x30);
        FUN_1800010e0(2,0x18000fd40,(ulonglong)local_res8[0],param_4);
        lVar2 = *(longlong *)(lVar1 + 0x28);
        if (((lVar2 == 0) || (*(ulonglong *)(lVar1 + 0x30) < 0x18)) || (*(int *)(lVar2 + 4) != 0)) {
          uVar5 = 0x8009800f;
          if (*(uint *)(lVar2 + 4) != 0) {
            uVar5 = *(uint *)(lVar2 + 4);
          }
        }
        else {
          uVar6 = (ulonglong)*(uint *)(lVar2 + 8);
          uVar7 = 0x180000000;
          switch(*(uint *)(lVar2 + 8)) {
          case 1:
            break;
          case 2:
            *(undefined4 *)(lVar2 + 4) = 0x80098008;
            *param_2 = *(undefined4 *)(*(longlong *)(lVar1 + 0x28) + 0xc);
            FUN_1800010e0(2,0x18000fde0,uVar6,0x180000000);
            break;
          case 3:
            FUN_1800010e0(2,0x18000fe40,uVar6,0x180000000);
            break;
          case 4:
            *(undefined4 *)(lVar2 + 4) = 0x80098010;
            break;
          case 5:
            FUN_1800010e0(2,0x18000fea0,uVar6,0x180000000);
            break;
          case 6:
            FUN_1800010e0(2,0x18000ff10,uVar6,0x180000000);
            break;
          default:
            FUN_1800010e0(2,0x18000ff70,uVar6,param_4);
            *(undefined4 *)(*(longlong *)(lVar1 + 0x28) + 4) = 0x8009800f;
            uVar7 = param_4;
          }
          *param_2 = *(undefined4 *)(*(longlong *)(lVar1 + 0x28) + 0xc);
          param_4 = uVar7;
          uVar5 = *(uint *)(*(longlong *)(lVar1 + 0x28) + 4);
        }
      }
    }
  }
  FUN_1800010e0(2,0x18000ffc0,(ulonglong)uVar5,param_4);
  return uVar5;
}



uint FUN_180002800(longlong param_1,undefined8 *param_2,ulonglong *param_3,undefined8 param_4)

{
  uint uVar1;
  longlong lVar2;
  undefined8 *puVar3;
  uint uVar4;
  
  FUN_1800010e0(2,0x18000fff8,param_3,param_4);
  uVar4 = 0;
  if (((param_1 == 0) || (param_2 == (undefined8 *)0x0)) || (param_3 == (ulonglong *)0x0)) {
    uVar4 = 0x80004003;
  }
  else {
    lVar2 = *(longlong *)(param_1 + 0x30);
    if (lVar2 == 0) {
      uVar4 = 0x8009800f;
    }
    else if ((*(longlong *)(lVar2 + 0x28) == 0) ||
            (uVar1 = *(uint *)(*(longlong *)(lVar2 + 0x28) + 0x10), uVar1 == 0)) {
      uVar4 = 0x80098026;
    }
    else {
      puVar3 = (undefined8 *)FUN_180002a70((ulonglong)uVar1);
      if (puVar3 == (undefined8 *)0x0) {
        uVar4 = 0x8007000e;
      }
      else {
        FUN_180002e40(puVar3,(undefined8 *)(*(longlong *)(lVar2 + 0x28) + 0x14),
                      (ulonglong)*(uint *)(*(longlong *)(lVar2 + 0x28) + 0x10));
        *param_2 = puVar3;
        *param_3 = (ulonglong)*(uint *)(*(longlong *)(*(longlong *)(param_1 + 0x30) + 0x28) + 0x10);
      }
    }
  }
  FUN_1800010e0(2,0x180010020,(ulonglong)uVar4,param_4);
  return uVar4;
}



uint FUN_1800028e0(longlong param_1,byte param_2,undefined8 param_3,undefined4 *param_4)

{
  longlong lVar1;
  longlong lVar2;
  code *pcVar3;
  uint uVar4;
  undefined4 *puVar5;
  
  puVar5 = param_4;
  FUN_1800010e0(2,0x1800100a0,param_3,param_4);
  if ((param_1 == 0) || (param_4 == (undefined4 *)0x0)) {
LAB_18000299f:
    uVar4 = 0x80004003;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x30);
    if (lVar1 == 0) {
      uVar4 = 0x8009800f;
      goto LAB_1800029a4;
    }
    lVar2 = *(longlong *)(lVar1 + 0x28);
    if (lVar2 != 0) {
      if (((0x17 < *(ulonglong *)(lVar1 + 0x30)) && (*(int *)(lVar2 + 0x10) != 0)) &&
         (*(int *)(lVar2 + 8) == 1)) {
        if (*(longlong *)(param_1 + 0x20) != 0) {
          pcVar3 = *(code **)(*(longlong *)(param_1 + 0x20) + 0x60);
          if (pcVar3 == (code *)0x0) {
            uVar4 = 0x80004001;
          }
          else {
            puVar5 = (undefined4 *)(ulonglong)param_2;
            uVar4 = (*pcVar3)(param_1,lVar2 + 0x14,*(int *)(lVar2 + 0x10),puVar5,param_4);
          }
          goto LAB_1800029a4;
        }
        goto LAB_18000299f;
      }
      if (((lVar2 != 0) && (0x17 < *(ulonglong *)(lVar1 + 0x30))) &&
         (uVar4 = 0x80098008, *(int *)(lVar2 + 4) == -0x7ff67ff8)) {
        *param_4 = *(undefined4 *)(lVar2 + 0xc);
        goto LAB_1800029a4;
      }
    }
    uVar4 = 0x80098026;
  }
LAB_1800029a4:
  FUN_1800010e0(2,0x1800100c8,(ulonglong)uVar4,puVar5);
  return uVar4;
}



uint FUN_1800029d0(longlong *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                  undefined8 param_5,undefined8 param_6,longlong param_7,longlong param_8)

{
  uint uVar1;
  
  FUN_1800010e0(2,0x180010100,param_3,param_4);
  if (((param_1 == (longlong *)0x0) || (param_7 == 0)) || (param_8 == 0)) {
    uVar1 = 0x80004003;
  }
  else if ((param_1[6] == 0) || (*param_1 == -1)) {
    uVar1 = 0x8009800f;
  }
  else {
    uVar1 = 0x80098009;
  }
  FUN_1800010e0(2,0x180010120,(ulonglong)uVar1,param_4);
  return uVar1;
}



undefined8
FUN_180002a40(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_1800010e0(2,0x180010158,param_3,param_4);
  FUN_1800010e0(2,0x180010180,0,param_4);
  return 0;
}



void FUN_180002a70(SIZE_T param_1)

{
  HANDLE hHeap;
  
  hHeap = GetProcessHeap();
                    // WARNING: Could not recover jumptable at 0x000180002a8f. Too many branches
                    // WARNING: Treating indirect jump as call
  HeapAlloc(hHeap,8,param_1);
  return;
}



undefined8 FUN_180002aa0(void)

{
  return 1;
}



undefined8 WbioQuerySensorInterface(undefined8 *param_1)

{
  ulonglong uVar1;
  undefined8 uVar2;
  
                    // 0x2ab0  1  WbioQuerySensorInterface
  if (param_1 == (undefined8 *)0x0) {
    return 0x80004003;
  }
  uVar1 = (ulonglong)DAT_180017000;
  uVar2 = DAT_180017008;
  FUN_1800010e0(2,0x1800101c0,uVar1,DAT_180017008);
  *param_1 = &DAT_180017000;
  FUN_1800010e0(2,0x1800101f0,uVar1,uVar2);
  return 0;
}



DWORD FUN_180002b0c(undefined1 *param_1,longlong param_2,char *param_3)

{
  char cVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  longlong lVar4;
  
  if ((param_1 != (undefined1 *)0x0) && (param_2 != 0)) {
    if (param_3 != (char *)0x0) {
      lVar4 = (longlong)param_1 - (longlong)param_3;
      do {
        cVar1 = *param_3;
        param_3[lVar4] = cVar1;
        param_3 = param_3 + 1;
        if (cVar1 == '\0') break;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        return 0;
      }
      *param_1 = 0;
      pDVar2 = FUN_180003898();
      DVar3 = 0x22;
      goto LAB_180002b2e;
    }
    *param_1 = 0;
  }
  pDVar2 = FUN_180003898();
  DVar3 = 0x16;
LAB_180002b2e:
  *pDVar2 = DVar3;
  FUN_1800037cc();
  return DVar3;
}



DWORD FUN_180002b70(undefined2 *param_1,longlong param_2,short *param_3)

{
  short sVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  longlong lVar4;
  
  if ((param_1 != (undefined2 *)0x0) && (param_2 != 0)) {
    if (param_3 != (short *)0x0) {
      lVar4 = (longlong)param_1 - (longlong)param_3;
      do {
        sVar1 = *param_3;
        *(short *)(lVar4 + (longlong)param_3) = sVar1;
        param_3 = param_3 + 1;
        if (sVar1 == 0) break;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        return 0;
      }
      *param_1 = 0;
      pDVar2 = FUN_180003898();
      DVar3 = 0x22;
      goto LAB_180002b96;
    }
    *param_1 = 0;
  }
  pDVar2 = FUN_180003898();
  DVar3 = 0x16;
LAB_180002b96:
  *pDVar2 = DVar3;
  FUN_1800037cc();
  return DVar3;
}



void FUN_180002bdc(undefined1 *param_1,ulonglong param_2,longlong param_3,undefined8 param_4)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  FUN_180002ce8(param_1,param_2,param_3,0,&local_res20);
  return;
}



ulonglong FUN_180002c00(undefined *param_1,undefined1 *param_2,ulonglong param_3,longlong param_4,
                       undefined8 param_5,undefined8 param_6)

{
  DWORD *pDVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined *local_48;
  int local_40 [2];
  undefined1 *local_38;
  undefined4 local_30;
  
  local_48 = (undefined *)0x0;
  FUN_180003b50((undefined1 (*) [16])local_40,0,0x28);
  if ((param_4 == 0) || ((param_3 != 0 && (param_2 == (undefined1 *)0x0)))) {
    pDVar1 = FUN_180003898();
    *pDVar1 = 0x16;
    FUN_1800037cc();
    uVar2 = 0xffffffff;
  }
  else {
    local_40[0] = (int)param_3;
    if (0x7fffffff < param_3) {
      local_40[0] = 0x7fffffff;
    }
    local_30 = 0x42;
    local_48 = param_2;
    local_38 = param_2;
    uVar2 = (*(code *)param_1)(&local_48,param_4,param_5,param_6);
    if (param_2 != (undefined1 *)0x0) {
      if (-1 < (int)uVar2) {
        local_40[0] = local_40[0] + -1;
        if (-1 < local_40[0]) {
          *local_48 = 0;
          return uVar2 & 0xffffffff;
        }
        uVar3 = FUN_180003908(0,&local_48);
        if ((int)uVar3 != -1) {
          return uVar2 & 0xffffffff;
        }
      }
      param_2[param_3 - 1] = 0;
      uVar2 = (ulonglong)((-1 < local_40[0]) - 2);
    }
  }
  return uVar2;
}



ulonglong FUN_180002ce8(undefined1 *param_1,ulonglong param_2,longlong param_3,undefined8 param_4,
                       undefined8 param_5)

{
  ulonglong uVar1;
  DWORD *pDVar2;
  
  if (((param_3 == 0) || (param_1 == (undefined1 *)0x0)) || (param_2 == 0)) {
    pDVar2 = FUN_180003898();
    *pDVar2 = 0x16;
  }
  else {
    uVar1 = FUN_180002c00(FUN_180003d7c,param_1,param_2,param_3,param_4,param_5);
    if ((int)uVar1 < 0) {
      *param_1 = 0;
    }
    if ((int)uVar1 != -2) {
      return uVar1;
    }
    pDVar2 = FUN_180003898();
    *pDVar2 = 0x22;
  }
  FUN_1800037cc();
  return 0xffffffff;
}



void FUN_180002d58(undefined1 *param_1,ulonglong param_2,longlong param_3,undefined8 param_4)

{
  FUN_180002ce8(param_1,param_2,param_3,0,param_4);
  return;
}



undefined8 FUN_180002d70(undefined8 param_1,ulonglong param_2,undefined8 param_3,longlong param_4)

{
  FUN_180002d90(param_2,param_4,*(uint **)(param_4 + 0x38));
  return 1;
}



void FUN_180002d90(ulonglong param_1,longlong param_2,uint *param_3)

{
  longlong lVar1;
  ulonglong uVar2;
  
  uVar2 = param_1;
  if ((*param_3 & 4) != 0) {
    uVar2 = (longlong)(int)param_3[1] + param_1 & (longlong)(int)-param_3[2];
  }
  lVar1 = (ulonglong)*(uint *)(*(longlong *)(param_2 + 0x10) + 8) + *(longlong *)(param_2 + 8);
  if ((*(byte *)(lVar1 + 3) & 0xf) != 0) {
    param_1 = param_1 + (longlong)(int)(*(byte *)(lVar1 + 3) & 0xfffffff0);
  }
  FUN_180002e10(param_1 ^ *(ulonglong *)((longlong)(int)(*param_3 & 0xfffffff8) + uVar2));
  return;
}



void FUN_180002e10(longlong param_1)

{
  if ((param_1 == DAT_1800170a0) && ((short)((ulonglong)param_1 >> 0x30) == 0)) {
    return;
  }
  FUN_180004920();
  return;
}



undefined8 * FUN_180002e40(undefined8 *param_1,undefined8 *param_2,ulonglong param_3)

{
  undefined4 *puVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined8 *puVar7;
  undefined8 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  longlong lVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  
  if (0x10 < param_3) {
    lVar11 = (longlong)param_2 - (longlong)param_1;
    if ((param_2 < param_1) && ((longlong)param_1 < (longlong)((longlong)param_2 + param_3))) {
      if ((DAT_180018c04 >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          uVar12 = (longlong)param_1 + param_3;
          if ((uVar12 & 0xf) == 0) {
            puVar9 = (undefined4 *)(uVar12 - 0x10);
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar9);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            uVar12 = param_3 - 0x10;
          }
          else {
            puVar7 = (undefined8 *)(uVar12 - 0x10);
            uVar4 = ((undefined8 *)(lVar11 + (longlong)puVar7))[1];
            puVar9 = (undefined4 *)((ulonglong)puVar7 & 0xfffffffffffffff0);
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar9);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            *puVar7 = *(undefined8 *)(lVar11 + (longlong)puVar7);
            *(undefined8 *)(uVar12 - 8) = uVar4;
            uVar12 = (longlong)puVar9 - (longlong)param_1;
          }
          uVar13 = uVar12 >> 7;
          if (uVar13 != 0) {
            *puVar9 = uVar14;
            puVar9[1] = uVar15;
            puVar9[2] = uVar16;
            puVar9[3] = uVar17;
            puVar10 = puVar9;
            while( true ) {
              puVar7 = (undefined8 *)(lVar11 + -0x10 + (longlong)puVar10);
              uVar4 = puVar7[1];
              puVar8 = (undefined8 *)(lVar11 + -0x20 + (longlong)puVar10);
              uVar5 = *puVar8;
              uVar6 = puVar8[1];
              puVar9 = puVar10 + -0x20;
              *(undefined8 *)(puVar10 + -4) = *puVar7;
              *(undefined8 *)(puVar10 + -2) = uVar4;
              *(undefined8 *)(puVar10 + -8) = uVar5;
              *(undefined8 *)(puVar10 + -6) = uVar6;
              puVar7 = (undefined8 *)(lVar11 + 0x50 + (longlong)puVar9);
              uVar4 = puVar7[1];
              puVar8 = (undefined8 *)(lVar11 + 0x40 + (longlong)puVar9);
              uVar5 = *puVar8;
              uVar6 = puVar8[1];
              uVar13 = uVar13 - 1;
              *(undefined8 *)(puVar10 + -0xc) = *puVar7;
              *(undefined8 *)(puVar10 + -10) = uVar4;
              *(undefined8 *)(puVar10 + -0x10) = uVar5;
              *(undefined8 *)(puVar10 + -0xe) = uVar6;
              puVar7 = (undefined8 *)(lVar11 + 0x30 + (longlong)puVar9);
              uVar4 = puVar7[1];
              puVar8 = (undefined8 *)(lVar11 + 0x20 + (longlong)puVar9);
              uVar5 = *puVar8;
              uVar6 = puVar8[1];
              *(undefined8 *)(puVar10 + -0x14) = *puVar7;
              *(undefined8 *)(puVar10 + -0x12) = uVar4;
              *(undefined8 *)(puVar10 + -0x18) = uVar5;
              *(undefined8 *)(puVar10 + -0x16) = uVar6;
              puVar7 = (undefined8 *)(lVar11 + 0x10 + (longlong)puVar9);
              uVar4 = *puVar7;
              uVar5 = puVar7[1];
              puVar1 = (undefined4 *)(lVar11 + (longlong)puVar9);
              uVar14 = *puVar1;
              uVar15 = puVar1[1];
              uVar16 = puVar1[2];
              uVar17 = puVar1[3];
              if (uVar13 == 0) break;
              *(undefined8 *)(puVar10 + -0x1c) = uVar4;
              *(undefined8 *)(puVar10 + -0x1a) = uVar5;
              *puVar9 = uVar14;
              puVar10[-0x1f] = uVar15;
              puVar10[-0x1e] = uVar16;
              puVar10[-0x1d] = uVar17;
              puVar10 = puVar9;
            }
            *(undefined8 *)(puVar10 + -0x1c) = uVar4;
            *(undefined8 *)(puVar10 + -0x1a) = uVar5;
            uVar12 = uVar12 & 0x7f;
          }
          for (uVar13 = uVar12 >> 4; uVar13 != 0; uVar13 = uVar13 - 1) {
            *puVar9 = uVar14;
            puVar9[1] = uVar15;
            puVar9[2] = uVar16;
            puVar9[3] = uVar17;
            puVar9 = puVar9 + -4;
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar9);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
          }
          if ((uVar12 & 0xf) != 0) {
            uVar4 = param_2[1];
            *param_1 = *param_2;
            param_1[1] = uVar4;
          }
          *puVar9 = uVar14;
          puVar9[1] = uVar15;
          puVar9[2] = uVar16;
          puVar9[3] = uVar17;
          return param_1;
        }
LAB_1800031d0:
        uVar4 = param_2[1];
        puVar7 = (undefined8 *)((param_3 - 0x10) + (longlong)param_1);
        uVar5 = *(undefined8 *)(lVar11 + (longlong)puVar7);
        uVar6 = ((undefined8 *)(lVar11 + (longlong)puVar7))[1];
        *param_1 = *param_2;
        param_1[1] = uVar4;
        *puVar7 = uVar5;
        puVar7[1] = uVar6;
        return param_1;
      }
      puVar7 = (undefined8 *)((longlong)param_1 + param_3);
      if (((ulonglong)puVar7 & 7) != 0) {
        if (((ulonglong)puVar7 & 1) != 0) {
          puVar7 = (undefined8 *)((longlong)puVar7 + -1);
          param_3 = param_3 - 1;
          *(undefined1 *)puVar7 = *(undefined1 *)(lVar11 + (longlong)puVar7);
        }
        if (((ulonglong)puVar7 & 2) != 0) {
          puVar7 = (undefined8 *)((longlong)puVar7 + -2);
          param_3 = param_3 - 2;
          *(undefined2 *)puVar7 = *(undefined2 *)(lVar11 + (longlong)puVar7);
        }
        if (((ulonglong)puVar7 & 4) != 0) {
          puVar7 = (undefined8 *)((longlong)puVar7 + -4);
          param_3 = param_3 - 4;
          *(undefined4 *)puVar7 = *(undefined4 *)(lVar11 + (longlong)puVar7);
        }
      }
      uVar12 = param_3 >> 5;
      puVar8 = puVar7;
      if (uVar12 != 0) {
        do {
          uVar4 = *(undefined8 *)(lVar11 + -0x10 + (longlong)puVar8);
          puVar7 = puVar8 + -4;
          puVar8[-1] = *(undefined8 *)(lVar11 + -8 + (longlong)puVar8);
          puVar8[-2] = uVar4;
          uVar4 = *(undefined8 *)(lVar11 + (longlong)puVar7);
          uVar12 = uVar12 - 1;
          puVar8[-3] = *(undefined8 *)(lVar11 + 8 + (longlong)puVar7);
          *puVar7 = uVar4;
          puVar8 = puVar7;
        } while (uVar12 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar12 = param_3 >> 3;
      if (uVar12 != 0) {
        do {
          puVar7 = puVar7 + -1;
          uVar12 = uVar12 - 1;
          *puVar7 = *(undefined8 *)(lVar11 + (longlong)puVar7);
        } while (uVar12 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_1 = (undefined8 *)((longlong)puVar7 - param_3);
      param_2 = (undefined8 *)(lVar11 + (longlong)param_1);
    }
    else {
      puVar7 = param_1;
      if ((DAT_180018c04 >> 1 & 1) != 0) {
        for (; param_3 != 0; param_3 = param_3 - 1) {
          *(undefined1 *)puVar7 = *(undefined1 *)param_2;
          param_2 = (undefined8 *)((longlong)param_2 + 1);
          puVar7 = (undefined8 *)((longlong)puVar7 + 1);
        }
        return param_1;
      }
      if ((DAT_180018c04 >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          if (((ulonglong)param_1 & 0xf) == 0) {
            puVar10 = (undefined4 *)(lVar11 + (longlong)param_1);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            puVar7 = param_1 + 2;
            uVar12 = param_3 - 0x10;
          }
          else {
            uVar4 = ((undefined8 *)(lVar11 + (longlong)param_1))[1];
            puVar7 = (undefined8 *)((ulonglong)(param_1 + 4) & 0xfffffffffffffff0);
            puVar10 = (undefined4 *)(lVar11 + -0x10 + (longlong)puVar7);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            *param_1 = *(undefined8 *)(lVar11 + (longlong)param_1);
            param_1[1] = uVar4;
            uVar12 = param_3 - ((longlong)puVar7 - (longlong)param_1);
          }
          uVar13 = uVar12 >> 7;
          if (uVar13 != 0) {
            *(undefined4 *)(puVar7 + -2) = uVar14;
            *(undefined4 *)((longlong)puVar7 + -0xc) = uVar15;
            *(undefined4 *)(puVar7 + -1) = uVar16;
            *(undefined4 *)((longlong)puVar7 + -4) = uVar17;
            puVar8 = puVar7;
            while( true ) {
              uVar4 = ((undefined8 *)(lVar11 + (longlong)puVar8))[1];
              puVar7 = (undefined8 *)(lVar11 + 0x10 + (longlong)puVar8);
              uVar5 = *puVar7;
              uVar6 = puVar7[1];
              puVar7 = puVar8 + 0x10;
              *puVar8 = *(undefined8 *)(lVar11 + (longlong)puVar8);
              puVar8[1] = uVar4;
              puVar8[2] = uVar5;
              puVar8[3] = uVar6;
              puVar2 = (undefined8 *)(lVar11 + -0x60 + (longlong)puVar7);
              uVar4 = puVar2[1];
              puVar3 = (undefined8 *)(lVar11 + -0x50 + (longlong)puVar7);
              uVar5 = *puVar3;
              uVar6 = puVar3[1];
              uVar13 = uVar13 - 1;
              puVar8[4] = *puVar2;
              puVar8[5] = uVar4;
              puVar8[6] = uVar5;
              puVar8[7] = uVar6;
              puVar2 = (undefined8 *)(lVar11 + -0x40 + (longlong)puVar7);
              uVar4 = puVar2[1];
              puVar3 = (undefined8 *)(lVar11 + -0x30 + (longlong)puVar7);
              uVar5 = *puVar3;
              uVar6 = puVar3[1];
              puVar8[8] = *puVar2;
              puVar8[9] = uVar4;
              puVar8[10] = uVar5;
              puVar8[0xb] = uVar6;
              puVar2 = (undefined8 *)(lVar11 + -0x20 + (longlong)puVar7);
              uVar4 = *puVar2;
              uVar5 = puVar2[1];
              puVar10 = (undefined4 *)(lVar11 + -0x10 + (longlong)puVar7);
              uVar14 = *puVar10;
              uVar15 = puVar10[1];
              uVar16 = puVar10[2];
              uVar17 = puVar10[3];
              if (uVar13 == 0) break;
              puVar8[0xc] = uVar4;
              puVar8[0xd] = uVar5;
              *(undefined4 *)(puVar8 + 0xe) = uVar14;
              *(undefined4 *)((longlong)puVar8 + 0x74) = uVar15;
              *(undefined4 *)(puVar8 + 0xf) = uVar16;
              *(undefined4 *)((longlong)puVar8 + 0x7c) = uVar17;
              puVar8 = puVar7;
            }
            puVar8[0xc] = uVar4;
            puVar8[0xd] = uVar5;
            uVar12 = uVar12 & 0x7f;
          }
          for (uVar13 = uVar12 >> 4; uVar13 != 0; uVar13 = uVar13 - 1) {
            *(undefined4 *)(puVar7 + -2) = uVar14;
            *(undefined4 *)((longlong)puVar7 + -0xc) = uVar15;
            *(undefined4 *)(puVar7 + -1) = uVar16;
            *(undefined4 *)((longlong)puVar7 + -4) = uVar17;
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar7);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            puVar7 = puVar7 + 2;
          }
          uVar12 = uVar12 & 0xf;
          if (uVar12 != 0) {
            puVar8 = (undefined8 *)((longlong)puVar7 + lVar11 + -0x10 + uVar12);
            uVar4 = puVar8[1];
            *(undefined8 *)((longlong)puVar7 + (uVar12 - 0x10)) = *puVar8;
            *(undefined8 *)((longlong)puVar7 + (uVar12 - 8)) = uVar4;
          }
          *(undefined4 *)(puVar7 + -2) = uVar14;
          *(undefined4 *)((longlong)puVar7 + -0xc) = uVar15;
          *(undefined4 *)(puVar7 + -1) = uVar16;
          *(undefined4 *)((longlong)puVar7 + -4) = uVar17;
          return param_1;
        }
        goto LAB_1800031d0;
      }
      if (((ulonglong)param_1 & 7) != 0) {
        if (((ulonglong)param_1 & 1) != 0) {
          param_3 = param_3 - 1;
          *(undefined1 *)param_1 = *(undefined1 *)(lVar11 + (longlong)param_1);
          puVar7 = (undefined8 *)((longlong)param_1 + 1);
        }
        if (((ulonglong)puVar7 & 2) != 0) {
          param_3 = param_3 - 2;
          *(undefined2 *)puVar7 = *(undefined2 *)(lVar11 + (longlong)puVar7);
          puVar7 = (undefined8 *)((longlong)puVar7 + 2);
        }
        if (((ulonglong)puVar7 & 4) != 0) {
          param_3 = param_3 - 4;
          *(undefined4 *)puVar7 = *(undefined4 *)(lVar11 + (longlong)puVar7);
          puVar7 = (undefined8 *)((longlong)puVar7 + 4);
        }
      }
      uVar12 = param_3 >> 5;
      puVar8 = puVar7;
      if (uVar12 != 0) {
        do {
          uVar4 = *(undefined8 *)(lVar11 + 8 + (longlong)puVar8);
          puVar7 = puVar8 + 4;
          *puVar8 = *(undefined8 *)(lVar11 + (longlong)puVar8);
          puVar8[1] = uVar4;
          uVar4 = *(undefined8 *)(lVar11 + -8 + (longlong)puVar7);
          uVar12 = uVar12 - 1;
          puVar8[2] = *(undefined8 *)(lVar11 + -0x10 + (longlong)puVar7);
          puVar8[3] = uVar4;
          puVar8 = puVar7;
        } while (uVar12 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar12 = param_3 >> 3;
      if (uVar12 != 0) {
        do {
          *puVar7 = *(undefined8 *)(lVar11 + (longlong)puVar7);
          puVar7 = puVar7 + 1;
          uVar12 = uVar12 - 1;
        } while (uVar12 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_2 = (undefined8 *)(lVar11 + (longlong)puVar7);
      param_1 = puVar7;
    }
  }
                    // WARNING: Could not recover jumptable at 0x000180002f1e. Too many branches
                    // WARNING: Treating indirect jump as call
  puVar7 = (undefined8 *)
           (*(code *)((ulonglong)*(uint *)(&DAT_180002f20 + param_3 * 4) + 0x180000000))
                     (param_1,param_2);
  return puVar7;
}



undefined8 FUN_1800033a8(undefined8 param_1,int param_2,longlong param_3)

{
  bool bVar1;
  int iVar2;
  DWORD DVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  longlong lVar5;
  DWORD *pDVar6;
  
  if (param_2 == 1) {
    bVar1 = FUN_180005610();
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      uVar4 = FUN_180005054();
      if ((int)uVar4 != 0) {
        FUN_180006740();
        DAT_18001aa30 = GetCommandLineA();
        DAT_180018678 = FUN_180005ebc();
        uVar4 = FUN_18000563c();
        if (-1 < (int)uVar4) {
          uVar4 = FUN_1800059e0();
          if (((-1 < (int)uVar4) && (uVar4 = FUN_180005c9c(), -1 < (int)uVar4)) &&
             (uVar4 = FUN_1800052d4(), (int)uVar4 == 0)) {
            DAT_180018670 = DAT_180018670 + 1;
            goto LAB_1800034fc;
          }
          FUN_18000596c();
        }
        FUN_1800050d4();
      }
      FUN_180005630();
    }
LAB_1800033c3:
    uVar4 = 0;
  }
  else {
    if (param_2 == 0) {
      if (DAT_180018670 < 1) goto LAB_1800033c3;
      DAT_180018670 = DAT_180018670 + -1;
      if (DAT_180018c48 == 0) {
        FUN_1800052c4();
      }
      FUN_180005154();
      if (param_3 == 0) {
        FUN_18000596c();
        FUN_1800050d4();
        FUN_180005630();
        if (DAT_180017238 != -1) {
          FUN_1800050d4();
        }
      }
    }
    else if (param_2 == 2) {
      lVar5 = FUN_1800060cc();
      if (lVar5 == 0) {
        pDVar6 = (DWORD *)FUN_1800065c0(1,0x478);
        if (pDVar6 != (DWORD *)0x0) {
          iVar2 = FUN_1800060e8();
          if (iVar2 != 0) {
            FUN_180004f90((longlong)pDVar6,0);
            DVar3 = GetCurrentThreadId();
            *pDVar6 = DVar3;
            pDVar6[2] = 0xffffffff;
            pDVar6[3] = 0xffffffff;
            goto LAB_1800034fc;
          }
          FUN_180005dd0(pDVar6);
        }
        goto LAB_1800033c3;
      }
    }
    else if (param_2 == 3) {
      FUN_180004eac((LPVOID)0x0);
    }
LAB_1800034fc:
    uVar4 = 1;
  }
  return uVar4;
}



void entry(undefined8 param_1,int param_2,longlong param_3,undefined8 param_4)

{
  if (param_2 == 1) {
    FUN_180005e10();
  }
  FUN_180003548(param_1,param_2,param_3,param_4);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180003607)
// WARNING: Removing unreachable block (ram,0x000180003599)
// WARNING: Removing unreachable block (ram,0x000180003641)

ulonglong FUN_180003548(undefined8 param_1,int param_2,longlong param_3,undefined8 param_4)

{
  ulonglong uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  
  if ((param_2 == 0) && (DAT_180018670 == 0)) {
    uVar1 = 0;
  }
  else if ((param_2 - 1U < 2) && (uVar2 = FUN_1800033a8(param_1,param_2,param_3), (int)uVar2 == 0))
  {
    uVar1 = 0;
  }
  else {
    uVar3 = FUN_180002aa0();
    uVar1 = uVar3 & 0xffffffff;
    if ((param_2 == 1) && ((uint)uVar3 == 0)) {
      FUN_180002aa0();
      FUN_1800033a8(param_1,0,param_3);
    }
    if ((param_2 == 0) || (param_2 == 3)) {
      uVar2 = FUN_1800033a8(param_1,param_2,param_3);
      uVar1 = (ulonglong)(-(uint)((int)uVar2 != 0) & (uint)uVar3);
    }
  }
  return uVar1;
}



void FUN_180003668(int param_1,undefined4 param_2,undefined4 param_3)

{
  BOOL BVar1;
  int iVar2;
  undefined1 auStackX_8 [8];
  undefined1 auStack_5b8 [32];
  undefined4 *local_598;
  _CONTEXT *local_590;
  undefined4 local_588;
  undefined1 local_584 [156];
  _CONTEXT local_4e8;
  ulonglong local_18;
  
  local_18 = DAT_1800170a0 ^ (ulonglong)auStack_5b8;
  if (param_1 != -1) {
    FUN_180006994();
  }
  local_588 = 0;
  FUN_180003b50((undefined1 (*) [16])local_584,0,0x94);
  local_598 = &local_588;
  local_590 = &local_4e8;
  FUN_180005fb0(&local_4e8);
  local_4e8.Rsp = (DWORD64)auStackX_8;
  local_588 = param_2;
  local_584._0_4_ = param_3;
  BVar1 = IsDebuggerPresent();
  iVar2 = FUN_1800065a0(&local_598);
  if (((iVar2 == 0) && (BVar1 == 0)) && (param_1 != -1)) {
    FUN_180006994();
  }
  FUN_180002e10(local_18 ^ (ulonglong)auStack_5b8);
  return;
}



void FUN_18000375c(undefined8 param_1)

{
  DAT_180018688 = param_1;
  return;
}



void FUN_180003764(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)DecodePointer(DAT_180018688);
  if (UNRECOVERED_JUMPTABLE != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800037b6. Too many branches
                    // WARNING: Treating indirect jump as call
    (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
    return;
  }
  FUN_1800037ec();
  UNRECOVERED_JUMPTABLE = (code *)swi(3);
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void FUN_1800037cc(void)

{
  FUN_180003764(0,0,0,0);
  return;
}



void FUN_1800037ec(void)

{
  code *pcVar1;
  BOOL BVar2;
  undefined1 *puVar3;
  undefined1 auStack_28 [8];
  undefined1 auStack_20 [32];
  
  puVar3 = auStack_28;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(5);
    puVar3 = auStack_20;
  }
  *(undefined8 *)(puVar3 + -8) = 0x180003819;
  FUN_180003668(2,0xc0000417,1);
  FUN_180006580(0xc0000417);
  return;
}



DWORD * FUN_180003828(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180004f0c();
  if (pDVar1 == (DWORD *)0x0) {
    pDVar1 = &DAT_18001721c;
  }
  else {
    pDVar1 = pDVar1 + 5;
  }
  return pDVar1;
}



void FUN_180003848(DWORD param_1)

{
  DWORD DVar1;
  DWORD *pDVar2;
  DWORD *pDVar3;
  
  pDVar2 = FUN_180004f0c();
  if (pDVar2 == (DWORD *)0x0) {
    pDVar2 = &DAT_18001721c;
  }
  else {
    pDVar2 = pDVar2 + 5;
  }
  *pDVar2 = param_1;
  pDVar3 = FUN_180004f0c();
  pDVar2 = (DWORD *)&DAT_180017218;
  if (pDVar3 != (DWORD *)0x0) {
    pDVar2 = pDVar3 + 4;
  }
  DVar1 = FUN_1800038b8(param_1);
  *pDVar2 = DVar1;
  return;
}



DWORD * FUN_180003898(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180004f0c();
  if (pDVar1 == (DWORD *)0x0) {
    pDVar1 = (DWORD *)&DAT_180017218;
  }
  else {
    pDVar1 = pDVar1 + 4;
  }
  return pDVar1;
}



undefined4 FUN_1800038b8(int param_1)

{
  undefined4 uVar1;
  uint uVar2;
  int *piVar3;
  
  uVar2 = 0;
  piVar3 = &DAT_1800170b0;
  do {
    if (param_1 == *piVar3) {
      return *(undefined4 *)(&DAT_1800170b4 + (longlong)(int)uVar2 * 8);
    }
    uVar2 = uVar2 + 1;
    piVar3 = piVar3 + 2;
  } while (uVar2 < 0x2d);
  if (param_1 - 0x13U < 0x12) {
    return 0xd;
  }
  uVar1 = 0x16;
  if (param_1 - 0xbcU < 0xf) {
    uVar1 = 8;
  }
  return uVar1;
}



ulonglong FUN_180003908(undefined4 param_1,undefined **param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  DWORD *pDVar4;
  undefined **ppuVar5;
  undefined7 extraout_var;
  longlong lVar6;
  undefined *puVar7;
  uint uVar8;
  undefined4 local_res8 [2];
  
  local_res8[0] = param_1;
  uVar2 = FUN_180006b78((longlong)param_2);
  uVar8 = *(uint *)(param_2 + 3);
  if ((uVar8 & 0x82) == 0) {
    pDVar4 = FUN_180003898();
    *pDVar4 = 9;
  }
  else if ((uVar8 & 0x40) == 0) {
    uVar3 = 0;
    if ((uVar8 & 1) != 0) {
      *(undefined4 *)(param_2 + 1) = 0;
      if ((uVar8 & 0x10) == 0) {
        *(uint *)(param_2 + 3) = uVar8 | 0x20;
        return 0xffffffff;
      }
      *param_2 = param_2[2];
      *(uint *)(param_2 + 3) = uVar8 & 0xfffffffe;
    }
    uVar8 = *(uint *)(param_2 + 3);
    *(undefined4 *)(param_2 + 1) = 0;
    *(uint *)(param_2 + 3) = uVar8 & 0xffffffef | 2;
    if (((uVar8 & 0x10c) == 0) &&
       (((ppuVar5 = FUN_180006a64(), param_2 != ppuVar5 + 6 &&
         (ppuVar5 = FUN_180006a64(), param_2 != ppuVar5 + 0xc)) ||
        (bVar1 = FUN_180006ba0(uVar2), (int)CONCAT71(extraout_var,bVar1) == 0)))) {
      FUN_180007654(param_2);
    }
    if (((ulonglong)param_2[3] & 0x108) == 0) {
      uVar8 = 1;
      uVar3 = FUN_180006c00(uVar2,(WCHAR *)local_res8,1);
    }
    else {
      uVar8 = *(int *)param_2 - *(int *)(param_2 + 2);
      *param_2 = (undefined *)((longlong)param_2[2] + 1);
      *(int *)(param_2 + 1) = *(int *)((longlong)param_2 + 0x24) + -1;
      if ((int)uVar8 < 1) {
        if (uVar2 + 2 < 2) {
          puVar7 = &DAT_180017240;
        }
        else {
          puVar7 = (undefined *)
                   ((ulonglong)(uVar2 & 0x1f) * 0x58 + (&DAT_180018c70)[(longlong)(int)uVar2 >> 5]);
        }
        if (((puVar7[8] & 0x20) != 0) &&
           (lVar6 = FUN_1800074d8(uVar2,(LARGE_INTEGER)0x0,2), lVar6 == -1)) goto LAB_180003940;
      }
      else {
        uVar3 = FUN_180006c00(uVar2,(WCHAR *)param_2[2],uVar8);
      }
      *param_2[2] = (byte)local_res8[0];
    }
    if (uVar3 == uVar8) {
      return (ulonglong)(byte)local_res8[0];
    }
  }
  else {
    pDVar4 = FUN_180003898();
    *pDVar4 = 0x22;
  }
LAB_180003940:
  *(uint *)(param_2 + 3) = *(uint *)(param_2 + 3) | 0x20;
  return 0xffffffff;
}



longlong * FUN_180003a94(longlong *param_1,longlong *param_2)

{
  uint uVar1;
  undefined *puVar2;
  longlong lVar3;
  DWORD *pDVar4;
  int *piVar5;
  
  *(undefined1 *)(param_1 + 3) = 0;
  if (param_2 == (longlong *)0x0) {
    pDVar4 = FUN_180004ee8();
    param_1[2] = (longlong)pDVar4;
    puVar2 = *(undefined **)(pDVar4 + 0x30);
    *param_1 = (longlong)puVar2;
    param_1[1] = *(longlong *)(pDVar4 + 0x2e);
    if ((puVar2 != PTR_DAT_180017e70) && ((DAT_180017fd8 & pDVar4[0x32]) == 0)) {
      piVar5 = FUN_180007970();
      *param_1 = (longlong)piVar5;
    }
    if (((undefined *)param_1[1] != PTR_DAT_180017b90) &&
       ((DAT_180017fd8 & *(uint *)(param_1[2] + 200)) == 0)) {
      piVar5 = FUN_180007d68();
      param_1[1] = (longlong)piVar5;
    }
    uVar1 = *(uint *)(param_1[2] + 200);
    if ((uVar1 & 2) == 0) {
      *(uint *)(param_1[2] + 200) = uVar1 | 2;
      *(undefined1 *)(param_1 + 3) = 1;
    }
  }
  else {
    lVar3 = param_2[1];
    *param_1 = *param_2;
    param_1[1] = lVar3;
  }
  return param_1;
}



undefined1 (*) [16] FUN_180003b50(undefined1 (*param_1) [16],byte param_2,ulonglong param_3)

{
  uint uVar1;
  undefined1 (*pauVar2) [16];
  undefined1 (*pauVar3) [16];
  undefined1 uVar4;
  ulonglong uVar7;
  longlong lVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  undefined1 auVar11 [16];
  undefined2 uVar5;
  undefined4 uVar6;
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 uVar19;
  
  if (0xf < param_3) {
    pauVar2 = param_1;
    if ((DAT_180018c04 >> 1 & 1) == 0) {
      uVar7 = (ulonglong)param_2 * 0x101010101010101;
      uVar4 = (undefined1)uVar7;
      if ((DAT_180018c04 >> 2 & 1) != 0) {
        uVar19 = (undefined1)(uVar7 >> 0x38);
        auVar18._8_6_ = 0;
        auVar18._0_8_ = uVar7;
        auVar18[0xe] = uVar19;
        auVar18[0xf] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x30);
        auVar17._14_2_ = auVar18._14_2_;
        auVar17._8_5_ = 0;
        auVar17._0_8_ = uVar7;
        auVar17[0xd] = uVar19;
        auVar16._13_3_ = auVar17._13_3_;
        auVar16._8_4_ = 0;
        auVar16._0_8_ = uVar7;
        auVar16[0xc] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x28);
        auVar15._12_4_ = auVar16._12_4_;
        auVar15._8_3_ = 0;
        auVar15._0_8_ = uVar7;
        auVar15[0xb] = uVar19;
        auVar14._11_5_ = auVar15._11_5_;
        auVar14._8_2_ = 0;
        auVar14._0_8_ = uVar7;
        auVar14[10] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x20);
        auVar13._10_6_ = auVar14._10_6_;
        auVar13[8] = 0;
        auVar13._0_8_ = uVar7;
        auVar13[9] = uVar19;
        auVar12._9_7_ = auVar13._9_7_;
        auVar12[8] = uVar19;
        auVar12._0_8_ = uVar7;
        uVar19 = (undefined1)(uVar7 >> 0x18);
        auVar11._8_8_ = auVar12._8_8_;
        auVar11[7] = uVar19;
        auVar11[6] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x10);
        auVar11[5] = uVar19;
        auVar11[4] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 8);
        auVar11[3] = uVar19;
        auVar11[2] = uVar19;
        auVar11[1] = uVar4;
        auVar11[0] = uVar4;
        if (((ulonglong)param_1 & 0xf) != 0) {
          *param_1 = auVar11;
          pauVar2 = (undefined1 (*) [16])((longlong)param_1 + (0x10 - ((ulonglong)param_1 & 0xf)));
          param_3 = (((ulonglong)param_1 & 0xf) - 0x10) + param_3;
        }
        uVar7 = param_3 >> 7;
        pauVar3 = pauVar2;
        if (uVar7 != 0) {
          do {
            *pauVar2 = auVar11;
            pauVar2[1] = auVar11;
            pauVar3 = pauVar2 + 8;
            pauVar2[2] = auVar11;
            pauVar2[3] = auVar11;
            uVar7 = uVar7 - 1;
            pauVar2[4] = auVar11;
            pauVar2[5] = auVar11;
            pauVar2[6] = auVar11;
            pauVar2[7] = auVar11;
            pauVar2 = pauVar3;
          } while (uVar7 != 0);
          param_3 = param_3 & 0x7f;
        }
        for (uVar7 = param_3 >> 4; uVar7 != 0; uVar7 = uVar7 - 1) {
          *pauVar3 = auVar11;
          pauVar3 = pauVar3 + 1;
        }
        if ((param_3 & 0xf) != 0) {
          *(undefined1 (*) [16])(pauVar3[-1] + (param_3 & 0xf)) = auVar11;
        }
        return param_1;
      }
      if (0x3f < param_3) {
        uVar1 = -(int)param_1 & 7;
        uVar9 = param_3;
        if (uVar1 != 0) {
          uVar9 = param_3 - uVar1;
          *(ulonglong *)*param_1 = uVar7;
        }
        param_3 = uVar9 & 0x3f;
        pauVar2 = (undefined1 (*) [16])(*param_1 + uVar1);
        for (uVar9 = uVar9 >> 6; uVar9 != 0; uVar9 = uVar9 - 1) {
          *(ulonglong *)*pauVar2 = uVar7;
          *(ulonglong *)(*pauVar2 + 8) = uVar7;
          *(ulonglong *)pauVar2[1] = uVar7;
          *(ulonglong *)(pauVar2[1] + 8) = uVar7;
          *(ulonglong *)pauVar2[2] = uVar7;
          *(ulonglong *)(pauVar2[2] + 8) = uVar7;
          *(ulonglong *)pauVar2[3] = uVar7;
          *(ulonglong *)(pauVar2[3] + 8) = uVar7;
          pauVar2 = pauVar2 + 4;
        }
      }
      uVar10 = param_3 & 7;
      for (uVar9 = param_3 >> 3; uVar9 != 0; uVar9 = uVar9 - 1) {
        *(ulonglong *)*pauVar2 = uVar7;
        pauVar2 = (undefined1 (*) [16])(*pauVar2 + 8);
      }
      for (; uVar10 != 0; uVar10 = uVar10 - 1) {
        (*pauVar2)[0] = uVar4;
        pauVar2 = (undefined1 (*) [16])(*pauVar2 + 1);
      }
    }
    else {
      for (; param_3 != 0; param_3 = param_3 - 1) {
        (*pauVar2)[0] = param_2;
        pauVar2 = (undefined1 (*) [16])(*pauVar2 + 1);
      }
    }
    return param_1;
  }
  lVar8 = (ulonglong)param_2 * 0x101010101010101;
  uVar4 = (undefined1)lVar8;
  uVar5 = (undefined2)lVar8;
  uVar6 = (undefined4)lVar8;
  switch(param_3) {
  case 0:
    return param_1;
  case 1:
    goto switchD_180003ce2_caseD_1;
  case 8:
    *(longlong *)(param_1[-1] + param_3 + 8) = lVar8;
    return param_1;
  case 9:
    *(longlong *)(param_1[-1] + param_3 + 7) = lVar8;
    param_1[-1][param_3 + 0xf] = uVar4;
    return param_1;
  case 10:
    *(longlong *)(param_1[-1] + param_3 + 6) = lVar8;
    *(undefined2 *)(param_1[-1] + param_3 + 0xe) = uVar5;
    return param_1;
  case 0xb:
    *(longlong *)(param_1[-1] + param_3 + 5) = lVar8;
    break;
  case 0xc:
    *(longlong *)(param_1[-1] + param_3 + 4) = lVar8;
  case 4:
    *(undefined4 *)(param_1[-1] + param_3 + 0xc) = uVar6;
    return param_1;
  case 0xd:
    *(longlong *)(param_1[-1] + param_3 + 3) = lVar8;
  case 5:
    *(undefined4 *)(param_1[-1] + param_3 + 0xb) = uVar6;
    param_1[-1][param_3 + 0xf] = uVar4;
    return param_1;
  case 0xe:
    *(longlong *)(param_1[-1] + param_3 + 2) = lVar8;
  case 6:
    *(undefined4 *)(param_1[-1] + param_3 + 10) = uVar6;
  case 2:
    *(undefined2 *)(param_1[-1] + param_3 + 0xe) = uVar5;
    return param_1;
  case 0xf:
    *(longlong *)(param_1[-1] + param_3 + 1) = lVar8;
  case 7:
    *(undefined4 *)(param_1[-1] + param_3 + 9) = uVar6;
  }
  *(undefined2 *)(param_1[-1] + param_3 + 0xd) = uVar5;
switchD_180003ce2_caseD_1:
  param_1[-1][param_3 + 0xf] = uVar4;
  return param_1;
}



// WARNING: Removing unreachable block (ram,0x000180004192)
// WARNING: Removing unreachable block (ram,0x000180004176)
// WARNING: Removing unreachable block (ram,0x0001800042cb)
// WARNING: Removing unreachable block (ram,0x0001800042cf)
// WARNING: Removing unreachable block (ram,0x0001800042d8)

void FUN_180003d7c(undefined **param_1,byte *param_2,longlong *param_3,WCHAR *param_4)

{
  byte bVar1;
  short *psVar2;
  uint *puVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  bool bVar8;
  bool bVar9;
  bool bVar10;
  bool bVar11;
  char cVar12;
  ushort uVar13;
  uint uVar14;
  int iVar15;
  undefined7 extraout_var;
  code *pcVar16;
  char *pcVar17;
  undefined6 extraout_var_00;
  DWORD *pDVar18;
  uint uVar19;
  int iVar20;
  WCHAR *pWVar21;
  uint uVar22;
  WCHAR *pWVar23;
  int iVar24;
  byte *pbVar25;
  undefined *puVar26;
  ulonglong uVar27;
  undefined *puVar28;
  uint uVar29;
  uint uVar30;
  byte bVar31;
  undefined **ppuVar32;
  undefined1 auStackY_318 [32];
  uint local_2d8;
  int local_2d4;
  uint local_2d0;
  byte local_2cc [4];
  int local_2c8;
  int local_2c4;
  int local_2c0;
  uint local_2bc;
  undefined4 local_2b8;
  undefined **local_2b0;
  undefined4 local_2a8;
  WCHAR *local_2a0;
  DWORD *local_298;
  WCHAR *local_290;
  int local_288 [2];
  byte *local_280;
  undefined8 local_278;
  longlong local_270 [2];
  longlong local_260;
  char local_258;
  WCHAR local_248 [255];
  char local_49 [9];
  ulonglong local_40;
  
  local_40 = DAT_1800170a0 ^ (ulonglong)auStackY_318;
  local_2a8 = 0;
  uVar30 = 0;
  bVar10 = false;
  bVar9 = false;
  bVar8 = false;
  bVar7 = false;
  bVar6 = false;
  bVar4 = false;
  bVar5 = false;
  local_2c4 = 0;
  uVar29 = 0;
  local_2d0 = 0;
  local_2b8 = 0;
  local_2c0 = 0;
  pWVar23 = (WCHAR *)0x0;
  local_2c8 = 0;
  local_2b0 = param_1;
  FUN_180003a94(local_270,param_3);
  local_298 = FUN_180003898();
  if (param_1 != (undefined **)0x0) {
    if (((ulonglong)param_1[3] & 0x40) == 0) {
      uVar14 = FUN_180006b78((longlong)param_1);
      puVar26 = &DAT_180017240;
      if (uVar14 + 2 < 2) {
        puVar28 = &DAT_180017240;
      }
      else {
        puVar28 = (undefined *)
                  ((ulonglong)(uVar14 & 0x1f) * 0x58 + (&DAT_180018c70)[(longlong)(int)uVar14 >> 5])
        ;
      }
      if ((puVar28[0x38] & 0x7f) == 0) {
        if (1 < uVar14 + 2) {
          puVar26 = (undefined *)
                    ((ulonglong)(uVar14 & 0x1f) * 0x58 +
                    (&DAT_180018c70)[(longlong)(int)uVar14 >> 5]);
        }
        if ((puVar26[0x38] & 0x80) == 0) goto LAB_180003e98;
      }
    }
    else {
LAB_180003e98:
      uVar14 = 0;
      if (param_2 != (byte *)0x0) {
        bVar31 = *param_2;
        local_2d8 = 0;
        local_2d4 = 0;
        local_290 = (WCHAR *)0x0;
        uVar22 = uVar14;
        if (bVar31 == 0) goto LAB_180004766;
        do {
          pbVar25 = param_2 + 1;
          local_280 = pbVar25;
          if ((int)uVar14 < 0) break;
          uVar19 = 0;
          if ((byte)(bVar31 - 0x20) < 0x59) {
            uVar19 = (byte)(&DAT_180010270)[(char)bVar31] & 0xf;
          }
          local_2bc = (uint)((byte)(&DAT_180010290)
                                   [(longlong)(int)uVar19 * 9 + (longlong)(int)uVar22] >> 4);
          if (local_2bc == 8) goto LAB_18000474c;
          uVar22 = uVar29;
          if (local_2bc == 0) {
LAB_180004605:
            local_2c8 = 0;
            uVar13 = FUN_180008318((uint)bVar31,local_270);
            if ((int)CONCAT62(extraout_var_00,uVar13) != 0) {
              FUN_1800047a4(bVar31,local_2b0,(int *)&local_2d8);
              bVar31 = *pbVar25;
              pbVar25 = param_2 + 2;
              if (bVar31 == 0) goto LAB_18000474c;
            }
            FUN_1800047a4(bVar31,local_2b0,(int *)&local_2d8);
            uVar22 = uVar29;
            uVar14 = local_2d8;
          }
          else if (local_2bc == 1) {
            local_2b8 = 0;
            local_2c0 = 0;
            local_2c4 = 0;
            local_2d0 = 0;
            uVar30 = 0;
            bVar10 = false;
            bVar9 = false;
            bVar8 = false;
            bVar7 = false;
            bVar6 = false;
            bVar4 = false;
            bVar5 = false;
            local_2c8 = 0;
            uVar22 = 0xffffffff;
          }
          else if (local_2bc == 2) {
            if (bVar31 == 0x20) {
              bVar10 = true;
            }
            else if (bVar31 == 0x23) {
              bVar9 = true;
            }
            else if (bVar31 == 0x2b) {
              bVar6 = true;
            }
            else if (bVar31 == 0x2d) {
              uVar30 = uVar30 | 4;
            }
            else if (bVar31 == 0x30) {
              uVar30 = uVar30 | 8;
            }
          }
          else if (local_2bc == 3) {
            if (bVar31 == 0x2a) {
              local_2c4 = *(int *)param_4;
              param_4 = param_4 + 4;
              if (local_2c4 < 0) {
                uVar30 = uVar30 | 4;
                local_2c4 = -local_2c4;
              }
            }
            else {
              local_2c4 = (int)(char)bVar31 + local_2c4 * 10 + -0x30;
            }
          }
          else {
            uVar22 = 0;
            if (local_2bc != 4) {
              if (local_2bc == 5) {
                if (bVar31 == 0x2a) {
                  uVar22 = *(uint *)param_4;
                  param_4 = param_4 + 4;
                  if ((int)uVar22 < 0) {
                    uVar22 = 0xffffffff;
                  }
                }
                else {
                  uVar22 = (int)(char)bVar31 + (uVar29 * 5 + -0x18) * 2;
                }
              }
              else if (local_2bc == 6) {
                if (bVar31 == 0x49) {
                  bVar1 = *pbVar25;
                  bVar7 = true;
                  if ((bVar1 == 0x36) && (param_2[2] == 0x34)) {
                    bVar7 = true;
                    pbVar25 = param_2 + 3;
                    uVar22 = uVar29;
                  }
                  else if ((bVar1 == 0x33) && (param_2[2] == 0x32)) {
                    bVar7 = false;
                    pbVar25 = param_2 + 3;
                    uVar22 = uVar29;
                  }
                  else if ((0x20 < (byte)(bVar1 + 0xa8)) ||
                          (uVar22 = uVar29,
                          (0x120821001U >> ((ulonglong)(byte)(bVar1 + 0xa8) & 0x3f) & 1) == 0)) {
                    local_2bc = 0;
                    goto LAB_180004605;
                  }
                }
                else if (bVar31 == 0x68) {
                  uVar30 = uVar30 | 0x20;
                  uVar22 = uVar29;
                }
                else if (bVar31 == 0x6c) {
                  if (*pbVar25 == 0x6c) {
                    bVar5 = true;
                    pbVar25 = param_2 + 2;
                    uVar22 = uVar29;
                  }
                  else {
                    uVar30 = uVar30 | 0x10;
                    uVar22 = uVar29;
                  }
                }
                else {
                  uVar22 = uVar29;
                  if (bVar31 == 0x77) {
                    uVar30 = uVar30 | 0x800;
                  }
                }
              }
              else {
                uVar22 = uVar29;
                if (local_2bc == 7) {
                  iVar20 = (int)(char)bVar31;
                  if (iVar20 < 0x65) {
                    if (iVar20 == 100) {
LAB_1800041c9:
                      bVar8 = true;
LAB_1800041cd:
                      iVar20 = 10;
LAB_1800041d7:
                      if ((bVar7) || (bVar5)) {
                        uVar27 = *(ulonglong *)param_4;
                      }
                      else if ((uVar30 & 0x20) == 0) {
                        if (bVar8) {
                          uVar27 = (ulonglong)*(int *)param_4;
                        }
                        else {
                          uVar27 = (ulonglong)*(uint *)param_4;
                        }
                      }
                      else if (bVar8) {
                        uVar27 = (ulonglong)*param_4;
                      }
                      else {
                        uVar27 = (ulonglong)(ushort)*param_4;
                      }
                      local_2a0 = param_4 + 4;
                      if ((bVar8) && ((longlong)uVar27 < 0)) {
                        uVar27 = -uVar27;
                        bVar4 = true;
                      }
                      if ((!bVar7) && (!bVar5)) {
                        uVar27 = uVar27 & 0xffffffff;
                      }
                      if ((int)uVar29 < 0) {
                        uVar29 = 1;
                      }
                      else {
                        uVar30 = uVar30 & 0xfffffff7;
                        if (0x200 < (int)uVar29) {
                          uVar29 = 0x200;
                        }
                      }
                      pcVar17 = local_49;
                      local_2d0 = -(uint)(uVar27 != 0) & local_2d0;
                      uVar14 = uVar29;
                      while ((uVar29 = uVar14 - 1, 0 < (int)uVar14 || (uVar27 != 0))) {
                        uVar14 = (int)(uVar27 % (ulonglong)(longlong)iVar20) + 0x30;
                        cVar12 = (char)uVar14;
                        if (0x39 < uVar14) {
                          cVar12 = cVar12 + (char)local_2a8;
                        }
                        *pcVar17 = cVar12;
                        pcVar17 = pcVar17 + -1;
                        uVar27 = uVar27 / (ulonglong)(longlong)iVar20;
                        uVar14 = uVar29;
                      }
                      local_2d4 = (int)local_49 - (int)pcVar17;
                      pWVar23 = (WCHAR *)(pcVar17 + 1);
                      param_4 = local_2a0;
                    }
                    else {
                      if (iVar20 == 0x41) {
LAB_1800040a6:
                        local_2b8 = 1;
                        bVar31 = bVar31 + 0x20;
                        goto LAB_1800040b2;
                      }
                      if (iVar20 != 0x43) {
                        if ((iVar20 - 0x45U & 0xfffffffd) == 0) goto LAB_1800040a6;
                        if (iVar20 == 0x53) {
                          if ((uVar30 & 0x830) == 0) {
                            uVar30 = uVar30 | 0x800;
                          }
LAB_18000400e:
                          pWVar21 = *(WCHAR **)param_4;
                          uVar14 = uVar29;
                          if (uVar29 == 0xffffffff) {
                            uVar14 = 0x7fffffff;
                          }
                          param_4 = param_4 + 4;
                          pWVar23 = pWVar21;
                          if ((uVar30 & 0x810) == 0) {
                            if (pWVar21 == (WCHAR *)0x0) {
                              pWVar21 = (WCHAR *)PTR_s__null__180017220;
                              pWVar23 = (WCHAR *)PTR_s__null__180017220;
                            }
                            for (; (uVar14 != 0 && (uVar14 = uVar14 - 1, (char)*pWVar21 != '\0'));
                                pWVar21 = (WCHAR *)((longlong)pWVar21 + 1)) {
                            }
                            local_2d4 = (int)pWVar21 - (int)pWVar23;
                          }
                          else {
                            local_2c8 = 1;
                            if (pWVar21 == (WCHAR *)0x0) {
                              pWVar21 = (WCHAR *)PTR_u__null__180017228;
                              pWVar23 = (WCHAR *)PTR_u__null__180017228;
                            }
                            for (; (uVar14 != 0 && (uVar14 = uVar14 - 1, *pWVar21 != L'\0'));
                                pWVar21 = pWVar21 + 1) {
                            }
                            local_2d4 = (int)((longlong)pWVar21 - (longlong)pWVar23 >> 1);
                          }
                          goto LAB_1800043d4;
                        }
                        if (iVar20 == 0x58) goto LAB_180004162;
                        if (iVar20 != 0x5a) {
                          if (iVar20 == 0x61) goto LAB_1800040b2;
                          if (iVar20 != 99) goto LAB_1800043d4;
                          goto LAB_18000405a;
                        }
                        psVar2 = *(short **)param_4;
                        pWVar21 = (WCHAR *)PTR_s__null__180017220;
                        if ((psVar2 == (short *)0x0) ||
                           (pWVar23 = *(WCHAR **)(psVar2 + 4), pWVar23 == (WCHAR *)0x0))
                        goto LAB_1800043c5;
                        local_2d4 = (int)*psVar2;
                        if (uVar30 >> 0xb == 0) {
                          local_2c8 = 0;
                        }
                        else {
                          local_2c8 = 1;
                          local_2d4 = local_2d4 / 2;
                        }
                        goto LAB_1800043d0;
                      }
                      if ((uVar30 & 0x830) == 0) {
                        uVar30 = uVar30 | 0x800;
                      }
LAB_18000405a:
                      if ((uVar30 & 0x810) == 0) {
                        local_2d4 = 1;
                        local_248[0]._0_1_ = (char)*param_4;
                      }
                      else {
                        iVar20 = FUN_18000860c(&local_2d4,(undefined1 (*) [16])local_248,0x200,
                                               *param_4);
                        if (iVar20 != 0) {
                          local_2c0 = 1;
                        }
                      }
                      pWVar23 = local_248;
                      param_4 = param_4 + 4;
                    }
LAB_1800043d4:
                    ppuVar32 = local_2b0;
                    if (local_2c0 == 0) {
                      if (bVar8) {
                        if (bVar4) {
                          local_2cc[0] = 0x2d;
                        }
                        else if (bVar6) {
                          local_2cc[0] = 0x2b;
                        }
                        else {
                          if (!bVar10) goto LAB_18000441a;
                          local_2cc[0] = 0x20;
                        }
                        local_2d0 = 1;
                      }
LAB_18000441a:
                      uVar14 = local_2d0;
                      iVar20 = (local_2c4 - local_2d4) - local_2d0;
                      if ((uVar30 & 0xc) == 0) {
                        FUN_1800047ec(0x20,iVar20,local_2b0,(int *)&local_2d8);
                      }
                      FUN_180004840(local_2cc,uVar14,ppuVar32,(int *)&local_2d8,(int *)local_298);
                      if (((uVar30 & 8) != 0) && ((uVar30 & 4) == 0)) {
                        FUN_1800047ec(0x30,iVar20,ppuVar32,(int *)&local_2d8);
                      }
                      if ((local_2c8 == 0) || (pWVar21 = pWVar23, iVar24 = local_2d4, local_2d4 < 1)
                         ) {
                        FUN_180004840((byte *)pWVar23,local_2d4,ppuVar32,(int *)&local_2d8,
                                      (int *)local_298);
                      }
                      else {
                        do {
                          iVar24 = iVar24 + -1;
                          iVar15 = FUN_18000860c(local_288,(undefined1 (*) [16])(local_49 + 1),6,
                                                 *pWVar21);
                          if ((iVar15 != 0) || (local_288[0] == 0)) {
                            local_2d8 = 0xffffffff;
                            ppuVar32 = local_2b0;
                            break;
                          }
                          FUN_180004840((byte *)(local_49 + 1),local_288[0],local_2b0,
                                        (int *)&local_2d8,(int *)local_298);
                          ppuVar32 = local_2b0;
                          pWVar21 = pWVar21 + 1;
                        } while (iVar24 != 0);
                      }
                      if ((-1 < (int)local_2d8) && ((uVar30 & 4) != 0)) {
                        FUN_1800047ec(0x20,iVar20,ppuVar32,(int *)&local_2d8);
                      }
                    }
                  }
                  else {
                    if (iVar20 < 0x68) {
LAB_1800040b2:
                      bVar8 = true;
                      iVar20 = 0x200;
                      pWVar21 = local_248;
                      if ((int)uVar29 < 0) {
                        uVar29 = 6;
                        iVar24 = 0x200;
                      }
                      else {
                        iVar24 = iVar20;
                        if (uVar29 == 0) {
                          if (bVar31 == 0x67) {
                            uVar29 = 1;
                          }
                        }
                        else {
                          if (0x200 < (int)uVar29) {
                            uVar29 = 0x200;
                          }
                          if (0xa3 < (int)uVar29) {
                            iVar24 = uVar29 + 0x15d;
                            local_290 = (WCHAR *)FUN_180006640((longlong)iVar24);
                            pWVar21 = local_290;
                            if (local_290 == (WCHAR *)0x0) {
                              uVar29 = 0xa3;
                              pWVar21 = local_248;
                              iVar24 = iVar20;
                            }
                          }
                        }
                      }
                      local_278 = *(undefined8 *)param_4;
                      pcVar16 = (code *)DecodePointer(PTR_LAB_180018010);
                      (*pcVar16)(&local_278,pWVar21,(longlong)iVar24,(int)(char)bVar31);
                      if ((bVar9) && (uVar29 == 0)) {
                        pcVar16 = (code *)DecodePointer(PTR_LAB_180018028);
                        (*pcVar16)(pWVar21,local_270);
                      }
                      if ((bVar31 == 0x67) && (!bVar9)) {
                        pcVar16 = (code *)DecodePointer(PTR_LAB_180018020);
                        (*pcVar16)(pWVar21,local_270);
                      }
                      if ((char)*pWVar21 == '-') {
                        bVar8 = true;
                        bVar4 = true;
                        pWVar21 = (WCHAR *)((longlong)pWVar21 + 1);
                      }
LAB_1800043c5:
                      pcVar17 = FUN_1800083c0((ulonglong *)pWVar21);
                      local_2d4 = (int)pcVar17;
                      pWVar23 = pWVar21;
LAB_1800043d0:
                      param_4 = param_4 + 4;
                      goto LAB_1800043d4;
                    }
                    if (iVar20 == 0x69) goto LAB_1800041c9;
                    if (iVar20 != 0x6e) {
                      if (iVar20 == 0x6f) {
                        iVar20 = 8;
                      }
                      else {
                        if (iVar20 == 0x70) {
                          uVar29 = 0x10;
                          bVar7 = true;
LAB_180004162:
                          local_2a8 = 7;
                        }
                        else {
                          if (iVar20 == 0x73) goto LAB_18000400e;
                          if (iVar20 == 0x75) goto LAB_1800041cd;
                          if (iVar20 != 0x78) goto LAB_1800043d4;
                          local_2a8 = 0x27;
                        }
                        iVar20 = 0x10;
                      }
                      goto LAB_1800041d7;
                    }
                    puVar3 = *(uint **)param_4;
                    param_4 = param_4 + 4;
                    bVar11 = FUN_180008468();
                    if ((int)CONCAT71(extraout_var,bVar11) == 0) goto LAB_18000474c;
                    if ((uVar30 & 0x20) == 0) {
                      *puVar3 = uVar14;
                    }
                    else {
                      *(short *)puVar3 = (short)uVar14;
                    }
                    local_2c0 = 1;
                  }
                  pbVar25 = local_280;
                  uVar22 = uVar29;
                  uVar14 = local_2d8;
                  if (local_290 != (WCHAR *)0x0) {
                    FUN_180005dd0(local_290);
                    local_290 = (WCHAR *)0x0;
                    pbVar25 = local_280;
                    uVar14 = local_2d8;
                  }
                }
              }
            }
          }
          uVar29 = uVar22;
          bVar31 = *pbVar25;
          param_2 = pbVar25;
          uVar22 = local_2bc;
        } while (bVar31 != 0);
        if ((uVar22 == 0) || (uVar22 == 7)) goto LAB_180004766;
      }
    }
  }
LAB_18000474c:
  pDVar18 = FUN_180003898();
  *pDVar18 = 0x16;
  FUN_1800037cc();
LAB_180004766:
  if (local_258 != '\0') {
    *(uint *)(local_260 + 200) = *(uint *)(local_260 + 200) & 0xfffffffd;
  }
  FUN_180002e10(local_40 ^ (ulonglong)auStackY_318);
  return;
}



void FUN_1800047a4(byte param_1,undefined **param_2,int *param_3)

{
  undefined **ppuVar1;
  uint uVar2;
  ulonglong uVar3;
  
  if ((((ulonglong)param_2[3] & 0x40) == 0) || (param_2[2] != (undefined *)0x0)) {
    ppuVar1 = param_2 + 1;
    *(int *)ppuVar1 = *(int *)ppuVar1 + -1;
    if (*(int *)ppuVar1 < 0) {
      uVar3 = FUN_180003908((int)(char)param_1,param_2);
      uVar2 = (uint)uVar3;
    }
    else {
      **param_2 = param_1;
      *param_2 = *param_2 + 1;
      uVar2 = (uint)param_1;
    }
    if (uVar2 == 0xffffffff) {
      *param_3 = -1;
    }
    else {
      *param_3 = *param_3 + 1;
    }
  }
  else {
    *param_3 = *param_3 + 1;
  }
  return;
}



void FUN_1800047ec(byte param_1,int param_2,undefined **param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      FUN_1800047a4(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



void FUN_180004840(byte *param_1,int param_2,undefined **param_3,int *param_4,int *param_5)

{
  int iVar1;
  
  iVar1 = *param_5;
  if ((((ulonglong)param_3[3] & 0x40) == 0) || (param_3[2] != (undefined *)0x0)) {
    *param_5 = 0;
    if (0 < param_2) {
      do {
        param_2 = param_2 + -1;
        FUN_1800047a4(*param_1,param_3,param_4);
        param_1 = param_1 + 1;
        if (*param_4 == -1) {
          if (*param_5 != 0x2a) break;
          FUN_1800047a4(0x3f,param_3,param_4);
        }
      } while (0 < param_2);
      if (*param_5 != 0) {
        return;
      }
    }
    *param_5 = iVar1;
  }
  else {
    *param_4 = *param_4 + param_2;
  }
  return;
}



void FUN_1800048d4(undefined8 param_1)

{
  DAT_180018c00 = IsDebuggerPresent();
  FUN_180006994();
  FUN_1800065a0(param_1);
  if (DAT_180018c00 == 0) {
    FUN_180006994();
  }
  FUN_180006580(0xc0000409);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180004920(void)

{
  code *pcVar1;
  BOOL BVar2;
  undefined1 *puVar3;
  undefined1 auStack_38 [8];
  undefined1 auStack_30 [48];
  
  puVar3 = auStack_38;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(2);
    puVar3 = auStack_30;
  }
  *(undefined8 *)(puVar3 + -8) = 0x18000494a;
  FUN_180006020((PCONTEXT)&DAT_180018730);
  _DAT_1800186a0 = *(undefined8 *)(puVar3 + 0x38);
  _DAT_1800187c8 = puVar3 + 0x40;
  _DAT_1800187b0 = *(undefined8 *)(puVar3 + 0x40);
  _DAT_180018690 = 0xc0000409;
  _DAT_180018694 = 1;
  _DAT_1800186a8 = 1;
  DAT_1800186b0 = 2;
  *(undefined8 *)(puVar3 + 0x20) = DAT_1800170a0;
  *(undefined8 *)(puVar3 + 0x28) = DAT_1800170a8;
  *(undefined8 *)(puVar3 + -8) = 0x1800049ec;
  DAT_180018828 = _DAT_1800186a0;
  FUN_1800048d4(&PTR_DAT_1800102f0);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180004b0a)
// WARNING: Removing unreachable block (ram,0x000180004a74)
// WARNING: Removing unreachable block (ram,0x000180004a0e)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_1800049f4(void)

{
  int *piVar1;
  uint *puVar2;
  longlong lVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar6 = 0;
  piVar1 = (int *)cpuid_basic_info(0);
  _DAT_180017234 = 2;
  DAT_180017230 = 1;
  puVar2 = (uint *)cpuid_Version_info(1);
  uVar4 = puVar2[3];
  if (((piVar1[2] == 0x49656e69 && piVar1[3] == 0x6c65746e) && piVar1[1] == 0x756e6547) &&
     ((((uVar5 = *puVar2 & 0xfff3ff0, uVar5 == 0x106c0 || (uVar5 == 0x20660)) || (uVar5 == 0x20670))
      || ((uVar5 - 0x30650 < 0x21 &&
          ((0x100010001U >> ((ulonglong)(uVar5 - 0x30650) & 0x3f) & 1) != 0)))))) {
    DAT_180018c04 = DAT_180018c04 | 1;
  }
  if (((piVar1[1] == 0x68747541 && piVar1[2] == 0x69746e65) && piVar1[3] == 0x444d4163) &&
     (0x600eff < (*puVar2 & 0xff00f00))) {
    DAT_180018c04 = DAT_180018c04 | 4;
  }
  if (6 < *piVar1) {
    lVar3 = cpuid_Extended_Feature_Enumeration_info(7);
    uVar6 = *(uint *)(lVar3 + 4);
    if ((uVar6 >> 9 & 1) != 0) {
      DAT_180018c04 = DAT_180018c04 | 2;
    }
  }
  if ((uVar4 >> 0x14 & 1) != 0) {
    DAT_180017230 = 2;
    _DAT_180017234 = 6;
    if (((uVar4 >> 0x1b & 1) != 0) && ((uVar4 >> 0x1c & 1) != 0)) {
      DAT_180017230 = 3;
      _DAT_180017234 = 0xe;
      if ((uVar6 & 0x20) != 0) {
        DAT_180017230 = 5;
        _DAT_180017234 = 0x2e;
      }
    }
  }
  return 0;
}



undefined4 FUN_180004b98(int param_1,undefined8 param_2)

{
  DWORD DVar1;
  int *piVar2;
  code *pcVar3;
  undefined8 uVar4;
  DWORD *pDVar5;
  int *piVar6;
  longlong lVar7;
  longlong lVar8;
  
  pDVar5 = FUN_180004f0c();
  if (pDVar5 != (DWORD *)0x0) {
    piVar2 = *(int **)(pDVar5 + 0x28);
    piVar6 = piVar2;
    do {
      if (*piVar6 == param_1) break;
      piVar6 = piVar6 + 4;
    } while (piVar6 < piVar2 + 0x30);
    if ((piVar2 + 0x30 <= piVar6) || (*piVar6 != param_1)) {
      piVar6 = (int *)0x0;
    }
    if ((piVar6 != (int *)0x0) && (pcVar3 = *(code **)(piVar6 + 2), pcVar3 != (code *)0x0)) {
      if (pcVar3 == (code *)0x5) {
        piVar6[2] = 0;
        piVar6[3] = 0;
        return 1;
      }
      if (pcVar3 != (code *)0x1) {
        uVar4 = *(undefined8 *)(pDVar5 + 0x2a);
        *(undefined8 *)(pDVar5 + 0x2a) = param_2;
        if (piVar6[1] == 8) {
          lVar7 = 0x30;
          do {
            lVar8 = lVar7 + 0x10;
            *(undefined8 *)(lVar7 + 8 + *(longlong *)(pDVar5 + 0x28)) = 0;
            lVar7 = lVar8;
          } while (lVar8 < 0xc0);
          DVar1 = pDVar5[0x2c];
          if (*piVar6 == -0x3fffff72) {
            pDVar5[0x2c] = 0x83;
          }
          else if (*piVar6 == -0x3fffff70) {
            pDVar5[0x2c] = 0x81;
          }
          else if (*piVar6 == -0x3fffff6f) {
            pDVar5[0x2c] = 0x84;
          }
          else if (*piVar6 == -0x3fffff6d) {
            pDVar5[0x2c] = 0x85;
          }
          else if (*piVar6 == -0x3fffff73) {
            pDVar5[0x2c] = 0x82;
          }
          else if (*piVar6 == -0x3fffff71) {
            pDVar5[0x2c] = 0x86;
          }
          else if (*piVar6 == -0x3fffff6e) {
            pDVar5[0x2c] = 0x8a;
          }
          else if (*piVar6 == -0x3ffffd4b) {
            pDVar5[0x2c] = 0x8d;
          }
          else if (*piVar6 == -0x3ffffd4c) {
            pDVar5[0x2c] = 0x8e;
          }
          (*pcVar3)(8,pDVar5[0x2c]);
          pDVar5[0x2c] = DVar1;
        }
        else {
          piVar6[2] = 0;
          piVar6[3] = 0;
          (*pcVar3)(piVar6[1]);
        }
        *(undefined8 *)(pDVar5 + 0x2a) = uVar4;
      }
      return 0xffffffff;
    }
  }
  return 0;
}



undefined4 FUN_180004d64(int param_1,undefined8 param_2)

{
  undefined4 uVar1;
  
  if (param_1 == -0x1f928c9d) {
    uVar1 = FUN_180004b98(-0x1f928c9d,param_2);
    return uVar1;
  }
  return 0;
}



void FUN_180004d78(LPVOID param_1)

{
  int *piVar1;
  
  if (param_1 != (LPVOID)0x0) {
    if (*(LPVOID *)((longlong)param_1 + 0x38) != (LPVOID)0x0) {
      FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0x38));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x48) != (LPVOID)0x0) {
      FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0x48));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x58) != (LPVOID)0x0) {
      FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0x58));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x68) != (LPVOID)0x0) {
      FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0x68));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x70) != (LPVOID)0x0) {
      FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0x70));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x78) != (LPVOID)0x0) {
      FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0x78));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x80) != (LPVOID)0x0) {
      FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0x80));
    }
    if (*(undefined **)((longlong)param_1 + 0xa0) != &DAT_180010300) {
      FUN_180005dd0(*(undefined **)((longlong)param_1 + 0xa0));
    }
    FUN_1800087b8(0xd);
    piVar1 = *(int **)((longlong)param_1 + 0xb8);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
      UNLOCK();
      if ((*piVar1 == 0) && (piVar1 != &DAT_180017870)) {
        FUN_180005dd0(piVar1);
      }
    }
    FUN_1800089a8(0xd);
    FUN_1800087b8(0xc);
    piVar1 = *(int **)((longlong)param_1 + 0xc0);
    if (piVar1 != (int *)0x0) {
      FUN_1800078cc(piVar1);
      if (((piVar1 != (int *)PTR_DAT_180017e70) && (piVar1 != (int *)&DAT_180017e80)) &&
         (*piVar1 == 0)) {
        FUN_180007734(piVar1);
      }
    }
    FUN_1800089a8(0xc);
    FUN_180005dd0(param_1);
  }
  return;
}



void FUN_180004eac(LPVOID param_1)

{
  if (DAT_180017238 != -1) {
    if (param_1 == (LPVOID)0x0) {
      param_1 = (LPVOID)FUN_1800060cc();
    }
    FUN_1800060e8();
    FUN_180004d78(param_1);
  }
  return;
}



DWORD * FUN_180004ee8(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180004f0c();
  if (pDVar1 == (DWORD *)0x0) {
    FUN_18000529c(0x10);
  }
  return pDVar1;
}



DWORD * FUN_180004f0c(void)

{
  DWORD dwErrCode;
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  dwErrCode = GetLastError();
  pDVar3 = (DWORD *)FUN_1800060cc();
  if (pDVar3 == (DWORD *)0x0) {
    pDVar3 = (DWORD *)FUN_1800065c0(1,0x478);
    if (pDVar3 != (DWORD *)0x0) {
      iVar1 = FUN_1800060e8();
      if (iVar1 == 0) {
        FUN_180005dd0(pDVar3);
        pDVar3 = (DWORD *)0x0;
      }
      else {
        FUN_180004f90((longlong)pDVar3,0);
        DVar2 = GetCurrentThreadId();
        pDVar3[2] = 0xffffffff;
        pDVar3[3] = 0xffffffff;
        *pDVar3 = DVar2;
      }
    }
  }
  SetLastError(dwErrCode);
  return pDVar3;
}



void FUN_180004f90(longlong param_1,longlong param_2)

{
  *(undefined **)(param_1 + 0xa0) = &DAT_180010300;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 1;
  *(undefined4 *)(param_1 + 200) = 1;
  *(undefined2 *)(param_1 + 0x164) = 0x43;
  *(undefined2 *)(param_1 + 0x26a) = 0x43;
  *(undefined4 **)(param_1 + 0xb8) = &DAT_180017870;
  *(undefined8 *)(param_1 + 0x470) = 0;
  FUN_1800087b8(0xd);
  LOCK();
  **(int **)(param_1 + 0xb8) = **(int **)(param_1 + 0xb8) + 1;
  UNLOCK();
  FUN_1800089a8(0xd);
  FUN_1800087b8(0xc);
  *(longlong *)(param_1 + 0xc0) = param_2;
  if (param_2 == 0) {
    *(undefined **)(param_1 + 0xc0) = PTR_DAT_180017e70;
  }
  FUN_1800076a8(*(int **)(param_1 + 0xc0));
  FUN_1800089a8(0xc);
  return;
}



undefined8 FUN_180005054(void)

{
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  FUN_180005378();
  iVar1 = FUN_180008944();
  if ((((iVar1 != 0) && (DAT_180017238 = FUN_180006094(), DAT_180017238 != -1)) &&
      (pDVar3 = (DWORD *)FUN_1800065c0(1,0x478), pDVar3 != (DWORD *)0x0)) &&
     (iVar1 = FUN_1800060e8(), iVar1 != 0)) {
    FUN_180004f90((longlong)pDVar3,0);
    DVar2 = GetCurrentThreadId();
    pDVar3[2] = 0xffffffff;
    pDVar3[3] = 0xffffffff;
    *pDVar3 = DVar2;
    return 1;
  }
  FUN_1800050d4();
  return 0;
}



void FUN_1800050d4(void)

{
  if (DAT_180017238 != -1) {
    FUN_1800060b0();
    DAT_180017238 = -1;
  }
  FUN_1800087fc();
  return;
}



void FUN_1800050f8(uint param_1)

{
  BOOL BVar1;
  FARPROC pFVar2;
  HMODULE local_res10 [3];
  
  BVar1 = GetModuleHandleExW(0,L"mscoree.dll",local_res10);
  if (BVar1 != 0) {
    pFVar2 = GetProcAddress(local_res10[0],"CorExitProcess");
    if (pFVar2 != (FARPROC)0x0) {
      (*pFVar2)((ulonglong)param_1);
    }
  }
  return;
}



void FUN_18000513c(uint param_1)

{
  FUN_1800050f8(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



void FUN_180005154(void)

{
  int iVar1;
  PVOID pvVar2;
  undefined8 *puVar3;
  
  pvVar2 = DecodePointer(DAT_18001aa20);
  for (puVar3 = DAT_180018c28; (puVar3 != (undefined8 *)0x0 && ((LPVOID)*puVar3 != (LPVOID)0x0));
      puVar3 = puVar3 + 1) {
    FUN_180005dd0((LPVOID)*puVar3);
  }
  FUN_180005dd0(DAT_180018c28);
  DAT_180018c28 = (undefined8 *)0x0;
  for (puVar3 = DAT_180018c20; (puVar3 != (undefined8 *)0x0 && ((LPVOID)*puVar3 != (LPVOID)0x0));
      puVar3 = puVar3 + 1) {
    FUN_180005dd0((LPVOID)*puVar3);
  }
  FUN_180005dd0(DAT_180018c20);
  DAT_180018c20 = (undefined8 *)0x0;
  FUN_180005dd0(DAT_180018c18);
  FUN_180005dd0(DAT_180018c10);
  DAT_180018c18 = (LPVOID)0x0;
  DAT_180018c10 = (LPVOID)0x0;
  if ((pvVar2 != (PVOID)0xffffffffffffffff) && (DAT_18001aa20 != (PVOID)0x0)) {
    FUN_180005dd0(pvVar2);
  }
  DAT_18001aa20 = EncodePointer((PVOID)0xffffffffffffffff);
  if (DAT_180019860 != (LPVOID)0x0) {
    FUN_180005dd0(DAT_180019860);
    DAT_180019860 = (LPVOID)0x0;
  }
  if (DAT_180019868 != (LPVOID)0x0) {
    FUN_180005dd0(DAT_180019868);
    DAT_180019868 = (LPVOID)0x0;
  }
  LOCK();
  iVar1 = *(int *)PTR_DAT_180017b90;
  *(int *)PTR_DAT_180017b90 = *(int *)PTR_DAT_180017b90 + -1;
  UNLOCK();
  if ((iVar1 == 1) && ((undefined4 *)PTR_DAT_180017b90 != &DAT_180017870)) {
    FUN_180005dd0(PTR_DAT_180017b90);
    PTR_DAT_180017b90 = (undefined *)&DAT_180017870;
  }
  return;
}



void FUN_18000529c(int param_1)

{
  code *pcVar1;
  
  FUN_1800089c0();
  FUN_180008a34(param_1);
  FUN_180005478(0xff,1,0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_1800052c4(void)

{
  FUN_180005478(0,0,1);
  return;
}



undefined8 FUN_1800052d4(void)

{
  ulonglong uVar1;
  undefined8 uVar2;
  
  uVar1 = FUN_180008d00(0x1800152e0);
  if ((int)uVar1 != 0) {
    thunk_FUN_18000b2e8();
  }
  FUN_180008620();
  uVar2 = FUN_180005424((undefined8 *)&DAT_18000f280,(undefined8 *)&DAT_18000f2a8);
  if ((int)uVar2 == 0) {
    FUN_180008ed0(FUN_180006778);
    FUN_1800053c4((undefined8 *)&DAT_18000f270,(undefined8 *)&DAT_18000f278);
    if ((DAT_18001aa10 != (code *)0x0) && (uVar1 = FUN_180008d00(0x18001aa10), (int)uVar1 != 0)) {
      (*DAT_18001aa10)(0,2);
    }
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_18000536c(UINT param_1)

{
  FUN_180005478(param_1,1,0);
  return;
}



void FUN_180005378(void)

{
  PVOID pvVar1;
  
  pvVar1 = EncodePointer((PVOID)0x0);
  FUN_180008f5c(pvVar1);
  FUN_18000375c(pvVar1);
  FUN_180008f64(pvVar1);
  FUN_180008f7c(pvVar1);
  FUN_180008f08();
  FUN_1800091d0(pvVar1);
  FUN_18000617c();
  return;
}



void FUN_1800053c4(undefined8 *param_1,undefined8 *param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar2 = 0;
  uVar1 = (ulonglong)((longlong)param_2 + (7 - (longlong)param_1)) >> 3;
  if (param_2 < param_1) {
    uVar1 = uVar2;
  }
  if (uVar1 != 0) {
    do {
      if ((code *)*param_1 != (code *)0x0) {
        (*(code *)*param_1)();
      }
      uVar2 = uVar2 + 1;
      param_1 = param_1 + 1;
    } while (uVar2 < uVar1);
  }
  return;
}



void FUN_180005424(undefined8 *param_1,undefined8 *param_2)

{
  int iVar1;
  
  iVar1 = 0;
  if (param_1 < param_2) {
    do {
      if (iVar1 != 0) {
        return;
      }
      if ((code *)*param_1 != (code *)0x0) {
        iVar1 = (*(code *)*param_1)();
      }
      param_1 = param_1 + 1;
    } while (param_1 < param_2);
  }
  return;
}



void FUN_180005460(void)

{
  FUN_1800087b8(8);
  return;
}



void FUN_18000546c(void)

{
  FUN_1800089a8(8);
  return;
}



void FUN_180005478(UINT param_1,int param_2,int param_3)

{
  longlong *plVar1;
  longlong *plVar2;
  PVOID pvVar3;
  code *pcVar4;
  longlong *plVar5;
  longlong *plVar6;
  longlong *plVar7;
  longlong *plVar8;
  
  FUN_1800087b8(8);
  if (DAT_180018c08 != 1) {
    DAT_180018c48 = 1;
    DAT_180018c44 = (undefined1)param_3;
    if (param_2 == 0) {
      plVar1 = (longlong *)DecodePointer(DAT_18001aa20);
      if (plVar1 != (longlong *)0x0) {
        plVar2 = (longlong *)DecodePointer(DAT_18001aa18);
        plVar7 = plVar1;
        plVar8 = plVar2;
        while (plVar2 = plVar2 + -1, plVar1 <= plVar2) {
          pvVar3 = EncodePointer((PVOID)0x0);
          if ((PVOID)*plVar2 != pvVar3) {
            if (plVar2 < plVar1) break;
            pcVar4 = (code *)DecodePointer((PVOID)*plVar2);
            pvVar3 = EncodePointer((PVOID)0x0);
            *plVar2 = (longlong)pvVar3;
            (*pcVar4)();
            plVar5 = (longlong *)DecodePointer(DAT_18001aa20);
            plVar6 = (longlong *)DecodePointer(DAT_18001aa18);
            if ((plVar7 != plVar5) || (plVar8 != plVar6)) {
              plVar1 = plVar5;
              plVar2 = plVar6;
              plVar7 = plVar5;
              plVar8 = plVar6;
            }
          }
        }
      }
      FUN_1800053c4((undefined8 *)&DAT_18000f2b0,(undefined8 *)&DAT_18000f2d0);
    }
    FUN_1800053c4((undefined8 *)&DAT_18000f2d8,(undefined8 *)&DAT_18000f2e0);
  }
  if ((param_3 != 0) && (FUN_1800089a8(8), param_3 != 0)) {
    return;
  }
  DAT_180018c08 = 1;
  FUN_1800089a8(8);
  FUN_1800050f8(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



bool FUN_180005610(void)

{
  DAT_180018c60 = GetProcessHeap();
  return DAT_180018c60 != (HANDLE)0x0;
}



void FUN_180005630(void)

{
  DAT_180018c60 = 0;
  return;
}



undefined8 FUN_18000563c(void)

{
  uint uVar1;
  byte bVar2;
  DWORD DVar3;
  undefined8 uVar4;
  HANDLE hFile;
  int iVar5;
  longlong *plVar6;
  byte *pbVar7;
  longlong lVar8;
  byte *pbVar9;
  int iVar10;
  int iVar11;
  undefined1 auStack_d8 [32];
  uint local_b8;
  longlong *local_b0;
  int local_a8;
  byte *local_a0;
  byte *local_98;
  undefined1 *local_90;
  _STARTUPINFOW local_88;
  
  local_90 = auStack_d8;
  FUN_1800087b8(0xb);
  local_b0 = (longlong *)FUN_1800065c0(0x20,0x58);
  if (local_b0 == (longlong *)0x0) {
    FUN_1800091f0(auStack_d8,(PVOID)0x1800056a0);
    uVar4 = 0xffffffff;
  }
  else {
    DAT_18001aa08 = 0x20;
    DAT_180018c70 = local_b0;
    for (; local_b0 < DAT_180018c70 + 0x160; local_b0 = local_b0 + 0xb) {
      *(undefined2 *)(local_b0 + 1) = 0xa00;
      *local_b0 = -1;
      *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x7f;
      *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
      *(undefined4 *)(local_b0 + 10) = 0;
      *(undefined1 *)((longlong)local_b0 + 0x4c) = 0;
    }
    GetStartupInfoW(&local_88);
    if ((local_88.cbReserved2 != 0) && ((int *)local_88.lpReserved2 != (int *)0x0)) {
      pbVar9 = (byte *)((longlong)local_88.lpReserved2 + 4);
      pbVar7 = pbVar9 + *(int *)local_88.lpReserved2;
      iVar10 = 0x800;
      if (*(int *)local_88.lpReserved2 < 0x800) {
        iVar10 = *(int *)local_88.lpReserved2;
      }
      iVar5 = 1;
      local_a0 = pbVar9;
      local_98 = pbVar7;
      while ((iVar11 = iVar10, local_a8 = iVar5, DAT_18001aa08 < iVar10 &&
             (local_b0 = (longlong *)FUN_1800065c0(0x20,0x58), iVar11 = DAT_18001aa08,
             local_b0 != (longlong *)0x0))) {
        (&DAT_180018c70)[iVar5] = local_b0;
        DAT_18001aa08 = DAT_18001aa08 + 0x20;
        for (; local_b0 < (longlong *)((longlong)(&DAT_180018c70)[iVar5] + 0xb00);
            local_b0 = local_b0 + 0xb) {
          *(undefined2 *)(local_b0 + 1) = 0xa00;
          *local_b0 = -1;
          *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
          *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
          *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
          *(undefined4 *)(local_b0 + 10) = 0;
          *(undefined1 *)((longlong)local_b0 + 0x4c) = 0;
        }
        iVar5 = iVar5 + 1;
      }
      local_b8 = 0;
      while (uVar1 = local_b8, (int)local_b8 < iVar11) {
        if (((1 < (longlong)*(HANDLE *)pbVar7 + 2U) && ((*pbVar9 & 1) != 0)) &&
           (((*pbVar9 & 8) != 0 || (DVar3 = GetFileType(*(HANDLE *)pbVar7), DVar3 != 0)))) {
          plVar6 = (longlong *)
                   ((ulonglong)(uVar1 & 0x1f) * 0x58 +
                   (longlong)(&DAT_180018c70)[(longlong)(int)uVar1 >> 5]);
          *plVar6 = *(longlong *)pbVar7;
          *(byte *)(plVar6 + 1) = *pbVar9;
          local_b0 = plVar6;
          FUN_180006104((LPCRITICAL_SECTION)(plVar6 + 2),4000);
          *(int *)((longlong)plVar6 + 0xc) = *(int *)((longlong)plVar6 + 0xc) + 1;
        }
        pbVar9 = pbVar9 + 1;
        pbVar7 = pbVar7 + 8;
        local_a0 = pbVar9;
        local_98 = pbVar7;
        local_b8 = uVar1 + 1;
      }
    }
    local_b8 = 0;
    while (uVar1 = local_b8, (int)local_b8 < 3) {
      lVar8 = (longlong)(int)local_b8;
      plVar6 = DAT_180018c70 + lVar8 * 0xb;
      local_b0 = plVar6;
      if (*plVar6 + 2U < 2) {
        *(undefined1 *)(plVar6 + 1) = 0x81;
        DVar3 = 0xfffffff5 - (local_b8 != 1);
        if (local_b8 == 0) {
          DVar3 = 0xfffffff6;
        }
        hFile = GetStdHandle(DVar3);
        if (((longlong)hFile + 1U < 2) || (DVar3 = GetFileType(hFile), DVar3 == 0)) {
          *(byte *)(plVar6 + 1) = *(byte *)(plVar6 + 1) | 0x40;
          *plVar6 = -2;
          if (DAT_1800198c0 != 0) {
            *(undefined4 *)(*(longlong *)(DAT_1800198c0 + lVar8 * 8) + 0x1c) = 0xfffffffe;
          }
        }
        else {
          *plVar6 = (longlong)hFile;
          if ((DVar3 & 0xff) == 2) {
            bVar2 = *(byte *)(plVar6 + 1) | 0x40;
LAB_1800058f6:
            *(byte *)(plVar6 + 1) = bVar2;
          }
          else if ((DVar3 & 0xff) == 3) {
            bVar2 = *(byte *)(plVar6 + 1) | 8;
            goto LAB_1800058f6;
          }
          FUN_180006104((LPCRITICAL_SECTION)(plVar6 + 2),4000);
          *(int *)((longlong)plVar6 + 0xc) = *(int *)((longlong)plVar6 + 0xc) + 1;
        }
      }
      else {
        *(byte *)(plVar6 + 1) = *(byte *)(plVar6 + 1) | 0x80;
      }
      local_b8 = uVar1 + 1;
    }
    FUN_1800089a8(0xb);
    uVar4 = 0;
  }
  return uVar4;
}



void FUN_18000596c(void)

{
  ulonglong uVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong *puVar4;
  
  puVar4 = &DAT_180018c70;
  lVar3 = 0x40;
  do {
    uVar2 = *puVar4;
    uVar1 = uVar2;
    if (uVar2 != 0) {
      for (; uVar2 < uVar1 + 0xb00; uVar2 = uVar2 + 0x58) {
        if (*(int *)(uVar2 + 0xc) != 0) {
          DeleteCriticalSection((LPCRITICAL_SECTION)(uVar2 + 0x10));
        }
        uVar1 = *puVar4;
      }
      FUN_180005dd0((LPVOID)*puVar4);
      *puVar4 = 0;
    }
    puVar4 = puVar4 + 1;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_1800059e0(void)

{
  ulonglong uVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  byte *pbVar4;
  ulonglong uVar5;
  int local_res8 [2];
  int local_res10 [2];
  
  if (DAT_18001aa28 == 0) {
    FUN_180007a4c();
  }
  DAT_180018f74 = 0;
  GetModuleFileNameA((HMODULE)0x0,&DAT_180018e70,0x104);
  _DAT_180018c30 = &DAT_180018e70;
  if ((DAT_18001aa30 == (byte *)0x0) || (pbVar4 = DAT_18001aa30, *DAT_18001aa30 == 0)) {
    pbVar4 = &DAT_180018e70;
  }
  FUN_180005ad4(pbVar4,(undefined8 *)0x0,(byte *)0x0,local_res8,local_res10);
  uVar5 = (ulonglong)local_res8[0];
  if ((((uVar5 < 0x1fffffffffffffff) &&
       (uVar3 = (ulonglong)local_res10[0], uVar3 != 0xffffffffffffffff)) &&
      (uVar1 = uVar3 + uVar5 * 8, uVar3 <= uVar1)) &&
     (puVar2 = (undefined8 *)FUN_180006640(uVar1), puVar2 != (undefined8 *)0x0)) {
    FUN_180005ad4(pbVar4,puVar2,(byte *)(puVar2 + uVar5),local_res8,local_res10);
    _DAT_180018c0c = local_res8[0] + -1;
    DAT_180018c10 = puVar2;
    return 0;
  }
  return 0xffffffff;
}



void FUN_180005ad4(byte *param_1,undefined8 *param_2,byte *param_3,int *param_4,int *param_5)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  uint uVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte bVar7;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (undefined8 *)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  bVar2 = false;
  do {
    if (*param_1 == 0x22) {
      bVar2 = !bVar2;
      bVar7 = 0x22;
      pbVar5 = param_1 + 1;
    }
    else {
      *param_5 = *param_5 + 1;
      if (param_3 != (byte *)0x0) {
        *param_3 = *param_1;
        param_3 = param_3 + 1;
      }
      bVar7 = *param_1;
      pbVar5 = param_1 + 1;
      iVar3 = FUN_1800092d0((uint)bVar7);
      if (iVar3 != 0) {
        *param_5 = *param_5 + 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        pbVar5 = param_1 + 2;
      }
      if (bVar7 == 0) {
        pbVar5 = pbVar5 + -1;
        goto LAB_180005b86;
      }
    }
    param_1 = pbVar5;
  } while ((bVar2) || ((bVar7 != 0x20 && (bVar7 != 9))));
  if (param_3 != (byte *)0x0) {
    param_3[-1] = 0;
  }
LAB_180005b86:
  bVar2 = false;
  while (pbVar6 = pbVar5, *pbVar5 != 0) {
    for (; (*pbVar6 == 0x20 || (*pbVar6 == 9)); pbVar6 = pbVar6 + 1) {
    }
    if (*pbVar6 == 0) break;
    if (param_2 != (undefined8 *)0x0) {
      *param_2 = param_3;
      param_2 = param_2 + 1;
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      bVar1 = true;
      uVar4 = 0;
      for (; *pbVar6 == 0x5c; pbVar6 = pbVar6 + 1) {
        uVar4 = uVar4 + 1;
      }
      pbVar5 = pbVar6;
      if (*pbVar6 == 0x22) {
        if (((uVar4 & 1) == 0) && ((!bVar2 || (pbVar5 = pbVar6 + 1, *pbVar5 != 0x22)))) {
          bVar1 = false;
          bVar2 = !bVar2;
          pbVar5 = pbVar6;
        }
        uVar4 = uVar4 >> 1;
      }
      while (uVar4 != 0) {
        uVar4 = uVar4 - 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = 0x5c;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      bVar7 = *pbVar5;
      if ((bVar7 == 0) || ((!bVar2 && ((bVar7 == 0x20 || (bVar7 == 9)))))) break;
      if (bVar1) {
        iVar3 = FUN_1800092d0((int)(char)bVar7);
        if (param_3 == (byte *)0x0) {
          if (iVar3 != 0) {
            pbVar5 = pbVar5 + 1;
            *param_5 = *param_5 + 1;
          }
        }
        else {
          if (iVar3 != 0) {
            bVar7 = *pbVar5;
            pbVar5 = pbVar5 + 1;
            *param_3 = bVar7;
            param_3 = param_3 + 1;
            *param_5 = *param_5 + 1;
          }
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      pbVar6 = pbVar5 + 1;
    }
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    *param_5 = *param_5 + 1;
  }
  if (param_2 != (undefined8 *)0x0) {
    *param_2 = 0;
  }
  *param_4 = *param_4 + 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180005c9c(void)

{
  char cVar1;
  code *pcVar2;
  DWORD DVar3;
  char *pcVar4;
  undefined1 *puVar5;
  undefined8 uVar6;
  ulonglong *puVar7;
  int iVar8;
  undefined8 *puVar9;
  
  if (DAT_18001aa28 == 0) {
    FUN_180007a4c();
  }
  iVar8 = 0;
  puVar7 = DAT_180018678;
  if (DAT_180018678 != (ulonglong *)0x0) {
    for (; (char)*puVar7 != '\0'; puVar7 = (ulonglong *)(pcVar4 + (longlong)puVar7 + 1)) {
      if ((char)*puVar7 != '=') {
        iVar8 = iVar8 + 1;
      }
      pcVar4 = FUN_1800083c0(puVar7);
    }
    DAT_180018c20 = (undefined8 *)FUN_1800065c0((longlong)(iVar8 + 1),8);
    if (DAT_180018c20 != (undefined8 *)0x0) {
      cVar1 = (char)*DAT_180018678;
      puVar9 = DAT_180018c20;
      puVar7 = DAT_180018678;
      do {
        if (cVar1 == '\0') {
          FUN_180005dd0(DAT_180018678);
          DAT_180018678 = (ulonglong *)0x0;
          *puVar9 = 0;
          _DAT_18001aa2c = 1;
          return 0;
        }
        pcVar4 = FUN_1800083c0(puVar7);
        iVar8 = (int)pcVar4 + 1;
        if ((char)*puVar7 != '=') {
          puVar5 = (undefined1 *)FUN_1800065c0((longlong)iVar8,1);
          *puVar9 = puVar5;
          if (puVar5 == (undefined1 *)0x0) {
            FUN_180005dd0(DAT_180018c20);
            DAT_180018c20 = (undefined8 *)0x0;
            return 0xffffffff;
          }
          DVar3 = FUN_180002b0c(puVar5,(longlong)iVar8,(char *)puVar7);
          if (DVar3 != 0) {
            FUN_1800037ec();
            pcVar2 = (code *)swi(3);
            uVar6 = (*pcVar2)();
            return uVar6;
          }
          puVar9 = puVar9 + 1;
        }
        puVar7 = (ulonglong *)((longlong)puVar7 + (longlong)iVar8);
        cVar1 = (char)*puVar7;
      } while( true );
    }
  }
  return 0xffffffff;
}



void FUN_180005dd0(LPVOID param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  if ((param_1 != (LPVOID)0x0) && (BVar1 = HeapFree(DAT_180018c60,0,param_1), BVar1 == 0)) {
    pDVar3 = FUN_180003898();
    DVar2 = GetLastError();
    DVar2 = FUN_1800038b8(DVar2);
    *pDVar3 = DVar2;
  }
  return;
}



void FUN_180005e10(void)

{
  DWORD DVar1;
  _FILETIME local_res8;
  _FILETIME local_res10;
  LARGE_INTEGER local_res18;
  
  local_res10.dwLowDateTime = 0;
  local_res10.dwHighDateTime = 0;
  if (DAT_1800170a0 == 0x2b992ddfa232) {
    GetSystemTimeAsFileTime(&local_res10);
    local_res8 = local_res10;
    DVar1 = GetCurrentThreadId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    DVar1 = GetCurrentProcessId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    QueryPerformanceCounter(&local_res18);
    DAT_1800170a0 =
         ((ulonglong)local_res18.s.LowPart << 0x20 ^
          CONCAT44(local_res18.s.HighPart,local_res18.s.LowPart) ^ (ulonglong)local_res8 ^
         (ulonglong)&local_res8) & 0xffffffffffff;
    if (DAT_1800170a0 == 0x2b992ddfa232) {
      DAT_1800170a0 = 0x2b992ddfa233;
    }
  }
  DAT_1800170a8 = ~DAT_1800170a0;
  return;
}



LPSTR FUN_180005ebc(void)

{
  WCHAR WVar1;
  int cbMultiByte;
  int iVar2;
  LPWCH lpWideCharStr;
  LPSTR lpMultiByteStr;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  
  lpWideCharStr = GetEnvironmentStringsW();
  if (lpWideCharStr != (LPWCH)0x0) {
    WVar1 = *lpWideCharStr;
    pWVar3 = lpWideCharStr;
    while (WVar1 != L'\0') {
      do {
        pWVar4 = pWVar3;
        pWVar3 = pWVar4 + 1;
      } while (*pWVar3 != L'\0');
      pWVar3 = pWVar4 + 2;
      WVar1 = *pWVar3;
    }
    iVar2 = (int)((longlong)pWVar3 - (longlong)lpWideCharStr >> 1);
    cbMultiByte = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,(LPSTR)0x0,0,(LPCSTR)0x0,
                                      (LPBOOL)0x0);
    if ((cbMultiByte != 0) &&
       (lpMultiByteStr = (LPSTR)FUN_180006640((longlong)cbMultiByte), lpMultiByteStr != (LPSTR)0x0))
    {
      iVar2 = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,lpMultiByteStr,cbMultiByte,(LPCSTR)0x0
                                  ,(LPBOOL)0x0);
      if (iVar2 == 0) {
        FUN_180005dd0(lpMultiByteStr);
        lpMultiByteStr = (LPSTR)0x0;
      }
      FreeEnvironmentStringsW(lpWideCharStr);
      return lpMultiByteStr;
    }
    FreeEnvironmentStringsW(lpWideCharStr);
  }
  return (LPSTR)0x0;
}



void FUN_180005fb0(PCONTEXT param_1)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18;
  
  RtlCaptureContext();
  ControlPc = param_1->Rip;
  FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
  if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,&local_res18,&local_res10,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
  }
  return;
}



void FUN_180006020(PCONTEXT param_1)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  int iVar1;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18 [2];
  
  RtlCaptureContext();
  ControlPc = param_1->Rip;
  iVar1 = 0;
  do {
    FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    if (FunctionEntry == (PRUNTIME_FUNCTION)0x0) {
      return;
    }
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,local_res18,&local_res10,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 2);
  return;
}



void FUN_180006094(void)

{
  if ((code *)(DAT_18001a900 ^ DAT_1800170a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800060a4. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18001a900 ^ DAT_1800170a0))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800060a7. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsAlloc();
  return;
}



void FUN_1800060b0(void)

{
  if ((code *)(DAT_18001a908 ^ DAT_1800170a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800060c0. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18001a908 ^ DAT_1800170a0))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800060c3. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsFree();
  return;
}



void FUN_1800060cc(void)

{
  if ((code *)(DAT_18001a910 ^ DAT_1800170a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800060dc. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18001a910 ^ DAT_1800170a0))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800060df. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsGetValue();
  return;
}



void FUN_1800060e8(void)

{
  if ((code *)(DAT_18001a918 ^ DAT_1800170a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800060f8. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18001a918 ^ DAT_1800170a0))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800060fb. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsSetValue();
  return;
}



undefined8 FUN_180006104(LPCRITICAL_SECTION param_1,DWORD param_2)

{
  undefined8 uVar1;
  
  if ((code *)(DAT_18001a920 ^ DAT_1800170a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018000611c. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*(code *)(DAT_18001a920 ^ DAT_1800170a0))();
    return uVar1;
  }
  InitializeCriticalSectionAndSpinCount(param_1,param_2);
  return 1;
}



bool FUN_180006130(void)

{
  int iVar1;
  bool bVar2;
  undefined4 local_res8 [8];
  
  bVar2 = DAT_180017298 < 0;
  if (!bVar2) goto LAB_180006171;
  local_res8[0] = 0;
  if ((code *)(DAT_18001a9e8 ^ DAT_1800170a0) == (code *)0x0) {
LAB_180006167:
    DAT_180017298 = 0;
  }
  else {
    iVar1 = (*(code *)(DAT_18001a9e8 ^ DAT_1800170a0))(local_res8,0);
    DAT_180017298 = 1;
    if (iVar1 != 0x7a) goto LAB_180006167;
  }
  bVar2 = false;
LAB_180006171:
  return DAT_180017298 != 0 && !bVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18000617c(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  
  hModule = GetModuleHandleW(L"kernel32.dll");
  pFVar1 = GetProcAddress(hModule,"FlsAlloc");
  DAT_18001a900 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"FlsFree");
  DAT_18001a908 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"FlsGetValue");
  DAT_18001a910 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"FlsSetValue");
  DAT_18001a918 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"InitializeCriticalSectionEx");
  DAT_18001a920 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"CreateEventExW");
  _DAT_18001a928 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"CreateSemaphoreExW");
  _DAT_18001a930 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"SetThreadStackGuarantee");
  _DAT_18001a938 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"CreateThreadpoolTimer");
  _DAT_18001a940 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"SetThreadpoolTimer");
  _DAT_18001a948 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"WaitForThreadpoolTimerCallbacks");
  _DAT_18001a950 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"CloseThreadpoolTimer");
  _DAT_18001a958 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"CreateThreadpoolWait");
  _DAT_18001a960 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"SetThreadpoolWait");
  _DAT_18001a968 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"CloseThreadpoolWait");
  _DAT_18001a970 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"FlushProcessWriteBuffers");
  _DAT_18001a978 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"FreeLibraryWhenCallbackReturns");
  _DAT_18001a980 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"GetCurrentProcessorNumber");
  _DAT_18001a988 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"GetLogicalProcessorInformation");
  _DAT_18001a990 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"CreateSymbolicLinkW");
  _DAT_18001a998 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"SetDefaultDllDirectories");
  _DAT_18001a9a0 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"EnumSystemLocalesEx");
  _DAT_18001a9b0 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"CompareStringEx");
  _DAT_18001a9a8 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"GetDateFormatEx");
  _DAT_18001a9b8 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"GetLocaleInfoEx");
  _DAT_18001a9c0 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"GetTimeFormatEx");
  _DAT_18001a9c8 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"GetUserDefaultLocaleName");
  _DAT_18001a9d0 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"IsValidLocaleName");
  _DAT_18001a9d8 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"LCMapStringEx");
  DAT_18001a9e0 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"GetCurrentPackageId");
  DAT_18001a9e8 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"GetTickCount64");
  _DAT_18001a9f0 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"GetFileInformationByHandleExW");
  _DAT_18001a9f8 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  pFVar1 = GetProcAddress(hModule,"SetFileInformationByHandleW");
  _DAT_18001aa00 = (ulonglong)pFVar1 ^ DAT_1800170a0;
  return;
}



void __stdcall Sleep(DWORD dwMilliseconds)

{
                    // WARNING: Could not recover jumptable at 0x000180006578. Too many branches
                    // WARNING: Treating indirect jump as call
  Sleep(dwMilliseconds);
  return;
}



void FUN_180006580(undefined4 param_1)

{
  HANDLE pvVar1;
  
  pvVar1 = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x000180006598. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess(pvVar1,param_1);
  return;
}



void FUN_1800065a0(undefined8 param_1)

{
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
                    // WARNING: Could not recover jumptable at 0x0001800065b9. Too many branches
                    // WARNING: Treating indirect jump as call
  UnhandledExceptionFilter(param_1);
  return;
}



LPVOID FUN_1800065c0(ulonglong param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    pvVar1 = FUN_180009470(param_1,param_2,(undefined4 *)0x0);
    if (pvVar1 != (LPVOID)0x0) {
      return pvVar1;
    }
    if (DAT_180018f78 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_180018f78 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (LPVOID)0x0;
    }
  }
  return (LPVOID)0x0;
}



LPVOID FUN_180006640(ulonglong param_1)

{
  uint uVar1;
  LPVOID pvVar2;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    uVar1 = DAT_180018f78;
    pvVar2 = FUN_1800092e4(param_1);
    if (pvVar2 != (LPVOID)0x0) {
      return pvVar2;
    }
    if (uVar1 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_180018f78 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (LPVOID)0x0;
    }
  }
  return (LPVOID)0x0;
}



LPVOID FUN_1800066bc(LPVOID param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  do {
    pvVar1 = FUN_18000939c(param_1,param_2);
    if (pvVar1 != (LPVOID)0x0) {
      return pvVar1;
    }
    if (param_2 == 0) {
      return (LPVOID)0x0;
    }
    if (DAT_180018f78 == 0) {
      return (LPVOID)0x0;
    }
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_180018f78 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
  } while (dwMilliseconds != 0xffffffff);
  return (LPVOID)0x0;
}



void FUN_180006740(void)

{
  undefined8 *puVar1;
  
  for (puVar1 = &DAT_180015450; puVar1 < &DAT_180015450; puVar1 = puVar1 + 1) {
    if ((code *)*puVar1 != (code *)0x0) {
      (*(code *)*puVar1)();
    }
  }
  return;
}



void FUN_180006778(void)

{
  undefined8 *puVar1;
  
  for (puVar1 = &DAT_180015460; puVar1 < &DAT_180015460; puVar1 = puVar1 + 1) {
    if ((code *)*puVar1 != (code *)0x0) {
      (*(code *)*puVar1)();
    }
  }
  return;
}



undefined8
FUN_1800067b0(PEXCEPTION_RECORD param_1,PVOID param_2,undefined8 param_3,longlong *param_4)

{
  uint uVar1;
  longlong lVar2;
  uint *puVar3;
  int iVar4;
  ulonglong uVar5;
  uint uVar6;
  ulonglong uVar7;
  uint uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  PEXCEPTION_RECORD local_38;
  undefined8 local_30;
  
  lVar2 = param_4[1];
  puVar3 = (uint *)param_4[7];
  uVar10 = *param_4 - lVar2;
  if ((param_1->ExceptionFlags & 0x66) == 0) {
    local_38 = param_1;
    local_30 = param_3;
    for (uVar6 = *(uint *)(param_4 + 9); uVar6 < *puVar3; uVar6 = uVar6 + 1) {
      uVar7 = (ulonglong)uVar6;
      if (((puVar3[uVar7 * 4 + 1] <= uVar10) && (uVar10 < puVar3[uVar7 * 4 + 2])) &&
         (puVar3[uVar7 * 4 + 4] != 0)) {
        if (puVar3[uVar7 * 4 + 3] != 1) {
          iVar4 = (*(code *)((ulonglong)puVar3[uVar7 * 4 + 3] + lVar2))(&local_38,param_2);
          if (iVar4 < 0) {
            return 0;
          }
          if (iVar4 < 1) goto LAB_1800068bd;
        }
        if (((param_1->ExceptionCode == 0xe06d7363) && (DAT_18001a8e8 != (code *)0x0)) &&
           (uVar5 = FUN_180008d00(0x18001a8e8), (int)uVar5 != 0)) {
          (*DAT_18001a8e8)(param_1,1);
        }
        FUN_180009220();
        RtlUnwindEx(param_2,(PVOID)((ulonglong)puVar3[uVar7 * 4 + 4] + lVar2),param_1,
                    (PVOID)(ulonglong)param_1->ExceptionCode,(PCONTEXT)param_4[5],
                    (PUNWIND_HISTORY_TABLE)param_4[8]);
        FUN_180009250();
      }
LAB_1800068bd:
    }
  }
  else {
    uVar7 = param_4[4] - lVar2;
    for (uVar6 = *(uint *)(param_4 + 9); uVar1 = *puVar3, uVar6 < uVar1; uVar6 = uVar6 + 1) {
      uVar5 = (ulonglong)uVar6;
      if ((puVar3[uVar5 * 4 + 1] <= uVar10) && (uVar10 < puVar3[uVar5 * 4 + 2])) {
        if ((param_1->ExceptionFlags & 0x20) != 0) {
          uVar9 = 0;
          if (uVar1 != 0) {
            do {
              if ((((puVar3[uVar9 * 4 + 1] <= uVar7) && (uVar7 < puVar3[uVar9 * 4 + 2])) &&
                  (puVar3[uVar9 * 4 + 4] == puVar3[uVar5 * 4 + 4])) &&
                 (puVar3[uVar9 * 4 + 3] == puVar3[uVar5 * 4 + 3])) break;
              uVar8 = (int)uVar9 + 1;
              uVar9 = (ulonglong)uVar8;
            } while (uVar8 < uVar1);
          }
          if ((uint)uVar9 != uVar1) {
            return 1;
          }
        }
        if (puVar3[uVar5 * 4 + 4] == 0) {
          *(uint *)(param_4 + 9) = uVar6 + 1;
          (*(code *)((ulonglong)puVar3[uVar5 * 4 + 3] + lVar2))
                    (CONCAT71((int7)(uVar5 * 2 >> 8),1),param_2);
        }
        else if (uVar7 == puVar3[uVar5 * 4 + 4]) {
          return 1;
        }
      }
    }
  }
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180006994(void)

{
  _DAT_18001a8e0 = 0;
  return;
}



undefined8 FUN_18000699c(void)

{
  undefined **ppuVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar2 = 0;
  lVar3 = 0x14;
  if (DAT_1800198c8 == 0) {
    DAT_1800198c8 = 0x200;
  }
  else if (DAT_1800198c8 < 0x14) {
    DAT_1800198c8 = 0x14;
  }
  DAT_1800198c0 = FUN_1800065c0((longlong)DAT_1800198c8,8);
  if (DAT_1800198c0 == (LPVOID)0x0) {
    DAT_1800198c8 = 0x14;
    DAT_1800198c0 = FUN_1800065c0(0x14,8);
    if (DAT_1800198c0 == (LPVOID)0x0) {
      return 0x1a;
    }
  }
  ppuVar1 = &PTR_DAT_1800172a0;
  do {
    *(undefined ***)(lVar2 + (longlong)DAT_1800198c0) = ppuVar1;
    ppuVar1 = ppuVar1 + 6;
    lVar2 = lVar2 + 8;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  return 0;
}



void FUN_180006a34(void)

{
  FUN_18000967c();
  if (DAT_180018c44 != '\0') {
    FUN_18000950c();
  }
  FUN_180005dd0(DAT_1800198c0);
  DAT_1800198c0 = (LPVOID)0x0;
  return;
}



undefined ** FUN_180006a64(void)

{
  return &PTR_DAT_1800172a0;
}



void FUN_180006a6c(ulonglong param_1)

{
  if ((0x18001729f < param_1) && (param_1 < 0x180017631)) {
    FUN_1800087b8((int)((longlong)(param_1 - 0x1800172a0) / 0x30) + 0x10);
    *(uint *)(param_1 + 0x18) = *(uint *)(param_1 + 0x18) | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180006aca. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x30));
  return;
}



void FUN_180006ad4(int param_1,longlong param_2)

{
  if (param_1 < 0x14) {
    FUN_1800087b8(param_1 + 0x10);
    *(uint *)(param_2 + 0x18) = *(uint *)(param_2 + 0x18) | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180006afe. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x30));
  return;
}



void FUN_180006b08(ulonglong param_1)

{
  if ((0x18001729f < param_1) && (param_1 < 0x180017631)) {
    *(uint *)(param_1 + 0x18) = *(uint *)(param_1 + 0x18) & 0xffff7fff;
    FUN_1800089a8((int)((longlong)(param_1 - 0x1800172a0) / 0x30) + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180006b4f. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x30));
  return;
}



void FUN_180006b58(int param_1,longlong param_2)

{
  if (param_1 < 0x14) {
    *(uint *)(param_2 + 0x18) = *(uint *)(param_2 + 0x18) & 0xffff7fff;
    FUN_1800089a8(param_1 + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180006b6e. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x30));
  return;
}



undefined4 FUN_180006b78(longlong param_1)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  
  if (param_1 == 0) {
    pDVar2 = FUN_180003898();
    *pDVar2 = 0x16;
    FUN_1800037cc();
    uVar1 = 0xffffffff;
  }
  else {
    uVar1 = *(undefined4 *)(param_1 + 0x1c);
  }
  return uVar1;
}



byte FUN_180006ba0(uint param_1)

{
  DWORD *pDVar1;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_180003898();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18001aa08)) {
      return *(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 +
                      (ulonglong)(param_1 & 0x1f) * 0x58) & 0x40;
    }
    pDVar1 = FUN_180003898();
    *pDVar1 = 9;
    FUN_1800037cc();
  }
  return 0;
}



undefined4 FUN_180006c00(uint param_1,WCHAR *param_2,uint param_3)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    pDVar2 = FUN_180003828();
    *pDVar2 = 0;
    pDVar2 = FUN_180003898();
    *pDVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18001aa08)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) != 0) {
        FUN_180009770(param_1);
        if ((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) == 0) {
          pDVar2 = FUN_180003898();
          *pDVar2 = 9;
          pDVar2 = FUN_180003828();
          *pDVar2 = 0;
          uVar1 = 0xffffffff;
        }
        else {
          uVar1 = FUN_180006ce4(param_1,param_2,(ulonglong)param_3);
        }
        FUN_180009928(param_1);
        return uVar1;
      }
    }
    pDVar2 = FUN_180003828();
    *pDVar2 = 0;
    pDVar2 = FUN_180003898();
    *pDVar2 = 9;
    FUN_1800037cc();
  }
  return 0xffffffff;
}



void FUN_180006ce4(uint param_1,WCHAR *param_2,ulonglong param_3)

{
  char cVar1;
  undefined1 uVar2;
  HANDLE pvVar3;
  byte bVar4;
  WCHAR WVar5;
  ushort uVar6;
  WCHAR WVar7;
  BOOL BVar8;
  UINT UVar9;
  int iVar10;
  DWORD DVar11;
  DWORD DVar12;
  uint uVar13;
  longlong lVar14;
  DWORD *pDVar15;
  undefined7 extraout_var;
  undefined6 extraout_var_00;
  uint uVar16;
  uint uVar17;
  DWORD DVar18;
  int iVar19;
  WCHAR *pWVar20;
  longlong lVar21;
  WCHAR *pWVar22;
  uint nNumberOfBytesToWrite;
  ulonglong uVar23;
  char cVar24;
  uint uVar25;
  longlong lVar26;
  int iVar27;
  bool bVar28;
  int iStackX_8;
  WCHAR aWStackX_c [2];
  longlong lStackX_10;
  DWORD aDStackX_18 [2];
  WCHAR local_1af8 [856];
  WCHAR local_1448 [2560];
  ulonglong local_48;
  undefined8 uStack_40;
  
  uStack_40 = 0x180006d06;
  lVar14 = FUN_1800099c0();
  lVar14 = -lVar14;
  local_48 = DAT_1800170a0 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar14);
  uVar16 = 0;
  DVar12 = 0;
  uVar13 = 0;
  nNumberOfBytesToWrite = (uint)param_3;
  uVar25 = 0;
  *(undefined4 *)((longlong)&iStackX_8 + lVar14) = 0;
  DVar18 = 0;
  if (nNumberOfBytesToWrite == 0) goto LAB_1800074ab;
  if (param_2 == (WCHAR *)0x0) {
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006d47;
    pDVar15 = FUN_180003828();
    *pDVar15 = 0;
LAB_180006d4a:
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006d4f;
    pDVar15 = FUN_180003898();
    *pDVar15 = 0x16;
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006d5a;
    FUN_1800037cc();
    goto LAB_1800074ab;
  }
  *(longlong *)((longlong)&lStackX_10 + lVar14) = (longlong)(int)param_1 >> 5;
  lVar21 = (&DAT_180018c70)[(longlong)(int)param_1 >> 5];
  lVar26 = (ulonglong)(param_1 & 0x1f) * 0x58;
  cVar24 = *(char *)(lVar26 + 0x38 + lVar21);
  *(longlong *)(&stack0x00000020 + lVar14) = lVar26;
  cVar24 = (char)(cVar24 * '\x02') >> 1;
  if (((byte)(cVar24 - 1U) < 2) && ((~nNumberOfBytesToWrite & 1) == 0)) {
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006daa;
    pDVar15 = FUN_180003828();
    *pDVar15 = 0;
    goto LAB_180006d4a;
  }
  if ((*(byte *)(lVar26 + 8 + lVar21) & 0x20) != 0) {
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006dc5;
    FUN_1800075c0(param_1,(LARGE_INTEGER)0x0,2);
  }
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006dcc;
  bVar4 = FUN_180006ba0(param_1);
  lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
  iVar27 = (int)param_2;
  if (((int)CONCAT71(extraout_var,bVar4) == 0) ||
     ((*(byte *)(lVar26 + 8 + (&DAT_180018c70)[lVar21]) & 0x80) == 0)) {
LAB_18000711b:
    DVar12 = 0;
    if ((*(byte *)(lVar26 + 8 + (&DAT_180018c70)[lVar21]) & 0x80) != 0) {
      DVar11 = 0;
      if (cVar24 == '\0') {
        pWVar20 = param_2;
        if (nNumberOfBytesToWrite != 0) {
          do {
            uVar23 = 0;
            iVar10 = *(int *)((longlong)&iStackX_8 + lVar14);
            pWVar22 = local_1448;
            do {
              if (nNumberOfBytesToWrite <= (uint)((int)pWVar20 - iVar27)) break;
              WVar5 = *pWVar20;
              pWVar20 = (WCHAR *)((longlong)pWVar20 + 1);
              if ((char)WVar5 == '\n') {
                *(char *)pWVar22 = '\r';
                iVar10 = iVar10 + 1;
                pWVar22 = (WCHAR *)((longlong)pWVar22 + 1);
                uVar23 = uVar23 + 1;
              }
              uVar23 = uVar23 + 1;
              *(char *)pWVar22 = (char)WVar5;
              pWVar22 = (WCHAR *)((longlong)pWVar22 + 1);
            } while (uVar23 < 0x13ff);
            *(int *)((longlong)&iStackX_8 + lVar14) = iVar10;
            lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
            pvVar3 = *(HANDLE *)
                      (lVar26 + (&DAT_180018c70)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
            *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800071d1;
            BVar8 = WriteFile(pvVar3,local_1448,(int)pWVar22 - (int)local_1448,
                              (LPDWORD)((longlong)aDStackX_18 + lVar14),
                              *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
            if (BVar8 == 0) goto LAB_1800070bb;
            uVar16 = uVar16 + *(int *)((longlong)aDStackX_18 + lVar14);
          } while (((longlong)pWVar22 - (longlong)local_1448 <=
                    (longlong)*(int *)((longlong)aDStackX_18 + lVar14)) &&
                  ((uint)((int)pWVar20 - iVar27) < nNumberOfBytesToWrite));
          goto LAB_1800070d2;
        }
      }
      else if (cVar24 == '\x02') {
        pWVar20 = param_2;
        if (nNumberOfBytesToWrite != 0) {
          do {
            uVar23 = 0;
            iVar10 = *(int *)((longlong)&iStackX_8 + lVar14);
            pWVar22 = local_1448;
            do {
              if (nNumberOfBytesToWrite <= (uint)((int)pWVar20 - iVar27)) break;
              WVar5 = *pWVar20;
              pWVar20 = pWVar20 + 1;
              if (WVar5 == L'\n') {
                *pWVar22 = L'\r';
                iVar10 = iVar10 + 2;
                pWVar22 = pWVar22 + 1;
                uVar23 = uVar23 + 2;
              }
              uVar23 = uVar23 + 2;
              *pWVar22 = WVar5;
              pWVar22 = pWVar22 + 1;
            } while (uVar23 < 0x13fe);
            *(int *)((longlong)&iStackX_8 + lVar14) = iVar10;
            lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
            pvVar3 = *(HANDLE *)
                      (lVar26 + (&DAT_180018c70)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
            *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800072be;
            BVar8 = WriteFile(pvVar3,local_1448,(int)pWVar22 - (int)local_1448,
                              (LPDWORD)((longlong)aDStackX_18 + lVar14),
                              *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
            if (BVar8 == 0) goto LAB_1800070bb;
            uVar16 = uVar16 + *(int *)((longlong)aDStackX_18 + lVar14);
          } while (((longlong)pWVar22 - (longlong)local_1448 <=
                    (longlong)*(int *)((longlong)aDStackX_18 + lVar14)) &&
                  ((uint)((int)pWVar20 - iVar27) < nNumberOfBytesToWrite));
          goto LAB_1800070d2;
        }
      }
      else {
        pWVar20 = param_2;
        if (nNumberOfBytesToWrite != 0) {
          do {
            uVar23 = 0;
            pWVar22 = local_1af8;
            do {
              if (nNumberOfBytesToWrite <= (uint)((int)pWVar20 - iVar27)) break;
              WVar5 = *pWVar20;
              pWVar20 = pWVar20 + 1;
              if (WVar5 == L'\n') {
                *pWVar22 = L'\r';
                pWVar22 = pWVar22 + 1;
                uVar23 = uVar23 + 2;
              }
              uVar23 = uVar23 + 2;
              *pWVar22 = WVar5;
              pWVar22 = pWVar22 + 1;
            } while (uVar23 < 0x6a8);
            iVar19 = 0;
            *(undefined8 *)(&stack0x00000000 + lVar14) = 0;
            *(undefined8 *)(&stack0xfffffffffffffff8 + lVar14) = 0;
            *(undefined4 *)(&stack0xfffffffffffffff0 + lVar14) = 0xd55;
            *(WCHAR **)(&stack0xffffffffffffffe8 + lVar14) = local_1448;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180007397;
            iVar10 = WideCharToMultiByte(0xfde9,0,local_1af8,((int)pWVar22 - (int)local_1af8) / 2,
                                         *(LPSTR *)(&stack0xffffffffffffffe8 + lVar14),
                                         *(int *)(&stack0xfffffffffffffff0 + lVar14),
                                         *(LPCSTR *)(&stack0xfffffffffffffff8 + lVar14),
                                         *(LPBOOL *)(&stack0x00000000 + lVar14));
            uVar17 = uVar16;
            if (iVar10 == 0) goto LAB_1800070c5;
            do {
              lVar21 = (&DAT_180018c70)[*(longlong *)((longlong)&lStackX_10 + lVar14)];
              *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
              pvVar3 = *(HANDLE *)(*(longlong *)(&stack0x00000020 + lVar14) + lVar21);
              *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800073e0;
              BVar8 = WriteFile(pvVar3,(LPCVOID)((longlong)local_1448 + (longlong)iVar19),
                                iVar10 - iVar19,(LPDWORD)((longlong)aDStackX_18 + lVar14),
                                *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
              if (BVar8 == 0) {
                *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800073f5;
                DVar12 = GetLastError();
                break;
              }
              iVar19 = iVar19 + *(int *)((longlong)aDStackX_18 + lVar14);
            } while (iVar19 < iVar10);
          } while ((iVar10 <= iVar19) &&
                  (uVar16 = (int)pWVar20 - iVar27, uVar16 < nNumberOfBytesToWrite));
          goto LAB_1800070cd;
        }
      }
      goto LAB_180007473;
    }
    pvVar3 = *(HANDLE *)(lVar26 + (&DAT_180018c70)[lVar21]);
    *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180007435;
    BVar8 = WriteFile(pvVar3,param_2,nNumberOfBytesToWrite,(LPDWORD)((longlong)aDStackX_18 + lVar14)
                      ,*(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
    if (BVar8 == 0) {
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18000744a;
      uVar13 = GetLastError();
      uVar16 = uVar25;
    }
    else {
      uVar16 = *(uint *)((longlong)aDStackX_18 + lVar14);
      uVar13 = uVar25;
    }
    goto LAB_1800070db;
  }
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006df5;
  pDVar15 = FUN_180004ee8();
  lVar21 = *(longlong *)(*(longlong *)(pDVar15 + 0x30) + 0x138);
  pvVar3 = *(HANDLE *)(lVar26 + (&DAT_180018c70)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006e2b;
  BVar8 = GetConsoleMode(pvVar3,(LPDWORD)(&stack0x0000002c + lVar14));
  if (BVar8 == 0) {
    lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
    goto LAB_18000711b;
  }
  if ((lVar21 == 0) && (cVar24 == '\0')) {
    lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
    goto LAB_18000711b;
  }
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006e4a;
  UVar9 = GetConsoleCP();
  *(UINT *)(&stack0x00000030 + lVar14) = UVar9;
  WVar5 = L'\0';
  *(undefined2 *)((longlong)aWStackX_c + lVar14) = 0;
  *(undefined4 *)(&stack0x00000028 + lVar14) = 0;
  pWVar20 = param_2;
  if (nNumberOfBytesToWrite != 0) {
    do {
      bVar28 = false;
      uVar17 = uVar16;
      if (cVar24 == '\0') {
        cVar1 = (char)*pWVar20;
        lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
        *(uint *)(&stack0x0000002c + lVar14) = (uint)(cVar1 == '\n');
        lVar21 = (&DAT_180018c70)[*(longlong *)((longlong)&lStackX_10 + lVar14)];
        if (*(int *)(lVar26 + 0x50 + lVar21) == 0) {
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006ec6;
          uVar6 = FUN_18000835c((int)cVar1);
          if ((int)CONCAT62(extraout_var_00,uVar6) == 0) {
            uVar23 = 1;
            pWVar22 = pWVar20;
            goto LAB_180006f07;
          }
          if ((longlong)(((param_3 & 0xffffffff) - (longlong)pWVar20) + (longlong)param_2) < 2) {
            lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
            uVar16 = uVar16 + 1;
            *(char *)(lVar26 + 0x4c + (&DAT_180018c70)[lVar21]) = (char)*pWVar20;
            *(undefined4 *)(lVar26 + 0x50 + (&DAT_180018c70)[lVar21]) = 1;
            goto LAB_1800070db;
          }
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006ef0;
          iVar10 = FUN_1800087b0((LPWSTR)((longlong)aWStackX_c + lVar14),(byte *)pWVar20,2);
          DVar11 = DVar18;
          if (iVar10 == -1) break;
          pWVar20 = (WCHAR *)((longlong)pWVar20 + 1);
        }
        else {
          uVar2 = *(undefined1 *)(lVar26 + 0x4c + lVar21);
          (&stack0x00000035)[lVar14] = cVar1;
          (&stack0x00000034)[lVar14] = uVar2;
          *(undefined4 *)(lVar26 + 0x50 + lVar21) = 0;
          uVar23 = 2;
          pWVar22 = (WCHAR *)(&stack0x00000034 + lVar14);
LAB_180006f07:
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006f11;
          iVar10 = FUN_1800087b0((LPWSTR)((longlong)aWStackX_c + lVar14),(byte *)pWVar22,uVar23);
          DVar11 = 0;
          if (iVar10 == -1) break;
        }
        *(undefined8 *)(&stack0x00000000 + lVar14) = 0;
        *(undefined8 *)(&stack0xfffffffffffffff8 + lVar14) = 0;
        *(undefined4 *)(&stack0xfffffffffffffff0 + lVar14) = 5;
        *(undefined1 **)(&stack0xffffffffffffffe8 + lVar14) = &stack0x00000034 + lVar14;
        pWVar20 = (WCHAR *)((longlong)pWVar20 + 1);
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006f52;
        DVar11 = WideCharToMultiByte(*(UINT *)(&stack0x00000030 + lVar14),0,
                                     (LPCWSTR)((longlong)aWStackX_c + lVar14),1,
                                     *(LPSTR *)(&stack0xffffffffffffffe8 + lVar14),
                                     *(int *)(&stack0xfffffffffffffff0 + lVar14),
                                     *(LPCSTR *)(&stack0xfffffffffffffff8 + lVar14),
                                     *(LPBOOL *)(&stack0x00000000 + lVar14));
        if (DVar11 == 0) goto LAB_1800070cd;
        lVar21 = (&DAT_180018c70)[*(longlong *)((longlong)&lStackX_10 + lVar14)];
        *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
        pvVar3 = *(HANDLE *)(*(longlong *)(&stack0x00000020 + lVar14) + lVar21);
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006f90;
        BVar8 = WriteFile(pvVar3,&stack0x00000034 + lVar14,DVar11,
                          (LPDWORD)(&stack0x00000028 + lVar14),
                          *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
        if (BVar8 == 0) goto LAB_1800070c5;
        uVar16 = ((int)pWVar20 - iVar27) + *(int *)((longlong)&iStackX_8 + lVar14);
        if (*(int *)(&stack0x00000028 + lVar14) < (int)DVar11) {
          lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
          lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
          uVar13 = uVar25;
          goto LAB_1800070db;
        }
        if (*(int *)(&stack0x0000002c + lVar14) == 0) {
          WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
          uVar17 = uVar16;
          goto LAB_18000707a;
        }
        (&stack0x00000034)[lVar14] = 0xd;
        *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
        lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
        pvVar3 = *(HANDLE *)
                  (lVar26 + (&DAT_180018c70)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180006ff0;
        BVar8 = WriteFile(pvVar3,&stack0x00000034 + lVar14,1,(LPDWORD)(&stack0x00000028 + lVar14),
                          *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
        if (BVar8 == 0) goto LAB_1800070bb;
        DVar11 = DVar18;
        if (*(int *)(&stack0x00000028 + lVar14) < 1) break;
        *(int *)((longlong)&iStackX_8 + lVar14) = *(int *)((longlong)&iStackX_8 + lVar14) + 1;
        WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
        uVar16 = uVar16 + 1;
      }
      else {
        if ((byte)(cVar24 - 1U) < 2) {
          WVar5 = *pWVar20;
          bVar28 = WVar5 == L'\n';
          *(WCHAR *)((longlong)aWStackX_c + lVar14) = WVar5;
          pWVar20 = pWVar20 + 1;
        }
        if ((byte)(cVar24 - 1U) < 2) {
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180007047;
          WVar7 = FUN_180009954(WVar5);
          WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
          if (WVar7 != WVar5) goto LAB_1800070c5;
          uVar17 = uVar16 + 2;
          if (bVar28) {
            *(undefined2 *)((longlong)aWStackX_c + lVar14) = 0xd;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18000706a;
            WVar7 = FUN_180009954(0xd);
            WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
            if (WVar7 != WVar5) goto LAB_1800070c5;
            uVar17 = uVar16 + 3;
            *(int *)((longlong)&iStackX_8 + lVar14) = *(int *)((longlong)&iStackX_8 + lVar14) + 1;
          }
        }
LAB_18000707a:
        lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
        uVar16 = uVar17;
      }
      DVar11 = DVar18;
    } while ((uint)((int)pWVar20 - iVar27) < nNumberOfBytesToWrite);
    goto LAB_1800070d2;
  }
  lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
  goto LAB_180007473;
LAB_1800070c5:
  uVar16 = uVar17;
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800070cb;
  DVar12 = GetLastError();
LAB_1800070cd:
  lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
  DVar11 = DVar12;
  goto LAB_1800070d2;
LAB_1800070bb:
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800070c1;
  DVar11 = GetLastError();
LAB_1800070d2:
  uVar13 = DVar11;
  lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
LAB_1800070db:
  if (uVar16 == 0) {
    if (uVar13 == 0) {
LAB_180007473:
      if (((*(byte *)(lVar26 + 8 + (&DAT_180018c70)[lVar21]) & 0x40) == 0) ||
         ((char)*param_2 != '\x1a')) {
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180007495;
        pDVar15 = FUN_180003898();
        *pDVar15 = 0x1c;
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800074a0;
        pDVar15 = FUN_180003828();
        *pDVar15 = 0;
      }
    }
    else if (uVar13 == 5) {
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800070fb;
      pDVar15 = FUN_180003898();
      *pDVar15 = 9;
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180007106;
      pDVar15 = FUN_180003828();
      *pDVar15 = 5;
    }
    else {
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180007469;
      FUN_180003848(uVar13);
    }
  }
LAB_1800074ab:
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800074ba;
  FUN_180002e10(local_48 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar14));
  return;
}



undefined8 FUN_1800074d8(uint param_1,LARGE_INTEGER param_2,DWORD param_3)

{
  DWORD *pDVar1;
  undefined8 uVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_180003828();
    *pDVar1 = 0;
    pDVar1 = FUN_180003898();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18001aa08)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) != 0) {
        FUN_180009770(param_1);
        if ((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) == 0) {
          pDVar1 = FUN_180003898();
          *pDVar1 = 9;
          pDVar1 = FUN_180003828();
          *pDVar1 = 0;
          uVar2 = 0xffffffffffffffff;
        }
        else {
          uVar2 = FUN_1800075c0(param_1,param_2,param_3);
        }
        FUN_180009928(param_1);
        return uVar2;
      }
    }
    pDVar1 = FUN_180003828();
    *pDVar1 = 0;
    pDVar1 = FUN_180003898();
    *pDVar1 = 9;
    FUN_1800037cc();
  }
  return 0xffffffffffffffff;
}



undefined8 FUN_1800075c0(uint param_1,LARGE_INTEGER param_2,DWORD param_3)

{
  byte *pbVar1;
  BOOL BVar2;
  DWORD DVar3;
  HANDLE hFile;
  DWORD *pDVar4;
  LARGE_INTEGER local_res20;
  
  hFile = (HANDLE)FUN_1800098b4(param_1);
  if (hFile == (HANDLE)0xffffffffffffffff) {
    pDVar4 = FUN_180003898();
    *pDVar4 = 9;
  }
  else {
    BVar2 = SetFilePointerEx(hFile,param_2,&local_res20,param_3);
    if (BVar2 != 0) {
      pbVar1 = (byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 +
                       (ulonglong)(param_1 & 0x1f) * 0x58);
      *pbVar1 = *pbVar1 & 0xfd;
      return local_res20.QuadPart;
    }
    DVar3 = GetLastError();
    FUN_180003848(DVar3);
  }
  return 0xffffffffffffffff;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180007654(undefined8 *param_1)

{
  LPVOID pvVar1;
  
  _DAT_180018f7c = _DAT_180018f7c + 1;
  pvVar1 = FUN_180006640(0x1000);
  param_1[2] = pvVar1;
  if (pvVar1 == (LPVOID)0x0) {
    *(uint *)(param_1 + 3) = *(uint *)(param_1 + 3) | 4;
    *(undefined4 *)((longlong)param_1 + 0x24) = 2;
    param_1[2] = param_1 + 4;
  }
  else {
    *(uint *)(param_1 + 3) = *(uint *)(param_1 + 3) | 8;
    *(undefined4 *)((longlong)param_1 + 0x24) = 0x1000;
  }
  *(undefined4 *)(param_1 + 1) = 0;
  *param_1 = param_1[2];
  return;
}



void FUN_1800076a8(int *param_1)

{
  int *piVar1;
  int *piVar2;
  longlong lVar3;
  
  LOCK();
  *param_1 = *param_1 + 1;
  UNLOCK();
  piVar2 = *(int **)(param_1 + 0x36);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = *(int **)(param_1 + 0x3a);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = *(int **)(param_1 + 0x38);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = *(int **)(param_1 + 0x3e);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = param_1 + 10;
  lVar3 = 6;
  do {
    if ((*(undefined **)(piVar2 + -4) != &DAT_180017ba4) &&
       (piVar1 = *(int **)piVar2, piVar1 != (int *)0x0)) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    if ((*(longlong *)(piVar2 + -6) != 0) && (piVar1 = *(int **)(piVar2 + -2), piVar1 != (int *)0x0)
       ) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    piVar2 = piVar2 + 8;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  LOCK();
  *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
       *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + 1;
  UNLOCK();
  return;
}



void FUN_180007734(LPVOID param_1)

{
  int *piVar1;
  undefined **ppuVar2;
  longlong lVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;
  
  if ((((*(undefined ***)((longlong)param_1 + 0xf0) != (undefined **)0x0) &&
       (*(undefined ***)((longlong)param_1 + 0xf0) != &PTR_DAT_180018270)) &&
      (*(int **)((longlong)param_1 + 0xd8) != (int *)0x0)) &&
     (**(int **)((longlong)param_1 + 0xd8) == 0)) {
    piVar1 = *(int **)((longlong)param_1 + 0xe8);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      FUN_180005dd0(piVar1);
      FUN_180009a10(*(longlong *)((longlong)param_1 + 0xf0));
    }
    piVar1 = *(int **)((longlong)param_1 + 0xe0);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      FUN_180005dd0(piVar1);
      FUN_180009b1c(*(undefined8 **)((longlong)param_1 + 0xf0));
    }
    FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0xd8));
    FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0xf0));
  }
  if ((*(int **)((longlong)param_1 + 0xf8) != (int *)0x0) &&
     (**(int **)((longlong)param_1 + 0xf8) == 0)) {
    FUN_180005dd0((LPVOID)(*(longlong *)((longlong)param_1 + 0x100) + -0xfe));
    FUN_180005dd0((LPVOID)(*(longlong *)((longlong)param_1 + 0x110) + -0x80));
    FUN_180005dd0((LPVOID)(*(longlong *)((longlong)param_1 + 0x118) + -0x80));
    FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0xf8));
  }
  ppuVar2 = *(undefined ***)((longlong)param_1 + 0x120);
  if ((ppuVar2 != &PTR_DAT_180017bb0) && (*(int *)((longlong)ppuVar2 + 0x15c) == 0)) {
    FUN_180009b88(ppuVar2);
    FUN_180005dd0(*(LPVOID *)((longlong)param_1 + 0x120));
  }
  puVar4 = (undefined8 *)((longlong)param_1 + 0x128);
  puVar5 = (undefined8 *)((longlong)param_1 + 0x28);
  lVar3 = 6;
  do {
    if ((((undefined *)puVar5[-2] != &DAT_180017ba4) &&
        (piVar1 = (int *)*puVar5, piVar1 != (int *)0x0)) && (*piVar1 == 0)) {
      FUN_180005dd0(piVar1);
      FUN_180005dd0((LPVOID)*puVar4);
    }
    if (((puVar5[-3] != 0) && (piVar1 = (int *)puVar5[-1], piVar1 != (int *)0x0)) && (*piVar1 == 0))
    {
      FUN_180005dd0(piVar1);
    }
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 4;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  FUN_180005dd0(param_1);
  return;
}



int * FUN_1800078cc(int *param_1)

{
  int *piVar1;
  int *piVar2;
  longlong lVar3;
  
  if (param_1 != (int *)0x0) {
    LOCK();
    *param_1 = *param_1 + -1;
    UNLOCK();
    piVar2 = *(int **)(param_1 + 0x36);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = *(int **)(param_1 + 0x3a);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = *(int **)(param_1 + 0x38);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = *(int **)(param_1 + 0x3e);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = param_1 + 10;
    lVar3 = 6;
    do {
      if ((*(undefined **)(piVar2 + -4) != &DAT_180017ba4) &&
         (piVar1 = *(int **)piVar2, piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
        UNLOCK();
      }
      if ((*(longlong *)(piVar2 + -6) != 0) &&
         (piVar1 = *(int **)(piVar2 + -2), piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
        UNLOCK();
      }
      piVar2 = piVar2 + 8;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    LOCK();
    *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
         *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + -1;
    UNLOCK();
  }
  return param_1;
}



int * FUN_180007970(void)

{
  DWORD *pDVar1;
  int *piVar2;
  
  pDVar1 = FUN_180004ee8();
  if (((pDVar1[0x32] & DAT_180017fd8) == 0) || (*(longlong *)(pDVar1 + 0x30) == 0)) {
    FUN_1800087b8(0xc);
    piVar2 = FUN_1800079e8((undefined8 *)(pDVar1 + 0x30),(int *)PTR_DAT_180017e70);
    FUN_1800089a8(0xc);
  }
  else {
    pDVar1 = FUN_180004ee8();
    piVar2 = *(int **)(pDVar1 + 0x30);
  }
  if (piVar2 == (int *)0x0) {
    FUN_18000529c(0x20);
  }
  return piVar2;
}



int * FUN_1800079e8(undefined8 *param_1,int *param_2)

{
  int *piVar1;
  
  if ((param_2 == (int *)0x0) || (param_1 == (undefined8 *)0x0)) {
    param_2 = (int *)0x0;
  }
  else {
    piVar1 = (int *)*param_1;
    if (piVar1 != param_2) {
      *param_1 = param_2;
      FUN_1800076a8(param_2);
      if (((piVar1 != (int *)0x0) && (FUN_1800078cc(piVar1), *piVar1 == 0)) &&
         (piVar1 != (int *)&DAT_180017e80)) {
        FUN_180007734(piVar1);
      }
    }
  }
  return param_2;
}



undefined8 FUN_180007a4c(void)

{
  if (DAT_18001aa28 == 0) {
    FUN_180007e24(0xfffffffd);
    DAT_18001aa28 = 1;
  }
  return 0;
}



UINT FUN_180007a74(UINT param_1)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180003a94(local_28,(longlong *)0x0);
  DAT_180018fa0 = 0;
  if (param_1 == 0xfffffffe) {
    DAT_180018fa0 = 1;
    param_1 = GetOEMCP();
  }
  else if (param_1 == 0xfffffffd) {
    DAT_180018fa0 = 1;
    param_1 = GetACP();
  }
  else if (param_1 == 0xfffffffc) {
    DAT_180018fa0 = 1;
    param_1 = *(UINT *)(local_28[0] + 4);
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return param_1;
}



void FUN_180007af4(longlong param_1)

{
  longlong lVar1;
  undefined1 *puVar2;
  undefined1 (*pauVar3) [16];
  longlong lVar4;
  undefined2 *puVar5;
  
  pauVar3 = (undefined1 (*) [16])(param_1 + 0x18);
  lVar4 = 0x101;
  FUN_180003b50(pauVar3,0,0x101);
  *(undefined8 *)(param_1 + 4) = 0;
  *(undefined8 *)(param_1 + 0x220) = 0;
  puVar5 = (undefined2 *)(param_1 + 0xc);
  for (lVar1 = 6; lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  do {
    (*pauVar3)[0] = *(undefined1 *)(((longlong)&DAT_180017870 - param_1) + (longlong)pauVar3);
    pauVar3 = (undefined1 (*) [16])(*pauVar3 + 1);
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  puVar2 = (undefined1 *)(param_1 + 0x119);
  lVar1 = 0x100;
  do {
    *puVar2 = puVar2[(longlong)&DAT_180017870 - param_1];
    puVar2 = puVar2 + 1;
    lVar1 = lVar1 + -1;
  } while (lVar1 != 0);
  return;
}



void FUN_180007b84(longlong param_1)

{
  byte bVar1;
  BOOL BVar2;
  uint uVar3;
  CHAR *pCVar4;
  ulonglong uVar5;
  byte *pbVar6;
  BYTE *pBVar7;
  WORD *pWVar8;
  longlong lVar9;
  undefined1 auStackY_588 [32];
  _cpinfo local_538;
  CHAR local_518 [231];
  byte abStack_431 [25];
  undefined1 local_418 [231];
  byte abStack_331 [25];
  undefined1 local_318 [256];
  WORD local_218 [256];
  ulonglong local_18;
  
  local_18 = DAT_1800170a0 ^ (ulonglong)auStackY_588;
  BVar2 = GetCPInfo(*(UINT *)(param_1 + 4),&local_538);
  lVar9 = 0x100;
  if (BVar2 == 0) {
    uVar3 = 0;
    pbVar6 = (byte *)(param_1 + 0x19);
    do {
      if (uVar3 - 0x41 < 0x1a) {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = (char)uVar3 + 0x20;
LAB_180007d29:
        pbVar6[0x100] = bVar1;
      }
      else {
        if (uVar3 - 0x61 < 0x1a) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = (char)uVar3 - 0x20;
          goto LAB_180007d29;
        }
        pbVar6[0x100] = 0;
      }
      uVar3 = uVar3 + 1;
      pbVar6 = pbVar6 + 1;
    } while (uVar3 < 0x100);
  }
  else {
    uVar3 = 0;
    pCVar4 = local_518;
    do {
      *pCVar4 = (CHAR)uVar3;
      uVar3 = uVar3 + 1;
      pCVar4 = pCVar4 + 1;
    } while (uVar3 < 0x100);
    local_518[0] = ' ';
    pBVar7 = local_538.LeadByte;
    while (local_538.LeadByte[0] != 0) {
      bVar1 = pBVar7[1];
      uVar5 = (ulonglong)local_538.LeadByte[0];
      while ((uVar3 = (uint)uVar5, uVar3 <= bVar1 && (uVar3 < 0x100))) {
        local_518[uVar5] = ' ';
        uVar5 = (ulonglong)(uVar3 + 1);
      }
      pBVar7 = pBVar7 + 2;
      local_538.LeadByte[0] = *pBVar7;
    }
    FUN_18000a480((longlong *)0x0,1,local_518,0x100,local_218,*(UINT *)(param_1 + 4),0);
    FUN_18000a270((longlong *)0x0,*(longlong *)(param_1 + 0x220),0x100,local_518,0x100,local_418,
                  0x100,*(UINT *)(param_1 + 4),0);
    FUN_18000a270((longlong *)0x0,*(longlong *)(param_1 + 0x220),0x200,local_518,0x100,local_318,
                  0x100,*(UINT *)(param_1 + 4),0);
    pWVar8 = local_218;
    pbVar6 = (byte *)(param_1 + 0x19);
    do {
      if ((*pWVar8 & 1) == 0) {
        if ((*pWVar8 & 2) != 0) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = pbVar6[(longlong)(abStack_331 + -param_1)];
          goto LAB_180007ce5;
        }
        pbVar6[0x100] = 0;
      }
      else {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = pbVar6[(longlong)(abStack_431 + -param_1)];
LAB_180007ce5:
        pbVar6[0x100] = bVar1;
      }
      pbVar6 = pbVar6 + 1;
      pWVar8 = pWVar8 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
  }
  FUN_180002e10(local_18 ^ (ulonglong)auStackY_588);
  return;
}



int * FUN_180007d68(void)

{
  DWORD *pDVar1;
  int *piVar2;
  
  pDVar1 = FUN_180004ee8();
  if (((pDVar1[0x32] & DAT_180017fd8) == 0) || (*(longlong *)(pDVar1 + 0x30) == 0)) {
    FUN_1800087b8(0xd);
    piVar2 = *(int **)(pDVar1 + 0x2e);
    if (piVar2 != (int *)PTR_DAT_180017b90) {
      if (piVar2 != (int *)0x0) {
        LOCK();
        *piVar2 = *piVar2 + -1;
        UNLOCK();
        if ((*piVar2 == 0) && (piVar2 != &DAT_180017870)) {
          FUN_180005dd0(piVar2);
        }
      }
      *(undefined **)(pDVar1 + 0x2e) = PTR_DAT_180017b90;
      piVar2 = (int *)PTR_DAT_180017b90;
      LOCK();
      *(int *)PTR_DAT_180017b90 = *(int *)PTR_DAT_180017b90 + 1;
      UNLOCK();
    }
    FUN_1800089a8(0xd);
  }
  else {
    piVar2 = *(int **)(pDVar1 + 0x2e);
  }
  if (piVar2 == (int *)0x0) {
    FUN_18000529c(0x20);
  }
  return piVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_180007e24(UINT param_1)

{
  int *piVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  UINT UVar4;
  int iVar5;
  DWORD *pDVar6;
  int *piVar7;
  undefined8 *puVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  longlong lVar12;
  int iVar13;
  
  iVar5 = -1;
  pDVar6 = FUN_180004ee8();
  FUN_180007d68();
  lVar12 = *(longlong *)(pDVar6 + 0x2e);
  UVar4 = FUN_180007a74(param_1);
  if (UVar4 == *(UINT *)(lVar12 + 4)) {
    iVar5 = 0;
  }
  else {
    piVar7 = (int *)FUN_180006640(0x228);
    iVar13 = 0;
    if (piVar7 != (int *)0x0) {
      lVar12 = 4;
      puVar3 = *(undefined8 **)(pDVar6 + 0x2e);
      piVar1 = piVar7;
      do {
        piVar9 = piVar1;
        puVar8 = puVar3;
        uVar2 = puVar8[1];
        *(undefined8 *)piVar9 = *puVar8;
        *(undefined8 *)(piVar9 + 2) = uVar2;
        uVar2 = puVar8[3];
        *(undefined8 *)(piVar9 + 4) = puVar8[2];
        *(undefined8 *)(piVar9 + 6) = uVar2;
        uVar2 = puVar8[5];
        *(undefined8 *)(piVar9 + 8) = puVar8[4];
        *(undefined8 *)(piVar9 + 10) = uVar2;
        uVar2 = puVar8[7];
        *(undefined8 *)(piVar9 + 0xc) = puVar8[6];
        *(undefined8 *)(piVar9 + 0xe) = uVar2;
        uVar2 = puVar8[9];
        *(undefined8 *)(piVar9 + 0x10) = puVar8[8];
        *(undefined8 *)(piVar9 + 0x12) = uVar2;
        uVar2 = puVar8[0xb];
        *(undefined8 *)(piVar9 + 0x14) = puVar8[10];
        *(undefined8 *)(piVar9 + 0x16) = uVar2;
        uVar2 = puVar8[0xd];
        *(undefined8 *)(piVar9 + 0x18) = puVar8[0xc];
        *(undefined8 *)(piVar9 + 0x1a) = uVar2;
        uVar2 = puVar8[0xf];
        *(undefined8 *)(piVar9 + 0x1c) = puVar8[0xe];
        *(undefined8 *)(piVar9 + 0x1e) = uVar2;
        lVar12 = lVar12 + -1;
        puVar3 = puVar8 + 0x10;
        piVar1 = piVar9 + 0x20;
      } while (lVar12 != 0);
      uVar2 = puVar8[0x11];
      *(undefined8 *)(piVar9 + 0x20) = puVar8[0x10];
      *(undefined8 *)(piVar9 + 0x22) = uVar2;
      uVar2 = puVar8[0x13];
      *(undefined8 *)(piVar9 + 0x24) = puVar8[0x12];
      *(undefined8 *)(piVar9 + 0x26) = uVar2;
      *(undefined8 *)(piVar9 + 0x28) = puVar8[0x14];
      *piVar7 = 0;
      iVar5 = FUN_180008068(UVar4,(longlong)piVar7);
      if (iVar5 == 0) {
        piVar1 = *(int **)(pDVar6 + 0x2e);
        LOCK();
        *piVar1 = *piVar1 + -1;
        UNLOCK();
        if ((*piVar1 == 0) && (*(undefined4 **)(pDVar6 + 0x2e) != &DAT_180017870)) {
          FUN_180005dd0(*(undefined4 **)(pDVar6 + 0x2e));
        }
        *(int **)(pDVar6 + 0x2e) = piVar7;
        LOCK();
        *piVar7 = *piVar7 + 1;
        UNLOCK();
        if (((pDVar6[0x32] & 2) == 0) && (((byte)DAT_180017fd8 & 1) == 0)) {
          FUN_1800087b8(0xd);
          _DAT_180018f80 = piVar7[1];
          _DAT_180018f84 = piVar7[2];
          _DAT_180018f98 = *(undefined8 *)(piVar7 + 0x88);
          for (iVar10 = iVar13; iVar11 = iVar13, iVar10 < 5; iVar10 = iVar10 + 1) {
            *(undefined2 *)(&DAT_180018f88 + (longlong)iVar10 * 2) =
                 *(undefined2 *)((longlong)piVar7 + (longlong)iVar10 * 2 + 0xc);
          }
          for (; iVar11 < 0x101; iVar11 = iVar11 + 1) {
            (&DAT_180017660)[iVar11] = *(undefined1 *)((longlong)iVar11 + 0x18 + (longlong)piVar7);
          }
          for (; iVar13 < 0x100; iVar13 = iVar13 + 1) {
            (&DAT_180017770)[iVar13] = *(undefined1 *)((longlong)iVar13 + 0x119 + (longlong)piVar7);
          }
          LOCK();
          iVar13 = *(int *)PTR_DAT_180017b90;
          *(int *)PTR_DAT_180017b90 = *(int *)PTR_DAT_180017b90 + -1;
          UNLOCK();
          if ((iVar13 == 1) && ((undefined4 *)PTR_DAT_180017b90 != &DAT_180017870)) {
            FUN_180005dd0(PTR_DAT_180017b90);
          }
          LOCK();
          PTR_DAT_180017b90 = (undefined *)piVar7;
          *piVar7 = *piVar7 + 1;
          UNLOCK();
          FUN_1800089a8(0xd);
        }
      }
      else if (iVar5 == -1) {
        if (piVar7 != &DAT_180017870) {
          FUN_180005dd0(piVar7);
        }
        pDVar6 = FUN_180003898();
        *pDVar6 = 0x16;
      }
    }
  }
  return iVar5;
}



void FUN_180008068(UINT param_1,longlong param_2)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  UINT CodePage;
  BOOL BVar4;
  UINT *pUVar5;
  byte *pbVar6;
  wchar_t *pwVar7;
  ulonglong uVar8;
  longlong lVar9;
  undefined2 *puVar10;
  BYTE *pBVar11;
  byte *pbVar12;
  uint uVar13;
  uint uVar15;
  byte *pbVar16;
  undefined1 auStack_68 [32];
  _cpinfo local_48;
  ulonglong local_30;
  wchar_t *pwVar14;
  
  local_30 = DAT_1800170a0 ^ (ulonglong)auStack_68;
  CodePage = FUN_180007a74(param_1);
  pwVar7 = (wchar_t *)0x0;
  if (CodePage != 0) {
    pUVar5 = &DAT_180017aa0;
    pwVar14 = pwVar7;
LAB_1800080bc:
    if (*pUVar5 != CodePage) goto code_r0x0001800080c4;
    FUN_180003b50((undefined1 (*) [16])(param_2 + 0x18),0,0x101);
    pbVar16 = &DAT_180017a98;
    lVar9 = 4;
    pbVar6 = &DAT_180017ab0 + (longlong)pwVar14 * 0x30;
    do {
      bVar2 = *pbVar6;
      pbVar12 = pbVar6;
      while ((bVar2 != 0 && (pbVar12[1] != 0))) {
        bVar2 = *pbVar12;
        uVar13 = (uint)bVar2;
        if (bVar2 <= pbVar12[1]) {
          uVar15 = (uint)bVar2;
          do {
            uVar15 = uVar15 + 1;
            if (0x100 < uVar15) break;
            uVar13 = uVar13 + 1;
            pbVar1 = (byte *)((ulonglong)uVar15 + 0x18 + param_2);
            *pbVar1 = *pbVar1 | *pbVar16;
          } while (uVar13 <= pbVar12[1]);
        }
        pbVar12 = pbVar12 + 2;
        bVar2 = *pbVar12;
      }
      pbVar6 = pbVar6 + 8;
      pbVar16 = pbVar16 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
    *(UINT *)(param_2 + 4) = CodePage;
    *(undefined4 *)(param_2 + 8) = 1;
    if (CodePage == 0x3a4) {
      pwVar7 = L"ja-JP";
    }
    else if (CodePage == 0x3a8) {
      pwVar7 = L"zh-CN";
    }
    else if (CodePage == 0x3b5) {
      pwVar7 = L"ko-KR";
    }
    else if (CodePage == 0x3b6) {
      pwVar7 = L"zh-TW";
    }
    *(wchar_t **)(param_2 + 0x220) = pwVar7;
    puVar10 = (undefined2 *)(param_2 + 0xc);
    lVar9 = 6;
    do {
      *puVar10 = *(undefined2 *)
                  (&DAT_180017a98 + ((longlong)pwVar14 * 0x30 - param_2) + (longlong)puVar10);
      puVar10 = puVar10 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
    goto LAB_1800082e6;
  }
LAB_18000809d:
  FUN_180007af4(param_2);
LAB_1800082f0:
  FUN_180002e10(local_30 ^ (ulonglong)auStack_68);
  return;
code_r0x0001800080c4:
  uVar13 = (int)pwVar14 + 1;
  pwVar14 = (wchar_t *)(ulonglong)uVar13;
  pUVar5 = pUVar5 + 0xc;
  if (4 < uVar13) goto code_r0x0001800080d0;
  goto LAB_1800080bc;
code_r0x0001800080d0:
  if ((CodePage - 65000 < 2) || (BVar4 = IsValidCodePage(CodePage & 0xffff), BVar4 == 0))
  goto LAB_1800082f0;
  BVar4 = GetCPInfo(CodePage,&local_48);
  if (BVar4 != 0) {
    FUN_180003b50((undefined1 (*) [16])(param_2 + 0x18),0,0x101);
    *(UINT *)(param_2 + 4) = CodePage;
    *(undefined8 *)(param_2 + 0x220) = 0;
    if (local_48.MaxCharSize < 2) {
      *(undefined4 *)(param_2 + 8) = 0;
    }
    else {
      pBVar11 = local_48.LeadByte;
      while ((local_48.LeadByte[0] != 0 && (pBVar11[1] != 0))) {
        bVar2 = *pBVar11;
        if ((uint)bVar2 <= (uint)pBVar11[1]) {
          pbVar6 = (byte *)(param_2 + 0x18 + (ulonglong)(bVar2 + 1));
          uVar8 = (ulonglong)(((uint)pBVar11[1] - (uint)bVar2) + 1);
          do {
            *pbVar6 = *pbVar6 | 4;
            pbVar6 = pbVar6 + 1;
            uVar8 = uVar8 - 1;
          } while (uVar8 != 0);
        }
        pBVar11 = pBVar11 + 2;
        local_48.LeadByte[0] = *pBVar11;
      }
      pbVar6 = (byte *)(param_2 + 0x1a);
      lVar9 = 0xfe;
      do {
        *pbVar6 = *pbVar6 | 8;
        pbVar6 = pbVar6 + 1;
        lVar9 = lVar9 + -1;
      } while (lVar9 != 0);
      iVar3 = *(int *)(param_2 + 4);
      if (iVar3 == 0x3a4) {
        pwVar7 = L"ja-JP";
      }
      else if (iVar3 == 0x3a8) {
        pwVar7 = L"zh-CN";
      }
      else if (iVar3 == 0x3b5) {
        pwVar7 = L"ko-KR";
      }
      else if (iVar3 == 0x3b6) {
        pwVar7 = L"zh-TW";
      }
      *(wchar_t **)(param_2 + 0x220) = pwVar7;
      *(undefined4 *)(param_2 + 8) = 1;
    }
    puVar10 = (undefined2 *)(param_2 + 0xc);
    for (lVar9 = 6; lVar9 != 0; lVar9 = lVar9 + -1) {
      *puVar10 = 0;
      puVar10 = puVar10 + 1;
    }
LAB_1800082e6:
    FUN_180007b84(param_2);
    goto LAB_1800082f0;
  }
  if (DAT_180018fa0 == 0) goto LAB_1800082f0;
  goto LAB_18000809d;
}



ushort FUN_180008318(uint param_1,longlong *param_2)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180003a94(local_28,param_2);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(param_1 & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1 & 0x8000;
}



ushort FUN_18000835c(uint param_1)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180003a94(local_28,(longlong *)0x0);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(param_1 & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1 & 0x8000;
}



char * FUN_1800083c0(ulonglong *param_1)

{
  ulonglong uVar1;
  ulonglong *puVar2;
  longlong lVar3;
  
  lVar3 = -(longlong)param_1;
  uVar1 = (ulonglong)param_1 & 7;
  while (uVar1 != 0) {
    uVar1 = *param_1;
    param_1 = (ulonglong *)((longlong)param_1 + 1);
    if ((char)uVar1 == '\0') goto LAB_180008438;
    uVar1 = (ulonglong)param_1 & 7;
  }
  do {
    do {
      puVar2 = param_1;
      param_1 = puVar2 + 1;
    } while (((~*puVar2 ^ *puVar2 + 0x7efefefefefefeff) & 0x8101010101010100) == 0);
    uVar1 = *puVar2;
    if ((char)uVar1 == '\0') {
      return (char *)(lVar3 + -8 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 8) == '\0') {
      return (char *)(lVar3 + -7 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x10) == '\0') {
      return (char *)(lVar3 + -6 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x18) == '\0') {
      return (char *)(lVar3 + -5 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x20) == '\0') {
      return (char *)(lVar3 + -4 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x28) == '\0') {
      return (char *)(lVar3 + -3 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x30) == '\0') {
      return (char *)(lVar3 + -2 + (longlong)param_1);
    }
  } while ((char)(uVar1 >> 0x38) != '\0');
LAB_180008438:
  return (char *)(lVar3 + -1 + (longlong)param_1);
}



bool FUN_180008468(void)

{
  return DAT_180018fa8 == (DAT_1800170a0 | 1);
}



DWORD FUN_180008480(int *param_1,undefined1 (*param_2) [16],ulonglong param_3,WCHAR param_4,
                   longlong *param_5)

{
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  DWORD unaff_EBX;
  BOOL local_res10 [2];
  WCHAR local_res20 [4];
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if ((param_2 == (undefined1 (*) [16])0x0) && (param_3 != 0)) {
    if (param_1 == (int *)0x0) {
      return unaff_EBX;
    }
    *param_1 = 0;
    return unaff_EBX;
  }
  if (param_1 != (int *)0x0) {
    *param_1 = -1;
  }
  local_res20[0] = param_4;
  if (0x7fffffff < param_3) {
    pDVar3 = FUN_180003898();
    *pDVar3 = 0x16;
    FUN_1800037cc();
    return unaff_EBX;
  }
  FUN_180003a94(local_28,param_5);
  if (*(longlong *)(local_28[0] + 0x138) == 0) {
    if ((ushort)local_res20[0] < 0x100) {
      if (param_2 != (undefined1 (*) [16])0x0) {
        if (param_3 == 0) goto LAB_1800085f4;
        (*param_2)[0] = (char)local_res20[0];
      }
      if (param_1 != (int *)0x0) {
        *param_1 = 1;
      }
      goto LAB_180008536;
    }
    if ((param_2 != (undefined1 (*) [16])0x0) && (param_3 != 0)) {
      FUN_180003b50(param_2,0,param_3);
    }
  }
  else {
    local_res10[0] = 0;
    iVar1 = WideCharToMultiByte(*(UINT *)(local_28[0] + 4),0,local_res20,1,(LPSTR)param_2,
                                (int)param_3,(LPCSTR)0x0,local_res10);
    if (iVar1 == 0) {
      DVar2 = GetLastError();
      if (DVar2 == 0x7a) {
        if ((param_2 != (undefined1 (*) [16])0x0) && (param_3 != 0)) {
          FUN_180003b50(param_2,0,param_3);
        }
LAB_1800085f4:
        pDVar3 = FUN_180003898();
        *pDVar3 = 0x22;
        FUN_1800037cc();
        goto LAB_180008536;
      }
    }
    else if (local_res10[0] == 0) {
      if (param_1 != (int *)0x0) {
        *param_1 = iVar1;
      }
      goto LAB_180008536;
    }
  }
  pDVar3 = FUN_180003898();
  *pDVar3 = 0x2a;
  FUN_180003898();
LAB_180008536:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return unaff_EBX;
}



void FUN_18000860c(int *param_1,undefined1 (*param_2) [16],ulonglong param_3,WCHAR param_4)

{
  FUN_180008480(param_1,param_2,param_3,param_4,(longlong *)0x0);
  return;
}



void FUN_180008620(void)

{
  undefined *puVar1;
  undefined **ppuVar2;
  uint uVar3;
  
  uVar3 = 0;
  ppuVar2 = &PTR_LAB_180017fe0;
  do {
    puVar1 = (undefined *)EncodePointer(*ppuVar2);
    uVar3 = uVar3 + 1;
    *ppuVar2 = puVar1;
    ppuVar2 = ppuVar2 + 1;
  } while (uVar3 < 10);
  return;
}



undefined4 FUN_18000865c(LPWSTR param_1,byte *param_2,ulonglong param_3,longlong *param_4)

{
  ushort uVar1;
  int iVar2;
  undefined6 extraout_var;
  DWORD *pDVar3;
  undefined4 uVar4;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if ((param_2 != (byte *)0x0) && (param_3 != 0)) {
    if (*param_2 != 0) {
      FUN_180003a94(local_28,param_4);
      if (*(longlong *)(local_28[0] + 0x138) == 0) {
        if (param_1 != (LPWSTR)0x0) {
          *param_1 = (ushort)*param_2;
        }
        uVar4 = 1;
      }
      else {
        uVar1 = FUN_180008318((uint)*param_2,local_28);
        uVar4 = 1;
        if ((int)CONCAT62(extraout_var,uVar1) == 0) {
          iVar2 = MultiByteToWideChar(*(UINT *)(local_28[0] + 4),9,(LPCSTR)param_2,1,param_1,
                                      (uint)(param_1 != (LPWSTR)0x0));
          if (iVar2 != 0) goto LAB_180008793;
        }
        else {
          iVar2 = *(int *)(local_28[0] + 0xd4);
          if ((((1 < iVar2) && (iVar2 <= (int)param_3)) &&
              (iVar2 = MultiByteToWideChar(*(UINT *)(local_28[0] + 4),9,(LPCSTR)param_2,iVar2,
                                           param_1,(uint)(param_1 != (LPWSTR)0x0)), iVar2 != 0)) ||
             (((ulonglong)(longlong)*(int *)(local_28[0] + 0xd4) <= param_3 && (param_2[1] != 0))))
          {
            uVar4 = *(undefined4 *)(local_28[0] + 0xd4);
            goto LAB_180008793;
          }
        }
        pDVar3 = FUN_180003898();
        uVar4 = 0xffffffff;
        *pDVar3 = 0x2a;
      }
LAB_180008793:
      if (local_10 == '\0') {
        return uVar4;
      }
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
      return uVar4;
    }
    if (param_1 != (LPWSTR)0x0) {
      *param_1 = L'\0';
    }
  }
  return 0;
}



void FUN_1800087b0(LPWSTR param_1,byte *param_2,ulonglong param_3)

{
  FUN_18000865c(param_1,param_2,param_3,(longlong *)0x0);
  return;
}



void FUN_1800087b8(int param_1)

{
  undefined8 uVar1;
  
  if ((&DAT_180018030)[(longlong)param_1 * 2] == 0) {
    uVar1 = FUN_180008884(param_1);
    if ((int)uVar1 == 0) {
      FUN_18000529c(0x11);
    }
  }
                    // WARNING: Could not recover jumptable at 0x0001800087f5. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(&DAT_180018030)[(longlong)param_1 * 2]);
  return;
}



void FUN_1800087fc(void)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined8 *puVar1;
  int *piVar2;
  longlong lVar3;
  longlong lVar4;
  
  lVar4 = 0x24;
  puVar1 = &DAT_180018030;
  lVar3 = 0x24;
  do {
    lpCriticalSection = (LPCRITICAL_SECTION)*puVar1;
    if ((lpCriticalSection != (LPCRITICAL_SECTION)0x0) && (*(int *)(puVar1 + 1) != 1)) {
      DeleteCriticalSection(lpCriticalSection);
      FUN_180005dd0(lpCriticalSection);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 2;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  piVar2 = &DAT_180018038;
  do {
    if ((*(LPCRITICAL_SECTION *)(piVar2 + -2) != (LPCRITICAL_SECTION)0x0) && (*piVar2 == 1)) {
      DeleteCriticalSection(*(LPCRITICAL_SECTION *)(piVar2 + -2));
    }
    piVar2 = piVar2 + 4;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return;
}



undefined8 FUN_180008884(int param_1)

{
  LPCRITICAL_SECTION p_Var1;
  DWORD *pDVar2;
  longlong lVar3;
  
  lVar3 = (longlong)param_1;
  if (DAT_180018c60 == 0) {
    FUN_1800089c0();
    FUN_180008a34(0x1e);
    FUN_18000513c(0xff);
  }
  if ((&DAT_180018030)[lVar3 * 2] == 0) {
    p_Var1 = (LPCRITICAL_SECTION)FUN_180006640(0x28);
    if (p_Var1 == (LPCRITICAL_SECTION)0x0) {
      pDVar2 = FUN_180003898();
      *pDVar2 = 0xc;
      return 0;
    }
    FUN_1800087b8(10);
    if ((&DAT_180018030)[lVar3 * 2] == 0) {
      FUN_180006104(p_Var1,4000);
      (&DAT_180018030)[lVar3 * 2] = p_Var1;
    }
    else {
      FUN_180005dd0(p_Var1);
    }
    LeaveCriticalSection(DAT_1800180d0);
  }
  return 1;
}



undefined4 FUN_180008944(void)

{
  longlong lVar1;
  undefined8 *puVar2;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  puVar2 = &DAT_180018030;
  lVar4 = 0x24;
  do {
    if (*(int *)(puVar2 + 1) == 1) {
      lVar1 = (longlong)iVar3;
      iVar3 = iVar3 + 1;
      *puVar2 = (LPCRITICAL_SECTION)(&DAT_180018fb0 + lVar1 * 0x28);
      FUN_180006104((LPCRITICAL_SECTION)(&DAT_180018fb0 + lVar1 * 0x28),4000);
    }
    puVar2 = puVar2 + 2;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return 1;
}



void FUN_1800089a8(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x0001800089b9. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(&DAT_180018030)[(longlong)param_1 * 2]);
  return;
}



void FUN_1800089c0(void)

{
  int iVar1;
  
  iVar1 = FUN_18000a79c(3);
  if (iVar1 != 1) {
    iVar1 = FUN_18000a79c(3);
    if (iVar1 != 0) {
      return;
    }
    if (DAT_1800191e0 != 1) {
      return;
    }
  }
  FUN_180008a34(0xfc);
  FUN_180008a34(0xff);
  return;
}



undefined * FUN_180008a04(int param_1)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = &DAT_180010b40;
  do {
    if (param_1 == *piVar2) {
      return (&PTR_u_R6002___floating_point_support_n_180010b48)[(longlong)(int)uVar1 * 2];
    }
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 4;
  } while (uVar1 < 0x17);
  return (undefined *)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180008a34(int param_1)

{
  code *pcVar1;
  int iVar2;
  DWORD DVar3;
  short *psVar4;
  longlong lVar5;
  HANDLE hFile;
  char *pcVar6;
  ulonglong *puVar7;
  uint uVar8;
  undefined1 auStackY_268 [32];
  DWORD local_238 [4];
  ulonglong local_228 [62];
  undefined1 local_35;
  ulonglong local_28;
  
  local_28 = DAT_1800170a0 ^ (ulonglong)auStackY_268;
  psVar4 = (short *)FUN_180008a04(param_1);
  uVar8 = 0;
  if (psVar4 != (short *)0x0) {
    iVar2 = FUN_18000a79c(3);
    if (iVar2 != 1) {
      iVar2 = FUN_18000a79c(3);
      if ((iVar2 != 0) || (DAT_1800191e0 != 1)) {
        if (param_1 != 0xfc) {
          iVar2 = FUN_180002b70((undefined2 *)&DAT_1800191f0,0x314,L"Runtime Error!\n\nProgram: ");
          if (iVar2 != 0) {
            FUN_1800037ec();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          _DAT_18001942a = 0;
          DVar3 = GetModuleFileNameW((HMODULE)0x0,(LPWSTR)&DAT_180019222,0x104);
          if (DVar3 == 0) {
            iVar2 = FUN_180002b70((undefined2 *)&DAT_180019222,0x2fb,L"<program name unknown>");
            if (iVar2 != 0) {
              FUN_1800037ec();
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          lVar5 = FUN_18000a6b4((short *)&DAT_180019222);
          if (0x3c < lVar5 + 1U) {
            lVar5 = FUN_18000a6b4((short *)&DAT_180019222);
            iVar2 = FUN_18000a6d0((short *)(&DAT_1800191ac + lVar5 * 2),
                                  0x2fb - (lVar5 * 2 + -0x76 >> 1),(short *)&DAT_180011648,3);
            if (iVar2 != 0) {
              FUN_1800037ec();
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          iVar2 = FUN_18000a62c((short *)&DAT_1800191f0,0x314,(short *)&DAT_180011650);
          if (iVar2 != 0) {
            FUN_1800037ec();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          iVar2 = FUN_18000a62c((short *)&DAT_1800191f0,0x314,psVar4);
          if (iVar2 != 0) {
            FUN_1800037ec();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          FUN_18000a7dc((LPCWSTR)&DAT_1800191f0,L"Microsoft Visual C++ Runtime Library",0x12010);
        }
        goto LAB_180008c0f;
      }
    }
    hFile = GetStdHandle(0xfffffff4);
    if ((longlong)hFile - 1U < 0xfffffffffffffffe) {
      puVar7 = local_228;
      do {
        *(char *)puVar7 = (char)*psVar4;
        if (*psVar4 == 0) break;
        uVar8 = uVar8 + 1;
        puVar7 = (ulonglong *)((longlong)puVar7 + 1);
        psVar4 = psVar4 + 1;
      } while (uVar8 < 500);
      local_35 = 0;
      pcVar6 = FUN_1800083c0(local_228);
      WriteFile(hFile,local_228,(DWORD)pcVar6,local_238,(LPOVERLAPPED)0x0);
    }
  }
LAB_180008c0f:
  FUN_180002e10(local_28 ^ (ulonglong)auStackY_268);
  return;
}



longlong FUN_180008cb0(longlong param_1,ulonglong param_2)

{
  longlong lVar1;
  longlong lVar2;
  uint uVar3;
  
  uVar3 = 0;
  lVar2 = *(int *)(param_1 + 0x3c) + param_1;
  lVar1 = (ulonglong)*(ushort *)(lVar2 + 0x14) + 0x18 + lVar2;
  if (*(ushort *)(lVar2 + 6) != 0) {
    do {
      if ((*(uint *)(lVar1 + 0xc) <= param_2) &&
         (param_2 < *(int *)(lVar1 + 8) + *(uint *)(lVar1 + 0xc))) {
        return lVar1;
      }
      uVar3 = uVar3 + 1;
      lVar1 = lVar1 + 0x28;
    } while (uVar3 < *(ushort *)(lVar2 + 6));
  }
  return 0;
}



ulonglong FUN_180008d00(longlong param_1)

{
  bool bVar1;
  undefined7 extraout_var;
  ulonglong uVar2;
  
  bVar1 = FUN_180008d50((short *)&IMAGE_DOS_HEADER_180000000);
  uVar2 = CONCAT71(extraout_var,bVar1);
  if ((int)uVar2 != 0) {
    uVar2 = FUN_180008cb0(0x180000000,param_1 - 0x180000000);
    if (uVar2 != 0) {
      uVar2 = (ulonglong)(~(*(uint *)(uVar2 + 0x24) >> 0x1f) & 1);
    }
  }
  return uVar2;
}



bool FUN_180008d50(short *param_1)

{
  bool bVar1;
  
  if (*param_1 != 0x5a4d) {
    return false;
  }
  bVar1 = false;
  if (*(int *)((longlong)*(int *)(param_1 + 0x1e) + (longlong)param_1) == 0x4550) {
    bVar1 = (short)((int *)((longlong)*(int *)(param_1 + 0x1e) + (longlong)param_1))[6] == 0x20b;
  }
  return bVar1;
}



undefined4 FUN_180008d80(void)

{
  undefined4 uVar1;
  undefined8 *Ptr;
  
  Ptr = (undefined8 *)FUN_1800065c0(0x20,8);
  DAT_18001aa18 = EncodePointer(Ptr);
  DAT_18001aa20 = DAT_18001aa18;
  if (Ptr == (undefined8 *)0x0) {
    uVar1 = 0x18;
  }
  else {
    *Ptr = 0;
    uVar1 = 0;
  }
  return uVar1;
}



PVOID FUN_180008dc4(PVOID param_1)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  PVOID pvVar4;
  ulonglong uVar5;
  PVOID pvVar6;
  
  FUN_180005460();
  puVar1 = (undefined8 *)DecodePointer(DAT_18001aa20);
  puVar2 = (undefined8 *)DecodePointer(DAT_18001aa18);
  if (puVar1 <= puVar2) {
    uVar5 = ((longlong)puVar2 - (longlong)puVar1) + 8;
    if (7 < uVar5) {
      uVar3 = FUN_18000aa50((longlong)puVar1);
      if (uVar3 < uVar5) {
        uVar5 = 0x1000;
        if (uVar3 < 0x1000) {
          uVar5 = uVar3;
        }
        if ((uVar5 + uVar3 < uVar3) ||
           (pvVar4 = FUN_1800066bc(puVar1,uVar5 + uVar3), pvVar4 == (LPVOID)0x0)) {
          pvVar6 = (PVOID)0x0;
          if ((uVar3 + 0x20 < uVar3) ||
             (pvVar4 = FUN_1800066bc(puVar1,uVar3 + 0x20), pvVar4 == (LPVOID)0x0))
          goto LAB_180008eac;
        }
        puVar2 = (undefined8 *)((longlong)pvVar4 + ((longlong)puVar2 - (longlong)puVar1 >> 3) * 8);
        DAT_18001aa20 = EncodePointer(pvVar4);
      }
      pvVar4 = EncodePointer(param_1);
      *puVar2 = pvVar4;
      DAT_18001aa18 = EncodePointer(puVar2 + 1);
      pvVar6 = param_1;
      goto LAB_180008eac;
    }
  }
  pvVar6 = (PVOID)0x0;
LAB_180008eac:
  FUN_18000546c();
  return pvVar6;
}



int FUN_180008ed0(PVOID param_1)

{
  PVOID pvVar1;
  
  pvVar1 = FUN_180008dc4(param_1);
  return (pvVar1 != (PVOID)0x0) - 1;
}



void FUN_180008ee8(void)

{
  code *pcVar1;
  DWORD *pDVar2;
  
  pDVar2 = FUN_180004ee8();
  if (*(code **)(pDVar2 + 0x34) != (code *)0x0) {
    (**(code **)(pDVar2 + 0x34))();
  }
  FUN_18000aa8c();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180008f08(void)

{
  _DAT_180019818 = EncodePointer(FUN_180008ee8);
  return;
}



undefined8 FUN_180008f28(undefined8 param_1)

{
  int iVar1;
  code *pcVar2;
  
  pcVar2 = (code *)DecodePointer(DAT_180019820);
  if ((pcVar2 != (code *)0x0) && (iVar1 = (*pcVar2)(param_1), iVar1 != 0)) {
    return 1;
  }
  return 0;
}



void FUN_180008f5c(undefined8 param_1)

{
  DAT_180019820 = param_1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180008f64(undefined8 param_1)

{
  _DAT_180019828 = param_1;
  return;
}



void FUN_180008f6c(void)

{
                    // WARNING: Could not recover jumptable at 0x000180008f73. Too many branches
                    // WARNING: Treating indirect jump as call
  DecodePointer(DAT_180019840);
  return;
}



void FUN_180008f7c(undefined8 param_1)

{
  DAT_180019830 = param_1;
  DAT_180019838 = param_1;
  DAT_180019840 = param_1;
  DAT_180019848 = param_1;
  return;
}



undefined8 FUN_180008f9c(uint param_1)

{
  ulonglong uVar1;
  bool bVar2;
  DWORD *pDVar3;
  code *pcVar4;
  undefined8 uVar5;
  PVOID pvVar6;
  ulonglong uVar7;
  int iVar8;
  undefined8 *puVar9;
  DWORD local_res10;
  
  uVar5 = 0;
  local_res10 = 0;
  bVar2 = false;
  pDVar3 = (DWORD *)0x0;
  if (param_1 == 2) {
    puVar9 = &DAT_180019830;
    pvVar6 = DAT_180019830;
    goto LAB_1800090a2;
  }
  if (param_1 == 4) {
LAB_180009037:
    pDVar3 = FUN_180004f0c();
    if (pDVar3 == (DWORD *)0x0) {
      return 0xffffffff;
    }
    uVar1 = *(ulonglong *)(pDVar3 + 0x28);
    uVar7 = uVar1;
    do {
      if (*(uint *)(uVar7 + 4) == param_1) break;
      uVar7 = uVar7 + 0x10;
    } while (uVar7 < uVar1 + 0xc0);
    if ((uVar1 + 0xc0 <= uVar7) || (*(uint *)(uVar7 + 4) != param_1)) {
      uVar7 = 0;
    }
    puVar9 = (undefined8 *)(uVar7 + 8);
    pcVar4 = (code *)*puVar9;
  }
  else {
    if (param_1 == 6) {
LAB_180009027:
      puVar9 = &DAT_180019840;
      pvVar6 = DAT_180019840;
    }
    else {
      if ((param_1 == 8) || (param_1 == 0xb)) goto LAB_180009037;
      if (param_1 == 0xf) {
        puVar9 = &DAT_180019848;
        pvVar6 = DAT_180019848;
      }
      else {
        if (param_1 != 0x15) {
          if (param_1 != 0x16) {
            pDVar3 = FUN_180003898();
            *pDVar3 = 0x16;
            FUN_1800037cc();
            return 0xffffffff;
          }
          goto LAB_180009027;
        }
        puVar9 = &DAT_180019838;
        pvVar6 = DAT_180019838;
      }
    }
LAB_1800090a2:
    bVar2 = true;
    pcVar4 = (code *)DecodePointer(pvVar6);
  }
  if (pcVar4 == (code *)0x1) {
    return 0;
  }
  if (pcVar4 == (code *)0x0) {
    FUN_18000536c(3);
    pcVar4 = (code *)swi(3);
    uVar5 = (*pcVar4)();
    return uVar5;
  }
  if (bVar2) {
    FUN_1800087b8(0);
  }
  if ((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) {
    uVar5 = *(undefined8 *)(pDVar3 + 0x2a);
    pDVar3[0x2a] = 0;
    pDVar3[0x2b] = 0;
    if (param_1 == 8) {
      local_res10 = pDVar3[0x2c];
      pDVar3[0x2c] = 0x8c;
      goto LAB_18000911a;
    }
  }
  else {
LAB_18000911a:
    if (param_1 == 8) {
      for (iVar8 = 3; iVar8 < 0xc; iVar8 = iVar8 + 1) {
        *(undefined8 *)(*(longlong *)(pDVar3 + 0x28) + 8 + (longlong)iVar8 * 0x10) = 0;
      }
      goto LAB_180009163;
    }
  }
  pvVar6 = EncodePointer((PVOID)0x0);
  *puVar9 = pvVar6;
LAB_180009163:
  if (bVar2) {
    FUN_1800089a8(0);
  }
  if (param_1 == 8) {
    (*pcVar4)(8,pDVar3[0x2c]);
  }
  else {
    (*pcVar4)(param_1);
  }
  if (((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) &&
     (*(undefined8 *)(pDVar3 + 0x2a) = uVar5, param_1 == 8)) {
    pDVar3[0x2c] = local_res10;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1800091d0(undefined8 param_1)

{
  _DAT_180019858 = param_1;
  return;
}



void FUN_1800091f0(PVOID param_1,PVOID param_2)

{
  RtlUnwindEx(param_1,param_2,(PEXCEPTION_RECORD)0x0,(PVOID)0x0,(PCONTEXT)&stack0xfffffffffffffb28,
              (PUNWIND_HISTORY_TABLE)0x0);
  return;
}



void FUN_180009220(void)

{
  FUN_180009240();
  return;
}



void FUN_180009240(void)

{
  return;
}



void FUN_180009250(void)

{
  return;
}



uint FUN_180009254(longlong *param_1,uint param_2,uint param_3,byte param_4)

{
  uint uVar1;
  longlong local_28;
  longlong local_20;
  longlong local_18;
  char local_10;
  
  FUN_180003a94(&local_28,param_1);
  if ((*(byte *)((ulonglong)(param_2 & 0xff) + 0x19 + local_20) & param_4) == 0) {
    if (param_3 == 0) {
      uVar1 = 0;
    }
    else {
      uVar1 = *(ushort *)(*(longlong *)(local_28 + 0x108) + (ulonglong)(param_2 & 0xff) * 2) &
              param_3;
    }
    if (uVar1 == 0) goto LAB_1800092aa;
  }
  uVar1 = 1;
LAB_1800092aa:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1;
}



void FUN_1800092d0(uint param_1)

{
  FUN_180009254((longlong *)0x0,param_1,0,4);
  return;
}



LPVOID FUN_1800092e4(ulonglong param_1)

{
  LPVOID pvVar1;
  undefined8 uVar2;
  DWORD *pDVar3;
  SIZE_T dwBytes;
  
  if (param_1 < 0xffffffffffffffe1) {
    dwBytes = 1;
    if (param_1 != 0) {
      dwBytes = param_1;
    }
    do {
      if (DAT_180018c60 == (HANDLE)0x0) {
        FUN_1800089c0();
        FUN_180008a34(0x1e);
        FUN_18000513c(0xff);
      }
      pvVar1 = HeapAlloc(DAT_180018c60,0,dwBytes);
      if (pvVar1 != (LPVOID)0x0) {
        return pvVar1;
      }
      if (DAT_1800198b0 == 0) {
        pDVar3 = FUN_180003898();
        *pDVar3 = 0xc;
        break;
      }
      uVar2 = FUN_180008f28(param_1);
    } while ((int)uVar2 != 0);
    pDVar3 = FUN_180003898();
    *pDVar3 = 0xc;
  }
  else {
    FUN_180008f28(param_1);
    pDVar3 = FUN_180003898();
    *pDVar3 = 0xc;
  }
  return (LPVOID)0x0;
}



LPVOID FUN_18000939c(LPVOID param_1,ulonglong param_2)

{
  DWORD DVar1;
  LPVOID pvVar2;
  undefined8 uVar3;
  DWORD *pDVar4;
  
  if (param_1 == (LPVOID)0x0) {
    pvVar2 = FUN_1800092e4(param_2);
  }
  else {
    if (param_2 == 0) {
      FUN_180005dd0(param_1);
    }
    else {
      if (param_2 < 0xffffffffffffffe1) {
        do {
          if (param_2 == 0) {
            param_2 = 1;
          }
          pvVar2 = HeapReAlloc(DAT_180018c60,0,param_1,param_2);
          if (pvVar2 != (LPVOID)0x0) {
            return pvVar2;
          }
          if (DAT_1800198b0 == 0) {
            pDVar4 = FUN_180003898();
            DVar1 = GetLastError();
            DVar1 = FUN_1800038b8(DVar1);
            *pDVar4 = DVar1;
            return (LPVOID)0x0;
          }
          uVar3 = FUN_180008f28(param_2);
          if ((int)uVar3 == 0) {
            pDVar4 = FUN_180003898();
            DVar1 = GetLastError();
            DVar1 = FUN_1800038b8(DVar1);
            *pDVar4 = DVar1;
            goto LAB_180009428;
          }
        } while (param_2 < 0xffffffffffffffe1);
      }
      FUN_180008f28(param_2);
      pDVar4 = FUN_180003898();
      *pDVar4 = 0xc;
    }
LAB_180009428:
    pvVar2 = (LPVOID)0x0;
  }
  return pvVar2;
}



LPVOID FUN_180009470(ulonglong param_1,ulonglong param_2,undefined4 *param_3)

{
  DWORD *pDVar1;
  LPVOID pvVar2;
  undefined8 uVar3;
  ulonglong dwBytes;
  
  if ((param_1 == 0) || (param_2 <= 0xffffffffffffffe0 / param_1)) {
    dwBytes = param_2 * param_1;
    if (dwBytes == 0) {
      dwBytes = 1;
    }
    do {
      pvVar2 = (LPVOID)0x0;
      if ((dwBytes < 0xffffffffffffffe1) &&
         (pvVar2 = HeapAlloc(DAT_180018c60,8,dwBytes), pvVar2 != (LPVOID)0x0)) {
        return pvVar2;
      }
      if (DAT_1800198b0 == 0) {
        if (param_3 == (undefined4 *)0x0) {
          return pvVar2;
        }
        *param_3 = 0xc;
        return pvVar2;
      }
      uVar3 = FUN_180008f28(dwBytes);
    } while ((int)uVar3 != 0);
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = 0xc;
    }
  }
  else {
    pDVar1 = FUN_180003898();
    *pDVar1 = 0xc;
  }
  return (LPVOID)0x0;
}



int FUN_18000950c(void)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  int iVar5;
  
  iVar5 = 0;
  FUN_1800087b8(1);
  for (iVar3 = 3; iVar3 < DAT_1800198c8; iVar3 = iVar3 + 1) {
    lVar4 = (longlong)iVar3;
    piVar1 = *(int **)(DAT_1800198c0 + lVar4 * 8);
    if (piVar1 != (int *)0x0) {
      if ((*(byte *)(piVar1 + 6) & 0x83) != 0) {
        iVar2 = FUN_18000ad08(piVar1);
        if (iVar2 != -1) {
          iVar5 = iVar5 + 1;
        }
      }
      if (0x13 < iVar3) {
        DeleteCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(DAT_1800198c0 + lVar4 * 8) + 0x30))
        ;
        FUN_180005dd0(*(LPVOID *)(DAT_1800198c0 + lVar4 * 8));
        *(undefined8 *)(DAT_1800198c0 + lVar4 * 8) = 0;
      }
    }
  }
  FUN_1800089a8(1);
  return iVar5;
}



ulonglong FUN_1800095b4(int *param_1)

{
  int iVar1;
  uint uVar2;
  DWORD DVar3;
  undefined4 extraout_var;
  undefined8 uVar4;
  ulonglong uVar5;
  
  if (param_1 == (int *)0x0) {
    iVar1 = FUN_180009688(0);
    return CONCAT44(extraout_var,iVar1);
  }
  uVar4 = FUN_180009600(param_1);
  if ((int)uVar4 == 0) {
    if ((param_1[6] & 0x4000U) == 0) {
      uVar5 = 0;
    }
    else {
      uVar2 = FUN_180006b78((longlong)param_1);
      DVar3 = FUN_18000ad70(uVar2);
      uVar5 = (ulonglong)-(uint)(DVar3 != 0);
    }
  }
  else {
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



undefined8 FUN_180009600(int *param_1)

{
  uint uVar1;
  undefined8 uVar2;
  uint uVar3;
  
  uVar2 = 0;
  if (((((byte)param_1[6] & 3) == 2) && ((param_1[6] & 0x108U) != 0)) &&
     (uVar3 = *param_1 - param_1[4], 0 < (int)uVar3)) {
    uVar1 = FUN_180006b78((longlong)param_1);
    uVar1 = FUN_180006c00(uVar1,*(WCHAR **)(param_1 + 4),uVar3);
    if (uVar1 == uVar3) {
      uVar2 = 0;
      if ((char)param_1[6] < '\0') {
        param_1[6] = param_1[6] & 0xfffffffd;
      }
    }
    else {
      param_1[6] = param_1[6] | 0x20;
      uVar2 = 0xffffffff;
    }
  }
  param_1[2] = 0;
  *(undefined8 *)param_1 = *(undefined8 *)(param_1 + 4);
  return uVar2;
}



void FUN_18000967c(void)

{
  FUN_180009688(1);
  return;
}



int FUN_180009688(int param_1)

{
  longlong lVar1;
  int *piVar2;
  ulonglong uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  
  iVar5 = 0;
  iVar6 = 0;
  FUN_1800087b8(1);
  for (iVar4 = 0; iVar4 < DAT_1800198c8; iVar4 = iVar4 + 1) {
    lVar7 = (longlong)iVar4;
    lVar1 = *(longlong *)(DAT_1800198c0 + lVar7 * 8);
    if ((lVar1 != 0) && ((*(byte *)(lVar1 + 0x18) & 0x83) != 0)) {
      FUN_180006ad4(iVar4,lVar1);
      piVar2 = *(int **)(DAT_1800198c0 + lVar7 * 8);
      if ((*(byte *)(piVar2 + 6) & 0x83) != 0) {
        if (param_1 == 1) {
          uVar3 = FUN_1800095b4(piVar2);
          if ((int)uVar3 != -1) {
            iVar5 = iVar5 + 1;
          }
        }
        else if (((param_1 == 0) && ((*(byte *)(piVar2 + 6) & 2) != 0)) &&
                (uVar3 = FUN_1800095b4(piVar2), (int)uVar3 == -1)) {
          iVar6 = -1;
        }
      }
      FUN_180006b58(iVar4,*(longlong *)(DAT_1800198c0 + lVar7 * 8));
    }
  }
  FUN_1800089a8(1);
  if (param_1 == 1) {
    iVar6 = iVar5;
  }
  return iVar6;
}



undefined8 FUN_180009770(uint param_1)

{
  int *piVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
  lVar2 = (&DAT_180018c70)[(longlong)(int)param_1 >> 5];
  if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
    FUN_1800087b8(10);
    if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
      FUN_180006104((LPCRITICAL_SECTION)(lVar3 + 0x10 + lVar2),4000);
      piVar1 = (int *)(lVar3 + 0xc + lVar2);
      *piVar1 = *piVar1 + 1;
    }
    FUN_1800089a8(10);
  }
  EnterCriticalSection
            ((LPCRITICAL_SECTION)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 0x10 + lVar3));
  return 1;
}



undefined8 FUN_180009808(uint param_1)

{
  DWORD *pDVar1;
  DWORD nStdHandle;
  longlong lVar2;
  
  if ((-1 < (int)param_1) && (param_1 < DAT_18001aa08)) {
    lVar2 = (ulonglong)(param_1 & 0x1f) * 0x58;
    if (((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar2) & 1) != 0) &&
       (*(longlong *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + lVar2) != -1)) {
      if (DAT_1800191e0 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_18000987e;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_18000987e:
      *(undefined8 *)(lVar2 + (&DAT_180018c70)[(longlong)(int)param_1 >> 5]) = 0xffffffffffffffff;
      return 0;
    }
  }
  pDVar1 = FUN_180003898();
  *pDVar1 = 9;
  pDVar1 = FUN_180003828();
  *pDVar1 = 0;
  return 0xffffffff;
}



undefined8 FUN_1800098b4(uint param_1)

{
  DWORD *pDVar1;
  longlong lVar2;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_180003828();
    *pDVar1 = 0;
    pDVar1 = FUN_180003898();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18001aa08)) {
      lVar2 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar2) & 1) != 0) {
        return *(undefined8 *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + lVar2);
      }
    }
    pDVar1 = FUN_180003828();
    *pDVar1 = 0;
    pDVar1 = FUN_180003898();
    *pDVar1 = 9;
    FUN_1800037cc();
  }
  return 0xffffffffffffffff;
}



void FUN_180009928(uint param_1)

{
                    // WARNING: Could not recover jumptable at 0x00018000994b. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((ulonglong)(param_1 & 0x1f) * 0x58 + 0x10 +
             (&DAT_180018c70)[(longlong)(int)param_1 >> 5]));
  return;
}



undefined2 FUN_180009954(undefined2 param_1)

{
  BOOL BVar1;
  undefined2 local_res8 [4];
  DWORD local_res10 [6];
  
  local_res8[0] = param_1;
  if (DAT_180018338 == (HANDLE)0xfffffffffffffffe) {
    FUN_18000ae68();
  }
  if ((DAT_180018338 == (HANDLE)0xffffffffffffffff) ||
     (BVar1 = WriteConsoleW(DAT_180018338,local_res8,1,local_res10,(LPVOID)0x0), BVar1 == 0)) {
    local_res8[0] = 0xffff;
  }
  return local_res8[0];
}



void FUN_1800099c0(void)

{
  undefined1 *in_RAX;
  undefined1 *puVar1;
  undefined1 *puVar2;
  undefined1 local_res8 [32];
  
  puVar1 = local_res8 + -(longlong)in_RAX;
  if (local_res8 < in_RAX) {
    puVar1 = (undefined1 *)0x0;
  }
  if (puVar1 < StackLimit) {
    puVar2 = (undefined1 *)StackLimit;
    do {
      puVar2 = puVar2 + -0x1000;
      *puVar2 = 0;
    } while ((undefined1 *)((ulonglong)puVar1 & 0xfffffffffffff000) != puVar2);
  }
  return;
}



void FUN_180009a10(longlong param_1)

{
  if (param_1 != 0) {
    if (*(undefined **)(param_1 + 0x18) != PTR_DAT_180018288) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x18));
    }
    if (*(undefined **)(param_1 + 0x20) != PTR_DAT_180018290) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x20));
    }
    if (*(undefined **)(param_1 + 0x28) != PTR_DAT_180018298) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x28));
    }
    if (*(undefined **)(param_1 + 0x30) != PTR_DAT_1800182a0) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x30));
    }
    if (*(undefined **)(param_1 + 0x38) != PTR_DAT_1800182a8) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x38));
    }
    if (*(undefined **)(param_1 + 0x40) != PTR_DAT_1800182b0) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x40));
    }
    if (*(undefined **)(param_1 + 0x48) != PTR_DAT_1800182b8) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x48));
    }
    if (*(undefined **)(param_1 + 0x68) != PTR_DAT_1800182d8) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x68));
    }
    if (*(undefined **)(param_1 + 0x70) != PTR_DAT_1800182e0) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x70));
    }
    if (*(undefined **)(param_1 + 0x78) != PTR_DAT_1800182e8) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x78));
    }
    if (*(undefined **)(param_1 + 0x80) != PTR_DAT_1800182f0) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x80));
    }
    if (*(undefined **)(param_1 + 0x88) != PTR_DAT_1800182f8) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x88));
    }
    if (*(undefined **)(param_1 + 0x90) != PTR_DAT_180018300) {
      FUN_180005dd0(*(undefined **)(param_1 + 0x90));
    }
  }
  return;
}



void FUN_180009b1c(undefined8 *param_1)

{
  if (param_1 != (undefined8 *)0x0) {
    if ((undefined *)*param_1 != PTR_DAT_180018270) {
      FUN_180005dd0((undefined *)*param_1);
    }
    if ((undefined *)param_1[1] != PTR_DAT_180018278) {
      FUN_180005dd0((undefined *)param_1[1]);
    }
    if ((undefined *)param_1[2] != PTR_DAT_180018280) {
      FUN_180005dd0((undefined *)param_1[2]);
    }
    if ((undefined *)param_1[0xb] != PTR_DAT_1800182c8) {
      FUN_180005dd0((undefined *)param_1[0xb]);
    }
    if ((undefined *)param_1[0xc] != PTR_DAT_1800182d0) {
      FUN_180005dd0((undefined *)param_1[0xc]);
    }
  }
  return;
}



void FUN_180009b88(undefined8 *param_1)

{
  if (param_1 != (undefined8 *)0x0) {
    FUN_180005dd0((LPVOID)param_1[1]);
    FUN_180005dd0((LPVOID)param_1[2]);
    FUN_180005dd0((LPVOID)param_1[3]);
    FUN_180005dd0((LPVOID)param_1[4]);
    FUN_180005dd0((LPVOID)param_1[5]);
    FUN_180005dd0((LPVOID)param_1[6]);
    FUN_180005dd0((LPVOID)*param_1);
    FUN_180005dd0((LPVOID)param_1[8]);
    FUN_180005dd0((LPVOID)param_1[9]);
    FUN_180005dd0((LPVOID)param_1[10]);
    FUN_180005dd0((LPVOID)param_1[0xb]);
    FUN_180005dd0((LPVOID)param_1[0xc]);
    FUN_180005dd0((LPVOID)param_1[0xd]);
    FUN_180005dd0((LPVOID)param_1[7]);
    FUN_180005dd0((LPVOID)param_1[0xe]);
    FUN_180005dd0((LPVOID)param_1[0xf]);
    FUN_180005dd0((LPVOID)param_1[0x10]);
    FUN_180005dd0((LPVOID)param_1[0x11]);
    FUN_180005dd0((LPVOID)param_1[0x12]);
    FUN_180005dd0((LPVOID)param_1[0x13]);
    FUN_180005dd0((LPVOID)param_1[0x14]);
    FUN_180005dd0((LPVOID)param_1[0x15]);
    FUN_180005dd0((LPVOID)param_1[0x16]);
    FUN_180005dd0((LPVOID)param_1[0x17]);
    FUN_180005dd0((LPVOID)param_1[0x18]);
    FUN_180005dd0((LPVOID)param_1[0x19]);
    FUN_180005dd0((LPVOID)param_1[0x1a]);
    FUN_180005dd0((LPVOID)param_1[0x1b]);
    FUN_180005dd0((LPVOID)param_1[0x1c]);
    FUN_180005dd0((LPVOID)param_1[0x1d]);
    FUN_180005dd0((LPVOID)param_1[0x1e]);
    FUN_180005dd0((LPVOID)param_1[0x1f]);
    FUN_180005dd0((LPVOID)param_1[0x20]);
    FUN_180005dd0((LPVOID)param_1[0x21]);
    FUN_180005dd0((LPVOID)param_1[0x22]);
    FUN_180005dd0((LPVOID)param_1[0x23]);
    FUN_180005dd0((LPVOID)param_1[0x24]);
    FUN_180005dd0((LPVOID)param_1[0x25]);
    FUN_180005dd0((LPVOID)param_1[0x26]);
    FUN_180005dd0((LPVOID)param_1[0x27]);
    FUN_180005dd0((LPVOID)param_1[0x28]);
    FUN_180005dd0((LPVOID)param_1[0x29]);
    FUN_180005dd0((LPVOID)param_1[0x2a]);
    FUN_180005dd0((LPVOID)param_1[0x2d]);
    FUN_180005dd0((LPVOID)param_1[0x2e]);
    FUN_180005dd0((LPVOID)param_1[0x2f]);
    FUN_180005dd0((LPVOID)param_1[0x30]);
    FUN_180005dd0((LPVOID)param_1[0x31]);
    FUN_180005dd0((LPVOID)param_1[0x32]);
    FUN_180005dd0((LPVOID)param_1[0x2c]);
    FUN_180005dd0((LPVOID)param_1[0x34]);
    FUN_180005dd0((LPVOID)param_1[0x35]);
    FUN_180005dd0((LPVOID)param_1[0x36]);
    FUN_180005dd0((LPVOID)param_1[0x37]);
    FUN_180005dd0((LPVOID)param_1[0x38]);
    FUN_180005dd0((LPVOID)param_1[0x39]);
    FUN_180005dd0((LPVOID)param_1[0x33]);
    FUN_180005dd0((LPVOID)param_1[0x3a]);
    FUN_180005dd0((LPVOID)param_1[0x3b]);
    FUN_180005dd0((LPVOID)param_1[0x3c]);
    FUN_180005dd0((LPVOID)param_1[0x3d]);
    FUN_180005dd0((LPVOID)param_1[0x3e]);
    FUN_180005dd0((LPVOID)param_1[0x3f]);
    FUN_180005dd0((LPVOID)param_1[0x40]);
    FUN_180005dd0((LPVOID)param_1[0x41]);
    FUN_180005dd0((LPVOID)param_1[0x42]);
    FUN_180005dd0((LPVOID)param_1[0x43]);
    FUN_180005dd0((LPVOID)param_1[0x44]);
    FUN_180005dd0((LPVOID)param_1[0x45]);
    FUN_180005dd0((LPVOID)param_1[0x46]);
    FUN_180005dd0((LPVOID)param_1[0x47]);
    FUN_180005dd0((LPVOID)param_1[0x48]);
    FUN_180005dd0((LPVOID)param_1[0x49]);
    FUN_180005dd0((LPVOID)param_1[0x4a]);
    FUN_180005dd0((LPVOID)param_1[0x4b]);
    FUN_180005dd0((LPVOID)param_1[0x4c]);
    FUN_180005dd0((LPVOID)param_1[0x4d]);
    FUN_180005dd0((LPVOID)param_1[0x4e]);
    FUN_180005dd0((LPVOID)param_1[0x4f]);
    FUN_180005dd0((LPVOID)param_1[0x50]);
    FUN_180005dd0((LPVOID)param_1[0x51]);
    FUN_180005dd0((LPVOID)param_1[0x52]);
    FUN_180005dd0((LPVOID)param_1[0x53]);
    FUN_180005dd0((LPVOID)param_1[0x54]);
    FUN_180005dd0((LPVOID)param_1[0x55]);
    FUN_180005dd0((LPVOID)param_1[0x56]);
    FUN_180005dd0((LPVOID)param_1[0x57]);
  }
  return;
}



void FUN_180009f84(longlong *param_1,longlong param_2,uint param_3,LPCSTR param_4,int param_5,
                  undefined8 param_6,int param_7,UINT param_8,int param_9)

{
  int iVar1;
  char *pcVar2;
  longlong lVar3;
  LPCWSTR pWVar4;
  longlong lVar5;
  LPCWSTR lpWideCharStr;
  undefined1 *puVar6;
  undefined1 *puVar7;
  undefined1 *puVar8;
  int iVar9;
  ulonglong uVar10;
  undefined1 auStackY_78 [32];
  longlong local_38;
  ulonglong local_30;
  
  puVar7 = auStackY_78;
  puVar6 = auStackY_78;
  local_30 = DAT_1800170a0 ^ (ulonglong)&local_38;
  pWVar4 = (LPCWSTR)0x0;
  pcVar2 = param_4;
  iVar9 = param_5;
  if (0 < param_5) {
    do {
      iVar9 = iVar9 + -1;
      if (*pcVar2 == '\0') goto LAB_180009fde;
      pcVar2 = pcVar2 + 1;
    } while (iVar9 != 0);
    iVar9 = -1;
LAB_180009fde:
    iVar1 = (param_5 - iVar9) + -1;
    iVar9 = param_5 - iVar9;
    if (param_5 <= iVar1) {
      iVar9 = iVar1;
    }
  }
  if (param_8 == 0) {
    param_8 = *(UINT *)(*param_1 + 4);
  }
  local_38 = param_2;
  iVar1 = MultiByteToWideChar(param_8,(-(uint)(param_9 != 0) & 8) + 1,param_4,iVar9,(LPWSTR)0x0,0);
  uVar10 = (ulonglong)iVar1;
  if (iVar1 == 0) goto LAB_18000a24a;
  puVar7 = auStackY_78;
  if (((0 < iVar1) && (puVar7 = auStackY_78, 1 < 0xffffffffffffffe0 / uVar10)) &&
     (puVar7 = auStackY_78, uVar10 * 2 < uVar10 * 2 + 0x10)) {
    uVar10 = uVar10 * 2 + 0x10;
    if (uVar10 < 0x401) {
      lVar3 = FUN_1800099c0();
      lVar3 = -lVar3;
      puVar7 = auStackY_78 + lVar3;
      puVar6 = auStackY_78 + lVar3;
      pWVar4 = (LPCWSTR)((longlong)&local_38 + lVar3);
      if (pWVar4 == (LPCWSTR)0x0) goto LAB_18000a24a;
      pWVar4[0] = L'';
      pWVar4[1] = L'\0';
    }
    else {
      pWVar4 = (LPCWSTR)FUN_1800092e4(uVar10);
      puVar7 = auStackY_78;
      if (pWVar4 == (LPCWSTR)0x0) goto LAB_18000a0af;
      pWVar4[0] = L'\xdddd';
      pWVar4[1] = L'\0';
    }
    pWVar4 = pWVar4 + 8;
    puVar7 = puVar6;
  }
LAB_18000a0af:
  if (pWVar4 == (LPCWSTR)0x0) goto LAB_18000a24a;
  *(int *)(puVar7 + 0x28) = iVar1;
  *(LPCWSTR *)(puVar7 + 0x20) = pWVar4;
  *(undefined8 *)(puVar7 + -8) = 0x18000a0d6;
  iVar9 = MultiByteToWideChar(param_8,1,param_4,iVar9,*(LPWSTR *)(puVar7 + 0x20),
                              *(int *)(puVar7 + 0x28));
  lVar3 = local_38;
  puVar8 = puVar7;
  if (iVar9 != 0) {
    *(undefined4 *)(puVar7 + 0x28) = 0;
    *(undefined8 *)(puVar7 + 0x20) = 0;
    *(undefined8 *)(puVar7 + -8) = 0x18000a0fc;
    iVar9 = FUN_18000aba4(lVar3,param_3,pWVar4,iVar1,*(LPWSTR *)(puVar7 + 0x20),
                          *(int *)(puVar7 + 0x28));
    uVar10 = (ulonglong)iVar9;
    if (iVar9 != 0) {
      if ((param_3 & 0x400) == 0) {
        if (((iVar9 < 1) || (0xffffffffffffffe0 / uVar10 < 2)) || (uVar10 * 2 + 0x10 <= uVar10 * 2))
        {
          lpWideCharStr = (LPCWSTR)0x0;
        }
        else {
          uVar10 = uVar10 * 2 + 0x10;
          if (uVar10 < 0x401) {
            *(undefined8 *)(puVar7 + -8) = 0x18000a191;
            lVar5 = FUN_1800099c0();
            lVar5 = -lVar5;
            puVar8 = puVar7 + lVar5;
            lpWideCharStr = (LPCWSTR)(puVar7 + lVar5 + 0x40);
            if (lpWideCharStr == (LPCWSTR)0x0) goto LAB_18000a237;
            lpWideCharStr[0] = L'';
            lpWideCharStr[1] = L'\0';
            puVar7 = puVar7 + lVar5;
          }
          else {
            *(undefined8 *)(puVar7 + -8) = 0x18000a1af;
            lpWideCharStr = (LPCWSTR)FUN_1800092e4(uVar10);
            if (lpWideCharStr == (LPCWSTR)0x0) goto LAB_18000a1c5;
            lpWideCharStr[0] = L'\xdddd';
            lpWideCharStr[1] = L'\0';
          }
          lpWideCharStr = lpWideCharStr + 8;
          puVar8 = puVar7;
        }
LAB_18000a1c5:
        if (lpWideCharStr != (LPCWSTR)0x0) {
          *(int *)(puVar8 + 0x28) = iVar9;
          *(LPCWSTR *)(puVar8 + 0x20) = lpWideCharStr;
          *(undefined8 *)(puVar8 + -8) = 0x18000a1e4;
          iVar1 = FUN_18000aba4(lVar3,param_3,pWVar4,iVar1,*(LPWSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28));
          if (iVar1 != 0) {
            *(undefined8 *)(puVar8 + 0x38) = 0;
            *(undefined8 *)(puVar8 + 0x30) = 0;
            if (param_7 == 0) {
              *(undefined4 *)(puVar8 + 0x28) = 0;
              *(undefined8 *)(puVar8 + 0x20) = 0;
            }
            else {
              *(int *)(puVar8 + 0x28) = param_7;
              *(undefined8 *)(puVar8 + 0x20) = param_6;
            }
            *(undefined8 *)(puVar8 + -8) = 0x18000a224;
            WideCharToMultiByte(param_8,0,lpWideCharStr,iVar9,*(LPSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28),*(LPCSTR *)(puVar8 + 0x30),
                                *(LPBOOL *)(puVar8 + 0x38));
          }
          if (*(int *)(lpWideCharStr + -8) == 0xdddd) {
            *(undefined8 *)(puVar8 + -8) = 0x18000a237;
            FUN_180005dd0(lpWideCharStr + -8);
          }
        }
      }
      else if ((param_7 != 0) && (iVar9 <= param_7)) {
        *(int *)(puVar7 + 0x28) = param_7;
        *(undefined8 *)(puVar7 + 0x20) = param_6;
        *(undefined8 *)(puVar7 + -8) = 0x18000a143;
        FUN_18000aba4(lVar3,param_3,pWVar4,iVar1,*(LPWSTR *)(puVar7 + 0x20),*(int *)(puVar7 + 0x28))
        ;
      }
    }
  }
LAB_18000a237:
  puVar7 = puVar8;
  if (*(int *)(pWVar4 + -8) == 0xdddd) {
    *(undefined8 *)(puVar8 + -8) = 0x18000a248;
    FUN_180005dd0(pWVar4 + -8);
  }
LAB_18000a24a:
  uVar10 = local_30 ^ (ulonglong)&local_38;
  *(undefined8 *)(puVar7 + -8) = 0x18000a256;
  FUN_180002e10(uVar10);
  return;
}



void FUN_18000a270(longlong *param_1,longlong param_2,uint param_3,LPCSTR param_4,int param_5,
                  undefined8 param_6,int param_7,UINT param_8,int param_9)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180003a94(local_28,param_1);
  FUN_180009f84(local_28,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_18000a308(longlong *param_1,DWORD param_2,LPCSTR param_3,int param_4,LPWORD param_5,
                  UINT param_6,int param_7)

{
  ulonglong uVar1;
  int iVar2;
  longlong lVar3;
  undefined1 (*lpSrcStr) [16];
  undefined1 *puVar4;
  undefined1 *puVar5;
  ulonglong uVar6;
  undefined1 auStackY_68 [32];
  ulonglong local_38 [2];
  
  puVar5 = auStackY_68;
  puVar4 = auStackY_68;
  local_38[0] = DAT_1800170a0 ^ (ulonglong)local_38;
  lpSrcStr = (undefined1 (*) [16])0x0;
  if (param_6 == 0) {
    param_6 = *(UINT *)(*param_1 + 4);
  }
  iVar2 = MultiByteToWideChar(param_6,(-(uint)(param_7 != 0) & 8) + 1,param_3,param_4,(LPWSTR)0x0,0)
  ;
  uVar6 = (ulonglong)iVar2;
  if (iVar2 == 0) goto LAB_18000a458;
  puVar5 = auStackY_68;
  if (((0 < iVar2) && (puVar5 = auStackY_68, uVar6 < 0x7ffffffffffffff1)) &&
     (puVar5 = auStackY_68, uVar6 * 2 < uVar6 * 2 + 0x10)) {
    uVar1 = uVar6 * 2 + 0x10;
    if (uVar1 < 0x401) {
      lVar3 = FUN_1800099c0();
      lVar3 = -lVar3;
      puVar5 = auStackY_68 + lVar3;
      puVar4 = auStackY_68 + lVar3;
      lpSrcStr = (undefined1 (*) [16])((longlong)local_38 + lVar3);
      if (lpSrcStr == (undefined1 (*) [16])0x0) goto LAB_18000a458;
      *(undefined4 *)*lpSrcStr = 0xcccc;
    }
    else {
      lpSrcStr = (undefined1 (*) [16])FUN_1800092e4(uVar1);
      puVar5 = auStackY_68;
      if (lpSrcStr == (undefined1 (*) [16])0x0) goto LAB_18000a3f6;
      *(undefined4 *)*lpSrcStr = 0xdddd;
    }
    lpSrcStr = lpSrcStr + 1;
    puVar5 = puVar4;
  }
LAB_18000a3f6:
  if (lpSrcStr != (undefined1 (*) [16])0x0) {
    *(undefined8 *)(puVar5 + -8) = 0x18000a40f;
    FUN_180003b50(lpSrcStr,0,uVar6 * 2);
    *(int *)(puVar5 + 0x28) = iVar2;
    *(undefined1 (**) [16])(puVar5 + 0x20) = lpSrcStr;
    *(undefined8 *)(puVar5 + -8) = 0x18000a42c;
    iVar2 = MultiByteToWideChar(param_6,1,param_3,param_4,*(LPWSTR *)(puVar5 + 0x20),
                                *(int *)(puVar5 + 0x28));
    if (iVar2 != 0) {
      *(undefined8 *)(puVar5 + -8) = 0x18000a443;
      GetStringTypeW(param_2,(LPCWSTR)lpSrcStr,iVar2,param_5);
    }
    if (*(int *)lpSrcStr[-1] == 0xdddd) {
      *(undefined8 *)(puVar5 + -8) = 0x18000a456;
      FUN_180005dd0(lpSrcStr + -1);
    }
  }
LAB_18000a458:
  uVar6 = local_38[0] ^ (ulonglong)local_38;
  *(undefined8 *)(puVar5 + -8) = 0x18000a464;
  FUN_180002e10(uVar6);
  return;
}



void FUN_18000a480(longlong *param_1,DWORD param_2,LPCSTR param_3,int param_4,LPWORD param_5,
                  UINT param_6,int param_7)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180003a94(local_28,param_1);
  FUN_18000a308(local_28,param_2,param_3,param_4,param_5,param_6,param_7);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



ushort FUN_18000a508(int param_1,ushort param_2,longlong *param_3)

{
  ushort uVar1;
  undefined6 extraout_var;
  int iVar2;
  ushort local_res8 [4];
  CHAR local_res20;
  CHAR local_res21;
  undefined1 local_res22;
  longlong local_38 [2];
  longlong local_28;
  char local_20;
  
  FUN_180003a94(local_38,param_3);
  if (param_1 + 1U < 0x101) {
    local_res8[0] = *(ushort *)(*(longlong *)(local_38[0] + 0x108) + (longlong)param_1 * 2);
  }
  else {
    uVar1 = FUN_180008318(param_1 >> 8 & 0xff,local_38);
    iVar2 = 1;
    if ((int)CONCAT62(extraout_var,uVar1) == 0) {
      local_res21 = '\0';
      local_res20 = (CHAR)param_1;
    }
    else {
      local_res22 = 0;
      iVar2 = 2;
      local_res20 = (CHAR)((uint)param_1 >> 8);
      local_res21 = (CHAR)param_1;
    }
    iVar2 = FUN_18000a480(local_38,1,&local_res20,iVar2,local_res8,*(UINT *)(local_38[0] + 4),1);
    if (iVar2 == 0) {
      if (local_20 != '\0') {
        *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
      }
      return 0;
    }
  }
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return local_res8[0] & param_2;
}



void FUN_18000a5e4(void)

{
  if (PTR_DAT_180017e70 != &DAT_180017e80) {
    FUN_1800087b8(0xc);
    PTR_DAT_180017e70 = (undefined *)FUN_1800079e8(&PTR_DAT_180017e70,(int *)&DAT_180017e80);
    FUN_1800089a8(0xc);
  }
  return;
}



DWORD FUN_18000a62c(short *param_1,longlong param_2,short *param_3)

{
  short sVar1;
  DWORD *pDVar2;
  short *psVar3;
  longlong lVar4;
  DWORD DVar5;
  
  if ((param_1 != (short *)0x0) && (param_2 != 0)) {
    psVar3 = param_1;
    if (param_3 == (short *)0x0) {
      *param_1 = 0;
    }
    else {
      do {
        if (*psVar3 == 0) break;
        psVar3 = psVar3 + 1;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        lVar4 = (longlong)psVar3 - (longlong)param_3;
        do {
          sVar1 = *param_3;
          *(short *)(lVar4 + (longlong)param_3) = sVar1;
          param_3 = param_3 + 1;
          if (sVar1 == 0) break;
          param_2 = param_2 + -1;
        } while (param_2 != 0);
        if (param_2 != 0) {
          return 0;
        }
        *param_1 = 0;
        pDVar2 = FUN_180003898();
        DVar5 = 0x22;
        goto LAB_18000a655;
      }
      *param_1 = 0;
    }
  }
  pDVar2 = FUN_180003898();
  DVar5 = 0x16;
LAB_18000a655:
  *pDVar2 = DVar5;
  FUN_1800037cc();
  return DVar5;
}



longlong FUN_18000a6b4(short *param_1)

{
  short sVar1;
  short *psVar2;
  
  psVar2 = param_1;
  do {
    sVar1 = *psVar2;
    psVar2 = psVar2 + 1;
  } while (sVar1 != 0);
  return ((longlong)psVar2 - (longlong)param_1 >> 1) + -1;
}



DWORD FUN_18000a6d0(short *param_1,longlong param_2,short *param_3,longlong param_4)

{
  short sVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  longlong lVar4;
  longlong lVar5;
  short *psVar6;
  
  if (param_4 == 0) {
    if (param_1 == (short *)0x0) {
      if (param_2 == 0) {
        return 0;
      }
    }
    else {
LAB_18000a6f0:
      if (param_2 != 0) {
        if (param_4 == 0) {
          *param_1 = 0;
          return 0;
        }
        if (param_3 != (short *)0x0) {
          lVar4 = param_2;
          if (param_4 == -1) {
            lVar5 = (longlong)param_1 - (longlong)param_3;
            do {
              sVar1 = *param_3;
              *(short *)(lVar5 + (longlong)param_3) = sVar1;
              param_3 = param_3 + 1;
              if (sVar1 == 0) break;
              lVar4 = lVar4 + -1;
            } while (lVar4 != 0);
          }
          else {
            psVar6 = param_1;
            do {
              sVar1 = *(short *)(((longlong)param_3 - (longlong)param_1) + (longlong)psVar6);
              *psVar6 = sVar1;
              psVar6 = psVar6 + 1;
              if ((sVar1 == 0) || (lVar4 = lVar4 + -1, lVar4 == 0)) break;
              param_4 = param_4 + -1;
            } while (param_4 != 0);
            if (param_4 == 0) {
              *psVar6 = 0;
            }
          }
          if (lVar4 != 0) {
            return 0;
          }
          if (param_4 == -1) {
            param_1[param_2 + -1] = 0;
            return 0x50;
          }
          *param_1 = 0;
          pDVar2 = FUN_180003898();
          DVar3 = 0x22;
          goto LAB_18000a711;
        }
        *param_1 = 0;
      }
    }
  }
  else if (param_1 != (short *)0x0) goto LAB_18000a6f0;
  pDVar2 = FUN_180003898();
  DVar3 = 0x16;
LAB_18000a711:
  *pDVar2 = DVar3;
  FUN_1800037cc();
  return DVar3;
}



int FUN_18000a79c(int param_1)

{
  int iVar1;
  int iVar2;
  DWORD *pDVar3;
  
  if ((param_1 < 0) ||
     ((iVar2 = DAT_18001987c, iVar1 = param_1, 2 < param_1 && (iVar1 = DAT_18001987c, param_1 != 3))
     )) {
    pDVar3 = FUN_180003898();
    *pDVar3 = 0x16;
    FUN_1800037cc();
    iVar2 = -1;
    iVar1 = DAT_18001987c;
  }
  DAT_18001987c = iVar1;
  return iVar2;
}



void FUN_18000a7dc(LPCWSTR param_1,undefined8 param_2,uint param_3)

{
  bool bVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  PVOID pvVar5;
  undefined7 extraout_var;
  HMODULE hModule;
  FARPROC pFVar6;
  code *pcVar7;
  code *pcVar8;
  longlong lVar9;
  longlong lVar10;
  undefined1 auStack_88 [32];
  undefined1 *local_68;
  undefined1 local_58 [8];
  undefined1 local_50 [8];
  byte local_48;
  ulonglong local_40;
  
  local_40 = DAT_1800170a0 ^ (ulonglong)auStack_88;
  pvVar5 = EncodePointer((PVOID)0x0);
  lVar10 = 0;
  bVar1 = FUN_180006130();
  if (DAT_180019880 == (PVOID)0x0) {
    hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0x800);
    if (((hModule == (HMODULE)0x0) &&
        ((DVar2 = GetLastError(), DVar2 != 0x57 ||
         (hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0), hModule == (HMODULE)0x0)))) ||
       (pFVar6 = GetProcAddress(hModule,"MessageBoxW"), pFVar6 == (FARPROC)0x0)) goto LAB_18000aa33;
    DAT_180019880 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetActiveWindow");
    DAT_180019888 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetLastActivePopup");
    DAT_180019890 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetUserObjectInformationW");
    DAT_1800198a0 = EncodePointer(pFVar6);
    if (DAT_1800198a0 != (PVOID)0x0) {
      pFVar6 = GetProcAddress(hModule,"GetProcessWindowStation");
      DAT_180019898 = EncodePointer(pFVar6);
    }
  }
  BVar3 = IsDebuggerPresent();
  iVar4 = (int)CONCAT71(extraout_var,bVar1);
  if (BVar3 == 0) {
    if (iVar4 != 0) {
      DecodePointer(DAT_180019880);
      goto LAB_18000aa33;
    }
  }
  else {
    if (param_1 != (LPCWSTR)0x0) {
      OutputDebugStringW(param_1);
    }
    if (iVar4 != 0) goto LAB_18000aa33;
  }
  if ((DAT_180019898 == pvVar5) || (DAT_1800198a0 == pvVar5)) {
LAB_18000a9cf:
    if (((DAT_180019888 != pvVar5) &&
        (((pcVar7 = (code *)DecodePointer(DAT_180019888), pcVar7 != (code *)0x0 &&
          (lVar10 = (*pcVar7)(), lVar10 != 0)) && (DAT_180019890 != pvVar5)))) &&
       (pcVar7 = (code *)DecodePointer(DAT_180019890), pcVar7 != (code *)0x0)) {
      lVar10 = (*pcVar7)(lVar10);
    }
  }
  else {
    pcVar7 = (code *)DecodePointer(DAT_180019898);
    pcVar8 = (code *)DecodePointer(DAT_1800198a0);
    if ((pcVar7 == (code *)0x0) || (pcVar8 == (code *)0x0)) goto LAB_18000a9cf;
    lVar9 = (*pcVar7)();
    if (lVar9 != 0) {
      local_68 = local_58;
      iVar4 = (*pcVar8)(lVar9,1,local_50);
      if ((iVar4 != 0) && ((local_48 & 1) != 0)) goto LAB_18000a9cf;
    }
    param_3 = param_3 | 0x200000;
  }
  pcVar7 = (code *)DecodePointer(DAT_180019880);
  if (pcVar7 != (code *)0x0) {
    (*pcVar7)(lVar10,param_1,param_2,param_3);
  }
LAB_18000aa33:
  FUN_180002e10(local_40 ^ (ulonglong)auStack_88);
  return;
}



undefined8 FUN_18000aa50(longlong param_1)

{
  DWORD *pDVar1;
  undefined8 uVar2;
  
  if (param_1 == 0) {
    pDVar1 = FUN_180003898();
    *pDVar1 = 0x16;
    FUN_1800037cc();
    return 0xffffffffffffffff;
  }
                    // WARNING: Could not recover jumptable at 0x00018000aa82. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar2 = HeapSize(DAT_180018c60,0,param_1);
  return uVar2;
}



void FUN_18000aa8c(void)

{
  code *pcVar1;
  BOOL BVar2;
  longlong lVar3;
  undefined1 *puVar4;
  undefined1 auStack_28 [8];
  undefined1 auStack_20 [32];
  
  puVar4 = auStack_28;
  lVar3 = FUN_180008f6c();
  if (lVar3 != 0) {
    FUN_180008f9c(0x16);
  }
  if ((DAT_180018330 & 2) != 0) {
    BVar2 = IsProcessorFeaturePresent(0x17);
    puVar4 = auStack_28;
    if (BVar2 != 0) {
      pcVar1 = (code *)swi(0x29);
      (*pcVar1)(7);
      puVar4 = auStack_20;
    }
    *(undefined8 *)(puVar4 + -8) = 0x18000aad6;
    FUN_180003668(3,0x40000015,1);
  }
  *(undefined8 *)(puVar4 + -8) = 0x18000aae0;
  FUN_18000536c(3);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined4 FUN_18000aae4(longlong param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  iVar3 = 0xe3;
  do {
    iVar1 = (iVar3 + iVar4) / 2;
    iVar2 = FUN_18000ac34(param_1,(ushort *)(&PTR_DAT_180012e10)[(longlong)iVar1 * 2],0x55);
    if (iVar2 == 0) {
      return *(undefined4 *)(&DAT_180012e18 + (longlong)iVar1 * 0x10);
    }
    if (iVar2 < 0) {
      iVar3 = iVar1 + -1;
    }
    else {
      iVar4 = iVar1 + 1;
    }
  } while (iVar4 <= iVar3);
  return 0xffffffff;
}



undefined4 FUN_18000ab70(longlong param_1)

{
  int iVar1;
  
  if (((param_1 != 0) && (iVar1 = FUN_18000aae4(param_1), -1 < iVar1)) &&
     ((ulonglong)(longlong)iVar1 < 0xe4)) {
    return *(undefined4 *)(&DAT_180011fd0 + (longlong)iVar1 * 0x10);
  }
  return 0;
}



void FUN_18000aba4(longlong param_1,DWORD param_2,LPCWSTR param_3,int param_4,LPWSTR param_5,
                  int param_6)

{
  LCID Locale;
  
  if ((code *)(DAT_18001a9e0 ^ DAT_1800170a0) == (code *)0x0) {
    Locale = FUN_18000ab70(param_1);
    LCMapStringW(Locale,param_2,param_3,param_4,param_5,param_6);
  }
  else {
    (*(code *)(DAT_18001a9e0 ^ DAT_1800170a0))();
  }
  return;
}



int FUN_18000ac34(longlong param_1,ushort *param_2,longlong param_3)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  if (param_3 != 0) {
    lVar4 = param_1 - (longlong)param_2;
    do {
      uVar1 = *(ushort *)(lVar4 + (longlong)param_2);
      if ((ushort)(uVar1 - 0x41) < 0x1a) {
        uVar1 = uVar1 + 0x20;
      }
      uVar2 = *param_2;
      if ((ushort)(uVar2 - 0x41) < 0x1a) {
        uVar2 = uVar2 + 0x20;
      }
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (((param_3 != 0) && (uVar1 != 0)) && (uVar1 == uVar2));
    iVar3 = (uint)uVar1 - (uint)uVar2;
  }
  return iVar3;
}



undefined4 FUN_18000ac8c(int *param_1)

{
  undefined4 uVar1;
  uint uVar2;
  DWORD *pDVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  
  uVar1 = 0xffffffff;
  if (param_1 == (int *)0x0) {
    pDVar3 = FUN_180003898();
    *pDVar3 = 0x16;
    FUN_1800037cc();
    uVar1 = 0xffffffff;
  }
  else {
    if ((*(byte *)(param_1 + 6) & 0x83) != 0) {
      uVar4 = FUN_180009600(param_1);
      uVar1 = (undefined4)uVar4;
      FUN_18000b108((undefined8 *)param_1);
      uVar2 = FUN_180006b78((longlong)param_1);
      uVar5 = FUN_18000af88(uVar2);
      if ((int)uVar5 < 0) {
        uVar1 = 0xffffffff;
      }
      else if (*(LPVOID *)(param_1 + 10) != (LPVOID)0x0) {
        FUN_180005dd0(*(LPVOID *)(param_1 + 10));
        param_1[10] = 0;
        param_1[0xb] = 0;
      }
    }
    param_1[6] = 0;
  }
  return uVar1;
}



undefined4 FUN_18000ad08(int *param_1)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  
  uVar1 = 0xffffffff;
  if (param_1 == (int *)0x0) {
    pDVar2 = FUN_180003898();
    *pDVar2 = 0x16;
    FUN_1800037cc();
    uVar1 = 0xffffffff;
  }
  else if ((*(byte *)(param_1 + 6) & 0x40) == 0) {
    FUN_180006a6c((ulonglong)param_1);
    uVar1 = FUN_18000ac8c(param_1);
    FUN_180006b08((ulonglong)param_1);
  }
  else {
    param_1[6] = 0;
  }
  return uVar1;
}



DWORD FUN_18000ad70(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  HANDLE hFile;
  longlong lVar4;
  
  if (param_1 == 0xfffffffe) {
    pDVar3 = FUN_180003898();
    *pDVar3 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18001aa08)) {
      lVar4 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar4) & 1) != 0) {
        FUN_180009770(param_1);
        if ((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar4) & 1) != 0) {
          hFile = (HANDLE)FUN_1800098b4(param_1);
          BVar1 = FlushFileBuffers(hFile);
          if (BVar1 == 0) {
            DVar2 = GetLastError();
          }
          else {
            DVar2 = 0;
          }
          if (DVar2 == 0) goto LAB_18000ae1b;
          pDVar3 = FUN_180003828();
          *pDVar3 = DVar2;
        }
        pDVar3 = FUN_180003898();
        *pDVar3 = 9;
        DVar2 = 0xffffffff;
LAB_18000ae1b:
        FUN_180009928(param_1);
        return DVar2;
      }
    }
    pDVar3 = FUN_180003898();
    *pDVar3 = 9;
    FUN_1800037cc();
  }
  return 0xffffffff;
}



void FUN_18000ae48(void)

{
  if (1 < (longlong)DAT_180018338 + 2U) {
    CloseHandle(DAT_180018338);
  }
  return;
}



void FUN_18000ae68(void)

{
  DAT_180018338 = CreateFileW(L"CONOUT$",0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  return;
}



int FUN_18000aec0(ulonglong *param_1,longlong param_2,ulonglong param_3)

{
  uint uVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong uVar4;
  bool bVar5;
  
  lVar3 = param_2 - (longlong)param_1;
  if (7 < param_3) {
    uVar4 = (ulonglong)param_1 & 7;
    while (uVar4 != 0) {
      bVar5 = (byte)*param_1 < *(byte *)(lVar3 + (longlong)param_1);
      if ((byte)*param_1 != *(byte *)(lVar3 + (longlong)param_1)) goto LAB_18000af03;
      param_1 = (ulonglong *)((longlong)param_1 + 1);
      param_3 = param_3 - 1;
      uVar4 = (ulonglong)param_1 & 7;
    }
    if (param_3 >> 3 != 0) {
      uVar4 = param_3 >> 5;
      if (uVar4 != 0) {
        do {
          uVar2 = *param_1;
          if (uVar2 != *(ulonglong *)(lVar3 + (longlong)param_1)) goto LAB_18000af74;
          uVar2 = param_1[1];
          if (uVar2 != *(ulonglong *)(lVar3 + 8 + (longlong)param_1)) {
LAB_18000af70:
            param_1 = param_1 + 1;
            goto LAB_18000af74;
          }
          uVar2 = param_1[2];
          if (uVar2 != *(ulonglong *)(lVar3 + 0x10 + (longlong)param_1)) {
LAB_18000af6c:
            param_1 = param_1 + 1;
            goto LAB_18000af70;
          }
          uVar2 = param_1[3];
          if (uVar2 != *(ulonglong *)(lVar3 + 0x18 + (longlong)param_1)) {
            param_1 = param_1 + 1;
            goto LAB_18000af6c;
          }
          param_1 = param_1 + 4;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar4 = param_3 >> 3;
      if (uVar4 != 0) {
        do {
          uVar2 = *param_1;
          if (uVar2 != *(ulonglong *)(lVar3 + (longlong)param_1)) {
LAB_18000af74:
            uVar4 = *(ulonglong *)((longlong)param_1 + lVar3);
            uVar1 = (uint)((uVar2 >> 0x38 | (uVar2 & 0xff000000000000) >> 0x28 |
                            (uVar2 & 0xff0000000000) >> 0x18 | (uVar2 & 0xff00000000) >> 8 |
                            (uVar2 & 0xff000000) << 8 | (uVar2 & 0xff0000) << 0x18 |
                            (uVar2 & 0xff00) << 0x28 | uVar2 << 0x38) <
                          (uVar4 >> 0x38 | (uVar4 & 0xff000000000000) >> 0x28 |
                           (uVar4 & 0xff0000000000) >> 0x18 | (uVar4 & 0xff00000000) >> 8 |
                           (uVar4 & 0xff000000) << 8 | (uVar4 & 0xff0000) << 0x18 |
                           (uVar4 & 0xff00) << 0x28 | uVar4 << 0x38));
            return (1 - uVar1) - (uint)(uVar1 != 0);
          }
          param_1 = param_1 + 1;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        param_3 = param_3 & 7;
      }
    }
  }
  while( true ) {
    if (param_3 == 0) {
      return 0;
    }
    bVar5 = (byte)*param_1 < *(byte *)(lVar3 + (longlong)param_1);
    if ((byte)*param_1 != *(byte *)(lVar3 + (longlong)param_1)) break;
    param_1 = (ulonglong *)((longlong)param_1 + 1);
    param_3 = param_3 - 1;
  }
LAB_18000af03:
  return (1 - (uint)bVar5) - (uint)(bVar5 != 0);
}



ulonglong FUN_18000af88(uint param_1)

{
  DWORD *pDVar1;
  ulonglong uVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_180003828();
    *pDVar1 = 0;
    pDVar1 = FUN_180003898();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18001aa08)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) != 0) {
        FUN_180009770(param_1);
        if ((*(byte *)((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) == 0) {
          pDVar1 = FUN_180003898();
          *pDVar1 = 9;
          uVar2 = 0xffffffff;
        }
        else {
          uVar2 = FUN_18000b04c(param_1);
          uVar2 = uVar2 & 0xffffffff;
        }
        FUN_180009928(param_1);
        return uVar2;
      }
    }
    pDVar1 = FUN_180003828();
    *pDVar1 = 0;
    pDVar1 = FUN_180003898();
    *pDVar1 = 9;
    FUN_1800037cc();
  }
  return 0xffffffff;
}



undefined8 FUN_18000b04c(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  longlong lVar3;
  longlong lVar4;
  HANDLE hObject;
  undefined8 uVar5;
  
  lVar3 = FUN_1800098b4(param_1);
  if (lVar3 != -1) {
    if (((param_1 == 1) && ((*(byte *)(DAT_180018c70 + 0xb8) & 1) != 0)) ||
       ((param_1 == 2 && ((*(byte *)(DAT_180018c70 + 0x60) & 1) != 0)))) {
      lVar3 = FUN_1800098b4(2);
      lVar4 = FUN_1800098b4(1);
      if (lVar4 == lVar3) goto LAB_18000b0bf;
    }
    hObject = (HANDLE)FUN_1800098b4(param_1);
    BVar1 = CloseHandle(hObject);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      goto LAB_18000b0c1;
    }
  }
LAB_18000b0bf:
  DVar2 = 0;
LAB_18000b0c1:
  FUN_180009808(param_1);
  *(undefined1 *)
   ((&DAT_180018c70)[(longlong)(int)param_1 >> 5] + 8 + (ulonglong)(param_1 & 0x1f) * 0x58) = 0;
  if (DVar2 == 0) {
    uVar5 = 0;
  }
  else {
    FUN_180003848(DVar2);
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



void FUN_18000b108(undefined8 *param_1)

{
  if (((*(byte *)(param_1 + 3) & 0x83) != 0) && ((*(byte *)(param_1 + 3) & 8) != 0)) {
    FUN_180005dd0((LPVOID)param_1[2]);
    *(uint *)(param_1 + 3) = *(uint *)(param_1 + 3) & 0xfffffbf7;
    *param_1 = 0;
    param_1[2] = 0;
    *(undefined4 *)(param_1 + 1) = 0;
  }
  return;
}



void FUN_18000b140(uint *param_1,byte *param_2,longlong *param_3,undefined8 *param_4)

{
  undefined1 auStackY_98 [32];
  undefined8 local_58;
  longlong local_50 [2];
  longlong local_40;
  char local_38;
  ushort local_30 [8];
  ulonglong local_20;
  
  local_20 = DAT_1800170a0 ^ (ulonglong)auStackY_98;
  FUN_180003a94(local_50,param_3);
  FUN_18000bee0(local_30,(ushort *)&local_58,param_2,0,0,0,0,local_50);
  if (param_4 != (undefined8 *)0x0) {
    *param_4 = local_58;
  }
  FUN_18000b928(local_30,param_1);
  if (local_38 != '\0') {
    *(uint *)(local_40 + 200) = *(uint *)(local_40 + 200) & 0xfffffffd;
  }
  FUN_180002e10(local_20 ^ (ulonglong)auStackY_98);
  return;
}



void FUN_18000b210(uint *param_1,byte *param_2,longlong *param_3)

{
  undefined1 auStackY_88 [32];
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  ushort local_28 [4];
  ushort local_20 [8];
  ulonglong local_10;
  
  local_10 = DAT_1800170a0 ^ (ulonglong)auStackY_88;
  FUN_180003a94(local_48,param_3);
  FUN_18000bee0(local_20,local_28,param_2,0,0,0,0,local_48);
  FUN_18000b370(local_20,param_1);
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  FUN_180002e10(local_10 ^ (ulonglong)auStackY_88);
  return;
}



void FUN_18000b2d8(uint *param_1,byte *param_2,longlong *param_3)

{
  FUN_18000b140(param_1,param_2,param_3,(undefined8 *)0x0);
  return;
}



void thunk_FUN_18000b2e8(void)

{
  PTR_LAB_180017fe8 = &LAB_18000d1f8;
  PTR_LAB_180017fe0 = FUN_18000c744;
  PTR_LAB_180017ff0 = &LAB_18000d298;
  PTR_LAB_180018008 = FUN_18000c744;
  PTR_LAB_180017ff8 = &LAB_18000d2e0;
  PTR_LAB_180018000 = &LAB_18000d368;
  PTR_LAB_180018010 = FUN_18000c768;
  PTR_LAB_180018018 = FUN_18000d2a0;
  PTR_LAB_180018020 = FUN_18000d200;
  PTR_LAB_180018028 = FUN_18000d2e8;
  return;
}



void FUN_18000b2e8(void)

{
  PTR_LAB_180017fe8 = &LAB_18000d1f8;
  PTR_LAB_180017fe0 = FUN_18000c744;
  PTR_LAB_180017ff0 = &LAB_18000d298;
  PTR_LAB_180018008 = FUN_18000c744;
  PTR_LAB_180017ff8 = &LAB_18000d2e0;
  PTR_LAB_180018000 = &LAB_18000d368;
  PTR_LAB_180018010 = FUN_18000c768;
  PTR_LAB_180018018 = FUN_18000d2a0;
  PTR_LAB_180018020 = FUN_18000d200;
  PTR_LAB_180018028 = FUN_18000d2e8;
  return;
}



void FUN_18000b370(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  uint *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined1 auStack_88 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800170a0 ^ (ulonglong)auStack_88;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_180018360 + -1;
    uVar7 = DAT_180018360 >> 0x1f & 0x1f;
    uVar1 = DAT_180018360 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_18000b491;
        }
      }
      else {
LAB_18000b491:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *puVar13 = *puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_180003b50((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_18001835c - DAT_180018360) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else if (DAT_18001835c < iVar11) {
      uVar10 = DAT_180018364 >> 0x1f & 0x1f;
      iVar15 = DAT_180018364 + uVar10;
      bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
      iVar15 = iVar15 >> 5;
      uVar10 = ~(-1 << (bVar4 & 0x1f));
      if (iVar11 < DAT_180018358) {
        local_40 = local_40 & 0xffffffff7fffffff;
        iVar2 = DAT_18001836c + iVar11;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = *puVar13;
          *puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = puVar13 + 1;
          uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
      }
      else {
        local_40 = 0x80000000;
        local_38 = 0;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = (uint)uVar3;
          uVar3 = (ulonglong)((uVar10 & *puVar13) << (0x20 - bVar4 & 0x1f));
          *puVar13 = *puVar13 >> (bVar4 & 0x1f) | uVar1;
          puVar13 = puVar13 + 1;
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = DAT_18001836c + DAT_180018358;
      }
    }
    else {
      local_40 = local_48;
      local_38 = local_50;
      uVar10 = DAT_18001835c - local_68 >> 0x1f & 0x1f;
      puVar13 = (uint *)&local_40;
      iVar2 = (DAT_18001835c - local_68) + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      uVar6 = uVar3;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
        puVar13 = puVar13 + 1;
        uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar17 = lVar17 + -1;
      } while (lVar17 != 0);
      lVar16 = (longlong)(iVar2 >> 5);
      lVar17 = 2;
      lVar18 = 3;
      lVar5 = 2;
      do {
        if (lVar5 < lVar16) {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
        }
        lVar5 = lVar5 + -1;
      } while (-1 < lVar5);
      uVar1 = local_60 + 1 >> 0x1f & 0x1f;
      uVar10 = local_60 + 1 + uVar1;
      iVar2 = (int)uVar10 >> 5;
      uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
      bVar4 = (byte)uVar10;
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0) {
          for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
            if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_18000b66b;
          }
        }
        else {
LAB_18000b66b:
          uVar10 = local_60 >> 0x1f & 0x1f;
          iVar11 = local_60 + uVar10;
          iVar15 = iVar11 >> 5;
          uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
          uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
          uVar10 = uVar1 + uVar7;
          if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
            uVar6 = uVar9;
          }
          *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
          lVar5 = (longlong)(iVar15 + -1);
          if (-1 < iVar15 + -1) {
            do {
              if ((int)uVar6 == 0) break;
              uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
              uVar10 = uVar1 + 1;
              if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                uVar6 = uVar9;
              }
              *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
              lVar5 = lVar5 + -1;
            } while (-1 < lVar5);
          }
        }
      }
      puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar2 * 4);
      *puVar13 = *puVar13 & -1 << (bVar4 & 0x1f);
      lVar5 = (longlong)(iVar2 + 1);
      if (lVar5 < 3) {
        FUN_180003b50((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
      }
      puVar13 = (uint *)&local_40;
      uVar10 = DAT_180018364 + 1 >> 0x1f & 0x1f;
      iVar2 = DAT_180018364 + 1 + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
        puVar13 = puVar13 + 1;
        uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar18 = lVar18 + -1;
      } while (lVar18 != 0);
      lVar5 = (longlong)(iVar2 >> 5);
      do {
        if (lVar17 < lVar5) {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
        }
        lVar17 = lVar17 + -1;
      } while (-1 < lVar17);
      iVar2 = 0;
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  uVar10 = iVar2 << (0x1fU - (char)DAT_180018364 & 0x1f) | -(uint)bVar19 & 0x80000000 |
           (uint)local_40;
  if (DAT_180018368 == 0x40) {
    local_58[1] = uVar10;
    *local_58 = local_40._4_4_;
  }
  else if (DAT_180018368 == 0x20) {
    *local_58 = uVar10;
  }
  FUN_180002e10(local_30 ^ (ulonglong)auStack_88);
  return;
}



void FUN_18000b928(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  uint *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined1 auStack_88 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800170a0 ^ (ulonglong)auStack_88;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_180018378 + -1;
    uVar7 = DAT_180018378 >> 0x1f & 0x1f;
    uVar1 = DAT_180018378 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_18000ba49;
        }
      }
      else {
LAB_18000ba49:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *puVar13 = *puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_180003b50((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_180018374 - DAT_180018378) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else if (DAT_180018374 < iVar11) {
      uVar10 = DAT_18001837c >> 0x1f & 0x1f;
      iVar15 = DAT_18001837c + uVar10;
      bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
      iVar15 = iVar15 >> 5;
      uVar10 = ~(-1 << (bVar4 & 0x1f));
      if (iVar11 < DAT_180018370) {
        local_40 = local_40 & 0xffffffff7fffffff;
        iVar2 = DAT_180018384 + iVar11;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = *puVar13;
          *puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = puVar13 + 1;
          uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
      }
      else {
        local_40 = 0x80000000;
        local_38 = 0;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = (uint)uVar3;
          uVar3 = (ulonglong)((uVar10 & *puVar13) << (0x20 - bVar4 & 0x1f));
          *puVar13 = *puVar13 >> (bVar4 & 0x1f) | uVar1;
          puVar13 = puVar13 + 1;
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = DAT_180018384 + DAT_180018370;
      }
    }
    else {
      local_40 = local_48;
      local_38 = local_50;
      uVar10 = DAT_180018374 - local_68 >> 0x1f & 0x1f;
      puVar13 = (uint *)&local_40;
      iVar2 = (DAT_180018374 - local_68) + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      uVar6 = uVar3;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
        puVar13 = puVar13 + 1;
        uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar17 = lVar17 + -1;
      } while (lVar17 != 0);
      lVar16 = (longlong)(iVar2 >> 5);
      lVar17 = 2;
      lVar18 = 3;
      lVar5 = 2;
      do {
        if (lVar5 < lVar16) {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
        }
        lVar5 = lVar5 + -1;
      } while (-1 < lVar5);
      uVar1 = local_60 + 1 >> 0x1f & 0x1f;
      uVar10 = local_60 + 1 + uVar1;
      iVar2 = (int)uVar10 >> 5;
      uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
      bVar4 = (byte)uVar10;
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0) {
          for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
            if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_18000bc23;
          }
        }
        else {
LAB_18000bc23:
          uVar10 = local_60 >> 0x1f & 0x1f;
          iVar11 = local_60 + uVar10;
          iVar15 = iVar11 >> 5;
          uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
          uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
          uVar10 = uVar1 + uVar7;
          if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
            uVar6 = uVar9;
          }
          *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
          lVar5 = (longlong)(iVar15 + -1);
          if (-1 < iVar15 + -1) {
            do {
              if ((int)uVar6 == 0) break;
              uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
              uVar10 = uVar1 + 1;
              if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                uVar6 = uVar9;
              }
              *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
              lVar5 = lVar5 + -1;
            } while (-1 < lVar5);
          }
        }
      }
      puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar2 * 4);
      *puVar13 = *puVar13 & -1 << (bVar4 & 0x1f);
      lVar5 = (longlong)(iVar2 + 1);
      if (lVar5 < 3) {
        FUN_180003b50((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
      }
      puVar13 = (uint *)&local_40;
      uVar10 = DAT_18001837c + 1 >> 0x1f & 0x1f;
      iVar2 = DAT_18001837c + 1 + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
        puVar13 = puVar13 + 1;
        uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar18 = lVar18 + -1;
      } while (lVar18 != 0);
      lVar5 = (longlong)(iVar2 >> 5);
      do {
        if (lVar17 < lVar5) {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
        }
        lVar17 = lVar17 + -1;
      } while (-1 < lVar17);
      iVar2 = 0;
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  uVar10 = iVar2 << (0x1fU - (char)DAT_18001837c & 0x1f) | -(uint)bVar19 & 0x80000000 |
           (uint)local_40;
  if (DAT_180018380 == 0x40) {
    local_58[1] = uVar10;
    *local_58 = local_40._4_4_;
  }
  else if (DAT_180018380 == 0x20) {
    *local_58 = uVar10;
  }
  FUN_180002e10(local_30 ^ (ulonglong)auStack_88);
  return;
}



void FUN_18000bee0(ushort *param_1,ushort *param_2,byte *param_3,int param_4,int param_5,int param_6
                  ,int param_7,longlong *param_8)

{
  undefined8 uVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  DWORD *pDVar5;
  byte bVar6;
  ushort uVar7;
  ulonglong uVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  undefined *puVar12;
  ushort *puVar13;
  byte *pbVar14;
  ushort *puVar15;
  ushort uVar16;
  byte *pbVar17;
  uint uVar18;
  uint uVar19;
  uint *puVar20;
  int iVar21;
  uint uVar22;
  char *pcVar23;
  ushort uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  undefined1 auStack_d8 [32];
  int local_b8;
  int local_b4;
  uint local_b0;
  int local_ac;
  ushort *local_a8;
  undefined *local_a0;
  ushort *local_98;
  byte local_90;
  undefined1 uStack_8f;
  undefined4 uStack_8e;
  undefined4 uStack_8a;
  ushort uStack_86;
  undefined4 local_80;
  undefined2 uStack_7c;
  undefined2 uStack_7a;
  undefined4 uStack_78;
  undefined8 local_70;
  undefined4 local_68;
  char local_60 [23];
  char local_49;
  ulonglong local_40;
  
  local_40 = DAT_1800170a0 ^ (ulonglong)auStack_d8;
  uVar9 = 0;
  uVar27 = 0;
  pcVar23 = local_60;
  uVar2 = 0;
  local_b0 = local_b0 & 0xffff0000;
  iVar10 = 0;
  local_b4 = 1;
  local_b8 = 0;
  uVar19 = 0;
  pbVar14 = param_3;
  local_ac = param_4;
  local_a8 = param_2;
  local_98 = param_1;
  if (param_8 == (longlong *)0x0) {
    pDVar5 = FUN_180003898();
    *pDVar5 = 0x16;
    FUN_1800037cc();
    goto LAB_18000c71a;
  }
  while ((uVar22 = uVar9, uVar3 = uVar9, uVar11 = uVar9, uVar18 = uVar9, uVar25 = uVar9,
         *pbVar14 < 0x21 &&
         (uVar22 = 0, uVar3 = 0, uVar11 = 0, uVar18 = 0, uVar25 = 0,
         (0x100002600U >> ((longlong)(char)*pbVar14 & 0x3fU) & 1) != 0))) {
    pbVar14 = pbVar14 + 1;
  }
LAB_18000bf7d:
  do {
    bVar6 = *pbVar14;
    pbVar17 = pbVar14 + 1;
    uVar26 = uVar27;
    if (uVar3 < 6) {
      if (uVar3 == 5) {
        local_b8 = 1;
        pbVar14 = param_3;
        uVar26 = 0;
        if (9 < (byte)(bVar6 - 0x30)) break;
        uVar3 = 4;
      }
      else {
        if (uVar3 != 0) {
          if (uVar3 == 1) {
            uVar22 = 1;
            if ((byte)(bVar6 - 0x31) < 9) {
              uVar3 = 3;
              pbVar14 = param_3;
              goto LAB_18000c0a0;
            }
            if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) {
LAB_18000c084:
              uVar22 = 1;
              uVar3 = 4;
              pbVar14 = pbVar17;
              goto LAB_18000bf7d;
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) goto LAB_18000c034;
            if (bVar6 == 0x30) goto LAB_18000c0d8;
          }
          else {
            if (uVar3 == 2) {
              if ((byte)(bVar6 - 0x31) < 9) goto LAB_18000c095;
              if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) goto LAB_18000c0b9;
              pbVar14 = param_3;
              if (bVar6 == 0x30) goto LAB_18000c0d8;
              break;
            }
            if (uVar3 == 3) {
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
                if (uVar18 < 0x19) {
                  uVar18 = uVar18 + 1;
                  *pcVar23 = bVar6 - 0x30;
                  pcVar23 = pcVar23 + 1;
                }
                else {
                  uVar11 = uVar11 + 1;
                }
                bVar6 = *pbVar17;
                pbVar17 = pbVar17 + 1;
              }
              if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) goto LAB_18000c084;
            }
            else {
              if (uVar3 != 4) goto LAB_18000c25b;
              local_b8 = 1;
              if (uVar18 == 0) {
                while (bVar6 == 0x30) {
                  uVar11 = uVar11 - 1;
                  bVar6 = *pbVar17;
                  pbVar17 = pbVar17 + 1;
                }
              }
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
                if (uVar18 < 0x19) {
                  uVar18 = uVar18 + 1;
                  *pcVar23 = bVar6 - 0x30;
                  pcVar23 = pcVar23 + 1;
                  uVar11 = uVar11 - 1;
                }
                bVar6 = *pbVar17;
                pbVar17 = pbVar17 + 1;
              }
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) {
LAB_18000c034:
              uVar22 = 1;
              uVar3 = 0xb;
              pbVar14 = pbVar17 + -1;
              goto LAB_18000bf7d;
            }
          }
          uVar22 = 1;
          uVar26 = 0;
          if (((char)bVar6 < 'D') ||
             (('E' < (char)bVar6 && (uVar26 = uVar19, bVar6 != 100 && bVar6 != 0x65))))
          goto LAB_18000c155;
          uVar3 = 6;
          pbVar14 = pbVar17;
          uVar22 = 1;
          goto LAB_18000bf7d;
        }
        if (8 < (byte)(bVar6 - 0x31)) {
          if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) {
LAB_18000c0b9:
            uVar3 = 5;
            pbVar14 = pbVar17;
          }
          else if (bVar6 == 0x2b) {
            uVar3 = 2;
            local_b0 = local_b0 & 0xffff0000;
            pbVar14 = pbVar17;
          }
          else if (bVar6 == 0x2d) {
            uVar3 = 2;
            local_b0 = 0x8000;
            pbVar14 = pbVar17;
          }
          else {
            uVar26 = uVar19;
            if (bVar6 != 0x30) goto LAB_18000c155;
LAB_18000c0d8:
            uVar3 = 1;
            pbVar14 = pbVar17;
          }
          goto LAB_18000bf7d;
        }
LAB_18000c095:
        uVar3 = 3;
        pbVar14 = param_3;
      }
LAB_18000c0a0:
      param_3 = pbVar14;
      pbVar14 = pbVar17 + -1;
      goto LAB_18000bf7d;
    }
    if (uVar3 == 6) {
      pbVar14 = pbVar14 + -1;
      if ((byte)(bVar6 - 0x31) < 9) goto LAB_18000c222;
      if (bVar6 != 0x2b) {
        if (bVar6 != 0x2d) goto LAB_18000c22c;
LAB_18000c1d7:
        local_b4 = -1;
        uVar3 = 7;
        param_3 = pbVar14;
        pbVar14 = pbVar17;
        goto LAB_18000bf7d;
      }
      uVar3 = 7;
      param_3 = pbVar14;
    }
    else {
      if (uVar3 == 7) {
        pbVar14 = param_3;
        if ((byte)(bVar6 - 0x31) < 9) {
LAB_18000c222:
          uVar3 = 9;
          goto LAB_18000c0a0;
        }
LAB_18000c22c:
        if (bVar6 != 0x30) break;
        uVar3 = 8;
        param_3 = pbVar14;
        pbVar14 = pbVar17;
        goto LAB_18000bf7d;
      }
      if (uVar3 == 8) {
        uVar25 = 1;
        while (bVar6 == 0x30) {
          bVar6 = *pbVar17;
          pbVar17 = pbVar17 + 1;
        }
        uVar26 = uVar19;
        if ((byte)(bVar6 - 0x31) < 9) {
          uVar3 = 9;
          pbVar14 = param_3;
          uVar25 = 1;
          goto LAB_18000c0a0;
        }
        goto LAB_18000c155;
      }
      if (uVar3 == 9) {
        uVar25 = 1;
        uVar26 = uVar9;
        goto LAB_18000c29c;
      }
      if (uVar3 == 0xb) {
        uVar26 = uVar19;
        if (param_7 == 0) goto LAB_18000c155;
        if (bVar6 != 0x2b) {
          uVar26 = uVar27;
          if (bVar6 == 0x2d) goto LAB_18000c1d7;
          break;
        }
        uVar3 = 7;
        param_3 = pbVar14;
        pbVar14 = pbVar17;
        goto LAB_18000bf7d;
      }
    }
LAB_18000c25b:
    pbVar14 = pbVar17;
  } while (uVar3 != 10);
  goto LAB_18000c2cd;
LAB_18000c29c:
  if (((char)bVar6 < '0') || ('9' < (char)bVar6)) goto LAB_18000c2ba;
  uVar26 = (int)(char)bVar6 + (uVar26 * 5 + -0x18) * 2;
  if ((int)uVar26 < 0x1451) {
    bVar6 = *pbVar17;
    pbVar17 = pbVar17 + 1;
    goto LAB_18000c29c;
  }
  uVar26 = 0x1451;
LAB_18000c2ba:
  while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
    bVar6 = *pbVar17;
    pbVar17 = pbVar17 + 1;
  }
LAB_18000c155:
  pbVar14 = pbVar17 + -1;
LAB_18000c2cd:
  *(byte **)param_2 = pbVar14;
  uVar7 = 0;
  uVar16 = uVar7;
  uVar24 = uVar7;
  iVar21 = iVar10;
  uStack_8e = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
  uStack_8a = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
  uStack_78 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
  local_80 = CONCAT22(local_80._2_2_,(ushort)local_80);
  if (uVar22 != 0) {
    if (0x18 < uVar18) {
      if ('\x04' < local_49) {
        local_49 = local_49 + '\x01';
      }
      pcVar23 = pcVar23 + -1;
      uVar18 = 0x18;
      uVar11 = uVar11 + 1;
    }
    uVar16 = uVar2;
    uVar24 = uVar2;
    uStack_8e = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
    uStack_8a = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
    uStack_78 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
    local_80 = CONCAT22(local_80._2_2_,(ushort)local_80);
    if (uVar18 != 0) {
      while (pcVar23 = pcVar23 + -1, *pcVar23 == '\0') {
        uVar18 = uVar18 - 1;
        uVar11 = uVar11 + 1;
      }
      FUN_18000d37c(local_60,uVar18,&local_80);
      uVar22 = CONCAT22(local_80._2_2_,(ushort)local_80);
      uVar19 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
      iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
      uVar27 = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
      if (local_b4 < 0) {
        uVar26 = -uVar26;
      }
      uVar26 = uVar26 + uVar11;
      if (uVar25 == 0) {
        uVar26 = uVar26 + param_5;
      }
      if (local_b8 == 0) {
        uVar26 = uVar26 - param_6;
      }
      local_80 = uVar22;
      if ((int)uVar26 < 0x1451) {
        if (-0x1451 < (int)uVar26) {
          puVar12 = &DAT_180018330;
          if (uVar26 != 0) {
            if ((int)uVar26 < 0) {
              uVar26 = -uVar26;
              puVar12 = (undefined *)0x180018490;
            }
            if (local_ac == 0) {
              local_80._0_2_ = 0;
            }
            uVar27 = uStack_8e;
            iVar4 = uStack_8a;
            uVar19 = uStack_78;
            uVar22 = CONCAT22(local_80._2_2_,(ushort)local_80);
joined_r0x00018000c395:
            do {
              if (uVar26 == 0) break;
              uStack_78._2_2_ = (ushort)(uVar19 >> 0x10);
              puVar12 = puVar12 + 0x54;
              uVar11 = (int)uVar26 >> 3;
              uVar3 = uVar26 & 7;
              uVar26 = uVar11;
              local_a0 = puVar12;
              if (uVar3 != 0) {
                local_a8 = (ushort *)(puVar12 + (longlong)(int)uVar3 * 0xc);
                if (0x7fff < *local_a8) {
                  puVar13 = local_a8 + 4;
                  uVar1 = *(undefined8 *)local_a8;
                  local_a8 = (ushort *)&local_70;
                  local_68 = *(undefined4 *)puVar13;
                  local_70._6_2_ = (undefined2)((ulonglong)uVar1 >> 0x30);
                  local_70._0_6_ = CONCAT42((int)((ulonglong)uVar1 >> 0x10) + -1,(ushort)uVar1);
                }
                local_90 = 0;
                uStack_8f = 0;
                uStack_8e._0_2_ = 0;
                uStack_8e._2_2_ = 0;
                uVar3 = 0;
                uStack_8a._0_2_ = 0;
                uVar2 = local_a8[5] & 0x7fff;
                uStack_8a._2_2_ = 0;
                iVar21 = 0;
                uStack_86 = 0;
                uVar24 = (local_a8[5] ^ uStack_78._2_2_) & 0x8000;
                uVar16 = (uStack_78._2_2_ & 0x7fff) + uVar2;
                uVar27 = 0;
                iVar4 = 0;
                if (((0x7ffe < (uStack_78._2_2_ & 0x7fff)) ||
                    (uVar27 = 0, iVar4 = 0, 0x7ffe < uVar2)) ||
                   (uVar27 = uVar3, iVar4 = iVar21, 0xbffd < uVar16)) {
LAB_18000c69b:
                  local_80._0_2_ = 0;
                  local_80._2_2_ = 0;
                  uVar22 = 0;
                  uStack_7c = 0;
                  uStack_7a = 0;
                  uVar19 = (-(uint)(uVar24 != 0) & 0x80000000) + 0x7fff8000;
                  uStack_78._0_2_ = (undefined2)uVar19;
                  uStack_78._2_2_ = (ushort)(uVar19 >> 0x10);
                  goto joined_r0x00018000c395;
                }
                if (0x3fbf < uVar16) {
                  if ((((uVar19 & 0x7fff0000) == 0) &&
                      (uVar16 = uVar16 + 1, (uVar19 & 0x7fffffff) == 0)) &&
                     ((CONCAT22(uStack_7a,uStack_7c) == 0 && (uVar22 == 0)))) {
                    uStack_78._2_2_ = 0;
                    uVar19 = uVar19 & 0xffff;
                    goto joined_r0x00018000c395;
                  }
                  if (((uVar2 != 0) ||
                      (uVar16 = uVar16 + 1, (*(uint *)(local_a8 + 4) & 0x7fffffff) != 0)) ||
                     ((*(int *)(local_a8 + 2) != 0 || (*(int *)local_a8 != 0)))) {
                    puVar20 = (uint *)&local_90;
                    iVar21 = 5;
                    uVar27 = uVar9;
                    do {
                      local_b8 = iVar21;
                      if (0 < iVar21) {
                        puVar13 = local_a8 + 4;
                        puVar15 = (ushort *)((longlong)&local_80 + (longlong)(int)(uVar27 * 2));
                        do {
                          uVar19 = *puVar20 + (uint)*puVar13 * (uint)*puVar15;
                          if ((uVar19 < *puVar20) ||
                             (iVar4 = iVar10, uVar19 < (uint)*puVar13 * (uint)*puVar15)) {
                            iVar4 = 1;
                          }
                          *puVar20 = uVar19;
                          if (iVar4 != 0) {
                            *(short *)(puVar20 + 1) = (short)puVar20[1] + 1;
                          }
                          puVar15 = puVar15 + 1;
                          puVar13 = puVar13 + -1;
                          local_b8 = local_b8 + -1;
                        } while (0 < local_b8);
                      }
                      iVar21 = iVar21 + -1;
                      puVar20 = (uint *)((longlong)puVar20 + 2);
                      uVar27 = uVar27 + 1;
                    } while (0 < iVar21);
                    uVar22 = CONCAT22(uStack_86,uStack_8a._2_2_);
                    uVar19 = CONCAT22((undefined2)uStack_8e,CONCAT11(uStack_8f,local_90));
                    uVar16 = uVar16 + 0xc002;
                    uVar27 = uVar19;
                    if ((short)uVar16 < 1) {
LAB_18000c59c:
                      uVar16 = uVar16 - 1;
                      if (-1 < (short)uVar16) goto LAB_18000c606;
                      uVar8 = (ulonglong)(ushort)-uVar16;
                      uVar16 = 0;
                      uVar27 = uVar9;
                      do {
                        uVar3 = uVar22;
                        if ((local_90 & 1) != 0) {
                          uVar27 = uVar27 + 1;
                        }
                        uVar11 = CONCAT22((ushort)uStack_8a,uStack_8e._2_2_);
                        uVar18 = uVar19 >> 1;
                        uStack_8a._0_2_ = (ushort)uStack_8a >> 1 | (ushort)((uVar3 << 0x1f) >> 0x10)
                        ;
                        uVar22 = uVar3 >> 1;
                        uVar19 = uVar18 | uVar11 << 0x1f;
                        uStack_8e._2_2_ = (ushort)(uVar11 >> 1);
                        local_90 = (byte)uVar18;
                        uStack_8f = (undefined1)(uVar18 >> 8);
                        uStack_8e._0_2_ = (undefined2)(uVar19 >> 0x10);
                        uVar8 = uVar8 - 1;
                      } while (uVar8 != 0);
                      uStack_8a._2_2_ = (undefined2)uVar22;
                      uStack_86 = (ushort)(uVar3 >> 0x11);
                      if (uVar27 == 0) goto LAB_18000c606;
                      uVar2 = (ushort)uVar18 | 1;
                      local_90 = (byte)uVar2;
                      uVar19 = CONCAT22((undefined2)uStack_8e,(ushort)uVar18) | 1;
                    }
                    else {
                      do {
                        uVar19 = uVar27;
                        if ((uVar22 & 0x80000000) != 0) break;
                        uVar3 = uVar22 * 2;
                        uVar19 = uVar27 * 2;
                        iVar21 = CONCAT22((ushort)uStack_8a,uStack_8e._2_2_) * 2;
                        uVar16 = uVar16 - 1;
                        uStack_8e._2_2_ = (ushort)iVar21 | (ushort)(uVar27 >> 0x1f);
                        uVar22 = uVar3 | (ushort)uStack_8a >> 0xf;
                        local_90 = (byte)uVar19;
                        uStack_8f = (undefined1)(uVar19 >> 8);
                        uStack_8e._0_2_ = (undefined2)(uVar19 >> 0x10);
                        uStack_8a._0_2_ = (ushort)((uint)iVar21 >> 0x10);
                        uStack_8a._2_2_ = (undefined2)uVar22;
                        uStack_86 = (ushort)(uVar3 >> 0x10);
                        uVar27 = uVar19;
                      } while (0 < (short)uVar16);
                      if ((short)uVar16 < 1) goto LAB_18000c59c;
LAB_18000c606:
                      uVar2 = CONCAT11(uStack_8f,local_90);
                    }
                    uVar27 = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
                    if ((0x8000 < uVar2) ||
                       (iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a),
                       (uVar19 & 0x1ffff) == 0x18000)) {
                      if (CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e) == -1) {
                        uStack_8e._0_2_ = 0;
                        uStack_8e._2_2_ = 0;
                        uVar27 = 0;
                        if (CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a) == -1) {
                          uStack_8a._0_2_ = 0;
                          uStack_8a._2_2_ = 0;
                          iVar4 = 0;
                          if (uStack_86 == 0xffff) {
                            uStack_86 = 0x8000;
                            uVar16 = uVar16 + 1;
                            iVar4 = 0;
                          }
                          else {
                            uStack_86 = uStack_86 + 1;
                          }
                        }
                        else {
                          iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a) + 1;
                          uStack_8a._0_2_ = (ushort)iVar4;
                          uStack_8a._2_2_ = (undefined2)((uint)iVar4 >> 0x10);
                        }
                        uStack_8a._2_2_ = (undefined2)((uint)iVar4 >> 0x10);
                        uVar22 = CONCAT22(uStack_86,uStack_8a._2_2_);
                      }
                      else {
                        uVar27 = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e) + 1;
                        uStack_8e._0_2_ = (undefined2)uVar27;
                        uStack_8e._2_2_ = (ushort)(uVar27 >> 0x10);
                        iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
                      }
                    }
                    uStack_8a._0_2_ = (ushort)iVar4;
                    if (0x7ffe < uVar16) goto LAB_18000c69b;
                    uStack_78._2_2_ = uVar16 | uVar24;
                    uStack_7a = (undefined2)uVar22;
                    uStack_78._0_2_ = (undefined2)(uVar22 >> 0x10);
                    uVar19 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
                    local_80 = uVar27;
                    uStack_7c = (ushort)uStack_8a;
                    uVar22 = uVar27;
                    goto joined_r0x00018000c395;
                  }
                }
                uStack_7c = 0;
                uStack_7a = 0;
                uStack_78._0_2_ = 0;
                uStack_78._2_2_ = 0;
                uVar19 = 0;
                local_80._0_2_ = 0;
                local_80._2_2_ = 0;
                uVar22 = 0;
              }
            } while( true );
          }
          local_80._2_2_ = (undefined2)(uVar22 >> 0x10);
          local_80._0_2_ = (ushort)uVar22;
          uStack_78._2_2_ = (ushort)(uVar19 >> 0x10);
          uStack_78._0_2_ = (undefined2)uVar19;
          iVar10 = CONCAT22(uStack_7c,local_80._2_2_);
          uVar16 = uStack_78._2_2_;
          uVar24 = (ushort)local_80;
          iVar21 = CONCAT22((undefined2)uStack_78,uStack_7a);
          uStack_8e = uVar27;
          uStack_8a = iVar4;
          uStack_78 = uVar19;
          local_80 = uVar22;
        }
      }
      else {
        uVar16 = 0x7fff;
        uVar24 = uVar7;
        iVar21 = -0x80000000;
      }
    }
  }
  local_98[5] = uVar16 | (ushort)local_b0;
  *local_98 = uVar24;
  *(int *)(local_98 + 1) = iVar10;
  *(int *)(local_98 + 3) = iVar21;
LAB_18000c71a:
  FUN_180002e10(local_40 ^ (ulonglong)auStack_d8);
  return;
}



void FUN_18000c744(ulonglong *param_1,ulonglong *param_2,ulonglong param_3,int param_4,uint param_5,
                  int param_6)

{
  FUN_18000c768(param_1,param_2,param_3,param_4,param_5,param_6,(longlong *)0x0);
  return;
}



void FUN_18000c768(ulonglong *param_1,ulonglong *param_2,ulonglong param_3,int param_4,uint param_5,
                  int param_6,longlong *param_7)

{
  if ((param_4 - 0x45U & 0xffffffdf) == 0) {
    FUN_18000cd94(param_1,(undefined1 *)param_2,param_3,param_5,param_6,param_7);
  }
  else if (param_4 == 0x66) {
    FUN_18000cff0(param_1,param_2,param_3,param_5,param_7);
  }
  else if ((param_4 - 0x41U & 0xffffffdf) == 0) {
    FUN_18000c7e8(param_1,(undefined1 *)param_2,param_3,param_5,param_6,param_7);
  }
  else {
    FUN_18000d0c4(param_1,param_2,param_3,param_5,param_6,param_7);
  }
  return;
}



DWORD FUN_18000c7e8(ulonglong *param_1,undefined1 *param_2,ulonglong param_3,uint param_4,
                   int param_5,longlong *param_6)

{
  int iVar1;
  undefined1 (*pauVar2) [16];
  ushort uVar3;
  DWORD DVar4;
  DWORD *pDVar5;
  undefined1 (*pauVar6) [16];
  undefined1 (*pauVar7) [16];
  longlong lVar8;
  short sVar9;
  longlong lVar10;
  ulonglong uVar11;
  short sVar12;
  undefined1 (*pauVar13) [16];
  char *pcVar14;
  char *pcVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  
  uVar17 = 0x3ff;
  sVar12 = 0x30;
  FUN_180003a94(local_48,param_6);
  uVar11 = (ulonglong)param_4;
  if ((int)param_4 < 0) {
    uVar11 = 0;
  }
  if ((param_2 == (undefined1 *)0x0) || (param_3 == 0)) {
    pDVar5 = FUN_180003898();
    DVar4 = 0x16;
  }
  else {
    iVar1 = (int)uVar11;
    *param_2 = 0;
    if ((ulonglong)(longlong)(iVar1 + 0xb) < param_3) {
      if ((*param_1 >> 0x34 & 0x7ff) == 0x7ff) {
        uVar11 = param_3 - 2;
        if (param_3 == 0xffffffffffffffff) {
          uVar11 = 0xffffffffffffffff;
        }
        DVar4 = FUN_18000cd94(param_1,param_2 + 2,uVar11,iVar1,0,(longlong *)0x0);
        if (DVar4 != 0) {
          *param_2 = 0;
          goto LAB_18000cb65;
        }
        if (param_2[2] == '-') {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        pauVar6 = FUN_18000d790((undefined1 (*) [16])(param_2 + 2),0x65);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          (*pauVar6)[0] = (-(param_5 != 0) & 0xe0U) + 0x70;
          (*pauVar6)[3] = 0;
        }
      }
      else {
        if ((*param_1 & 0x8000000000000000) != 0) {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        sVar9 = (-(ushort)(param_5 != 0) & 0xffe0) + 0x27;
        if ((*param_1 & 0x7ff0000000000000) == 0) {
          param_2[2] = 0x30;
          uVar17 = (ulonglong)(-(uint)((*param_1 & 0xfffffffffffff) != 0) & 0x3fe);
        }
        else {
          param_2[2] = 0x31;
        }
        pauVar13 = (undefined1 (*) [16])(param_2 + 3);
        pauVar6 = (undefined1 (*) [16])(param_2 + 4);
        if (iVar1 == 0) {
          (*pauVar13)[0] = 0;
        }
        else {
          (*pauVar13)[0] = *(undefined1 *)**(undefined8 **)(local_48[0] + 0xf0);
        }
        if ((*param_1 & 0xfffffffffffff) != 0) {
          uVar16 = 0xf000000000000;
          do {
            if ((int)uVar11 < 1) break;
            uVar3 = (short)((*param_1 & uVar16) >> ((byte)sVar12 & 0x3f)) + 0x30;
            if (0x39 < uVar3) {
              uVar3 = uVar3 + sVar9;
            }
            (*pauVar6)[0] = (char)uVar3;
            uVar16 = uVar16 >> 4;
            uVar11 = (ulonglong)((int)uVar11 - 1);
            pauVar6 = (undefined1 (*) [16])(*pauVar6 + 1);
            sVar12 = sVar12 + -4;
          } while (-1 < sVar12);
          if ((-1 < sVar12) &&
             (pauVar2 = pauVar6, 8 < (ushort)((*param_1 & uVar16) >> ((byte)sVar12 & 0x3f)))) {
            while (pauVar7 = (undefined1 (*) [16])(pauVar2[-1] + 0xf),
                  ((*pauVar7)[0] + 0xba & 0xdf) == 0) {
              (*pauVar7)[0] = 0x30;
              pauVar2 = pauVar7;
            }
            if (pauVar7 == pauVar13) {
              pauVar2[-1][0xe] = pauVar2[-1][0xe] + '\x01';
            }
            else if ((*pauVar7)[0] == '9') {
              (*pauVar7)[0] = (char)sVar9 + ':';
            }
            else {
              (*pauVar7)[0] = (*pauVar7)[0] + '\x01';
            }
          }
        }
        if (0 < (int)uVar11) {
          FUN_180003b50(pauVar6,0x30,uVar11);
          pauVar6 = (undefined1 (*) [16])(*pauVar6 + uVar11);
        }
        if ((*pauVar13)[0] == '\0') {
          pauVar6 = pauVar13;
        }
        (*pauVar6)[0] = (-(param_5 != 0) & 0xe0U) + 0x70;
        lVar8 = ((uint)(*param_1 >> 0x34) & 0x7ff) - uVar17;
        if (lVar8 < 0) {
          (*pauVar6)[1] = 0x2d;
          lVar8 = -lVar8;
        }
        else {
          (*pauVar6)[1] = 0x2b;
        }
        pcVar14 = *pauVar6 + 2;
        *pcVar14 = '0';
        pcVar15 = pcVar14;
        if (lVar8 < 1000) {
LAB_18000caef:
          if (99 < lVar8) goto LAB_18000caf5;
        }
        else {
          *pcVar14 = (char)(lVar8 / 1000) + '0';
          pcVar15 = *pauVar6 + 3;
          lVar8 = lVar8 % 1000;
          if (pcVar15 == pcVar14) goto LAB_18000caef;
LAB_18000caf5:
          lVar10 = SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816(lVar8),8) + lVar8;
          lVar10 = (lVar10 >> 6) - (lVar10 >> 0x3f);
          *pcVar15 = (char)lVar10 + '0';
          pcVar15 = pcVar15 + 1;
          lVar8 = lVar8 + lVar10 * -100;
        }
        if ((pcVar15 != pcVar14) || (9 < lVar8)) {
          *pcVar15 = (char)(lVar8 / 10) + '0';
          pcVar15 = pcVar15 + 1;
          lVar8 = lVar8 % 10;
        }
        *pcVar15 = (char)lVar8 + '0';
        pcVar15[1] = '\0';
      }
      DVar4 = 0;
      goto LAB_18000cb65;
    }
    pDVar5 = FUN_180003898();
    DVar4 = 0x22;
  }
  *pDVar5 = DVar4;
  FUN_1800037cc();
LAB_18000cb65:
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  return DVar4;
}



ulonglong FUN_18000cb98(undefined1 *param_1,ulonglong param_2,int param_3,int param_4,int *param_5,
                       char param_6,longlong *param_7)

{
  code *pcVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  char *pcVar4;
  ulonglong uVar5;
  undefined1 *puVar6;
  undefined1 *puVar7;
  uint uVar8;
  ulonglong *puVar9;
  int iVar10;
  longlong local_38 [2];
  longlong local_28;
  char local_20;
  
  FUN_180003a94(local_38,param_7);
  if ((param_1 == (undefined1 *)0x0) || (param_2 == 0)) {
    pDVar3 = FUN_180003898();
    uVar8 = 0x16;
  }
  else {
    iVar10 = 0;
    if (0 < param_3) {
      iVar10 = param_3;
    }
    if ((ulonglong)(longlong)(iVar10 + 9) < param_2) {
      if (param_6 != '\0') {
        puVar9 = (ulonglong *)(param_1 + (*param_5 == 0x2d));
        if (0 < param_3 != 0) {
          pcVar4 = FUN_1800083c0(puVar9);
          FUN_180002e40((undefined8 *)((longlong)(int)(uint)(0 < param_3) + (longlong)puVar9),puVar9
                        ,(ulonglong)(pcVar4 + 1));
        }
      }
      puVar6 = param_1;
      if (*param_5 == 0x2d) {
        *param_1 = 0x2d;
        puVar6 = param_1 + 1;
      }
      if (0 < param_3) {
        *puVar6 = puVar6[1];
        puVar6 = puVar6 + 1;
        *puVar6 = *(undefined1 *)**(undefined8 **)(local_38[0] + 0xf0);
      }
      puVar6 = puVar6 + (ulonglong)(param_6 == '\0') + (longlong)param_3;
      puVar7 = param_1 + (param_2 - (longlong)puVar6);
      if (param_2 == 0xffffffffffffffff) {
        puVar7 = (undefined1 *)0xffffffffffffffff;
      }
      DVar2 = FUN_180002b0c(puVar6,(longlong)puVar7,"e+000");
      if (DVar2 != 0) {
        FUN_1800037ec();
        pcVar1 = (code *)swi(3);
        uVar5 = (*pcVar1)();
        return uVar5;
      }
      if (param_4 != 0) {
        *puVar6 = 0x45;
      }
      if (**(char **)(param_5 + 4) != '0') {
        iVar10 = param_5[1] + -1;
        if (iVar10 < 0) {
          iVar10 = -iVar10;
          puVar6[1] = 0x2d;
        }
        if (99 < iVar10) {
          puVar6[2] = puVar6[2] + (char)(iVar10 / 100);
          iVar10 = iVar10 % 100;
        }
        if (9 < iVar10) {
          puVar6[3] = puVar6[3] + (char)(iVar10 / 10);
          iVar10 = iVar10 % 10;
        }
        puVar6[4] = puVar6[4] + (char)iVar10;
      }
      if (((DAT_1800198b8 & 1) != 0) && (puVar6[2] == '0')) {
        FUN_180002e40((undefined8 *)(puVar6 + 2),(undefined8 *)(puVar6 + 3),3);
      }
      uVar8 = 0;
      goto LAB_18000cd47;
    }
    pDVar3 = FUN_180003898();
    uVar8 = 0x22;
  }
  *pDVar3 = uVar8;
  FUN_1800037cc();
LAB_18000cd47:
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return (ulonglong)uVar8;
}



void FUN_18000cd94(undefined8 *param_1,undefined1 *param_2,ulonglong param_3,int param_4,int param_5
                  ,longlong *param_6)

{
  DWORD DVar1;
  DWORD *pDVar2;
  ulonglong uVar3;
  undefined1 auStackY_a8 [32];
  int local_68 [6];
  undefined1 local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_1800170a0 ^ (ulonglong)auStackY_a8;
  FUN_18000da70(*param_1,local_68,local_50,0x16);
  if ((param_2 == (undefined1 *)0x0) || (param_3 == 0)) {
    pDVar2 = FUN_180003898();
    *pDVar2 = 0x16;
    FUN_1800037cc();
  }
  else {
    uVar3 = 0xffffffffffffffff;
    if (param_3 != 0xffffffffffffffff) {
      uVar3 = (param_3 - (local_68[0] == 0x2d)) - (ulonglong)(0 < param_4);
    }
    DVar1 = FUN_18000d8d4(param_2 + (ulonglong)(0 < param_4) + (ulonglong)(local_68[0] == 0x2d),
                          uVar3,param_4 + 1,(longlong)local_68);
    if (DVar1 == 0) {
      FUN_18000cb98(param_2,param_3,param_4,param_5,local_68,'\0',param_6);
    }
    else {
      *param_2 = 0;
    }
  }
  FUN_180002e10(local_38 ^ (ulonglong)auStackY_a8);
  return;
}



undefined4
FUN_18000ce8c(ulonglong *param_1,longlong param_2,int param_3,int *param_4,char param_5,
             longlong *param_6)

{
  undefined1 (*pauVar1) [16];
  DWORD *pDVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  ulonglong *puVar7;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  iVar5 = param_4[1];
  FUN_180003a94(local_28,param_6);
  if ((param_1 == (ulonglong *)0x0) || (param_2 == 0)) {
    pDVar2 = FUN_180003898();
    uVar6 = 0x16;
    *pDVar2 = 0x16;
    FUN_1800037cc();
  }
  else {
    if ((param_5 != '\0') && (iVar5 + -1 == param_3)) {
      *(undefined2 *)((longlong)param_1 + (longlong)(iVar5 + -1) + (ulonglong)(*param_4 == 0x2d)) =
           0x30;
    }
    if (*param_4 == 0x2d) {
      *(undefined1 *)param_1 = 0x2d;
      param_1 = (ulonglong *)((longlong)param_1 + 1);
    }
    if (param_4[1] < 1) {
      pcVar3 = FUN_1800083c0(param_1);
      FUN_180002e40((undefined8 *)((longlong)param_1 + 1),param_1,(ulonglong)(pcVar3 + 1));
      *(undefined1 *)param_1 = 0x30;
      puVar7 = (ulonglong *)((longlong)param_1 + 1);
    }
    else {
      puVar7 = (ulonglong *)((longlong)param_1 + (longlong)param_4[1]);
    }
    if (0 < param_3) {
      pauVar1 = (undefined1 (*) [16])((longlong)puVar7 + 1);
      pcVar3 = FUN_1800083c0(puVar7);
      FUN_180002e40((undefined8 *)pauVar1,puVar7,(ulonglong)(pcVar3 + 1));
      *(undefined1 *)puVar7 = *(undefined1 *)**(undefined8 **)(local_28[0] + 0xf0);
      if (param_4[1] < 0) {
        iVar4 = -param_4[1];
        iVar5 = iVar4;
        if ((param_5 == '\0') && (iVar5 = param_3, iVar4 <= param_3)) {
          iVar5 = iVar4;
        }
        if (iVar5 != 0) {
          pcVar3 = FUN_1800083c0((ulonglong *)pauVar1);
          FUN_180002e40((undefined8 *)(*pauVar1 + iVar5),(undefined8 *)pauVar1,
                        (ulonglong)(pcVar3 + 1));
        }
        FUN_180003b50(pauVar1,0x30,(longlong)iVar5);
      }
    }
    uVar6 = 0;
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar6;
}



void FUN_18000cff0(undefined8 *param_1,ulonglong *param_2,longlong param_3,int param_4,
                  longlong *param_5)

{
  DWORD DVar1;
  DWORD *pDVar2;
  ulonglong uVar3;
  undefined1 auStackY_98 [32];
  int local_68;
  int local_64;
  undefined1 local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_1800170a0 ^ (ulonglong)auStackY_98;
  FUN_18000da70(*param_1,&local_68,local_50,0x16);
  if ((param_2 == (ulonglong *)0x0) || (param_3 == 0)) {
    pDVar2 = FUN_180003898();
    *pDVar2 = 0x16;
    FUN_1800037cc();
  }
  else {
    uVar3 = 0xffffffffffffffff;
    if (param_3 != -1) {
      uVar3 = param_3 - (ulonglong)(local_68 == 0x2d);
    }
    DVar1 = FUN_18000d8d4((char *)((ulonglong)(local_68 == 0x2d) + (longlong)param_2),uVar3,
                          local_64 + param_4,(longlong)&local_68);
    if (DVar1 == 0) {
      FUN_18000ce8c(param_2,param_3,param_4,&local_68,'\0',param_5);
    }
    else {
      *(undefined1 *)param_2 = 0;
    }
  }
  FUN_180002e10(local_38 ^ (ulonglong)auStackY_98);
  return;
}



void FUN_18000d0c4(undefined8 *param_1,ulonglong *param_2,ulonglong param_3,int param_4,int param_5,
                  longlong *param_6)

{
  char *pcVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  ulonglong uVar4;
  char *pcVar5;
  int iVar6;
  undefined1 auStackY_a8 [32];
  int local_68;
  int local_64;
  undefined1 local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_1800170a0 ^ (ulonglong)auStackY_a8;
  FUN_18000da70(*param_1,&local_68,local_50,0x16);
  if ((param_2 == (ulonglong *)0x0) || (param_3 == 0)) {
    pDVar3 = FUN_180003898();
    *pDVar3 = 0x16;
    FUN_1800037cc();
  }
  else {
    iVar6 = local_64 + -1;
    uVar4 = 0xffffffffffffffff;
    pcVar1 = (char *)((ulonglong)(local_68 == 0x2d) + (longlong)param_2);
    if (param_3 != 0xffffffffffffffff) {
      uVar4 = param_3 - (local_68 == 0x2d);
    }
    DVar2 = FUN_18000d8d4(pcVar1,uVar4,param_4,(longlong)&local_68);
    if (DVar2 == 0) {
      local_64 = local_64 + -1;
      if ((local_64 < -4) || (param_4 <= local_64)) {
        FUN_18000cb98((undefined1 *)param_2,param_3,param_4,param_5,&local_68,'\x01',param_6);
      }
      else {
        if (iVar6 < local_64) {
          do {
            pcVar5 = pcVar1;
            pcVar1 = pcVar5 + 1;
          } while (*pcVar5 != '\0');
          pcVar5[-1] = '\0';
        }
        FUN_18000ce8c(param_2,param_3,param_4,&local_68,'\x01',param_6);
      }
    }
    else {
      *(undefined1 *)param_2 = 0;
    }
  }
  FUN_180002e10(local_38 ^ (ulonglong)auStackY_a8);
  return;
}



void FUN_18000d200(char *param_1,longlong *param_2)

{
  char cVar1;
  char *pcVar2;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  char *pcVar3;
  
  FUN_180003a94(local_28,param_2);
  cVar1 = *param_1;
  if (cVar1 != '\0') {
    do {
      if (cVar1 == *(char *)**(undefined8 **)(local_28[0] + 0xf0)) break;
      param_1 = param_1 + 1;
      cVar1 = *param_1;
    } while (cVar1 != '\0');
  }
  if (*param_1 != '\0') {
    do {
      param_1 = param_1 + 1;
      pcVar2 = param_1;
      if (*param_1 == '\0') break;
    } while ((*param_1 + 0xbbU & 0xdf) != 0);
    do {
      pcVar3 = pcVar2;
      pcVar2 = pcVar3 + -1;
    } while (*pcVar2 == '0');
    if (*pcVar2 == *(char *)**(undefined8 **)(local_28[0] + 0xf0)) {
      pcVar2 = pcVar3 + -2;
    }
    do {
      cVar1 = *param_1;
      pcVar2 = pcVar2 + 1;
      param_1 = param_1 + 1;
      *pcVar2 = cVar1;
    } while (cVar1 != '\0');
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_18000d2a0(int param_1,uint *param_2,byte *param_3,longlong *param_4)

{
  uint local_res8 [8];
  undefined8 local_18 [2];
  
  if (param_1 == 0) {
    FUN_18000b2d8(local_res8,param_3,param_4);
    *param_2 = local_res8[0];
  }
  else {
    FUN_18000b210((uint *)local_18,param_3,param_4);
    *(undefined8 *)param_2 = local_18[0];
  }
  return;
}



void FUN_18000d2e8(byte *param_1,longlong *param_2)

{
  byte bVar1;
  uint uVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180003a94(local_28,param_2);
  uVar2 = FUN_18000d770((int)(char)*param_1);
  if (uVar2 != 0x65) {
    do {
      param_1 = param_1 + 1;
      uVar3 = FUN_18000d5a0((uint)*param_1);
    } while ((int)uVar3 != 0);
  }
  uVar2 = FUN_18000d770((int)(char)*param_1);
  if (uVar2 == 0x78) {
    param_1 = param_1 + 2;
  }
  bVar4 = *param_1;
  *param_1 = *(byte *)**(undefined8 **)(local_28[0] + 0xf0);
  do {
    param_1 = param_1 + 1;
    bVar1 = *param_1;
    *param_1 = bVar4;
    bVar4 = bVar1;
  } while (*param_1 != 0);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_18000d37c(char *param_1,int param_2,uint *param_3)

{
  undefined8 uVar1;
  uint uVar2;
  bool bVar3;
  bool bVar4;
  uint uVar5;
  short sVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint local_28;
  
  *param_3 = 0;
  param_3[1] = 0;
  param_3[2] = 0;
  sVar6 = 0x404e;
  if (param_2 != 0) {
    uVar5 = 0;
    uVar10 = 0;
    uVar8 = 0;
    bVar4 = true;
    do {
      uVar1 = *(undefined8 *)param_3;
      uVar9 = param_3[2];
      uVar2 = uVar5 * 4;
      uVar7 = (uVar10 * 2 | uVar5 >> 0x1f) * 2 | uVar5 * 2 >> 0x1f;
      uVar10 = (uVar8 * 2 | uVar10 >> 0x1f) * 2 | uVar10 * 2 >> 0x1f;
      local_28 = (uint)uVar1;
      *param_3 = uVar2;
      uVar5 = uVar2 + local_28;
      param_3[1] = uVar7;
      param_3[2] = uVar10;
      if ((uVar5 < uVar2) || (bVar3 = false, uVar5 < local_28)) {
        bVar3 = bVar4;
      }
      *param_3 = uVar5;
      uVar8 = uVar7;
      if (bVar3) {
        uVar8 = uVar7 + 1;
        if ((uVar8 < uVar7) || (bVar3 = false, uVar8 == 0)) {
          bVar3 = bVar4;
        }
        param_3[1] = uVar8;
        if (bVar3) {
          uVar10 = uVar10 + 1;
          param_3[2] = uVar10;
        }
      }
      uVar2 = (uint)((ulonglong)uVar1 >> 0x20);
      uVar7 = uVar8 + uVar2;
      if ((uVar7 < uVar8) || (bVar3 = false, uVar7 < uVar2)) {
        bVar3 = bVar4;
      }
      param_3[1] = uVar7;
      if (bVar3) {
        uVar10 = uVar10 + 1;
        param_3[2] = uVar10;
      }
      uVar2 = uVar5 * 2;
      uVar8 = (uVar10 + uVar9) * 2 | uVar7 >> 0x1f;
      *param_3 = uVar2;
      param_3[2] = uVar8;
      uVar9 = uVar7 * 2 | uVar5 >> 0x1f;
      param_3[1] = uVar9;
      uVar5 = uVar2 + (int)*param_1;
      if ((uVar5 < uVar2) || (bVar3 = false, uVar5 < (uint)(int)*param_1)) {
        bVar3 = bVar4;
      }
      *param_3 = uVar5;
      uVar10 = uVar9;
      if (bVar3) {
        uVar10 = uVar9 + 1;
        if ((uVar10 < uVar9) || (bVar3 = false, uVar10 == 0)) {
          bVar3 = bVar4;
        }
        param_3[1] = uVar10;
        if (bVar3) {
          uVar8 = uVar8 + 1;
          param_3[2] = uVar8;
        }
      }
      param_1 = param_1 + 1;
      param_3[1] = uVar10;
      param_3[2] = uVar8;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  if (param_3[2] == 0) {
    uVar5 = param_3[1];
    do {
      uVar10 = *param_3;
      uVar9 = uVar5 >> 0x10;
      *param_3 = uVar10 << 0x10;
      uVar8 = uVar10 >> 0x10 | uVar5 << 0x10;
      sVar6 = sVar6 + -0x10;
      uVar10 = uVar5 >> 0x10;
      uVar5 = uVar8;
    } while (uVar10 == 0);
    param_3[1] = uVar8;
    param_3[2] = uVar9;
  }
  uVar5 = param_3[2];
  if ((uVar5 & 0x8000) == 0) {
    uVar10 = *param_3;
    uVar8 = param_3[1];
    do {
      uVar9 = uVar5 * 2;
      uVar5 = uVar8 >> 0x1f;
      uVar8 = uVar8 * 2 | uVar10 >> 0x1f;
      uVar5 = uVar9 | uVar5;
      sVar6 = sVar6 + -1;
      uVar10 = uVar10 * 2;
    } while ((uVar9 & 0x8000) == 0);
    *param_3 = uVar10;
    param_3[1] = uVar8;
    param_3[2] = uVar5;
  }
  *(short *)((longlong)param_3 + 10) = sVar6;
  return;
}



ulonglong FUN_18000d5a0(int param_1)

{
  ushort uVar1;
  ulonglong uVar2;
  undefined6 extraout_var;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if (DAT_180019878 == 0) {
    uVar2 = (ulonglong)(*(ushort *)(PTR_DAT_180017f88 + (longlong)param_1 * 2) & 4);
  }
  else {
    FUN_180003a94(local_28,(longlong *)0x0);
    if (*(int *)(local_28[0] + 0xd4) < 2) {
      uVar2 = (ulonglong)
              (*(ushort *)(*(longlong *)(local_28[0] + 0x108) + (longlong)param_1 * 2) & 4);
    }
    else {
      uVar1 = FUN_18000a508(param_1,4,local_28);
      uVar2 = CONCAT62(extraout_var,uVar1) & 0xffffffff;
    }
    if (local_10 != '\0') {
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
    }
  }
  return uVar2;
}



uint FUN_18000d61c(uint param_1,longlong *param_2)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  undefined6 extraout_var;
  undefined6 extraout_var_00;
  DWORD *pDVar4;
  CHAR local_res8;
  CHAR local_res9;
  undefined1 local_resa;
  byte local_res18;
  undefined1 local_res19;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180003a94(local_28,param_2);
  if (param_1 < 0x100) {
    if (*(int *)(local_28[0] + 0xd4) < 2) {
      uVar2 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (longlong)(int)param_1 * 2) & 1;
    }
    else {
      uVar1 = FUN_18000a508(param_1,1,local_28);
      uVar2 = (uint)CONCAT62(extraout_var,uVar1);
    }
    if (uVar2 == 0) {
LAB_18000d687:
      if (local_10 == '\0') {
        return param_1;
      }
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
      return param_1;
    }
    uVar2 = (uint)*(byte *)(*(longlong *)(local_28[0] + 0x110) + (longlong)(int)param_1);
  }
  else {
    if ((*(int *)(local_28[0] + 0xd4) < 2) ||
       (uVar1 = FUN_180008318((int)param_1 >> 8 & 0xff,local_28),
       (int)CONCAT62(extraout_var_00,uVar1) == 0)) {
      pDVar4 = FUN_180003898();
      iVar3 = 1;
      *pDVar4 = 0x2a;
      local_res9 = '\0';
      local_res8 = (CHAR)param_1;
    }
    else {
      local_resa = 0;
      iVar3 = 2;
      local_res8 = (CHAR)(param_1 >> 8);
      local_res9 = (CHAR)param_1;
    }
    iVar3 = FUN_18000a270(local_28,*(longlong *)(local_28[0] + 0x138),0x100,&local_res8,iVar3,
                          &local_res18,3,*(UINT *)(local_28[0] + 4),1);
    if (iVar3 == 0) goto LAB_18000d687;
    uVar2 = (uint)local_res18;
    if (iVar3 != 1) {
      uVar2 = (uint)CONCAT11(local_res18,local_res19);
    }
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar2;
}



uint FUN_18000d770(uint param_1)

{
  uint uVar1;
  
  if (DAT_180019878 == 0) {
    if (param_1 - 0x41 < 0x1a) {
      param_1 = param_1 + 0x20;
    }
    return param_1;
  }
  uVar1 = FUN_18000d61c(param_1,(longlong *)0x0);
  return uVar1;
}



undefined1 (*) [16] FUN_18000d790(undefined1 (*param_1) [16],uint param_2)

{
  ushort uVar1;
  ulonglong uVar2;
  uint uVar3;
  undefined1 (*pauVar4) [16];
  int iVar5;
  uint uVar6;
  char *pcVar7;
  char *pcVar8;
  bool bVar9;
  bool bVar10;
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 in_XMM1 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [16];
  char cVar11;
  char cVar16;
  char cVar17;
  char cVar18;
  
  pauVar4 = (undefined1 (*) [16])0x0;
  if (param_2 == 0) {
    pcVar7 = (char *)((ulonglong)param_1 & 0xfffffffffffffff0);
    auVar12[0] = -(*pcVar7 == '\0');
    auVar12[1] = -(pcVar7[1] == '\0');
    auVar12[2] = -(pcVar7[2] == '\0');
    auVar12[3] = -(pcVar7[3] == '\0');
    auVar12[4] = -(pcVar7[4] == '\0');
    auVar12[5] = -(pcVar7[5] == '\0');
    auVar12[6] = -(pcVar7[6] == '\0');
    auVar12[7] = -(pcVar7[7] == '\0');
    auVar12[8] = -(pcVar7[8] == '\0');
    auVar12[9] = -(pcVar7[9] == '\0');
    auVar12[10] = -(pcVar7[10] == '\0');
    auVar12[0xb] = -(pcVar7[0xb] == '\0');
    auVar12[0xc] = -(pcVar7[0xc] == '\0');
    auVar12[0xd] = -(pcVar7[0xd] == '\0');
    auVar12[0xe] = -(pcVar7[0xe] == '\0');
    auVar12[0xf] = -(pcVar7[0xf] == '\0');
    uVar3 = (uint)(ushort)((ushort)(SUB161(auVar12 >> 7,0) & 1) |
                           (ushort)(SUB161(auVar12 >> 0xf,0) & 1) << 1 |
                           (ushort)(SUB161(auVar12 >> 0x17,0) & 1) << 2 |
                           (ushort)(SUB161(auVar12 >> 0x1f,0) & 1) << 3 |
                           (ushort)(SUB161(auVar12 >> 0x27,0) & 1) << 4 |
                           (ushort)(SUB161(auVar12 >> 0x2f,0) & 1) << 5 |
                           (ushort)(SUB161(auVar12 >> 0x37,0) & 1) << 6 |
                           (ushort)(SUB161(auVar12 >> 0x3f,0) & 1) << 7 |
                           (ushort)(SUB161(auVar12 >> 0x47,0) & 1) << 8 |
                           (ushort)(SUB161(auVar12 >> 0x4f,0) & 1) << 9 |
                           (ushort)(SUB161(auVar12 >> 0x57,0) & 1) << 10 |
                           (ushort)(SUB161(auVar12 >> 0x5f,0) & 1) << 0xb |
                           (ushort)(SUB161(auVar12 >> 0x67,0) & 1) << 0xc |
                           (ushort)(SUB161(auVar12 >> 0x6f,0) & 1) << 0xd |
                           (ushort)(SUB161(auVar12 >> 0x77,0) & 1) << 0xe |
                          (ushort)(auVar12[0xf] >> 7) << 0xf) & -1 << ((byte)param_1 & 0xf);
    pcVar8 = pcVar7;
    if (uVar3 == 0) {
      do {
        pcVar7 = pcVar8 + 0x10;
        auVar13[0] = -(*pcVar7 == '\0');
        auVar13[1] = -(pcVar8[0x11] == '\0');
        auVar13[2] = -(pcVar8[0x12] == '\0');
        auVar13[3] = -(pcVar8[0x13] == '\0');
        auVar13[4] = -(pcVar8[0x14] == '\0');
        auVar13[5] = -(pcVar8[0x15] == '\0');
        auVar13[6] = -(pcVar8[0x16] == '\0');
        auVar13[7] = -(pcVar8[0x17] == '\0');
        auVar13[8] = -(pcVar8[0x18] == '\0');
        auVar13[9] = -(pcVar8[0x19] == '\0');
        auVar13[10] = -(pcVar8[0x1a] == '\0');
        auVar13[0xb] = -(pcVar8[0x1b] == '\0');
        auVar13[0xc] = -(pcVar8[0x1c] == '\0');
        auVar13[0xd] = -(pcVar8[0x1d] == '\0');
        auVar13[0xe] = -(pcVar8[0x1e] == '\0');
        auVar13[0xf] = -(pcVar8[0x1f] == '\0');
        uVar1 = (ushort)(SUB161(auVar13 >> 7,0) & 1) | (ushort)(SUB161(auVar13 >> 0xf,0) & 1) << 1 |
                (ushort)(SUB161(auVar13 >> 0x17,0) & 1) << 2 |
                (ushort)(SUB161(auVar13 >> 0x1f,0) & 1) << 3 |
                (ushort)(SUB161(auVar13 >> 0x27,0) & 1) << 4 |
                (ushort)(SUB161(auVar13 >> 0x2f,0) & 1) << 5 |
                (ushort)(SUB161(auVar13 >> 0x37,0) & 1) << 6 |
                (ushort)(SUB161(auVar13 >> 0x3f,0) & 1) << 7 |
                (ushort)(SUB161(auVar13 >> 0x47,0) & 1) << 8 |
                (ushort)(SUB161(auVar13 >> 0x4f,0) & 1) << 9 |
                (ushort)(SUB161(auVar13 >> 0x57,0) & 1) << 10 |
                (ushort)(SUB161(auVar13 >> 0x5f,0) & 1) << 0xb |
                (ushort)(SUB161(auVar13 >> 0x67,0) & 1) << 0xc |
                (ushort)(SUB161(auVar13 >> 0x6f,0) & 1) << 0xd |
                (ushort)(SUB161(auVar13 >> 0x77,0) & 1) << 0xe | (ushort)(auVar13[0xf] >> 7) << 0xf;
        uVar3 = (uint)uVar1;
        pcVar8 = pcVar7;
      } while (uVar1 == 0);
    }
    uVar6 = 0;
    if (uVar3 != 0) {
      for (; (uVar3 >> uVar6 & 1) == 0; uVar6 = uVar6 + 1) {
      }
    }
    pauVar4 = (undefined1 (*) [16])(pcVar7 + uVar6);
  }
  else if (DAT_180017230 < 2) {
    pcVar7 = (char *)((ulonglong)param_1 & 0xfffffffffffffff0);
    uVar3 = -1 << ((byte)param_1 & 0xf);
    auVar19 = pshuflw(in_XMM1,ZEXT416((param_2 & 0xff) << 8 | param_2 & 0xff),0);
    auVar14[0] = -(*pcVar7 == '\0');
    auVar14[1] = -(pcVar7[1] == '\0');
    auVar14[2] = -(pcVar7[2] == '\0');
    auVar14[3] = -(pcVar7[3] == '\0');
    auVar14[4] = -(pcVar7[4] == '\0');
    auVar14[5] = -(pcVar7[5] == '\0');
    auVar14[6] = -(pcVar7[6] == '\0');
    auVar14[7] = -(pcVar7[7] == '\0');
    auVar14[8] = -(pcVar7[8] == '\0');
    auVar14[9] = -(pcVar7[9] == '\0');
    auVar14[10] = -(pcVar7[10] == '\0');
    auVar14[0xb] = -(pcVar7[0xb] == '\0');
    auVar14[0xc] = -(pcVar7[0xc] == '\0');
    auVar14[0xd] = -(pcVar7[0xd] == '\0');
    auVar14[0xe] = -(pcVar7[0xe] == '\0');
    auVar14[0xf] = -(pcVar7[0xf] == '\0');
    cVar11 = auVar19[0];
    auVar15[0] = -(cVar11 == *pcVar7);
    cVar16 = auVar19[1];
    auVar15[1] = -(cVar16 == pcVar7[1]);
    cVar17 = auVar19[2];
    auVar15[2] = -(cVar17 == pcVar7[2]);
    cVar18 = auVar19[3];
    auVar15[3] = -(cVar18 == pcVar7[3]);
    auVar15[4] = -(cVar11 == pcVar7[4]);
    auVar15[5] = -(cVar16 == pcVar7[5]);
    auVar15[6] = -(cVar17 == pcVar7[6]);
    auVar15[7] = -(cVar18 == pcVar7[7]);
    auVar15[8] = -(cVar11 == pcVar7[8]);
    auVar15[9] = -(cVar16 == pcVar7[9]);
    auVar15[10] = -(cVar17 == pcVar7[10]);
    auVar15[0xb] = -(cVar18 == pcVar7[0xb]);
    auVar15[0xc] = -(cVar11 == pcVar7[0xc]);
    auVar15[0xd] = -(cVar16 == pcVar7[0xd]);
    auVar15[0xe] = -(cVar17 == pcVar7[0xe]);
    auVar15[0xf] = -(cVar18 == pcVar7[0xf]);
    uVar6 = (ushort)((ushort)(SUB161(auVar15 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar15 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar15 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar15 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar15 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar15 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar15 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar15 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar15 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar15 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar15 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar15 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar15 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar15 >> 0x6f,0) & 1) << 0xd |
                     (ushort)(SUB161(auVar15 >> 0x77,0) & 1) << 0xe |
                    (ushort)(auVar15[0xf] >> 7) << 0xf) & uVar3;
    uVar3 = (ushort)((ushort)(SUB161(auVar14 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar14 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar14 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar14 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar14 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar14 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar14 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar14 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar14 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar14 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar14 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar14 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar14 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar14 >> 0x6f,0) & 1) << 0xd |
                     (ushort)(SUB161(auVar14 >> 0x77,0) & 1) << 0xe |
                    (ushort)(auVar14[0xf] >> 7) << 0xf) & uVar3;
    pcVar8 = pcVar7;
    if (uVar3 == 0) {
      do {
        uVar3 = 0x1f;
        if (uVar6 != 0) {
          for (; uVar6 >> uVar3 == 0; uVar3 = uVar3 - 1) {
          }
        }
        if (uVar6 != 0) {
          pauVar4 = (undefined1 (*) [16])(pcVar8 + uVar3);
        }
        pcVar7 = pcVar8 + 0x10;
        auVar20[0] = -(*pcVar7 == '\0');
        auVar20[1] = -(pcVar8[0x11] == '\0');
        auVar20[2] = -(pcVar8[0x12] == '\0');
        auVar20[3] = -(pcVar8[0x13] == '\0');
        auVar20[4] = -(pcVar8[0x14] == '\0');
        auVar20[5] = -(pcVar8[0x15] == '\0');
        auVar20[6] = -(pcVar8[0x16] == '\0');
        auVar20[7] = -(pcVar8[0x17] == '\0');
        auVar20[8] = -(pcVar8[0x18] == '\0');
        auVar20[9] = -(pcVar8[0x19] == '\0');
        auVar20[10] = -(pcVar8[0x1a] == '\0');
        auVar20[0xb] = -(pcVar8[0x1b] == '\0');
        auVar20[0xc] = -(pcVar8[0x1c] == '\0');
        auVar20[0xd] = -(pcVar8[0x1d] == '\0');
        auVar20[0xe] = -(pcVar8[0x1e] == '\0');
        auVar20[0xf] = -(pcVar8[0x1f] == '\0');
        auVar19[0] = -(cVar11 == *pcVar7);
        auVar19[1] = -(cVar16 == pcVar8[0x11]);
        auVar19[2] = -(cVar17 == pcVar8[0x12]);
        auVar19[3] = -(cVar18 == pcVar8[0x13]);
        auVar19[4] = -(cVar11 == pcVar8[0x14]);
        auVar19[5] = -(cVar16 == pcVar8[0x15]);
        auVar19[6] = -(cVar17 == pcVar8[0x16]);
        auVar19[7] = -(cVar18 == pcVar8[0x17]);
        auVar19[8] = -(cVar11 == pcVar8[0x18]);
        auVar19[9] = -(cVar16 == pcVar8[0x19]);
        auVar19[10] = -(cVar17 == pcVar8[0x1a]);
        auVar19[0xb] = -(cVar18 == pcVar8[0x1b]);
        auVar19[0xc] = -(cVar11 == pcVar8[0x1c]);
        auVar19[0xd] = -(cVar16 == pcVar8[0x1d]);
        auVar19[0xe] = -(cVar17 == pcVar8[0x1e]);
        auVar19[0xf] = -(cVar18 == pcVar8[0x1f]);
        uVar1 = (ushort)(SUB161(auVar20 >> 7,0) & 1) | (ushort)(SUB161(auVar20 >> 0xf,0) & 1) << 1 |
                (ushort)(SUB161(auVar20 >> 0x17,0) & 1) << 2 |
                (ushort)(SUB161(auVar20 >> 0x1f,0) & 1) << 3 |
                (ushort)(SUB161(auVar20 >> 0x27,0) & 1) << 4 |
                (ushort)(SUB161(auVar20 >> 0x2f,0) & 1) << 5 |
                (ushort)(SUB161(auVar20 >> 0x37,0) & 1) << 6 |
                (ushort)(SUB161(auVar20 >> 0x3f,0) & 1) << 7 |
                (ushort)(SUB161(auVar20 >> 0x47,0) & 1) << 8 |
                (ushort)(SUB161(auVar20 >> 0x4f,0) & 1) << 9 |
                (ushort)(SUB161(auVar20 >> 0x57,0) & 1) << 10 |
                (ushort)(SUB161(auVar20 >> 0x5f,0) & 1) << 0xb |
                (ushort)(SUB161(auVar20 >> 0x67,0) & 1) << 0xc |
                (ushort)(SUB161(auVar20 >> 0x6f,0) & 1) << 0xd |
                (ushort)(SUB161(auVar20 >> 0x77,0) & 1) << 0xe | (ushort)(auVar20[0xf] >> 7) << 0xf;
        uVar3 = (uint)uVar1;
        uVar6 = (uint)(ushort)((ushort)(SUB161(auVar19 >> 7,0) & 1) |
                               (ushort)(SUB161(auVar19 >> 0xf,0) & 1) << 1 |
                               (ushort)(SUB161(auVar19 >> 0x17,0) & 1) << 2 |
                               (ushort)(SUB161(auVar19 >> 0x1f,0) & 1) << 3 |
                               (ushort)(SUB161(auVar19 >> 0x27,0) & 1) << 4 |
                               (ushort)(SUB161(auVar19 >> 0x2f,0) & 1) << 5 |
                               (ushort)(SUB161(auVar19 >> 0x37,0) & 1) << 6 |
                               (ushort)(SUB161(auVar19 >> 0x3f,0) & 1) << 7 |
                               (ushort)(SUB161(auVar19 >> 0x47,0) & 1) << 8 |
                               (ushort)(SUB161(auVar19 >> 0x4f,0) & 1) << 9 |
                               (ushort)(SUB161(auVar19 >> 0x57,0) & 1) << 10 |
                               (ushort)(SUB161(auVar19 >> 0x5f,0) & 1) << 0xb |
                               (ushort)(SUB161(auVar19 >> 0x67,0) & 1) << 0xc |
                               (ushort)(SUB161(auVar19 >> 0x6f,0) & 1) << 0xd |
                               (ushort)(SUB161(auVar19 >> 0x77,0) & 1) << 0xe |
                              (ushort)(auVar19[0xf] >> 7) << 0xf);
        pcVar8 = pcVar7;
      } while (uVar1 == 0);
    }
    uVar6 = uVar6 & (-uVar3 & uVar3) - 1;
    uVar3 = 0x1f;
    if (uVar6 != 0) {
      for (; uVar6 >> uVar3 == 0; uVar3 = uVar3 - 1) {
      }
    }
    if (uVar6 != 0) {
      pauVar4 = (undefined1 (*) [16])(pcVar7 + uVar3);
    }
  }
  else {
    uVar2 = (ulonglong)param_1 & 0xf;
    while (bVar10 = uVar2 == 0, !bVar10) {
      if ((int)(char)(*param_1)[0] == param_2) {
        pauVar4 = param_1;
      }
      if ((*param_1)[0] == '\0') {
        return pauVar4;
      }
      param_1 = (undefined1 (*) [16])(*param_1 + 1);
      uVar2 = (ulonglong)param_1 & 0xf;
    }
    bVar9 = false;
    while( true ) {
      iVar5 = pcmpistri(ZEXT416(param_2 & 0xff),*param_1,0x40);
      if (bVar9) {
        pauVar4 = (undefined1 (*) [16])(*param_1 + iVar5);
        bVar10 = pauVar4 == (undefined1 (*) [16])0x0;
        pcmpistri(ZEXT416(param_2 & 0xff),*param_1,0x40);
      }
      if (bVar10) break;
      bVar9 = (undefined1 (*) [16])0xffffffffffffffef < param_1;
      param_1 = param_1 + 1;
      bVar10 = param_1 == (undefined1 (*) [16])0x0;
    }
  }
  return pauVar4;
}



DWORD FUN_18000d8d4(char *param_1,ulonglong param_2,int param_3,longlong param_4)

{
  ulonglong *puVar1;
  int iVar2;
  DWORD *pDVar3;
  ulonglong *puVar4;
  char *pcVar5;
  char cVar6;
  DWORD DVar7;
  
  pcVar5 = *(char **)(param_4 + 0x10);
  if ((param_1 == (char *)0x0) || (param_2 == 0)) {
    pDVar3 = FUN_180003898();
    DVar7 = 0x16;
  }
  else {
    *param_1 = '\0';
    iVar2 = 0;
    if (0 < param_3) {
      iVar2 = param_3;
    }
    if ((ulonglong)(longlong)(iVar2 + 1) < param_2) {
      puVar1 = (ulonglong *)(param_1 + 1);
      *param_1 = '0';
      puVar4 = puVar1;
      for (; 0 < param_3; param_3 = param_3 + -1) {
        if (*pcVar5 == '\0') {
          cVar6 = '0';
        }
        else {
          cVar6 = *pcVar5;
          pcVar5 = pcVar5 + 1;
        }
        *(char *)puVar4 = cVar6;
        puVar4 = (ulonglong *)((longlong)puVar4 + 1);
      }
      *(undefined1 *)puVar4 = 0;
      if ((-1 < param_3) && ('4' < *pcVar5)) {
        while (puVar4 = (ulonglong *)((longlong)puVar4 + -1), *(char *)puVar4 == '9') {
          *(undefined1 *)puVar4 = 0x30;
        }
        *(char *)puVar4 = *(char *)puVar4 + '\x01';
      }
      if (*param_1 == '1') {
        *(int *)(param_4 + 4) = *(int *)(param_4 + 4) + 1;
      }
      else {
        pcVar5 = FUN_1800083c0(puVar1);
        FUN_180002e40((undefined8 *)param_1,puVar1,(ulonglong)(pcVar5 + 1));
      }
      return 0;
    }
    pDVar3 = FUN_180003898();
    DVar7 = 0x22;
  }
  *pDVar3 = DVar7;
  FUN_1800037cc();
  return DVar7;
}



void FUN_18000d9a0(uint *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  ushort uVar3;
  uint uVar4;
  ushort uVar5;
  
  uVar4 = param_2[1];
  uVar5 = *(ushort *)((longlong)param_2 + 6) & 0x8000;
  uVar1 = *param_2;
  uVar3 = *(ushort *)((longlong)param_2 + 6) >> 4 & 0x7ff;
  uVar2 = 0x80000000;
  if (uVar3 == 0) {
    if (((uVar4 & 0xfffff) == 0) && (uVar1 == 0)) {
      param_1[1] = 0;
      *param_1 = 0;
      goto LAB_18000da62;
    }
    uVar3 = 0x3c01;
    uVar2 = 0;
  }
  else if (uVar3 == 0x7ff) {
    uVar3 = 0x7fff;
  }
  else {
    uVar3 = uVar3 + 0x3c00;
  }
  *param_1 = uVar1 << 0xb;
  uVar4 = uVar1 >> 0x15 | (uVar4 & 0xfffff) << 0xb | uVar2;
  param_1[1] = uVar4;
  if (uVar2 == 0) {
    do {
      uVar4 = *param_1 >> 0x1f | uVar4 * 2;
      *param_1 = *param_1 * 2;
      uVar3 = uVar3 - 1;
    } while (-1 < (int)uVar4);
    param_1[1] = uVar4;
  }
  uVar5 = uVar5 | uVar3;
LAB_18000da62:
  *(ushort *)(param_1 + 2) = uVar5;
  return;
}



void FUN_18000da70(undefined8 param_1,int *param_2,undefined1 *param_3,longlong param_4)

{
  code *pcVar1;
  int iVar2;
  DWORD DVar3;
  undefined1 auStack_a8 [32];
  undefined8 local_88;
  undefined8 local_78;
  undefined2 local_70;
  undefined8 local_68;
  undefined2 local_60;
  short local_58;
  char local_56;
  char local_54 [28];
  ulonglong local_38;
  
  local_38 = DAT_1800170a0 ^ (ulonglong)auStack_a8;
  local_78 = param_1;
  FUN_18000d9a0((uint *)&local_68,(uint *)&local_78);
  local_78 = local_68;
  local_70 = local_60;
  iVar2 = FUN_18000db28((int *)&local_78,0x11,0,&local_58);
  *param_2 = (int)local_56;
  param_2[1] = (int)local_58;
  param_2[2] = iVar2;
  DVar3 = FUN_180002b0c(param_3,param_4,local_54);
  if (DVar3 == 0) {
    *(undefined1 **)(param_2 + 4) = param_3;
    FUN_180002e10(local_38 ^ (ulonglong)auStack_a8);
    return;
  }
  local_88 = 0;
  FUN_1800037ec();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_18000db28(int *param_1,int param_2,uint param_3,short *param_4)

{
  short *psVar1;
  undefined8 uVar2;
  code *pcVar3;
  undefined3 uVar4;
  bool bVar5;
  undefined1 uVar6;
  ushort uVar7;
  DWORD DVar8;
  short sVar9;
  ushort uVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint *puVar14;
  ulonglong uVar15;
  uint uVar16;
  uint uVar17;
  undefined *puVar18;
  char cVar19;
  ushort uVar20;
  uint uVar21;
  uint uVar22;
  longlong lVar23;
  short *psVar24;
  short *psVar25;
  int iVar26;
  int iVar27;
  ushort *puVar28;
  ushort *puVar29;
  undefined1 auStack_f8 [32];
  undefined8 local_d8;
  ushort local_c8;
  ushort local_c6;
  int local_c4;
  int local_c0;
  undefined2 local_bc;
  undefined *local_b8;
  undefined4 local_b0;
  int local_ac;
  int local_a8;
  short *local_a0;
  uint local_98;
  ushort *local_90;
  byte local_88;
  undefined1 uStack_87;
  undefined4 uStack_86;
  undefined4 uStack_82;
  ushort uStack_7e;
  undefined4 local_78;
  undefined2 uStack_74;
  undefined2 uStack_72;
  ushort uStack_70;
  undefined1 uStack_6e;
  byte bStack_6d;
  int local_68;
  int local_64;
  undefined4 local_60;
  undefined8 local_58;
  undefined4 local_50;
  ulonglong local_48;
  
  local_48 = DAT_1800170a0 ^ (ulonglong)auStack_f8;
  iVar27 = *param_1;
  uVar21 = param_1[1];
  local_c6 = *(ushort *)(param_1 + 2) & 0x8000;
  uVar20 = *(ushort *)(param_1 + 2) & 0x7fff;
  local_68 = -0x33333334;
  local_64 = -0x33333334;
  local_60 = 0x3ffbcccc;
  if (local_c6 == 0) {
    *(undefined1 *)(param_4 + 1) = 0x20;
  }
  else {
    *(undefined1 *)(param_4 + 1) = 0x2d;
  }
  local_ac = param_2;
  local_a0 = param_4;
  local_98 = param_3;
  if (uVar20 == 0) {
    if ((uVar21 != 0) || (iVar27 != 0)) goto LAB_18000dcba;
    uVar6 = 0x20;
    local_78 = CONCAT22(local_78._2_2_,(undefined2)local_78);
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
      local_78 = CONCAT22(local_78._2_2_,(undefined2)local_78);
    }
LAB_18000dbd5:
    *param_4 = 0;
    *(undefined1 *)(param_4 + 1) = uVar6;
    *(undefined2 *)((longlong)param_4 + 3) = 0x3001;
  }
  else {
    if (uVar20 == 0x7fff) {
      *param_4 = 1;
      if (((uVar21 == 0x80000000) && (iVar27 == 0)) || ((uVar21 >> 0x1e & 1) != 0)) {
        if ((local_c6 == 0) || (uVar21 != 0xc0000000)) {
          if ((uVar21 != 0x80000000) || (iVar27 != 0)) goto LAB_18000dc91;
          DVar8 = FUN_180002b0c((undefined1 *)(param_4 + 2),0x16,"1#INF");
          if (DVar8 != 0) {
            local_d8 = 0;
            FUN_1800037ec();
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        else {
          if (iVar27 != 0) {
LAB_18000dc91:
            DVar8 = FUN_180002b0c((undefined1 *)(param_4 + 2),0x16,"1#QNAN");
            if (DVar8 != 0) {
              local_d8 = 0;
              FUN_1800037ec();
              pcVar3 = (code *)swi(3);
              (*pcVar3)();
              return;
            }
            goto LAB_18000dcae;
          }
          DVar8 = FUN_180002b0c((undefined1 *)(param_4 + 2),0x16,"1#IND");
          if (DVar8 != 0) {
            local_d8 = 0;
            FUN_1800037ec();
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        *(undefined1 *)((longlong)param_4 + 3) = 5;
      }
      else {
        DVar8 = FUN_180002b0c((undefined1 *)(param_4 + 2),0x16,"1#SNAN");
        if (DVar8 != 0) {
          local_d8 = 0;
          FUN_1800037ec();
          pcVar3 = (code *)swi(3);
          (*pcVar3)();
          return;
        }
LAB_18000dcae:
        *(undefined1 *)((longlong)param_4 + 3) = 6;
      }
      goto LAB_18000e546;
    }
LAB_18000dcba:
    local_78._2_2_ = (undefined2)iVar27;
    uStack_74 = (undefined2)((uint)iVar27 >> 0x10);
    uStack_6e = (undefined1)uVar20;
    bStack_6d = (byte)(uVar20 >> 8);
    puVar18 = &DAT_180018330;
    uStack_72 = (undefined2)uVar21;
    uStack_70 = (ushort)(uVar21 >> 0x10);
    local_78._0_2_ = 0;
    uVar22 = iVar27 << 0x10;
    uVar12 = iVar27 << 0x10;
    local_a8 = 5;
    iVar11 = ((uint)(uVar20 >> 8) + (uVar21 >> 0x18) * 2) * 0x4d +
             (uint)uVar20 * 0x4d10 + -0x134312f4;
    local_c0 = iVar11 >> 0x10;
    sVar9 = (short)((uint)iVar11 >> 0x10);
    uVar21 = (uint)sVar9;
    if (-uVar21 == 0) {
LAB_18000e094:
      uVar21 = CONCAT22(uStack_72,uStack_74);
      local_78 = iVar27 << 0x10;
    }
    else {
      uVar16 = -uVar21;
      if (0 < (int)uVar21) {
        puVar18 = (undefined *)0x180018490;
        uVar16 = uVar21;
      }
      if (uVar16 == 0) goto LAB_18000e094;
      uVar21 = CONCAT22(uStack_72,uStack_74);
      local_78 = iVar27 << 0x10;
      do {
        iVar27 = 0;
        puVar18 = puVar18 + 0x54;
        uVar22 = (int)uVar16 >> 3;
        if ((uVar16 & 7) != 0) {
          local_90 = (ushort *)(puVar18 + (longlong)(int)(uVar16 & 7) * 0xc);
          if (0x7fff < *local_90) {
            puVar29 = local_90 + 4;
            uVar2 = *(undefined8 *)local_90;
            local_90 = (ushort *)&local_58;
            local_50 = *(undefined4 *)puVar29;
            local_58._6_2_ = (undefined2)((ulonglong)uVar2 >> 0x30);
            local_58._0_6_ = CONCAT42((int)((ulonglong)uVar2 >> 0x10) + -1,(ushort)uVar2);
          }
          local_c4 = 0;
          uVar10 = local_90[5] & 0x7fff;
          local_88 = 0;
          uStack_87 = 0;
          uStack_86._0_2_ = 0;
          uStack_86._2_2_ = 0;
          uStack_86 = 0;
          uStack_82._0_2_ = 0;
          uVar7 = CONCAT11(bStack_6d,uStack_6e) & 0x7fff;
          uStack_82._2_2_ = 0;
          iVar11 = 0;
          uStack_82 = 0;
          uStack_7e = 0;
          local_c8 = (local_90[5] ^ CONCAT11(bStack_6d,uStack_6e)) & 0x8000;
          uVar20 = uVar7 + uVar10;
          if (((uVar7 < 0x7fff) && (uVar10 < 0x7fff)) && (uVar20 < 0xbffe)) {
            if (0x3fbf < uVar20) {
              if (((uVar7 == 0) &&
                  (uVar20 = uVar20 + 1,
                  (CONCAT13(bStack_6d,CONCAT12(uStack_6e,uStack_70)) & 0x7fffffff) == 0)) &&
                 ((uVar21 == 0 && (local_78 == 0)))) {
                uStack_6e = 0;
                bStack_6d = 0;
                uStack_86 = 0;
                goto LAB_18000e07d;
              }
              if (((uVar10 == 0) &&
                  (uVar20 = uVar20 + 1, (*(uint *)(local_90 + 4) & 0x7fffffff) == 0)) &&
                 ((*(int *)(local_90 + 2) == 0 && (*(int *)local_90 == 0)))) goto LAB_18000de04;
              iVar11 = 5;
              puVar14 = (uint *)&local_88;
              do {
                if (0 < iVar11) {
                  puVar29 = local_90 + 4;
                  puVar28 = (ushort *)((longlong)&local_78 + (longlong)(iVar27 * 2));
                  iVar26 = iVar11;
                  do {
                    uVar21 = *puVar14 + (uint)*puVar28 * (uint)*puVar29;
                    if ((uVar21 < *puVar14) ||
                       (bVar5 = false, uVar21 < (uint)*puVar28 * (uint)*puVar29)) {
                      bVar5 = true;
                    }
                    *puVar14 = uVar21;
                    if (bVar5) {
                      *(short *)(puVar14 + 1) = (short)puVar14[1] + 1;
                    }
                    iVar26 = iVar26 + -1;
                    puVar28 = puVar28 + 1;
                    puVar29 = puVar29 + -1;
                  } while (0 < iVar26);
                }
                iVar11 = iVar11 + -1;
                puVar14 = (uint *)((longlong)puVar14 + 2);
                iVar27 = iVar27 + 1;
              } while (0 < iVar11);
              uVar12 = CONCAT22(uStack_7e,uStack_82._2_2_);
              uVar21 = CONCAT22((undefined2)uStack_86,CONCAT11(uStack_87,local_88));
              uVar20 = uVar20 + 0xc002;
              uVar16 = uVar21;
              if ((short)uVar20 < 1) {
LAB_18000df36:
                uVar20 = uVar20 - 1;
                if (-1 < (short)uVar20) goto LAB_18000dfa3;
                uVar15 = (ulonglong)(ushort)-uVar20;
                local_bc = 0;
                iVar27 = local_c4;
                do {
                  uVar16 = uVar12;
                  if ((local_88 & 1) != 0) {
                    iVar27 = iVar27 + 1;
                  }
                  uVar13 = CONCAT22((ushort)uStack_82,uStack_86._2_2_);
                  uVar17 = uVar21 >> 1;
                  uStack_82._0_2_ = (ushort)uStack_82 >> 1 | (ushort)((uVar16 << 0x1f) >> 0x10);
                  uVar12 = uVar16 >> 1;
                  uVar21 = uVar17 | uVar13 << 0x1f;
                  uStack_86._2_2_ = (ushort)(uVar13 >> 1);
                  local_88 = (byte)uVar17;
                  uStack_87 = (undefined1)(uVar17 >> 8);
                  uStack_86._0_2_ = (undefined2)(uVar21 >> 0x10);
                  uVar15 = uVar15 - 1;
                } while (uVar15 != 0);
                uVar20 = 0;
                uStack_82._2_2_ = (undefined2)uVar12;
                uStack_7e = (ushort)(uVar16 >> 0x11);
                if (iVar27 == 0) goto LAB_18000dfa3;
                uVar7 = (ushort)uVar17 | 1;
                local_88 = (byte)uVar7;
                uVar21 = CONCAT22((undefined2)uStack_86,(ushort)uVar17) | 1;
              }
              else {
                do {
                  uVar21 = uVar16;
                  if ((uVar12 & 0x80000000) != 0) break;
                  uVar13 = uVar12 * 2;
                  uVar21 = uVar16 * 2;
                  iVar27 = CONCAT22((ushort)uStack_82,uStack_86._2_2_) * 2;
                  uVar20 = uVar20 - 1;
                  uStack_86._2_2_ = (ushort)iVar27 | (ushort)(uVar16 >> 0x1f);
                  uVar12 = uVar13 | (ushort)uStack_82 >> 0xf;
                  local_88 = (byte)uVar21;
                  uStack_87 = (undefined1)(uVar21 >> 8);
                  uStack_86._0_2_ = (undefined2)(uVar21 >> 0x10);
                  uStack_82._0_2_ = (ushort)((uint)iVar27 >> 0x10);
                  uStack_82._2_2_ = (undefined2)uVar12;
                  uStack_7e = (ushort)(uVar13 >> 0x10);
                  uVar16 = uVar21;
                } while (0 < (short)uVar20);
                if ((short)uVar20 < 1) goto LAB_18000df36;
LAB_18000dfa3:
                uVar7 = CONCAT11(uStack_87,local_88);
              }
              local_78 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86);
              if ((0x8000 < uVar7) ||
                 (uStack_82 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82),
                 (uVar21 & 0x1ffff) == 0x18000)) {
                if (CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) == -1) {
                  uStack_86._0_2_ = 0;
                  uStack_86._2_2_ = 0;
                  local_78 = 0;
                  if (CONCAT22(uStack_82._2_2_,(ushort)uStack_82) == -1) {
                    uStack_82._0_2_ = 0;
                    uStack_82._2_2_ = 0;
                    iVar27 = 0;
                    if (uStack_7e == 0xffff) {
                      uStack_7e = 0x8000;
                      uVar20 = uVar20 + 1;
                      iVar27 = 0;
                    }
                    else {
                      uStack_7e = uStack_7e + 1;
                    }
                  }
                  else {
                    iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82) + 1;
                    uStack_82._0_2_ = (ushort)iVar27;
                    uStack_82._2_2_ = (undefined2)((uint)iVar27 >> 0x10);
                  }
                  uStack_82._2_2_ = (undefined2)((uint)iVar27 >> 0x10);
                  uVar12 = CONCAT22(uStack_7e,uStack_82._2_2_);
                  uStack_82 = iVar27;
                }
                else {
                  local_78 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) + 1;
                  uStack_86._0_2_ = (undefined2)local_78;
                  uStack_86._2_2_ = (ushort)(local_78 >> 0x10);
                  uStack_82 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82);
                }
              }
              uStack_86 = local_78;
              iVar11 = uStack_82;
              if (uVar20 < 0x7fff) {
                bStack_6d = (byte)(uVar20 >> 8) | (byte)(local_c8 >> 8);
                uStack_72 = (undefined2)uVar12;
                uStack_70 = (ushort)(uVar12 >> 0x10);
                uStack_74 = (ushort)uStack_82;
                uVar21 = CONCAT22(uStack_72,(ushort)uStack_82);
                uStack_6e = (undefined1)uVar20;
                uVar12 = local_78;
                goto LAB_18000e07d;
              }
              goto LAB_18000e05f;
            }
LAB_18000de04:
            uStack_74 = 0;
            uStack_72 = 0;
            uStack_70 = 0;
            uStack_6e = 0;
            bStack_6d = 0;
            uStack_82 = iVar11;
          }
          else {
LAB_18000e05f:
            uStack_74 = 0;
            uStack_72 = 0;
            iVar27 = (-(uint)(local_c8 != 0) & 0x80000000) + 0x7fff8000;
            uStack_70 = (ushort)iVar27;
            uStack_6e = (undefined1)((uint)iVar27 >> 0x10);
            bStack_6d = (byte)((uint)iVar27 >> 0x18);
            uStack_82 = iVar11;
          }
          uStack_72 = 0;
          uStack_74 = 0;
          uVar21 = 0;
          local_78._0_2_ = 0;
          local_78._2_2_ = 0;
          local_78 = uVar21;
          uVar12 = 0;
        }
LAB_18000e07d:
        uVar16 = uVar22;
      } while (uVar22 != 0);
      local_b0 = 0;
      local_b8 = puVar18;
      uVar22 = uVar12;
    }
    iVar27 = 0;
    uVar12 = CONCAT13(bStack_6d,CONCAT12(uStack_6e,uStack_70));
    uVar20 = (ushort)(uVar12 >> 0x10);
    uVar16 = uVar21;
    if (0x3ffe < uVar20) {
      local_c0 = CONCAT22(sVar9 >> 0xf,sVar9 + 1);
      uVar16 = 0;
      local_c4 = 0;
      local_88 = 0;
      uStack_87 = 0;
      uStack_86._0_2_ = 0;
      uStack_86._2_2_ = 0;
      uStack_86 = 0;
      uStack_82._0_2_ = 0;
      uStack_82._2_2_ = 0;
      uStack_82 = 0;
      uStack_7e = 0;
      uVar10 = (local_60._2_2_ ^ uVar20) & 0x8000;
      uVar7 = (uVar20 & 0x7fff) + (local_60._2_2_ & 0x7fff);
      if ((((uVar20 & 0x7fff) < 0x7fff) && ((local_60._2_2_ & 0x7fff) < 0x7fff)) && (uVar7 < 0xbffe)
         ) {
        if (uVar7 < 0x3fc0) {
LAB_18000e118:
          uStack_70 = 0;
          uStack_6e = 0;
          bStack_6d = 0;
          local_78 = uVar16;
        }
        else if ((((uVar12 & 0x7fff0000) == 0) &&
                 (uVar7 = uVar7 + 1,
                 (CONCAT13(bStack_6d,CONCAT12(uStack_6e,uStack_70)) & 0x7fffffff) == 0)) &&
                ((uVar21 == 0 && (local_78 == 0)))) {
          uStack_6e = 0;
          bStack_6d = 0;
          uVar16 = uVar21;
          uStack_86 = 0;
          uStack_82 = 0;
        }
        else {
          if ((((local_60 & 0x7fff0000) == 0) && (uVar7 = uVar7 + 1, (local_60 & 0x7fffffff) == 0))
             && ((local_64 == 0 && (local_68 == 0)))) goto LAB_18000e118;
          puVar14 = (uint *)&local_88;
          uVar21 = uVar22;
          do {
            if (0 < local_a8) {
              puVar29 = (ushort *)&local_60;
              puVar28 = (ushort *)((longlong)&local_78 + (longlong)(iVar27 * 2));
              iVar11 = local_a8;
              do {
                bVar5 = false;
                uVar22 = *puVar14 + (uint)*puVar29 * (uint)*puVar28;
                if ((uVar22 < *puVar14) || (uVar22 < (uint)*puVar29 * (uint)*puVar28)) {
                  bVar5 = true;
                }
                local_78 = uVar21;
                *puVar14 = uVar22;
                uVar21 = local_78;
                if (bVar5) {
                  *(short *)(puVar14 + 1) = (short)puVar14[1] + 1;
                  uVar21 = local_78;
                }
                iVar11 = iVar11 + -1;
                puVar28 = puVar28 + 1;
                puVar29 = puVar29 + -1;
              } while (0 < iVar11);
            }
            local_a8 = local_a8 + -1;
            puVar14 = (uint *)((longlong)puVar14 + 2);
            iVar27 = iVar27 + 1;
          } while (0 < local_a8);
          uVar16 = CONCAT22(uStack_7e,uStack_82._2_2_);
          uVar12 = CONCAT22((undefined2)uStack_86,CONCAT11(uStack_87,local_88));
          uVar7 = uVar7 + 0xc002;
          uVar22 = uVar12;
          if ((short)uVar7 < 1) {
LAB_18000e23d:
            uVar7 = uVar7 - 1;
            if (-1 < (short)uVar7) goto LAB_18000e2a2;
            uVar15 = (ulonglong)(ushort)-uVar7;
            uVar7 = 0;
            iVar27 = local_c4;
            do {
              uVar22 = uVar16;
              if ((local_88 & 1) != 0) {
                iVar27 = iVar27 + 1;
              }
              uVar13 = CONCAT22((ushort)uStack_82,uStack_86._2_2_);
              uVar17 = uVar12 >> 1;
              uStack_82._0_2_ = (ushort)uStack_82 >> 1 | (ushort)((uVar22 << 0x1f) >> 0x10);
              uVar16 = uVar22 >> 1;
              uVar12 = uVar17 | uVar13 << 0x1f;
              uStack_86._2_2_ = (ushort)(uVar13 >> 1);
              local_88 = (byte)uVar17;
              uStack_87 = (undefined1)(uVar17 >> 8);
              uStack_86._0_2_ = (undefined2)(uVar12 >> 0x10);
              uVar15 = uVar15 - 1;
            } while (uVar15 != 0);
            uStack_82._2_2_ = (undefined2)uVar16;
            uStack_7e = (ushort)(uVar22 >> 0x11);
            if (iVar27 == 0) goto LAB_18000e2a2;
            uVar20 = (ushort)uVar17 | 1;
            local_88 = (byte)uVar20;
            uVar12 = CONCAT22((undefined2)uStack_86,(ushort)uVar17) | 1;
          }
          else {
            do {
              uVar12 = uVar22;
              if ((uVar16 & 0x80000000) != 0) break;
              uVar13 = uVar16 * 2;
              uVar12 = uVar22 * 2;
              iVar27 = CONCAT22((ushort)uStack_82,uStack_86._2_2_) * 2;
              uVar7 = uVar7 - 1;
              uStack_86._2_2_ = (ushort)iVar27 | (ushort)(uVar22 >> 0x1f);
              uVar16 = uVar13 | (ushort)uStack_82 >> 0xf;
              local_88 = (byte)uVar12;
              uStack_87 = (undefined1)(uVar12 >> 8);
              uStack_86._0_2_ = (undefined2)(uVar12 >> 0x10);
              uStack_82._0_2_ = (ushort)((uint)iVar27 >> 0x10);
              uStack_82._2_2_ = (undefined2)uVar16;
              uStack_7e = (ushort)(uVar13 >> 0x10);
              uVar22 = uVar12;
            } while (0 < (short)uVar7);
            if ((short)uVar7 < 1) goto LAB_18000e23d;
LAB_18000e2a2:
            uVar20 = CONCAT11(uStack_87,local_88);
          }
          uVar22 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86);
          if ((0x8000 < uVar20) ||
             (iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82), (uVar12 & 0x1ffff) == 0x18000))
          {
            if (CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) == -1) {
              uVar22 = 0;
              if (CONCAT22(uStack_82._2_2_,(ushort)uStack_82) == -1) {
                iVar27 = 0;
                if (uStack_7e == 0xffff) {
                  uStack_7e = 0x8000;
                  uVar7 = uVar7 + 1;
                  iVar27 = 0;
                }
                else {
                  uStack_7e = uStack_7e + 1;
                }
              }
              else {
                iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82) + 1;
              }
              uStack_82._2_2_ = (undefined2)((uint)iVar27 >> 0x10);
              uVar16 = CONCAT22(uStack_7e,uStack_82._2_2_);
            }
            else {
              uVar22 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) + 1;
              iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82);
            }
          }
          uStack_82._0_2_ = (ushort)iVar27;
          uStack_82 = iVar27;
          uStack_86 = uVar22;
          if (uVar7 < 0x7fff) {
            bStack_6d = (byte)(uVar7 >> 8) | (byte)(uVar10 >> 8);
            uStack_72 = (undefined2)uVar16;
            uStack_70 = (ushort)(uVar16 >> 0x10);
            uStack_6e = (undefined1)uVar7;
            uStack_74 = (ushort)uStack_82;
            uVar16 = CONCAT22(uStack_72,(ushort)uStack_82);
            local_78 = uVar22;
          }
          else {
            iVar27 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
            uStack_70 = (ushort)iVar27;
            uStack_6e = (undefined1)((uint)iVar27 >> 0x10);
            bStack_6d = (byte)((uint)iVar27 >> 0x18);
            uVar16 = 0;
            local_78 = 0;
            uVar22 = uVar21;
          }
        }
      }
      else {
        iVar27 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
        uStack_70 = (ushort)iVar27;
        uStack_6e = (undefined1)((uint)iVar27 >> 0x10);
        bStack_6d = (byte)((uint)iVar27 >> 0x18);
        local_78 = uVar16;
      }
    }
    *param_4 = (short)local_c0;
    iVar27 = param_2;
    if (((param_3 & 1) != 0) && (iVar27 = param_2 + (short)local_c0, iVar27 < 1)) {
      uVar6 = 0x20;
      local_78 = uVar22;
      if (local_c6 == 0x8000) {
        uVar6 = 0x2d;
      }
      goto LAB_18000dbd5;
    }
    uVar4 = CONCAT12(uStack_6e,uStack_70);
    uStack_6e = 0;
    uVar21 = (uint)uStack_70;
    lVar23 = 8;
    if (0x15 < iVar27) {
      iVar27 = 0x15;
    }
    iVar11 = (CONCAT13(bStack_6d,uVar4) >> 0x10) - 0x3ffe;
    do {
      uVar22 = uVar16 * 2;
      uVar12 = uVar16 >> 0x1f;
      uVar16 = uVar22 | local_78 >> 0x1f;
      uVar21 = uVar21 * 2 | uVar12;
      local_78 = local_78 * 2;
      lVar23 = lVar23 + -1;
    } while (lVar23 != 0);
    uStack_74 = (undefined2)uVar16;
    uStack_72 = (undefined2)(uVar22 >> 0x10);
    if ((iVar11 < 0) && (uVar22 = -iVar11 & 0xff, uVar22 != 0)) {
      do {
        uVar17 = uVar16 >> 1;
        uVar12 = uVar21 << 0x1f;
        uVar13 = uVar16 << 0x1f;
        uVar22 = uVar22 - 1;
        uVar21 = uVar21 >> 1;
        uVar16 = uVar17 | uVar12;
        local_78 = local_78 >> 1 | uVar13;
      } while (0 < (int)uVar22);
      uStack_74 = (undefined2)uVar17;
      uStack_72 = (undefined2)(uVar16 >> 0x10);
    }
    iVar27 = iVar27 + 1;
    psVar1 = param_4 + 2;
    psVar24 = psVar1;
    if (0 < iVar27) {
      while( true ) {
        local_58 = CONCAT26(uStack_72,CONCAT24(uStack_74,local_78));
        uVar12 = (uVar16 * 2 | local_78 >> 0x1f) * 2 | local_78 * 2 >> 0x1f;
        uVar22 = local_78 * 5;
        uVar13 = (uVar21 * 2 | uVar16 >> 0x1f) * 2 | uVar16 * 2 >> 0x1f;
        if ((uVar22 < local_78 * 4) || (uVar16 = uVar12, uVar22 < local_78)) {
          uVar16 = uVar12 + 1;
          if ((uVar16 < uVar12) || (bVar5 = false, uVar16 == 0)) {
            bVar5 = true;
          }
          if (bVar5) {
            uVar13 = uVar13 + 1;
          }
        }
        uVar12 = (uint)((ulonglong)local_58 >> 0x20);
        uVar17 = uVar16 + uVar12;
        if ((uVar17 < uVar16) || (uVar17 < uVar12)) {
          uVar13 = uVar13 + 1;
        }
        local_78 = local_78 * 10;
        uVar16 = uVar17 * 2 | uVar22 >> 0x1f;
        uVar21 = (uVar13 + uVar21) * 2;
        iVar27 = iVar27 + -1;
        uStack_70 = (ushort)uVar21 | (ushort)(uVar17 >> 0x1f);
        uStack_74 = (undefined2)uVar16;
        uStack_72 = (undefined2)(uVar17 * 2 >> 0x10);
        uStack_6e = (undefined1)(uVar21 >> 0x10);
        *(char *)psVar24 = (char)(uVar21 >> 0x18) + '0';
        psVar24 = (short *)((longlong)psVar24 + 1);
        if (iVar27 < 1) break;
        uVar21 = uVar21 & 0xffffff | uVar17 >> 0x1f;
      }
    }
    bStack_6d = 0;
    psVar25 = psVar24 + -1;
    if ('4' < *(char *)((longlong)psVar24 + -1)) {
      for (; (psVar1 <= psVar25 && ((char)*psVar25 == '9'));
          psVar25 = (short *)((longlong)psVar25 + -1)) {
        *(char *)psVar25 = '0';
      }
      if (psVar25 < psVar1) {
        psVar25 = (short *)((longlong)psVar25 + 1);
        *param_4 = *param_4 + 1;
      }
      *(char *)psVar25 = (char)*psVar25 + '\x01';
LAB_18000e532:
      cVar19 = ((char)psVar25 - (char)param_4) + -3;
      *(char *)((longlong)param_4 + 3) = cVar19;
      *(undefined1 *)((longlong)cVar19 + 4 + (longlong)param_4) = 0;
      goto LAB_18000e546;
    }
    for (; (psVar1 <= psVar25 && ((char)*psVar25 == '0'));
        psVar25 = (short *)((longlong)psVar25 + -1)) {
    }
    if (psVar1 <= psVar25) goto LAB_18000e532;
    *param_4 = 0;
    *(undefined1 *)((longlong)param_4 + 3) = 1;
    uVar6 = 0x20;
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
    }
    *(undefined1 *)(param_4 + 1) = uVar6;
    *(char *)psVar1 = '0';
  }
  *(undefined1 *)((longlong)param_4 + 5) = 0;
LAB_18000e546:
  FUN_180002e10(local_48 ^ (ulonglong)auStack_f8);
  return;
}



BOOL __stdcall IsProcessorFeaturePresent(DWORD ProcessorFeature)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018000e600. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsProcessorFeaturePresent(ProcessorFeature);
  return BVar1;
}



void __stdcall
RtlUnwindEx(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue,
           PCONTEXT ContextRecord,PUNWIND_HISTORY_TABLE HistoryTable)

{
                    // WARNING: Could not recover jumptable at 0x00018000e606. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnwindEx(TargetFrame,TargetIp,ExceptionRecord,ReturnValue,ContextRecord,HistoryTable);
  return;
}



void FUN_18000e610(undefined8 param_1,longlong param_2)

{
  if ((*(longlong *)(param_2 + 0x40) == 0) && (DAT_180017238 != -1)) {
    FUN_1800050d4();
  }
  return;
}



void FUN_18000e636(undefined8 *param_1,longlong param_2)

{
  undefined4 uVar1;
  
  *(undefined8 **)(param_2 + 0x40) = param_1;
  uVar1 = *(undefined4 *)*param_1;
  *(undefined4 *)(param_2 + 0x30) = uVar1;
  *(undefined8 **)(param_2 + 0x38) = param_1;
  *(undefined4 *)(param_2 + 0x28) = uVar1;
  if (*(int *)(param_2 + 0x78) == 1) {
    FUN_1800033a8(*(undefined8 *)(param_2 + 0x70),0,*(longlong *)(param_2 + 0x80));
  }
  FUN_180004d64(*(int *)(param_2 + 0x28),*(undefined8 *)(param_2 + 0x38));
  return;
}



void FUN_18000e67f(void)

{
  FUN_1800089a8(0xd);
  return;
}



void FUN_18000e698(void)

{
  FUN_1800089a8(0xc);
  return;
}



void FUN_18000e6b1(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x80) != 0) {
    FUN_1800089a8(8);
  }
  return;
}



void FUN_18000e6d5(void)

{
  FUN_1800089a8(0xb);
  return;
}



void FUN_18000e6f0(undefined8 param_1,longlong param_2)

{
  FUN_180009928(*(uint *)(param_2 + 0x50));
  return;
}



void FUN_18000e707(void)

{
  FUN_1800089a8(0xc);
  return;
}



void FUN_18000e720(void)

{
  FUN_1800089a8(0xd);
  return;
}



void FUN_18000e739(void)

{
                    // WARNING: Could not recover jumptable at 0x00018000e74e. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection(DAT_1800180d0);
  return;
}



bool FUN_18000e760(undefined8 *param_1)

{
  return *(int *)*param_1 == -0x3ffffffb;
}



void FUN_18000e780(void)

{
  FUN_18000546c();
  return;
}



void FUN_18000e794(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x60) != 0) {
    FUN_1800089a8(0);
  }
  return;
}



void FUN_18000e7b2(void)

{
  FUN_1800089a8(1);
  return;
}



void FUN_18000e7cb(undefined8 param_1,longlong param_2)

{
  FUN_180006b58(*(int *)(param_2 + 0x20),
                *(longlong *)(DAT_1800198c0 + (longlong)*(int *)(param_2 + 0x20) * 8));
  return;
}



void FUN_18000e7f3(void)

{
  FUN_1800089a8(1);
  return;
}



void FUN_18000e80c(void)

{
  FUN_1800089a8(10);
  return;
}



void FUN_18000e825(undefined8 param_1,longlong param_2)

{
  FUN_180006b08(*(ulonglong *)(param_2 + 0x30));
  return;
}



void FUN_18000e83d(undefined8 param_1,longlong param_2)

{
  FUN_180009928(*(uint *)(param_2 + 0x40));
  return;
}


