#include "EgisTouchFP0575.h"


DWORD DAT_18004c108;
undefined LAB_18002ce00;
undefined4 DAT_18004c144;
undefined LAB_18002ce10;
undefined DAT_18004dc00;
undefined DAT_18004dc68;
char DAT_18004dc88;
undefined DAT_18004dc70;
undefined DAT_18004dc78;
undefined DAT_18004dc80;
ulonglong DAT_18004a880;
undefined DAT_180045ab0;
undefined DAT_180045b88;
undefined DAT_180045c50;
undefined DAT_180045ba8;
undefined DAT_180045b58;
undefined DAT_180045b68;
undefined DAT_18002d5b0;
undefined DAT_18002d640;
undefined DAT_18003d520;
undefined *PTR_u_SecurityLogParameter_18004a790;
undefined FUN_1800062ec;
undefined *PTR_FUN_18004a780;
undefined *PTR_FUN_18004a788;
undefined FUN_180006d00;
undefined *PTR_u_SecurityLogMask_18004a798;
undefined *PTR_u_SecurityLogPath_18004a7a0;
undefined FUN_180006b18;
undefined LAB_18000681c;
undefined FUN_180006d68;
undefined FUN_180006640;
undefined *PTR_FUN_18003d5d8;
char DAT_18004a7b0;
undefined4 DAT_18004a7ac;
int DAT_18004c100;
int DAT_18004c104;
undefined *PTR_FUN_18003df28;
pointer PTR_LOOP_18004a7b8;
undefined DAT_18003e118;
undefined *DAT_18004c110;
undefined8 DAT_18004c128;
undefined8 DAT_18004c118;
undefined DAT_18004c130;
undefined8 DAT_18004c910;
undefined *DAT_18004c558;
undefined *PTR_DAT_18004a7e0;
undefined *DAT_18004c318;
undefined *DAT_18004c528;
undefined DAT_18003e178;
undefined *PTR_FUN_18003e188;
undefined FUN_18000c544;
undefined FUN_18000c5a0;
undefined FUN_18000c5d0;
undefined *PTR_LOOP_18004a7b8;
undefined8 DAT_18004c110;
undefined FUN_18000c87c;
undefined DAT_18003e200;
pointer PTR_FUN_18003e238;
pointer PTR_FUN_18003e240;
pointer PTR_FUN_18003e248;
undefined *PTR_FUN_18003e258;
undefined *DAT_18004c1e0;
undefined *DAT_18004c5b8;
undefined *DAT_18004c578;
undefined *DAT_18004c228;
undefined *DAT_18004c230;
undefined DAT_18003e138;
undefined DAT_18003e210;
undefined *PTR_DAT_18004a808;
undefined *DAT_18004c1f8;
undefined *DAT_18004c1e8;
undefined *DAT_18004c200;
undefined *DAT_18004c218;
undefined FUN_18000ce6c;
undefined FUN_18000ce90;
undefined FUN_18000cec0;
undefined FUN_18000cef0;
undefined FUN_18000cf10;
undefined FUN_18000cf34;
undefined FUN_18000cf58;
undefined FUN_18000cf7c;
undefined *DAT_18004c298;
undefined *DAT_18004c698;
undefined *DAT_18004c668;
undefined *DAT_18004c300;
undefined *DAT_18004c670;
undefined DAT_18003e220;
undefined *DAT_18004c270;
undefined *DAT_18004c278;
undefined *DAT_18004c5a8;
undefined *DAT_18004c5d8;
undefined *PTR_IMAGE_DOS_HEADER_18004a7c0;
undefined *DAT_18004c570;
undefined DAT_18003e168;
undefined DAT_18003e488;
undefined *PTR_FUN_18003e570;
undefined *PTR_FUN_18003e498;
undefined *PTR_FUN_18003e500;
undefined *DAT_18004c5e8;
undefined FUN_18000fe28;
char DAT_18004c140;
undefined DAT_18003e700;
undefined DAT_18003eb40;
undefined DAT_18003ec30;
undefined DAT_18003ec50;
undefined DAT_18003ec90;
undefined DAT_18003ed10;
undefined DAT_18003ef10;
undefined *PTR_FUN_18003f4c0;
undefined *PTR_LAB_18003f558;
undefined DAT_18003f060;
undefined *PTR_FUN_18003f128;
undefined *PTR_FUN_18003f070;
undefined *DAT_18004c730;
undefined *DAT_18004c5e0;
undefined *DAT_18004c5c0;
undefined FUN_180018b28;
undefined FUN_180018b70;
undefined DAT_18003f2c0;
undefined FUN_180017568;
undefined FUN_1800178d8;
undefined *DAT_18004c590;
pointer PTR_FUN_18003f6d8;
pointer PTR_FUN_18003f6e0;
undefined DAT_18003f6c8;
undefined *PTR_DAT_18004a830;
undefined *DAT_18004c3f8;
undefined *DAT_18004c290;
undefined FUN_180019800;
undefined FUN_180019824;
undefined DAT_18004c410;
undefined DAT_18004c408;
undefined *DAT_18004c1d0;
undefined *DAT_18004c640;
undefined *DAT_18004c548;
undefined *DAT_18004c7a0;
undefined *DAT_18004c7e0;
undefined *DAT_18004c8b0;
undefined *DAT_18004c8c0;
undefined *DAT_18004c8c8;
undefined *DAT_18004c830;
undefined *DAT_18004c818;
undefined DAT_18003f6e8;
undefined *DAT_18004c508;
undefined *DAT_18004c7b0;
undefined *DAT_18004c7b8;
undefined *DAT_18004c7c8;
undefined *DAT_18004c5f0;
undefined *DAT_18004c500;
undefined *DAT_18004c7f8;
undefined *DAT_18004c610;
undefined *DAT_18004c618;
undefined *DAT_18004c658;
undefined *DAT_18004c1d8;
undefined *DAT_18004c678;
undefined *DAT_18004c690;
undefined *DAT_18004c680;
undefined *DAT_18004c688;
undefined *DAT_18004c850;
undefined *DAT_18004c540;
undefined *DAT_18004c840;
undefined DAT_18003f708;
undefined DAT_18003f728;
undefined *PTR_FUN_18003f738;
undefined *DAT_18004c568;
undefined DAT_18003f888;
undefined DAT_18003f8b0;
undefined DAT_18003f948;
pointer PTR_FUN_18003f958;
int DAT_18004c144;
undefined *DAT_18004c630;
undefined *DAT_18004c6c8;
undefined *DAT_18004c420;
undefined *DAT_18004c498;
undefined FUN_18001d85c;
undefined *DAT_18004c6a0;
undefined *DAT_18004c4f0;
undefined *DAT_18004c5f8;
undefined *DAT_18004c620;
undefined FUN_18001dd30;
uint DAT_18004c918;
undefined DAT_18004c148;
undefined DAT_18004a848;
undefined *PTR_DAT_18004c0e8;
undefined4 DAT_18004c0e0;
HANDLE DAT_18004ceb0;
int DAT_18004d558;
longlong DAT_18004a880;
uint DAT_18004d55c;
undefined LAB_18001ff60;
pointer[2] vftable;
undefined DAT_180047e90;
PVOID DAT_18004ede8;
PVOID DAT_18004ede0;
int DAT_18004ce90;
undefined8 DAT_18004cab8;
undefined DAT_18004ca58;
undefined DAT_18004c930;
undefined DAT_18004ca40;
undefined DAT_18004c920;
undefined DAT_18004c924;
undefined DAT_18004c938;
undefined8 DAT_18004a880;
undefined8 DAT_18004a888;
undefined8 DAT_18004c940;
pointer PTR_DAT_18003fce8;
undefined DAT_18004c9c0;
void *StackLimit;
undefined DAT_18003fcf8;
undefined *PTR_LAB_18004aa28;
undefined *PTR_LAB_18004aa20;
undefined *PTR_LAB_18004aa30;
undefined *PTR_LAB_18004aa48;
undefined *PTR_LAB_18004aa38;
undefined FUN_180023ad0;
undefined *PTR_LAB_18004aa40;
undefined FUN_180023b70;
undefined *PTR_LAB_18004aa50;
undefined FUN_180023bb8;
undefined *PTR_LAB_18004aa58;
undefined *PTR_LAB_18004aa60;
undefined *PTR_LAB_18004aa68;
undefined LAB_180023ac8;
undefined LAB_180023b68;
undefined LAB_180023bb0;
undefined LAB_180023c38;
undefined FUN_180023014;
undefined FUN_180023038;
int DAT_18004aa10;
PVOID DAT_18004d568;
undefined *PTR_DAT_18004b290;
uint DAT_18004b408;
undefined *PTR_DAT_18004afb0;
int DAT_18004d59c;
pointer PTR_DAT_18004b3f8;
LPSTR DAT_18004edf8;
LPSTR DAT_18004cea0;
int DAT_18004ce98;
int DAT_18004cf00;
DWORD DAT_18004afb8;
undefined4 DAT_18004aa0c;
undefined DAT_18004aa08;
undefined4 DAT_18004a8a0;
undefined DAT_18004a8a4;
undefined8 DAT_18004ceb0;
PVOID DAT_18004ceb8;
undefined8 DAT_18004ceb8;
undefined8 *DAT_18004cee0;
undefined8 *DAT_18004ced8;
LPVOID DAT_18004ced0;
LPVOID DAT_18004cec8;
LPVOID DAT_18004db18;
LPVOID DAT_18004db20;
undefined4 DAT_18004ac90;
undefined *DAT_18004edd8;
undefined DAT_18002d4d8;
undefined DAT_18002d4f8;
undefined DAT_18002d500;
undefined DAT_18002d528;
undefined FUN_180026878;
int DAT_18004cec0;
undefined4 DAT_18004cf00;
undefined1 DAT_18004cefc;
undefined DAT_18002d530;
undefined DAT_18002d550;
undefined DAT_18002d558;
undefined DAT_18002d560;
int DAT_18004cf20;
undefined4 DAT_18003fd40;
pointer PTR_u_R6002_-_floating_point_support_n_18003fd48;
undefined DAT_18004d16a;
undefined DAT_180040848;
undefined DAT_180040850;
undefined DAT_18004ceec;
undefined DAT_18004cf30;
undefined DAT_18004cf62;
undefined DAT_18004aa14;
undefined4 DAT_18004aa10;
pointer[1] vftable;
uint DAT_18004d560;
undefined *DAT_18004edd0;
undefined DAT_18004edc8;
ulonglong DAT_18004ecc0;
ulonglong DAT_18004ecc8;
ulonglong DAT_18004ecd0;
ulonglong DAT_18004ecd8;
ulonglong DAT_18004ece0;
int DAT_18004aa18;
ulonglong DAT_18004eda8;
undefined DAT_18004ece8;
undefined DAT_18004ecf0;
undefined DAT_18004ecf8;
undefined DAT_18004ed00;
undefined DAT_18004ed08;
undefined DAT_18004ed10;
undefined DAT_18004ed18;
undefined DAT_18004ed20;
undefined DAT_18004ed28;
undefined DAT_18004ed30;
undefined DAT_18004ed38;
undefined DAT_18004ed40;
undefined DAT_18004ed48;
undefined DAT_18004ed50;
undefined DAT_18004ed58;
undefined DAT_18004ed60;
undefined DAT_18004ed70;
undefined DAT_18004ed68;
undefined DAT_18004ed78;
undefined DAT_18004ed80;
undefined DAT_18004ed88;
undefined DAT_18004ed90;
undefined DAT_18004ed98;
ulonglong DAT_18004eda0;
undefined DAT_18004edb0;
undefined DAT_18004edb8;
undefined DAT_18004edc0;
int DAT_18004b8a4;
byte DAT_18004db68;
pointer PTR_LAB_18004aa20;
uint DAT_18004aa70;
undefined DAT_18004aa70;
undefined8 DAT_18004d568;
undefined8 DAT_18004d570;
PVOID DAT_18004d570;
undefined DAT_18004b430;
undefined8 DAT_18004d5a0;
undefined *PTR_DAT_18004b418;
undefined *PTR_u_(null)_18004b420;
undefined1 DAT_180041100;
undefined DAT_180041120;
undefined DAT_18004afc0;
undefined *PTR_DAT_18004afd0;
pointer PTR_DAT_18004bc70;
undefined DAT_18004b2a0;
int DAT_18004edf0;
undefined4 DAT_18004d598;
undefined DAT_18004b408;
undefined DAT_18004d578;
undefined DAT_18004d57c;
undefined DAT_18004d590;
undefined DAT_18004aa80;
undefined1 DAT_18004ab90;
undefined DAT_18004d580;
int DAT_18004d598;
undefined1 DAT_18004aeb8;
undefined4 DAT_18004aec0;
undefined DAT_18004aed0;
undefined DAT_180041180;
int DAT_18004afb8;
pointer PTR_DAT_18004b290;
int DAT_18004eca0;
longlong DAT_18004dc90;
undefined1 DAT_18004d8a4;
byte *DAT_18004edf8;
undefined DAT_18004cee8;
undefined8 *DAT_18004cec8;
undefined DAT_18004cec4;
undefined DAT_18004d7a0;
ulonglong *DAT_18004cea0;
undefined DAT_18004edf4;
ulonglong DAT_18004a888;
undefined8 DAT_180045f10;
undefined8 DAT_180045f20;
undefined8 DAT_18004b490;
undefined4 DAT_18004b498;
longlong DAT_18004ceb0;
LPCRITICAL_SECTION DAT_18004b530;
undefined DAT_18004d8b0;
IMAGE_DOS_HEADER IMAGE_DOS_HEADER_180000000;
undefined DAT_18004dae0;
undefined FUN_180026b90;
PVOID DAT_18004daf8;
undefined8 DAT_18004dae8;
undefined8 DAT_18004daf0;
undefined8 DAT_18004daf8;
undefined8 DAT_18004db00;
undefined DAT_18004db10;
int DAT_18004db28;
PVOID DAT_18004db30;
PVOID DAT_18004db38;
PVOID DAT_18004db40;
PVOID DAT_18004db50;
PVOID DAT_18004db48;
longlong *DAT_18004db60;
undefined DAT_18004db58;
char DAT_18004b8a0;
undefined *PTR_DAT_18004b3a8;
pointer PTR_DAT_1800421e0;
undefined DAT_1800421e8;
undefined DAT_1800413a0;
int DAT_18004dc98;
LPVOID DAT_18004dc90;
pointer PTR_DAT_18004b8b0;
char DAT_18004cefc;
uint DAT_18004eca0;
undefined DAT_18004db78;
ulonglong DAT_18004db80;
undefined *PTR_DAT_18004bc88;
undefined *PTR_DAT_18004bc90;
undefined *PTR_DAT_18004bc98;
undefined *PTR_DAT_18004bca0;
undefined *PTR_DAT_18004bca8;
undefined *PTR_DAT_18004bcb0;
undefined *PTR_DAT_18004bcb8;
undefined *PTR_DAT_18004bcd8;
undefined *PTR_DAT_18004bce0;
undefined *PTR_DAT_18004bce8;
undefined *PTR_DAT_18004bcf0;
undefined *PTR_DAT_18004bcf8;
undefined *PTR_DAT_18004bd00;
undefined *PTR_DAT_18004bc70;
undefined *PTR_DAT_18004bc78;
undefined *PTR_DAT_18004bc80;
undefined *PTR_DAT_18004bcc8;
undefined *PTR_DAT_18004bcd0;
undefined4 null;
uint null;
int DAT_18004bd5c;
int DAT_18004bd60;
int DAT_18004bd58;
int DAT_18004bd54;
int DAT_18004bd50;
int DAT_18004bd64;
int DAT_18004bd74;
int DAT_18004bd78;
int DAT_18004bd70;
int DAT_18004bd6c;
int DAT_18004bd68;
int DAT_18004bd7c;
undefined *PTR_DAT_18004bd20;
HANDLE DAT_18004c040;
undefined1 DAT_18004dc89;
undefined DAT_1800458c0;

void FUN_180001000(void)

{
  DAT_18004c108 = TlsAlloc();
  FUN_180020978(&LAB_18002ce00);
  return;
}



void FUN_180001020(void)

{
  DAT_18004c144 = FUN_18001b3e4(10,0,0);
  return;
}



void FUN_18000103c(void)

{
  FUN_18002ca70((undefined4 *)&DAT_18004dc00);
  FUN_180020978(&LAB_18002ce10);
  return;
}



bool FUN_180001060(PUCHAR param_1,ULONG param_2)

{
  NTSTATUS NVar1;
  BCRYPT_ALG_HANDLE local_res18 [2];
  
  NVar1 = BCryptOpenAlgorithmProvider(local_res18,L"RNG",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenRandom(local_res18[0],param_1,param_2,0);
    BCryptCloseAlgorithmProvider(local_res18[0],0);
  }
  return -1 < NVar1;
}



bool FUN_1800010d0(undefined8 *param_1,ULONG *param_2,uint param_3,PUCHAR param_4)

{
  NTSTATUS NVar1;
  uint uVar2;
  BCRYPT_HASH_HANDLE local_28;
  BCRYPT_ALG_HANDLE local_20;
  
  uVar2 = 0;
  local_20 = (BCRYPT_ALG_HANDLE)0x0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_20,L"SHA256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_20,&local_28,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
    if (-1 < NVar1) {
      if (param_3 != 0) {
        do {
          if (((PUCHAR)*param_1 != (PUCHAR)0x0) && (*param_2 != 0)) {
            NVar1 = BCryptHashData(local_28,(PUCHAR)*param_1,*param_2,0);
            if (NVar1 < 0) goto LAB_1800011a5;
          }
          uVar2 = uVar2 + 1;
          param_1 = param_1 + 1;
          param_2 = param_2 + 1;
        } while (uVar2 < param_3);
      }
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_28,param_4,0x20,0);
      }
LAB_1800011a5:
      BCryptDestroyHash(local_28);
    }
    BCryptCloseAlgorithmProvider(local_20,0);
  }
  return -1 < NVar1;
}



void FUN_1800011f0(undefined8 param_1,ULONG param_2,PUCHAR param_3)

{
  undefined8 local_res8;
  ULONG local_res10 [6];
  
  local_res8 = param_1;
  local_res10[0] = param_2;
  FUN_1800010d0(&local_res8,local_res10,1,param_3);
  return;
}



bool FUN_180001220(PUCHAR param_1,ULONG param_2,undefined8 *param_3,ULONG *param_4,uint param_5,
                  PUCHAR param_6,undefined8 *param_7)

{
  NTSTATUS NVar1;
  uint uVar2;
  BCRYPT_HASH_HANDLE local_28 [2];
  
  NVar1 = BCryptCreateHash((BCRYPT_ALG_HANDLE)*param_7,local_28,(PUCHAR)0x0,0,param_1,param_2,0);
  if (-1 < NVar1) {
    uVar2 = 0;
    if (param_5 != 0) {
      do {
        if ((((PUCHAR)*param_3 != (PUCHAR)0x0) && (*param_4 != 0)) &&
           (NVar1 = BCryptHashData(local_28[0],(PUCHAR)*param_3,*param_4,0), NVar1 < 0))
        goto LAB_1800012e3;
        uVar2 = uVar2 + 1;
        param_3 = param_3 + 1;
        param_4 = param_4 + 1;
      } while (uVar2 < param_5);
    }
    if (-1 < NVar1) {
      NVar1 = BCryptFinishHash(local_28[0],param_6,0x20,0);
    }
LAB_1800012e3:
    BCryptDestroyHash(local_28[0]);
  }
  BCryptCloseAlgorithmProvider((BCRYPT_ALG_HANDLE)*param_7,0);
  return -1 < NVar1;
}



bool FUN_180001330(PUCHAR param_1,ULONG param_2,undefined8 param_3,ULONG param_4,PUCHAR param_5)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined8 local_res18;
  ULONG local_res20 [2];
  BCRYPT_ALG_HANDLE local_18 [2];
  
  local_res18 = param_3;
  local_res20[0] = param_4;
  NVar2 = BCryptOpenAlgorithmProvider(local_18,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar2) {
    bVar1 = FUN_180001220(param_1,param_2,&local_res18,local_res20,1,param_5,local_18);
    return bVar1;
  }
  return false;
}



NTSTATUS FUN_1800013c0(undefined8 *param_1,ULONG *param_2,undefined8 param_3,int *param_4,
                      undefined8 param_5,PUCHAR param_6)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined7 extraout_var;
  wchar_t *pszAlgId;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_ALG_HANDLE local_38;
  UCHAR local_30 [40];
  
  local_48[0] = 0x40;
  local_38 = (BCRYPT_ALG_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  bVar1 = FUN_1800010d0(param_1,param_2,1,local_30);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    NVar2 = -0x3fffffff;
  }
  else {
    pszAlgId = L"ECDSA_P256";
    if (*param_4 == 0x324b4345) {
      pszAlgId = L"ECDH_P256";
    }
    NVar2 = BCryptOpenAlgorithmProvider(&local_38,pszAlgId,(LPCWSTR)0x0,0);
    if (-1 < NVar2) {
      NVar2 = BCryptImportKeyPair(local_38,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_40,
                                  (PUCHAR)param_4,0x68,0);
      if (-1 < NVar2) {
        NVar2 = BCryptSignHash(local_40,(void *)0x0,local_30,0x20,param_6,local_48[0],local_48,0);
        if (-1 < NVar2) {
          NVar2 = 0;
        }
      }
    }
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
    local_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38,0);
  }
  return NVar2;
}



NTSTATUS FUN_1800014f0(undefined8 *param_1,ULONG *param_2,undefined8 param_3,int *param_4,
                      undefined8 param_5,PUCHAR param_6)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined7 extraout_var;
  wchar_t *pwVar3;
  BCRYPT_KEY_HANDLE local_38;
  BCRYPT_ALG_HANDLE local_30;
  UCHAR local_28 [32];
  
  local_30 = (BCRYPT_ALG_HANDLE)0x0;
  local_38 = (BCRYPT_KEY_HANDLE)0x0;
  bVar1 = FUN_1800010d0(param_1,param_2,1,local_28);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    NVar2 = -0x3fffffff;
  }
  else {
    pwVar3 = L"ECDSA_P256";
    if (*param_4 == 0x314b4345) {
      pwVar3 = L"ECDH_P256";
    }
    NVar2 = BCryptOpenAlgorithmProvider(&local_30,pwVar3,(LPCWSTR)0x0,0);
    if (-1 < NVar2) {
      pwVar3 = L"ECCPUBLICBLOB";
      if (*param_4 == 0x32534345) {
        pwVar3 = L"ECCPRIVATEBLOB";
      }
      NVar2 = BCryptImportKeyPair(local_30,(BCRYPT_KEY_HANDLE)0x0,pwVar3,&local_38,(PUCHAR)param_4,
                                  0x48,0);
      if (-1 < NVar2) {
        NVar2 = BCryptVerifySignature(local_38,(void *)0x0,local_28,0x20,param_6,0x40,0);
        if (-1 < NVar2) {
          NVar2 = 0;
        }
      }
    }
  }
  if (local_38 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_38);
    local_38 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_30 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_30,0);
  }
  return NVar2;
}



NTSTATUS FUN_180001610(PUCHAR param_1,PUCHAR param_2,PVOID param_3,ULONG param_4,PUCHAR param_5,
                      ULONG param_6)

{
  NTSTATUS NVar1;
  BCRYPT_ALG_HANDLE local_68;
  BCRYPT_SECRET_HANDLE local_60;
  BCRYPT_KEY_HANDLE local_58;
  BCRYPT_KEY_HANDLE local_50;
  BCryptBufferDesc local_48;
  _BCryptBuffer local_38;
  undefined8 local_28;
  wchar_t *local_20;
  
  local_68 = (BCRYPT_ALG_HANDLE)0x0;
  local_50 = (BCRYPT_KEY_HANDLE)0x0;
  local_58 = (BCRYPT_KEY_HANDLE)0x0;
  local_60 = (BCRYPT_SECRET_HANDLE)0x0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"ECDH_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptImportKeyPair(local_68,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_50,param_1,
                                0x68,0);
    if (-1 < NVar1) {
      NVar1 = BCryptImportKeyPair(local_68,(BCRYPT_KEY_HANDLE)0x0,L"ECCPUBLICBLOB",&local_58,param_2
                                  ,0x48,0);
      if (-1 < NVar1) {
        NVar1 = BCryptSecretAgreement(local_50,local_58,&local_60,0);
        if (-1 < NVar1) {
          local_20 = L"SHA256";
          local_48.pBuffers = &local_38;
          local_38.BufferType = 3;
          local_28 = 0xe;
          local_48.cBuffers = 2;
          local_48.ulVersion = 0;
          local_38.cbBuffer = param_4;
          local_38.pvBuffer = param_3;
          NVar1 = BCryptDeriveKey(local_60,L"HMAC",&local_48,param_5,param_6,&param_6,0);
          if (-1 < NVar1) {
            NVar1 = 0;
          }
        }
      }
    }
  }
  if (local_60 != (BCRYPT_SECRET_HANDLE)0x0) {
    BCryptDestroySecret(local_60);
  }
  if (local_58 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_58);
  }
  if (local_50 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_50);
  }
  if (local_68 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_68,0);
  }
  return NVar1;
}



bool FUN_1800017d0(undefined8 *param_1,undefined8 param_2,ULONG param_3,PUCHAR param_4)

{
  NTSTATUS NVar1;
  undefined8 uVar2;
  undefined8 local_res10;
  ULONG local_res18 [4];
  undefined8 in_stack_ffffffffffffff68;
  int local_78 [18];
  undefined8 local_30;
  undefined8 uStack_28;
  undefined8 local_20;
  undefined8 uStack_18;
  
  uVar2 = 0x68;
  local_res10 = param_2;
  local_res18[0] = param_3;
  FUN_180020400((undefined1 (*) [16])local_78,0,0x68);
  local_30 = *param_1;
  uStack_28 = param_1[1];
  local_20 = param_1[2];
  uStack_18 = param_1[3];
  local_78[0] = 0x32534345;
  local_78[1] = 0x20;
  NVar1 = FUN_1800013c0(&local_res10,local_res18,uVar2,local_78,in_stack_ffffffffffffff68,param_4);
  return -1 < NVar1;
}



bool FUN_180001860(undefined8 *param_1,undefined8 param_2,undefined8 param_3,PUCHAR param_4,
                  undefined4 *param_5)

{
  NTSTATUS NVar1;
  undefined8 local_res10;
  ULONG local_res18 [4];
  undefined8 in_stack_ffffffffffffff88;
  int local_58 [2];
  undefined8 local_50;
  undefined8 uStack_48;
  undefined8 local_40;
  undefined8 uStack_38;
  undefined8 local_30;
  undefined8 uStack_28;
  undefined8 local_20;
  undefined8 uStack_18;
  
  local_res18[0] = (ULONG)param_3;
  local_50 = *param_1;
  uStack_48 = param_1[1];
  local_40 = param_1[2];
  uStack_38 = param_1[3];
  local_30 = param_1[4];
  uStack_28 = param_1[5];
  local_20 = param_1[6];
  uStack_18 = param_1[7];
  local_58[0] = 0x31534345;
  local_58[1] = 0x20;
  local_res10 = param_2;
  NVar1 = FUN_1800014f0(&local_res10,local_res18,param_3,local_58,in_stack_ffffffffffffff88,param_4)
  ;
  if (-1 < NVar1) {
    *param_5 = 1;
    return true;
  }
  *param_5 = 0;
  return NVar1 == -0x3fff6000;
}



bool FUN_180001920(PUCHAR param_1)

{
  NTSTATUS NVar1;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  
  local_res20 = (BCRYPT_ALG_HANDLE)0x0;
  local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"ECDSA_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptImportKeyPair(local_res20,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_res18,
                                param_1,0x68,0);
    if (-1 < NVar1) {
      NVar1 = BCryptExportKey(local_res18,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",param_1,0x68,
                              local_res10,0);
      if (-1 < NVar1) {
        NVar1 = 0;
      }
    }
  }
  if (local_res18 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res18);
    local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_res20 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_res20,0);
  }
  return -1 < NVar1;
}



bool FUN_180001a00(PUCHAR param_1,int param_2)

{
  NTSTATUS NVar1;
  wchar_t *pszAlgId;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  
  pszAlgId = L"ECDSA_P256";
  if (param_2 != 0) {
    pszAlgId = L"ECDH_P256";
  }
  local_res20 = (BCRYPT_ALG_HANDLE)0x0;
  local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,pszAlgId,(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenerateKeyPair(local_res20,&local_res18,0x100,0);
    if (-1 < NVar1) {
      NVar1 = BCryptFinalizeKeyPair(local_res18,0);
      if (-1 < NVar1) {
        NVar1 = BCryptExportKey(local_res18,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",param_1,0x68,
                                local_res10,0);
        if (-1 < NVar1) {
          NVar1 = 0;
        }
      }
    }
  }
  if (local_res18 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res18);
    local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_res20 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_res20,0);
  }
  return -1 < NVar1;
}



undefined4 *
FUN_180001af0(uint param_1,uint param_2,undefined8 *param_3,undefined8 *param_4,undefined8 *param_5,
             uint *param_6)

{
  undefined4 *puVar1;
  uint uVar2;
  
  uVar2 = param_2 + 0x18 + param_1;
  puVar1 = (undefined4 *)LocalAlloc(0,(ulonglong)uVar2);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = 0x31415352;
    puVar1[1] = param_1 * 8;
    *(undefined8 *)(puVar1 + 4) = 0;
    puVar1[2] = param_2;
    puVar1[3] = param_1;
    FUN_18001fe80((undefined8 *)(puVar1 + 6),param_3,(ulonglong)param_2);
    FUN_18001fe80((undefined8 *)((ulonglong)param_2 + (longlong)(puVar1 + 6)),param_4,
                  (ulonglong)param_1);
    *param_5 = puVar1;
    *param_6 = uVar2;
    puVar1 = (undefined4 *)0x1;
  }
  return puVar1;
}



undefined4 FUN_180001bb0(longlong param_1)

{
  return *(undefined4 *)(param_1 + 4);
}



void FUN_180001bc0(HLOCAL param_1)

{
  if (param_1 != (HLOCAL)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180001bc5. Too many branches
                    // WARNING: Treating indirect jump as call
    LocalFree(param_1);
    return;
  }
  return;
}



bool FUN_180001bd0(int *param_1,ULONG param_2,PUCHAR param_3,ULONG param_4,PUCHAR param_5,
                  ULONG param_6,ULONG *param_7)

{
  NTSTATUS NVar1;
  wchar_t *pszBlobType;
  ULONG *pcbResult;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_58;
  BCRYPT_ALG_HANDLE local_50;
  wchar_t *local_48;
  undefined8 local_40;
  undefined4 local_38;
  
  local_48 = L"SHA256";
  local_40 = 0;
  pcbResult = local_res10;
  if (param_7 != (ULONG *)0x0) {
    pcbResult = param_7;
  }
  local_50 = (BCRYPT_ALG_HANDLE)0x0;
  local_58 = (BCRYPT_KEY_HANDLE)0x0;
  local_38 = 0;
  local_res10[0] = 0;
  if (param_2 == 0) {
    if (*param_1 == 0x31415352) {
      param_2 = param_1[2] + 0x18 + param_1[3];
    }
    else if (*param_1 == 0x33415352) {
      param_2 = (param_1[4] + 8) * 3 + (param_1[5] + param_1[3]) * 2 + param_1[2];
    }
  }
  NVar1 = BCryptOpenAlgorithmProvider(&local_50,L"RSA",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    pszBlobType = L"RSAFULLPRIVATEBLOB";
    if (*param_1 == 0x31415352) {
      pszBlobType = L"RSAPUBLICBLOB";
    }
    NVar1 = BCryptImportKeyPair(local_50,(BCRYPT_KEY_HANDLE)0x0,pszBlobType,&local_58,
                                (PUCHAR)param_1,param_2,0);
    if (-1 < NVar1) {
      NVar1 = BCryptEncrypt(local_58,param_3,param_4,&local_48,(PUCHAR)0x0,0,param_5,param_6,
                            pcbResult,4);
      if (-1 < NVar1) {
        NVar1 = 0;
      }
    }
  }
  if (local_58 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_58);
    local_58 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_50 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_50,0);
  }
  return -1 < NVar1;
}



undefined8
FUN_180001d60(undefined8 *param_1,undefined8 param_2,undefined8 *param_3,ulonglong param_4)

{
  NTSTATUS NVar1;
  undefined8 uVar2;
  BCRYPT_KEY_HANDLE local_res10 [2];
  ulonglong local_res20;
  BCRYPT_ALG_HANDLE local_98 [2];
  UCHAR local_88 [8];
  undefined8 local_80;
  undefined8 uStack_78;
  undefined8 local_70;
  undefined8 uStack_68;
  undefined8 local_60;
  undefined8 uStack_58;
  undefined8 local_50;
  undefined8 uStack_48;
  undefined8 local_40;
  undefined8 uStack_38;
  undefined8 local_30;
  undefined8 uStack_28;
  
  local_98[0] = (BCRYPT_ALG_HANDLE)0x0;
  local_res10[0] = (BCRYPT_KEY_HANDLE)0x0;
  local_res20 = param_4 & 0xffffffff00000000;
  NVar1 = BCryptOpenAlgorithmProvider(local_98,L"ECDH_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenerateKeyPair(local_98[0],local_res10,0x100,0);
    if (-1 < NVar1) {
      NVar1 = BCryptFinalizeKeyPair(local_res10[0],0);
      if (-1 < NVar1) {
        NVar1 = BCryptExportKey(local_res10[0],(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",local_88,
                                0x68,(ULONG *)&local_res20,0);
        if (-1 < NVar1) {
          NVar1 = 0;
        }
      }
    }
  }
  if (local_res10[0] != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res10[0]);
    local_res10[0] = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_98[0] != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_98[0],0);
  }
  if (NVar1 < 0) {
    uVar2 = 0;
  }
  else {
    if (param_1 != (undefined8 *)0x0) {
      *param_1 = local_40;
      param_1[1] = uStack_38;
      param_1[2] = local_30;
      param_1[3] = uStack_28;
    }
    if (param_3 != (undefined8 *)0x0) {
      *param_3 = local_80;
      param_3[1] = uStack_78;
      param_3[2] = local_70;
      param_3[3] = uStack_68;
      param_3[4] = local_60;
      param_3[5] = uStack_58;
      param_3[6] = local_50;
      param_3[7] = uStack_48;
    }
    uVar2 = 1;
  }
  return uVar2;
}



bool FUN_180001ec0(undefined8 *param_1,int param_2,undefined8 *param_3,int param_4,PVOID param_5,
                  ULONG param_6,PUCHAR param_7,ULONG param_8)

{
  NTSTATUS NVar1;
  UCHAR local_c8 [8];
  undefined8 local_c0;
  undefined8 uStack_b8;
  undefined8 local_b0;
  undefined8 uStack_a8;
  undefined8 local_a0;
  undefined8 uStack_98;
  undefined8 local_90;
  undefined8 uStack_88;
  UCHAR local_78 [72];
  undefined8 local_30;
  undefined8 uStack_28;
  undefined8 local_20;
  undefined8 uStack_18;
  
  if ((param_2 == 0x20) && (param_4 == 0x40)) {
    FUN_180020400((undefined1 (*) [16])local_78,0,0x68);
    local_30 = *param_1;
    uStack_28 = param_1[1];
    local_20 = param_1[2];
    uStack_18 = param_1[3];
    local_c0 = *param_3;
    uStack_b8 = param_3[1];
    builtin_memcpy(local_78,"ECK2",4);
    local_b0 = param_3[2];
    uStack_a8 = param_3[3];
    local_a0 = param_3[4];
    uStack_98 = param_3[5];
    local_78[4] = ' ';
    local_78[5] = '\0';
    local_78[6] = '\0';
    local_78[7] = '\0';
    builtin_memcpy(local_c8,"ECK1 ",6);
    local_c8[6] = '\0';
    local_c8[7] = '\0';
    local_90 = param_3[6];
    uStack_88 = param_3[7];
    NVar1 = FUN_180001610(local_78,local_c8,param_5,param_6,param_7,param_8);
    return -1 < NVar1;
  }
  return false;
}



bool FUN_180001fc0(PUCHAR param_1,uint param_2,PUCHAR param_3,PUCHAR param_4,uint param_5,
                  PUCHAR param_6,ULONG param_7,ULONG *param_8)

{
  uint uVar1;
  PUCHAR pUVar2;
  NTSTATUS NVar3;
  uint cbInput;
  uint *pcbResult;
  BCRYPT_KEY_HANDLE local_38;
  BCRYPT_ALG_HANDLE local_30;
  
  uVar1 = param_5;
  cbInput = (param_5 / param_2) * param_2;
  pcbResult = &param_5;
  if (param_8 != (ULONG *)0x0) {
    pcbResult = param_8;
  }
  local_30 = (BCRYPT_HANDLE)0x0;
  local_38 = (BCRYPT_KEY_HANDLE)0x0;
  param_5 = 0;
  NVar3 = BCryptOpenAlgorithmProvider(&local_30,L"AES",(LPCWSTR)0x0,0);
  if ((-1 < NVar3) &&
     (NVar3 = BCryptSetProperty(local_30,L"ChainingMode",(PUCHAR)L"ChainingModeCBC",0x20,0),
     -1 < NVar3)) {
    NVar3 = BCryptGenerateSymmetricKey(local_30,&local_38,(PUCHAR)0x0,0,param_1,param_2,0);
    pUVar2 = param_6;
    if (-1 < NVar3) {
      if (cbInput != 0) {
        NVar3 = BCryptEncrypt(local_38,param_4,cbInput,(void *)0x0,param_3,0x10,param_6,param_7,
                              pcbResult,0);
        if (NVar3 < 0) goto LAB_180002119;
        if (cbInput != *pcbResult) {
          NVar3 = -0x3fffffff;
          goto LAB_180002119;
        }
      }
      NVar3 = 0;
      if (cbInput < uVar1) {
        if (param_4 != pUVar2) {
          FUN_18001fe80((undefined8 *)(pUVar2 + cbInput),(undefined8 *)(param_4 + cbInput),
                        (ulonglong)(uVar1 - cbInput));
        }
        *pcbResult = uVar1;
      }
    }
  }
LAB_180002119:
  if (local_38 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_38);
    local_38 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_30 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_30,0);
  }
  return -1 < NVar3;
}



bool FUN_180002170(PUCHAR param_1,undefined8 param_2,PUCHAR param_3,PUCHAR param_4,uint param_5,
                  PUCHAR param_6,ULONG param_7)

{
  NTSTATUS NVar1;
  uint cbInput;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE pvStack0000000000000040;
  BCRYPT_ALG_HANDLE local_38 [2];
  
  local_38[0] = (BCRYPT_HANDLE)0x0;
  pvStack0000000000000040 = (BCRYPT_KEY_HANDLE)0x0;
  cbInput = param_5 & 0xffffffe0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(local_38,L"AES",(LPCWSTR)0x0,0);
  if ((-1 < NVar1) &&
     (NVar1 = BCryptSetProperty(local_38[0],L"ChainingMode",(PUCHAR)L"ChainingModeCBC",0x20,0),
     -1 < NVar1)) {
    NVar1 = BCryptGenerateSymmetricKey(local_38[0],&stack0x00000040,(PUCHAR)0x0,0,param_1,0x20,0);
    if (-1 < NVar1) {
      if (cbInput != 0) {
        NVar1 = BCryptDecrypt(pvStack0000000000000040,param_4,cbInput,(void *)0x0,param_3,0x10,
                              param_6,param_7,local_res10,0);
        if (NVar1 < 0) goto LAB_1800022bd;
        if (cbInput != local_res10[0]) {
          NVar1 = -0x3fffffff;
          goto LAB_1800022bd;
        }
      }
      NVar1 = 0;
      if (cbInput < param_5) {
        if (param_4 != param_6) {
          FUN_18001fe80((undefined8 *)(param_6 + cbInput),(undefined8 *)(param_4 + cbInput),
                        (ulonglong)(param_5 - cbInput));
        }
        local_res10[0] = param_5;
      }
    }
  }
LAB_1800022bd:
  if (pvStack0000000000000040 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(pvStack0000000000000040);
    pvStack0000000000000040 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38[0] != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38[0],0);
  }
  return -1 < NVar1;
}



bool FUN_180002310(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5)

{
  uint uVar1;
  NTSTATUS NVar2;
  PUCHAR pUVar3;
  ulonglong uVar4;
  uint uVar5;
  uint *puVar6;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_ALG_HANDLE local_38;
  uint local_30 [6];
  
  uVar5 = 0;
  local_38 = (BCRYPT_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  local_48[0] = 0;
  NVar2 = BCryptOpenAlgorithmProvider(&local_38,L"AES",(LPCWSTR)0x0,0);
  if ((((-1 < NVar2) &&
       (NVar2 = BCryptSetProperty(local_38,L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
       -1 < NVar2)) &&
      (NVar2 = BCryptGenerateSymmetricKey(local_38,&local_40,(PUCHAR)0x0,0,param_1,0x10,0),
      -1 < NVar2)) && (NVar2 = 0, param_5 != 0)) {
    do {
      if (uVar5 == 0) {
        NVar2 = BCryptEncrypt(local_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,(PUCHAR)local_30,0x10,
                              local_48,0);
        if (NVar2 < 0) break;
        pUVar3 = param_2 + 0xf;
        do {
          *pUVar3 = *pUVar3 + '\x01';
          if (*pUVar3 != '\0') break;
          pUVar3 = pUVar3 + -1;
        } while (0 < (longlong)(pUVar3 + (1 - (longlong)param_2)));
      }
      if ((param_5 < 4) || (uVar4 = (ulonglong)(int)uVar5, 0xb < uVar4)) {
        if ((param_5 < 2) || (uVar4 = (ulonglong)(int)uVar5, 0xd < uVar4)) {
          uVar1 = *param_3;
          puVar6 = (uint *)((longlong)param_4 + 1);
          param_3 = (uint *)((longlong)param_3 + 1);
          *(byte *)param_4 = *(byte *)((longlong)local_30 + (longlong)(int)uVar5) ^ (byte)uVar1;
          uVar5 = uVar5 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          puVar6 = (uint *)((longlong)param_4 + 2);
          uVar1 = *param_3;
          param_3 = (uint *)((longlong)param_3 + 2);
          uVar5 = uVar5 + 2 & 0xf;
          *(ushort *)param_4 = *(ushort *)((longlong)local_30 + uVar4) ^ (ushort)uVar1;
          param_5 = param_5 - 2;
        }
      }
      else {
        puVar6 = param_4 + 1;
        uVar1 = *param_3;
        param_3 = param_3 + 1;
        uVar5 = uVar5 + 4 & 0xf;
        *param_4 = *(uint *)((longlong)local_30 + uVar4) ^ uVar1;
        param_5 = param_5 - 4;
      }
      param_4 = puVar6;
      NVar2 = 0;
    } while (param_5 != 0);
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
    local_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38,0);
  }
  return -1 < NVar2;
}



bool thunk_FUN_180002310(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5)

{
  uint uVar1;
  NTSTATUS NVar2;
  PUCHAR pUVar3;
  ulonglong uVar4;
  uint uVar5;
  uint *puVar6;
  ULONG aUStack_48 [2];
  BCRYPT_KEY_HANDLE pvStack_40;
  BCRYPT_ALG_HANDLE pvStack_38;
  uint auStack_30 [6];
  
  uVar5 = 0;
  pvStack_38 = (BCRYPT_HANDLE)0x0;
  pvStack_40 = (BCRYPT_KEY_HANDLE)0x0;
  aUStack_48[0] = 0;
  NVar2 = BCryptOpenAlgorithmProvider(&pvStack_38,L"AES",(LPCWSTR)0x0,0);
  if ((((-1 < NVar2) &&
       (NVar2 = BCryptSetProperty(pvStack_38,L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
       -1 < NVar2)) &&
      (NVar2 = BCryptGenerateSymmetricKey(pvStack_38,&pvStack_40,(PUCHAR)0x0,0,param_1,0x10,0),
      -1 < NVar2)) && (NVar2 = 0, param_5 != 0)) {
    do {
      if (uVar5 == 0) {
        NVar2 = BCryptEncrypt(pvStack_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,(PUCHAR)auStack_30,
                              0x10,aUStack_48,0);
        if (NVar2 < 0) break;
        pUVar3 = param_2 + 0xf;
        do {
          *pUVar3 = *pUVar3 + '\x01';
          if (*pUVar3 != '\0') break;
          pUVar3 = pUVar3 + -1;
        } while (0 < (longlong)(pUVar3 + (1 - (longlong)param_2)));
      }
      if ((param_5 < 4) || (uVar4 = (ulonglong)(int)uVar5, 0xb < uVar4)) {
        if ((param_5 < 2) || (uVar4 = (ulonglong)(int)uVar5, 0xd < uVar4)) {
          uVar1 = *param_3;
          puVar6 = (uint *)((longlong)param_4 + 1);
          param_3 = (uint *)((longlong)param_3 + 1);
          *(byte *)param_4 = *(byte *)((longlong)auStack_30 + (longlong)(int)uVar5) ^ (byte)uVar1;
          uVar5 = uVar5 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          puVar6 = (uint *)((longlong)param_4 + 2);
          uVar1 = *param_3;
          param_3 = (uint *)((longlong)param_3 + 2);
          uVar5 = uVar5 + 2 & 0xf;
          *(ushort *)param_4 = *(ushort *)((longlong)auStack_30 + uVar4) ^ (ushort)uVar1;
          param_5 = param_5 - 2;
        }
      }
      else {
        puVar6 = param_4 + 1;
        uVar1 = *param_3;
        param_3 = param_3 + 1;
        uVar5 = uVar5 + 4 & 0xf;
        *param_4 = *(uint *)((longlong)auStack_30 + uVar4) ^ uVar1;
        param_5 = param_5 - 4;
      }
      param_4 = puVar6;
      NVar2 = 0;
    } while (param_5 != 0);
  }
  if (pvStack_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(pvStack_40);
    pvStack_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (pvStack_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(pvStack_38,0);
  }
  return -1 < NVar2;
}



undefined8
FUN_180002550(PUCHAR param_1,undefined8 param_2,undefined8 param_3,undefined1 *param_4,
             undefined8 param_5,undefined8 *param_6)

{
  ushort uVar1;
  NTSTATUS NVar2;
  char **ppcVar3;
  ULONG *pUVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  undefined8 *puVar8;
  undefined8 local_res18;
  BCRYPT_HASH_HANDLE local_res20;
  uint uStack0000000000000038;
  BCRYPT_ALG_HANDLE local_a8;
  ULONG local_a0 [2];
  uint local_98;
  undefined4 local_94;
  char *local_90 [4];
  UCHAR local_70 [48];
  
  local_90[0] = (char *)&local_res18;
  local_90[1] = "SNBase";
  local_90[2] = (char *)&param_5;
  if (param_4 != (undefined1 *)0x0) {
    local_90[2] = param_4;
  }
  uVar7 = 0x20;
  local_90[3] = (char *)&param_5;
  local_a0[0] = 4;
  local_98 = 4;
  if (param_4 != (undefined1 *)0x0) {
    local_98 = uVar7;
  }
  local_a0[1] = 7;
  local_94 = 4;
  param_5._0_4_ = 0x10000;
  uStack0000000000000038 = 1;
  puVar8 = param_6;
  local_res18 = param_3;
  do {
    uVar5 = uStack0000000000000038;
    uVar1 = (ushort)(uStack0000000000000038 >> 0x10);
    local_res18 = CONCAT44(local_res18._4_4_,
                           ((uint)(ushort)((short)uStack0000000000000038 << 8) |
                           uStack0000000000000038 >> 8 & 0xff) << 0x10 | (uint)(ushort)(uVar1 << 8)
                           | (uint)(uVar1 >> 8));
    NVar2 = BCryptOpenAlgorithmProvider(&local_a8,L"SHA256",(LPCWSTR)0x0,8);
    if (NVar2 < 0) {
      return 0;
    }
    NVar2 = BCryptCreateHash(local_a8,&local_res20,(PUCHAR)0x0,0,param_1,0x20,0);
    if (-1 < NVar2) {
      uVar5 = 0;
      if ((param_4 != (undefined1 *)0x0) != 0xfffffffd) {
        pUVar4 = local_a0;
        ppcVar3 = local_90;
        do {
          if ((((PUCHAR)*ppcVar3 != (PUCHAR)0x0) && (*pUVar4 != 0)) &&
             (NVar2 = BCryptHashData(local_res20,(PUCHAR)*ppcVar3,*pUVar4,0), NVar2 < 0))
          goto LAB_1800026eb;
          uVar5 = uVar5 + 1;
          ppcVar3 = ppcVar3 + 1;
          pUVar4 = pUVar4 + 1;
        } while (uVar5 < (param_4 != (undefined1 *)0x0) + 3);
      }
      if (-1 < NVar2) {
        NVar2 = BCryptFinishHash(local_res20,local_70,0x20,0);
      }
LAB_1800026eb:
      BCryptDestroyHash(local_res20);
      uVar5 = uStack0000000000000038;
    }
    BCryptCloseAlgorithmProvider(local_a8,0);
    if (NVar2 < 0) {
      return 0;
    }
    uVar6 = 0x20;
    if (uVar7 < 0x20) {
      uVar6 = uVar7;
    }
    FUN_18001fe80(puVar8,(undefined8 *)local_70,(ulonglong)uVar6);
    uStack0000000000000038 = uVar5 + 1;
    puVar8 = (undefined8 *)((longlong)puVar8 + (ulonglong)uVar6);
    uVar7 = uVar7 - uVar6;
    if (uVar7 == 0) {
      return 1;
    }
  } while( true );
}



UINT FUN_180002760(void)

{
  char cVar1;
  short sVar2;
  UINT BufferSize;
  UINT UVar3;
  NTSTATUS NVar4;
  HANDLE pvVar5;
  LPVOID pFirmwareTableBuffer;
  short *psVar6;
  short *psVar7;
  LPVOID pvVar8;
  int iVar9;
  short *psVar10;
  uint uVar11;
  int iVar13;
  int iVar14;
  ULONG *pUVar15;
  short **ppsVar16;
  ULONG local_res8 [2];
  BCRYPT_HASH_HANDLE local_res10;
  BCRYPT_ALG_HANDLE local_res18;
  short *local_38 [2];
  LPVOID pvVar12;
  
  pvVar12 = (LPVOID)0x0;
  iVar14 = 0;
  local_res8[0] = 0;
  local_res8[1] = 0;
  local_38[0] = (short *)0x0;
  local_38[1] = (short *)0x0;
  BufferSize = GetSystemFirmwareTable(0x52534d42,0,(PVOID)0x0,0);
  if (BufferSize == 0) {
    return BufferSize;
  }
  pvVar5 = GetProcessHeap();
  pFirmwareTableBuffer = HeapAlloc(pvVar5,0,(ulonglong)BufferSize);
  pvVar8 = pFirmwareTableBuffer;
  if (pFirmwareTableBuffer == (LPVOID)0x0) goto LAB_1800029f3;
  UVar3 = GetSystemFirmwareTable(0x52534d42,0,pFirmwareTableBuffer,BufferSize);
  iVar13 = iVar14;
  if (BufferSize == UVar3) {
    psVar6 = (short *)((longlong)pFirmwareTableBuffer + 8);
    psVar10 = (short *)((ulonglong)*(uint *)((longlong)pFirmwareTableBuffer + 4) +
                       (longlong)pFirmwareTableBuffer);
    if (psVar6 < psVar10) {
      while ((char)*psVar6 != '\x01') {
        psVar6 = (short *)((longlong)psVar6 + (ulonglong)*(byte *)((longlong)psVar6 + 1));
        if (psVar10 <= psVar6) goto LAB_1800028e0;
        sVar2 = *psVar6;
        while (sVar2 != 0) {
          if (psVar10 <= psVar6) goto LAB_1800028e0;
          psVar6 = (short *)((longlong)psVar6 + 1);
          sVar2 = *psVar6;
        }
        if ((psVar10 <= psVar6) || (psVar6 = psVar6 + 1, psVar10 <= psVar6)) goto LAB_1800028e0;
      }
      if ((*(longlong *)(psVar6 + 4) != *(longlong *)(psVar6 + 8)) ||
         (*(longlong *)(psVar6 + 4) - 1U < 0xfffffffffffffffe)) {
        iVar13 = 0x10;
        local_res8[0] = 0x10;
        local_38[0] = psVar6 + 4;
      }
      if ((*(char *)((longlong)psVar6 + 7) != '\0') &&
         (psVar7 = (short *)((longlong)psVar6 + (ulonglong)*(byte *)((longlong)psVar6 + 1)),
         psVar7 < psVar10)) {
        iVar9 = *(byte *)((longlong)psVar6 + 7) - 1;
        if (iVar9 != 0) goto LAB_180002890;
        goto LAB_1800028b4;
      }
    }
  }
  goto LAB_1800028e0;
  while( true ) {
    psVar7 = (short *)((longlong)psVar7 + 1);
    iVar9 = iVar9 + -1;
    if (iVar9 == 0) break;
LAB_180002890:
    cVar1 = (char)*psVar7;
    while (cVar1 != '\0') {
      if (psVar10 <= psVar7) goto LAB_1800028b0;
      psVar7 = (short *)((longlong)psVar7 + 1);
      cVar1 = *(char *)psVar7;
    }
    if (psVar10 <= psVar7) {
LAB_1800028b0:
      if (iVar9 != 0) goto LAB_1800028e0;
      break;
    }
  }
LAB_1800028b4:
  cVar1 = (char)*psVar7;
  psVar6 = psVar7;
  while (local_38[1] = psVar7, cVar1 != '\0') {
    if (psVar10 <= psVar6) goto LAB_1800028e0;
    psVar6 = (short *)((longlong)psVar6 + 1);
    cVar1 = *(char *)psVar6;
  }
  if (psVar6 < psVar10) {
    iVar14 = ((int)psVar6 - (int)psVar7) + 1;
    local_res8[1] = iVar14;
  }
LAB_1800028e0:
  if ((iVar13 != 0) || (pvVar8 = pvVar12, iVar14 != 0)) {
    local_res18 = (BCRYPT_ALG_HANDLE)0x0;
    NVar4 = BCryptOpenAlgorithmProvider(&local_res18,L"SHA256",(LPCWSTR)0x0,0);
    if (-1 < NVar4) {
      NVar4 = BCryptCreateHash(local_res18,&local_res10,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
      if (-1 < NVar4) {
        pUVar15 = local_res8;
        ppsVar16 = local_38;
        do {
          if (((*ppsVar16 != (short *)0x0) && (*pUVar15 != 0)) &&
             (NVar4 = BCryptHashData(local_res10,(PUCHAR)*ppsVar16,*pUVar15,0), NVar4 < 0))
          goto LAB_1800029b8;
          uVar11 = (int)pvVar12 + 1;
          pvVar12 = (LPVOID)(ulonglong)uVar11;
          ppsVar16 = ppsVar16 + 1;
          pUVar15 = pUVar15 + 1;
        } while (uVar11 < 2);
        if (-1 < NVar4) {
          NVar4 = BCryptFinishHash(local_res10,&DAT_18004dc68,0x20,0);
        }
LAB_1800029b8:
        BCryptDestroyHash(local_res10);
      }
      BCryptCloseAlgorithmProvider(local_res18,0);
    }
    pvVar8 = (LPVOID)(ulonglong)(-1 < NVar4);
  }
  pvVar5 = GetProcessHeap();
  HeapFree(pvVar5,0,pFirmwareTableBuffer);
LAB_1800029f3:
  return (UINT)pvVar8;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined * FUN_180002a10(void)

{
  UINT UVar1;
  
  if (DAT_18004dc88 == '\0') {
    UVar1 = FUN_180002760();
    if (UVar1 == 0) {
      _DAT_18004dc68 = 0;
      _DAT_18004dc70 = 0;
      _DAT_18004dc78 = 0;
      _DAT_18004dc80 = 0;
    }
    DAT_18004dc88 = '\x01';
  }
  return &DAT_18004dc68;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180002a60(undefined8 *param_1,undefined8 param_2,PUCHAR param_3)

{
  UINT UVar1;
  PUCHAR pUVar2;
  undefined8 in_stack_ffffffffffffffd8;
  
  pUVar2 = param_3;
  if (param_3 == (PUCHAR)0x0) {
    if (DAT_18004dc88 == '\0') {
      UVar1 = FUN_180002760();
      if (UVar1 == 0) {
        _DAT_18004dc68 = 0;
        _DAT_18004dc70 = 0;
        _DAT_18004dc78 = 0;
        _DAT_18004dc80 = 0;
      }
      DAT_18004dc88 = '\x01';
      pUVar2 = param_3;
    }
    param_3 = &DAT_18004dc68;
  }
  if (DAT_18004dc88 == '\0') {
    UVar1 = FUN_180002760();
    if (UVar1 == 0) {
      _DAT_18004dc68 = 0;
      _DAT_18004dc70 = 0;
      _DAT_18004dc78 = 0;
      _DAT_18004dc80 = 0;
    }
    DAT_18004dc88 = '\x01';
  }
  FUN_180002550(param_3,param_2,pUVar2,&DAT_18004dc68,in_stack_ffffffffffffffd8,param_1);
  return;
}



longlong FUN_180002b10(uint param_1,longlong param_2)

{
  return param_2 + 0x40 + (ulonglong)param_1;
}



int FUN_180002b20(int *param_1,int *param_2)

{
  if (*param_1 != 0x5366616b) {
    return 0;
  }
  if (param_2 != (int *)0x0) {
    *param_2 = param_1[2];
  }
  return param_1[3];
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8
FUN_180002b40(undefined8 *param_1,uint param_2,undefined8 *param_3,uint param_4,undefined4 *param_5,
             uint *param_6,longlong param_7)

{
  undefined8 *puVar1;
  undefined4 *puVar2;
  bool bVar3;
  NTSTATUS NVar4;
  UINT UVar5;
  undefined7 extraout_var;
  undefined4 **ppuVar6;
  uint uVar7;
  uint uVar8;
  undefined4 **ppuVar9;
  BCRYPT_HASH_HANDLE local_68;
  BCRYPT_ALG_HANDLE local_60;
  undefined4 *local_58;
  longlong local_50;
  undefined8 local_48;
  undefined8 uStack_40;
  UCHAR local_38 [16];
  
  puVar2 = param_5;
  uVar7 = param_2 + param_4 + 0x40;
  if (uVar7 <= *param_6) {
    *param_5 = 0x5366616b;
    param_5[1] = uVar7;
    param_5[2] = param_2;
    param_5[3] = param_4;
    NVar4 = BCryptOpenAlgorithmProvider(&param_5,L"RNG",(LPCWSTR)0x0,0);
    if (-1 < NVar4) {
      BCryptGenRandom(param_5,(PUCHAR)(puVar2 + 4),0x10,0);
      BCryptCloseAlgorithmProvider(param_5,0);
    }
    NVar4 = BCryptOpenAlgorithmProvider(&param_5,L"RNG",(LPCWSTR)0x0,0);
    if (-1 < NVar4) {
      BCryptGenRandom(param_5,(PUCHAR)(puVar2 + 8),0x10,0);
      BCryptCloseAlgorithmProvider(param_5,0);
    }
    if (param_2 != 0) {
      FUN_18001fe80((undefined8 *)(puVar2 + 0xc),param_1,(ulonglong)param_2);
    }
    FUN_18001fe80((undefined8 *)((longlong)puVar2 + (ulonglong)param_2 + 0x30),param_3,
                  (ulonglong)param_4);
    local_58 = puVar2 + 4;
    param_5._0_4_ = 0x10;
    local_50 = param_7;
    param_5._4_4_ = -(uint)(param_7 != 0) & 0x20;
    if (DAT_18004dc88 == '\0') {
      UVar5 = FUN_180002760();
      if (UVar5 == 0) {
        _DAT_18004dc68 = 0;
        _DAT_18004dc70 = 0;
        _DAT_18004dc78 = 0;
        _DAT_18004dc80 = 0;
      }
      DAT_18004dc88 = '\x01';
    }
    NVar4 = BCryptOpenAlgorithmProvider(&local_60,L"SHA256",(LPCWSTR)0x0,8);
    if (-1 < NVar4) {
      uVar7 = 0;
      NVar4 = BCryptCreateHash(local_60,&local_68,(PUCHAR)0x0,0,&DAT_18004dc68,0x20,0);
      if (-1 < NVar4) {
        uVar8 = 0;
        ppuVar9 = &param_5;
        ppuVar6 = &local_58;
        do {
          if ((((PUCHAR)*ppuVar6 != (PUCHAR)0x0) && (*(ULONG *)ppuVar9 != 0)) &&
             (NVar4 = BCryptHashData(local_68,(PUCHAR)*ppuVar6,*(ULONG *)ppuVar9,0), NVar4 < 0))
          goto LAB_180002d46;
          uVar8 = uVar8 + 1;
          ppuVar6 = ppuVar6 + 1;
          ppuVar9 = (undefined4 **)((longlong)ppuVar9 + 4);
        } while (uVar8 < 2);
        if (-1 < NVar4) {
          NVar4 = BCryptFinishHash(local_68,(PUCHAR)&local_48,0x20,0);
        }
LAB_180002d46:
        BCryptDestroyHash(local_68);
      }
      BCryptCloseAlgorithmProvider(local_60,0);
      if ((-1 < NVar4) &&
         (bVar3 = FUN_180002310((PUCHAR)&local_48,local_38,puVar2 + 8,puVar2 + 8,
                                param_2 + param_4 + 0x10), (int)CONCAT71(extraout_var,bVar3) != 0))
      {
        param_5._0_4_ = puVar2[1] + -0x10;
        local_58 = puVar2;
        if (DAT_18004dc88 == '\0') {
          UVar5 = FUN_180002760();
          if (UVar5 == 0) {
            _DAT_18004dc68 = 0;
            _DAT_18004dc70 = 0;
            _DAT_18004dc78 = 0;
            _DAT_18004dc80 = 0;
          }
          DAT_18004dc88 = '\x01';
        }
        NVar4 = BCryptOpenAlgorithmProvider(&local_60,L"SHA256",(LPCWSTR)0x0,8);
        if (-1 < NVar4) {
          NVar4 = BCryptCreateHash(local_60,&local_68,(PUCHAR)0x0,0,&DAT_18004dc68,0x20,0);
          if (-1 < NVar4) {
            ppuVar9 = &param_5;
            ppuVar6 = &local_58;
            do {
              if ((((PUCHAR)*ppuVar6 != (PUCHAR)0x0) && (*(ULONG *)ppuVar9 != 0)) &&
                 (NVar4 = BCryptHashData(local_68,(PUCHAR)*ppuVar6,*(ULONG *)ppuVar9,0), NVar4 < 0))
              goto LAB_180002e83;
              uVar7 = uVar7 + 1;
              ppuVar6 = ppuVar6 + 1;
              ppuVar9 = (undefined4 **)((longlong)ppuVar9 + 4);
            } while (uVar7 < 2);
            if (-1 < NVar4) {
              NVar4 = BCryptFinishHash(local_68,(PUCHAR)&local_48,0x20,0);
            }
LAB_180002e83:
            BCryptDestroyHash(local_68);
          }
          BCryptCloseAlgorithmProvider(local_60,0);
          if (-1 < NVar4) {
            puVar1 = (undefined8 *)((ulonglong)(puVar2[1] - 0x10) + (longlong)puVar2);
            *puVar1 = local_48;
            puVar1[1] = uStack_40;
            *param_6 = puVar2[1];
            return 1;
          }
        }
      }
    }
  }
  return 0;
}



bool FUN_180002ee0(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5,
                  PUCHAR param_6,uint *param_7)

{
  uint uVar1;
  uint uVar2;
  NTSTATUS NVar3;
  uint uVar4;
  PUCHAR pUVar5;
  uint *puVar6;
  int iVar7;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_ALG_HANDLE local_38 [2];
  
  iVar7 = 0;
  local_38[0] = (BCRYPT_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  local_48[0] = 0;
  NVar3 = BCryptOpenAlgorithmProvider(local_38,L"AES",(LPCWSTR)0x0,0);
  if (((-1 < NVar3) &&
      (NVar3 = BCryptSetProperty(local_38[0],L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
      -1 < NVar3)) &&
     (NVar3 = BCryptGenerateSymmetricKey(local_38[0],&local_40,(PUCHAR)0x0,0,param_1,0x10,0),
     -1 < NVar3)) {
    NVar3 = iVar7;
    if (param_4 == (uint *)0x0) {
      if (param_5 != 0) {
        do {
          if (*param_7 == 0) {
            if ((param_5 < 0x11) &&
               (NVar3 = BCryptEncrypt(local_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,param_6,0x10,
                                      local_48,0), NVar3 < 0)) break;
            pUVar5 = param_2 + 0xf;
            do {
              *pUVar5 = *pUVar5 + '\x01';
              if (*pUVar5 != '\0') break;
              pUVar5 = pUVar5 + -1;
            } while (0 < (longlong)(pUVar5 + (1 - (longlong)param_2)));
          }
          *param_7 = *param_7 + 1 & 0xf;
          param_5 = param_5 - 1;
          NVar3 = iVar7;
        } while (param_5 != 0);
      }
    }
    else if (param_5 != 0) {
      do {
        if (*param_7 == 0) {
          NVar3 = BCryptEncrypt(local_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,param_6,0x10,
                                local_48,0);
          if (NVar3 < 0) break;
          pUVar5 = param_2 + 0xf;
          do {
            *pUVar5 = *pUVar5 + '\x01';
            if (*pUVar5 != '\0') break;
            pUVar5 = pUVar5 + -1;
          } while (0 < (longlong)(pUVar5 + (1 - (longlong)param_2)));
        }
        if (param_5 < 4) {
LAB_180003060:
          if (1 < param_5) {
            uVar1 = *param_7;
            if (uVar1 < 0xe) {
              puVar6 = (uint *)((longlong)param_4 + 2);
              uVar2 = *param_3;
              param_3 = (uint *)((longlong)param_3 + 2);
              uVar4 = uVar1 + 2 & 0xf;
              *(ushort *)param_4 = *(ushort *)(param_6 + uVar1) ^ (ushort)uVar2;
              param_5 = param_5 - 2;
              goto LAB_1800030ac;
            }
          }
          uVar2 = *param_3;
          uVar1 = *param_7;
          param_3 = (uint *)((longlong)param_3 + 1);
          puVar6 = (uint *)((longlong)param_4 + 1);
          *(byte *)param_4 = param_6[uVar1] ^ (byte)uVar2;
          uVar4 = uVar1 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          uVar1 = *param_7;
          if (0xb < uVar1) goto LAB_180003060;
          puVar6 = param_4 + 1;
          uVar2 = *param_3;
          param_3 = param_3 + 1;
          uVar4 = uVar1 + 4 & 0xf;
          *param_4 = *(uint *)(param_6 + uVar1) ^ uVar2;
          param_5 = param_5 - 4;
        }
LAB_1800030ac:
        *param_7 = uVar4;
        param_4 = puVar6;
        NVar3 = iVar7;
      } while (param_5 != 0);
    }
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
  }
  if (local_38[0] != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38[0],0);
  }
  return -1 < NVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8
FUN_1800031b0(int *param_1,uint *param_2,uint *param_3,uint *param_4,uint *param_5,longlong param_6)

{
  bool bVar1;
  UINT UVar2;
  NTSTATUS NVar3;
  PUCHAR pbSecret;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  int **ppiVar4;
  uint uVar5;
  ULONG *pUVar6;
  uint uVar7;
  uint local_res8 [2];
  uint *local_res10;
  BCRYPT_HASH_HANDLE local_d8;
  BCRYPT_ALG_HANDLE local_d0;
  ULONG local_c8;
  uint local_c4;
  int *local_c0;
  longlong local_b8;
  longlong local_b0;
  longlong local_a8;
  UCHAR local_a0 [16];
  UCHAR local_90 [24];
  uint local_78 [16];
  
  if (*param_1 != 0x5366616b) {
    return 0;
  }
  local_c8 = param_1[1] - 0x10;
  uVar7 = 0;
  local_b8 = param_6;
  local_res8[0] = 0;
  local_c4 = -(uint)(param_6 != 0) & 0x20;
  local_res10 = param_2;
  local_c0 = param_1;
  if (DAT_18004dc88 == '\0') {
    UVar2 = FUN_180002760();
    if (UVar2 == 0) {
      _DAT_18004dc68 = 0;
      _DAT_18004dc70 = 0;
      _DAT_18004dc78 = 0;
      _DAT_18004dc80 = 0;
    }
    DAT_18004dc88 = '\x01';
  }
  NVar3 = BCryptOpenAlgorithmProvider(&local_d0,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar3) {
    NVar3 = BCryptCreateHash(local_d0,&local_d8,(PUCHAR)0x0,0,&DAT_18004dc68,0x20,0);
    if (-1 < NVar3) {
      uVar5 = 0;
      pUVar6 = &local_c8;
      ppiVar4 = &local_c0;
      do {
        if (((*ppiVar4 != (int *)0x0) && (*pUVar6 != 0)) &&
           (NVar3 = BCryptHashData(local_d8,(PUCHAR)*ppiVar4,*pUVar6,0), NVar3 < 0))
        goto LAB_180003322;
        uVar5 = uVar5 + 1;
        ppiVar4 = ppiVar4 + 1;
        pUVar6 = pUVar6 + 1;
      } while (uVar5 < 2);
      if (-1 < NVar3) {
        NVar3 = BCryptFinishHash(local_d8,(PUCHAR)&local_b0,0x20,0);
      }
LAB_180003322:
      BCryptDestroyHash(local_d8);
      param_2 = local_res10;
    }
    BCryptCloseAlgorithmProvider(local_d0,0);
    if (((((-1 < NVar3) &&
          (*(longlong *)((ulonglong)(param_1[1] - 0x10U) + (longlong)param_1) == local_b0)) &&
         (*(longlong *)((ulonglong)(param_1[1] - 0x10U) + 8 + (longlong)param_1) == local_a8)) &&
        ((param_3 == (uint *)0x0 || ((param_2 != (uint *)0x0 && ((uint)param_1[2] <= *param_3))))))
       && ((param_5 == (uint *)0x0 || ((param_4 != (uint *)0x0 && ((uint)param_1[3] <= *param_5)))))
       ) {
      local_c0 = param_1 + 4;
      local_c8 = 0x10;
      pbSecret = FUN_180002a10();
      NVar3 = BCryptOpenAlgorithmProvider(&local_d0,L"SHA256",(LPCWSTR)0x0,8);
      if (-1 < NVar3) {
        NVar3 = BCryptCreateHash(local_d0,&local_d8,(PUCHAR)0x0,0,pbSecret,0x20,0);
        if (-1 < NVar3) {
          pUVar6 = &local_c8;
          ppiVar4 = &local_c0;
          do {
            if (((*ppiVar4 != (int *)0x0) && (*pUVar6 != 0)) &&
               (NVar3 = BCryptHashData(local_d8,(PUCHAR)*ppiVar4,*pUVar6,0), NVar3 < 0))
            goto LAB_180003474;
            uVar7 = uVar7 + 1;
            ppiVar4 = ppiVar4 + 1;
            pUVar6 = pUVar6 + 1;
          } while (uVar7 < 2);
          if (-1 < NVar3) {
            NVar3 = BCryptFinishHash(local_d8,(PUCHAR)&local_b0,0x20,0);
          }
LAB_180003474:
          BCryptDestroyHash(local_d8);
        }
        BCryptCloseAlgorithmProvider(local_d0,0);
        if (((-1 < NVar3) &&
            (bVar1 = FUN_180002ee0((PUCHAR)&local_b0,local_a0,(uint *)(param_1 + 8),local_78,0x10,
                                   local_90,local_res8), (int)CONCAT71(extraout_var,bVar1) != 0)) &&
           ((param_1[2] == 0 ||
            (bVar1 = FUN_180002ee0((PUCHAR)&local_b0,local_a0,(uint *)(param_1 + 0xc),local_res10,
                                   param_1[2],local_90,local_res8),
            (int)CONCAT71(extraout_var_00,bVar1) != 0)))) {
          if (param_3 != (uint *)0x0) {
            *param_3 = param_1[2];
          }
          if (((param_1[3] == 0) || (param_4 == (uint *)0x0)) ||
             (bVar1 = FUN_180002ee0((PUCHAR)&local_b0,local_a0,
                                    (uint *)((longlong)param_1 + (ulonglong)(uint)param_1[2] + 0x30)
                                    ,param_4,param_1[3],local_90,local_res8),
             (int)CONCAT71(extraout_var_01,bVar1) != 0)) {
            if (param_5 != (uint *)0x0) {
              *param_5 = param_1[3];
            }
            return 1;
          }
        }
      }
    }
  }
  return 0;
}



undefined8 FUN_180003590(undefined8 param_1,PUCHAR param_2)

{
  NTSTATUS NVar1;
  int iVar2;
  ULONG *pUVar3;
  undefined8 *puVar4;
  ULONG local_res8 [4];
  BCRYPT_HASH_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  undefined8 local_38 [2];
  
  local_res8[0] = 0x20;
  local_38[0] = param_1;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    iVar2 = 0;
    NVar1 = BCryptCreateHash(local_res20,&local_res18,(PUCHAR)0x0,0,"NzY4",0x17,0);
    if (-1 < NVar1) {
      puVar4 = local_38;
      pUVar3 = local_res8;
      do {
        if (((PUCHAR)*puVar4 != (PUCHAR)0x0) && (*pUVar3 != 0)) {
          NVar1 = BCryptHashData(local_res18,(PUCHAR)*puVar4,*pUVar3,0);
          if (NVar1 < 0) goto LAB_180003684;
        }
        iVar2 = iVar2 + 1;
        puVar4 = puVar4 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar2 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_res18,param_2,0x20,0);
      }
LAB_180003684:
      BCryptDestroyHash(local_res18);
    }
    BCryptCloseAlgorithmProvider(local_res20,0);
    if (-1 < NVar1) {
      return 0;
    }
  }
  return 1;
}



undefined8 FUN_1800036d0(undefined8 param_1,PUCHAR param_2)

{
  NTSTATUS NVar1;
  int iVar2;
  ULONG *pUVar3;
  undefined8 *puVar4;
  ULONG local_res8 [4];
  BCRYPT_HASH_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  undefined8 local_38 [2];
  
  local_res8[0] = 0x20;
  local_38[0] = param_1;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    iVar2 = 0;
    NVar1 = BCryptCreateHash(local_res20,&local_res18,(PUCHAR)0x0,0,"Mzg0",0x13,0);
    if (-1 < NVar1) {
      puVar4 = local_38;
      pUVar3 = local_res8;
      do {
        if (((PUCHAR)*puVar4 != (PUCHAR)0x0) && (*pUVar3 != 0)) {
          NVar1 = BCryptHashData(local_res18,(PUCHAR)*puVar4,*pUVar3,0);
          if (NVar1 < 0) goto LAB_1800037c4;
        }
        iVar2 = iVar2 + 1;
        puVar4 = puVar4 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar2 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_res18,param_2,0x20,0);
      }
LAB_1800037c4:
      BCryptDestroyHash(local_res18);
    }
    BCryptCloseAlgorithmProvider(local_res20,0);
    if (-1 < NVar1) {
      return 0;
    }
  }
  return 1;
}



void FUN_180003810(undefined8 param_1,undefined8 *param_2,uint *param_3,uint *param_4,
                  longlong param_5)

{
  uint uVar1;
  bool bVar2;
  NTSTATUS NVar3;
  undefined8 uVar4;
  undefined7 extraout_var;
  undefined8 *puVar5;
  int iVar6;
  ULONG *pUVar7;
  undefined1 auStackY_148 [32];
  BCRYPT_ALG_HANDLE local_108;
  uint local_100 [2];
  ULONG local_f8 [2];
  BCRYPT_ALG_HANDLE local_f0;
  undefined8 local_e8;
  UCHAR local_e0 [16];
  UCHAR local_d0 [24];
  UCHAR local_b8 [32];
  UCHAR local_98 [32];
  undefined8 local_78;
  undefined8 uStack_70;
  undefined8 local_68;
  undefined8 uStack_60;
  ulonglong local_58;
  
  local_58 = DAT_18004a880 ^ (ulonglong)auStackY_148;
  local_100[0] = 0xa0;
  if (param_3 == (uint *)0x0) {
    *param_4 = 0xa0;
  }
  else if ((0x9f < *param_4) &&
          (NVar3 = BCryptOpenAlgorithmProvider(&local_108,L"RNG",(LPCWSTR)0x0,0), -1 < NVar3)) {
    NVar3 = BCryptGenRandom(local_108,local_b8,0x20,0);
    BCryptCloseAlgorithmProvider(local_108,0);
    if ((-1 < NVar3) && (uVar4 = FUN_1800036d0(param_1,local_98), (int)uVar4 == 0)) {
      local_78 = *param_2;
      uStack_70 = param_2[1];
      local_68 = param_2[2];
      uStack_60 = param_2[3];
      uVar4 = FUN_180002b40((undefined8 *)0x0,0,(undefined8 *)local_b8,0x60,param_3,local_100,
                            param_5);
      if ((int)uVar4 != 0) {
        local_f8[0] = 0x20;
        local_e8 = param_1;
        NVar3 = BCryptOpenAlgorithmProvider(&local_f0,L"SHA256",(LPCWSTR)0x0,8);
        if (-1 < NVar3) {
          iVar6 = 0;
          NVar3 = BCryptCreateHash(local_f0,&local_108,(PUCHAR)0x0,0,"MTI4",0x1a,0);
          if (-1 < NVar3) {
            pUVar7 = local_f8;
            puVar5 = &local_e8;
            do {
              if ((((PUCHAR)*puVar5 != (PUCHAR)0x0) && (*pUVar7 != 0)) &&
                 (NVar3 = BCryptHashData(local_108,(PUCHAR)*puVar5,*pUVar7,0), NVar3 < 0))
              goto LAB_1800039e3;
              iVar6 = iVar6 + 1;
              puVar5 = puVar5 + 1;
              pUVar7 = pUVar7 + 1;
            } while (iVar6 == 0);
            if (-1 < NVar3) {
              NVar3 = BCryptFinishHash(local_108,local_e0,0x20,0);
            }
LAB_1800039e3:
            BCryptDestroyHash(local_108);
          }
          BCryptCloseAlgorithmProvider(local_f0,0);
          uVar1 = local_100[0];
          if ((-1 < NVar3) &&
             (bVar2 = FUN_180002310(local_d0,local_e0,param_3,param_3,local_100[0]),
             (int)CONCAT71(extraout_var,bVar2) != 0)) {
            *param_4 = uVar1;
          }
        }
      }
    }
  }
  FUN_18001fe50(local_58 ^ (ulonglong)auStackY_148);
  return;
}



void FUN_180003a70(longlong param_1,uint *param_2,int param_3,undefined8 *param_4,longlong param_5)

{
  bool bVar1;
  NTSTATUS NVar2;
  uint *puVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  int iVar5;
  ULONG *pUVar6;
  longlong *plVar7;
  undefined1 auStackY_138 [32];
  ULONG local_f8 [2];
  BCRYPT_HASH_HANDLE local_f0;
  BCRYPT_ALG_HANDLE local_e8;
  longlong local_e0 [2];
  uint *local_d0;
  UCHAR local_c8 [16];
  UCHAR local_b8 [16];
  ulonglong local_a8 [4];
  undefined1 local_88 [32];
  undefined8 local_68;
  undefined8 uStack_60;
  undefined8 local_58;
  undefined8 uStack_50;
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStackY_138;
  local_e0[1] = param_5;
  local_d0 = param_2;
  if ((param_3 == 0xa0) && (puVar3 = (uint *)FUN_18001fcf8(0xa0), puVar3 != (uint *)0x0)) {
    local_f8[0] = 0x20;
    local_e0[0] = param_1;
    NVar2 = BCryptOpenAlgorithmProvider(&local_e8,L"SHA256",(LPCWSTR)0x0,8);
    if (-1 < NVar2) {
      iVar5 = 0;
      NVar2 = BCryptCreateHash(local_e8,&local_f0,(PUCHAR)0x0,0,"MTI4",0x1a,0);
      if (-1 < NVar2) {
        pUVar6 = local_f8;
        plVar7 = local_e0;
        do {
          if ((((PUCHAR)*plVar7 != (PUCHAR)0x0) && (*pUVar6 != 0)) &&
             (NVar2 = BCryptHashData(local_f0,(PUCHAR)*plVar7,*pUVar6,0), NVar2 < 0))
          goto LAB_180003bab;
          iVar5 = iVar5 + 1;
          plVar7 = plVar7 + 1;
          pUVar6 = pUVar6 + 1;
        } while (iVar5 == 0);
        if (-1 < NVar2) {
          NVar2 = BCryptFinishHash(local_f0,local_c8,0x20,0);
        }
LAB_180003bab:
        BCryptDestroyHash(local_f0);
        param_5 = local_e0[1];
        param_2 = local_d0;
      }
      BCryptCloseAlgorithmProvider(local_e8,0);
      if ((-1 < NVar2) &&
         (bVar1 = FUN_180002310(local_b8,local_c8,param_2,puVar3,0xa0),
         (int)CONCAT71(extraout_var,bVar1) != 0)) {
        local_f8[0] = 0x60;
        uVar4 = FUN_1800031b0((int *)puVar3,(uint *)0x0,(uint *)0x0,(uint *)local_a8,local_f8,
                              param_5);
        if ((((int)uVar4 != 0) &&
            ((local_f8[0] == 0x60 &&
             (uVar4 = FUN_1800036d0(param_1,(PUCHAR)local_a8), (int)uVar4 == 0)))) &&
           (iVar5 = FUN_180020a30(local_a8,(longlong)local_88,0x20), iVar5 == 0)) {
          *param_4 = local_68;
          param_4[1] = uStack_60;
          param_4[2] = local_58;
          param_4[3] = uStack_50;
        }
      }
    }
    FUN_18001fcb8(puVar3);
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStackY_138);
  return;
}



void FUN_180003cb0(undefined8 *param_1,uint *param_2,uint *param_3,PUCHAR param_4)

{
  undefined8 *puVar1;
  int iVar2;
  undefined8 uVar3;
  PUCHAR pUVar4;
  PUCHAR pUVar5;
  undefined1 auStackY_e8 [32];
  undefined8 local_b8 [4];
  undefined8 local_98;
  undefined8 uStack_90;
  undefined8 local_88;
  undefined8 uStack_80;
  undefined8 local_78;
  undefined8 uStack_70;
  undefined8 local_68;
  undefined8 uStack_60;
  undefined8 local_58 [4];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStackY_e8;
  if (*param_3 < 3) {
    *param_3 = 3;
  }
  else if (param_1 == (undefined8 *)0x0) {
    *param_3 = 3;
    *param_2 = 0x20;
    param_2[2] = 0x40;
    FUN_180003810(0,(undefined8 *)0x0,(uint *)0x0,param_2 + 1,(longlong)param_4);
  }
  else {
    *param_3 = 0;
    if ((0x1f < *param_2) &&
       (pUVar5 = param_4, iVar2 = FUN_180002a60(local_b8,param_2,param_4), iVar2 != 0)) {
      pUVar4 = (PUCHAR)*param_1;
      uVar3 = FUN_180003590(local_b8,pUVar4);
      if ((int)uVar3 == 0) {
        *param_2 = 0x20;
        uVar3 = FUN_180001d60(local_58,pUVar4,&local_98,(ulonglong)pUVar5);
        if (((int)uVar3 != 0) &&
           (FUN_180003810(local_b8,local_58,(uint *)param_1[1],param_2 + 1,(longlong)param_4),
           0x3f < param_2[2])) {
          puVar1 = (undefined8 *)param_1[2];
          *puVar1 = local_98;
          puVar1[1] = uStack_90;
          puVar1[2] = local_88;
          puVar1[3] = uStack_80;
          puVar1[4] = local_78;
          puVar1[5] = uStack_70;
          puVar1[6] = local_68;
          puVar1[7] = uStack_60;
          param_2[2] = 0x40;
          *param_3 = 3;
        }
      }
    }
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStackY_e8);
  return;
}



void FUN_180003e10(undefined8 param_1,uint *param_2)

{
  FUN_180004d00(param_1,(longlong *)param_1,param_2);
  return;
}



void FUN_180003e30(undefined *param_1,ULONG param_2,undefined8 *param_3,undefined4 *param_4)

{
  NTSTATUS NVar1;
  int iVar2;
  ULONG *pUVar3;
  BCRYPT_ALG_HANDLE *ppvVar4;
  undefined8 uVar5;
  undefined1 auStackY_148 [32];
  undefined *puVar6;
  ULONG local_108 [2];
  BCRYPT_HASH_HANDLE local_100;
  BCRYPT_ALG_HANDLE local_f8 [2];
  int local_e8 [18];
  undefined8 local_a0;
  undefined8 uStack_98;
  undefined8 local_90;
  undefined8 uStack_88;
  undefined8 local_78;
  undefined8 uStack_70;
  undefined8 local_68;
  undefined8 uStack_60;
  ulonglong local_58;
  
  local_58 = DAT_18004a880 ^ (ulonglong)auStackY_148;
  *param_4 = 0x60;
  if (param_3 != (undefined8 *)0x0) {
    local_108[0] = 0x20;
    local_f8[0] = &DAT_180045b88;
    NVar1 = BCryptOpenAlgorithmProvider(local_f8 + 1,L"SHA256",(LPCWSTR)0x0,8);
    if (-1 < NVar1) {
      iVar2 = 0;
      puVar6 = &DAT_180045ab0;
      NVar1 = BCryptCreateHash(local_f8[1],&local_100,(PUCHAR)0x0,0,"UmVx",0x15,0);
      if (-1 < NVar1) {
        ppvVar4 = local_f8;
        pUVar3 = local_108;
        do {
          if ((((PUCHAR)*ppvVar4 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
             (NVar1 = BCryptHashData(local_100,(PUCHAR)*ppvVar4,*pUVar3,0), NVar1 < 0))
          goto LAB_180003f59;
          iVar2 = iVar2 + 1;
          ppvVar4 = ppvVar4 + 1;
          pUVar3 = pUVar3 + 1;
        } while (iVar2 == 0);
        if (-1 < NVar1) {
          NVar1 = BCryptFinishHash(local_100,(PUCHAR)&local_78,0x20,0);
        }
LAB_180003f59:
        BCryptDestroyHash(local_100);
      }
      BCryptCloseAlgorithmProvider(local_f8[1],0);
      if (-1 < NVar1) {
        uVar5 = 0x68;
        local_108[0] = param_2;
        local_f8[0] = param_1;
        FUN_180020400((undefined1 (*) [16])local_e8,0,0x68);
        local_e8[0] = 0x32534345;
        local_a0 = local_78;
        uStack_98 = uStack_70;
        local_90 = local_68;
        uStack_88 = uStack_60;
        local_e8[1] = 0x20;
        NVar1 = FUN_1800013c0(local_f8,local_108,uVar5,local_e8,puVar6,(PUCHAR)(param_3 + 4));
        if (-1 < NVar1) {
          *param_3 = 0xc12e898df2b7e4ec;
          param_3[1] = 0xc3d0233a57658dee;
          param_3[2] = 0xba7ff53a364ab8c0;
          param_3[3] = 0x3ab211844642b312;
        }
      }
    }
  }
  FUN_18001fe50(local_58 ^ (ulonglong)auStackY_148);
  return;
}



void FUN_180004030(uint *param_1,uint param_2)

{
  NTSTATUS NVar1;
  undefined **ppuVar2;
  ULONG *pUVar3;
  int iVar4;
  undefined1 auStackY_b8 [32];
  ULONG local_78 [2];
  BCRYPT_HASH_HANDLE local_70;
  BCRYPT_ALG_HANDLE local_68;
  undefined *local_60;
  UCHAR local_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStackY_b8;
  local_60 = &DAT_180045c50;
  local_78[0] = 0x20;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_68,&local_70,(PUCHAR)0x0,0,"UmVx",0x17,0);
    if (-1 < NVar1) {
      iVar4 = 0;
      pUVar3 = local_78;
      ppuVar2 = &local_60;
      do {
        if (((*ppuVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
           (NVar1 = BCryptHashData(local_70,*ppuVar2,*pUVar3,0), NVar1 < 0)) goto LAB_180004145;
        iVar4 = iVar4 + 1;
        ppuVar2 = ppuVar2 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar4 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_70,local_58,0x20,0);
      }
LAB_180004145:
      BCryptDestroyHash(local_70);
    }
    BCryptCloseAlgorithmProvider(local_68,0);
    if (-1 < NVar1) {
      FUN_180002310(local_48,local_58,param_1,param_1,param_2);
    }
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStackY_b8);
  return;
}



// WARNING: Removing unreachable block (ram,0x0001800042e2)

void FUN_1800041d0(PUCHAR param_1,uint param_2,undefined8 *param_3,undefined8 *param_4,char *param_5
                  )

{
  undefined8 uVar1;
  bool bVar2;
  NTSTATUS NVar3;
  undefined7 extraout_var;
  PUCHAR pUVar4;
  undefined1 auStackY_168 [32];
  UCHAR local_128 [8];
  undefined8 local_120;
  undefined8 uStack_118;
  undefined8 local_110;
  undefined8 uStack_108;
  undefined8 local_100;
  undefined8 uStack_f8;
  undefined8 local_f0;
  undefined8 uStack_e8;
  UCHAR local_d8 [72];
  undefined8 local_90;
  undefined8 uStack_88;
  undefined8 local_80;
  undefined8 uStack_78;
  ulonglong local_68;
  ulonglong uStack_60;
  ulonglong local_58;
  ulonglong uStack_50;
  ulonglong local_48;
  ulonglong uStack_40;
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStackY_168;
  FUN_180020400((undefined1 (*) [16])local_d8,0,0x68);
  local_90 = *param_3;
  uStack_88 = param_3[1];
  local_80 = param_3[2];
  uStack_78 = param_3[3];
  pUVar4 = local_128;
  local_120 = *param_4;
  uStack_118 = param_4[1];
  builtin_memcpy(local_d8,"ECK2 ",6);
  local_d8[6] = '\0';
  local_d8[7] = '\0';
  builtin_memcpy(local_128,"ECK1 ",6);
  local_128[6] = '\0';
  local_128[7] = '\0';
  local_110 = param_4[2];
  uStack_108 = param_4[3];
  local_100 = param_4[4];
  uStack_f8 = param_4[5];
  local_f0 = param_4[6];
  uStack_e8 = param_4[7];
  NVar3 = FUN_180001610(local_d8,pUVar4,"SecureShare",0xb,(PUCHAR)&local_68,0x20);
  if (-1 < NVar3) {
    local_48 = local_58 ^ local_68;
    uStack_40 = uStack_50 ^ uStack_60;
    bVar2 = FUN_180002170((PUCHAR)&local_68,pUVar4,(PUCHAR)&local_48,param_1,param_2,param_1,param_2
                         );
    if ((int)CONCAT71(extraout_var,bVar2) != 0) {
      uVar1 = *(undefined8 *)(param_1 + 0x28);
      *(undefined8 *)param_5 = *(undefined8 *)(param_1 + 0x20);
      *(undefined8 *)(param_5 + 8) = uVar1;
      if (((((*(int *)(param_1 + 0x30) + 0xcebeacaeU & 0xfdffffff) == 0) && (*param_5 == 'R')) &&
          (param_5[2] == 'P')) &&
         (((*(uint *)(param_1 + 0x34) == (uint)((byte)param_5[1] >> 4) << (param_5[1] & 0xfU) &&
           (param_5[3] == 'B')) && (0x50f < (*(uint *)(param_1 + 0x34) & 0xfffffff8))))) {
        FUN_180001af0(*(uint *)(param_1 + 0x3c),*(uint *)(param_1 + 0x38),
                      (undefined8 *)(param_1 + 0x48),
                      (undefined8 *)(param_1 + 0x48 + *(uint *)(param_1 + 0x38)),
                      (undefined8 *)(param_5 + 0x18),(uint *)(param_5 + 0x10));
      }
    }
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStackY_168);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1800043e0(undefined8 *param_1,int *param_2,undefined8 param_3,char *param_4)

{
  undefined8 *puVar1;
  UINT UVar2;
  int iVar3;
  undefined8 uVar4;
  int *piVar5;
  PUCHAR pUVar6;
  undefined1 auStackY_e8 [32];
  undefined8 in_stack_ffffffffffffff38;
  undefined8 local_a8;
  undefined8 uStack_a0;
  undefined8 local_98;
  undefined8 uStack_90;
  undefined8 local_88;
  undefined8 uStack_80;
  undefined8 local_78;
  undefined8 uStack_70;
  undefined8 local_68 [4];
  undefined8 local_48 [4];
  ulonglong local_28;
  
  local_28 = DAT_18004a880 ^ (ulonglong)auStackY_e8;
  if (2 < (uint)param_3) {
    pUVar6 = *(PUCHAR *)(param_4 + 0x20);
    piVar5 = param_2;
    if (pUVar6 == (PUCHAR)0x0) {
      if (DAT_18004dc88 == '\0') {
        UVar2 = FUN_180002760();
        if (UVar2 == 0) {
          _DAT_18004dc68 = 0;
          _DAT_18004dc70 = 0;
          _DAT_18004dc78 = 0;
          _DAT_18004dc80 = 0;
        }
        DAT_18004dc88 = '\x01';
      }
      pUVar6 = &DAT_18004dc68;
    }
    if (DAT_18004dc88 == '\0') {
      UVar2 = FUN_180002760();
      if (UVar2 == 0) {
        _DAT_18004dc68 = 0;
        _DAT_18004dc70 = 0;
        _DAT_18004dc78 = 0;
        _DAT_18004dc80 = 0;
      }
      DAT_18004dc88 = '\x01';
    }
    uVar4 = FUN_180002550(pUVar6,piVar5,param_3,&DAT_18004dc68,in_stack_ffffffffffffff38,local_48);
    if ((((int)uVar4 != 0) &&
        (iVar3 = FUN_180003a70((longlong)local_48,(uint *)*param_1,*param_2,local_68,
                               *(longlong *)(param_4 + 0x20)), iVar3 == 0)) && (param_2[1] == 0x40))
    {
      puVar1 = (undefined8 *)param_1[1];
      local_a8 = *puVar1;
      uStack_a0 = puVar1[1];
      local_98 = puVar1[2];
      uStack_90 = puVar1[3];
      local_88 = puVar1[4];
      uStack_80 = puVar1[5];
      local_78 = puVar1[6];
      uStack_70 = puVar1[7];
      FUN_1800041d0((PUCHAR)param_1[2],param_2[2],local_68,&local_a8,param_4);
    }
  }
  FUN_18001fe50(local_28 ^ (ulonglong)auStackY_e8);
  return;
}



void FUN_180004570(undefined8 param_1,uint param_2)

{
  FUN_180004ff0(param_1,(uint *)param_1,param_2);
  return;
}



void FUN_180004590(uint *param_1,uint param_2)

{
  NTSTATUS NVar1;
  undefined **ppuVar2;
  ULONG *pUVar3;
  int iVar4;
  undefined1 auStackY_b8 [32];
  ULONG local_78 [2];
  BCRYPT_HASH_HANDLE local_70;
  BCRYPT_ALG_HANDLE local_68;
  undefined *local_60;
  UCHAR local_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStackY_b8;
  local_60 = &DAT_180045ba8;
  local_78[0] = 0x20;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_68,&local_70,(PUCHAR)0x0,0,"QWNj",0x15,0);
    if (-1 < NVar1) {
      iVar4 = 0;
      pUVar3 = local_78;
      ppuVar2 = &local_60;
      do {
        if (((*ppuVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
           (NVar1 = BCryptHashData(local_70,*ppuVar2,*pUVar3,0), NVar1 < 0)) goto LAB_1800046a5;
        iVar4 = iVar4 + 1;
        ppuVar2 = ppuVar2 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar4 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_70,local_58,0x20,0);
      }
LAB_1800046a5:
      BCryptDestroyHash(local_70);
    }
    BCryptCloseAlgorithmProvider(local_68,0);
    if (-1 < NVar1) {
      FUN_180002310(local_48,local_58,param_1,param_1,param_2);
    }
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStackY_b8);
  return;
}



void FUN_180004730(longlong param_1,uint param_2,ulonglong *param_3,int param_4,longlong param_5)

{
  NTSTATUS NVar1;
  longlong *plVar2;
  ULONG *pUVar3;
  int iVar4;
  undefined8 uVar5;
  undefined1 auStackY_128 [32];
  undefined8 in_stack_fffffffffffffef8;
  uint local_e8 [2];
  int local_e0 [2];
  BCRYPT_HASH_HANDLE local_d8;
  longlong local_d0;
  ULONG local_c8 [2];
  BCRYPT_ALG_HANDLE local_c0;
  int local_b8 [20];
  UCHAR local_68 [32];
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStackY_128;
  iVar4 = 0;
  local_e0[0] = 0;
  local_e8[0] = param_2;
  if (param_4 == 0x60) {
    if (*(longlong *)(param_5 + 0x28) == 0) {
      uVar5 = 0x20;
      iVar4 = FUN_180020a30(param_3,0x180045c30,0x20);
      if (iVar4 == 0) {
        local_b8[2] = 0x7e5af32e;
        local_b8[3] = 0x6450e3f;
        local_b8[4] = -0xc2ef683;
        local_b8[5] = -0x54ede992;
        local_b8[6] = -0x5a97d7d8;
        local_b8[7] = -0x10a08b80;
        local_b8[8] = 0x4b1d13af;
        local_b8[9] = -0x379e48f7;
        local_b8[10] = -0x7d6a26da;
        local_b8[0xb] = -0x1dfc2e1a;
        local_b8[0xc] = -0x70fe801a;
        local_b8[0xd] = 0x20702292;
        local_b8[0xe] = -0x6167d619;
        local_b8[0xf] = 0x13c294b2;
        local_b8[0x10] = 0x2ad9c944;
        local_b8[0x11] = 0x127d49e5;
        local_b8[0] = 0x31534345;
        local_b8[1] = 0x20;
        local_e8[0] = param_2;
        local_d0 = param_1;
        FUN_1800014f0(&local_d0,local_e8,uVar5,local_b8,in_stack_fffffffffffffef8,
                      (PUCHAR)(param_3 + 4));
      }
    }
    else {
      local_c8[0] = 0x40;
      local_c0 = (BCRYPT_ALG_HANDLE)0x0;
      local_d0 = *(longlong *)(param_5 + 0x28);
      NVar1 = BCryptOpenAlgorithmProvider(&local_c0,L"SHA256",(LPCWSTR)0x0,0);
      if (-1 < NVar1) {
        NVar1 = BCryptCreateHash(local_c0,&local_d8,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
        if (-1 < NVar1) {
          plVar2 = &local_d0;
          pUVar3 = local_c8;
          do {
            if ((((PUCHAR)*plVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
               (NVar1 = BCryptHashData(local_d8,(PUCHAR)*plVar2,*pUVar3,0), NVar1 < 0))
            goto LAB_180004852;
            iVar4 = iVar4 + 1;
            plVar2 = plVar2 + 1;
            pUVar3 = pUVar3 + 1;
          } while (iVar4 == 0);
          if (-1 < NVar1) {
            NVar1 = BCryptFinishHash(local_d8,local_68,0x20,0);
          }
LAB_180004852:
          BCryptDestroyHash(local_d8);
          param_2 = local_e8[0];
        }
        BCryptCloseAlgorithmProvider(local_c0,0);
        if ((-1 < NVar1) && (iVar4 = FUN_180020a30(param_3,(longlong)local_68,0x20), iVar4 == 0)) {
          FUN_180001860(*(undefined8 **)(param_5 + 0x28),param_1,(ulonglong)param_2,
                        (PUCHAR)(param_3 + 4),local_e0);
        }
      }
    }
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStackY_128);
  return;
}



BOOL __stdcall
InitializeCriticalSectionEx(LPCRITICAL_SECTION lpCriticalSection,DWORD dwSpinCount,DWORD Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800049c0. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = InitializeCriticalSectionEx(lpCriticalSection,dwSpinCount,Flags);
  return BVar1;
}



void FUN_1800049d0(undefined8 *param_1,undefined8 param_2,undefined8 param_3,undefined8 *param_4,
                  int *param_5)

{
  PUCHAR pUVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  int iVar4;
  NTSTATUS NVar5;
  undefined8 *puVar6;
  int iVar7;
  PUCHAR pUVar8;
  uint uVar9;
  undefined1 auStackY_c8 [32];
  uint local_88;
  BCRYPT_ALG_HANDLE local_80;
  int local_78;
  undefined8 local_70;
  undefined8 *local_68;
  undefined4 local_60;
  undefined4 local_5c;
  undefined8 local_58;
  undefined8 uStack_50;
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStackY_c8;
  iVar7 = 0;
  uVar9 = param_5[1] + *param_5;
  local_70 = param_2;
  local_68 = param_1;
  iVar4 = (*(code *)*param_1)(param_1[3],0,0x50,0);
  if (iVar4 != 0) {
    local_78 = local_88 + 0x40 + uVar9;
    puVar6 = (undefined8 *)FUN_18001fcf8((longlong)local_78);
    if (puVar6 != (undefined8 *)0x0) {
      pUVar1 = (PUCHAR)(puVar6 + 8);
      pUVar8 = pUVar1 + (int)local_88;
      NVar5 = BCryptOpenAlgorithmProvider(&local_80,L"RNG",(LPCWSTR)0x0,0);
      if (-1 < NVar5) {
        BCryptGenRandom(local_80,pUVar1,0x50,0);
        BCryptCloseAlgorithmProvider(local_80,0);
      }
      *(undefined4 *)(puVar6 + 4) = 0x80000003;
      *(undefined4 *)((longlong)puVar6 + 0x24) = 0;
      *(int *)(puVar6 + 5) = (int)pUVar1 - (int)puVar6;
      *(uint *)((longlong)puVar6 + 0x2c) = local_88;
      if (0 < (int)uVar9) {
        do {
          FUN_18001fe80((undefined8 *)(pUVar8 + iVar7),(undefined8 *)*param_4,(longlong)*param_5);
          iVar7 = iVar7 + *param_5;
          param_4 = param_4 + 1;
          param_5 = param_5 + 1;
        } while (iVar7 < (int)uVar9);
      }
      puVar6[6] = 0x7d3;
      *(uint *)((longlong)puVar6 + 0x3c) = uVar9;
      pUVar1 = (PUCHAR)(puVar6 + 8);
      *(int *)(puVar6 + 7) = (int)pUVar8 - (int)puVar6;
      local_58 = puVar6[0x10];
      uStack_50 = puVar6[0x11];
      FUN_180001fc0(pUVar1,0x40,(PUCHAR)&local_58,pUVar8,uVar9,pUVar8,uVar9,(ULONG *)0x0);
      puVar3 = local_68;
      iVar4 = (*(code *)*local_68)(local_68[3],pUVar1,0x50,pUVar1);
      if (iVar4 != 0) {
        local_68 = (undefined8 *)0xeeccaa8866442200;
        local_60 = 0x99bbddff;
        local_5c = 0x11335577;
        FUN_180001fc0(&DAT_180045b68,0x20,(PUCHAR)&local_68,pUVar1,local_88,pUVar1,local_88,
                      (ULONG *)&local_80);
        *puVar6 = 0x4545464c;
        GetSystemTimeAsFileTime((LPFILETIME)(puVar6 + 1));
        uVar2 = ((undefined8 *)puVar3[2])[1];
        puVar6[2] = *(undefined8 *)puVar3[2];
        puVar6[3] = uVar2;
        local_68 = (undefined8 *)0xeeccaa8866442200;
        local_60 = 0x99bbddff;
        local_5c = 0x11335577;
        FUN_180001fc0(&DAT_180045b58,0x10,(PUCHAR)&local_68,(PUCHAR)(puVar6 + 4),0x20,
                      (PUCHAR)(puVar6 + 4),0x20,(ULONG *)&local_80);
        (*(code *)puVar3[1])(puVar3[3],local_70,puVar6,local_78);
      }
      FUN_18001fcb8(puVar6);
    }
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStackY_c8);
  return;
}



void FUN_180004c80(undefined8 *param_1,undefined8 param_2,undefined8 param_3,int param_4,int param_5
                  )

{
  undefined1 auStackY_68 [32];
  int local_38;
  int local_34;
  undefined4 *local_30;
  undefined8 local_28;
  undefined4 local_20;
  undefined2 local_1c;
  undefined2 local_1a;
  undefined4 local_18;
  ulonglong local_10;
  
  local_10 = DAT_18004a880 ^ (ulonglong)auStackY_68;
  local_20 = 0xc;
  local_1c = (undefined2)param_4;
  local_38 = 0xc;
  local_1a = (undefined2)param_5;
  local_30 = &local_20;
  local_34 = param_4 * param_5;
  local_18 = 0x80001;
  local_28 = param_3;
  FUN_1800049d0(param_1,param_2,param_3,&local_30,&local_38);
  FUN_18001fe50(local_10 ^ (ulonglong)auStackY_68);
  return;
}



void FUN_180004d00(undefined8 param_1,longlong *param_2,uint *param_3)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  uint cbBuffer;
  int iVar4;
  NTSTATUS NVar5;
  ulonglong uVar6;
  undefined1 (*pauVar7) [16];
  uint *puVar8;
  uint uVar9;
  ulonglong uVar10;
  PUCHAR pUVar11;
  uint uVar12;
  ulonglong uVar13;
  uint uVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  int iVar19;
  int iVar20;
  int iVar21;
  PUCHAR in_stack_00000038;
  undefined1 auStack_f8 [48];
  uint local_c8 [2];
  BCRYPT_ALG_HANDLE local_c0;
  PUCHAR local_b8;
  uint local_b0 [10];
  PUCHAR local_88 [8];
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStack_f8;
  local_c8[0] = 6;
  iVar4 = FUN_180003cb0((undefined8 *)0x0,local_b0 + 1,local_c8,in_stack_00000038);
  if (iVar4 == 0) {
    local_c8[0] = local_c8[0] + 1;
    uVar13 = 0;
    local_b0[0] = 0x20;
    uVar9 = 0;
    FUN_180003e30((undefined *)0x0,0,(undefined8 *)0x0,local_b0 + local_c8[0]);
    local_c8[0] = local_c8[0] + 1;
    if (local_c8[0] != 0) {
      uVar10 = uVar13;
      uVar6 = uVar13;
      if (7 < local_c8[0]) {
        iVar15 = 0;
        iVar16 = 0;
        iVar18 = 0;
        iVar20 = 0;
        iVar4 = iVar15;
        iVar17 = iVar16;
        iVar19 = iVar18;
        iVar21 = iVar20;
        do {
          puVar8 = local_b0 + uVar10;
          lVar1 = uVar10 + 1;
          lVar2 = uVar10 + 2;
          lVar3 = uVar10 + 3;
          uVar6 = (ulonglong)((int)uVar10 + 4);
          uVar9 = (int)uVar10 + 8;
          uVar10 = (ulonglong)uVar9;
          iVar15 = *puVar8 + iVar15;
          iVar16 = local_b0[lVar1] + iVar16;
          iVar18 = local_b0[lVar2] + iVar18;
          iVar20 = local_b0[lVar3] + iVar20;
          iVar4 = local_b0[uVar6] + iVar4;
          iVar17 = local_b0[uVar6 + 1] + iVar17;
          iVar19 = local_b0[uVar6 + 2] + iVar19;
          iVar21 = local_b0[uVar6 + 3] + iVar21;
        } while (uVar9 < local_c8[0] - (local_c8[0] & 7));
        uVar6 = (ulonglong)
                (uint)(iVar15 + iVar4 + iVar18 + iVar19 + iVar16 + iVar17 + iVar20 + iVar21);
      }
      uVar9 = (uint)uVar6;
      if ((uint)uVar10 < local_c8[0]) {
        puVar8 = local_b0 + uVar10;
        uVar10 = (ulonglong)(local_c8[0] - (uint)uVar10);
        do {
          uVar9 = (int)uVar6 + *puVar8;
          uVar6 = (ulonglong)uVar9;
          puVar8 = puVar8 + 1;
          uVar10 = uVar10 - 1;
        } while (uVar10 != 0);
      }
    }
    pauVar7 = (undefined1 (*) [16])*param_2;
    uVar14 = (local_c8[0] * 4 + 0x13 + uVar9 & 0xfffffff0) + 0xc;
    if (pauVar7 == (undefined1 (*) [16])0x0) {
      pauVar7 = (undefined1 (*) [16])FUN_18001fcf8((ulonglong)uVar14);
      if (pauVar7 == (undefined1 (*) [16])0x0) goto LAB_180004fd0;
    }
    else if (*param_3 < uVar14) {
      *param_3 = uVar14;
      goto LAB_180004fd0;
    }
    FUN_180020400(pauVar7,0,(ulonglong)uVar14);
    cbBuffer = local_b0[0];
    *(uint *)*pauVar7 = uVar14;
    *(undefined4 *)(*pauVar7 + 4) = 1;
    *(undefined4 *)(*pauVar7 + 8) = 1;
    *(uint *)(*pauVar7 + 0xc) = local_c8[0];
    pUVar11 = pauVar7[1] + (ulonglong)local_c8[0] * 4;
    if (local_c8[0] != 0) {
      do {
        uVar14 = local_b0[uVar13];
        local_88[uVar13] = pUVar11;
        *(uint *)(pauVar7[1] + uVar13 * 4) = uVar14;
        uVar12 = (int)uVar13 + 1;
        uVar13 = (ulonglong)uVar12;
        pUVar11 = pUVar11 + uVar14;
      } while (uVar12 < local_c8[0]);
    }
    local_b8 = local_88[0];
    NVar5 = BCryptOpenAlgorithmProvider(&local_c0,L"RNG",(LPCWSTR)0x0,0);
    uVar14 = local_c8[0];
    if (-1 < NVar5) {
      NVar5 = BCryptGenRandom(local_c0,local_b8,cbBuffer,0);
      BCryptCloseAlgorithmProvider(local_c0,0);
      uVar14 = local_c8[0];
      if (-1 < NVar5) {
        local_c8[0] = local_c8[0] - 2;
        iVar4 = FUN_180003cb0(local_88 + 1,local_b0 + 1,local_c8,in_stack_00000038);
        uVar14 = local_c8[0] + 2;
        if (iVar4 == 0) {
          uVar14 = local_c8[0] + 1;
          local_c8[0] = local_c8[0] + 2;
          iVar4 = FUN_180003e30(local_88[0],uVar9 - local_b0[uVar14],(undefined8 *)local_88[uVar14],
                                local_b0 + uVar14);
          uVar14 = local_c8[0];
          if ((iVar4 == 0) &&
             (iVar4 = FUN_180004030((uint *)(*pauVar7 + 0xc),*(int *)*pauVar7 - 0xc),
             uVar14 = local_c8[0], iVar4 == 0)) {
            *param_2 = (longlong)pauVar7;
            *param_3 = *(uint *)*pauVar7;
            goto LAB_180004fd0;
          }
        }
      }
    }
    local_c8[0] = uVar14;
    if ((undefined1 (*) [16])*param_2 != pauVar7) {
      FUN_18001fcb8(pauVar7);
    }
  }
LAB_180004fd0:
  FUN_18001fe50(local_48 ^ (ulonglong)auStack_f8);
  return;
}



void FUN_180004ff0(undefined8 param_1,uint *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint *puVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  longlong *plVar9;
  uint *puVar10;
  char *in_stack_00000038;
  undefined1 auStackY_a8 [32];
  int local_78 [8];
  longlong local_58 [8];
  ulonglong local_18;
  
  local_18 = DAT_18004a880 ^ (ulonglong)auStackY_a8;
  if ((((0xf < param_3) && (*param_2 <= param_3)) && (param_2[1] == 2)) &&
     ((param_2[2] == 1 && (iVar4 = FUN_180004590(param_2 + 3,*param_2 - 0xc), iVar4 == 0)))) {
    uVar1 = param_2[3];
    uVar2 = *param_2;
    uVar6 = 0;
    if (((ulonglong)uVar1 * 4 + 0x10 <= (ulonglong)uVar2) && (uVar1 < 9)) {
      puVar10 = param_2 + (ulonglong)uVar1 + 4;
      if (uVar1 != 0) {
        puVar5 = param_2 + 4;
        plVar9 = local_58;
        uVar8 = 0;
        do {
          uVar7 = uVar8;
          uVar3 = *puVar5;
          uVar6 = uVar6 + uVar3;
          if (uVar2 - 4 < uVar6) goto LAB_18000512f;
          *plVar9 = (longlong)puVar10;
          uVar8 = uVar7 + 1;
          *(uint *)((longlong)local_78 + (-0x10 - (longlong)param_2) + (longlong)puVar5) = uVar3;
          puVar10 = (uint *)((longlong)puVar10 + (ulonglong)uVar3);
          plVar9 = plVar9 + 1;
          puVar5 = puVar5 + 1;
        } while (uVar8 < uVar1);
        if ((1 < uVar8) &&
           (iVar4 = FUN_180004730(local_58[0],uVar6 - local_78[uVar7],(ulonglong *)local_58[uVar7],
                                  local_78[uVar7],(longlong)in_stack_00000038), iVar4 == 0)) {
          FUN_1800043e0(local_58 + 1,local_78 + 1,(ulonglong)(uVar7 - 1),in_stack_00000038);
        }
      }
    }
  }
LAB_18000512f:
  FUN_18001fe50(local_18 ^ (ulonglong)auStackY_a8);
  return;
}



ulonglong FUN_180005150(byte *param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  ulonglong uVar2;
  
  bVar1 = FUN_180005d38(param_1,param_2,param_3);
  if (bVar1 == 0xff) {
    uVar2 = 0x10;
  }
  else {
    uVar2 = (longlong)((0xff - param_4) * 0x10) / (longlong)(int)(0xff - (uint)bVar1) & 0xffffffff;
  }
  return uVar2;
}



void FUN_180005184(byte *param_1,int param_2,int param_3,int param_4)

{
  ulonglong uVar1;
  
  uVar1 = FUN_180005150(param_1,param_2,param_3,param_4);
  FUN_1800060b8(param_1,param_2,param_3,(int)uVar1);
  return;
}



int FUN_1800051c0(longlong param_1,uint param_2,int param_3,byte *param_4,int param_5)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  ulonglong uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  byte *pbVar9;
  int local_res20;
  
  iVar6 = 0;
  if (((param_5 < 0) || (param_1 == 0)) || (param_4 == (byte *)0x0)) {
    iVar6 = -1;
  }
  else {
    local_res20 = 0;
    if (0 < param_5) {
      while( true ) {
        iVar5 = 0;
        iVar6 = 0;
        iVar7 = 0;
        if (param_3 < 1) break;
        pbVar8 = param_4;
        do {
          iVar6 = 0;
          if (0 < (int)param_2) {
            pbVar9 = pbVar8;
            do {
              if ((*pbVar9 & 1) != 0) {
                cVar1 = FUN_180005360(param_1,(longlong)param_4,iVar6,iVar7,param_2,param_3,0x10);
                iVar2 = (int)CONCAT71(extraout_var,cVar1);
                if (iVar2 != 0xff) {
                  iVar2 = (iVar2 + 7) * 0x112;
                  uVar3 = (int)(iVar2 + (iVar2 >> 0x1f & 0xfffU)) >> 0xc & 0x80000007;
                  if ((int)uVar3 < 0) {
                    uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
                  }
                  uVar4 = FUN_1800057a4((longlong)(pbVar8 + (param_1 - (longlong)param_4)),
                                        (longlong)pbVar8,param_2,param_3,iVar6,iVar7,uVar3);
                  if (-1 < (int)uVar4) {
                    pbVar9[(longlong)(pbVar8 + (param_1 - (longlong)param_4)) - (longlong)pbVar8] =
                         (byte)uVar4;
                    *pbVar9 = 2;
                    goto LAB_1800052ee;
                  }
                }
                iVar5 = iVar5 + 1;
              }
LAB_1800052ee:
              iVar6 = iVar6 + 1;
              pbVar9 = pbVar9 + 1;
            } while (iVar6 < (int)param_2);
          }
          iVar7 = iVar7 + 1;
          pbVar8 = pbVar8 + (int)param_2;
        } while (iVar7 < param_3);
        if (iVar5 == 0) {
          return 0;
        }
        local_res20 = local_res20 + 1;
        if (param_5 <= local_res20) {
          return iVar5;
        }
      }
    }
  }
  return iVar6;
}



char FUN_180005360(longlong param_1,longlong param_2,int param_3,int param_4,int param_5,int param_6
                  ,int param_7)

{
  longlong lVar1;
  char cVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  longlong lVar8;
  int iVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  uint uVar13;
  uint uVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  int iVar18;
  int local_res18;
  int local_68;
  int local_64;
  
  local_64 = 0;
  local_68 = 0;
  iVar5 = 0;
  iVar9 = 0;
  iVar4 = param_7 / 2;
  local_res18 = 0;
  iVar10 = param_3 - iVar4;
  lVar8 = (longlong)iVar10;
  if (lVar8 < iVar4 + param_3) {
    do {
      if ((longlong)param_4 - (longlong)iVar4 < (longlong)(iVar4 + param_4)) {
        lVar17 = (longlong)param_5;
        lVar12 = (longlong)param_4 - (longlong)iVar4;
        iVar18 = param_4 - iVar4;
        do {
          lVar11 = lVar12 + 1;
          if ((((0 < lVar8) && (iVar10 < param_5 + -1)) && (0 < lVar12)) && (iVar18 < param_6 + -1))
          {
            lVar1 = lVar12 * lVar17 + lVar8;
            lVar16 = lVar11 * lVar17 + lVar8;
            lVar12 = (lVar12 + -1) * lVar17 + lVar8;
            iVar5 = local_res18;
            if ((*(uint *)(lVar16 + -1 + param_2) & 0xffffff00) +
                (*(uint *)(lVar1 + -1 + param_2) & 0xffffff00) +
                (*(uint *)(lVar12 + -1 + param_2) & 0xffffff00) == 0) {
              uVar13 = (uint)*(byte *)(lVar16 + -1 + param_1);
              uVar6 = (uint)*(byte *)(param_1 + -1 + lVar12);
              uVar7 = (uint)*(byte *)(param_1 + 1 + lVar12);
              uVar14 = (uint)*(byte *)(lVar16 + 1 + param_1);
              iVar15 = ((((uint)*(byte *)(lVar1 + 1 + param_1) -
                         (uint)*(byte *)(lVar1 + -1 + param_1)) - uVar13) - uVar6) + uVar14 + uVar7;
              iVar5 = ((((uint)*(byte *)(lVar16 + param_1) - (uint)*(byte *)(param_1 + lVar12)) -
                       uVar7) - uVar6) + uVar14 + uVar13;
              local_64 = local_64 + iVar15 * iVar15;
              local_68 = local_68 + iVar5 * iVar5;
              local_res18 = local_res18 + iVar5 * iVar15;
              iVar9 = iVar9 + 1;
              iVar5 = local_res18;
            }
          }
          iVar18 = iVar18 + 1;
          lVar12 = lVar11;
        } while (lVar11 < iVar4 + param_4);
      }
      lVar8 = lVar8 + 1;
      iVar10 = iVar10 + 1;
    } while (lVar8 < iVar4 + param_3);
    if (iVar9 != 0) {
      iVar4 = iVar9 / 2;
      uVar7 = ((iVar4 + iVar5) / iVar9) * 2;
      uVar14 = (local_64 + iVar4) / iVar9 - (local_68 + iVar4) / iVar9;
      if (uVar14 == 0) {
        if ((int)uVar7 < 1) {
          return '\x1e';
        }
        return 'Z';
      }
      iVar4 = (uVar14 ^ (int)uVar14 >> 0x1f) - ((int)uVar14 >> 0x1f);
      iVar5 = (uVar7 ^ (int)uVar7 >> 0x1f) - ((int)uVar7 >> 0x1f);
      if (iVar4 < iVar5) {
        uVar6 = 0x1e0 - (byte)(&DAT_18002d5b0)[(iVar5 / 2 + iVar4 * 0x80) / iVar5];
      }
      else {
        uVar6 = (uint)(byte)(&DAT_18002d5b0)[(iVar4 / 2 + iVar5 * 0x80) / iVar4];
      }
      cVar2 = (char)((int)(uVar6 + 8 + ((int)(uVar6 + 8) >> 0x1f & 0xfU)) >> 4);
      if ((int)uVar14 < 0) {
        if ((int)uVar7 < 0) {
          return cVar2;
        }
        if (cVar2 == '\0') {
          return '\0';
        }
        cVar3 = 'x';
      }
      else {
        cVar3 = '<';
        if (-1 < (int)uVar7) {
          return cVar2 + '<';
        }
      }
      return cVar3 - cVar2;
    }
  }
  return -1;
}



ulonglong FUN_180005660(byte *param_1,int param_2,uint param_3,int param_4,int param_5)

{
  uint uVar1;
  
  uVar1 = FUN_180005690(param_1,param_2,param_3,param_4,param_5);
  return (ulonglong)uVar1 / (ulonglong)(param_3 * param_4);
}



int FUN_180005690(byte *param_1,int param_2,uint param_3,int param_4,int param_5)

{
  byte bVar1;
  int iVar2;
  ulonglong uVar3;
  byte *pbVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  
  iVar8 = 0;
  lVar6 = (longlong)param_4;
  if (param_5 == 0) {
    iVar2 = 0;
    if (0 < (int)param_3) {
      uVar3 = (ulonglong)param_3;
      do {
        lVar5 = 0;
        if (0 < param_4) {
          do {
            pbVar4 = param_1 + lVar5;
            lVar5 = lVar5 + 1;
            iVar8 = iVar8 + (uint)*pbVar4;
          } while (lVar5 < lVar6);
        }
        param_1 = param_1 + param_2;
        uVar3 = uVar3 - 1;
        iVar2 = iVar8;
      } while (uVar3 != 0);
    }
  }
  else {
    iVar7 = 0;
    iVar2 = iVar8;
    if (0 < (int)param_3) {
      do {
        if (0 < lVar6) {
          pbVar4 = param_1;
          do {
            bVar1 = *pbVar4;
            if ((int)(uint)bVar1 < param_5) {
              return 0;
            }
            pbVar4 = pbVar4 + 1;
            iVar8 = iVar8 + (uint)bVar1;
          } while ((longlong)pbVar4 - (longlong)param_1 < lVar6);
        }
        iVar7 = iVar7 + 1;
        param_1 = param_1 + param_2;
        iVar2 = iVar8;
      } while (iVar7 < (int)param_3);
    }
  }
  return iVar2;
}



int FUN_180005724(longlong param_1,int param_2,byte *param_3,int param_4,uint param_5,int param_6)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  longlong lVar4;
  ulonglong uVar5;
  int iVar6;
  
  iVar6 = 0;
  if (0 < (int)param_5) {
    uVar5 = (ulonglong)param_5;
    do {
      if (0 < (longlong)param_6) {
        pbVar3 = param_3;
        lVar4 = (longlong)param_6;
        do {
          pbVar1 = pbVar3 + (param_1 - (longlong)param_3);
          bVar2 = *pbVar3;
          pbVar3 = pbVar3 + 1;
          iVar6 = iVar6 + ((uint)bVar2 - (uint)*pbVar1) * ((uint)bVar2 - (uint)*pbVar1);
          lVar4 = lVar4 + -1;
        } while (lVar4 != 0);
      }
      param_3 = param_3 + param_4;
      param_1 = param_1 + param_2;
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  return iVar6;
}



ulonglong FUN_1800057a4(longlong param_1,longlong param_2,uint param_3,int param_4,int param_5,
                       int param_6,int param_7)

{
  longlong lVar1;
  ulonglong uVar2;
  int iVar3;
  ulonglong uVar4;
  longlong lVar5;
  int iVar6;
  longlong lVar7;
  int iVar8;
  longlong lVar9;
  longlong lVar10;
  int iVar11;
  longlong local_res8;
  
  uVar4 = (ulonglong)(int)param_3;
  iVar3 = 0;
  iVar11 = 0;
  lVar9 = 0;
  iVar6 = param_6 + -1;
  lVar1 = (longlong)(int)((param_5 - param_3) + -1);
  lVar7 = lVar1 + param_1;
  lVar1 = param_2 + lVar1;
  local_res8 = 3;
  lVar10 = 0;
  uVar2 = uVar4;
  do {
    if ((-1 < iVar6) && (iVar6 <= param_4 + -1)) {
      lVar5 = 0;
      iVar8 = param_5 + -1;
      do {
        if ((lVar10 != 1) || (lVar5 != 1)) {
          if ((-1 < iVar8) && (iVar8 < (int)uVar2 + -1)) {
            if ((((byte *)(lVar5 + lVar7))[lVar1 - lVar7] & 1) == 0) {
              iVar11 = iVar11 + (uint)*(byte *)(lVar5 + lVar7) *
                                (uint)(byte)(&DAT_18002d640)[lVar9 + (longlong)param_7 * 8];
              iVar3 = iVar3 + (uint)(byte)(&DAT_18002d640)[lVar9 + (longlong)param_7 * 8];
            }
            uVar2 = (ulonglong)param_3;
          }
          lVar9 = lVar9 + 1;
        }
        lVar5 = lVar5 + 1;
        iVar8 = iVar8 + 1;
      } while (lVar5 < 3);
    }
    lVar10 = lVar10 + 1;
    iVar6 = iVar6 + 1;
    lVar1 = lVar1 + uVar4;
    lVar7 = lVar7 + uVar4;
    local_res8 = local_res8 + -1;
  } while (local_res8 != 0);
  if (iVar3 < 1) {
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = (longlong)iVar11 / (longlong)iVar3 & 0xffffffff;
  }
  return uVar2;
}



void FUN_1800058b0(longlong param_1,int param_2,int param_3)

{
  byte bVar1;
  LPVOID pvVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  ulonglong uVar6;
  int iVar7;
  undefined1 *puVar8;
  longlong lVar9;
  undefined1 *puVar10;
  int iVar11;
  undefined1 auStack_c8 [32];
  int local_a8;
  int local_a4;
  longlong local_a0;
  undefined1 *local_98;
  longlong local_90;
  longlong local_88;
  int local_80 [10];
  byte local_58 [16];
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStack_c8;
  uVar6 = (ulonglong)param_2;
  iVar7 = 0;
  local_a8 = 0;
  pvVar2 = FUN_18001fcf8((longlong)(param_2 * 3));
  if (pvVar2 != (LPVOID)0x0) {
    local_80[6] = param_2 * 2;
    iVar11 = 1;
    local_80[4] = param_2 + 1;
    puVar8 = (undefined1 *)(param_1 + uVar6);
    local_80[5] = param_2 + 2;
    local_80[0] = 0;
    local_80[7] = local_80[6] + 1;
    local_80[1] = 1;
    local_80[8] = local_80[6] + 2;
    local_a4 = param_3 + -1;
    local_80[2] = 2;
    local_80[3] = param_2;
    if (1 < local_a4) {
      lVar9 = 0;
      local_90 = (longlong)(param_2 + -1);
      iVar7 = 0;
      do {
        puVar10 = (undefined1 *)(lVar9 + (longlong)pvVar2);
        *puVar10 = *puVar8;
        lVar5 = 1;
        if (1 < local_90) {
          local_98 = puVar8 + (-uVar6 - (longlong)puVar10) + -1;
          local_a0 = local_90 + -1;
          do {
            puVar10 = puVar10 + 1;
            lVar5 = 0;
            do {
              lVar4 = lVar5 + 1;
              local_58[lVar5] = puVar10[(longlong)(local_98 + local_80[lVar5])];
              lVar5 = lVar4;
            } while (lVar4 < 9);
            lVar5 = 8;
            lVar4 = 8;
            do {
              lVar3 = 0;
              if (0 < lVar5) {
                do {
                  bVar1 = local_58[lVar3];
                  if (local_58[lVar3 + 1] < bVar1) {
                    local_58[lVar3] = local_58[lVar3 + 1];
                    local_58[lVar3 + 1] = bVar1;
                  }
                  lVar3 = lVar3 + 1;
                } while (lVar3 < lVar5);
              }
              lVar5 = lVar5 + -1;
              lVar4 = lVar4 + -1;
            } while (lVar4 != 0);
            *puVar10 = local_58[4];
            local_a0 = local_a0 + -1;
          } while (local_a0 != 0);
          local_a0 = 0;
          lVar5 = local_90;
          local_88 = local_90;
        }
        *(undefined1 *)(lVar5 + lVar9 + (longlong)pvVar2) = puVar8[lVar5];
        local_a8 = local_a8 + param_2;
        lVar9 = lVar9 + uVar6;
        if (local_a8 == param_2 * 3) {
          local_a8 = 0;
          lVar9 = 0;
        }
        if (2 < iVar11) {
          FUN_18001fe80((undefined8 *)(puVar8 + -(longlong)(param_2 * 2)),
                        (undefined8 *)((longlong)iVar7 + (longlong)pvVar2),uVar6);
          iVar7 = iVar7 + param_2;
          if (iVar7 == param_2 * 3) {
            iVar7 = 0;
          }
        }
        iVar11 = iVar11 + 1;
        puVar8 = puVar8 + uVar6;
      } while (iVar11 < local_a4);
    }
    FUN_18001fe80((undefined8 *)(puVar8 + -(longlong)(param_2 * 2)),
                  (undefined8 *)((longlong)iVar7 + (longlong)pvVar2),uVar6);
    iVar11 = iVar7 + param_2;
    if (iVar7 + param_2 == param_2 * 3) {
      iVar11 = 0;
    }
    FUN_18001fe80((undefined8 *)(puVar8 + -uVar6),
                  (undefined8 *)((longlong)iVar11 + (longlong)pvVar2),uVar6);
    FUN_18001fcb8(pvVar2);
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStack_c8);
  return;
}



int FUN_180005ae0(byte *param_1,int param_2,int param_3)

{
  byte local_res20 [8];
  byte local_18 [24];
  
  FUN_180005b34(param_1,param_2,param_3,local_res20,local_18,1);
  return (uint)local_res20[0] - (uint)local_18[0];
}



void FUN_180005b14(byte *param_1,int param_2,int param_3,undefined1 *param_4,undefined1 *param_5)

{
  FUN_180005b34(param_1,param_2,param_3,param_4,param_5,0);
  return;
}



void FUN_180005b34(byte *param_1,int param_2,int param_3,undefined1 *param_4,undefined1 *param_5,
                  int param_6)

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  ulonglong uVar7;
  longlong lVar8;
  uint uVar9;
  int iVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  int *piVar13;
  int iVar14;
  undefined1 auStack_498 [32];
  int local_478;
  uint local_474;
  int local_470;
  int local_46c;
  uint local_468;
  int local_464;
  undefined1 *local_460;
  undefined1 *local_458;
  int local_448 [256];
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStack_498;
  iVar5 = param_2 * param_3;
  local_458 = param_5;
  local_468 = 0;
  iVar10 = 0;
  local_464 = 0;
  uVar7 = 0;
  iVar14 = 0;
  local_46c = 0;
  local_470 = 0;
  local_474 = 1;
  local_478 = 1;
  iVar3 = 0;
  local_460 = param_4;
  FUN_180020400((undefined1 (*) [16])local_448,0,0x400);
  lVar1 = (longlong)iVar5;
  if (0 < iVar5) {
    do {
      if ((*param_1 < 0xf0) || (param_6 < 1)) {
        iVar10 = iVar10 + (uint)*param_1;
        local_448[*param_1] = local_448[*param_1] + 1;
      }
      else {
        iVar3 = iVar3 + 1;
      }
      param_1 = param_1 + 1;
      lVar1 = lVar1 + -1;
      local_464 = iVar10;
    } while (lVar1 != 0);
  }
  uVar9 = 0;
  piVar13 = local_448;
  uVar12 = uVar7;
  do {
    if (*piVar13 != 0) {
      uVar6 = (int)uVar7 + *piVar13;
      uVar7 = (ulonglong)uVar6;
      iVar14 = iVar14 + *piVar13 * uVar9;
      iVar2 = (iVar5 - iVar3) - uVar6;
      iVar4 = iVar10 - iVar14;
      if ((uVar6 != 0) && (iVar2 != 0)) {
        lVar8 = (longlong)iVar14;
        lVar1 = (longlong)iVar4;
        uVar11 = (ulonglong)(lVar8 * lVar8 * (longlong)iVar2) / (ulonglong)(longlong)(int)uVar6 +
                 (ulonglong)((int)uVar6 * lVar1 * lVar1) / (ulonglong)(longlong)iVar2 +
                 lVar8 * lVar1 * -2;
        iVar10 = local_464;
        if (uVar12 < uVar11) {
          uVar12 = uVar11;
          local_478 = iVar2;
          local_474 = uVar6;
          local_470 = iVar4;
          local_46c = iVar14;
          local_468 = uVar9;
        }
      }
    }
    uVar9 = uVar9 + 1;
    piVar13 = piVar13 + 1;
  } while (uVar9 < 0x100);
  if (local_460 != (undefined1 *)0x0) {
    *local_460 = (char)(local_470 / local_478);
  }
  if (local_458 != (undefined1 *)0x0) {
    *local_458 = (char)(local_46c / (int)local_474);
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStack_498);
  return;
}



void FUN_180005d18(byte *param_1,int param_2,int param_3,undefined1 *param_4,undefined1 *param_5)

{
  FUN_180005b34(param_1,param_2,param_3,param_4,param_5,1);
  return;
}



void FUN_180005d38(byte *param_1,int param_2,int param_3)

{
  int iVar1;
  longlong lVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  ulonglong uVar6;
  int *piVar7;
  longlong lVar8;
  uint uVar9;
  ulonglong uVar10;
  int iVar11;
  int iVar12;
  undefined1 auStack_458 [32];
  int local_438 [256];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_458;
  iVar12 = 0;
  iVar3 = param_2 * param_3;
  uVar10 = 0;
  iVar5 = 0;
  iVar4 = 0;
  iVar11 = 0;
  FUN_180020400((undefined1 (*) [16])local_438,0,0x400);
  lVar2 = (longlong)iVar3;
  if (0 < iVar3) {
    do {
      if (*param_1 < 0xf0) {
        iVar12 = iVar12 + (uint)*param_1;
        local_438[*param_1] = local_438[*param_1] + 1;
      }
      else {
        iVar5 = iVar5 + 1;
      }
      param_1 = param_1 + 1;
      lVar2 = lVar2 + -1;
    } while (lVar2 != 0);
  }
  piVar7 = local_438;
  uVar9 = 0;
  do {
    if (*piVar7 != 0) {
      iVar4 = iVar4 + *piVar7;
      iVar11 = iVar11 + *piVar7 * uVar9;
      iVar1 = (iVar3 - iVar5) - iVar4;
      if ((iVar4 != 0) && (iVar1 != 0)) {
        lVar2 = (longlong)(iVar12 - iVar11);
        lVar8 = (longlong)iVar11;
        uVar6 = (ulonglong)(lVar8 * lVar8 * (longlong)iVar1) / (ulonglong)(longlong)iVar4 +
                (ulonglong)(iVar4 * lVar2 * lVar2) / (ulonglong)(longlong)iVar1 + lVar8 * lVar2 * -2
        ;
        if (uVar10 < uVar6) {
          uVar10 = uVar6;
        }
      }
    }
    uVar9 = uVar9 + 1;
    piVar7 = piVar7 + 1;
  } while (uVar9 < 0x100);
  FUN_18001fe50(local_38 ^ (ulonglong)auStack_458);
  return;
}



void FUN_180005e70(longlong param_1,uint param_2,int param_3,int param_4,uint param_5)

{
  byte bVar1;
  ulonglong uVar2;
  longlong lVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  longlong lVar10;
  ulonglong uVar11;
  uint uVar12;
  ulonglong uVar13;
  int iVar14;
  longlong lVar15;
  longlong lVar16;
  byte *pbVar17;
  undefined1 *puVar18;
  undefined1 *puVar19;
  ulonglong uVar20;
  int iVar21;
  ulonglong uVar22;
  undefined1 auStack_98 [32];
  int local_78;
  uint local_74;
  int local_6c;
  ulonglong local_68;
  longlong local_60;
  undefined8 local_58;
  int local_50 [4];
  ulonglong local_40;
  
  local_40 = DAT_18004a880 ^ (ulonglong)auStack_98;
  uVar13 = (ulonglong)(int)param_2;
  local_74 = param_5;
  local_78 = param_4;
  local_60 = param_1;
  local_58 = (undefined1 *)FUN_18001fcf8((longlong)(int)(param_5 * param_2));
  if (local_58 != (undefined1 *)0x0) {
    iVar21 = 0;
    uVar2 = (longlong)(param_3 << 10) / (longlong)(int)param_5;
    iVar4 = (int)uVar2;
    local_6c = iVar4 / 2;
    uVar12 = param_2;
    if (0 < (int)param_5) {
      uVar20 = (ulonglong)param_5;
      uVar11 = uVar13;
      puVar19 = local_58;
      do {
        iVar14 = 0;
        local_50[0] = 0;
        local_50[1] = 0;
        local_50[2] = 0;
        local_50[3] = 0;
        iVar5 = (int)(iVar21 + (iVar21 >> 0x1f & 0x3ffU)) >> 10;
        iVar8 = (iVar5 + 1) * 0x400 - iVar21;
        if (0 < iVar4) {
          piVar7 = local_50;
          uVar22 = uVar2 & 0xffffffff;
          do {
            iVar6 = (int)uVar22;
            iVar9 = iVar8;
            if (iVar6 < iVar8) {
              iVar9 = iVar6;
            }
            iVar14 = iVar14 + 1;
            uVar22 = (ulonglong)(uint)(iVar6 - iVar9);
            *piVar7 = iVar9;
            iVar8 = 0x400;
            piVar7 = piVar7 + 1;
          } while (0 < iVar6 - iVar9);
        }
        if (0 < (longlong)uVar13) {
          puVar18 = puVar19;
          uVar22 = uVar13;
          do {
            lVar15 = 0;
            pbVar17 = puVar18 + ((param_1 + iVar5 * (int)uVar11) - (longlong)puVar19);
            iVar8 = local_6c;
            if (0 < (longlong)iVar14) {
              do {
                bVar1 = *pbVar17;
                piVar7 = local_50 + lVar15;
                lVar15 = lVar15 + 1;
                pbVar17 = pbVar17 + uVar13;
                iVar8 = iVar8 + *piVar7 * (uint)bVar1;
              } while (lVar15 < iVar14);
            }
            *puVar18 = (char)(iVar8 / iVar4);
            puVar18 = puVar18 + 1;
            uVar22 = uVar22 - 1;
          } while (uVar22 != 0);
          uVar11 = (ulonglong)param_2;
        }
        uVar12 = (uint)uVar11;
        puVar19 = puVar19 + uVar13;
        iVar21 = iVar21 + iVar4;
        uVar20 = uVar20 - 1;
        param_1 = local_60;
        param_5 = local_74;
      } while (uVar20 != 0);
    }
    uVar11 = (ulonglong)param_5;
    lVar15 = (longlong)local_78;
    uVar2 = (longlong)(int)(uVar12 << 10) / (longlong)local_78;
    iVar4 = (int)uVar2;
    puVar19 = local_58;
    if (0 < (int)param_5) {
      do {
        iVar21 = 0;
        lVar16 = 0;
        if (0 < lVar15) {
          do {
            iVar14 = 0;
            iVar5 = (int)(iVar21 + (iVar21 >> 0x1f & 0x3ffU)) >> 10;
            local_50[0] = 0;
            local_50[1] = 0;
            local_50[2] = 0;
            local_50[3] = 0;
            iVar8 = (iVar5 + 1) * 0x400 - iVar21;
            if (0 < iVar4) {
              piVar7 = local_50;
              uVar20 = uVar2 & 0xffffffff;
              do {
                iVar6 = (int)uVar20;
                iVar9 = iVar8;
                if (iVar6 < iVar8) {
                  iVar9 = iVar6;
                }
                iVar14 = iVar14 + 1;
                uVar20 = (ulonglong)(uint)(iVar6 - iVar9);
                *piVar7 = iVar9;
                iVar8 = 0x400;
                piVar7 = piVar7 + 1;
              } while (0 < iVar6 - iVar9);
            }
            lVar10 = 0;
            iVar8 = iVar4 / 2;
            if (0 < (longlong)iVar14) {
              do {
                lVar3 = lVar10 + iVar5;
                lVar10 = lVar10 + 1;
                iVar8 = iVar8 + (uint)(byte)puVar19[lVar3] *
                                *(int *)((longlong)&local_58 + lVar10 * 4 + 4);
              } while (lVar10 < iVar14);
            }
            iVar21 = iVar21 + iVar4;
            *(char *)(lVar16 + param_1) = (char)(iVar8 / iVar4);
            lVar16 = lVar16 + 1;
          } while (lVar16 < lVar15);
        }
        param_1 = param_1 + lVar15;
        uVar11 = uVar11 - 1;
        puVar19 = puVar19 + uVar13;
      } while (uVar11 != 0);
    }
    local_68 = uVar13;
    FUN_18001fcb8(local_58);
  }
  FUN_18001fe50(local_40 ^ (ulonglong)auStack_98);
  return;
}



void FUN_1800060b8(byte *param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  longlong lVar2;
  
  lVar2 = (longlong)(param_2 * param_3);
  if (0 < param_2 * param_3) {
    do {
      iVar1 = (0xff - (uint)*param_1) * param_4 + 8;
      iVar1 = (int)(iVar1 + (iVar1 >> 0x1f & 0xfU)) >> 4;
      if (iVar1 < 0xff) {
        if (iVar1 < 0) {
          *param_1 = 0xff;
        }
        else {
          *param_1 = -(char)iVar1 - 1;
        }
      }
      else {
        *param_1 = 0;
      }
      param_1 = param_1 + 1;
      lVar2 = lVar2 + -1;
    } while (lVar2 != 0);
  }
  return;
}



void FUN_18000610c(byte *param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  longlong lVar3;
  
  lVar3 = (longlong)(param_2 * param_3);
  if (0 < param_2 * param_3) {
    do {
      iVar2 = (uint)*param_1 + param_4;
      if (iVar2 < 0xff) {
        bVar1 = (byte)iVar2;
        if (iVar2 < 1) {
          bVar1 = 0;
        }
        *param_1 = bVar1;
      }
      else {
        *param_1 = 0xff;
      }
      param_1 = param_1 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  return;
}



void FUN_180006144(byte *param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  longlong lVar3;
  
  lVar3 = (longlong)(param_2 * param_3);
  if (0 < lVar3) {
    do {
      if (0xff - param_4 <= (int)(uint)*param_1) {
        iVar2 = (uint)*param_1 + param_4;
        if (iVar2 < 0xff) {
          bVar1 = (byte)iVar2;
          if (iVar2 < 1) {
            bVar1 = 0;
          }
          *param_1 = bVar1;
        }
        else {
          *param_1 = 0xff;
        }
      }
      param_1 = param_1 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  return;
}



void FUN_18000618c(byte *param_1,int param_2,int param_3,int param_4)

{
  byte *pbVar1;
  longlong lVar2;
  int iVar3;
  uint uVar4;
  ulonglong uVar5;
  undefined1 auStack_458 [32];
  int local_438 [256];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_458;
  iVar3 = param_3 * param_2;
  uVar5 = (longlong)iVar3 / (longlong)param_4 & 0xffffffff;
  FUN_180020400((undefined1 (*) [16])local_438,0,0x400);
  lVar2 = (longlong)iVar3;
  pbVar1 = param_1;
  if (0 < iVar3) {
    do {
      local_438[*pbVar1] = local_438[*pbVar1] + 1;
      lVar2 = lVar2 + -1;
      pbVar1 = pbVar1 + 1;
    } while (lVar2 != 0);
  }
  iVar3 = 0xff;
  lVar2 = 0xff;
  do {
    uVar4 = (int)uVar5 - local_438[lVar2];
    uVar5 = (ulonglong)uVar4;
    if ((int)uVar4 < 1) break;
    iVar3 = iVar3 + -1;
    lVar2 = lVar2 + -1;
  } while (-1 < lVar2);
  FUN_18000610c(param_1,param_2,param_3,0xff - iVar3);
  FUN_18001fe50(local_38 ^ (ulonglong)auStack_458);
  return;
}



void FUN_18000623c(byte *param_1,int param_2,int param_3,int param_4)

{
  byte *pbVar1;
  longlong lVar2;
  int iVar3;
  uint uVar4;
  ulonglong uVar5;
  undefined1 auStack_458 [32];
  int local_438 [256];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_458;
  iVar3 = param_3 * param_2;
  uVar5 = (longlong)iVar3 / (longlong)param_4 & 0xffffffff;
  FUN_180020400((undefined1 (*) [16])local_438,0,0x400);
  lVar2 = (longlong)iVar3;
  pbVar1 = param_1;
  if (0 < iVar3) {
    do {
      local_438[*pbVar1] = local_438[*pbVar1] + 1;
      lVar2 = lVar2 + -1;
      pbVar1 = pbVar1 + 1;
    } while (lVar2 != 0);
  }
  iVar3 = 0xff;
  lVar2 = 0xff;
  do {
    uVar4 = (int)uVar5 - local_438[lVar2];
    uVar5 = (ulonglong)uVar4;
    if ((int)uVar4 < 1) break;
    iVar3 = iVar3 + -1;
    lVar2 = lVar2 + -1;
  } while (-1 < lVar2);
  FUN_180006144(param_1,param_2,param_3,0xff - iVar3);
  FUN_18001fe50(local_38 ^ (ulonglong)auStack_458);
  return;
}



undefined8 FUN_1800062ec(void)

{
  return 0;
}



LPCRITICAL_SECTION FUN_1800062f0(LPCRITICAL_SECTION param_1,LPCWSTR param_2)

{
  int iVar1;
  HANDLE pvVar2;
  
  InitializeCriticalSection(param_1);
  *(undefined4 *)&param_1[1].OwningThread = 0;
  param_1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
  *(HANDLE *)&param_1[1].LockCount = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[1].LockSemaphore = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[2].OwningThread = (HANDLE)0x0;
  param_1[2].LockCount = 0;
  param_1[2].RecursionCount = 0;
  param_1[2].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  *(undefined4 *)&param_1[2].LockSemaphore = 0;
  *(undefined4 *)((longlong)&param_1[2].LockSemaphore + 4) = 0;
  param_1[1].SpinCount = (ULONG_PTR)pvVar2;
  lstrcpyW((LPWSTR)&param_1[2].SpinCount,param_2);
  iVar1 = lstrlenW(param_2);
  FUN_180001330("u",0xe,param_2,iVar1 * 2,(PUCHAR)&param_1[0x1c].SpinCount);
  FUN_180020400((undefined1 (*) [16])&param_1[0x1d].LockSemaphore,0,0x30);
  param_1[0x1e].OwningThread = &param_1[0x1c].SpinCount;
  param_1[0x1e].LockSemaphore = &DAT_18003d520;
  return param_1;
}



void FUN_1800063e0(LPCRITICAL_SECTION param_1)

{
  PRTL_CRITICAL_SECTION_DEBUG p_Var1;
  undefined8 uVar2;
  longlong lVar3;
  ULONG_PTR *pUVar4;
  HANDLE *ppvVar5;
  
  if (param_1[1].DebugInfo != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    *(undefined4 *)&param_1[1].OwningThread = 1;
    SetEvent(*(HANDLE *)&param_1[1].LockCount);
    WaitForSingleObject(param_1[1].DebugInfo,0xffffffff);
    CloseHandle(param_1[1].DebugInfo);
    param_1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  }
  CloseHandle(*(HANDLE *)&param_1[1].LockCount);
  DeleteCriticalSection(param_1);
  CloseHandle(param_1[1].LockSemaphore);
  CloseHandle((HANDLE)param_1[1].SpinCount);
  if (param_1[2].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    param_1[2].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)param_1[2].OwningThread;
  }
  else {
    **(undefined8 **)&param_1[2].LockCount = (PRTL_CRITICAL_SECTION_DEBUG)param_1[2].OwningThread;
  }
  p_Var1 = param_1[2].DebugInfo;
  while (p_Var1 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    p_Var1 = param_1[2].DebugInfo;
    uVar2._0_2_ = p_Var1->Type;
    uVar2._2_2_ = p_Var1->CreatorBackTraceIndex;
    uVar2._4_4_ = *(undefined4 *)&p_Var1->field_0x4;
    param_1[2].LockCount = (int)uVar2;
    param_1[2].RecursionCount = (int)((ulonglong)uVar2 >> 0x20);
    LocalFree(p_Var1);
    p_Var1 = *(PRTL_CRITICAL_SECTION_DEBUG *)&param_1[2].LockCount;
    param_1[2].DebugInfo = p_Var1;
  }
  pUVar4 = &param_1[0x1c].SpinCount;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    *(undefined1 *)pUVar4 = 0;
    pUVar4 = (ULONG_PTR *)((longlong)pUVar4 + 1);
  }
  if (*(HLOCAL *)&param_1[0x1e].LockCount != (HLOCAL)0x0) {
    FUN_180001bc0(*(HLOCAL *)&param_1[0x1e].LockCount);
  }
  ppvVar5 = &param_1[0x1d].LockSemaphore;
  for (lVar3 = 0x30; lVar3 != 0; lVar3 = lVar3 + -1) {
    *(undefined1 *)ppvVar5 = 0;
    ppvVar5 = (HANDLE *)((longlong)ppvVar5 + 1);
  }
  return;
}



undefined8 FUN_1800064c0(longlong *param_1,longlong param_2,uint param_3)

{
  longlong lVar1;
  int iVar2;
  ulonglong uVar3;
  undefined4 *lpData;
  undefined8 uVar4;
  undefined1 auStackY_a8 [32];
  DWORD aDStack_68 [2];
  undefined1 auStack_60 [24];
  HLOCAL pvStack_48;
  longlong lStack_40;
  undefined8 uStack_38;
  ulonglong uStack_30;
  
  lVar1 = *param_1;
  if (lVar1 != 0) {
    uStack_30 = DAT_18004a880 ^ (ulonglong)auStackY_a8;
    if ((param_2 == 0) && (param_3 == 0)) {
      PTR_FUN_18004a780 = FUN_1800062ec;
      PTR_FUN_18004a788 = FUN_1800062ec;
      RegDeleteKeyValueW((HKEY)0xffffffff80000002,(LPCWSTR)(lVar1 + 0x70),
                         (LPCWSTR)PTR_u_SecurityLogParameter_18004a790);
    }
    else {
      FUN_180020400((undefined1 (*) [16])auStack_60,0,0x30);
      uStack_38 = *(undefined8 *)(lVar1 + 0x4c8);
      lStack_40 = lVar1 + 0x480;
      uVar3 = FUN_180002b10(0,(ulonglong)param_3);
      aDStack_68[0] = (DWORD)uVar3;
      lpData = (undefined4 *)LocalAlloc(0,uVar3 & 0xffffffff);
      if (lpData != (undefined4 *)0x0) {
        uVar4 = FUN_180002b40((undefined8 *)0x0,0,(undefined8 *)param_2,param_3,lpData,aDStack_68,
                              lVar1 + 0x480);
        if (((int)uVar4 != 0) && (iVar2 = FUN_180004570(param_2,param_3), iVar2 == 0)) {
          if (pvStack_48 != (HLOCAL)0x0) {
            FUN_180001bc0(pvStack_48);
          }
          RegSetKeyValueW((HKEY)0xffffffff80000002,(LPCWSTR)(lVar1 + 0x70),
                          (LPCWSTR)PTR_u_SecurityLogParameter_18004a790,3,lpData,aDStack_68[0]);
        }
        LocalFree(lpData);
      }
    }
    uVar4 = FUN_18001fe50(uStack_30 ^ (ulonglong)auStackY_a8);
    return uVar4;
  }
  return 0;
}



void FUN_1800064d0(longlong param_1,undefined8 *param_2,uint param_3)

{
  int iVar1;
  ulonglong uVar2;
  undefined4 *lpData;
  undefined8 uVar3;
  undefined1 auStackY_a8 [32];
  DWORD local_68 [2];
  undefined1 local_60 [24];
  HLOCAL local_48;
  longlong local_40;
  undefined8 local_38;
  ulonglong local_30;
  
  local_30 = DAT_18004a880 ^ (ulonglong)auStackY_a8;
  if ((param_2 == (undefined8 *)0x0) && (param_3 == 0)) {
    PTR_FUN_18004a780 = FUN_1800062ec;
    PTR_FUN_18004a788 = FUN_1800062ec;
    RegDeleteKeyValueW((HKEY)0xffffffff80000002,(LPCWSTR)(param_1 + 0x70),
                       (LPCWSTR)PTR_u_SecurityLogParameter_18004a790);
  }
  else {
    FUN_180020400((undefined1 (*) [16])local_60,0,0x30);
    local_38 = *(undefined8 *)(param_1 + 0x4c8);
    local_40 = param_1 + 0x480;
    uVar2 = FUN_180002b10(0,(ulonglong)param_3);
    local_68[0] = (DWORD)uVar2;
    lpData = (undefined4 *)LocalAlloc(0,uVar2 & 0xffffffff);
    if (lpData != (undefined4 *)0x0) {
      uVar3 = FUN_180002b40((undefined8 *)0x0,0,param_2,param_3,lpData,local_68,param_1 + 0x480);
      if (((int)uVar3 != 0) && (iVar1 = FUN_180004570(param_2,param_3), iVar1 == 0)) {
        if (local_48 != (HLOCAL)0x0) {
          FUN_180001bc0(local_48);
        }
        RegSetKeyValueW((HKEY)0xffffffff80000002,(LPCWSTR)(param_1 + 0x70),
                        (LPCWSTR)PTR_u_SecurityLogParameter_18004a790,3,lpData,local_68[0]);
      }
      LocalFree(lpData);
    }
  }
  FUN_18001fe50(local_30 ^ (ulonglong)auStackY_a8);
  return;
}



bool FUN_180006640(longlong param_1,PUCHAR param_2,ULONG param_3,PUCHAR param_4,ULONG param_5,
                  ULONG *param_6)

{
  int *piVar1;
  bool bVar2;
  uint uVar3;
  
  piVar1 = *(int **)(param_1 + 0x18);
  uVar3 = FUN_180001bb0((longlong)piVar1);
  if (param_3 + 0x42 <= uVar3 >> 3) {
    if ((param_4 != (PUCHAR)0x0) || (param_5 != 0)) {
      bVar2 = FUN_180001bd0(piVar1,*(ULONG *)(param_1 + 0x10),param_2,param_3,param_4,param_5,
                            param_6);
      return bVar2;
    }
    if (param_6 != (ULONG *)0x0) {
      uVar3 = FUN_180001bb0((longlong)piVar1);
      *param_6 = uVar3 >> 3;
      return true;
    }
  }
  return false;
}



void FUN_1800066ec(longlong *param_1)

{
  longlong lVar1;
  LPCRITICAL_SECTION p_Var2;
  
  if (*param_1 != 0) {
    PTR_FUN_18004a780 = FUN_1800062ec;
    PTR_FUN_18004a788 = FUN_1800062ec;
    lVar1 = *param_1;
    if (*(longlong *)(lVar1 + 0x28) != 0) {
      *(undefined4 *)(lVar1 + 0x38) = 1;
      SetEvent(*(HANDLE *)(lVar1 + 0x30));
      WaitForSingleObject(*(HANDLE *)(lVar1 + 0x28),0xffffffff);
      CloseHandle(*(HANDLE *)(lVar1 + 0x28));
      *(undefined8 *)(lVar1 + 0x28) = 0;
    }
    p_Var2 = (LPCRITICAL_SECTION)*param_1;
    if (p_Var2 != (LPCRITICAL_SECTION)0x0) {
      FUN_1800063e0(p_Var2);
      thunk_FUN_18001fcb8(p_Var2);
    }
    *param_1 = 0;
  }
  return;
}



void FUN_18000677c(longlong *param_1,LPCWSTR param_2)

{
  LPCRITICAL_SECTION p_Var1;
  PRTL_CRITICAL_SECTION_DEBUG p_Var2;
  
  if (*param_1 == 0) {
    p_Var1 = (LPCRITICAL_SECTION)FUN_180020780(0x4d0);
    if (p_Var1 == (LPCRITICAL_SECTION)0x0) {
      p_Var1 = (LPCRITICAL_SECTION)0x0;
    }
    else {
      p_Var1 = FUN_1800062f0(p_Var1,param_2);
    }
    *param_1 = (longlong)p_Var1;
    if (p_Var1[1].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      ResetEvent(*(HANDLE *)&p_Var1[1].LockCount);
      *(undefined4 *)&p_Var1[1].OwningThread = 0;
      p_Var2 = (PRTL_CRITICAL_SECTION_DEBUG)
               CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_180006d00,p_Var1,0,(LPDWORD)0x0);
      p_Var1[1].DebugInfo = p_Var2;
      if (p_Var2 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
        p_Var1 = (LPCRITICAL_SECTION)*param_1;
        if (p_Var1 != (LPCRITICAL_SECTION)0x0) {
          FUN_1800063e0(p_Var1);
          thunk_FUN_18001fcb8(p_Var1);
        }
        *param_1 = 0;
      }
    }
  }
  return;
}



bool FUN_18000682c(longlong param_1)

{
  LPWSTR lpBuffer;
  bool bVar1;
  int iVar2;
  LSTATUS LVar3;
  BOOL BVar4;
  uint *puVar5;
  uint *hMem;
  undefined8 uVar6;
  LPWSTR pWVar7;
  DWORD local_res8 [2];
  DWORD local_res10 [2];
  uint local_res18 [2];
  HKEY local_res20;
  
  bVar1 = true;
  local_res20 = (HKEY)0x0;
  iVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,(LPCWSTR)(param_1 + 0x70),0,3,&local_res20);
  if (iVar2 == 5) {
    iVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,(LPCWSTR)(param_1 + 0x70),0,1,&local_res20);
  }
  if (iVar2 != 0) goto LAB_180006b01;
  local_res10[0] = 3;
  local_res8[0] = 0;
  LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogParameter_18004a790,(LPDWORD)0x0,
                           local_res10,(LPBYTE)0x0,local_res8);
  puVar5 = (uint *)0x0;
  if (((LVar3 == 0) || (LVar3 == 0xea)) && (local_res10[0] == 3)) {
    puVar5 = (uint *)LocalAlloc(0,(ulonglong)local_res8[0]);
    LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogParameter_18004a790,(LPDWORD)0x0,
                             local_res10,(LPBYTE)puVar5,local_res8);
    if (LVar3 != 0) goto LAB_180006ab6;
    local_res18[0] = FUN_180002b20((int *)puVar5,(int *)0x0);
    if (local_res18[0] == 0) goto LAB_180006ab6;
    hMem = (uint *)LocalAlloc(0,(ulonglong)local_res18[0]);
    if (hMem == (uint *)0x0) goto LAB_180006ab6;
    uVar6 = FUN_1800031b0((int *)puVar5,(uint *)0x0,(uint *)0x0,hMem,local_res18,param_1 + 0x480);
    if ((int)uVar6 == 0) {
      LocalFree(hMem);
      goto LAB_180006ab6;
    }
    LocalFree(puVar5);
    local_res8[0] = local_res18[0];
    iVar2 = FUN_180004570(hMem,local_res18[0]);
    puVar5 = hMem;
    if (iVar2 != 0) goto LAB_180006ab6;
    local_res8[0] = 4;
    local_res10[0] = 4;
    LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogMask_18004a798,(LPDWORD)0x0,
                             local_res10,(LPBYTE)(param_1 + 0x6c),local_res8);
    if ((LVar3 != 0) || (*(int *)(param_1 + 0x6c) == 0)) goto LAB_180006ab6;
    lpBuffer = (LPWSTR)(param_1 + 0x278);
    local_res8[0] = 0x208;
    local_res10[0] = 1;
    LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogPath_18004a7a0,(LPDWORD)0x0,
                             local_res10,(LPBYTE)lpBuffer,local_res8);
    if (LVar3 == 0) {
      iVar2 = lstrlenW(lpBuffer);
      pWVar7 = (LPWSTR)(param_1 + ((longlong)iVar2 + 0x13c) * 2);
      if ((lpBuffer < pWVar7) && ((pWVar7[-1] == L'\\' || (pWVar7[-1] == L'/')))) {
        pWVar7[-1] = L'\0';
      }
    }
    else {
      GetSystemDirectoryW(lpBuffer,0x104);
      pWVar7 = (LPWSTR)FUN_180020990((ushort *)lpBuffer,0x5c);
      lstrcpyW(pWVar7,L"\\Temp2\\WBF");
    }
    BVar4 = PathFileExistsW(lpBuffer);
    if (BVar4 == 0) goto LAB_180006ab6;
    PTR_FUN_18004a780 = &LAB_18000681c;
    PTR_FUN_18004a788 = FUN_180006b18;
    bVar1 = false;
  }
  else {
LAB_180006ab6:
    RegDeleteValueW(local_res20,(LPCWSTR)PTR_u_SecurityLogParameter_18004a790);
    RegDeleteValueW(local_res20,(LPCWSTR)PTR_u_SecurityLogMask_18004a798);
    RegDeleteValueW(local_res20,(LPCWSTR)PTR_u_SecurityLogPath_18004a7a0);
  }
  if (puVar5 != (uint *)0x0) {
    LocalFree(puVar5);
  }
  RegCloseKey(local_res20);
LAB_180006b01:
  return !bVar1;
}



void FUN_180006b18(undefined8 *param_1,undefined8 param_2,undefined8 *param_3,int param_4,
                  int param_5)

{
  LPCRITICAL_SECTION lpCriticalSection;
  HANDLE pvVar1;
  DWORD DVar2;
  PRTL_CRITICAL_SECTION_DEBUG p_Var3;
  undefined1 auStack_f8 [32];
  uint local_d8;
  uint local_d0;
  uint local_c8;
  uint local_c0;
  uint local_b8;
  uint local_b0;
  uint local_a8;
  int local_98;
  undefined8 local_90;
  undefined8 *local_88;
  undefined8 *local_80;
  HANDLE local_78;
  HANDLE local_70;
  _SYSTEMTIME local_68;
  ulonglong local_58;
  
  local_58 = DAT_18004a880 ^ (ulonglong)auStack_f8;
  lpCriticalSection = (LPCRITICAL_SECTION)*param_1;
  local_98 = param_4;
  local_90 = param_2;
  local_88 = param_3;
  local_80 = param_1;
  GetLocalTime(&local_68);
  while (EnterCriticalSection(lpCriticalSection), lpCriticalSection[2].OwningThread == (HANDLE)0x0)
  {
    if (*(uint *)&lpCriticalSection[2].LockSemaphore < 5) {
      *(int *)&lpCriticalSection[2].LockSemaphore = *(int *)&lpCriticalSection[2].LockSemaphore + 1;
      LeaveCriticalSection(lpCriticalSection);
      p_Var3 = (PRTL_CRITICAL_SECTION_DEBUG)LocalAlloc(0,(longlong)(param_5 * param_4) + 0x218);
      goto LAB_180006c0b;
    }
    LeaveCriticalSection(lpCriticalSection);
    local_78 = *(HANDLE *)&lpCriticalSection[1].LockCount;
    local_70 = lpCriticalSection[1].LockSemaphore;
    DVar2 = WaitForMultipleObjects(2,&local_78,0,0xffffffff);
    if ((DVar2 != 1) || (*(int *)&lpCriticalSection[1].OwningThread != 0)) goto LAB_180006cd8;
  }
  p_Var3 = (PRTL_CRITICAL_SECTION_DEBUG)lpCriticalSection[2].OwningThread;
  pvVar1 = *(HANDLE *)p_Var3;
  lpCriticalSection[2].OwningThread = pvVar1;
  if (pvVar1 == (HANDLE)0x0) {
    ResetEvent((HANDLE)lpCriticalSection[1].SpinCount);
  }
  LeaveCriticalSection(lpCriticalSection);
LAB_180006c0b:
  if (p_Var3 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    local_a8 = (uint)local_68.wMilliseconds;
    local_b0 = (uint)local_68.wSecond;
    local_b8 = (uint)local_68.wMinute;
    local_c0 = (uint)local_68.wHour;
    local_c8 = (uint)local_68.wDay;
    local_d0 = (uint)local_68.wMonth;
    local_d8 = (uint)local_68.wYear;
    wsprintfW((LPWSTR)&p_Var3->CriticalSection,L"%s\\%s_%4d%02d%02d_%02d%02d%02d.%03d.efl");
    *(int *)&p_Var3[0xb].field_0x4 = param_5;
    p_Var3[0xb].Type = (undefined2)local_98;
    p_Var3[0xb].CreatorBackTraceIndex = local_98._2_2_;
    FUN_18001fe80(&p_Var3[0xb].CriticalSection,local_88,(longlong)(param_5 * local_98));
    EnterCriticalSection(lpCriticalSection);
    p_Var3->Type = 0;
    p_Var3->CreatorBackTraceIndex = 0;
    *(undefined4 *)&p_Var3->field_0x4 = 0;
    if (lpCriticalSection[2].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      pvVar1 = lpCriticalSection[1].LockSemaphore;
      *(PRTL_CRITICAL_SECTION_DEBUG *)&lpCriticalSection[2].LockCount = p_Var3;
      lpCriticalSection[2].DebugInfo = p_Var3;
      SetEvent(pvVar1);
    }
    else {
      **(undefined8 **)&lpCriticalSection[2].LockCount = p_Var3;
      *(PRTL_CRITICAL_SECTION_DEBUG *)&lpCriticalSection[2].LockCount = p_Var3;
    }
    LeaveCriticalSection(lpCriticalSection);
  }
LAB_180006cd8:
  FUN_18001fe50(local_58 ^ (ulonglong)auStack_f8);
  return;
}



undefined8 FUN_180006d00(LPCRITICAL_SECTION param_1)

{
  FUN_180006de0(param_1);
  return 0;
}



bool FUN_180006d10(longlong *param_1,undefined8 param_2,uint param_3,uint *param_4)

{
  int iVar1;
  bool bVar2;
  uint local_res8 [2];
  undefined8 local_18 [2];
  
  if (*param_1 == 0) {
    bVar2 = false;
  }
  else {
    local_res8[0] = param_3;
    local_18[0] = param_2;
    iVar1 = FUN_180003e10(local_18,local_res8);
    bVar2 = iVar1 == 0;
    if (bVar2) {
      *param_4 = local_res8[0];
    }
  }
  return bVar2;
}



undefined8 FUN_180006d68(undefined8 param_1,LPCWSTR param_2,LPCVOID param_3,DWORD param_4)

{
  HANDLE hFile;
  DWORD local_res20 [2];
  
  local_res20[0] = param_4;
  hFile = CreateFileW(param_2,0x120116,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,(HANDLE)0x0);
  if (hFile != (HANDLE)0xffffffffffffffff) {
    WriteFile(hFile,param_3,local_res20[0],local_res20,(LPOVERLAPPED)0x0);
    CloseHandle(hFile);
  }
  return 1;
}



void FUN_180006de0(LPCRITICAL_SECTION param_1)

{
  int iVar1;
  longlong lVar2;
  longlong lVar3;
  bool bVar4;
  DWORD DVar5;
  undefined7 extraout_var;
  PRTL_CRITICAL_SECTION_DEBUG p_Var6;
  HANDLE local_38;
  HANDLE local_30;
  code *local_28;
  code *local_20;
  HANDLE *local_18;
  HANDLE *local_10;
  
  bVar4 = FUN_18000682c((longlong)param_1);
  if (((int)CONCAT71(extraout_var,bVar4) != 0) &&
     (lVar2._0_4_ = param_1[0x1e].LockCount, lVar2._4_4_ = param_1[0x1e].RecursionCount, lVar2 != 0)
     ) {
    local_28 = FUN_180006640;
    local_20 = FUN_180006d68;
    local_18 = &param_1[0x1d].LockSemaphore;
    local_38 = *(HANDLE *)&param_1[1].LockCount;
    local_30 = param_1[1].LockSemaphore;
    local_10 = local_18;
    while( true ) {
      DVar5 = WaitForMultipleObjects(2,&local_38,0,0xffffffff);
      if (DVar5 != 1) break;
      EnterCriticalSection(param_1);
      p_Var6 = param_1[2].DebugInfo;
      param_1[2].DebugInfo = *(PRTL_CRITICAL_SECTION_DEBUG *)p_Var6;
      LeaveCriticalSection(param_1);
      do {
        iVar1._0_2_ = p_Var6[0xb].Type;
        iVar1._2_2_ = p_Var6[0xb].CreatorBackTraceIndex;
        FUN_180004c80(&local_28,&p_Var6->CriticalSection,&p_Var6[0xb].CriticalSection,iVar1,
                      *(int *)&p_Var6[0xb].field_0x4);
        EnterCriticalSection(param_1);
        *(HANDLE *)p_Var6 = param_1[2].OwningThread;
        param_1[2].OwningThread = p_Var6;
        lVar3._0_2_ = p_Var6->Type;
        lVar3._2_2_ = p_Var6->CreatorBackTraceIndex;
        lVar3._4_4_ = *(undefined4 *)&p_Var6->field_0x4;
        if (lVar3 == 0) {
          SetEvent((HANDLE)param_1[1].SpinCount);
        }
        p_Var6 = param_1[2].DebugInfo;
        if (p_Var6 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
          ResetEvent(param_1[1].LockSemaphore);
        }
        else {
          param_1[2].DebugInfo = *(PRTL_CRITICAL_SECTION_DEBUG *)p_Var6;
        }
        LeaveCriticalSection(param_1);
      } while ((p_Var6 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) &&
              (*(int *)&param_1[1].OwningThread == 0));
    }
  }
  return;
}



undefined8 * FUN_180006f0c(undefined8 *param_1)

{
  param_1[1] = 0;
  *param_1 = &PTR_FUN_18003d5d8;
  return param_1;
}



void FUN_180006f20(undefined8 *param_1)

{
  SIZE_T SVar1;
  undefined1 *puVar2;
  
  *param_1 = &PTR_FUN_18003d5d8;
  if ((HLOCAL)param_1[1] != (HLOCAL)0x0) {
    SVar1 = LocalSize((HLOCAL)param_1[1]);
    puVar2 = (undefined1 *)param_1[1];
    for (; SVar1 != 0; SVar1 = SVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    LocalFree((HLOCAL)param_1[1]);
  }
  return;
}



undefined8 * FUN_180006f68(undefined8 *param_1,uint param_2)

{
  FUN_180006f20(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



void FUN_180006f98(longlong param_1,ulonglong *param_2,int param_3,undefined8 *param_4,int param_5,
                  undefined4 *param_6)

{
  int *piVar1;
  bool bVar2;
  int iVar3;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  ulonglong uVar4;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  longlong lVar5;
  undefined1 *puVar6;
  UCHAR *pUVar7;
  undefined8 *puVar8;
  undefined1 auStackY_258 [32];
  int *local_218 [2];
  UCHAR local_208 [8];
  undefined8 local_200;
  undefined8 uStack_1f8;
  undefined8 local_1f0;
  undefined8 uStack_1e8;
  undefined8 local_1e0;
  undefined8 uStack_1d8;
  undefined8 local_1d0;
  undefined8 uStack_1c8;
  undefined8 local_1c0 [5];
  undefined1 local_198 [4];
  undefined8 local_194;
  undefined8 uStack_18c;
  undefined8 local_184;
  undefined8 uStack_17c;
  uint local_174 [8];
  undefined8 local_154;
  undefined8 uStack_14c;
  undefined8 local_144;
  undefined8 uStack_13c;
  undefined1 local_114 [64];
  undefined8 local_d4 [5];
  undefined8 local_a8;
  undefined8 uStack_a0;
  undefined8 local_98;
  undefined8 uStack_90;
  UCHAR local_88 [32];
  UCHAR local_68 [16];
  UCHAR local_58 [16];
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStackY_258;
  if ((((param_3 == 0xd0) && (param_5 == 0xd0)) &&
      (piVar1 = *(int **)(param_1 + 8), piVar1 != (int *)0x0)) &&
     (local_218[0] = piVar1,
     iVar3 = FUN_1800072b4(0,(PUCHAR)local_218,8,piVar1 + 1,0x20,(uint *)(piVar1 + 9),local_174,0xc0
                          ), iVar3 != 0)) {
    iVar3 = FUN_1800011f0(&local_154,0x40,local_88);
    if ((((iVar3 != 0) &&
         (bVar2 = FUN_180007b0c(local_88,0x10,param_2,0xd0,&local_154,0x40),
         (int)CONCAT71(extraout_var,bVar2) != 0)) &&
        ((bVar2 = FUN_180001a00(local_208,1), (int)CONCAT71(extraout_var_00,bVar2) != 0 &&
         ((bVar2 = FUN_180001060((PUCHAR)&local_a8,0x20), (int)CONCAT71(extraout_var_01,bVar2) != 0
          && (bVar2 = FUN_180001ec0(local_1c0,0x20,param_2 + 6,0x40,param_2 + 0xe,0x20,local_68,0x20
                                   ), (int)CONCAT71(extraout_var_02,bVar2) != 0)))))) &&
       (bVar2 = FUN_180001060((PUCHAR)(param_4 + 2),0x20), (int)CONCAT71(extraout_var_03,bVar2) != 0
       )) {
      param_4[6] = local_200;
      param_4[7] = uStack_1f8;
      param_4[8] = local_1f0;
      param_4[9] = uStack_1e8;
      param_4[10] = local_1e0;
      param_4[0xb] = uStack_1d8;
      param_4[0xc] = local_1d0;
      param_4[0xd] = uStack_1c8;
      bVar2 = FUN_180002310(local_68,local_58,(uint *)&local_a8,(uint *)(param_4 + 0xe),0x20);
      if ((((int)CONCAT71(extraout_var_04,bVar2) != 0) &&
          (iVar3 = FUN_1800011f0(local_114,0x40,local_88), iVar3 != 0)) &&
         (uVar4 = FUN_1800074fc(local_88,0x10,param_4,0xd0,local_d4,0x40), (int)uVar4 != 0)) {
        *param_6 = 0xd0;
        bVar2 = FUN_180001060((PUCHAR)local_174,0x20);
        if ((int)CONCAT71(extraout_var_05,bVar2) != 0) {
          local_154 = local_a8;
          uStack_14c = uStack_a0;
          local_144 = local_98;
          uStack_13c = uStack_90;
          bVar2 = FUN_180001060((PUCHAR)&local_194,0x20);
          if (((int)CONCAT71(extraout_var_06,bVar2) != 0) &&
             (iVar3 = FUN_1800072b4(0,(PUCHAR)local_218,8,&local_194,0x20,local_174,
                                    (uint *)(local_218[0] + 9),0x40), iVar3 != 0)) {
            *(undefined8 *)(local_218[0] + 1) = local_194;
            *(undefined8 *)(local_218[0] + 3) = uStack_18c;
            *(undefined8 *)(local_218[0] + 5) = local_184;
            *(undefined8 *)(local_218[0] + 7) = uStack_17c;
            *local_218[0] = 1;
          }
        }
      }
    }
    puVar6 = local_198;
    for (lVar5 = 0xe4; lVar5 != 0; lVar5 = lVar5 + -1) {
      *puVar6 = 0;
      puVar6 = puVar6 + 1;
    }
    pUVar7 = local_208;
    for (lVar5 = 0x68; lVar5 != 0; lVar5 = lVar5 + -1) {
      *pUVar7 = '\0';
      pUVar7 = pUVar7 + 1;
    }
    pUVar7 = local_88;
    for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
      *pUVar7 = '\0';
      pUVar7 = pUVar7 + 1;
    }
    pUVar7 = local_68;
    for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
      *pUVar7 = '\0';
      pUVar7 = pUVar7 + 1;
    }
    puVar8 = &local_a8;
    for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
      *(undefined1 *)puVar8 = 0;
      puVar8 = (undefined8 *)((longlong)puVar8 + 1);
    }
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStackY_258);
  return;
}



void FUN_1800072b4(int param_1,PUCHAR param_2,ULONG param_3,undefined8 param_4,ULONG param_5,
                  uint *param_6,uint *param_7,uint param_8)

{
  bool bVar1;
  undefined7 extraout_var;
  longlong lVar2;
  UCHAR *pUVar3;
  undefined1 auStackY_88 [32];
  UCHAR local_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStackY_88;
  bVar1 = FUN_180001330(param_2,param_3,param_4,param_5,local_58);
  if ((int)CONCAT71(extraout_var,bVar1) != 0) {
    if (param_1 == 0) {
      thunk_FUN_180002310(local_58,local_48,param_6,param_7,param_8);
    }
    else {
      FUN_180002310(local_58,local_48,param_6,param_7,param_8);
    }
    pUVar3 = local_58;
    for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
      *pUVar3 = '\0';
      pUVar3 = pUVar3 + 1;
    }
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStackY_88);
  return;
}



void FUN_180007364(longlong param_1,uint *param_2,uint *param_3,uint param_4)

{
  int iVar1;
  longlong lVar2;
  uint *puVar3;
  undefined1 auStackY_b8 [32];
  int *local_78 [2];
  uint local_68 [8];
  UCHAR aUStack_48 [16];
  UCHAR local_38 [16];
  ulonglong local_28;
  
  local_28 = DAT_18004a880 ^ (ulonglong)auStackY_b8;
  local_78[0] = *(int **)(param_1 + 8);
  if (((local_78[0] != (int *)0x0) && (*local_78[0] != 0)) &&
     (iVar1 = FUN_1800072b4(0,(PUCHAR)local_78,8,local_78[0] + 1,0x20,(uint *)(local_78[0] + 9),
                            local_68,0x40), iVar1 != 0)) {
    local_78[0] = (int *)&stack0xffffffffffffff74;
    thunk_FUN_180002310(aUStack_48,local_38,param_2,param_3,param_4);
    puVar3 = local_68;
    for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
      *(undefined1 *)puVar3 = 0;
      puVar3 = (uint *)((longlong)puVar3 + 1);
    }
  }
  FUN_18001fe50(local_28 ^ (ulonglong)auStackY_b8);
  return;
}



void FUN_180007430(longlong param_1,uint *param_2,uint *param_3,uint param_4)

{
  int iVar1;
  longlong lVar2;
  uint *puVar3;
  undefined1 auStackY_b8 [32];
  int *local_78 [2];
  uint local_68 [8];
  UCHAR aUStack_48 [16];
  UCHAR local_38 [16];
  ulonglong local_28;
  
  local_28 = DAT_18004a880 ^ (ulonglong)auStackY_b8;
  local_78[0] = *(int **)(param_1 + 8);
  if (((local_78[0] != (int *)0x0) && (*local_78[0] != 0)) &&
     (iVar1 = FUN_1800072b4(0,(PUCHAR)local_78,8,local_78[0] + 1,0x20,(uint *)(local_78[0] + 9),
                            local_68,0x40), iVar1 != 0)) {
    local_78[0] = (int *)&stack0xffffffffffffff74;
    FUN_180002310(aUStack_48,local_38,param_2,param_3,param_4);
    puVar3 = local_68;
    for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
      *(undefined1 *)puVar3 = 0;
      puVar3 = (uint *)((longlong)puVar3 + 1);
    }
  }
  FUN_18001fe50(local_28 ^ (ulonglong)auStackY_b8);
  return;
}



ulonglong FUN_1800074fc(PUCHAR param_1,uint param_2,undefined8 *param_3,uint param_4,
                       undefined8 *param_5,uint param_6)

{
  bool bVar1;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  ulonglong uVar2;
  
  FUN_18001fe80(param_3,(undefined8 *)param_1,(ulonglong)param_2);
  bVar1 = FUN_180002310(param_1 + 0x10,param_1,(uint *)((ulonglong)param_2 + (longlong)param_3),
                        (uint *)((ulonglong)param_2 + (longlong)param_3),
                        (param_4 - param_2) - param_6);
  uVar2 = CONCAT71(extraout_var,bVar1);
  if ((int)uVar2 != 0) {
    bVar1 = FUN_1800017d0(param_5,param_3,param_4 - param_6,
                          (PUCHAR)(((ulonglong)param_4 - (ulonglong)param_6) + (longlong)param_3));
    uVar2 = (ulonglong)((int)CONCAT71(extraout_var_00,bVar1) != 0);
  }
  return uVar2;
}



void FUN_180007594(longlong param_1,undefined8 param_2,undefined *param_3)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  ulonglong uVar3;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  longlong lVar4;
  undefined1 *puVar5;
  ulonglong *puVar6;
  UCHAR *pUVar7;
  undefined8 *puVar8;
  undefined1 auStackY_3f8 [32];
  int *local_3b8;
  int local_3b0;
  UCHAR local_3a8 [8];
  undefined8 local_3a0;
  undefined8 uStack_398;
  undefined8 local_390;
  undefined8 uStack_388;
  undefined8 local_380;
  undefined8 uStack_378;
  undefined8 local_370;
  undefined8 uStack_368;
  undefined8 local_360 [5];
  undefined1 local_338 [4];
  undefined8 local_334;
  undefined8 uStack_32c;
  undefined8 local_324;
  undefined8 uStack_31c;
  uint local_314 [8];
  uint local_2f4 [16];
  undefined1 local_2b4 [64];
  undefined8 local_274 [5];
  undefined8 local_248 [2];
  UCHAR local_238 [32];
  undefined8 local_218;
  undefined8 uStack_210;
  undefined8 local_208;
  undefined8 uStack_200;
  undefined8 local_1f8;
  undefined8 uStack_1f0;
  undefined8 local_1e8;
  undefined8 uStack_1e0;
  undefined8 local_1d8;
  undefined8 uStack_1d0;
  undefined8 local_1c8;
  undefined8 uStack_1c0;
  ulonglong local_178 [6];
  undefined8 local_148 [8];
  uint local_108 [24];
  undefined8 local_a8;
  undefined8 uStack_a0;
  undefined8 local_98;
  undefined8 uStack_90;
  UCHAR local_88 [32];
  UCHAR local_68 [16];
  UCHAR local_58 [16];
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStackY_3f8;
  local_3b8 = *(int **)(param_1 + 8);
  if (((param_3 != (undefined *)0x0) && (local_3b8 != (int *)0x0)) &&
     (iVar2 = FUN_1800072b4(0,(PUCHAR)&local_3b8,8,local_3b8 + 1,0x20,(uint *)(local_3b8 + 9),
                            local_314,0xc0), iVar2 != 0)) {
    bVar1 = FUN_180001a00(local_3a8,1);
    if (((int)CONCAT71(extraout_var,bVar1) != 0) &&
       (bVar1 = FUN_180001060(local_238,0x20), (int)CONCAT71(extraout_var_00,bVar1) != 0)) {
      local_218 = local_3a0;
      uStack_210 = uStack_398;
      local_208 = local_390;
      uStack_200 = uStack_388;
      local_1f8 = local_380;
      uStack_1f0 = uStack_378;
      local_1e8 = local_370;
      uStack_1e0 = uStack_368;
      bVar1 = FUN_180001060((PUCHAR)&local_a8,0x20);
      if ((int)CONCAT71(extraout_var_01,bVar1) != 0) {
        local_1d8 = local_a8;
        uStack_1d0 = uStack_a0;
        local_1c8 = local_98;
        uStack_1c0 = uStack_90;
        iVar2 = FUN_1800011f0(local_2b4,0x40,local_88);
        if ((iVar2 != 0) &&
           (uVar3 = FUN_1800074fc(local_88,0x10,local_248,0xd0,local_274,0x40), (int)uVar3 != 0)) {
          local_3b0 = 0;
          iVar2 = (*(code *)param_3)(param_2,local_248,0xd0,local_178);
          if ((((iVar2 != 0) &&
               ((((local_3b0 == 0xd0 && (iVar2 = FUN_1800011f0(local_2f4,0x40,local_88), iVar2 != 0)
                  ) && (bVar1 = FUN_180007b0c(local_88,0x10,local_178,0xd0,(undefined8 *)local_2f4,
                                              0x40), (int)CONCAT71(extraout_var_02,bVar1) != 0)) &&
                ((bVar1 = FUN_180001ec0(local_360,0x20,local_148,0x40,&local_a8,0x20,local_68,0x20),
                 (int)CONCAT71(extraout_var_03,bVar1) != 0 &&
                 (bVar1 = thunk_FUN_180002310(local_68,local_58,local_108,local_2f4,0x20),
                 (int)CONCAT71(extraout_var_04,bVar1) != 0)))))) &&
              (bVar1 = FUN_180001060((PUCHAR)local_314,0x20),
              (int)CONCAT71(extraout_var_05,bVar1) != 0)) &&
             ((bVar1 = FUN_180001060((PUCHAR)&local_334,0x20),
              (int)CONCAT71(extraout_var_06,bVar1) != 0 &&
              (iVar2 = FUN_1800072b4(1,(PUCHAR)&local_3b8,8,&local_334,0x20,local_314,
                                     (uint *)(local_3b8 + 9),0x40), iVar2 != 0)))) {
            *(undefined8 *)(local_3b8 + 1) = local_334;
            *(undefined8 *)(local_3b8 + 3) = uStack_32c;
            *(undefined8 *)(local_3b8 + 5) = local_324;
            *(undefined8 *)(local_3b8 + 7) = uStack_31c;
            *local_3b8 = 1;
          }
        }
      }
    }
    puVar5 = local_338;
    for (lVar4 = 0xe4; lVar4 != 0; lVar4 = lVar4 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
    pUVar7 = local_3a8;
    for (lVar4 = 0x68; lVar4 != 0; lVar4 = lVar4 + -1) {
      *pUVar7 = '\0';
      pUVar7 = pUVar7 + 1;
    }
    puVar8 = local_248;
    for (lVar4 = 0xd0; lVar4 != 0; lVar4 = lVar4 + -1) {
      *(undefined1 *)puVar8 = 0;
      puVar8 = (undefined8 *)((longlong)puVar8 + 1);
    }
    puVar6 = local_178;
    for (lVar4 = 0xd0; lVar4 != 0; lVar4 = lVar4 + -1) {
      *(undefined1 *)puVar6 = 0;
      puVar6 = (ulonglong *)((longlong)puVar6 + 1);
    }
    pUVar7 = local_88;
    for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
      *pUVar7 = '\0';
      pUVar7 = pUVar7 + 1;
    }
    pUVar7 = local_68;
    for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
      *pUVar7 = '\0';
      pUVar7 = pUVar7 + 1;
    }
    puVar8 = &local_a8;
    for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
      *(undefined1 *)puVar8 = 0;
      puVar8 = (undefined8 *)((longlong)puVar8 + 1);
    }
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStackY_3f8);
  return;
}



void FUN_18000790c(longlong param_1,undefined8 *param_2,int param_3,undefined8 *param_4,int param_5)

{
  undefined8 uVar1;
  bool bVar2;
  int iVar3;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  SIZE_T SVar4;
  longlong lVar5;
  longlong lVar6;
  UCHAR *pUVar7;
  undefined1 *puVar8;
  undefined1 auStackY_108 [32];
  undefined1 *local_c8 [2];
  UCHAR local_b8 [16];
  undefined8 uStack_a8;
  undefined8 local_a0;
  undefined8 uStack_98;
  undefined8 local_90;
  undefined8 uStack_88;
  undefined8 local_80;
  undefined8 uStack_78;
  undefined8 local_70;
  undefined8 uStack_68;
  undefined8 local_60;
  undefined8 uStack_58;
  undefined1 local_48 [32];
  ulonglong local_28;
  
  local_28 = DAT_18004a880 ^ (ulonglong)auStackY_108;
  if (((param_3 == 0x40) && (lVar6 = 0x20, param_5 == 0x20)) &&
     (local_c8[0] = (undefined1 *)LocalAlloc(0,0xe4), local_c8[0] != (undefined1 *)0x0)) {
    bVar2 = FUN_180001060(local_c8[0] + 4,0x20);
    if (((int)CONCAT71(extraout_var,bVar2) != 0) &&
       (bVar2 = FUN_180001060(local_c8[0] + 0x24,0x20), (int)CONCAT71(extraout_var_00,bVar2) != 0))
    {
      FUN_180020400((undefined1 (*) [16])local_b8,0,0x68);
      builtin_memcpy(local_b8,"ECS2",4);
      local_70 = *param_4;
      uStack_68 = param_4[1];
      local_60 = param_4[2];
      uStack_58 = param_4[3];
      local_b8[4] = ' ';
      local_b8[5] = '\0';
      local_b8[6] = '\0';
      local_b8[7] = '\0';
      bVar2 = FUN_180001920(local_b8);
      if ((int)CONCAT71(extraout_var_01,bVar2) != 0) {
        uVar1 = param_2[1];
        *(undefined8 *)(local_c8[0] + 0x44) = *param_2;
        *(undefined8 *)(local_c8[0] + 0x4c) = uVar1;
        uVar1 = param_2[3];
        *(undefined8 *)(local_c8[0] + 0x54) = param_2[2];
        *(undefined8 *)(local_c8[0] + 0x5c) = uVar1;
        uVar1 = param_2[5];
        *(undefined8 *)(local_c8[0] + 100) = param_2[4];
        *(undefined8 *)(local_c8[0] + 0x6c) = uVar1;
        uVar1 = param_2[7];
        *(undefined8 *)(local_c8[0] + 0x74) = param_2[6];
        *(undefined8 *)(local_c8[0] + 0x7c) = uVar1;
        *(undefined8 *)(local_c8[0] + 0x84) = local_b8._8_8_;
        *(undefined8 *)(local_c8[0] + 0x8c) = uStack_a8;
        *(undefined8 *)(local_c8[0] + 0x94) = local_a0;
        *(undefined8 *)(local_c8[0] + 0x9c) = uStack_98;
        *(undefined8 *)(local_c8[0] + 0xa4) = local_90;
        *(undefined8 *)(local_c8[0] + 0xac) = uStack_88;
        *(undefined8 *)(local_c8[0] + 0xb4) = local_80;
        *(undefined8 *)(local_c8[0] + 0xbc) = uStack_78;
        *(undefined8 *)(local_c8[0] + 0xc4) = local_70;
        *(undefined8 *)(local_c8[0] + 0xcc) = uStack_68;
        *(undefined8 *)(local_c8[0] + 0xd4) = local_60;
        *(undefined8 *)(local_c8[0] + 0xdc) = uStack_58;
        iVar3 = FUN_1800072b4(1,(PUCHAR)local_c8,8,local_c8[0] + 4,0x20,(uint *)(local_c8[0] + 0x24)
                              ,(uint *)(local_c8[0] + 0x24),0xc0);
        if (iVar3 != 0) {
          if (*(HLOCAL *)(param_1 + 8) != (HLOCAL)0x0) {
            SVar4 = LocalSize(*(HLOCAL *)(param_1 + 8));
            puVar8 = *(undefined1 **)(param_1 + 8);
            for (; SVar4 != 0; SVar4 = SVar4 - 1) {
              *puVar8 = 0;
              puVar8 = puVar8 + 1;
            }
            LocalFree(*(HLOCAL *)(param_1 + 8));
          }
          *(undefined1 **)(param_1 + 8) = local_c8[0];
          local_c8[0] = (undefined1 *)0x0;
        }
      }
    }
    pUVar7 = local_b8;
    for (lVar5 = 0x68; lVar5 != 0; lVar5 = lVar5 + -1) {
      *pUVar7 = '\0';
      pUVar7 = pUVar7 + 1;
    }
    puVar8 = local_48;
    for (; lVar6 != 0; lVar6 = lVar6 + -1) {
      *puVar8 = 0;
      puVar8 = puVar8 + 1;
    }
    if (local_c8[0] != (undefined1 *)0x0) {
      puVar8 = local_c8[0];
      for (lVar6 = 0xe4; lVar6 != 0; lVar6 = lVar6 + -1) {
        *puVar8 = 0;
        puVar8 = puVar8 + 1;
      }
      LocalFree(local_c8[0]);
    }
  }
  FUN_18001fe50(local_28 ^ (ulonglong)auStackY_108);
  return;
}



bool FUN_180007b0c(PUCHAR param_1,uint param_2,ulonglong *param_3,uint param_4,undefined8 *param_5,
                  uint param_6)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  int local_res10 [2];
  
  iVar2 = FUN_180020a30(param_3,(longlong)param_1,(ulonglong)param_2);
  if (iVar2 == 0) {
    local_res10[0] = 0;
    bVar1 = FUN_180001860(param_5,param_3,(ulonglong)(param_4 - param_6),
                          (PUCHAR)(((ulonglong)param_4 - (ulonglong)param_6) + (longlong)param_3),
                          local_res10);
    if (((int)CONCAT71(extraout_var,bVar1) != 0) && (local_res10[0] != 0)) {
      bVar1 = thunk_FUN_180002310(param_1 + 0x10,param_1,
                                  (uint *)((ulonglong)param_2 + (longlong)param_3),
                                  (uint *)((ulonglong)param_2 + (longlong)param_3),
                                  (param_4 - param_2) - param_6);
      return (int)CONCAT71(extraout_var_00,bVar1) != 0;
    }
  }
  return false;
}



ulonglong FUN_180007bc0(void)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  int iVar7;
  uint uVar8;
  ulonglong uVar9;
  LPVOID pvVar10;
  longlong *plVar11;
  longlong lVar12;
  undefined1 (*pauVar13) [16];
  longlong *plVar14;
  undefined8 *puVar15;
  undefined8 *puVar16;
  
  uVar9 = FUN_180009a40();
  if ((int)uVar9 == 0) {
    pvVar10 = TlsGetValue(DAT_18004c108);
    iVar7 = FUN_180007e0c(*(undefined8 **)((longlong)pvVar10 + 0x28));
    if (iVar7 == 0x1d) {
      uVar9 = 0xf;
    }
    else {
      plVar11 = (longlong *)TlsGetValue(DAT_18004c108);
      pvVar10 = TlsGetValue(DAT_18004c108);
      lVar12 = 0x29;
      puVar5 = (undefined8 *)(*plVar11 + 0xe);
      puVar6 = *(undefined8 **)((longlong)pvVar10 + 0x28);
      do {
        puVar16 = puVar6;
        puVar15 = puVar5;
        uVar4 = puVar16[1];
        *puVar15 = *puVar16;
        puVar15[1] = uVar4;
        uVar4 = puVar16[3];
        puVar15[2] = puVar16[2];
        puVar15[3] = uVar4;
        uVar4 = puVar16[5];
        puVar15[4] = puVar16[4];
        puVar15[5] = uVar4;
        uVar4 = puVar16[7];
        puVar15[6] = puVar16[6];
        puVar15[7] = uVar4;
        uVar4 = puVar16[9];
        puVar15[8] = puVar16[8];
        puVar15[9] = uVar4;
        uVar4 = puVar16[0xb];
        puVar15[10] = puVar16[10];
        puVar15[0xb] = uVar4;
        uVar4 = puVar16[0xd];
        puVar15[0xc] = puVar16[0xc];
        puVar15[0xd] = uVar4;
        uVar4 = puVar16[0xf];
        puVar15[0xe] = puVar16[0xe];
        puVar15[0xf] = uVar4;
        lVar12 = lVar12 + -1;
        puVar5 = puVar15 + 0x10;
        puVar6 = puVar16 + 0x10;
      } while (lVar12 != 0);
      uVar4 = puVar16[0x11];
      puVar15[0x10] = puVar16[0x10];
      puVar15[0x11] = uVar4;
      uVar4 = puVar16[0x13];
      puVar15[0x12] = puVar16[0x12];
      puVar15[0x13] = uVar4;
      uVar4 = puVar16[0x15];
      puVar15[0x14] = puVar16[0x14];
      puVar15[0x15] = uVar4;
      uVar4 = puVar16[0x17];
      puVar15[0x16] = puVar16[0x16];
      puVar15[0x17] = uVar4;
      uVar1 = *(undefined4 *)((longlong)puVar16 + 0xc4);
      uVar2 = *(undefined4 *)(puVar16 + 0x19);
      uVar3 = *(undefined4 *)((longlong)puVar16 + 0xcc);
      *(undefined4 *)(puVar15 + 0x18) = *(undefined4 *)(puVar16 + 0x18);
      *(undefined4 *)((longlong)puVar15 + 0xc4) = uVar1;
      *(undefined4 *)(puVar15 + 0x19) = uVar2;
      *(undefined4 *)((longlong)puVar15 + 0xcc) = uVar3;
      uVar1 = *(undefined4 *)((longlong)puVar16 + 0xd4);
      uVar2 = *(undefined4 *)(puVar16 + 0x1b);
      uVar3 = *(undefined4 *)((longlong)puVar16 + 0xdc);
      *(undefined4 *)(puVar15 + 0x1a) = *(undefined4 *)(puVar16 + 0x1a);
      *(undefined4 *)((longlong)puVar15 + 0xd4) = uVar1;
      *(undefined4 *)(puVar15 + 0x1b) = uVar2;
      *(undefined4 *)((longlong)puVar15 + 0xdc) = uVar3;
      puVar15[0x1c] = puVar16[0x1c];
      *(undefined4 *)(puVar15 + 0x1d) = *(undefined4 *)(puVar16 + 0x1d);
      plVar11 = (longlong *)TlsGetValue(DAT_18004c108);
      FUN_180009748((undefined1 *)(*plVar11 + 0x14fa),0);
      pauVar13 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_calibration.c",0x2f);
      if (pauVar13 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_calibration.c",0x2f);
      }
      TlsGetValue(DAT_18004c108);
      FUN_180016018();
      uVar9 = FUN_1800092d4();
      if ((int)uVar9 == 0) {
        FUN_18000a1a0();
        plVar11 = (longlong *)TlsGetValue(DAT_18004c108);
        plVar14 = (longlong *)TlsGetValue(DAT_18004c108);
        uVar8 = FUN_180008bf4(*plVar14,(int *)(*plVar11 + 0x29e8));
        uVar9 = (ulonglong)uVar8;
        pauVar13 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_calibration.c",0x2f);
        if (pauVar13 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_calibration.c",0x2f);
        }
        TlsGetValue(DAT_18004c108);
        FUN_180016018();
      }
    }
  }
  return uVar9;
}



int FUN_180007e0c(undefined8 *param_1)

{
  undefined8 uVar1;
  byte *pbVar2;
  int iVar3;
  int iVar4;
  byte *pbVar5;
  longlong lVar6;
  undefined1 (*pauVar7) [16];
  byte *pbVar8;
  undefined8 *puVar9;
  
  pbVar5 = (byte *)FUN_18001fcf8(0x14ec);
  iVar3 = FUN_1800096d8(pbVar5,0x67,0x34);
  if (param_1 != (undefined8 *)0x0) {
    lVar6 = 0x29;
    pbVar2 = pbVar5;
    do {
      puVar9 = param_1;
      pbVar8 = pbVar2;
      uVar1 = *(undefined8 *)(pbVar8 + 8);
      *puVar9 = *(undefined8 *)pbVar8;
      puVar9[1] = uVar1;
      uVar1 = *(undefined8 *)(pbVar8 + 0x18);
      puVar9[2] = *(undefined8 *)(pbVar8 + 0x10);
      puVar9[3] = uVar1;
      uVar1 = *(undefined8 *)(pbVar8 + 0x28);
      puVar9[4] = *(undefined8 *)(pbVar8 + 0x20);
      puVar9[5] = uVar1;
      uVar1 = *(undefined8 *)(pbVar8 + 0x38);
      puVar9[6] = *(undefined8 *)(pbVar8 + 0x30);
      puVar9[7] = uVar1;
      uVar1 = *(undefined8 *)(pbVar8 + 0x48);
      puVar9[8] = *(undefined8 *)(pbVar8 + 0x40);
      puVar9[9] = uVar1;
      uVar1 = *(undefined8 *)(pbVar8 + 0x58);
      puVar9[10] = *(undefined8 *)(pbVar8 + 0x50);
      puVar9[0xb] = uVar1;
      uVar1 = *(undefined8 *)(pbVar8 + 0x68);
      puVar9[0xc] = *(undefined8 *)(pbVar8 + 0x60);
      puVar9[0xd] = uVar1;
      uVar1 = *(undefined8 *)(pbVar8 + 0x78);
      puVar9[0xe] = *(undefined8 *)(pbVar8 + 0x70);
      puVar9[0xf] = uVar1;
      lVar6 = lVar6 + -1;
      pbVar2 = pbVar8 + 0x80;
      param_1 = puVar9 + 0x10;
    } while (lVar6 != 0);
    uVar1 = *(undefined8 *)(pbVar8 + 0x88);
    puVar9[0x10] = *(undefined8 *)(pbVar8 + 0x80);
    puVar9[0x11] = uVar1;
    uVar1 = *(undefined8 *)(pbVar8 + 0x98);
    puVar9[0x12] = *(undefined8 *)(pbVar8 + 0x90);
    puVar9[0x13] = uVar1;
    uVar1 = *(undefined8 *)(pbVar8 + 0xa8);
    puVar9[0x14] = *(undefined8 *)(pbVar8 + 0xa0);
    puVar9[0x15] = uVar1;
    uVar1 = *(undefined8 *)(pbVar8 + 0xb8);
    puVar9[0x16] = *(undefined8 *)(pbVar8 + 0xb0);
    puVar9[0x17] = uVar1;
    uVar1 = *(undefined8 *)(pbVar8 + 200);
    puVar9[0x18] = *(undefined8 *)(pbVar8 + 0xc0);
    puVar9[0x19] = uVar1;
    uVar1 = *(undefined8 *)(pbVar8 + 0xd8);
    puVar9[0x1a] = *(undefined8 *)(pbVar8 + 0xd0);
    puVar9[0x1b] = uVar1;
    puVar9[0x1c] = *(undefined8 *)(pbVar8 + 0xe0);
    *(undefined4 *)(puVar9 + 0x1d) = *(undefined4 *)(pbVar8 + 0xe8);
  }
  if (iVar3 == 0) {
    iVar4 = FUN_18000b670((undefined8 *)pbVar5,(int *)0x0,0);
    pauVar7 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_calibration.c",0x2f);
    if (pauVar7 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_calibration.c",0x2f);
    }
    FUN_180016018();
    if (0xb9 < iVar4) {
      pauVar7 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_calibration.c",0x2f);
      if (pauVar7 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_calibration.c",0x2f);
      }
      FUN_180005660(pbVar5,0x67,0x34,0x67,0);
      FUN_180016018();
      iVar3 = 0x1d;
    }
  }
  FUN_18001fcb8(pbVar5);
  return iVar3;
}



void FUN_180008010(byte *param_1,uint param_2,ulonglong param_3,int param_4)

{
  byte *pbVar1;
  longlong lVar2;
  ulonglong uVar3;
  int iVar4;
  longlong lVar5;
  int iVar6;
  int iVar7;
  byte abStackX_8 [9];
  byte abStackX_11 [23];
  undefined8 uStack_40;
  
  uStack_40 = 0x18000802d;
  lVar2 = FUN_180020c30();
  lVar2 = -lVar2;
  uVar3 = DAT_18004a880 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar2);
  *(undefined4 *)(&stack0xfffffffffffffff8 + lVar2) = 0;
  *(undefined4 *)(&stack0xfffffffffffffffc + lVar2) = 0;
  pbVar1 = abStackX_11 + lVar2 + -0x11;
  pbVar1[0] = 0;
  pbVar1[1] = 0;
  pbVar1[2] = 0;
  pbVar1[3] = 0;
  pbVar1 = abStackX_11 + lVar2 + -0xd;
  pbVar1[0] = 0;
  pbVar1[1] = 0;
  pbVar1[2] = 0;
  pbVar1[3] = 0;
  iVar6 = (int)param_3;
  *(undefined8 *)((longlong)&uStack_40 + lVar2) = 0x180008077;
  FUN_18001fe80((undefined8 *)(abStackX_8 + lVar2),(undefined8 *)param_1,
                (longlong)(int)(iVar6 * param_2));
  *(undefined4 *)(&stack0xffffffffffffffe8 + lVar2) = 0x50;
  *(undefined8 *)((longlong)&uStack_40 + lVar2) = 0x180008095;
  FUN_180005e70((longlong)(abStackX_8 + lVar2),param_2,iVar6,0xa0,
                *(uint *)(&stack0xffffffffffffffe8 + lVar2));
  *(undefined4 *)(&stack0xffffffffffffffe8 + lVar2) = 3;
  *(undefined8 *)((longlong)&uStack_40 + lVar2) = 0x1800080af;
  thunk_FUN_1800138e0(abStackX_8 + lVar2,0xa0,0x50,(undefined4 *)0x0,
                      *(int *)(&stack0xffffffffffffffe8 + lVar2));
  *(byte **)(&stack0xfffffffffffffff0 + lVar2) = abStackX_11 + lVar2 + -0x11;
  *(undefined1 **)(&stack0xffffffffffffffe8 + lVar2) = &stack0xfffffffffffffff8 + lVar2;
  *(undefined8 *)((longlong)&uStack_40 + lVar2) = 0x1800080d6;
  FUN_18000a43c((longlong)param_1,param_2,param_3 & 0xffffffff,(uint)abStackX_8[lVar2],
                *(longlong *)(&stack0xffffffffffffffe8 + lVar2),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar2));
  *(byte **)(&stack0xfffffffffffffff0 + lVar2) = abStackX_11 + lVar2 + -0x11;
  *(undefined1 **)(&stack0xffffffffffffffe8 + lVar2) = &stack0xfffffffffffffff8 + lVar2;
  *(undefined8 *)((longlong)&uStack_40 + lVar2) = 0x180008101;
  FUN_18000a43c((longlong)(param_1 + (longlong)(int)param_2 + -8),param_2,param_3 & 0xffffffff,
                (uint)abStackX_11[lVar2],*(longlong *)(&stack0xffffffffffffffe8 + lVar2),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar2));
  lVar5 = (longlong)(int)((iVar6 + -8) * param_2);
  *(byte **)(&stack0xfffffffffffffff0 + lVar2) = abStackX_11 + lVar2 + -0x11;
  *(undefined1 **)(&stack0xffffffffffffffe8 + lVar2) = &stack0xfffffffffffffff8 + lVar2;
  *(undefined8 *)((longlong)&uStack_40 + lVar2) = 0x180008133;
  FUN_18000a43c((longlong)(param_1 + lVar5),param_2,param_3 & 0xffffffff,
                (uint)(byte)(&stack0x00000030)[lVar2],
                *(longlong *)(&stack0xffffffffffffffe8 + lVar2),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar2));
  *(byte **)(&stack0xfffffffffffffff0 + lVar2) = abStackX_11 + lVar2 + -0x11;
  *(undefined1 **)(&stack0xffffffffffffffe8 + lVar2) = &stack0xfffffffffffffff8 + lVar2;
  *(undefined8 *)((longlong)&uStack_40 + lVar2) = 0x180008162;
  FUN_18000a43c((longlong)(param_1 + lVar5 + (int)param_2 + -8),param_2,param_3 & 0xffffffff,
                (uint)(byte)(&stack0x00000039)[lVar2],
                *(longlong *)(&stack0xffffffffffffffe8 + lVar2),
                *(longlong *)(&stack0xfffffffffffffff0 + lVar2));
  if (0 < *(int *)(abStackX_11 + lVar2 + -0x11)) {
    iVar4 = *(int *)(&stack0xfffffffffffffff8 + lVar2) / *(int *)(abStackX_11 + lVar2 + -0x11);
    if (*(int *)(abStackX_11 + lVar2 + -0xd) < 1) {
      iVar7 = 0;
    }
    else {
      iVar7 = *(int *)(&stack0xfffffffffffffffc + lVar2) / *(int *)(abStackX_11 + lVar2 + -0xd);
    }
    if (param_4 == 0) {
      iVar4 = 0xff - iVar4;
      if (0xff - iVar7 < iVar4) goto LAB_1800081cd;
    }
    else {
      if ((iVar7 < iVar4) && (0 < iVar7)) goto LAB_1800081cd;
      iVar4 = -iVar4;
    }
    *(undefined8 *)((longlong)&uStack_40 + lVar2) = 0x1800081c7;
    FUN_18000610c(param_1,param_2,iVar6,iVar4);
  }
LAB_1800081cd:
  *(undefined8 *)((longlong)&uStack_40 + lVar2) = 0x1800081dc;
  FUN_18001fe50(uVar3 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar2));
  return;
}



byte FUN_1800081f0(byte param_1,byte *param_2,byte param_3)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  undefined8 uVar4;
  byte unaff_BL;
  byte bVar5;
  byte bVar6;
  int iVar7;
  byte bVar8;
  int iVar9;
  byte local_res20;
  byte local_38 [4];
  uint local_34;
  
  local_34 = (uint)param_3;
  bVar6 = 0;
  iVar9 = 0x3f;
  local_res20 = 0;
  bVar8 = 0xff;
  bVar5 = 0x1f;
  iVar7 = 0;
  do {
    iVar3 = (int)((uint)local_res20 + iVar9) >> 1;
    bVar1 = (byte)iVar3;
    FUN_18000c3b0(0xf,bVar1);
    uVar4 = FUN_180008720((byte *)0x0,(byte *)0x0,local_38,local_34);
    if ((int)uVar4 != 0) {
      return unaff_BL;
    }
    bVar2 = (byte)((int)((uint)local_38[0] - (uint)param_1) >> 0x1f);
    bVar2 = ((byte)((uint)local_38[0] - (uint)param_1) ^ bVar2) - bVar2;
    if (bVar2 < bVar8) {
      bVar8 = bVar2;
      bVar5 = bVar1;
      bVar6 = local_38[0];
    }
    if (param_1 < local_38[0]) {
      iVar9 = iVar3;
      bVar1 = local_res20;
    }
    local_res20 = bVar1;
    iVar7 = iVar7 + 1;
  } while (iVar7 < 6);
  FUN_18000c3b0(0xf,bVar5);
  if (param_2 != (byte *)0x0) {
    *param_2 = bVar6;
  }
  return unaff_BL;
}



int FUN_1800082d4(byte *param_1,byte *param_2,undefined1 *param_3,byte *param_4,undefined2 param_5,
                 uint param_6)

{
  longlong lVar1;
  uint uVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  longlong *plVar6;
  undefined7 extraout_var;
  undefined8 uVar7;
  undefined1 (*pauVar8) [16];
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  int iVar9;
  int iVar10;
  byte bVar11;
  int iVar12;
  byte *pbVar13;
  int iVar14;
  int iVar15;
  uint uVar16;
  int local_74;
  int local_70;
  int local_6c;
  byte *local_60;
  
  local_74 = 0;
  local_70 = 0;
  plVar6 = (longlong *)TlsGetValue(DAT_18004c108);
  uVar2 = param_6;
  bVar5 = (byte)param_6;
  lVar1 = *plVar6;
  bVar4 = (byte)param_5;
  uVar16 = (uint)(byte)param_5;
  iVar12 = 0;
  iVar10 = 0;
  iVar15 = (param_6 & 0xff) * (uint)(byte)param_5;
  param_6 = 1;
  local_6c = 1;
  if (((byte)param_5 < 0x34) || (bVar5 < 0x67)) {
    iVar12 = 0xb;
    iVar10 = 6;
  }
  local_60 = param_4;
  if (param_4 == (byte *)0x0) {
    local_60 = (byte *)FUN_18001fcf8((longlong)iVar15);
    bVar11 = 0;
    param_5 = 0x5000;
    bVar3 = FUN_18000c360(0x2c,2,&param_5);
    local_74 = (int)CONCAT71(extraout_var,bVar3);
    if (local_74 == 0) {
      iVar10 = 5;
      do {
        bVar11 = bVar11 + 1;
        uVar7 = FUN_18000c4e0(0,1,1);
        if ((int)uVar7 == 0) {
          bVar3 = FUN_18000c220((longlong)local_60,uVar16,uVar2 & 0xff,0,1);
          local_74 = (int)CONCAT71(extraout_var_00,bVar3);
          if (local_74 == 0) {
            bVar3 = FUN_18000c3b0(0x2d,0x20);
            local_74 = (int)CONCAT71(extraout_var_01,bVar3);
            if (local_74 == 0) {
              if ((bVar4 < 0x34) || (bVar5 < 0x67)) {
                pauVar8 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
                if (pauVar8 != (undefined1 (*) [16])0x0) {
                  FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
                }
                FUN_180016018();
                iVar12 = 6;
                local_6c = 6;
                param_6 = 6;
              }
              else {
                pauVar8 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
                if (pauVar8 != (undefined1 (*) [16])0x0) {
                  FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
                }
                FUN_180016018();
                iVar12 = 0;
                iVar10 = 0;
              }
              goto LAB_180008559;
            }
          }
          break;
        }
        pauVar8 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pauVar8 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180016018();
      } while (bVar11 < 5);
    }
  }
  else {
LAB_180008559:
    iVar12 = iVar10 * 0x67 + iVar12;
    iVar14 = ((uVar2 & 0xff) - 1) * local_6c + iVar12;
    bVar4 = 0xff;
    iVar10 = 0;
    bVar5 = 0;
    pbVar13 = local_60;
    do {
      if (*(char *)((longlong)iVar12 + 0x14fb + lVar1) == '\x01') {
        iVar10 = iVar10 + 1;
        *pbVar13 = *(char *)(lVar1 + 0x14fa) + 1;
      }
      else {
        bVar3 = *pbVar13;
        if (bVar3 < bVar4) {
          bVar4 = bVar3;
        }
        if (bVar5 < bVar3) {
          bVar5 = bVar3;
        }
        local_70 = local_70 + (uint)bVar3;
      }
      iVar9 = iVar12 - iVar14;
      if (iVar9 == (iVar9 / 0x67) * 0x67) {
        iVar12 = iVar12 + param_6 * 0x67 + (1 - (uVar2 & 0xff)) * local_6c;
      }
      else {
        iVar12 = iVar12 + local_6c;
      }
      pbVar13 = pbVar13 + 1;
    } while (iVar12 <= (int)((uVar16 - 1) * param_6 * 0x67 + iVar14));
    if (param_1 != (byte *)0x0) {
      *param_1 = bVar4;
    }
    if (param_2 != (byte *)0x0) {
      *param_2 = bVar5;
    }
    if (param_3 != (undefined1 *)0x0) {
      *param_3 = (char)(local_70 / (iVar15 - iVar10));
    }
    pauVar8 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar8 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180016018();
    if (param_4 != (byte *)0x0) {
      return local_74;
    }
  }
  if (local_60 != (byte *)0x0) {
    FUN_18001fcb8(local_60);
  }
  return local_74;
}



undefined8 FUN_180008720(byte *param_1,byte *param_2,undefined1 *param_3,int param_4)

{
  byte bVar1;
  LPVOID pvVar2;
  undefined7 extraout_var;
  undefined8 uVar3;
  undefined7 extraout_var_00;
  undefined2 in_stack_ffffffffffffffd8;
  undefined1 uVar5;
  undefined2 uVar4;
  undefined4 in_stack_ffffffffffffffe0;
  undefined3 uVar7;
  uint uVar6;
  undefined1 local_18;
  undefined1 local_17;
  byte local_14;
  byte local_13;
  undefined1 local_12;
  
  uVar5 = (undefined1)((ushort)in_stack_ffffffffffffffd8 >> 8);
  pvVar2 = TlsGetValue(DAT_18004c108);
  if (*(int *)((longlong)pvVar2 + 0x20) == 1) {
    uVar7 = (undefined3)((uint)in_stack_ffffffffffffffe0 >> 8);
    if (param_4 == 1) {
      uVar6 = CONCAT31(uVar7,0x10);
      uVar4 = CONCAT11(uVar5,8);
    }
    else {
      if (param_4 != 0) {
        return 0;
      }
      uVar6 = CONCAT31(uVar7,0x67);
      uVar4 = CONCAT11(uVar5,0x34);
    }
    FUN_1800082d4(param_1,param_2,param_3,(byte *)0x0,uVar4,uVar6);
  }
  else {
    local_17 = 0x15;
    if (param_4 != 0) {
      local_17 = 0x57;
    }
    local_18 = 0;
    bVar1 = FUN_18000c360(0x2c,2,&local_18);
    if ((((int)CONCAT71(extraout_var,bVar1) != 0) ||
        (uVar3 = FUN_18000c4e0(0x2d,0,0x80), (int)uVar3 != 0)) ||
       (bVar1 = FUN_18000c2a4(0x67,3,&local_14), (int)CONCAT71(extraout_var_00,bVar1) != 0)) {
      return 3;
    }
    if (param_1 != (byte *)0x0) {
      *param_1 = local_14;
    }
    if (param_2 != (byte *)0x0) {
      *param_2 = local_13;
    }
    if (param_3 != (undefined1 *)0x0) {
      *param_3 = local_12;
    }
  }
  return 0;
}



undefined8 FUN_180008814(void)

{
  char *pcVar1;
  longlong lVar2;
  byte bVar3;
  longlong *plVar4;
  undefined1 (*pauVar5) [16];
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined8 uVar6;
  undefined2 local_res8;
  undefined1 local_resa;
  
  plVar4 = (longlong *)TlsGetValue(DAT_18004c108);
  lVar2 = *plVar4;
  pauVar5 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar5 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180016018();
  local_res8 = 1;
  local_resa = 0x72;
  bVar3 = FUN_18000c360(0x11,3,&local_res8);
  if ((int)CONCAT71(extraout_var,bVar3) == 0) {
    local_res8 = 0x107;
    bVar3 = FUN_18000c360(0x34,2,&local_res8);
    if ((int)CONCAT71(extraout_var_00,bVar3) == 0) {
      FUN_18000c4e0(0x35,0,0x80);
      bVar3 = FUN_18000c2a4(0xd,3,lVar2 + 6);
      if ((int)CONCAT71(extraout_var_01,bVar3) == 0) {
        *(undefined1 *)(lVar2 + 5) = 10;
        FUN_18000c3b0(0x12,10);
        do {
          FUN_18000c3b0(0xf,*(undefined1 *)(lVar2 + 8));
          uVar6 = FUN_180008720((byte *)0x0,(byte *)0x0,(undefined1 *)&local_res8,1);
          if ((int)uVar6 != 0) {
            return 3;
          }
          if ((byte)local_res8 < 0x80) break;
          pcVar1 = (char *)(lVar2 + 8);
          *pcVar1 = *pcVar1 + -1;
        } while (*pcVar1 != '\0');
        *(byte *)(lVar2 + 0xb) = DAT_18004a7b0 + (byte)local_res8;
        pauVar5 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pauVar5 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180016018();
        *(undefined2 *)(lVar2 + 0xc) = 0xff00;
        return 0;
      }
    }
  }
  return 3;
}



ulonglong FUN_1800089c0(int param_1)

{
  byte bVar1;
  int iVar2;
  undefined7 extraout_var;
  LPVOID pvVar3;
  ulonglong uVar4;
  undefined4 extraout_var_00;
  undefined1 (*pauVar5) [16];
  
  bVar1 = FUN_180008acc();
  iVar2 = (int)CONCAT71(extraout_var,bVar1);
  if (iVar2 == 0) {
    pvVar3 = TlsGetValue(DAT_18004c108);
    *(undefined4 *)((longlong)pvVar3 + 0x10) = 0;
    uVar4 = 0;
  }
  else {
    pvVar3 = TlsGetValue(DAT_18004c108);
    if (*(int *)((longlong)pvVar3 + 0x10) < 0x32) {
      if (iVar2 == 3) {
        pvVar3 = TlsGetValue(DAT_18004c108);
        *(int *)((longlong)pvVar3 + 0x10) = *(int *)((longlong)pvVar3 + 0x10) + 1;
        pvVar3 = TlsGetValue(DAT_18004c108);
        if (*(int *)((longlong)pvVar3 + 0x18) == 1) {
          FUN_18000c334();
          iVar2 = FUN_18000a36c(param_1);
          uVar4 = CONCAT44(extraout_var_00,iVar2);
        }
        else {
          pvVar3 = TlsGetValue(DAT_18004c108);
          *(undefined4 *)((longlong)pvVar3 + 0x18) = 1;
          pauVar5 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
          if (pauVar5 != (undefined1 (*) [16])0x0) {
            FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
          }
          FUN_180016018();
          uVar4 = 3;
        }
      }
      else {
        uVar4 = CONCAT71(extraout_var,bVar1) & 0xffffffff;
      }
    }
    else {
      pvVar3 = TlsGetValue(DAT_18004c108);
      *(undefined4 *)((longlong)pvVar3 + 0x10) = 0;
      uVar4 = 0x18;
    }
  }
  return uVar4;
}



byte FUN_180008acc(void)

{
  byte bVar1;
  undefined8 uVar2;
  undefined1 (*pauVar3) [16];
  int iVar4;
  byte local_res8 [8];
  
  iVar4 = 0;
  local_res8[0] = 0;
  uVar2 = FUN_18000c4e0(0,0xaa,0xfe);
  while ((int)uVar2 != 0) {
    pauVar3 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar3 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180016018();
    if (1 < iVar4) goto LAB_180008bdb;
    iVar4 = iVar4 + 1;
    uVar2 = FUN_18000c4e0(0,0xaa,0xfe);
  }
  bVar1 = FUN_18000c2f4(1,local_res8);
  if ((local_res8[0] & 3) != 0) {
    pauVar3 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar3 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180016018();
LAB_180008bdb:
    bVar1 = 3;
  }
  return bVar1;
}



void FUN_180008bf4(longlong param_1,int *param_2)

{
  bool bVar1;
  byte bVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  undefined1 (*pauVar6) [16];
  undefined7 extraout_var;
  ulonglong uVar7;
  char *pcVar8;
  LPVOID pvVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  uint uVar13;
  undefined1 *puVar14;
  uint uVar15;
  longlong lVar16;
  uint uVar17;
  byte *pbVar18;
  int iVar19;
  longlong lVar20;
  
  pbVar5 = (byte *)FUN_18001fcf8(0x3ec4);
  lVar20 = 0x14ec;
  iVar11 = 0;
  iVar12 = 0;
  FUN_180020400((undefined1 (*) [16])(param_1 + 0x14fb),0,0x14ec);
  FUN_18000c3b0(0x2c,0);
  pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar6 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180016018();
  iVar19 = 0;
  pbVar18 = pbVar5;
  do {
    puVar14 = (undefined1 *)(param_1 + 0x14fb);
    bVar2 = FUN_18000c3b0(0x2d,0x13);
    if ((int)CONCAT71(extraout_var,bVar2) != 0) goto LAB_180009030;
    FUN_18000c4e0(0,1,1);
    FUN_18000c220((longlong)pbVar18,0x34,0x67,0,1);
    FUN_18000c3b0(0x2d,0x20);
    uVar7 = FUN_180005660(pbVar18,0x67,0x34,0x67,0);
    lVar16 = 0x14ec;
    do {
      uVar3 = ((uint)uVar7 & 0xff) - (uint)pbVar18[(longlong)puVar14 - (param_1 + 0x14fb)];
      uVar10 = (int)uVar3 >> 0x1f;
      if (0x20 < (int)((uVar3 ^ uVar10) - uVar10)) {
        *puVar14 = 1;
      }
      puVar14 = puVar14 + 1;
      lVar16 = lVar16 + -1;
    } while (lVar16 != 0);
    iVar19 = iVar19 + 1;
    pbVar18 = pbVar18 + 0x14ec;
    pcVar8 = (char *)(param_1 + 0x14fb);
  } while (iVar19 < 3);
  bVar1 = false;
  do {
    if (*pcVar8 == '\x01') {
      bVar1 = true;
LAB_180008d88:
      iVar11 = iVar11 + 1;
    }
    else if (bVar1) {
      bVar1 = false;
      *pcVar8 = '\x01';
      goto LAB_180008d88;
    }
    pcVar8 = pcVar8 + 1;
    lVar20 = lVar20 + -1;
  } while (lVar20 != 0);
  if (param_2 != (int *)0x0) {
    *param_2 = iVar11;
  }
  if (*(char *)(param_1 + 0x1f3d) == '\x01') {
    pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar6 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180016018();
  }
  else {
    pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (iVar11 < 0xa77) {
      if (pauVar6 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      FUN_180016018();
      pbVar18 = (byte *)(param_1 + 0x29ec);
      FUN_18000c2a4(0x26,6,pbVar18);
      if ((*(char *)(param_1 + 0x29ee) == '\0') || (*(char *)(param_1 + 0x29f1) == '\0')) {
        pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180016018();
        pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180016018();
      }
      else {
        uVar3 = (uint)*pbVar18;
        uVar10 = (uint)*(byte *)(param_1 + 0x29ed);
        do {
          if (0x66 < (int)uVar10) break;
          iVar11 = 0;
          uVar13 = (uint)*(byte *)(param_1 + 0x29ef);
          uVar15 = (uint)*(byte *)(param_1 + 0x29f0);
LAB_180008f2a:
          if ((int)uVar15 < 0x34) {
            lVar20 = param_1 + 0x14fb;
            uVar4 = uVar13;
            for (uVar17 = uVar13; lVar20 = lVar20 + (int)(uVar4 * 0x67), uVar4 = uVar3,
                (int)uVar17 <= (int)uVar15; uVar17 = uVar17 + uVar4) {
              for (; (int)uVar4 <= (int)uVar10; uVar4 = uVar4 + *(byte *)(param_1 + 0x29ee)) {
                if (*(char *)((int)uVar4 + lVar20) == '\x01') {
                  if (iVar11 == 0) {
                    iVar11 = 1;
                  }
                  else if (iVar11 < 1) {
                    iVar11 = 1 - iVar11;
                  }
                  else {
                    iVar11 = -iVar11;
                  }
                  uVar13 = (uint)*(byte *)(param_1 + 0x29ef) + iVar11;
                  uVar15 = iVar11 + (uint)*(byte *)(param_1 + 0x29f0);
                  if (-1 < (int)uVar13) goto LAB_180008f2a;
                  goto LAB_180008fa2;
                }
              }
              uVar4 = (uint)*(byte *)(param_1 + 0x29f1);
            }
            *(char *)(param_1 + 0x29ef) = (char)uVar13;
            *(char *)(param_1 + 0x29f0) = (char)uVar15;
            *pbVar18 = (byte)uVar3;
            *(char *)(param_1 + 0x29ed) = (char)uVar10;
            goto LAB_180009030;
          }
LAB_180008fa2:
          if (iVar12 == 0) {
            iVar12 = 1;
          }
          else if (iVar12 < 1) {
            iVar12 = 1 - iVar12;
          }
          else {
            iVar12 = -iVar12;
          }
          uVar3 = (uint)*pbVar18 + iVar12;
          uVar10 = (uint)*(byte *)(param_1 + 0x29ed) + iVar12;
        } while (-1 < (int)uVar3);
        pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180016018();
        pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180016018();
        pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180016018();
        pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180016018();
      }
      pvVar9 = TlsGetValue(DAT_18004c108);
      *(undefined4 *)((longlong)pvVar9 + 0x20) = 1;
    }
    else {
      if (pauVar6 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      FUN_180016018();
    }
  }
LAB_180009030:
  FUN_18001fcb8(pbVar5);
  pvVar9 = TlsGetValue(DAT_18004c108);
  if (*(int *)((longlong)pvVar9 + 0x20) == 1) {
    pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar6 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180016018();
    *(undefined4 *)(param_1 + 0x29ec) = 0x5066006;
    *(undefined2 *)(param_1 + 0x29f0) = 0x62f;
  }
  FUN_18000c360(0x26,6,param_1 + 0x29ec);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180009304)
// WARNING: Removing unreachable block (ram,0x000180009322)
// WARNING: Removing unreachable block (ram,0x000180009329)
// WARNING: Removing unreachable block (ram,0x000180009330)
// WARNING: Removing unreachable block (ram,0x000180009334)
// WARNING: Removing unreachable block (ram,0x000180009342)

undefined8 FUN_1800092d4(void)

{
  longlong lVar1;
  longlong *plVar2;
  
  plVar2 = (longlong *)TlsGetValue(DAT_18004c108);
  lVar1 = *plVar2;
  *(char *)(lVar1 + 1) = (char)DAT_18004a7ac;
  *(undefined2 *)(lVar1 + 2) = 0x80f;
  *(undefined1 *)(lVar1 + 4) = 0x20;
  return 0;
}



void FUN_180009360(void)

{
  byte bVar1;
  undefined3 extraout_var;
  LPVOID pvVar2;
  
  bVar1 = FUN_180008acc();
  if (CONCAT31(extraout_var,bVar1) == 3) {
    FUN_18000c334();
    pvVar2 = TlsGetValue(DAT_18004c108);
    FUN_18000a36c(*(int *)((longlong)pvVar2 + 8));
  }
  return;
}



void FUN_18000938c(byte *param_1,uint param_2,uint param_3,longlong param_4,uint param_5)

{
  byte *pbVar1;
  undefined1 (*pauVar2) [16];
  uint uVar3;
  int iVar4;
  bool bVar5;
  undefined1 auStackY_d8 [32];
  byte local_98;
  byte local_97;
  byte local_96 [2];
  uint local_94;
  uint local_90;
  byte *local_88;
  int local_78 [16];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStackY_d8;
  local_78[0] = 0x800;
  local_78[1] = 0x395c;
  local_78[2] = 0x42e1;
  local_78[3] = 0x4c66;
  local_78[4] = 0x508f;
  local_78[5] = 0x5f33;
  local_78[6] = 0x68cd;
  local_78[7] = 0x7266;
  local_78[8] = 0x7c00;
  local_78[9] = 0x859a;
  local_78[10] = 0x8e66;
  local_78[0xb] = 0x9800;
  local_78[0xc] = 0xa19a;
  local_78[0xd] = 0xab33;
  local_78[0xe] = 0xb4cd;
  local_78[0xf] = 0xbe66;
  local_94 = param_3;
  local_90 = param_2;
  local_88 = param_1;
  FUN_180008720(&local_97,local_96,(undefined1 *)0x0,1);
  if ((local_97 == 0) && (local_96[0] == 0xff)) {
    FUN_18000c2f4(0x12,&local_98);
    if (1 < local_98) {
      FUN_18000c3b0(0x12,local_98 - 1);
    }
  }
  else {
    pbVar1 = (byte *)(param_4 + 0xd);
    if (*pbVar1 == 0xff) {
      FUN_18000c2f4(0xf,pbVar1);
    }
    if (local_96[0] == 0xff) {
      pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      if (pauVar2 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      FUN_180016018();
      iVar4 = (uint)local_97 << 10;
      FUN_18000c2f4(0x12,&local_98);
      uVar3 = (uint)*pbVar1;
      do {
        if (iVar4 < local_78[local_98]) break;
        iVar4 = iVar4 - local_78[local_98];
        uVar3 = uVar3 - 1;
      } while (-1 < (int)uVar3);
      bVar5 = uVar3 == *pbVar1;
    }
    else {
      if (local_97 != 0) goto LAB_1800095ab;
      pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      if (pauVar2 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      FUN_180016018();
      iVar4 = (0xff - (uint)local_96[0]) * 0x400;
      FUN_18000c2f4(0x12,&local_98);
      uVar3 = (uint)*pbVar1;
      if (uVar3 < 0x40) {
        do {
          if (iVar4 < local_78[local_98]) break;
          uVar3 = uVar3 + 1;
          iVar4 = iVar4 - local_78[local_98];
        } while ((int)uVar3 < 0x40);
      }
      bVar5 = uVar3 == *pbVar1;
    }
    if (!bVar5) {
      FUN_18000c3b0(0xf,(byte)uVar3);
      *pbVar1 = (byte)uVar3;
    }
  }
LAB_1800095ab:
  FUN_1800095e0(local_88,local_90,local_94,param_4,param_5);
  FUN_18001fe50(local_38 ^ (ulonglong)auStackY_d8);
  return;
}



ulonglong FUN_1800095e0(byte *param_1,uint param_2,uint param_3,undefined8 param_4,uint param_5)

{
  char cVar1;
  uint uVar2;
  byte bVar3;
  undefined7 extraout_var;
  ulonglong uVar4;
  undefined7 extraout_var_00;
  byte *pbVar5;
  undefined7 extraout_var_01;
  longlong lVar6;
  ulonglong uVar7;
  byte local_res10 [8];
  uint uVar8;
  uint in_stack_ffffffffffffffd0;
  
  uVar2 = param_5;
  uVar7 = (ulonglong)param_5;
  cVar1 = (char)param_5;
  local_res10[0] = 0;
  param_5._0_2_ = CONCAT11(0x13,cVar1 + -1);
  bVar3 = FUN_18000c360(0x2c,2,&param_5);
  if ((int)CONCAT71(extraout_var,bVar3) == 0) {
    FUN_18000c4e0(0,1,1);
    uVar8 = uVar2;
    bVar3 = FUN_18000c220((longlong)param_1,param_3,param_2,0,uVar2);
    uVar4 = CONCAT71(extraout_var_00,bVar3) & 0xffffffff;
    if (uVar2 != 0) {
      do {
        in_stack_ffffffffffffffd0 = CONCAT31((int3)(in_stack_ffffffffffffffd0 >> 8),(char)param_2);
        uVar8 = CONCAT31((int3)(uVar8 >> 8),(char)param_3);
        FUN_1800082d4(local_res10,(byte *)0x0,(undefined1 *)0x0,param_1,(short)uVar8,
                      in_stack_ffffffffffffffd0);
        pbVar5 = param_1;
        for (lVar6 = (longlong)(int)((param_3 & 0xff) * (param_2 & 0xff)); lVar6 != 0;
            lVar6 = lVar6 + -1) {
          *pbVar5 = *pbVar5 - local_res10[0];
          pbVar5 = pbVar5 + 1;
        }
        param_1 = param_1 + (int)(param_2 * param_3);
        uVar7 = uVar7 - 1;
      } while (uVar7 != 0);
    }
    if ((int)CONCAT71(extraout_var_00,bVar3) == 0) {
      bVar3 = FUN_18000c3b0(0x2d,0x20);
      uVar4 = CONCAT71(extraout_var_01,bVar3);
    }
  }
  else {
    uVar4 = 3;
  }
  return uVar4;
}



void FUN_1800096d8(undefined8 param_1,int param_2,int param_3)

{
  if (DAT_18004c100 == 1) {
    FUN_18000c3b0(9,3);
  }
  FUN_18000c3b0(10,0xf4);
  FUN_18000c3b0(0xc,0x44);
  FUN_18000c3b0(0x50,1);
  FUN_18000c4e0(0x50,0x80,0x80);
  FUN_18000c440(param_1,param_3,param_2);
  return;
}



void FUN_180009748(undefined1 *param_1,int param_2)

{
  undefined1 auStack_48 [32];
  char local_28 [16];
  ulonglong local_18;
  
  local_18 = DAT_18004a880 ^ (ulonglong)auStack_48;
  local_28[1] = 0x24;
  local_28[2] = 0;
  local_28[3] = 'D';
  local_28[4] = '\x0f';
  local_28[5] = '\b';
  local_28[6] = ' ';
  local_28[7] = ' ';
  local_28[8] = '\0';
  local_28[9] = '\0';
  local_28[10] = 'R';
  local_28[0] = (-(DAT_18004c100 != 0) & 0x80U) + 0x83;
  FUN_18000c360(9,0xb,local_28);
  if (param_2 != 0) {
    local_28[0] = '\x01';
    local_28[1] = 0x33;
    local_28[2] = 0x19;
    FUN_18000c360(0x54,3,local_28);
  }
  FUN_180008720((byte *)0x0,(byte *)0x0,param_1,0);
  if (param_2 != 0) {
    FUN_18000c3b0(0x54,0);
  }
  FUN_18001fe50(local_18 ^ (ulonglong)auStack_48);
  return;
}



byte FUN_1800097f8(void)

{
  longlong lVar1;
  byte bVar2;
  longlong *plVar3;
  undefined1 (*pauVar4) [16];
  undefined8 uVar5;
  undefined7 extraout_var;
  undefined2 local_res8 [4];
  
  plVar3 = (longlong *)TlsGetValue(DAT_18004c108);
  lVar1 = *plVar3;
  pauVar4 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar4 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180016018();
  FUN_18000c3b0(10,0xfd);
  FUN_18000c3b0(0x35,2);
  FUN_18000c3b0(0x80,0);
  uVar5 = FUN_18000c4e0(0x80,0,0xc0);
  if ((int)uVar5 != 0) {
    pauVar4 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar4 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180016018();
  }
  FUN_18000c3b0(10,0xfc);
  local_res8[0] = 0x30f;
  bVar2 = FUN_18000c360(1,2,local_res8);
  if ((int)CONCAT71(extraout_var,bVar2) == 0) {
    FUN_18000c3b0(0xc,0x22);
    FUN_18000c3b0(9,(-(DAT_18004c100 != 0) & 0xc0U) + 0x83);
    bVar2 = FUN_18000c360(0x26,6,lVar1 + 0x29ec);
  }
  else {
    bVar2 = 3;
  }
  return bVar2;
}



void FUN_180009964(undefined8 param_1,int param_2,int param_3)

{
  if (DAT_18004c100 == 1) {
    FUN_18000c3b0(9,3);
  }
  FUN_18000c3b0(10,0xf4);
  FUN_18000c3b0(0xc,0x44);
  FUN_18000c3b0(0x50,3);
  FUN_18000c4e0(0x50,0x80,0x80);
  FUN_18000c490(param_1,param_3,param_2);
  return;
}



void FUN_1800099d4(byte *param_1,uint param_2,uint param_3,uint param_4)

{
  LPVOID pvVar1;
  ulonglong uVar2;
  longlong *plVar3;
  
  pvVar1 = TlsGetValue(DAT_18004c108);
  uVar2 = FUN_1800089c0(*(int *)((longlong)pvVar1 + 8));
  if ((int)uVar2 == 0) {
    plVar3 = (longlong *)TlsGetValue(DAT_18004c108);
    FUN_18000938c(param_1,param_3,param_2,*plVar3,param_4);
  }
  return;
}



void FUN_180009a40(void)

{
  byte bVar1;
  undefined1 (*pauVar2) [16];
  LPVOID pvVar3;
  ulonglong uVar4;
  undefined7 extraout_var;
  undefined1 auStack_68 [32];
  undefined4 local_48;
  char *local_40;
  char *local_38;
  byte local_28;
  byte local_27 [7];
  byte local_20 [16];
  ulonglong local_10;
  
  local_10 = DAT_18004a880 ^ (ulonglong)auStack_68;
  local_28 = 0;
  pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar2 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  local_38 = "fp_tz_secure_pre_calibrate";
  local_40 = "%s";
  local_48 = 0x2ad;
  FUN_180016018();
  pvVar3 = TlsGetValue(DAT_18004c108);
  uVar4 = FUN_1800089c0(*(int *)((longlong)pvVar3 + 8));
  if ((int)uVar4 == 0) {
    FUN_18000c2f4(0x40,local_27);
    if ((local_27[0] & 0x81) == 0x81) {
      pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      if (pauVar2 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      local_40 = "pre_calibration, exit detect_mode first";
      local_48 = 0x2b6;
      FUN_180016018();
      uVar4 = FUN_180009f4c();
      if ((int)uVar4 != 0) goto LAB_180009be6;
    }
    FUN_180009748(&local_28,0);
    pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar2 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    bVar1 = local_28;
    local_38 = (char *)CONCAT44(local_38._4_4_,(uint)local_28);
    local_40 = "vdm target mean = 0x%x";
    local_48 = 700;
    FUN_180016018();
    local_20[0] = bVar1;
    local_20[1] = 0x10;
    local_20[2] = 1;
    bVar1 = FUN_18000c360(0x33,3,local_20);
    if ((int)CONCAT71(extraout_var,bVar1) == 0) {
      FUN_18000c4e0(0x35,0,0x80);
    }
  }
LAB_180009be6:
  FUN_18001fe50(local_10 ^ (ulonglong)auStack_68);
  return;
}



undefined8 FUN_180009c04(void)

{
  undefined1 (*pauVar1) [16];
  undefined8 uVar2;
  byte local_res8 [8];
  
  FUN_1800062ec();
  pauVar1 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar1 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180016018();
  uVar2 = FUN_18000c4e0(0,0xaa,0xfe);
  if ((int)uVar2 == 0) {
    FUN_18000c2f4(1,local_res8);
    if ((local_res8[0] & 3) != 0) {
      pauVar1 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      if (pauVar1 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      FUN_180016018();
      FUN_1800097f8();
    }
    uVar2 = 0;
  }
  else {
    uVar2 = 3;
  }
  return uVar2;
}



void FUN_180009d0c(void)

{
  longlong lVar1;
  longlong *plVar2;
  undefined1 (*pauVar3) [16];
  ulonglong uVar4;
  LPVOID pvVar5;
  undefined1 uVar6;
  undefined1 uVar7;
  undefined1 auStack_68 [32];
  undefined4 local_48;
  char *local_40;
  char *local_38;
  byte local_28 [8];
  char local_20;
  undefined1 uStack_1f;
  undefined1 uStack_1e;
  undefined1 uStack_1d;
  undefined1 uStack_1c;
  undefined1 uStack_1b;
  undefined1 uStack_1a;
  undefined1 uStack_19;
  undefined1 uStack_18;
  undefined1 local_17;
  undefined1 local_16;
  ulonglong local_10;
  
  local_10 = DAT_18004a880 ^ (ulonglong)auStack_68;
  plVar2 = (longlong *)TlsGetValue(DAT_18004c108);
  lVar1 = *plVar2;
  FUN_18000c2f4(0x40,local_28);
  if ((local_28[0] & 0x81) == 0x81) {
    pauVar3 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar3 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    local_38 = "fp_tz_secure_set_detect_mode";
    local_40 = "%s, preivious detect_mode";
    local_48 = 0x2d8;
    FUN_180016018();
    uVar4 = FUN_180009f4c();
    if ((int)uVar4 != 0) goto LAB_180009f28;
  }
  pvVar5 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar5 + 8) = 1;
  FUN_18000c360(0x26,6,lVar1 + 0x29ec);
  pauVar3 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar3 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  local_38 = "fp_tz_secure_set_detect_mode";
  local_40 = "%s";
  local_48 = 0x2e5;
  FUN_180016018();
  uStack_1f = 0xf4;
  uStack_1e = 3;
  uStack_1d = 0x44;
  local_20 = (-(DAT_18004c100 != 0) & 0x80U) + 0x83;
  if (DAT_18004c104 == 0) {
    uStack_1c = *(undefined1 *)(lVar1 + 6);
    uStack_1b = *(undefined1 *)(lVar1 + 7);
    uStack_1a = *(undefined1 *)(lVar1 + 8);
    local_16 = 0x72;
  }
  else {
    uStack_1c = 0xf;
    uStack_1b = 8;
    uStack_1a = 0x20;
    local_16 = 0x52;
  }
  uStack_18 = 1;
  uStack_19 = 0x20;
  local_17 = *(undefined1 *)(lVar1 + 5);
  FUN_18000c360(9,0xb,&local_20);
  local_20 = '\f';
  uStack_1f = 3;
  FUN_18000c360(1,2,&local_20);
  FUN_18000c3b0(0xc,0x22);
  FUN_18000c3b0(0xb,3);
  FUN_18000c3b0(10,0xfc);
  if (DAT_18004c100 == 1) {
    FUN_18000c3b0(9,0x43);
  }
  if (DAT_18004c104 == 0) {
    local_20 = *(char *)(lVar1 + 0xc);
    uVar7 = 6;
    uVar6 = 0x45;
    uStack_1f = *(undefined1 *)(lVar1 + 0xb);
    uStack_1e = 0x87;
    uStack_1d = 0x13;
    uStack_1c = 0;
    uStack_1b = 3;
  }
  else {
    local_20 = '\x06';
    uStack_1f = 6;
    uStack_1e = 0;
    uStack_1d = 0;
    uStack_1c = 0x87;
    uStack_1b = 0x13;
    uStack_1a = (undefined1)DAT_18004c104;
    uStack_19 = 3;
    uVar7 = 8;
    uVar6 = 0x47;
  }
  FUN_18000c3f0(uVar6,uVar7,&local_20);
LAB_180009f28:
  FUN_18001fe50(local_10 ^ (ulonglong)auStack_68);
  return;
}



ulonglong FUN_180009f4c(void)

{
  byte bVar1;
  undefined1 (*pauVar2) [16];
  undefined7 extraout_var;
  undefined8 uVar3;
  undefined2 local_res8 [4];
  
  pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar2 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180016018();
  if (DAT_18004c100 == 1) {
    FUN_18000c3b0(9,3);
  }
  FUN_18000c3b0(10,0xf4);
  FUN_18000c3b0(0xc,0x44);
  bVar1 = FUN_18000c3b0(0x40,0);
  uVar3 = FUN_18000c4e0(0x40,0,0x80);
  if ((int)uVar3 != 0) {
    pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar2 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180016018();
  }
  local_res8[0] = 0xc01;
  FUN_18000c3f0(2,2,local_res8);
  return CONCAT71(extraout_var,bVar1) & 0xffffffff;
}



ulonglong FUN_18000a074(void)

{
  undefined1 (*pauVar1) [16];
  ulonglong uVar2;
  LPVOID pvVar3;
  byte local_res8 [8];
  
  pauVar1 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar1 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180016018();
  FUN_18000c2f4(0x40,local_res8);
  if ((local_res8[0] & 0x81) == 0x81) {
    pauVar1 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar1 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180016018();
    uVar2 = FUN_180009f4c();
    if ((int)uVar2 != 0) {
      return uVar2;
    }
  }
  pvVar3 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar3 + 8) = 0;
  FUN_18000c3b0(0xc,0x22);
  FUN_18000c3b0(0xb,3);
  FUN_18000c3b0(10,0xfc);
  if (DAT_18004c100 == 1) {
    FUN_18000c3b0(9,0x43);
  }
  return 0;
}



void FUN_18000a1a0(void)

{
  longlong lVar1;
  undefined1 (*pauVar2) [16];
  ulonglong uVar3;
  LPVOID pvVar4;
  longlong *plVar5;
  undefined1 auStack_68 [32];
  undefined4 local_48;
  char *local_40;
  char *local_38;
  byte local_28 [8];
  char local_20 [5];
  undefined1 local_1b;
  undefined1 local_1a;
  undefined2 local_19;
  undefined1 local_17;
  undefined1 local_16;
  ulonglong local_10;
  
  local_10 = DAT_18004a880 ^ (ulonglong)auStack_68;
  pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar2 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  local_38 = "fp_tz_secure_set_sensor_mode";
  local_40 = "%s";
  local_48 = 0x321;
  FUN_180016018();
  FUN_18000c2f4(0x40,local_28);
  if ((local_28[0] & 0x81) == 0x81) {
    pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pauVar2 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    local_38 = "fp_tz_secure_set_sensor_mode";
    local_40 = "%s, preivious detect_mode";
    local_48 = 0x329;
    FUN_180016018();
    uVar3 = FUN_180009f4c();
    if ((int)uVar3 != 0) goto LAB_18000a34e;
  }
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 8) = 2;
  plVar5 = (longlong *)TlsGetValue(DAT_18004c108);
  lVar1 = *plVar5;
  local_20[1] = '$';
  local_20[2] = '\0';
  local_20[3] = 0x44;
  local_20[0] = (-(DAT_18004c100 != 0) & 0x80U) + 0x83;
  local_20[4] = *(undefined1 *)(lVar1 + 2);
  local_1b = *(undefined1 *)(lVar1 + 3);
  local_1a = *(undefined1 *)(lVar1 + 4);
  local_19 = 0x120;
  local_17 = *(undefined1 *)(lVar1 + 1);
  local_16 = 0x12;
  FUN_18000c360(9,0xb,local_20);
  *(undefined1 *)(lVar1 + 0xd) = 0xff;
  FUN_18000c360(0x26,6,lVar1 + 0x29ec);
  FUN_18000c3b0(0x23,0);
  FUN_18000c3b0(0x24,0x33);
  FUN_18000c3b0(0x20,0);
  FUN_18000c3b0(0x21,0x66);
LAB_18000a34e:
  FUN_18001fe50(local_10 ^ (ulonglong)auStack_68);
  return;
}



int FUN_18000a36c(int param_1)

{
  int iVar1;
  undefined1 (*pauVar2) [16];
  longlong *plVar3;
  ulonglong uVar4;
  LPVOID pvVar5;
  
  pauVar2 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pauVar2 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180016018();
  FUN_180009c04();
  plVar3 = (longlong *)TlsGetValue(DAT_18004c108);
  FUN_180009964(*plVar3 + 0xe,0x67,0x34);
  if (param_1 == 2) {
    iVar1 = FUN_18000a1a0();
  }
  else if (param_1 == 1) {
    iVar1 = FUN_180009d0c();
  }
  else {
    uVar4 = FUN_18000a074();
    iVar1 = (int)uVar4;
  }
  if (iVar1 == 0) {
    pvVar5 = TlsGetValue(DAT_18004c108);
    *(undefined4 *)((longlong)pvVar5 + 0x18) = 0;
  }
  return iVar1;
}



void FUN_18000a43c(longlong param_1,int param_2,undefined8 param_3,int param_4,longlong param_5,
                  longlong param_6)

{
  byte *pbVar1;
  int *piVar2;
  longlong lVar3;
  int iVar4;
  longlong lVar5;
  longlong lVar6;
  
  if (param_4 < 0x3c) {
    iVar4 = 0;
  }
  else {
    if (param_4 < 0x79) {
      return;
    }
    iVar4 = 1;
  }
  lVar3 = (longlong)iVar4;
  iVar4 = *(int *)(param_5 + lVar3 * 4);
  lVar6 = 8;
  do {
    lVar5 = 0;
    do {
      pbVar1 = (byte *)(lVar5 + param_1);
      lVar5 = lVar5 + 1;
      iVar4 = iVar4 + (uint)*pbVar1;
      *(int *)(param_5 + lVar3 * 4) = iVar4;
    } while (lVar5 < 8);
    param_1 = param_1 + param_2;
    lVar6 = lVar6 + -1;
  } while (lVar6 != 0);
  piVar2 = (int *)(param_6 + lVar3 * 4);
  *piVar2 = *piVar2 + 0x40;
  return;
}



ulonglong FUN_18000a49c(int *param_1)

{
  int iVar1;
  int iVar2;
  LPVOID pvVar3;
  ulonglong uVar4;
  undefined1 (*pauVar5) [16];
  int local_res10 [2];
  int local_res18 [2];
  int local_res20 [2];
  int local_34;
  
  local_res20[0] = 0;
  local_res18[0] = 0;
  local_res10[0] = 0;
  pvVar3 = TlsGetValue(DAT_18004c108);
  uVar4 = FUN_1800089c0(*(int *)((longlong)pvVar3 + 8));
  if ((int)uVar4 == 0) {
    uVar4 = FUN_18000a1a0();
    if ((int)uVar4 == 0) {
      local_34 = 0;
      do {
        pvVar3 = TlsGetValue(DAT_18004c108);
        uVar4 = FUN_1800099d4(*(byte **)((longlong)pvVar3 + 0x28),0x34,0x67,1);
        if ((int)uVar4 != 0) {
          return uVar4;
        }
        pvVar3 = TlsGetValue(DAT_18004c108);
        FUN_18000b5d0(*(byte **)((longlong)pvVar3 + 0x28),0);
        pvVar3 = TlsGetValue(DAT_18004c108);
        FUN_180008010(*(byte **)((longlong)pvVar3 + 0x28),0x67,0x34,0);
        pvVar3 = TlsGetValue(DAT_18004c108);
        iVar1 = FUN_18000b670(*(undefined8 **)((longlong)pvVar3 + 0x28),local_res20,local_res18);
        pvVar3 = TlsGetValue(DAT_18004c108);
        iVar2 = FUN_18001542c(*(byte **)((longlong)pvVar3 + 0x28),0x67,0x34,local_res10);
        pauVar5 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        if (pauVar5 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        }
        FUN_180016018();
        pauVar5 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        if (pauVar5 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        }
        FUN_180016018();
        pauVar5 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        if (pauVar5 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        }
        TlsGetValue(DAT_18004c108);
        FUN_180016018();
        if (iVar1 < *param_1) {
          *param_1 = iVar1;
        }
        pvVar3 = TlsGetValue(DAT_18004c108);
        if (0 < *(int *)((longlong)pvVar3 + 0x58)) {
          pvVar3 = TlsGetValue(DAT_18004c108);
          *(undefined4 *)((longlong)pvVar3 + 0x58) = 0;
        }
        if ((iVar2 < 3) && ((local_res10[0] < 0x1f || (local_res18[0] < 2)))) {
          *param_1 = iVar1;
          pvVar3 = TlsGetValue(DAT_18004c108);
          *(undefined4 *)((longlong)pvVar3 + 0x58) = 0;
          pvVar3 = TlsGetValue(DAT_18004c108);
          *(int *)((longlong)pvVar3 + 0x60) = local_res10[0];
          break;
        }
        if (local_34 == 4) {
          return 0x11;
        }
        local_34 = local_34 + 1;
      } while (local_34 < 5);
      pauVar5 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
      if (pauVar5 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
      }
      FUN_180016018();
      uVar4 = 0;
    }
  }
  else {
    pauVar5 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    if (pauVar5 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    }
    FUN_180016018();
    uVar4 = uVar4 & 0xffffffff;
  }
  return uVar4;
}



undefined8 FUN_18000a82c(byte *param_1,uint param_2,uint param_3,undefined8 param_4,int *param_5)

{
  int iVar1;
  longlong *plVar2;
  longlong lVar3;
  undefined8 uVar4;
  byte *pbVar5;
  int iVar6;
  byte bVar7;
  undefined1 local_res10 [8];
  int local_res18 [2];
  
  uVar4 = 0;
  bVar7 = 0xff;
  iVar6 = param_2 * param_3;
  iVar1 = iVar6 + -1;
  if (-1 < iVar1) {
    pbVar5 = param_1 + iVar1;
    lVar3 = (longlong)iVar1 + 1;
    do {
      if (*pbVar5 < bVar7) {
        bVar7 = *pbVar5;
      }
      pbVar5 = pbVar5 + -1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  lVar3 = (longlong)iVar6;
  pbVar5 = param_1;
  if (0 < iVar6) {
    do {
      *pbVar5 = *pbVar5 - bVar7;
      lVar3 = lVar3 + -1;
      pbVar5 = pbVar5 + 1;
    } while (lVar3 != 0);
  }
  FUN_18000b5d0(param_1,0);
  FUN_180008010(param_1,param_2,(ulonglong)param_3,0);
  iVar1 = FUN_18000b670((undefined8 *)param_1,local_res18,local_res10);
  if (iVar1 < 0x3c) {
    uVar4 = 0xe;
  }
  else {
    FUN_180005184(param_1,param_2,param_3,0x8c);
    plVar2 = (longlong *)TlsGetValue(DAT_18004c108);
    FUN_18000c0f8((longlong)param_1,param_2,param_3,(undefined8 *)(*plVar2 + 0x14fb));
  }
  *param_5 = iVar1;
  return uVar4;
}



undefined8 FUN_18000a93c(byte *param_1,uint *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined8 *puVar4;
  int iVar5;
  uint uVar6;
  undefined8 uVar7;
  LPVOID pvVar8;
  longlong lVar9;
  undefined1 (*pauVar10) [16];
  undefined8 *puVar11;
  uint uVar12;
  byte *pbVar13;
  byte *pbVar14;
  int iVar15;
  longlong lVar16;
  int local_res10 [2];
  int local_res18 [2];
  
  *param_2 = 0;
  local_res18[0] = 0;
  local_res10[0] = 0;
  iVar15 = 1;
  uVar7 = FUN_1800099d4(param_1,0x34,0x67,1);
  if ((int)uVar7 == 0) {
    lVar16 = 0x29;
    do {
      FUN_18000b5d0(param_1,0);
      FUN_180008010(param_1,0x67,0x34,0);
      iVar5 = FUN_18000b670((undefined8 *)param_1,local_res18,local_res10);
      pvVar8 = TlsGetValue(DAT_18004c108);
      if ((**(int **)((longlong)pvVar8 + 0x50) <= iVar5) &&
         (pvVar8 = TlsGetValue(DAT_18004c108),
         *(int *)(*(longlong *)((longlong)pvVar8 + 0x50) + 4) <= local_res10[0])) {
        pvVar8 = TlsGetValue(DAT_18004c108);
        **(int **)((longlong)pvVar8 + 0x50) = iVar5;
        pvVar8 = TlsGetValue(DAT_18004c108);
        *(int *)(*(longlong *)((longlong)pvVar8 + 0x50) + 4) = local_res10[0];
        pvVar8 = TlsGetValue(DAT_18004c108);
        lVar9 = lVar16;
        puVar4 = (undefined8 *)(*(longlong *)((longlong)pvVar8 + 0x50) + 0x10);
        pbVar14 = param_1;
        do {
          pbVar13 = pbVar14;
          puVar11 = puVar4;
          uVar7 = *(undefined8 *)(pbVar13 + 8);
          *puVar11 = *(undefined8 *)pbVar13;
          puVar11[1] = uVar7;
          uVar7 = *(undefined8 *)(pbVar13 + 0x18);
          puVar11[2] = *(undefined8 *)(pbVar13 + 0x10);
          puVar11[3] = uVar7;
          uVar7 = *(undefined8 *)(pbVar13 + 0x28);
          puVar11[4] = *(undefined8 *)(pbVar13 + 0x20);
          puVar11[5] = uVar7;
          uVar7 = *(undefined8 *)(pbVar13 + 0x38);
          puVar11[6] = *(undefined8 *)(pbVar13 + 0x30);
          puVar11[7] = uVar7;
          uVar7 = *(undefined8 *)(pbVar13 + 0x48);
          puVar11[8] = *(undefined8 *)(pbVar13 + 0x40);
          puVar11[9] = uVar7;
          uVar7 = *(undefined8 *)(pbVar13 + 0x58);
          puVar11[10] = *(undefined8 *)(pbVar13 + 0x50);
          puVar11[0xb] = uVar7;
          uVar7 = *(undefined8 *)(pbVar13 + 0x68);
          puVar11[0xc] = *(undefined8 *)(pbVar13 + 0x60);
          puVar11[0xd] = uVar7;
          uVar7 = *(undefined8 *)(pbVar13 + 0x78);
          puVar11[0xe] = *(undefined8 *)(pbVar13 + 0x70);
          puVar11[0xf] = uVar7;
          lVar9 = lVar9 + -1;
          puVar4 = puVar11 + 0x10;
          pbVar14 = pbVar13 + 0x80;
        } while (lVar9 != 0);
        uVar7 = *(undefined8 *)(pbVar13 + 0x88);
        puVar11[0x10] = *(undefined8 *)(pbVar13 + 0x80);
        puVar11[0x11] = uVar7;
        uVar7 = *(undefined8 *)(pbVar13 + 0x98);
        puVar11[0x12] = *(undefined8 *)(pbVar13 + 0x90);
        puVar11[0x13] = uVar7;
        uVar7 = *(undefined8 *)(pbVar13 + 0xa8);
        puVar11[0x14] = *(undefined8 *)(pbVar13 + 0xa0);
        puVar11[0x15] = uVar7;
        uVar7 = *(undefined8 *)(pbVar13 + 0xb8);
        puVar11[0x16] = *(undefined8 *)(pbVar13 + 0xb0);
        puVar11[0x17] = uVar7;
        uVar1 = *(undefined4 *)(pbVar13 + 0xc4);
        uVar2 = *(undefined4 *)(pbVar13 + 200);
        uVar3 = *(undefined4 *)(pbVar13 + 0xcc);
        *(undefined4 *)(puVar11 + 0x18) = *(undefined4 *)(pbVar13 + 0xc0);
        *(undefined4 *)((longlong)puVar11 + 0xc4) = uVar1;
        *(undefined4 *)(puVar11 + 0x19) = uVar2;
        *(undefined4 *)((longlong)puVar11 + 0xcc) = uVar3;
        uVar7 = *(undefined8 *)(pbVar13 + 0xd8);
        puVar11[0x1a] = *(undefined8 *)(pbVar13 + 0xd0);
        puVar11[0x1b] = uVar7;
        puVar11[0x1c] = *(undefined8 *)(pbVar13 + 0xe0);
        *(undefined4 *)(puVar11 + 0x1d) = *(undefined4 *)(pbVar13 + 0xe8);
      }
      if ((iVar5 < 0x3c) || (9 < iVar15)) {
LAB_18000ab3c:
        TlsGetValue(DAT_18004c108);
        pvVar8 = TlsGetValue(DAT_18004c108);
        local_res10[0] = *(int *)(*(longlong *)((longlong)pvVar8 + 0x50) + 4);
        pvVar8 = TlsGetValue(DAT_18004c108);
        puVar4 = (undefined8 *)(*(longlong *)((longlong)pvVar8 + 0x50) + 0x10);
        do {
          pbVar14 = param_1;
          puVar11 = puVar4;
          uVar7 = puVar11[1];
          *(undefined8 *)pbVar14 = *puVar11;
          *(undefined8 *)(pbVar14 + 8) = uVar7;
          uVar7 = puVar11[3];
          *(undefined8 *)(pbVar14 + 0x10) = puVar11[2];
          *(undefined8 *)(pbVar14 + 0x18) = uVar7;
          uVar7 = puVar11[5];
          *(undefined8 *)(pbVar14 + 0x20) = puVar11[4];
          *(undefined8 *)(pbVar14 + 0x28) = uVar7;
          uVar7 = puVar11[7];
          *(undefined8 *)(pbVar14 + 0x30) = puVar11[6];
          *(undefined8 *)(pbVar14 + 0x38) = uVar7;
          uVar7 = puVar11[9];
          *(undefined8 *)(pbVar14 + 0x40) = puVar11[8];
          *(undefined8 *)(pbVar14 + 0x48) = uVar7;
          uVar7 = puVar11[0xb];
          *(undefined8 *)(pbVar14 + 0x50) = puVar11[10];
          *(undefined8 *)(pbVar14 + 0x58) = uVar7;
          uVar7 = puVar11[0xd];
          *(undefined8 *)(pbVar14 + 0x60) = puVar11[0xc];
          *(undefined8 *)(pbVar14 + 0x68) = uVar7;
          uVar7 = puVar11[0xf];
          *(undefined8 *)(pbVar14 + 0x70) = puVar11[0xe];
          *(undefined8 *)(pbVar14 + 0x78) = uVar7;
          lVar16 = lVar16 + -1;
          puVar4 = puVar11 + 0x10;
          param_1 = pbVar14 + 0x80;
        } while (lVar16 != 0);
        uVar7 = puVar11[0x11];
        *(undefined8 *)(pbVar14 + 0x80) = puVar11[0x10];
        *(undefined8 *)(pbVar14 + 0x88) = uVar7;
        uVar7 = puVar11[0x13];
        *(undefined8 *)(pbVar14 + 0x90) = puVar11[0x12];
        *(undefined8 *)(pbVar14 + 0x98) = uVar7;
        uVar7 = puVar11[0x15];
        *(undefined8 *)(pbVar14 + 0xa0) = puVar11[0x14];
        *(undefined8 *)(pbVar14 + 0xa8) = uVar7;
        uVar7 = puVar11[0x17];
        *(undefined8 *)(pbVar14 + 0xb0) = puVar11[0x16];
        *(undefined8 *)(pbVar14 + 0xb8) = uVar7;
        uVar7 = puVar11[0x19];
        *(undefined8 *)(pbVar14 + 0xc0) = puVar11[0x18];
        *(undefined8 *)(pbVar14 + 200) = uVar7;
        uVar7 = puVar11[0x1b];
        *(undefined8 *)(pbVar14 + 0xd0) = puVar11[0x1a];
        *(undefined8 *)(pbVar14 + 0xd8) = uVar7;
        *(undefined8 *)(pbVar14 + 0xe0) = puVar11[0x1c];
        *(undefined4 *)(pbVar14 + 0xe8) = *(undefined4 *)(puVar11 + 0x1d);
        pauVar10 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        if (pauVar10 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        }
        FUN_180016018();
        if (local_res10[0] < 8) {
          if (local_res10[0] < 2) {
            *param_2 = *param_2 | 1;
          }
          else {
            *param_2 = *param_2 | 8;
          }
        }
        return 0;
      }
      if ((7 < local_res10[0]) &&
         ((pvVar8 = TlsGetValue(DAT_18004c108), uVar6 = *(int *)((longlong)pvVar8 + 0x48) - iVar5,
          uVar12 = (int)uVar6 >> 0x1f, (int)((uVar6 ^ uVar12) - uVar12) < 9 && (1 < iVar15)))) {
        pvVar8 = TlsGetValue(DAT_18004c108);
        *(int *)((longlong)pvVar8 + 0x48) = iVar5;
        goto LAB_18000ab3c;
      }
      pvVar8 = TlsGetValue(DAT_18004c108);
      *(int *)((longlong)pvVar8 + 0x48) = iVar5;
      iVar15 = iVar15 + 1;
      uVar7 = FUN_1800099d4(param_1,0x34,0x67,1);
    } while ((int)uVar7 == 0);
  }
  return uVar7;
}



void FUN_18000ac9c(void)

{
  int iVar1;
  byte *pbVar2;
  undefined8 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined8 uVar6;
  undefined8 *puVar7;
  int iVar8;
  undefined4 uVar9;
  int iVar10;
  longlong lVar11;
  ulonglong uVar12;
  LPVOID pvVar13;
  longlong lVar14;
  undefined1 (*pauVar15) [16];
  LPVOID pvVar16;
  undefined8 *puVar17;
  undefined8 *puVar18;
  int iVar19;
  longlong lVar20;
  undefined8 uStack_20;
  
  uStack_20 = 0x18000acc5;
  lVar11 = FUN_180020c30();
  lVar11 = -lVar11;
  uVar12 = DAT_18004a880 ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar11);
  iVar19 = 0;
  *(undefined4 *)(&stack0x00000040 + lVar11) = 0;
  *(undefined4 *)(&stack0x00000038 + lVar11) = 0;
  *(undefined4 *)(&stack0x0000003c + lVar11) = 0;
  lVar20 = 0x29;
  do {
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ad02;
    pvVar13 = TlsGetValue(DAT_18004c108);
    pbVar2 = *(byte **)((longlong)pvVar13 + 0x28);
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ad18;
    iVar8 = FUN_1800099d4(pbVar2,0x34,0x67,1);
    if (iVar8 != 0) goto LAB_18000afcb;
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ad2c;
    pvVar13 = TlsGetValue(DAT_18004c108);
    lVar14 = lVar20;
    puVar3 = (undefined8 *)(&stack0x00000048 + lVar11);
    puVar7 = *(undefined8 **)((longlong)pvVar13 + 0x28);
    do {
      puVar18 = puVar7;
      puVar17 = puVar3;
      uVar6 = puVar18[1];
      *puVar17 = *puVar18;
      puVar17[1] = uVar6;
      uVar6 = puVar18[3];
      puVar17[2] = puVar18[2];
      puVar17[3] = uVar6;
      uVar6 = puVar18[5];
      puVar17[4] = puVar18[4];
      puVar17[5] = uVar6;
      uVar6 = puVar18[7];
      puVar17[6] = puVar18[6];
      puVar17[7] = uVar6;
      uVar6 = puVar18[9];
      puVar17[8] = puVar18[8];
      puVar17[9] = uVar6;
      uVar6 = puVar18[0xb];
      puVar17[10] = puVar18[10];
      puVar17[0xb] = uVar6;
      uVar6 = puVar18[0xd];
      puVar17[0xc] = puVar18[0xc];
      puVar17[0xd] = uVar6;
      uVar6 = puVar18[0xf];
      puVar17[0xe] = puVar18[0xe];
      puVar17[0xf] = uVar6;
      lVar14 = lVar14 + -1;
      puVar3 = puVar17 + 0x10;
      puVar7 = puVar18 + 0x10;
    } while (lVar14 != 0);
    uVar6 = puVar18[0x11];
    puVar17[0x10] = puVar18[0x10];
    puVar17[0x11] = uVar6;
    uVar6 = puVar18[0x13];
    puVar17[0x12] = puVar18[0x12];
    puVar17[0x13] = uVar6;
    uVar6 = puVar18[0x15];
    puVar17[0x14] = puVar18[0x14];
    puVar17[0x15] = uVar6;
    uVar6 = puVar18[0x17];
    puVar17[0x16] = puVar18[0x16];
    puVar17[0x17] = uVar6;
    uVar9 = *(undefined4 *)((longlong)puVar18 + 0xc4);
    uVar4 = *(undefined4 *)(puVar18 + 0x19);
    uVar5 = *(undefined4 *)((longlong)puVar18 + 0xcc);
    *(undefined4 *)(puVar17 + 0x18) = *(undefined4 *)(puVar18 + 0x18);
    *(undefined4 *)((longlong)puVar17 + 0xc4) = uVar9;
    *(undefined4 *)(puVar17 + 0x19) = uVar4;
    *(undefined4 *)((longlong)puVar17 + 0xcc) = uVar5;
    uVar9 = *(undefined4 *)((longlong)puVar18 + 0xd4);
    uVar4 = *(undefined4 *)(puVar18 + 0x1b);
    uVar5 = *(undefined4 *)((longlong)puVar18 + 0xdc);
    *(undefined4 *)(puVar17 + 0x1a) = *(undefined4 *)(puVar18 + 0x1a);
    *(undefined4 *)((longlong)puVar17 + 0xd4) = uVar9;
    *(undefined4 *)(puVar17 + 0x1b) = uVar4;
    *(undefined4 *)((longlong)puVar17 + 0xdc) = uVar5;
    puVar17[0x1c] = puVar18[0x1c];
    *(undefined4 *)(puVar17 + 0x1d) = *(undefined4 *)(puVar18 + 0x1d);
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000add1;
    pvVar13 = TlsGetValue(DAT_18004c108);
    pbVar2 = *(byte **)((longlong)pvVar13 + 0x28);
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000addc;
    FUN_18000b5d0(pbVar2,0);
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000adf1;
    pvVar13 = TlsGetValue(DAT_18004c108);
    pbVar2 = *(byte **)((longlong)pvVar13 + 0x28);
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ae05;
    FUN_180008010(pbVar2,0x67,0x34,0);
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ae11;
    pvVar13 = TlsGetValue(DAT_18004c108);
    *(undefined1 **)(&stack0x00000008 + lVar11) = &stack0x00000044 + lVar11;
    puVar3 = *(undefined8 **)((longlong)pvVar13 + 0x28);
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ae31;
    uVar9 = FUN_18000b670(puVar3,(int *)(&stack0x00000040 + lVar11),&stack0x00000038 + lVar11);
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ae3f;
    pvVar13 = TlsGetValue(DAT_18004c108);
    *(undefined4 *)((longlong)pvVar13 + 0x48) = uVar9;
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ae4e;
    pvVar13 = TlsGetValue(DAT_18004c108);
    pbVar2 = *(byte **)((longlong)pvVar13 + 0x28);
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ae65;
    iVar8 = FUN_18001542c(pbVar2,0x67,0x34,(undefined4 *)(&stack0x0000003c + lVar11));
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ae73;
    pauVar15 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    if (pauVar15 != (undefined1 (*) [16])0x0) {
      *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ae83;
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    }
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000ae98;
    pvVar13 = TlsGetValue(DAT_18004c108);
    *(int *)(&stack0x00000030 + lVar11) = iVar8;
    uVar9 = *(undefined4 *)((longlong)pvVar13 + 0x48);
    *(undefined4 *)(&stack0x00000028 + lVar11) = *(undefined4 *)(&stack0x00000038 + lVar11);
    *(undefined4 *)(&stack0x00000020 + lVar11) = *(undefined4 *)(&stack0x00000040 + lVar11);
    *(undefined4 *)(&stack0x00000018 + lVar11) = uVar9;
    *(char **)(&stack0x00000010 + lVar11) =
         "[IsFP]detect qty = %d,corner = %d,cover = %d,level = %d";
    *(undefined4 *)(&stack0x00000008 + lVar11) = 0x14d;
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000aee3;
    FUN_180016018();
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000aeee;
    pauVar15 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    if (pauVar15 != (undefined1 (*) [16])0x0) {
      *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000aefe;
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    }
    iVar1 = *(int *)(&stack0x00000044 + lVar11);
    *(int *)(&stack0x00000020 + lVar11) = iVar1;
    *(undefined4 *)(&stack0x00000018 + lVar11) = *(undefined4 *)(&stack0x0000003c + lVar11);
    *(char **)(&stack0x00000010 + lVar11) = "[IsFP]detect percentage = %d,intensity = %d";
    *(undefined4 *)(&stack0x00000008 + lVar11) = 0x14e;
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000af43;
    FUN_180016018();
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000af4f;
    pvVar13 = TlsGetValue(DAT_18004c108);
    if (*(int *)((longlong)pvVar13 + 0x58) < iVar1) {
      *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000af60;
      pvVar13 = TlsGetValue(DAT_18004c108);
      *(int *)((longlong)pvVar13 + 0x58) = iVar1;
    }
    *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000af6f;
    pvVar13 = TlsGetValue(DAT_18004c108);
    if ((0x78 < *(int *)((longlong)pvVar13 + 0x48)) &&
       (1 < *(int *)(&stack0x00000038 + lVar11) - *(int *)(&stack0x00000040 + lVar11))) {
      if (*(int *)(&stack0x0000003c + lVar11) < 0x33) {
        if ((*(int *)(&stack0x0000003c + lVar11) - 0x1fU < 0x14) && (3 < iVar8)) goto LAB_18000afa1;
      }
      else if (5 < iVar8) {
LAB_18000afa1:
        *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000afb6;
        iVar10 = FUN_18001542c(&stack0x00000048 + lVar11,0x67,0x34,(undefined4 *)0x0);
        if (0 < iVar10) {
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b006;
          pauVar15 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
          if (pauVar15 != (undefined1 (*) [16])0x0) {
            *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b016;
            FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
          }
          *(char **)(&stack0x00000010 + lVar11) = "get_image finger touch";
          *(undefined4 *)(&stack0x00000008 + lVar11) = 0x169;
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b049;
          FUN_180016018();
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b055;
          pvVar13 = TlsGetValue(DAT_18004c108);
          *(int *)((longlong)pvVar13 + 0x58) = iVar1;
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b064;
          pvVar13 = TlsGetValue(DAT_18004c108);
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b073;
          pvVar16 = TlsGetValue(DAT_18004c108);
          **(undefined4 **)((longlong)pvVar16 + 0x50) = *(undefined4 *)((longlong)pvVar13 + 0x48);
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b088;
          pvVar13 = TlsGetValue(DAT_18004c108);
          *(undefined4 *)(*(longlong *)((longlong)pvVar13 + 0x50) + 4) =
               *(undefined4 *)(&stack0x00000038 + lVar11);
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b09f;
          pvVar13 = TlsGetValue(DAT_18004c108);
          *(int *)(*(longlong *)((longlong)pvVar13 + 0x50) + 8) = iVar8;
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b0b3;
          pvVar13 = TlsGetValue(DAT_18004c108);
          *(undefined4 *)(*(longlong *)((longlong)pvVar13 + 0x50) + 0xc) =
               *(undefined4 *)(&stack0x0000003c + lVar11);
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b0ca;
          pvVar13 = TlsGetValue(DAT_18004c108);
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000b0d9;
          pvVar16 = TlsGetValue(DAT_18004c108);
          puVar3 = (undefined8 *)(*(longlong *)((longlong)pvVar16 + 0x50) + 0x10);
          puVar7 = *(undefined8 **)((longlong)pvVar13 + 0x28);
          do {
            puVar18 = puVar7;
            puVar17 = puVar3;
            uVar6 = puVar18[1];
            *puVar17 = *puVar18;
            puVar17[1] = uVar6;
            uVar6 = puVar18[3];
            puVar17[2] = puVar18[2];
            puVar17[3] = uVar6;
            uVar6 = puVar18[5];
            puVar17[4] = puVar18[4];
            puVar17[5] = uVar6;
            uVar6 = puVar18[7];
            puVar17[6] = puVar18[6];
            puVar17[7] = uVar6;
            uVar6 = puVar18[9];
            puVar17[8] = puVar18[8];
            puVar17[9] = uVar6;
            uVar6 = puVar18[0xb];
            puVar17[10] = puVar18[10];
            puVar17[0xb] = uVar6;
            uVar6 = puVar18[0xd];
            puVar17[0xc] = puVar18[0xc];
            puVar17[0xd] = uVar6;
            uVar6 = puVar18[0xf];
            puVar17[0xe] = puVar18[0xe];
            puVar17[0xf] = uVar6;
            lVar20 = lVar20 + -1;
            puVar3 = puVar17 + 0x10;
            puVar7 = puVar18 + 0x10;
          } while (lVar20 != 0);
          uVar6 = puVar18[0x11];
          puVar17[0x10] = puVar18[0x10];
          puVar17[0x11] = uVar6;
          uVar6 = puVar18[0x13];
          puVar17[0x12] = puVar18[0x12];
          puVar17[0x13] = uVar6;
          uVar6 = puVar18[0x15];
          puVar17[0x14] = puVar18[0x14];
          puVar17[0x15] = uVar6;
          uVar6 = puVar18[0x17];
          puVar17[0x16] = puVar18[0x16];
          puVar17[0x17] = uVar6;
          uVar6 = puVar18[0x19];
          puVar17[0x18] = puVar18[0x18];
          puVar17[0x19] = uVar6;
          uVar6 = puVar18[0x1b];
          puVar17[0x1a] = puVar18[0x1a];
          puVar17[0x1b] = uVar6;
          puVar17[0x1c] = puVar18[0x1c];
          *(undefined4 *)(puVar17 + 0x1d) = *(undefined4 *)(puVar18 + 0x1d);
LAB_18000afcb:
          *(undefined8 *)((longlong)&uStack_20 + lVar11) = 0x18000afda;
          FUN_18001fe50(uVar12 ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar11));
          return;
        }
      }
    }
    iVar19 = iVar19 + 1;
    if (4 < iVar19) goto LAB_18000afcb;
  } while( true );
}



ulonglong FUN_18000b178(int *param_1,undefined4 *param_2,longlong *param_3,undefined4 *param_4,
                       undefined4 *param_5,uint *param_6)

{
  int iVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  undefined8 *puVar4;
  uint uVar5;
  undefined1 (*pauVar6) [16];
  LPVOID pvVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  longlong lVar10;
  longlong *plVar11;
  undefined8 *puVar12;
  undefined8 *puVar13;
  
  uVar9 = 0;
  pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
  if (pauVar6 != (undefined1 (*) [16])0x0) {
    FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
  }
  FUN_180016018();
  iVar1 = *param_1;
  if (iVar1 == 0x13) {
    *param_2 = 0xffffffff;
    *param_1 = 0x14;
    uVar9 = FUN_180009d0c();
    if ((int)uVar9 == 0) {
      pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
      if (pauVar6 != (undefined1 (*) [16])0x0) {
        FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
      }
      FUN_180016018();
      uVar9 = 0xc;
    }
  }
  else if (iVar1 == 0x14) {
    pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    if (pauVar6 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    }
    FUN_180016018();
    pvVar7 = TlsGetValue(DAT_18004c108);
    *(undefined4 *)((longlong)pvVar7 + 0x30) = 0;
    pvVar7 = TlsGetValue(DAT_18004c108);
    *(undefined4 *)((longlong)pvVar7 + 0x38) = 0;
    pvVar7 = TlsGetValue(DAT_18004c108);
    *(undefined4 *)((longlong)pvVar7 + 0x40) = 1;
    pvVar7 = TlsGetValue(DAT_18004c108);
    *(undefined4 *)((longlong)pvVar7 + 0x48) = 0;
    pvVar7 = TlsGetValue(DAT_18004c108);
    if ((*(int *)((longlong)pvVar7 + 8) == 2) || (uVar9 = FUN_18000a1a0(), (int)uVar9 == 0)) {
      uVar5 = FUN_18000ac9c();
      uVar9 = (ulonglong)uVar5;
      if (uVar5 == 0xe) {
        *param_2 = 0xffffffff;
        uVar5 = FUN_180009d0c();
        uVar9 = (ulonglong)uVar5;
        if (uVar5 == 0) {
          uVar9 = 0xc;
        }
      }
      else if (uVar5 == 0xf) {
        *param_1 = 0x15;
      }
    }
  }
  else if (iVar1 == 0x15) {
    pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    if (pauVar6 != (undefined1 (*) [16])0x0) {
      FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
    }
    FUN_180016018();
    pvVar7 = TlsGetValue(DAT_18004c108);
    uVar8 = FUN_18000a93c(*(byte **)((longlong)pvVar7 + 0x28),param_6);
    uVar9 = uVar8 & 0xffffffff;
    if ((int)uVar8 == 0xe) {
      uVar9 = 0;
    }
    if ((int)uVar9 == 0) {
      pvVar7 = FUN_18001fcf8(0x14ec);
      *param_3 = (longlong)pvVar7;
      if (pvVar7 == (LPVOID)0x0) {
        pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        }
        FUN_180016018();
        uVar9 = 2;
      }
      else {
        *param_4 = 0x67;
        *param_5 = 0x34;
        pvVar7 = TlsGetValue(DAT_18004c108);
        lVar10 = 0x29;
        puVar3 = (undefined8 *)*param_3;
        puVar4 = *(undefined8 **)((longlong)pvVar7 + 0x28);
        do {
          puVar13 = puVar4;
          puVar12 = puVar3;
          uVar2 = puVar13[1];
          *puVar12 = *puVar13;
          puVar12[1] = uVar2;
          uVar2 = puVar13[3];
          puVar12[2] = puVar13[2];
          puVar12[3] = uVar2;
          uVar2 = puVar13[5];
          puVar12[4] = puVar13[4];
          puVar12[5] = uVar2;
          uVar2 = puVar13[7];
          puVar12[6] = puVar13[6];
          puVar12[7] = uVar2;
          uVar2 = puVar13[9];
          puVar12[8] = puVar13[8];
          puVar12[9] = uVar2;
          uVar2 = puVar13[0xb];
          puVar12[10] = puVar13[10];
          puVar12[0xb] = uVar2;
          uVar2 = puVar13[0xd];
          puVar12[0xc] = puVar13[0xc];
          puVar12[0xd] = uVar2;
          uVar2 = puVar13[0xf];
          puVar12[0xe] = puVar13[0xe];
          puVar12[0xf] = uVar2;
          lVar10 = lVar10 + -1;
          puVar3 = puVar12 + 0x10;
          puVar4 = puVar13 + 0x10;
        } while (lVar10 != 0);
        uVar2 = puVar13[0x11];
        puVar12[0x10] = puVar13[0x10];
        puVar12[0x11] = uVar2;
        uVar2 = puVar13[0x13];
        puVar12[0x12] = puVar13[0x12];
        puVar12[0x13] = uVar2;
        uVar2 = puVar13[0x15];
        puVar12[0x14] = puVar13[0x14];
        puVar12[0x15] = uVar2;
        uVar2 = puVar13[0x17];
        puVar12[0x16] = puVar13[0x16];
        puVar12[0x17] = uVar2;
        uVar2 = puVar13[0x19];
        puVar12[0x18] = puVar13[0x18];
        puVar12[0x19] = uVar2;
        uVar2 = puVar13[0x1b];
        puVar12[0x1a] = puVar13[0x1a];
        puVar12[0x1b] = uVar2;
        puVar12[0x1c] = puVar13[0x1c];
        *(undefined4 *)(puVar12 + 0x1d) = *(undefined4 *)(puVar13 + 0x1d);
        FUN_180005184((byte *)*param_3,0x67,0x34,0x8c);
        plVar11 = (longlong *)TlsGetValue(DAT_18004c108);
        FUN_18000c0f8(*param_3,0x67,0x34,(undefined8 *)(*plVar11 + 0x14fb));
        pauVar6 = FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          FUN_180020e10((undefined1 (*) [16])"ET5XX\\egis_fp_get_image.c",0x2f);
        }
        FUN_180016018();
      }
    }
  }
  return uVar9;
}



// WARNING: Removing unreachable block (ram,0x00018000b608)
// WARNING: Removing unreachable block (ram,0x00018000b5fc)

void FUN_18000b5d0(byte *param_1,int param_2)

{
  undefined4 uVar1;
  longlong lVar2;
  
  if (param_1 != (byte *)0x0) {
    lVar2 = 0x14ec;
    if (param_2 == 0) {
      do {
        *param_1 = -*param_1 - 1;
        param_1 = param_1 + 1;
        lVar2 = lVar2 + -1;
      } while (lVar2 != 0);
    }
    else {
      do {
        uVar1 = FUN_18000b638((uint)*param_1);
        *param_1 = (byte)uVar1;
        param_1 = param_1 + 1;
        lVar2 = lVar2 + -1;
      } while (lVar2 != 0);
    }
  }
  return;
}



undefined4 FUN_18000b638(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  char cVar4;
  
  if (param_1 < 0) {
    return 0xff;
  }
  iVar2 = param_1 * 0x30 + 8;
  iVar2 = iVar2 + (iVar2 >> 0x1f & 0xfU);
  iVar3 = iVar2 >> 4;
  iVar1 = iVar3;
  if (0xff < iVar3) {
    iVar1 = 0xff;
  }
  cVar4 = (char)iVar1;
  if (iVar3 < 0) {
    cVar4 = '\0';
  }
  return CONCAT31((int3)(iVar2 >> 0xc),-1 - cVar4);
}



void FUN_18000b670(undefined8 *param_1,int *param_2,undefined8 param_3)

{
  undefined4 *puVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  byte *pbVar7;
  longlong lVar8;
  longlong lVar9;
  ulonglong uVar10;
  undefined8 *puVar11;
  byte *pbVar12;
  uint auStackX_8 [4];
  byte abStackX_18 [16];
  undefined8 uStack_20;
  
  uStack_20 = 0x18000b67e;
  lVar8 = FUN_180020c30();
  lVar8 = -lVar8;
  *(ulonglong *)(&stack0x00002d18 + lVar8) =
       DAT_18004a880 ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar8);
  puVar1 = *(undefined4 **)(&stack0x00002d68 + lVar8);
  lVar9 = 0x29;
  pbVar7 = abStackX_18 + lVar8;
  do {
    pbVar12 = pbVar7;
    puVar11 = param_1;
    uVar2 = puVar11[1];
    uVar3 = puVar11[2];
    uVar4 = puVar11[3];
    *(undefined8 *)pbVar12 = *puVar11;
    *(undefined8 *)(pbVar12 + 8) = uVar2;
    uVar2 = puVar11[4];
    uVar5 = puVar11[5];
    *(undefined8 *)(pbVar12 + 0x10) = uVar3;
    *(undefined8 *)(pbVar12 + 0x18) = uVar4;
    uVar3 = puVar11[6];
    uVar4 = puVar11[7];
    *(undefined8 *)(pbVar12 + 0x20) = uVar2;
    *(undefined8 *)(pbVar12 + 0x28) = uVar5;
    uVar2 = puVar11[8];
    uVar5 = puVar11[9];
    *(undefined8 *)(pbVar12 + 0x30) = uVar3;
    *(undefined8 *)(pbVar12 + 0x38) = uVar4;
    uVar3 = puVar11[10];
    uVar4 = puVar11[0xb];
    *(undefined8 *)(pbVar12 + 0x40) = uVar2;
    *(undefined8 *)(pbVar12 + 0x48) = uVar5;
    uVar2 = puVar11[0xc];
    uVar5 = puVar11[0xd];
    *(undefined8 *)(pbVar12 + 0x50) = uVar3;
    *(undefined8 *)(pbVar12 + 0x58) = uVar4;
    uVar3 = puVar11[0xe];
    uVar4 = puVar11[0xf];
    *(undefined8 *)(pbVar12 + 0x60) = uVar2;
    *(undefined8 *)(pbVar12 + 0x68) = uVar5;
    *(undefined8 *)(pbVar12 + 0x70) = uVar3;
    *(undefined8 *)(pbVar12 + 0x78) = uVar4;
    lVar9 = lVar9 + -1;
    param_1 = puVar11 + 0x10;
    pbVar7 = pbVar12 + 0x80;
  } while (lVar9 != 0);
  uVar3 = puVar11[0x10];
  uVar4 = puVar11[0x11];
  uVar5 = puVar11[0x12];
  uVar6 = puVar11[0x13];
  uVar2 = puVar11[0x1c];
  *(undefined4 *)((longlong)auStackX_8 + lVar8) = 0x50;
  *(undefined8 *)(pbVar12 + 0x80) = uVar3;
  *(undefined8 *)(pbVar12 + 0x88) = uVar4;
  uVar3 = puVar11[0x14];
  uVar4 = puVar11[0x15];
  *(undefined8 *)(pbVar12 + 0x90) = uVar5;
  *(undefined8 *)(pbVar12 + 0x98) = uVar6;
  uVar5 = puVar11[0x16];
  uVar6 = puVar11[0x17];
  *(undefined8 *)(pbVar12 + 0xa0) = uVar3;
  *(undefined8 *)(pbVar12 + 0xa8) = uVar4;
  uVar3 = puVar11[0x18];
  uVar4 = puVar11[0x19];
  *(undefined8 *)(pbVar12 + 0xb0) = uVar5;
  *(undefined8 *)(pbVar12 + 0xb8) = uVar6;
  uVar5 = puVar11[0x1a];
  uVar6 = puVar11[0x1b];
  *(undefined8 *)(pbVar12 + 0xc0) = uVar3;
  *(undefined8 *)(pbVar12 + 200) = uVar4;
  *(undefined8 *)(pbVar12 + 0xd0) = uVar5;
  *(undefined8 *)(pbVar12 + 0xd8) = uVar6;
  *(undefined8 *)(pbVar12 + 0xe0) = uVar2;
  *(undefined4 *)(pbVar12 + 0xe8) = *(undefined4 *)(puVar11 + 0x1d);
  *(undefined8 *)((longlong)&uStack_20 + lVar8) = 0x18000b753;
  FUN_180005e70((longlong)(abStackX_18 + lVar8),0x67,0x34,0x90,
                *(uint *)((longlong)auStackX_8 + lVar8));
  *(undefined4 *)((longlong)auStackX_8 + lVar8 + 8) = 0;
  *(undefined8 *)((longlong)auStackX_8 + lVar8) = param_3;
  *(undefined8 *)((longlong)&uStack_20 + lVar8) = 0x18000b773;
  FUN_180014dac(abStackX_18 + lVar8,0x90,0x50,param_2,*(int **)((longlong)auStackX_8 + lVar8),
                *(int *)((longlong)auStackX_8 + lVar8 + 8));
  if (puVar1 != (undefined4 *)0x0) {
    *(undefined4 *)((longlong)auStackX_8 + lVar8) = 0;
    *(undefined8 *)((longlong)&uStack_20 + lVar8) = 0x18000b795;
    uVar10 = FUN_180005660(abStackX_18 + lVar8,0x90,0x50,0x90,*(int *)((longlong)auStackX_8 + lVar8)
                          );
    *puVar1 = (int)uVar10;
  }
  *(undefined8 *)((longlong)&uStack_20 + lVar8) = 0x18000b7a9;
  FUN_18001fe50(*(ulonglong *)(&stack0x00002d18 + lVar8) ^
                (ulonglong)(&stack0xffffffffffffffe8 + lVar8));
  return;
}



undefined8 * FUN_18000b7b4(undefined8 *param_1)

{
  undefined1 (*lpTlsValue) [16];
  undefined2 *puVar1;
  HLOCAL pvVar2;
  undefined8 *puVar3;
  LPVOID pvVar4;
  
  lpTlsValue = (undefined1 (*) [16])(param_1 + 1);
  *param_1 = &PTR_FUN_18003df28;
  FUN_180020400(lpTlsValue,0,0x68);
  TlsSetValue(DAT_18004c108,lpTlsValue);
  pvVar2 = LocalAlloc(0x40,0x29f4);
  *(HLOCAL *)*lpTlsValue = pvVar2;
  pvVar2 = LocalAlloc(0x40,0x14ec);
  param_1[6] = pvVar2;
  pvVar2 = LocalAlloc(0x40,0x14fc);
  param_1[0xb] = pvVar2;
  puVar3 = (undefined8 *)TlsGetValue(DAT_18004c108);
  puVar1 = (undefined2 *)*puVar3;
  *puVar1 = 0xf03;
  *(undefined4 *)(puVar1 + 0x14f6) = 0x5066006;
  puVar1[0x14f8] = 0x62f;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 8) = 2;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 0x10) = 0;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 0x18) = 0;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 0x20) = 0;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 0x30) = 0;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 0x38) = 0;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 0x40) = 0;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 0x48) = 0;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 0x58) = 0xff;
  pvVar4 = TlsGetValue(DAT_18004c108);
  *(undefined4 *)((longlong)pvVar4 + 0x60) = 0;
  return param_1;
}



void FUN_18000b8fc(undefined8 *param_1)

{
  undefined8 *puVar1;
  LPVOID pvVar2;
  
  *param_1 = &PTR_FUN_18003df28;
  puVar1 = (undefined8 *)TlsGetValue(DAT_18004c108);
  LocalFree((HLOCAL)*puVar1);
  pvVar2 = TlsGetValue(DAT_18004c108);
  LocalFree(*(HLOCAL *)((longlong)pvVar2 + 0x28));
  pvVar2 = TlsGetValue(DAT_18004c108);
                    // WARNING: Could not recover jumptable at 0x00018000b949. Too many branches
                    // WARNING: Treating indirect jump as call
  LocalFree(*(HLOCAL *)((longlong)pvVar2 + 0x50));
  return;
}



undefined8 * FUN_18000b950(undefined8 *param_1,uint param_2)

{
  FUN_18000b8fc(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



uint FUN_18000b980(longlong param_1,byte *param_2,uint param_3,uint param_4,uint param_5,
                  int *param_6)

{
  undefined8 uVar1;
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  uVar1 = FUN_18000a82c(param_2,param_3,param_4,(ulonglong)param_5,param_6);
  return -(uint)((int)uVar1 != 0) & 0x3e3;
}



undefined8
FUN_18000b9e4(longlong *param_1,char *param_2,undefined8 *param_3,undefined4 *param_4,uint param_5)

{
  ULONGLONG UVar1;
  ulonglong uVar2;
  undefined8 uVar3;
  LPVOID pvVar4;
  ulonglong uVar5;
  int local_res8 [2];
  undefined4 local_res10 [2];
  int local_48;
  int local_44;
  uint local_40 [2];
  undefined8 *local_38 [2];
  
  TlsSetValue(DAT_18004c108,param_1 + 1);
  local_res10[0] = 0;
  local_res8[0] = 0x14;
  if (param_5 == 0xffffffff) {
    uVar5 = 0xffffffffffffffff;
  }
  else {
    UVar1 = GetTickCount64();
    uVar5 = param_5 + UVar1;
  }
  if (*param_2 == '\0') {
    FUN_180009360();
    do {
      uVar2 = FUN_18000b178(local_res8,local_res10,(longlong *)local_38,&local_48,&local_44,local_40
                           );
      if ((int)uVar2 == 0xf) {
        uVar2 = FUN_18000b178(local_res8,local_res10,(longlong *)local_38,&local_48,&local_44,
                              local_40);
        if ((int)uVar2 == 0) {
          FUN_18001fe80(param_3,local_38[0],(longlong)(local_48 * local_44));
          FUN_18001fcb8(local_38[0]);
          pvVar4 = TlsGetValue(DAT_18004c108);
          *param_4 = *(undefined4 *)((longlong)pvVar4 + 0x48);
          return 0;
        }
        local_res8[0] = 0x13;
      }
      else {
        if ((int)uVar2 != 0xc) {
          return 1;
        }
        if (*param_2 != '\0') {
          return 0x3e3;
        }
        do {
          UVar1 = GetTickCount64();
          if (uVar5 < UVar1) {
            return 0x5b4;
          }
          uVar3 = FUN_18000c060(param_1,&param_5);
          if ((int)uVar3 == 0) {
            return 1;
          }
        } while ((param_5 == 0) && (*param_2 == '\0'));
      }
    } while (*param_2 == '\0');
  }
  return 0x3e3;
}



longlong FUN_18000bb40(longlong param_1)

{
  longlong *plVar1;
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  plVar1 = (longlong *)TlsGetValue(DAT_18004c108);
  return *plVar1 + 0xe;
}



bool FUN_18000bb6c(longlong param_1,undefined8 param_2,undefined *param_3,undefined *param_4)

{
  longlong lVar1;
  int iVar2;
  longlong *plVar3;
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  plVar3 = (longlong *)TlsGetValue(DAT_18004c108);
  lVar1 = *plVar3;
  iVar2 = (*(code *)param_3)(param_2,L"sensor_gain",lVar1 + 1);
  if (((((iVar2 != 0) &&
        (iVar2 = (*(code *)param_3)(param_2,L"sensor_vref_sel",lVar1 + 2), iVar2 != 0)) &&
       (iVar2 = (*(code *)param_3)(param_2,L"sensor_dc_p",lVar1 + 3), iVar2 != 0)) &&
      ((((iVar2 = (*(code *)param_3)(param_2,L"sensor_dc_c",lVar1 + 4), iVar2 != 0 &&
         (iVar2 = (*(code *)param_3)(param_2,L"detect_gain",lVar1 + 5), iVar2 != 0)) &&
        ((iVar2 = (*(code *)param_3)(param_2,L"detect_vref_sel",lVar1 + 6), iVar2 != 0 &&
         ((iVar2 = (*(code *)param_3)(param_2,L"detect_dc_p",lVar1 + 7), iVar2 != 0 &&
          (iVar2 = (*(code *)param_3)(param_2,L"detect_dc_c",lVar1 + 8), iVar2 != 0)))))) &&
       (iVar2 = (*(code *)param_3)(param_2,L"detect_dc_f_g",lVar1 + 9), iVar2 != 0)))) &&
     ((((iVar2 = (*(code *)param_3)(param_2,L"detect_mean",lVar1 + 10), iVar2 != 0 &&
        (iVar2 = (*(code *)param_3)(param_2,L"detect_thh",lVar1 + 0xb), iVar2 != 0)) &&
       (iVar2 = (*(code *)param_3)(param_2,L"detect_thl",lVar1 + 0xc), iVar2 != 0)) &&
      ((iVar2 = (*(code *)param_4)(param_2,L"vdm_bk",lVar1 + 0xe,0x14ec), iVar2 != 0 &&
       (iVar2 = (*(code *)param_4)(param_2,L"bad_pixel",lVar1 + 0x14fb,0x14ec), iVar2 != 0)))))) {
    plVar3 = (longlong *)TlsGetValue(DAT_18004c108);
    iVar2 = FUN_180009964(*plVar3 + 0xe,0x67,0x34);
    if (iVar2 == 0) {
      iVar2 = FUN_18000a1a0();
      return iVar2 == 0;
    }
  }
  return false;
}



bool FUN_18000bd4c(longlong param_1)

{
  int iVar1;
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  iVar1 = FUN_180009360();
  return iVar1 == 0;
}



bool FUN_18000bd74(longlong param_1)

{
  int iVar1;
  bool bVar2;
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  iVar1 = FUN_180009360();
  if (iVar1 == 0) {
    iVar1 = FUN_180009d0c();
    bVar2 = iVar1 == 0;
  }
  else {
    bVar2 = false;
  }
  return bVar2;
}



bool FUN_18000bdac(longlong param_1)

{
  int iVar1;
  bool bVar2;
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  iVar1 = FUN_180009360();
  if (iVar1 == 0) {
    iVar1 = FUN_18000a1a0();
    bVar2 = iVar1 == 0;
  }
  else {
    bVar2 = false;
  }
  return bVar2;
}



bool FUN_18000bde4(longlong param_1)

{
  int iVar1;
  ulonglong uVar2;
  bool bVar3;
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  iVar1 = FUN_180009360();
  if (iVar1 == 0) {
    uVar2 = FUN_18000a074();
    bVar3 = (int)uVar2 == 0;
  }
  else {
    bVar3 = false;
  }
  return bVar3;
}



undefined8 FUN_18000be1c(longlong param_1,char *param_2)

{
  LPVOID pvVar1;
  ulonglong uVar2;
  int local_res8 [8];
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  pvVar1 = TlsGetValue(DAT_18004c108);
  local_res8[0] = *(int *)((longlong)pvVar1 + 0x48);
  do {
    if (*param_2 != '\0') {
      return 0x3e3;
    }
    uVar2 = FUN_18000a49c(local_res8);
  } while ((int)uVar2 == 0x11);
  return 0;
}



bool FUN_18000be70(longlong param_1,undefined8 param_2,undefined *param_3,undefined *param_4)

{
  longlong lVar1;
  int iVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  longlong *plVar5;
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  uVar3 = FUN_180007bc0();
  if (((int)uVar3 == 0) && (uVar4 = FUN_180008814(), (int)uVar4 == 0)) {
    plVar5 = (longlong *)TlsGetValue(DAT_18004c108);
    lVar1 = *plVar5;
    iVar2 = (*(code *)param_3)(param_2,L"sensor_gain",*(undefined1 *)(lVar1 + 1));
    if (iVar2 != 0) {
      iVar2 = (*(code *)param_3)(param_2,L"sensor_vref_sel",*(undefined1 *)(lVar1 + 2));
      if (iVar2 != 0) {
        iVar2 = (*(code *)param_3)(param_2,L"sensor_dc_p",*(undefined1 *)(lVar1 + 3));
        if (iVar2 != 0) {
          iVar2 = (*(code *)param_3)(param_2,L"sensor_dc_c",*(undefined1 *)(lVar1 + 4));
          if (iVar2 != 0) {
            iVar2 = (*(code *)param_3)(param_2,L"detect_gain",*(undefined1 *)(lVar1 + 5));
            if (iVar2 != 0) {
              iVar2 = (*(code *)param_3)(param_2,L"detect_vref_sel",*(undefined1 *)(lVar1 + 6));
              if (iVar2 != 0) {
                iVar2 = (*(code *)param_3)(param_2,L"detect_dc_p",*(undefined1 *)(lVar1 + 7));
                if (iVar2 != 0) {
                  iVar2 = (*(code *)param_3)(param_2,L"detect_dc_c",*(undefined1 *)(lVar1 + 8));
                  if (iVar2 != 0) {
                    iVar2 = (*(code *)param_3)(param_2,L"detect_dc_f_g",*(undefined1 *)(lVar1 + 9));
                    if (iVar2 != 0) {
                      iVar2 = (*(code *)param_3)(param_2,L"detect_mean",*(undefined1 *)(lVar1 + 10))
                      ;
                      if (iVar2 != 0) {
                        iVar2 = (*(code *)param_3)(param_2,L"detect_thh",
                                                   *(undefined1 *)(lVar1 + 0xb));
                        if (((iVar2 != 0) &&
                            (iVar2 = (*(code *)param_3)(param_2,L"detect_thl",
                                                        *(undefined1 *)(lVar1 + 0xc)), iVar2 != 0))
                           && (iVar2 = (*(code *)param_4)(param_2,L"vdm_bk",lVar1 + 0xe,0x14ec),
                              iVar2 != 0)) {
                          iVar2 = (*(code *)param_4)(param_2,L"bad_pixel",lVar1 + 0x14fb,0x14ec);
                          return iVar2 != 0;
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return false;
}



bool FUN_18000c038(longlong param_1)

{
  undefined8 uVar1;
  
  TlsSetValue(DAT_18004c108,(LPVOID)(param_1 + 8));
  uVar1 = FUN_180009c04();
  return (int)uVar1 == 0;
}



undefined8 FUN_18000c060(longlong *param_1,uint *param_2)

{
  undefined8 uVar1;
  byte local_res8 [32];
  
  uVar1 = (**(code **)(*param_1 + 0x10))(param_1,1,local_res8);
  if ((int)uVar1 != 0) {
    uVar1 = 1;
    *param_2 = local_res8[0] >> 2 & 1;
  }
  return uVar1;
}



bool FUN_18000c094(longlong *param_1,undefined1 param_2,char param_3)

{
  int iVar1;
  char local_res8 [8];
  
  iVar1 = (**(code **)(*param_1 + 0x18))();
  if ((iVar1 != 0) &&
     (iVar1 = (**(code **)(*param_1 + 0x10))(param_1,param_2,local_res8), iVar1 != 0)) {
    return param_3 == local_res8[0];
  }
  return false;
}



void FUN_18000c0f8(longlong param_1,uint param_2,int param_3,undefined8 *param_4)

{
  undefined8 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 *puVar6;
  longlong lVar7;
  longlong lVar8;
  undefined8 *puVar9;
  undefined8 *puVar10;
  int aiStackX_20 [2];
  undefined8 uStack_8;
  
  uStack_8 = 0x18000c102;
  lVar7 = FUN_180020c30();
  lVar7 = -lVar7;
  *(ulonglong *)(&stack0x00001520 + lVar7) = DAT_18004a880 ^ (longlong)aiStackX_20 + lVar7 + -0x20;
  lVar8 = 0x29;
  puVar6 = (undefined8 *)(&stack0x00000030 + lVar7);
  do {
    puVar10 = param_4;
    puVar9 = puVar6;
    uVar1 = puVar10[1];
    uVar2 = puVar10[2];
    uVar3 = puVar10[3];
    *puVar9 = *puVar10;
    puVar9[1] = uVar1;
    uVar1 = puVar10[4];
    uVar4 = puVar10[5];
    puVar9[2] = uVar2;
    puVar9[3] = uVar3;
    uVar2 = puVar10[6];
    uVar3 = puVar10[7];
    puVar9[4] = uVar1;
    puVar9[5] = uVar4;
    uVar1 = puVar10[8];
    uVar4 = puVar10[9];
    puVar9[6] = uVar2;
    puVar9[7] = uVar3;
    uVar2 = puVar10[10];
    uVar3 = puVar10[0xb];
    puVar9[8] = uVar1;
    puVar9[9] = uVar4;
    uVar1 = puVar10[0xc];
    uVar4 = puVar10[0xd];
    puVar9[10] = uVar2;
    puVar9[0xb] = uVar3;
    uVar2 = puVar10[0xe];
    uVar3 = puVar10[0xf];
    puVar9[0xc] = uVar1;
    puVar9[0xd] = uVar4;
    puVar9[0xe] = uVar2;
    puVar9[0xf] = uVar3;
    lVar8 = lVar8 + -1;
    puVar6 = puVar9 + 0x10;
    param_4 = puVar10 + 0x10;
  } while (lVar8 != 0);
  uVar2 = puVar10[0x11];
  uVar3 = puVar10[0x12];
  uVar4 = puVar10[0x13];
  uVar1 = puVar10[0x1c];
  puVar9[0x10] = puVar10[0x10];
  puVar9[0x11] = uVar2;
  uVar2 = puVar10[0x14];
  uVar5 = puVar10[0x15];
  puVar9[0x12] = uVar3;
  puVar9[0x13] = uVar4;
  uVar3 = puVar10[0x16];
  uVar4 = puVar10[0x17];
  puVar9[0x14] = uVar2;
  puVar9[0x15] = uVar5;
  uVar2 = puVar10[0x18];
  uVar5 = puVar10[0x19];
  puVar9[0x16] = uVar3;
  puVar9[0x17] = uVar4;
  uVar3 = puVar10[0x1a];
  uVar4 = puVar10[0x1b];
  puVar9[0x18] = uVar2;
  puVar9[0x19] = uVar5;
  puVar9[0x1a] = uVar3;
  puVar9[0x1b] = uVar4;
  puVar9[0x1c] = uVar1;
  lVar8 = 0;
  *(undefined4 *)(puVar9 + 0x1d) = *(undefined4 *)(puVar10 + 0x1d);
  if (0 < (int)(param_3 * param_2)) {
    do {
      if (((&stack0x00000030)[lVar8 + lVar7] == '\x01') &&
         (lVar8 = lVar8 + 1, (&stack0x00000031)[lVar8 + lVar7 + -1] != '\x01')) {
        (&stack0x00000031)[lVar8 + lVar7 + -1] = 1;
      }
      lVar8 = lVar8 + 1;
    } while (lVar8 < (int)(param_3 * param_2));
  }
  *(undefined4 *)((longlong)aiStackX_20 + lVar7) = *(undefined4 *)(&stack0x00001560 + lVar7);
  *(undefined8 *)((longlong)&uStack_8 + lVar7) = 0x18000c205;
  FUN_1800051c0(param_1,param_2,param_3,&stack0x00000030 + lVar7,
                *(int *)((longlong)aiStackX_20 + lVar7));
  *(undefined8 *)((longlong)&uStack_8 + lVar7) = 0x18000c215;
  FUN_18001fe50(*(ulonglong *)(&stack0x00001520 + lVar7) ^ (longlong)aiStackX_20 + lVar7 + -0x20);
  return;
}



byte FUN_18000c220(longlong param_1,int param_2,int param_3,undefined8 param_4,int param_5)

{
  byte bVar1;
  int iVar2;
  LPVOID pvVar3;
  
  if (param_5 != 0) {
    do {
      pvVar3 = TlsGetValue(DAT_18004c108);
      iVar2 = (**(code **)(*(longlong *)((longlong)pvVar3 + -8) + 8))
                        ((longlong *)((longlong)pvVar3 + -8),param_1,param_3,param_2);
      bVar1 = ~-(iVar2 != 0) & 3;
      if (bVar1 != 0) {
        return bVar1;
      }
      param_1 = param_1 + param_2 * param_3;
      param_5 = param_5 + -1;
    } while (param_5 != 0);
  }
  return 0;
}



byte FUN_18000c2a4(undefined1 param_1,undefined1 param_2,undefined8 param_3)

{
  int iVar1;
  LPVOID pvVar2;
  
  pvVar2 = TlsGetValue(DAT_18004c108);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x28))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2,param_3);
  return ~-(iVar1 != 0) & 3;
}



byte FUN_18000c2f4(undefined1 param_1,undefined8 param_2)

{
  int iVar1;
  LPVOID pvVar2;
  
  pvVar2 = TlsGetValue(DAT_18004c108);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x10))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2);
  return ~-(iVar1 != 0) & 3;
}



byte FUN_18000c334(void)

{
  int iVar1;
  LPVOID pvVar2;
  
  pvVar2 = TlsGetValue(DAT_18004c108);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x88))();
  return ~-(iVar1 != 0) & 3;
}



byte FUN_18000c360(undefined1 param_1,undefined1 param_2,undefined8 param_3)

{
  int iVar1;
  LPVOID pvVar2;
  
  pvVar2 = TlsGetValue(DAT_18004c108);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x30))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2,param_3);
  return ~-(iVar1 != 0) & 3;
}



byte FUN_18000c3b0(undefined1 param_1,undefined1 param_2)

{
  int iVar1;
  LPVOID pvVar2;
  
  pvVar2 = TlsGetValue(DAT_18004c108);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x18))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2);
  return ~-(iVar1 != 0) & 3;
}



byte FUN_18000c3f0(undefined1 param_1,undefined1 param_2,undefined8 param_3)

{
  int iVar1;
  LPVOID pvVar2;
  
  pvVar2 = TlsGetValue(DAT_18004c108);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x40))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2,param_3);
  return ~-(iVar1 != 0) & 3;
}



byte FUN_18000c440(undefined8 param_1,int param_2,int param_3)

{
  int iVar1;
  LPVOID pvVar2;
  
  pvVar2 = TlsGetValue(DAT_18004c108);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x70))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2 * param_3);
  return ~-(iVar1 != 0) & 3;
}



byte FUN_18000c490(undefined8 param_1,int param_2,int param_3)

{
  int iVar1;
  LPVOID pvVar2;
  
  pvVar2 = TlsGetValue(DAT_18004c108);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x78))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2 * param_3);
  return ~-(iVar1 != 0) & 3;
}



undefined8 FUN_18000c4e0(undefined1 param_1,byte param_2,byte param_3)

{
  byte bVar1;
  undefined7 extraout_var;
  int iVar2;
  byte local_res20 [8];
  
  iVar2 = 0;
  while( true ) {
    bVar1 = FUN_18000c2f4(param_1,local_res20);
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      return 3;
    }
    if ((local_res20[0] & param_3) == param_2) break;
    iVar2 = iVar2 + 1;
    if (2999 < iVar2) {
      return 3;
    }
  }
  return 0;
}



void FUN_18000c544(undefined8 param_1)

{
  LPVOID pvVar1;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 1) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xc,&DAT_18003e118);
  }
  pvVar1 = (LPVOID)FUN_18000c974(param_1);
  if (pvVar1 != (LPVOID)0x0) {
    thunk_FUN_18001fcb8(pvVar1);
  }
  FUN_18000c82c();
  return;
}



void FUN_18000c5a0(undefined8 param_1,undefined8 param_2)

{
  longlong *plVar1;
  
  plVar1 = (longlong *)FUN_18000c974(param_1);
                    // WARNING: Could not recover jumptable at 0x00018000c5cb. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar1 + 8))(plVar1,param_1,param_2);
  return;
}



void FUN_18000c5d0(undefined8 param_1)

{
  longlong *plVar1;
  
  plVar1 = (longlong *)FUN_18000c974(param_1);
  if (plVar1 != (longlong *)0x0) {
    (**(code **)(*plVar1 + 0x10))(plVar1,param_1);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_18000c5f8(undefined8 param_1,undefined8 param_2)

{
  int iVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;
  longlong local_res18;
  undefined4 local_78 [2];
  code *local_70;
  code *local_68;
  undefined4 local_58 [2];
  code *local_50;
  undefined4 local_40;
  undefined4 local_3c;
  undefined *local_28;
  
  puVar3 = (undefined8 *)0x0;
  local_res18 = 0;
  DAT_18004c110 = &DAT_18003e178;
  DAT_18004c128 = 0;
  DAT_18004c118 = 0;
  _DAT_18004c130 = 1;
  PTR_LOOP_18004a7b8 = (undefined *)&DAT_18004c118;
  FUN_18000c8fc();
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 1) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),10,&DAT_18003e118);
  }
  puVar2 = (undefined8 *)FUN_180020780(8);
  if (puVar2 != (undefined8 *)0x0) {
    *puVar2 = &PTR_FUN_18003e188;
    puVar3 = puVar2;
  }
  if (puVar3 == (undefined8 *)0x0) {
    iVar1 = -0x3fffff66;
  }
  else {
    FUN_180020400((undefined1 (*) [16])local_58,0,0x38);
    local_28 = PTR_DAT_18004a7e0;
    local_58[0] = 0x38;
    local_40 = 1;
    local_50 = FUN_18000c544;
    local_3c = 1;
    FUN_180020400((undefined1 (*) [16])local_78,0,0x20);
    local_70 = FUN_18000c5a0;
    local_68 = FUN_18000c5d0;
    local_78[0] = 0x20;
    iVar1 = (*DAT_18004c318)(DAT_18004c910,param_1,param_2,local_58,local_78,&local_res18);
    if (-1 < iVar1) {
      puVar2 = (undefined8 *)(*DAT_18004c528)(DAT_18004c910,local_res18,PTR_DAT_18004a7e0);
      *puVar2 = puVar3;
      iVar1 = (**(code **)*puVar3)(puVar3,local_res18);
      if (-1 < iVar1) goto LAB_18000c799;
      *puVar2 = 0;
    }
    thunk_FUN_18001fcb8(puVar3);
  }
LAB_18000c799:
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 1) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xb,&DAT_18003e118,iVar1);
  }
  if (iVar1 < 0) {
    if (local_res18 == 0) {
      FUN_18000c82c();
    }
    else {
      (*DAT_18004c558)(DAT_18004c910);
    }
  }
  return iVar1;
}



void FUN_18000c80c(undefined8 param_1,undefined2 param_2,undefined8 param_3)

{
  TraceMessage(param_1,0x2b,param_3,param_2,0);
  return;
}



void FUN_18000c82c(void)

{
  undefined8 *puVar1;
  
  puVar1 = (undefined8 *)PTR_LOOP_18004a7b8;
  if ((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) {
    for (; puVar1 != (undefined8 *)0x0; puVar1 = (undefined8 *)*puVar1) {
      if (puVar1[1] != 0) {
        UnregisterTraceGuids();
        puVar1[1] = 0;
      }
    }
    PTR_LOOP_18004a7b8 = (undefined *)&PTR_LOOP_18004a7b8;
  }
  return;
}



undefined8 FUN_18000c87c(int param_1,longlong param_2,undefined4 *param_3,undefined8 param_4)

{
  undefined1 uVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  
  *param_3 = 0;
  if (param_1 == 4) {
    uVar3 = GetTraceLoggerHandle(param_4);
    uVar1 = GetTraceEnableLevel(uVar3);
    uVar2 = GetTraceEnableFlags(uVar3);
  }
  else {
    if (param_1 != 5) {
      return 0x57;
    }
    uVar3 = 0;
    uVar2 = 0;
    uVar1 = 0;
  }
  if (((*(byte *)(param_2 + 0x1a) & 2) != 0) && (*(longlong *)(param_2 + 0x10) != 0)) {
    param_2 = *(longlong *)(param_2 + 0x10);
  }
  *(undefined8 *)(param_2 + 0x10) = uVar3;
  *(undefined1 *)(param_2 + 0x19) = uVar1;
  *(undefined4 *)(param_2 + 0x1c) = uVar2;
  return 0;
}



void FUN_18000c8fc(void)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  undefined8 local_18;
  undefined8 local_10;
  
  puVar2 = &DAT_18004c110;
  for (puVar1 = (undefined8 *)PTR_LOOP_18004a7b8; puVar1 != (undefined8 *)0x0;
      puVar1 = (undefined8 *)*puVar1) {
    local_18 = *puVar2;
    local_10 = 0;
    puVar2 = puVar2 + 1;
    puVar1[4] = local_18;
    RegisterTraceGuidsW(FUN_18000c87c,puVar1,local_18,1,&local_18,0,0,puVar1 + 1);
  }
  return;
}



undefined8 FUN_18000c974(undefined8 param_1)

{
  undefined8 *puVar1;
  
  puVar1 = (undefined8 *)(*DAT_18004c528)(DAT_18004c910,param_1,PTR_DAT_18004a7e0);
  return *puVar1;
}



uint FUN_18000c998(undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
  uint uVar1;
  longlong local_res20;
  
  uVar1 = FUN_18000cce0(param_2,param_3,&local_res20);
  if (-1 < (int)uVar1) {
    uVar1 = FUN_18000cab0(local_res20);
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 1) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),10,&DAT_18003e200);
  }
  return uVar1;
}



void FUN_18000ca00(undefined8 *param_1)

{
  int *piVar1;
  
  *param_1 = &PTR_FUN_18003e240;
  param_1[1] = &PTR_FUN_18003e248;
  param_1[2] = &PTR_FUN_18003e258;
  if (param_1[10] != 0) {
    piVar1 = (int *)(param_1[10] + 8);
    LOCK();
    *piVar1 = *piVar1 + -1;
    UNLOCK();
    if ((*piVar1 == 0) && (piVar1 != (int *)0x0)) {
      thunk_FUN_18001fcb8(piVar1);
    }
  }
  *param_1 = &PTR_FUN_18003e238;
  return;
}



undefined8 * FUN_18000ca58(undefined8 *param_1,byte param_2)

{
  *param_1 = &PTR_FUN_18003e238;
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



undefined8 * FUN_18000ca80(undefined8 *param_1,uint param_2)

{
  FUN_18000ca00(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



uint FUN_18000cab0(longlong param_1)

{
  uint uVar1;
  int iVar2;
  LSTATUS LVar3;
  short *psVar4;
  uint local_res8 [2];
  HKEY local_res10;
  DWORD local_res18 [2];
  HKEY local_res20;
  short local_38 [8];
  
  *(undefined4 *)(param_1 + 0x5c) = 2;
  uVar1 = FUN_180019704(*(longlong *)(param_1 + 0x18),param_1,(undefined8 *)(param_1 + 0x20));
  if (-1 < (int)uVar1) {
    uVar1 = 0;
  }
  local_res8[0] = 0xffffffff;
  local_res10 = (HKEY)0x0;
  iVar2 = (*DAT_18004c1e0)(DAT_18004c910,*(undefined8 *)(param_1 + 0x18),1,0x20019,0,&local_res10);
  if (-1 < iVar2) {
    psVar4 = FUN_18001ba38(local_38,L"IgnoreOTA");
    iVar2 = (*DAT_18004c5b8)(DAT_18004c910,local_res10,psVar4,local_res8);
    if (-1 < iVar2) {
      *(uint *)(param_1 + 0x3c) = (uint)(local_res8[0] != 0);
    }
    psVar4 = FUN_18001ba38(local_38,L"LowerIoInterface");
    iVar2 = (*DAT_18004c5b8)(DAT_18004c910,local_res10,psVar4,local_res8);
    if (iVar2 < 0) {
      local_res8[0] = 0xffffffff;
    }
    else {
      local_res8[0] = (uint)(local_res8[0] != 0);
    }
    (*DAT_18004c578)(DAT_18004c910,local_res10);
  }
  if (local_res8[0] == 0xffffffff) {
    LVar3 = RegOpenKeyExW((HKEY)0xffffffff80000002,
                          L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WUDF\\Services\\EgisTouchFP0575"
                          ,0,0x20019,&local_res20);
    if (LVar3 == 0) {
      local_res18[0] = 4;
      LVar3 = RegQueryValueExW(local_res20,L"LowerIoInterface",(LPDWORD)0x0,(LPDWORD)0x0,
                               (LPBYTE)&local_res10,local_res18);
      RegCloseKey(local_res20);
      if ((LVar3 == 0) && ((int)local_res10 != 0)) {
        if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
           (((PTR_LOOP_18004a7b8[0x1c] & 2) != 0 && (3 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xf,&DAT_18003e210);
        }
        local_res8[0] = (uint)((int)local_res10 != 0);
      }
    }
  }
  if (local_res8[0] == 1) {
    uVar1 = (*DAT_18004c228)(DAT_18004c910,*(undefined8 *)(param_1 + 0x18),&DAT_18003e138,0);
    if (-1 < (int)uVar1) {
      (*DAT_18004c230)(DAT_18004c910,*(undefined8 *)(param_1 + 0x18),&DAT_18003e138,0,1);
      *(undefined4 *)(param_1 + 0x38) = 1;
    }
  }
  else if (-1 < (int)uVar1) {
    uVar1 = FUN_18001db48(*(undefined8 *)(param_1 + 0x18),param_1,(undefined8 *)(param_1 + 0x50));
  }
  return uVar1;
}



uint FUN_18000cce0(undefined8 param_1,undefined8 param_2,undefined8 *param_3)

{
  undefined8 *puVar1;
  uint uVar2;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),10,&DAT_18003e210);
  }
  puVar1 = (undefined8 *)FUN_180020780(0x60);
  if (puVar1 == (undefined8 *)0x0) {
    puVar1 = (undefined8 *)0x0;
  }
  else {
    puVar1[3] = 0;
    puVar1[4] = 0;
    puVar1[5] = 0;
    puVar1[6] = 0;
    *(undefined4 *)(puVar1 + 7) = 0;
    *(undefined4 *)((longlong)puVar1 + 0x3c) = 0;
    *(undefined4 *)(puVar1 + 8) = 0;
    puVar1[9] = 0;
    puVar1[10] = 0;
    *(undefined4 *)(puVar1 + 0xb) = 0;
    *(undefined4 *)((longlong)puVar1 + 0x5c) = 0;
    *puVar1 = &PTR_FUN_18003e240;
    puVar1[1] = &PTR_FUN_18003e248;
    puVar1[2] = &PTR_FUN_18003e258;
  }
  uVar2 = ~-(uint)(puVar1 != (undefined8 *)0x0) & 0xc000009a;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18001f904(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xb,&DAT_18003e210,puVar1);
  }
  if (-1 < (int)uVar2) {
    uVar2 = FUN_18000d0a8((longlong)puVar1,param_1,param_2);
    if ((int)uVar2 < 0) {
      if (puVar1 != (undefined8 *)0x0) {
        (**(code **)*puVar1)(puVar1,1);
      }
    }
    else {
      *param_3 = puVar1;
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xc,&DAT_18003e210);
  }
  return uVar2;
}



void FUN_18000ce6c(undefined8 param_1)

{
  undefined8 *puVar1;
  
  puVar1 = (undefined8 *)FUN_18000d084(param_1);
  if (puVar1 != (undefined8 *)0x0) {
    (**(code **)*puVar1)(puVar1,1);
  }
  return;
}



void FUN_18000ce90(undefined8 param_1,undefined4 param_2)

{
  longlong lVar1;
  
  lVar1 = FUN_18000d084(param_1);
                    // WARNING: Could not recover jumptable at 0x00018000cebb. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)**(undefined8 **)(lVar1 + 0x10))((undefined8 *)(lVar1 + 0x10),param_1,param_2);
  return;
}



void FUN_18000cec0(undefined8 param_1,undefined4 param_2)

{
  longlong lVar1;
  
  lVar1 = FUN_18000d084(param_1);
                    // WARNING: Could not recover jumptable at 0x00018000ceeb. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(longlong *)(lVar1 + 0x10) + 8))((longlong *)(lVar1 + 0x10),param_1,param_2);
  return;
}



void FUN_18000cef0(undefined8 param_1)

{
  longlong lVar1;
  
  lVar1 = FUN_18000d084(param_1);
                    // WARNING: Could not recover jumptable at 0x00018000cf0d. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)**(undefined8 **)(lVar1 + 8))((undefined8 *)(lVar1 + 8),param_1);
  return;
}



void FUN_18000cf10(undefined8 param_1)

{
  longlong lVar1;
  
  lVar1 = FUN_18000d084(param_1);
                    // WARNING: Could not recover jumptable at 0x00018000cf2d. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(longlong *)(lVar1 + 0x10) + 0x18))((longlong *)(lVar1 + 0x10),param_1);
  return;
}



void FUN_18000cf34(undefined8 param_1)

{
  longlong lVar1;
  
  lVar1 = FUN_18000d084(param_1);
                    // WARNING: Could not recover jumptable at 0x00018000cf51. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(longlong *)(lVar1 + 0x10) + 0x20))((longlong *)(lVar1 + 0x10),param_1);
  return;
}



void FUN_18000cf58(undefined8 param_1)

{
  longlong lVar1;
  
  lVar1 = FUN_18000d084(param_1);
                    // WARNING: Could not recover jumptable at 0x00018000cf75. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(longlong *)(lVar1 + 8) + 8))((longlong *)(lVar1 + 8),param_1);
  return;
}



void FUN_18000cf7c(undefined8 param_1)

{
  longlong lVar1;
  
  lVar1 = FUN_18000d084(param_1);
                    // WARNING: Could not recover jumptable at 0x00018000cf99. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(longlong *)(lVar1 + 0x10) + 0x10))((longlong *)(lVar1 + 0x10),param_1);
  return;
}



undefined8 FUN_18000cfa0(longlong param_1,longlong param_2)

{
  ushort uVar1;
  LPCWSTR lpString;
  int iVar2;
  LPWSTR pWVar3;
  
  lpString = *(LPCWSTR *)(*(longlong *)(param_1 + 0x28) + 0x58);
  if (lpString != (LPCWSTR)0x0) {
    iVar2 = lstrlenW(lpString);
    if (iVar2 < 0x100) {
      lstrcpyW((LPWSTR)(param_2 + 0x41c),*(LPCWSTR *)(*(longlong *)(param_1 + 0x28) + 0x58));
    }
  }
  uVar1 = *(ushort *)(*(longlong *)(param_1 + 0x28) + 0x4c);
  if (0x103f < (uVar1 & 0xfff0)) {
    *(uint *)(param_2 + 0x61c) = (uint)(uVar1 >> 0xc);
    *(uint *)(param_2 + 0x620) = *(ushort *)(*(longlong *)(param_1 + 0x28) + 0x4c) >> 8 & 0xf;
    pWVar3 = StrStrIW((LPCWSTR)(param_2 + 0x21c),L" Rev");
    if (pWVar3 == (LPWSTR)0x0) {
      iVar2 = lstrlenW((LPCWSTR)(param_2 + 0x21c));
      wsprintfW((LPWSTR)(param_2 + ((longlong)iVar2 + 0x10e) * 2),L" Rev%d");
    }
  }
  return 0;
}



undefined8 FUN_18000d084(undefined8 param_1)

{
  undefined8 *puVar1;
  
  puVar1 = (undefined8 *)(*DAT_18004c528)(DAT_18004c910,param_1,PTR_DAT_18004a808);
  return *puVar1;
}



int FUN_18000d0a8(longlong param_1,undefined8 param_2,undefined8 param_3)

{
  undefined8 uVar1;
  int iVar2;
  longlong *plVar3;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined4 local_e8 [2];
  code *local_e0;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined *local_b8;
  undefined4 local_a8 [2];
  code *local_a0;
  code *local_90;
  code *local_80;
  code *local_78;
  code *local_48;
  code *local_40;
  code *local_38;
  
  local_res18 = param_3;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xd,&DAT_18003e210);
  }
  uVar1 = local_res18;
  FUN_180020400((undefined1 (*) [16])local_a8,0,0x90);
  local_a0 = FUN_18000ce90;
  local_90 = FUN_18000cec0;
  local_48 = FUN_18000cf7c;
  local_a8[0] = 0x90;
  local_40 = FUN_18000cf10;
  local_38 = FUN_18000cf34;
  local_80 = FUN_18000cef0;
  local_78 = FUN_18000cf58;
  (*DAT_18004c1f8)(DAT_18004c910,uVar1,1);
  (*DAT_18004c1e8)(DAT_18004c910,local_res18,local_a8);
  (*DAT_18004c200)(DAT_18004c910,local_res18,2);
  FUN_180020400((undefined1 (*) [16])local_e8,0,0x38);
  local_b8 = PTR_DAT_18004a808;
  local_e8[0] = 0x38;
  local_e0 = FUN_18000ce6c;
  local_d0 = 1;
  local_cc = 1;
  iVar2 = (*DAT_18004c218)(DAT_18004c910,&local_res18,local_e8,&local_res20);
  if (-1 < iVar2) {
    plVar3 = (longlong *)(*DAT_18004c528)(DAT_18004c910,local_res20,PTR_DAT_18004a808);
    *plVar3 = param_1;
    *(undefined8 *)(param_1 + 0x18) = local_res20;
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xe,&DAT_18003e210);
  }
  return iVar2;
}



undefined8 FUN_18000d268(longlong param_1,undefined8 param_2,int param_3)

{
  ULONGLONG UVar1;
  
  if (*(int *)(param_1 + 0x28) == 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1f,&DAT_18003e210,param_3);
    }
    if ((*(int *)(param_1 + 0x48) == 3) ||
       ((1 < *(int *)(param_1 + 0x48) && (*(int *)(*(longlong *)(param_1 + 0x18) + 0x3c) == 4)))) {
      UVar1 = GetTickCount64();
      *(ULONGLONG *)(*(longlong *)(param_1 + 0x40) + 0x80) = UVar1;
      *(undefined4 *)(*(longlong *)(param_1 + 0x40) + 0x88) = *(undefined4 *)(param_1 + 0x48);
    }
    FUN_18001cad0(*(longlong **)(param_1 + 0x20),param_3,1,1);
    if (1 < *(int *)(param_1 + 0x48)) {
      FUN_18001a30c(*(longlong *)(param_1 + 0x10));
    }
    *(undefined4 *)(param_1 + 0x48) = 0;
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x20,&DAT_18003e210,param_3);
    }
  }
  else {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1d,&DAT_18003e210,param_3);
    }
    if (1 < *(int *)(param_1 + 0x48)) {
      FUN_18001a30c(*(longlong *)(param_1 + 0x10));
    }
    *(undefined4 *)(param_1 + 0x48) = 0;
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1e,&DAT_18003e210,param_3);
    }
  }
  return 0;
}



undefined8 FUN_18000d404(longlong param_1,undefined8 param_2,int param_3)

{
  int iVar1;
  
  if (*(int *)(param_1 + 0x28) == 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x23,&DAT_18003e210,param_3);
    }
    iVar1 = (*DAT_18004c298)(DAT_18004c910,param_2);
    *(int *)(param_1 + 0x48) = iVar1;
    if (iVar1 < 2) {
      FUN_18001cad0(*(longlong **)(param_1 + 0x20),1,param_3,1);
    }
    else {
      FUN_18001a268(*(longlong *)(param_1 + 0x10));
      FUN_18001cad0(*(longlong **)(param_1 + 0x20),1,param_3,0);
      FUN_180019648(*(longlong *)(param_1 + 0x10),2000);
    }
    if (((*(int *)(param_1 + 0x48) == 3) && (*(int *)(*(longlong *)(param_1 + 0x18) + 0x3c) == 3))
       || ((1 < *(int *)(param_1 + 0x48) && (*(int *)(*(longlong *)(param_1 + 0x18) + 0x3c) == 4))))
    {
      *(undefined8 *)(*(longlong *)(param_1 + 0x40) + 0x90) = 0;
      *(undefined4 *)(*(longlong *)(param_1 + 0x40) + 0x9c) = 0;
    }
    if ((2 < *(int *)(param_1 + 0x4c)) && (*(int *)(param_1 + 0x30) != 0)) {
      *(undefined4 *)(param_1 + 0x30) = 0;
      (**(code **)(**(longlong **)(param_1 + 0x20) + 0x40))();
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x24,&DAT_18003e210,param_3);
    }
  }
  else {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x21,&DAT_18003e210,param_3);
    }
    iVar1 = (*DAT_18004c298)(DAT_18004c910,param_2);
    *(int *)(param_1 + 0x48) = iVar1;
    if (1 < iVar1) {
      FUN_18001a268(*(longlong *)(param_1 + 0x10));
      FUN_180019648(*(longlong *)(param_1 + 0x10),2000);
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x22,&DAT_18003e210,param_3);
    }
  }
  return 0;
}



void FUN_18000d634(longlong param_1,undefined8 param_2)

{
  int iVar1;
  uint local_res18 [2];
  undefined1 local_res20 [8];
  undefined8 local_38;
  undefined4 local_30 [2];
  undefined8 local_28;
  undefined *local_20;
  undefined8 local_18;
  
  iVar1 = (*DAT_18004c698)(DAT_18004c910,param_2,0,&local_38,local_30);
  if (iVar1 < 0) {
    iVar1 = -0x7ff8ffa9;
  }
  else {
    local_res18[0] = 0;
    local_18 = 0;
    local_28 = 0x18;
    local_20 = &DAT_18003e220;
    iVar1 = (*DAT_18004c300)(DAT_18004c910,*(undefined8 *)(param_1 + 0x18),&local_28,local_30[0],
                             local_38,local_res18,local_res20);
    if (-1 < iVar1) {
      (*DAT_18004c670)(DAT_18004c910,param_2,iVar1,(ulonglong)local_res18[0] * 2);
      return;
    }
  }
  (*DAT_18004c668)(DAT_18004c910,param_2,iVar1);
  return;
}



void FUN_18000d70c(longlong param_1,longlong param_2)

{
  int iVar1;
  int iVar2;
  uint local_res8 [4];
  int local_res18 [2];
  uint local_res20;
  undefined4 uStackX_24;
  ulonglong local_58;
  undefined8 *local_50;
  undefined8 *local_48;
  longlong local_40;
  longlong local_38 [2];
  
  FUN_18001b30c(param_2,local_res18,&local_40,&local_58,local_38,(undefined8 *)&local_res20);
  iVar2 = -0x3ffffff3;
  local_res8[0] = 0;
  (*DAT_18004c270)(DAT_18004c910,*(undefined8 *)(param_1 + 0x18),0);
  if (local_res18[0] == 0x222018) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2b,&DAT_18003e210);
    }
    if ((local_38[0] == 0) || (CONCAT44(uStackX_24,local_res20) == 0)) goto LAB_18000daa4;
    iVar2 = 0;
    local_40 = local_38[0];
LAB_18000da8b:
    iVar1 = 1;
  }
  else {
    if (local_res18[0] == 0x22201c) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2c,&DAT_18003e210);
      }
LAB_18000d84f:
      if ((local_40 == 0) || (local_58 == 0)) goto LAB_18000daa4;
      iVar2 = 1;
      goto LAB_18000da8b;
    }
    iVar1 = 0;
    if (local_res18[0] == 0x222020) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2d,&DAT_18003e210);
      }
      if (((local_58 == 8) && (local_38[0] != 0)) && (CONCAT44(uStackX_24,local_res20) != 0)) {
        FUN_18001b224(param_2,local_res18,&local_50,&local_58,&local_48,(undefined8 *)&local_res20);
        if (local_58 < CONCAT44(uStackX_24,local_res20)) {
          FUN_18001fe80(local_48,local_50,local_58);
          iVar2 = FUN_18001a820(*(undefined8 **)(param_1 + 0x28),local_48,local_res20,0,0,0,
                                local_res8);
        }
        else {
          iVar2 = FUN_18001a820(*(undefined8 **)(param_1 + 0x28),local_50,local_res20,0,0,0,
                                local_res8);
          if ((-1 < iVar2) && (local_res8[0] != 0)) {
            FUN_18001fe80(local_48,local_50,(ulonglong)local_res8[0]);
          }
        }
      }
      goto LAB_18000daa4;
    }
    if (local_res18[0] != 0x222024) {
      if (local_res18[0] != 0x222028) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x30,&DAT_18003e210,
                        local_res18[0]);
        }
        iVar2 = -0x3ffffff0;
        goto LAB_18000daa4;
      }
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2f,&DAT_18003e210);
      }
      if ((local_38[0] != 0) && (CONCAT44(uStackX_24,local_res20) != 0)) {
        iVar1 = FUN_18001a980(*(undefined8 **)(param_1 + 0x28),param_2,local_38[0],(longlong *)0x0,1
                              ,0,0,local_res8);
      }
      iVar2 = iVar1;
      if (iVar1 < 0) goto LAB_18000daa4;
      goto LAB_18000d84f;
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2e,&DAT_18003e210);
    }
    if ((local_40 == 0) || (local_58 == 0)) goto LAB_18000daa4;
    iVar2 = 1;
    iVar1 = 0;
  }
  iVar2 = FUN_18001a980(*(undefined8 **)(param_1 + 0x28),param_2,local_40,(longlong *)0x0,iVar1,
                        iVar2,0,local_res8);
LAB_18000daa4:
  (*DAT_18004c278)(DAT_18004c910,*(undefined8 *)(param_1 + 0x18));
  (*DAT_18004c670)(DAT_18004c910,param_2,iVar2,local_res8[0]);
  return;
}



// WARNING: Type propagation algorithm not settling

void FUN_18000dad8(longlong param_1,undefined8 param_2)

{
  int *piVar1;
  LPCWSTR pWVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  wchar_t *hMem;
  undefined8 *puVar6;
  wchar_t *pwVar7;
  wchar_t *pwVar8;
  ULONGLONG UVar9;
  LPWSTR pWVar10;
  wchar_t *pwVar11;
  undefined1 auStack_768 [32];
  wchar_t *local_748;
  uint *local_740;
  undefined1 *local_738;
  longlong *local_730;
  longlong local_728;
  uint local_720;
  uint local_71c;
  undefined1 local_718 [4];
  int local_714;
  int local_710 [2];
  longlong local_708 [2];
  undefined *local_6f8;
  undefined8 local_6f0;
  wchar_t local_6e8 [4];
  undefined1 *local_6e0;
  undefined4 local_6d8 [2];
  wchar_t *local_6d0;
  undefined4 local_6c8 [2];
  wchar_t *local_6c0;
  undefined1 local_6b8 [16];
  undefined1 local_6a8 [16];
  wchar_t local_698 [16];
  wchar_t local_678 [16];
  WCHAR local_658 [264];
  WCHAR local_448 [264];
  undefined1 local_238 [512];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_768;
  pwVar8 = (wchar_t *)0x0;
  iVar5 = 0;
  local_6f0 = 0;
  *(undefined4 *)(param_1 + 0x54) = 1;
  local_708[1] = 0x18;
  local_6f8 = &DAT_18003e220;
  local_738 = local_718;
  local_740 = &local_71c;
  pwVar11 = (wchar_t *)0x0;
  local_748 = (wchar_t *)0x0;
  local_71c = 0;
  iVar3 = (*DAT_18004c300)(DAT_18004c910,param_2,local_708 + 1,0);
  if (iVar3 == -0x3fffffdd) {
    hMem = (wchar_t *)LocalAlloc(0,(ulonglong)local_71c);
    if (hMem == (wchar_t *)0x0) {
      iVar3 = -0x3fffff66;
      goto LAB_18000e3f0;
    }
    local_738 = local_718;
    local_740 = &local_71c;
    local_748 = hMem;
    iVar3 = (*DAT_18004c300)(DAT_18004c910,param_2,local_708 + 1,local_71c);
    if (-1 < iVar3) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7dc(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x12,&DAT_18003e210,hMem);
      }
      goto LAB_18000dc9d;
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x11,&DAT_18003e210,iVar3);
    }
  }
  else {
    hMem = pwVar8;
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        (hMem = pwVar11, (PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) &&
       (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x10,&DAT_18003e210,iVar3);
    }
LAB_18000dc9d:
    local_6f0 = 0;
    local_6f8 = &DAT_18003e220;
    local_738 = local_718;
    local_720 = 0;
    local_740 = &local_720;
    local_708[1] = 0x18;
    local_748 = (wchar_t *)0x0;
    iVar3 = (*DAT_18004c300)(DAT_18004c910,param_2,local_708 + 1,0);
    if (iVar3 == -0x3fffffdd) {
      pwVar11 = (wchar_t *)LocalAlloc(0,(ulonglong)local_720);
      if (pwVar11 != (wchar_t *)0x0) {
        local_738 = local_718;
        local_740 = &local_720;
        local_748 = pwVar11;
        iVar3 = (*DAT_18004c300)(DAT_18004c910,param_2,local_708 + 1,local_720);
        if (-1 < iVar3) {
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000e7dc(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x15,&DAT_18003e210,pwVar11);
          }
          goto LAB_18000de26;
        }
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x14,&DAT_18003e210,iVar3);
        }
        goto LAB_18000e3c6;
      }
      iVar3 = -0x3fffff66;
    }
    else {
      pwVar11 = pwVar8;
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          (pwVar11 = (LPCWSTR)0x0, (PTR_LOOP_18004a7b8[0x1c] & 2) != 0)) &&
         (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x13,&DAT_18003e210,iVar3);
        pwVar11 = pwVar8;
      }
LAB_18000de26:
      if (iVar3 < 0) {
LAB_18000de76:
        if (*(int *)(param_1 + 0x30) == 0) {
          if (-1 < iVar3) {
            if (*(int *)(*(longlong *)(param_1 + 0x20) + 0x3c) == 4) {
              if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                  ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19]))
              {
                FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x16,&DAT_18003e210);
              }
              puVar6 = (undefined8 *)FUN_180020780(0x8838);
              if (puVar6 != (undefined8 *)0x0) {
                pwVar8 = (wchar_t *)
                         FUN_1800154fc(puVar6,*(longlong *)(param_1 + 0x20),
                                       *(undefined8 *)(param_1 + 0x10));
              }
              *(wchar_t **)(param_1 + 0x28) = pwVar8;
            }
            if (*(longlong *)(param_1 + 0x28) == 0) {
              iVar3 = -0x3fffff66;
              goto LAB_18000e3c6;
            }
            *(longlong *)(*(longlong *)(param_1 + 0x18) + 0x68) = *(longlong *)(param_1 + 0x28);
            if (*(longlong *)(param_1 + 0x48) != 0) {
              *(longlong *)(*(longlong *)(param_1 + 0x18) + 0x70) = *(longlong *)(param_1 + 0x48);
              LOCK();
              piVar1 = (int *)(*(longlong *)(*(longlong *)(param_1 + 0x18) + 0x70) + 8);
              *piVar1 = *piVar1 + 1;
              UNLOCK();
              *(undefined8 *)(*(longlong *)(param_1 + 0x48) + 0x78) =
                   *(undefined8 *)(param_1 + 0x28);
              UVar9 = GetTickCount64();
              *(ULONGLONG *)(*(longlong *)(param_1 + 0x48) + 0x80) = UVar9;
              *(undefined4 *)(*(longlong *)(param_1 + 0x48) + 0x88) = 0;
              *(undefined8 *)(*(longlong *)(param_1 + 0x48) + 0x90) = 0;
              *(undefined4 *)(*(longlong *)(param_1 + 0x48) + 0x9c) = 0;
            }
          }
          local_740 = (uint *)&local_728;
          local_728 = 0;
          local_708[0] = 0;
          local_748 = (wchar_t *)0x0;
          iVar3 = (*DAT_18004c1e0)(DAT_18004c910,param_2,0x101,0x2001b);
          iVar4 = local_710[0];
          if (-1 < iVar3) {
            builtin_wcsncpy(local_678 + 8,L"eOnly",6);
            local_6c0 = local_678;
            builtin_wcsncpy(local_678,L"OneDevic",8);
            local_6c8[0] = 0x1c001a;
            iVar4 = (*DAT_18004c5b8)(DAT_18004c910,local_728,local_6c8,local_710);
            if ((iVar4 < 0) || (local_710[0] == 0)) {
              pWVar2 = *(LPCWSTR *)(*(longlong *)(param_1 + 0x20) + 0x58);
              if ((pWVar2 == (LPCWSTR)0x0) ||
                 (pWVar10 = StrStrIW(pwVar11,pWVar2), pWVar10 != (LPWSTR)0x0)) {
                local_708[0] = local_728;
                local_728 = 0;
              }
              else {
                wsprintfW(local_448,L"EgisTouchFP\\%s");
                RtlInitUnicodeString(local_6b8,local_448);
                local_730 = local_708;
                local_738 = (undefined1 *)0x0;
                local_740 = (uint *)0x0;
                local_748 = (wchar_t *)((ulonglong)local_748 & 0xffffffff00000000);
                iVar3 = (*DAT_18004c570)(DAT_18004c910,local_728,local_6b8,0x10000000);
              }
            }
            else {
              pWVar2 = *(LPCWSTR *)(*(longlong *)(param_1 + 0x20) + 0x58);
              iVar5 = 0;
              if ((pWVar2 != (LPCWSTR)0x0) &&
                 (pWVar10 = StrStrIW(pwVar11,pWVar2), pWVar10 == (LPWSTR)0x0)) {
                builtin_wcsncpy(local_698 + 8,L"mber",5);
                builtin_wcsncpy(local_698,L"SerialNu",8);
                local_6d0 = local_698;
                local_6e0 = local_238;
                local_6d8[0] = 0x1a0018;
                local_748 = local_6e8;
                local_6e8[0] = L'\0';
                local_6e8[1] = L'';
                iVar5 = (*DAT_18004c5a8)(DAT_18004c910,local_728,local_6d8,0);
                if (-1 < iVar5) {
                  RtlInitUnicodeString
                            (local_6a8,*(undefined8 *)(*(longlong *)(param_1 + 0x20) + 0x58));
                  iVar4 = RtlCompareUnicodeString(local_6e8,local_6a8,0);
                  if (iVar4 != 0) {
                    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) &&
                       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
                      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x17,&DAT_18003e210);
                    }
                    iVar5 = -0x3fffffff;
                  }
                  if (-1 < iVar5) goto LAB_18000e13f;
                }
                RtlInitUnicodeString
                          (local_6e8,*(undefined8 *)(*(longlong *)(param_1 + 0x20) + 0x58));
                (*DAT_18004c5d8)(DAT_18004c910,local_728,local_6d8,local_6e8);
              }
LAB_18000e13f:
              local_708[0] = local_728;
              local_728 = 0;
            }
            iVar4 = iVar5;
            if (-1 < iVar3) {
              iVar3 = (**(code **)(**(longlong **)(param_1 + 0x28) + 0x30))
                                (*(longlong **)(param_1 + 0x28),local_708,local_728);
            }
          }
          if (local_728 != 0) {
            (*DAT_18004c578)(DAT_18004c910);
          }
          if (local_708[0] != 0) {
            (*DAT_18004c578)(DAT_18004c910);
          }
          if (iVar3 < 0) {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x18,&DAT_18003e210);
            }
          }
          else {
            wsprintfW(local_658,
                      L"SYSTEM\\CurrentControlSet\\Enum\\%s\\Device Parameters\\EgisTouchFP0575");
            FUN_18000677c((longlong *)(*(longlong *)(param_1 + 0x28) + 0x10),local_658);
            if (*(int *)(param_1 + 0x34) == 0) {
              local_714 = 0;
              iVar5 = (**(code **)(**(longlong **)(param_1 + 0x28) + 0x108))
                                (*(longlong **)(param_1 + 0x28),PTR_IMAGE_DOS_HEADER_18004a7c0,
                                 &local_714,1);
              if (iVar5 != 0x103) {
                if ((iVar5 < 0) && (local_714 == 0)) {
                  iVar3 = -0x3fffffa8;
                  goto LAB_18000e3c6;
                }
                goto LAB_18000e2fb;
              }
              if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                  ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (2 < (byte)PTR_LOOP_18004a7b8[0x19]))
              {
                FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1a,&DAT_18003e210);
              }
              iVar5 = (**(code **)(**(longlong **)(param_1 + 0x28) + 0x110))();
              if ((iVar5 < 0) && (local_714 != 0)) goto LAB_18000e2fb;
            }
            else {
              if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                 (((PTR_LOOP_18004a7b8[0x1c] & 2) != 0 && (2 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
                FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x19,&DAT_18003e210);
              }
LAB_18000e2fb:
              iVar5 = (**(code **)(**(longlong **)(param_1 + 0x28) + 0x38))();
              if (iVar5 == 1) {
                *(undefined4 *)(param_1 + 0x38) = 1;
                if ((iVar4 < 0) ||
                   (iVar5 = (**(code **)(**(longlong **)(param_1 + 0x28) + 0x68))(), iVar5 == 0)) {
                  (**(code **)(**(longlong **)(param_1 + 0x28) + 0x70))();
                }
                else {
                  (**(code **)(**(longlong **)(param_1 + 0x28) + 0x78))();
                }
                iVar3 = (*DAT_18004c228)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),
                                         &DAT_18003e168,0);
                if (-1 < iVar3) {
                  local_748 = (wchar_t *)CONCAT71(local_748._1_7_,1);
                  (*DAT_18004c230)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),&DAT_18003e168,0);
                }
                goto LAB_18000e3c6;
              }
            }
            iVar3 = -0x3fffffff;
          }
        }
      }
      else {
        puVar6 = (undefined8 *)FUN_180020780(0x70);
        pwVar7 = pwVar8;
        if (puVar6 != (undefined8 *)0x0) {
          pwVar7 = (wchar_t *)FUN_18001a3c0(puVar6,*(undefined8 *)(param_1 + 0x10));
        }
        *(wchar_t **)(param_1 + 0x20) = pwVar7;
        if (pwVar7 == (wchar_t *)0x0) {
          iVar3 = -0x3fffff66;
        }
        else {
          iVar3 = FUN_18001ab04((undefined8 *)pwVar7);
          if (-1 < iVar3) goto LAB_18000de76;
        }
      }
LAB_18000e3c6:
      if (pwVar11 != (wchar_t *)0x0) {
        LocalFree(pwVar11);
      }
    }
  }
  if (hMem != (wchar_t *)0x0) {
    LocalFree(hMem);
  }
LAB_18000e3f0:
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1b,&DAT_18003e210,iVar3);
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStack_768);
  return;
}



undefined8 FUN_18000e4c0(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x27,&DAT_18003e210);
  }
  FUN_18000e738(param_1 + -0x10,3);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x28,&DAT_18003e210);
  }
  return 0;
}



undefined8 FUN_18000e54c(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x29,&DAT_18003e210);
  }
  FUN_18000e738(param_1 + -0x10,4);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2a,&DAT_18003e210);
  }
  return 0;
}



undefined8 FUN_18000e5d8(longlong param_1)

{
  undefined8 *puVar1;
  LPVOID pvVar2;
  
  FUN_18000e738(param_1 + -8,6);
  if (*(longlong *)(param_1 + 0x28) != 0) {
    FUN_1800066ec((longlong *)(*(longlong *)(param_1 + 0x28) + 0x10));
    if (*(int *)(param_1 + 0x38) != 0) {
      (**(code **)(**(longlong **)(param_1 + 0x28) + 0x40))();
    }
    puVar1 = *(undefined8 **)(param_1 + 0x28);
    if (puVar1 != (undefined8 *)0x0) {
      (**(code **)*puVar1)(puVar1,1);
    }
    *(undefined8 *)(param_1 + 0x28) = 0;
  }
  pvVar2 = *(LPVOID *)(param_1 + 0x20);
  if (pvVar2 != (LPVOID)0x0) {
    FUN_18001a3f8((longlong)pvVar2);
    thunk_FUN_18001fcb8(pvVar2);
    *(undefined8 *)(param_1 + 0x20) = 0;
  }
  if (*(longlong *)(param_1 + 0x48) != 0) {
    FUN_18001dd88(*(longlong *)(param_1 + 0x48));
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1c,&DAT_18003e210);
  }
  return 0;
}



void FUN_18000e69c(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x25,&DAT_18003e210);
  }
  FUN_18000e738(param_1 + -0x10,5);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x26,&DAT_18003e210);
  }
  return;
}



void FUN_18000e724(longlong param_1,int param_2)

{
  longlong lVar1;
  
  lVar1 = *(longlong *)(param_1 + 0x20);
  if (param_2 == 0) {
    FUN_18001a2c4(lVar1);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(lVar1 + 0x28));
  *(int *)(lVar1 + 0x50) = *(int *)(lVar1 + 0x50) + 1;
  SetEvent(*(HANDLE *)(lVar1 + 0x60));
                    // WARNING: Could not recover jumptable at 0x000180019aea. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(lVar1 + 0x28));
  return;
}



void FUN_18000e738(longlong param_1,int param_2)

{
  if ((4 < param_2) && (*(int *)(param_1 + 0x5c) < 5)) {
    FUN_18001a4c8(*(longlong *)(param_1 + 0x28),1);
  }
  *(int *)(param_1 + 0x5c) = param_2;
  if ((((2 < param_2) && (*(longlong *)(param_1 + 0x30) != 0)) &&
      (*(longlong *)(param_1 + 0x50) != 0)) &&
     (*(longlong *)(*(longlong *)(param_1 + 0x50) + 0x38) != 0)) {
    FUN_18001bcc8(*(longlong *)(param_1 + 0x30),4);
    WaitForSingleObject(*(HANDLE *)(*(longlong *)(param_1 + 0x50) + 0x70),0xffffffff);
  }
  return;
}



void FUN_18000e7a8(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,0);
  return;
}



void FUN_18000e7dc(undefined8 param_1,undefined2 param_2,undefined8 param_3,wchar_t *param_4)

{
  longlong lVar1;
  
  if (param_4 == (wchar_t *)0x0) {
    lVar1 = 10;
  }
  else if (*param_4 == L'\0') {
    lVar1 = 0xe;
  }
  else {
    lVar1 = -1;
    do {
      lVar1 = lVar1 + 1;
    } while (param_4[lVar1] != L'\0');
    lVar1 = lVar1 * 2 + 2;
  }
  if (param_4 == (wchar_t *)0x0) {
    param_4 = L"NULL";
  }
  else if (*param_4 == L'\0') {
    param_4 = L"<NULL>";
  }
  TraceMessage(param_1,0x2b,param_3,param_2,param_4,lVar1,0);
  return;
}



void FUN_18000e850(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&stack0x00000028,4,0);
  return;
}



undefined8 * FUN_18000e894(undefined8 *param_1,undefined8 param_2,undefined8 param_3)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  HLOCAL pvVar3;
  uint local_res8 [2];
  
  FUN_18001ba70(param_1,param_2,param_3);
  puVar2 = (undefined8 *)0x0;
  *(undefined4 *)(param_1 + 0x87d) = 1;
  *(undefined1 *)((longlong)param_1 + 0x43ec) = 0xd;
  *param_1 = &PTR_FUN_18003e570;
  *(undefined4 *)((longlong)param_1 + 0x43dc) = 0;
  *(undefined4 *)(param_1 + 0x87a) = 0x80;
  *(undefined8 *)((longlong)param_1 + 0x43d4) = 0x80;
  *(undefined4 *)((longlong)param_1 + 0x4614) = 0;
  param_1[0x8c4] = 0;
  *(undefined4 *)(param_1 + 0x87c) = 0x7f;
  *(undefined4 *)((longlong)param_1 + 0x43e4) = 0x7f;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (2 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1d,&DAT_18003e488);
  }
  *(undefined4 *)(param_1 + 0x879) = 0x53494745;
  *(undefined2 *)((longlong)param_1 + 0x43cc) = 0;
  param_1[0x878] = 0;
  *(undefined1 *)((longlong)param_1 + 0x43ce) = 0;
  *(undefined4 *)(param_1 + 0x872) = 0x80000000;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x873));
  FUN_180020400((undefined1 (*) [16])((longlong)param_1 + 0x43ee),0,0x200);
  *(undefined8 *)*(undefined1 (*) [16])((longlong)param_1 + 0x43ee) = 0x67006e00690046;
  builtin_wcsncpy((wchar_t *)((longlong)param_1 + 0x43f6),L"erpr",4);
  builtin_wcsncpy((wchar_t *)((longlong)param_1 + 0x43fe),L"int ",4);
  builtin_wcsncpy((wchar_t *)((longlong)param_1 + 0x4406),L"ET30",4);
  *(undefined4 *)((longlong)param_1 + 0x440e) = 0x30;
  puVar1 = (undefined8 *)FUN_180020780(0x60);
  if (puVar1 != (undefined8 *)0x0) {
    puVar2 = FUN_18000ea0c(puVar1,0x18001bf54,param_1,local_res8);
  }
  param_1[0x8c5] = puVar2;
  *(undefined4 *)(param_1 + 99) = 0x4000;
  pvVar3 = LocalAlloc(0x40,0x4000);
  param_1[0x62] = pvVar3;
  return param_1;
}



undefined8 * FUN_18000ea0c(undefined8 *param_1,longlong param_2,undefined8 param_3,uint *param_4)

{
  uint uVar1;
  
  *param_1 = &PTR_FUN_18003e498;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  param_1[7] = param_2;
  param_1[8] = param_3;
  uVar1 = ~-(uint)(param_2 != 0) & 0xc000000d;
  *(uint *)(param_1 + 1) = uVar1;
  *param_4 = uVar1;
  *param_1 = &PTR_FUN_18003e500;
  if (-1 < (int)*param_4) {
    *(undefined4 *)(param_1 + 9) = 1;
    *(undefined4 *)((longlong)param_1 + 0x4c) = 0x53494745;
  }
  return param_1;
}



void FUN_18000ea94(undefined8 *param_1)

{
  undefined8 *puVar1;
  
  *param_1 = &PTR_FUN_18003e570;
  if (param_1[0x8c4] != 0) {
    (*DAT_18004c578)(DAT_18004c910);
    param_1[0x8c4] = 0;
  }
  if ((HLOCAL)param_1[0x62] != (HLOCAL)0x0) {
    LocalFree((HLOCAL)param_1[0x62]);
    param_1[0x62] = 0;
  }
  puVar1 = (undefined8 *)param_1[0x8c5];
  if (puVar1 != (undefined8 *)0x0) {
    (**(code **)*puVar1)(puVar1,1);
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x873));
  FUN_18001bc00(param_1);
  return;
}



undefined8 * FUN_18000eb14(undefined8 *param_1,uint param_2)

{
  *param_1 = &PTR_FUN_18003e498;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



undefined8 * FUN_18000eb54(undefined8 *param_1,uint param_2)

{
  FUN_18000ea94(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



uint FUN_18000eb84(longlong *param_1)

{
  undefined1 uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  short *psVar7;
  byte bVar8;
  uint uVar9;
  uint unaff_EDI;
  undefined7 uVar11;
  undefined8 uVar10;
  uint uVar12;
  uint uVar13;
  byte bVar14;
  byte local_res8 [8];
  int local_res10;
  int local_res18 [2];
  short local_38 [8];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x2000) != 0)) &&
     (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x48,&DAT_18003e488);
  }
  psVar7 = FUN_18001ba38(local_38,L"RemoteWakeupEnable");
  iVar4 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar7);
  if ((iVar4 < 0) || (uVar6 = 0, local_res10 != 0)) {
    uVar6 = 1;
  }
  uVar11 = (undefined7)((ulonglong)psVar7 >> 8);
  *(undefined4 *)(param_1 + 0x8c3) = uVar6;
  *(undefined1 *)((longlong)param_1 + 0x45f1) = *(undefined1 *)((longlong)param_1 + 0x45ee);
  *(undefined1 *)(param_1 + 0x8be) = *(undefined1 *)((longlong)param_1 + 0x45ef);
  iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],3);
  if (iVar4 < 0) {
    return unaff_EDI;
  }
  uVar10 = CONCAT71(uVar11,(char)param_1[0x8be]);
  iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],9,uVar10);
  if (iVar4 < 0) {
    return unaff_EDI;
  }
  uVar11 = (undefined7)((ulonglong)uVar10 >> 8);
  iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],2);
  if (iVar4 < 0) {
    return unaff_EDI;
  }
  iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                    ((longlong *)param_1[0x8c5],0xc,CONCAT71(uVar11,0xff));
  if (iVar4 < 0) {
    return unaff_EDI;
  }
  iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],0xb,1);
  if (iVar4 < 0) {
    return unaff_EDI;
  }
  bVar8 = 0x50;
  do {
    do {
      iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],8,bVar8);
      if (iVar4 < 0) {
        return unaff_EDI;
      }
      iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 8))
                        ((longlong *)param_1[0x8c5],8,local_res8);
      if (iVar4 < 0) {
        return unaff_EDI;
      }
    } while (bVar8 != local_res8[0]);
    bVar14 = 0;
    iVar4 = 0;
    do {
      Sleep(0x50);
      iVar5 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x48))
                        ((longlong *)param_1[0x8c5],local_res18);
      if (iVar5 < 0) {
        return unaff_EDI;
      }
      if (local_res18[0] != 0) {
        bVar14 = bVar14 + 1;
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < 0x10);
    if (bVar14 < 2) {
      *(byte *)((longlong)param_1 + 0x45f2) = bVar8;
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x2000) != 0)) &&
         (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x49,&DAT_18003e488,0);
      }
      uVar9 = 0;
      uVar12 = 0;
      goto LAB_18000ee63;
    }
    bVar8 = bVar8 + 2;
  } while (bVar8 < 0x60);
  goto LAB_18000ed4b;
LAB_18000ee63:
  do {
    iVar4 = (**(code **)(*param_1 + 0x180))(param_1,0);
    if (iVar4 != 0) {
      uVar9 = uVar9 + 1;
    }
    uVar12 = uVar12 + 1;
    if (uVar9 < 5) {
LAB_18000eecc:
      uVar3 = uVar9;
      if ((8 < uVar12) && (uVar9 == 0)) break;
    }
    else {
      *(char *)((longlong)param_1 + 0x45f2) = *(char *)((longlong)param_1 + 0x45f2) + '\x02';
      uVar13 = 0;
      uVar9 = 0;
      uVar12 = 0;
      uVar3 = uVar9;
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          (uVar12 = uVar13, uVar3 = 0, (*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x2000) != 0)) &&
         (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4a,&DAT_18003e488,
                      (uint)*(byte *)((longlong)param_1 + 0x45f2));
        goto LAB_18000eecc;
      }
    }
    uVar9 = uVar3;
  } while ((char)param_1[5] == '\0');
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x2000) != 0)) &&
     (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4b,&DAT_18003e488,0);
  }
  uVar1 = *(undefined1 *)((longlong)param_1 + 0x45f1);
  psVar7 = FUN_18001ba38(local_38,L"FPS_CTL(Detect)");
  iVar4 = (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar7,uVar1);
  if (-1 < iVar4) {
    lVar2 = param_1[0x8be];
    psVar7 = FUN_18001ba38(local_38,L"PGA_CONTL(Detect)");
    iVar4 = (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar7,(char)lVar2);
    if (-1 < iVar4) {
      uVar1 = *(undefined1 *)((longlong)param_1 + 0x45f2);
      psVar7 = FUN_18001ba38(local_38,L"DETC(Detect)");
      iVar4 = (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar7,uVar1);
      if (-1 < iVar4) {
        uVar6 = (**(code **)(*param_1 + 0x98))(param_1);
        psVar7 = FUN_18001ba38(local_38,L"CALIBRATE_TYPE(Detect)");
        goto LAB_18000ed5e;
      }
    }
  }
LAB_18000ed4b:
  psVar7 = FUN_18001ba38(local_38,L"CALIBRATE_TYPE(Detect)");
  uVar6 = 0;
LAB_18000ed5e:
  (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar7,uVar6);
  (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
            ((longlong *)param_1[0x8c5],3,*(undefined1 *)((longlong)param_1 + 0x45ee));
  (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
            ((longlong *)param_1[0x8c5],9,*(undefined1 *)((longlong)param_1 + 0x45ef));
  (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],2,0xff);
  (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],8,1);
  (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],0xb,0);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x2000) != 0)) &&
     (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4c,&DAT_18003e488);
  }
  return unaff_EDI;
}



undefined8 FUN_18000f024(longlong *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined1 (*pauVar5) [16];
  short *psVar6;
  longlong lVar7;
  int iVar8;
  double dVar9;
  double dVar10;
  short local_58 [24];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x41,&DAT_18003e488);
  }
  pauVar5 = (undefined1 (*) [16])
            FUN_180020780((longlong)((int)param_1[0x87a] * *(int *)((longlong)param_1 + 0x43d4)));
  dVar9 = 0.0;
  FUN_180020400(pauVar5,0,
                (longlong)(int)param_1[0x87a] * (longlong)*(int *)((longlong)param_1 + 0x43d4));
  iVar8 = 0;
  do {
    iVar1 = (**(code **)(*param_1 + 0x168))
                      (param_1,pauVar5,(int)param_1[0x87a],
                       *(undefined4 *)((longlong)param_1 + 0x43d4));
    if (iVar1 != 1) {
      return 0;
    }
    iVar2 = FUN_180005724((longlong)(param_1 + 0x72),(int)param_1[0x87a],(byte *)pauVar5,
                          (int)param_1[0x87a],0x10,0x10);
    iVar1 = (int)param_1[0x87a];
    iVar3 = FUN_180005724((longlong)param_1 + (longlong)(iVar1 + -0x10) + 0x390,iVar1,
                          *pauVar5 + (iVar1 + -0x10),iVar1,0x10,0x10);
    iVar1 = (int)param_1[0x87a];
    lVar7 = (longlong)((*(int *)((longlong)param_1 + 0x43d4) + -0x10) * iVar1);
    iVar4 = FUN_180005724(lVar7 + 0x390 + (longlong)param_1,iVar1,*pauVar5 + lVar7,iVar1,0x10,0x10);
    iVar1 = (int)param_1[0x87a];
    lVar7 = (longlong)(iVar1 + -0x10) +
            (longlong)((*(int *)((longlong)param_1 + 0x43d4) + -0x10) * iVar1);
    iVar1 = FUN_180005724(lVar7 + 0x390 + (longlong)param_1,iVar1,*pauVar5 + lVar7,iVar1,0x10,0x10);
    if (iVar3 < iVar2) {
      iVar3 = iVar2;
    }
    if (iVar1 < iVar4) {
      iVar1 = iVar4;
    }
    if (iVar1 < iVar3) {
      iVar1 = iVar3;
    }
    if (dVar9 < (double)iVar1 * 0.00390625) {
      dVar9 = (double)iVar1 * 0.00390625;
    }
    if (iVar8 == 9) {
      dVar10 = (double)(*(byte *)((longlong)param_1 + 0x45ef) >> 2) + 1.0;
      dVar9 = FUN_180020c80(dVar9);
      *(int *)(param_1 + 0x8c1) = (int)(dVar10 * 0.6 + dVar9 + 1.0);
      *(int *)(param_1 + 0x8c0) = (int)(dVar10 * 0.4 + dVar9 + 1.0);
    }
    iVar8 = iVar8 + 1;
  } while (iVar8 < 10);
  lVar7 = param_1[0x8c1];
  psVar6 = FUN_18001ba38(local_58,L"FingerOnThreshold");
  iVar8 = (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar6,(int)lVar7);
  if (-1 < iVar8) {
    lVar7 = param_1[0x8c0];
    psVar6 = FUN_18001ba38(local_58,L"FingerOnThresholdLoose");
    (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar6,(int)lVar7);
  }
  if (pauVar5 != (undefined1 (*) [16])0x0) {
    thunk_FUN_18001fcb8(pauVar5);
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x42,&DAT_18003e488,(int)param_1[0x8c1]
                 );
  }
  return 0;
}



int FUN_18000f334(longlong *param_1)

{
  int iVar1;
  undefined2 uVar2;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4d,&DAT_18003e488);
  }
  iVar1 = (**(code **)(*param_1 + 0x130))(param_1);
  if (iVar1 < 0) {
    *(undefined4 *)((longlong)param_1 + 0x4614) = 0;
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return iVar1;
    }
    if ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) == 0) {
      return iVar1;
    }
    if ((byte)PTR_LOOP_18004a7b8[0x19] < 2) {
      return iVar1;
    }
    uVar2 = 0x4e;
  }
  else {
    iVar1 = (**(code **)(*param_1 + 0x138))(param_1);
    if (-1 < iVar1) {
      if (*(int *)((longlong)param_1 + 0x45fc) == 0) {
        *(undefined4 *)(param_1 + 0x8c3) = 0;
      }
      else {
        iVar1 = (**(code **)(*param_1 + 0x140))(param_1);
        if (((iVar1 < 0) &&
            (*(undefined4 *)(param_1 + 0x8c3) = 0,
            (undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8)) &&
           (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0 &&
            (2 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x50,&DAT_18003e488);
        }
      }
      *(undefined4 *)((longlong)param_1 + 0x4614) = 1;
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x51,&DAT_18003e488);
      }
      return 0;
    }
    *(undefined4 *)((longlong)param_1 + 0x4614) = 0;
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return iVar1;
    }
    if ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) == 0) {
      return iVar1;
    }
    if ((byte)PTR_LOOP_18004a7b8[0x19] < 2) {
      return iVar1;
    }
    uVar2 = 0x4f;
  }
  FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar2,&DAT_18003e488);
  return iVar1;
}



int FUN_18000f4ac(longlong *param_1)

{
  char *pcVar1;
  byte bVar2;
  undefined1 uVar3;
  int iVar4;
  undefined4 uVar5;
  short *psVar6;
  ulonglong uVar7;
  uint uVar8;
  ulonglong uVar9;
  byte *pbVar10;
  int unaff_ESI;
  char local_res8 [8];
  uint local_res10 [2];
  uint local_res18 [2];
  undefined4 local_res20 [2];
  short local_48 [12];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x43,&DAT_18003e488);
  }
  psVar6 = FUN_18001ba38(local_48,L"FetchImageMode");
  iVar4 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar6,local_res20);
  if (iVar4 < 0) {
LAB_18000f7a1:
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x45,&DAT_18003e488);
    }
  }
  else {
    *(undefined4 *)(param_1 + 0x872) = local_res20[0];
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x44,&DAT_18003e488,local_res20[0]);
    }
    (**(code **)(*(longlong *)param_1[0x8c5] + 0x68))
              ((longlong *)param_1[0x8c5],(int)param_1[0x872]);
    iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],8,1);
    if (((-1 < iVar4) &&
        (iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 8))
                           ((longlong *)param_1[0x8c5],8,local_res8), -1 < iVar4)) &&
       (local_res8[0] == '\x01')) {
      *(undefined2 *)((longlong)param_1 + 0x45ee) = 0x3cfe;
      iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],3,0xfe);
      if ((((-1 < iVar4) &&
           (iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                              ((longlong *)param_1[0x8c5],9,
                               *(undefined1 *)((longlong)param_1 + 0x45ef)), -1 < iVar4)) &&
          (iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],5,2)
          , -1 < iVar4)) &&
         (iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                            ((longlong *)param_1[0x8c5],2,0xff), -1 < iVar4)) {
        (**(code **)(*param_1 + 0x178))(param_1,"start loop");
        pbVar10 = (byte *)(param_1 + 0x72);
LAB_18000f646:
        iVar4 = (**(code **)(*param_1 + 0x168))
                          (param_1,pbVar10,(int)param_1[0x87a],
                           *(undefined4 *)((longlong)param_1 + 0x43d4));
        if (iVar4 != 1) {
          return unaff_ESI;
        }
        local_res10[0] = 0;
        local_res18[0] = 0xff;
        uVar7 = FUN_180005660(pbVar10,(int)param_1[0x87a],*(uint *)((longlong)param_1 + 0x43d4),
                              (int)param_1[0x87a],0);
        iVar4 = (int)uVar7;
        if ((iVar4 - 0x47U < 0x95) &&
           (FUN_18000f8e8(param_1,pbVar10,(int)param_1[0x87a],*(int *)((longlong)param_1 + 0x43d4),
                          iVar4,local_res10,local_res18),
           (int)(local_res10[0] - local_res18[0]) < 0x80)) {
          uVar7 = FUN_180005660(pbVar10,(int)param_1[0x87a],*(uint *)((longlong)param_1 + 0x43d4),
                                (int)param_1[0x87a],0);
          *(undefined4 *)((longlong)param_1 + 0x45f4) = 0;
          uVar8 = (int)param_1[0x87a] * *(int *)((longlong)param_1 + 0x43d4);
          if (0 < (int)uVar8) {
            uVar9 = (ulonglong)uVar8;
            do {
              bVar2 = *pbVar10;
              if ((int)(uint)bVar2 <= (int)uVar7 + (0xff - (int)uVar7) / 2) {
                uVar8 = *(uint *)((longlong)param_1 + 0x45f4);
                if (*(uint *)((longlong)param_1 + 0x45f4) < (uint)bVar2) {
                  uVar8 = (uint)bVar2;
                }
                *(uint *)((longlong)param_1 + 0x45f4) = uVar8;
              }
              pbVar10 = pbVar10 + 1;
              uVar9 = uVar9 - 1;
            } while (uVar9 != 0);
          }
          uVar3 = *(undefined1 *)((longlong)param_1 + 0x45ee);
          psVar6 = FUN_18001ba38(local_48,L"FPS_CTL(Sensor)");
          iVar4 = (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar6,uVar3);
          if (iVar4 < 0) {
LAB_18000f764:
            psVar6 = FUN_18001ba38(local_48,L"CALIBRATE_TYPE(Sensor)");
            uVar5 = 0;
          }
          else {
            uVar3 = *(undefined1 *)((longlong)param_1 + 0x45ef);
            psVar6 = FUN_18001ba38(local_48,L"PGA_CONTL(Sensor)");
            iVar4 = (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar6,uVar3);
            if (iVar4 < 0) goto LAB_18000f764;
            uVar5 = (**(code **)(*param_1 + 0x98))(param_1);
            psVar6 = FUN_18001ba38(local_48,L"CALIBRATE_TYPE(Sensor)");
          }
          (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar6,uVar5);
          (**(code **)(*param_1 + 0x178))(param_1,"CalibrateSensorMode(end)");
          goto LAB_18000f7a1;
        }
        if ((iVar4 < 0x46) || ((0xdc < iVar4 && (*(byte *)((longlong)param_1 + 0x45ee) < 0x3f)))) {
          pcVar1 = (char *)((longlong)param_1 + 0x45ef);
          *pcVar1 = *pcVar1 + -4;
          if (*pcVar1 == '\0') goto LAB_18000f764;
          *(undefined1 *)((longlong)param_1 + 0x45ee) = 0xfe;
          iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                            ((longlong *)param_1[0x8c5],9,
                             *(undefined1 *)((longlong)param_1 + 0x45ef));
          if (iVar4 < 0) {
            return unaff_ESI;
          }
        }
        else {
          *(char *)((longlong)param_1 + 0x45ee) = *(char *)((longlong)param_1 + 0x45ee) + -8;
        }
        iVar4 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                          ((longlong *)param_1[0x8c5],3,*(undefined1 *)((longlong)param_1 + 0x45ee))
        ;
        if (-1 < iVar4) goto code_r0x00018000f749;
      }
    }
  }
  return unaff_ESI;
code_r0x00018000f749:
  if ((*(char *)((longlong)param_1 + 0x45ef) == '\0') ||
     (*(char *)((longlong)param_1 + 0x45ee) == '\0')) goto LAB_18000f764;
  goto LAB_18000f646;
}



void FUN_18000f8e8(undefined8 param_1,byte *param_2,int param_3,int param_4,int param_5,
                  uint *param_6,uint *param_7)

{
  byte bVar1;
  uint uVar2;
  longlong lVar3;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3f,&DAT_18003e488);
  }
  lVar3 = (longlong)(param_3 * param_4);
  if (0 < param_3 * param_4) {
    do {
      bVar1 = *param_2;
      uVar2 = (uint)bVar1;
      if (((int)*param_6 < (int)(uint)bVar1) && ((int)(uint)bVar1 < param_5 + (0xff - param_5) / 2))
      {
        *param_6 = uVar2;
      }
      else if (((int)uVar2 < (int)*param_7) &&
              (uVar2 != param_5 / 2 && param_5 / 2 <= (int)(uint)bVar1)) {
        *param_7 = uVar2;
      }
      param_2 = param_2 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x40,&DAT_18003e488);
  }
  return;
}



void FUN_18000f9e0(LPVOID param_1)

{
  DWORD DVar1;
  HANDLE pvVar2;
  
  FUN_18001cf4c((longlong)param_1);
  pvVar2 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_18000fe28,param_1,0,(LPDWORD)0x0);
  *(HANDLE *)((longlong)param_1 + 0x43c0) = pvVar2;
  if (pvVar2 == (HANDLE)0x0) {
    FUN_18001cf0c((longlong)param_1);
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    DVar1 = GetThreadId(*(HANDLE *)((longlong)param_1 + 0x43c0));
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3c,&DAT_18003e488,DVar1);
  }
  return;
}



void FUN_18000fa74(longlong param_1,undefined *param_2)

{
  undefined1 local_res8 [8];
  undefined *local_res10;
  undefined1 local_res18 [8];
  undefined1 local_res20 [8];
  undefined1 local_58;
  undefined1 local_57;
  undefined1 local_56;
  undefined1 local_55;
  undefined1 local_54;
  undefined1 local_53;
  undefined1 local_52;
  undefined1 local_51;
  undefined1 local_50;
  undefined1 local_4f;
  undefined1 local_4e;
  undefined1 local_4d;
  undefined1 local_4c [12];
  
  local_res10 = param_2;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3d,&DAT_18003e488);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),1,local_4c);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),2,&local_4e)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),3,&local_50)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),4,&local_52)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),5,&local_54)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),6,&local_56)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),7,&local_58)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),8,&local_4f)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),9,&local_53)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0xb,&local_4d);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0xc,&local_55);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),*(undefined1 *)(param_1 + 0x43ec),&local_51);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0x10,&local_57);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0x11,local_res20);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0x12,local_res18);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0x13,local_res8);
  LeaveCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_180012e54(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3e,&DAT_18003e488,local_res10);
  }
  return;
}



int FUN_18000fd18(longlong param_1,undefined8 param_2,undefined4 param_3,undefined8 param_4,
                 undefined4 param_5,undefined4 param_6,undefined8 param_7)

{
  int iVar1;
  undefined2 uVar2;
  
  GetTickCount64();
  iVar1 = (**(code **)(param_1 + 0x38))
                    (*(undefined8 *)(param_1 + 0x40),param_2,param_3,1,1,param_6,param_7);
  if (iVar1 < 0) {
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return iVar1;
    }
    if ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0) {
      return iVar1;
    }
    if ((byte)PTR_LOOP_18004a7b8[0x19] < 2) {
      return iVar1;
    }
    uVar2 = 0x1b;
  }
  else {
    iVar1 = (**(code **)(param_1 + 0x38))
                      (*(undefined8 *)(param_1 + 0x40),param_4,param_5,1,0,param_6,param_7);
    if (-1 < iVar1) {
      return 0;
    }
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return iVar1;
    }
    if ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0) {
      return iVar1;
    }
    if ((byte)PTR_LOOP_18004a7b8[0x19] < 2) {
      return iVar1;
    }
    uVar2 = 0x1c;
  }
  FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar2,&DAT_18003e488,iVar1);
  return iVar1;
}



undefined8 FUN_18000fe28(longlong *param_1)

{
  HANDLE hObject;
  
  (**(code **)(*param_1 + 0x160))();
  FUN_18001cf0c((longlong)param_1);
  LOCK();
  hObject = (HANDLE)param_1[0x878];
  param_1[0x878] = 0;
  UNLOCK();
  if (hObject != (HANDLE)0x0) {
    CloseHandle(hObject);
  }
  return 0;
}



char FUN_18000fe60(longlong param_1,char *param_2,int param_3,int param_4)

{
  int iVar1;
  ulonglong uVar2;
  uint uVar3;
  char cVar4;
  byte local_res8 [8];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2d,&DAT_18003e488);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                    (*(longlong **)(param_1 + 0x4628),*(undefined1 *)(param_1 + 0x43ec),
                     *(undefined1 *)(param_1 + 0x43e8));
  if (-1 < iVar1) {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
                      (*(longlong **)(param_1 + 0x4628),*(undefined1 *)(param_1 + 0x43ec),local_res8
                      );
    if (-1 < iVar1) {
      if (((uint)local_res8[0] & *(uint *)(param_1 + 0x43e8)) != 0) {
        do {
          iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
                            (*(longlong **)(param_1 + 0x4628),1,local_res8);
          if (iVar1 < 0) goto LAB_18000ff43;
          if (*(char *)(param_1 + 0x28) != '\0') goto LAB_18000ffe0;
        } while ((local_res8[0] & 1) == 0);
        if (*(char *)(param_1 + 0x28) == '\0') {
          uVar3 = param_3 * param_4;
          iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x30))
                            (*(longlong **)(param_1 + 0x4628),param_2,uVar3);
          cVar4 = (iVar1 < 0) + '\x01';
          if (((cVar4 == '\x01') && (*(int *)(param_1 + 0x4390) != 2)) && (uVar3 != 0)) {
            uVar2 = (ulonglong)uVar3;
            do {
              *param_2 = -1 - *param_2;
              param_2 = param_2 + 1;
              uVar2 = uVar2 - 1;
            } while (uVar2 != 0);
          }
        }
        else {
LAB_18000ffe0:
          cVar4 = '\x0f';
        }
        goto LAB_18000ff48;
      }
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2e,&DAT_18003e488,
                      *(uint *)(param_1 + 0x43e8));
      }
    }
  }
LAB_18000ff43:
  cVar4 = '\x02';
LAB_18000ff48:
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
            (*(longlong **)(param_1 + 0x4628),*(undefined1 *)(param_1 + 0x43ec),0);
  LeaveCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2f,&DAT_18003e488);
  }
  return cVar4;
}



undefined8 FUN_180010040(longlong param_1,ushort *param_2,uint *param_3)

{
  undefined8 uVar1;
  
  if ((param_2 == (ushort *)0x0) || (*param_3 < 0x30)) {
    *param_3 = 0x30;
    uVar1 = 0xc0000023;
  }
  else {
    FUN_18001cfa0(param_1,(undefined4 *)param_2,param_3);
    *(undefined1 *)(param_2 + 6) = 2;
    *param_2 = *param_2 | 0x1480;
    *(undefined1 *)((longlong)param_2 + 0xd) = *(undefined1 *)(param_1 + 0x308);
    *(undefined1 *)(param_2 + 7) = *(undefined1 *)(param_1 + 0x309);
    *param_3 = 0x30;
    uVar1 = 0;
  }
  return uVar1;
}



undefined8 FUN_1800100ac(longlong param_1,undefined1 (*param_2) [16],uint *param_3)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  undefined8 uVar3;
  undefined8 *puVar4;
  longlong lVar5;
  
  if ((param_2 == (undefined1 (*) [16])0x0) || (*param_3 < 0x4038)) {
    *param_3 = 0x4038;
    uVar3 = 0xc0000023;
  }
  else {
    FUN_18001d084(param_1,param_2,param_3);
    *(undefined4 *)(param_2[1] + 8) = 0x1fc01fc;
    *(undefined4 *)(param_2[1] + 0xc) = 0x1fc01fc;
    *(undefined4 *)param_2[2] = 0x80101;
    *(longlong *)*param_2 = *(longlong *)*param_2 + 0x4010;
    *(undefined2 *)(param_2[1] + 4) = 0x300;
    *(undefined8 *)(param_2[2] + 8) = 0;
    *(undefined8 *)param_2[3] = 0;
    *(undefined4 *)(param_2[2] + 8) = 0x4010;
    *(undefined4 *)(param_2[2] + 0xc) = 0x800080;
    *(undefined4 *)param_2[3] = 0xfe010100;
    puVar4 = *(undefined8 **)(param_1 + 0x310);
    lVar5 = 0x80;
    puVar2 = (undefined8 *)(param_2[3] + 8);
    do {
      uVar3 = puVar4[1];
      *puVar2 = *puVar4;
      puVar2[1] = uVar3;
      uVar3 = puVar4[3];
      puVar2[2] = puVar4[2];
      puVar2[3] = uVar3;
      uVar3 = puVar4[5];
      puVar2[4] = puVar4[4];
      puVar2[5] = uVar3;
      uVar3 = puVar4[7];
      puVar2[6] = puVar4[6];
      puVar2[7] = uVar3;
      uVar3 = puVar4[9];
      puVar2[8] = puVar4[8];
      puVar2[9] = uVar3;
      uVar3 = puVar4[0xb];
      puVar2[10] = puVar4[10];
      puVar2[0xb] = uVar3;
      uVar3 = puVar4[0xd];
      puVar2[0xc] = puVar4[0xc];
      puVar2[0xd] = uVar3;
      puVar1 = puVar4 + 0xe;
      uVar3 = puVar4[0xf];
      puVar4 = puVar4 + 0x10;
      puVar2[0xe] = *puVar1;
      puVar2[0xf] = uVar3;
      lVar5 = lVar5 + -1;
      puVar2 = puVar2 + 0x10;
    } while (lVar5 != 0);
    *param_3 = *(uint *)*param_2;
    uVar3 = 0;
  }
  return uVar3;
}



void FUN_1800101a0(longlong *param_1)

{
  undefined1 uVar1;
  undefined8 uVar2;
  longlong *plVar3;
  code *pcVar4;
  longlong lVar5;
  undefined2 uVar6;
  undefined2 uVar7;
  int iVar8;
  longlong lVar9;
  ulonglong uVar10;
  uint uVar11;
  undefined1 auStackX_8 [8];
  undefined8 uStack_20;
  
  uStack_20 = 0x1800101c0;
  lVar9 = FUN_180020c30();
  lVar9 = -lVar9;
  uVar10 = DAT_18004a880 ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar9);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    uVar2 = *(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10);
    *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x18001020b;
    FUN_18000c80c(uVar2,0x30,&DAT_18003e488);
  }
  uVar1 = *(undefined1 *)((longlong)param_1 + 0x45ee);
  plVar3 = (longlong *)param_1[0x8c5];
  *(undefined4 *)(&stack0x00000018 + lVar9) = 0x5020903;
  (&stack0x0000001c)[lVar9] = uVar1;
  uVar1 = *(undefined1 *)((longlong)param_1 + 0x45ef);
  *(undefined2 *)(&stack0x0000001e + lVar9) = 0x2ff;
  (&stack0x0000001d)[lVar9] = uVar1;
  pcVar4 = *(code **)(*plVar3 + 0x18);
  *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x18001024b;
  iVar8 = (*pcVar4)(plVar3,&stack0x00000018 + lVar9,&stack0x0000001c + lVar9,4);
  if (-1 < iVar8) {
    if (*(int *)((longlong)param_1 + 0x4394) == 1) {
      uVar11 = 0;
      do {
        pcVar4 = *(code **)(*param_1 + 0x180);
        *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x18001026f;
        iVar8 = (*pcVar4)(param_1,1);
        if (iVar8 == 0) {
          uVar11 = uVar11 + 1;
        }
        else {
          uVar11 = 0;
        }
      } while (((char)param_1[5] == '\0') && (uVar11 < 2));
      if (((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
         (((PTR_LOOP_18004a7b8[0x1c] & 8) == 0 || ((byte)PTR_LOOP_18004a7b8[0x19] < 4))))
      goto LAB_18001035a;
      uVar6 = 0x31;
    }
    else {
      uVar11 = 0;
      do {
        lVar5 = *param_1;
        pcVar4 = *(code **)(lVar5 + 0x50);
        *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x1800102c1;
        uVar6 = (*pcVar4)(param_1);
        pcVar4 = *(code **)(*param_1 + 0x48);
        *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x1800102cd;
        uVar7 = (*pcVar4)(param_1);
        pcVar4 = *(code **)(lVar5 + 0x168);
        *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x1800102e2;
        iVar8 = (*pcVar4)(param_1,&stack0x00000028 + lVar9,uVar7,uVar6);
        if ((iVar8 != 1) || (uVar11 = uVar11 + 1, (char)param_1[5] != '\0')) break;
        lVar5 = *param_1;
        pcVar4 = *(code **)(lVar5 + 0x50);
        *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x1800102f9;
        uVar6 = (*pcVar4)(param_1);
        pcVar4 = *(code **)(*param_1 + 0x48);
        *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x180010305;
        uVar7 = (*pcVar4)(param_1);
        auStackX_8[lVar9] = 0;
        pcVar4 = *(code **)(lVar5 + 0x188);
        *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x18001031f;
        iVar8 = (*pcVar4)(param_1,&stack0x00000028 + lVar9,uVar7,uVar6);
      } while (iVar8 != 0);
      if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
          ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_18004a7b8[0x19] < 4))
      goto LAB_18001035a;
      uVar6 = 0x32;
    }
    uVar2 = *(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10);
    *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x18001035a;
    FUN_18000e7a8(uVar2,uVar6,&DAT_18003e488,uVar11);
  }
LAB_18001035a:
  *(undefined8 *)((longlong)&uStack_20 + lVar9) = 0x180010369;
  FUN_18001fe50(uVar10 ^ (ulonglong)(&stack0xffffffffffffffe8 + lVar9));
  return;
}



undefined8 FUN_180010384(longlong param_1,undefined1 (*param_2) [16])

{
  wchar_t *pwVar1;
  HANDLE hObject;
  longlong lVar2;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5e,&DAT_18003e488);
  }
  if (*(HANDLE *)(param_1 + 0x43c0) != (HANDLE)0x0) {
    WaitForSingleObject(*(HANDLE *)(param_1 + 0x43c0),0xffffffff);
    LOCK();
    hObject = *(HANDLE *)(param_1 + 0x43c0);
    *(undefined8 *)(param_1 + 0x43c0) = 0;
    UNLOCK();
    if (hObject != (HANDLE)0x0) {
      CloseHandle(hObject);
    }
  }
  FUN_180020400(param_2,0,0x62c);
  *(undefined8 *)*param_2 = 0x62c;
  *(undefined8 *)(*param_2 + 8) = 1;
  *(undefined4 *)param_2[1] = 8;
  *(undefined4 *)(param_2[1] + 4) = 2;
  *(undefined4 *)(param_2[1] + 8) = 1;
  *(undefined4 *)(param_2[0x62] + 4) = 1;
  *(undefined4 *)(param_2[0x62] + 8) = 0x401001b;
  lVar2 = -1;
  pwVar1 = (wchar_t *)(param_2[1] + 0xc);
  pwVar1[0] = L'E';
  pwVar1[1] = L'g';
  pwVar1[2] = L'i';
  pwVar1[3] = L's';
  pwVar1 = (wchar_t *)(param_2[2] + 4);
  pwVar1[0] = L'T';
  pwVar1[1] = L'e';
  pwVar1[2] = L'c';
  pwVar1[3] = L'.';
  *(undefined2 *)(param_2[2] + 0xc) = 0;
  do {
    lVar2 = lVar2 + 1;
  } while (*(short *)(param_1 + 0x43ee + lVar2 * 2) != 0);
  FUN_18001fe80((undefined8 *)(param_2[0x21] + 0xc),(undefined8 *)(param_1 + 0x43ee),lVar2 * 2 + 2);
  *(undefined8 *)(param_2[0x41] + 0xc) = 0x2d003000300030;
  *(undefined8 *)(param_2[0x42] + 4) = 0x2d003000300030;
  *(undefined8 *)(param_2[0x42] + 0xc) = 0x3200310031;
  *(undefined8 *)(param_2[0x61] + 0xc) = 1;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5f,&DAT_18003e488);
  }
  return 0;
}



void FUN_18001050c(longlong *param_1,undefined8 param_2,int param_3)

{
  char cVar1;
  int iVar2;
  undefined4 uVar3;
  undefined1 auStack_298 [32];
  int local_278;
  undefined4 local_270;
  undefined1 *local_268;
  undefined1 local_258 [16];
  WCHAR local_248 [264];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_298;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x12,&DAT_18003e488);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  cVar1 = (char)param_1[9];
  uVar3 = 0;
  if (cVar1 == '\0') {
    *(undefined2 *)(param_1 + 10) = 2;
  }
  else {
    if (cVar1 != '\x01') {
      if (cVar1 == '\x02') {
        FUN_180020400((undefined1 (*) [16])local_248,0,0x208);
        DAT_18004c140 = DAT_18004c140 + '\x01';
        wsprintfW(local_248,L"C:\\Temp2\\ET300\\ImagePool\\Original_Image_%02x.png");
      }
      uVar3 = 0xc0000144;
      goto LAB_18001065d;
    }
    *(undefined2 *)(param_1 + 10) = 6;
  }
  local_268 = local_258;
  *(undefined1 *)((longlong)param_1 + 0x52) = 0x80;
  local_270 = 0;
  local_278 = param_3;
  iVar2 = (**(code **)(*param_1 + 0x60))(param_1,(longlong)param_1 + 0x4c,7,param_2);
  if (iVar2 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      local_278 = iVar2;
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x13,&DAT_18003e488,param_3);
    }
    uVar3 = 0xc0000001;
  }
LAB_18001065d:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x14,&DAT_18003e488);
  }
  *(undefined4 *)(param_1 + 1) = uVar3;
  FUN_18001fe50(local_38 ^ (ulonglong)auStack_298);
  return;
}



undefined4 FUN_1800106c0(longlong *param_1,undefined1 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar2 = 0;
  *(undefined2 *)(param_1 + 10) = 3;
  *(undefined1 *)((longlong)param_1 + 0x52) = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x15,&DAT_18003e488,iVar1);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x53) == 0x45474953) &&
          (*(char *)((longlong)param_1 + 0x59) == '\x01')) {
    *param_2 = (char)param_1[0xb];
  }
  else {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x16,&DAT_18003e488,
                    (uint)*(byte *)((longlong)param_1 + 0x59));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



undefined8 FUN_1800107d0(longlong *param_1,undefined8 param_2,longlong param_3,undefined4 *param_4)

{
  longlong *plVar1;
  undefined1 uVar2;
  int iVar3;
  short *psVar4;
  longlong lVar5;
  undefined8 uVar6;
  undefined4 local_res8 [2];
  uint in_stack_ffffffffffffffb8;
  short local_38 [8];
  
  uVar6 = 1;
  param_1[0xf] = param_3;
  *(undefined4 *)(param_1 + 0x10) = 0x80;
  *(undefined4 *)((longlong)param_1 + 0x84) = 0x8c;
  if ((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) {
    if (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x35,&DAT_18003e488);
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x36,&DAT_18003e488,
                    (int)param_1[0x878]);
    }
  }
  if (((int)param_1[0x872] != 2) && ((HANDLE)param_1[0x878] != (HANDLE)0x0)) {
    WaitForSingleObject((HANDLE)param_1[0x878],0xffffffff);
  }
  psVar4 = FUN_18001ba38(local_38,L"FetchImageMode");
  iVar3 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar4,local_res8);
  if (-1 < iVar3) {
    *(undefined4 *)(param_1 + 0x872) = local_res8[0];
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x37,&DAT_18003e488,local_res8[0]);
    }
    psVar4 = FUN_18001ba38(local_38,L"FingerOnMode");
    iVar3 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar4,local_res8);
    if (-1 < iVar3) {
      *(undefined4 *)((longlong)param_1 + 0x4394) = local_res8[0];
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
         (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x38,&DAT_18003e488,local_res8[0]);
      }
      (**(code **)(*(longlong *)param_1[0x8c5] + 0x68))
                ((longlong *)param_1[0x8c5],(int)param_1[0x872]);
      iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                        ((longlong *)param_1[0x8c5],3,*(undefined1 *)((longlong)param_1 + 0x45ee));
      if (((-1 < iVar3) &&
          (iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                             ((longlong *)param_1[0x8c5],9,
                              *(undefined1 *)((longlong)param_1 + 0x45ef)), -1 < iVar3)) &&
         ((iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                             ((longlong *)param_1[0x8c5],2,0xff), -1 < iVar3 &&
          (iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],5,2)
          , -1 < iVar3)))) {
        (**(code **)(*param_1 + 0x178))(param_1,"CET300::GetImage ...Set Register");
        iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],8,1);
        if (-1 < iVar3) {
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x39,&DAT_18003e488);
          }
          do {
            if ((char)param_1[5] != '\0') {
              return 0xf;
            }
            iVar3 = (**(code **)(*param_1 + 0x168))
                              (param_1,param_1[0xf],(int)param_1[0x87a],
                               *(undefined4 *)((longlong)param_1 + 0x43d4));
            if (iVar3 != 1) {
              return 1;
            }
            in_stack_ffffffffffffffb8 = in_stack_ffffffffffffffb8 & 0xffffff00;
            iVar3 = (**(code **)(*param_1 + 0x188))
                              (param_1,param_1[0xf],(int)param_1[0x87a],
                               *(undefined4 *)((longlong)param_1 + 0x43d4),in_stack_ffffffffffffffb8
                              );
          } while (iVar3 == 0);
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3a,&DAT_18003e488);
          }
          plVar1 = param_1 + 2;
          iVar3 = (*(code *)PTR_FUN_18004a780)(plVar1,0x1000000);
          if (iVar3 != 0) {
            (*(code *)PTR_FUN_18004a788)
                      (plVar1,L"Image",param_1[0xf],(int)param_1[0x87a],
                       *(undefined4 *)((longlong)param_1 + 0x43d4));
          }
          if (((int)param_1[0x872] != 2) &&
             (iVar3 = 0, 0 < *(int *)((longlong)param_1 + 0x43d4) * (int)param_1[0x87a])) {
            lVar5 = 0;
            do {
              uVar2 = (**(code **)(*param_1 + 0x120))
                                (param_1,(uint)*(byte *)((longlong)param_1 + lVar5 + 0x390) -
                                         (uint)*(byte *)(lVar5 + param_1[0xf]));
              iVar3 = iVar3 + 1;
              *(undefined1 *)(lVar5 + param_1[0xf]) = uVar2;
              lVar5 = lVar5 + 1;
            } while (iVar3 < *(int *)((longlong)param_1 + 0x43d4) * (int)param_1[0x87a]);
          }
          iVar3 = (*(code *)PTR_FUN_18004a780)(plVar1,0x1000000);
          if (iVar3 != 0) {
            (*(code *)PTR_FUN_18004a788)
                      (plVar1,L"Image_not_bkg",param_1[0xf],(int)param_1[0x87a],
                       *(undefined4 *)((longlong)param_1 + 0x43d4));
          }
          if (param_4 != (undefined4 *)0x0) {
            *param_4 = 100;
          }
          if ((int)param_1[0x872] != 2) {
            (**(code **)(*param_1 + 0x170))(param_1);
          }
          if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
            return 1;
          }
          if ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0) {
            return 1;
          }
          if ((byte)PTR_LOOP_18004a7b8[0x19] < 4) {
            return 1;
          }
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3b,&DAT_18003e488);
          return 1;
        }
      }
      uVar6 = 2;
    }
  }
  return uVar6;
}



// WARNING: Type propagation algorithm not settling

void FUN_180010c10(longlong *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined1 auStack_58 [32];
  int local_38 [2];
  undefined2 local_30;
  undefined1 local_2e;
  undefined1 local_2c;
  undefined1 uStack_2b;
  undefined1 uStack_2a;
  undefined1 uStack_29;
  undefined2 uStack_28;
  undefined1 uStack_26;
  ulonglong local_20;
  
  local_20 = DAT_18004a880 ^ (ulonglong)auStack_58;
  iVar3 = 0;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x29,&DAT_18003e488);
  }
  if (param_2 != 0) {
    (**(code **)(*param_1 + 0x158))(param_1);
  }
  local_2c = *(undefined1 *)((longlong)param_1 + 0x45f1);
  local_38[1] = 0x2080903;
  uStack_2b = (undefined1)param_1[0x8be];
  local_30 = 0xb0c;
  uStack_2a = *(undefined1 *)((longlong)param_1 + 0x45f2);
  local_2e = 5;
  uStack_29 = 2;
  uStack_28 = 0x1ff;
  uStack_26 = 0;
  iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                    ((longlong *)param_1[0x8c5],local_38 + 1,&local_2c,7);
  if (-1 < iVar1) {
    iVar1 = 0;
    do {
      iVar2 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x48))((longlong *)param_1[0x8c5],local_38)
      ;
      if (iVar2 < 0) goto LAB_180010d81;
      if (local_38[0] != 0) {
        iVar3 = iVar3 + 1;
      }
      iVar1 = iVar1 + 1;
    } while (iVar1 < 8);
    local_2c = 5;
    uStack_2b = 0xb;
    uStack_2a = 8;
    uStack_29 = 2;
    uStack_28 = 0x407;
    local_38[1] = 0xff010002;
    local_30 = 0;
    iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                      ((longlong *)param_1[0x8c5],&local_2c,local_38 + 1,6);
    if (((-1 < iVar1) && ((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8)) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (2 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2a,&DAT_18003e488,iVar3);
    }
  }
LAB_180010d81:
  FUN_18001fe50(local_20 ^ (ulonglong)auStack_58);
  return;
}



bool FUN_180010da8(longlong param_1,byte *param_2,int param_3,int param_4,char param_5)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  longlong lVar5;
  longlong lVar6;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2b,&DAT_18003e488);
  }
  if (param_5 == '\0') {
    iVar3 = *(int *)(param_1 + 0x4608);
  }
  else {
    iVar3 = *(int *)(param_1 + 0x4600);
  }
  uVar4 = iVar3 * iVar3 * 0x100;
  uVar1 = FUN_180005724(param_1 + 0x390,*(int *)(param_1 + 0x43d0),param_2,param_3,0x10,0x10);
  lVar5 = (longlong)(param_3 + -0x10);
  uVar1 = (uint)(uVar4 <= uVar1);
  uVar2 = FUN_180005724(param_1 + 0x390 + lVar5,*(int *)(param_1 + 0x43d0),param_2 + lVar5,param_3,
                        0x10,0x10);
  if (uVar4 <= uVar2) {
    uVar1 = uVar1 + 1;
  }
  lVar6 = (longlong)((param_4 + -0x10) * param_3);
  uVar2 = FUN_180005724(param_1 + 0x390 + lVar6,*(int *)(param_1 + 0x43d0),param_2 + lVar6,param_3,
                        0x10,0x10);
  if (uVar4 <= uVar2) {
    uVar1 = uVar1 + 1;
  }
  uVar2 = FUN_180005724(param_1 + 0x390 + lVar6 + lVar5,*(int *)(param_1 + 0x43d0),
                        param_2 + lVar6 + lVar5,param_3,0x10,0x10);
  if (uVar4 <= uVar2) {
    uVar1 = uVar1 + 1;
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2c,&DAT_18003e488,uVar1);
  }
  return 2 < uVar1;
}



void FUN_180010f58(longlong *param_1)

{
  int iVar1;
  undefined2 uVar2;
  undefined1 auStack_48 [32];
  undefined4 local_28;
  undefined1 local_24;
  undefined2 local_20;
  undefined2 local_1e;
  undefined1 local_1c;
  ulonglong local_18;
  
  local_18 = DAT_18004a880 ^ (ulonglong)auStack_48;
  if ((int)param_1[0x67] != 0) goto LAB_1800111ed;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1e,&DAT_18003e488);
  }
  FUN_18001199c((longlong)param_1);
  *(undefined4 *)((longlong)param_1 + 0x4614) = 0;
  *(undefined4 *)(param_1 + 0x8c3) = 0;
  *(undefined1 *)(param_1 + 5) = 0;
  iVar1 = (**(code **)(*param_1 + 0x148))(param_1);
  if (iVar1 == 0) {
    iVar1 = (**(code **)(*param_1 + 0x150))(param_1);
    if (iVar1 == 0) {
      iVar1 = (**(code **)(*param_1 + 0x158))(param_1);
      if ((iVar1 == 0) || ((int)param_1[0x8c3] == 0)) {
        *(undefined4 *)((longlong)param_1 + 0x4614) = 1;
      }
      else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
               ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
              (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        uVar2 = 0x21;
        goto LAB_180011081;
      }
    }
    else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
             ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
            (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar2 = 0x20;
      goto LAB_180011081;
    }
  }
  else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
           ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
          (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    uVar2 = 0x1f;
LAB_180011081:
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar2,&DAT_18003e488);
  }
  local_28 = 0x13121110;
  local_20 = CONCAT11((char)param_1[0x87c],(char)param_1[0x87b]);
  local_1e = CONCAT11(*(undefined1 *)((longlong)param_1 + 0x43e4),
                      *(undefined1 *)((longlong)param_1 + 0x43e4));
  iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                    ((longlong *)param_1[0x8c5],&local_28,&local_20,4);
  if (-1 < iVar1) {
    local_20 = 0x108;
    local_28 = CONCAT22(local_28._2_2_,0x205);
    iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                      ((longlong *)param_1[0x8c5],&local_20,&local_28,2);
    if (-1 < iVar1) {
      iVar1 = (**(code **)(*param_1 + 0x68))(param_1);
      if (iVar1 != 0) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
           (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x22,&DAT_18003e488);
        }
        local_28 = 0x7020903;
        local_20 = *(undefined2 *)((longlong)param_1 + 0x45ee);
        local_24 = 4;
        local_1e = 0xff;
        local_1c = 0;
        iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                          ((longlong *)param_1[0x8c5],&local_28,&local_20,5);
        if (iVar1 < 0) goto LAB_1800111ed;
        (**(code **)(*param_1 + 0x178))(param_1,"InitSensor");
      }
      *(undefined4 *)(param_1 + 0x67) = 1;
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
         (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x23,&DAT_18003e488);
      }
    }
  }
LAB_1800111ed:
  FUN_18001fe50(local_18 ^ (ulonglong)auStack_48);
  return;
}



int FUN_1800112d8(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  short *psVar2;
  byte local_res8 [8];
  undefined4 local_38 [2];
  short local_30 [12];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  psVar2 = FUN_18001ba38(local_30,L"FetchImageMode");
  iVar1 = (*DAT_18004c5b8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),psVar2,local_38);
  if (-1 < iVar1) {
    *(undefined4 *)(param_1 + 0x4390) = local_38[0];
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x60,&DAT_18003e488,local_38[0]);
    }
    psVar2 = FUN_18001ba38(local_30,L"FingerOnMode");
    iVar1 = (*DAT_18004c5b8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),psVar2,local_38);
    if (-1 < iVar1) {
      *(undefined4 *)(param_1 + 0x4394) = local_38[0];
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
         (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x61,&DAT_18003e488,local_38[0]);
      }
      iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                        (*(longlong **)(param_1 + 0x4628),*(undefined1 *)(param_1 + 0x43ec),
                         *(undefined1 *)(param_1 + 0x43e8));
      if (-1 < iVar1) {
        do {
          iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
                            (*(longlong **)(param_1 + 0x4628),1,local_res8);
          if (iVar1 < 0) goto LAB_18001145a;
        } while ((local_res8[0] & 1) == 0);
        (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x68))
                  (*(longlong **)(param_1 + 0x4628),*(undefined4 *)(param_1 + 0x4390));
        iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x30))
                          (*(longlong **)(param_1 + 0x4628),param_2,param_3);
      }
    }
  }
LAB_18001145a:
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))(*(longlong **)(param_1 + 0x4628),0xd,0);
  LeaveCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  return iVar1;
}



undefined8 FUN_1800114a0(longlong param_1,undefined1 *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined1 local_res8 [32];
  
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x48))
                    (*(longlong **)(param_1 + 0x4628),local_res8);
  if (iVar1 < 0) {
    uVar2 = 0xc0000001;
  }
  else {
    *param_2 = local_res8[0];
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_1800114d4(longlong param_1,undefined8 param_2,undefined4 param_3,undefined8 param_4)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x18))
                    (*(longlong **)(param_1 + 0x4628),param_2,param_4,param_3);
  uVar2 = 0xc0000001;
  if (-1 < iVar1) {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_180011504(longlong param_1,undefined8 param_2,undefined4 param_3,undefined8 param_4)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x20))
                    (*(longlong **)(param_1 + 0x4628),param_2,param_4,param_3);
  uVar2 = 0xc0000001;
  if (-1 < iVar1) {
    uVar2 = 0;
  }
  return uVar2;
}



int FUN_18001153c(longlong *param_1)

{
  int iVar1;
  undefined4 uVar2;
  short *psVar3;
  int unaff_EDI;
  int local_res8 [2];
  short local_18 [8];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x54,&DAT_18003e488);
  }
  if (*(int *)((longlong)param_1 + 0x45fc) == 0) {
    *(undefined4 *)(param_1 + 0x8c3) = 0;
    return unaff_EDI;
  }
  psVar3 = FUN_18001ba38(local_18,L"RemoteWakeupEnable");
  iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar3,local_res8);
  if ((iVar1 < 0) || (local_res8[0] != 0)) {
    uVar2 = 1;
  }
  else {
    uVar2 = 0;
  }
  *(undefined4 *)(param_1 + 0x8c3) = uVar2;
  psVar3 = FUN_18001ba38(local_18,L"CALIBRATE_TYPE(Detect)");
  iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar3,local_res8);
  if (-1 < iVar1) {
    iVar1 = (**(code **)(*param_1 + 0x98))(param_1);
    if (local_res8[0] == iVar1) {
      psVar3 = FUN_18001ba38(local_18,L"FPS_CTL(Detect)");
      iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar3,local_res8);
      if (-1 < iVar1) {
        *(undefined1 *)((longlong)param_1 + 0x45f1) = (undefined1)local_res8[0];
        psVar3 = FUN_18001ba38(local_18,L"PGA_CONTL(Detect)");
        iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar3,local_res8);
        if (-1 < iVar1) {
          *(undefined1 *)(param_1 + 0x8be) = (undefined1)local_res8[0];
          psVar3 = FUN_18001ba38(local_18,L"DETC(Detect)");
          iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar3,local_res8);
          if (-1 < iVar1) {
            *(undefined1 *)((longlong)param_1 + 0x45f2) = (undefined1)local_res8[0];
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
               (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x56,&DAT_18003e488,
                            (uint)*(byte *)((longlong)param_1 + 0x45f1));
            }
            goto LAB_180011677;
          }
        }
      }
    }
    else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
             ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x55,&DAT_18003e488);
    }
  }
  *(undefined2 *)(param_1 + 0x8be) = 0;
  *(undefined1 *)((longlong)param_1 + 0x45f2) = 0;
LAB_180011677:
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x57,&DAT_18003e488);
  }
  return unaff_EDI;
}



int FUN_1800117c8(longlong *param_1)

{
  int iVar1;
  short *psVar2;
  int local_res8 [2];
  short local_18 [8];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x58,&DAT_18003e488);
  }
  psVar2 = FUN_18001ba38(local_18,L"CALIBRATE_TYPE(Sensor)");
  iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar2,local_res8);
  if (-1 < iVar1) {
    iVar1 = (**(code **)(*param_1 + 0x98))(param_1);
    if (local_res8[0] == iVar1) {
      psVar2 = FUN_18001ba38(local_18,L"FPS_CTL(Sensor)");
      iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar2,local_res8);
      if (-1 < iVar1) {
        *(undefined1 *)((longlong)param_1 + 0x45ee) = (undefined1)local_res8[0];
        psVar2 = FUN_18001ba38(local_18,L"PGA_CONTL(Sensor)");
        iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar2,local_res8);
        if (-1 < iVar1) {
          *(undefined1 *)((longlong)param_1 + 0x45ef) = (undefined1)local_res8[0];
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
             (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5a,&DAT_18003e488,
                          (uint)*(byte *)((longlong)param_1 + 0x45ee));
          }
          iVar1 = 0;
          goto LAB_180011898;
        }
      }
    }
    else {
      iVar1 = -0x3fffffa7;
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x59,&DAT_18003e488);
      }
    }
  }
  *(undefined2 *)((longlong)param_1 + 0x45ee) = 0;
LAB_180011898:
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5b,&DAT_18003e488);
  }
  return iVar1;
}



void FUN_18001199c(longlong param_1)

{
  int iVar1;
  short *psVar2;
  undefined4 local_res8 [2];
  longlong local_res10;
  short local_18 [8];
  
  local_res10 = 0;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x33,&DAT_18003e488);
  }
  iVar1 = (*DAT_18004c1e0)(DAT_18004c910,*(undefined8 *)(param_1 + 0x68),1,0x20019,0,&local_res10);
  if (-1 < iVar1) {
    psVar2 = FUN_18001ba38(local_18,L"DeviceIdleEnabled");
    iVar1 = (*DAT_18004c5b8)(DAT_18004c910,local_res10,psVar2,local_res8);
    if (-1 < iVar1) {
      *(undefined4 *)(param_1 + 0x45fc) = local_res8[0];
      psVar2 = FUN_18001ba38(local_18,L"DefaultIdleTimeout");
      iVar1 = (*DAT_18004c5b8)(DAT_18004c910,local_res10,psVar2,local_res8);
      if (-1 < iVar1) {
        *(undefined4 *)(param_1 + 0x460c) = local_res8[0];
        psVar2 = FUN_18001ba38(local_18,L"ResumingDetectModeParameterTuningEnabled");
        iVar1 = (*DAT_18004c5b8)(DAT_18004c910,local_res10,psVar2,local_res8);
        if (-1 < iVar1) {
          *(undefined4 *)(param_1 + 0x4610) = local_res8[0];
        }
      }
    }
  }
  if (local_res10 != 0) {
    (*DAT_18004c578)(DAT_18004c910);
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x34,&DAT_18003e488,
                  *(undefined4 *)(param_1 + 0x45fc));
  }
  return;
}



int FUN_180011b1c(longlong param_1)

{
  int iVar1;
  short *psVar2;
  undefined4 local_res8 [2];
  short local_18 [8];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5c,&DAT_18003e488);
  }
  psVar2 = FUN_18001ba38(local_18,L"FingerOnThreshold");
  iVar1 = (*DAT_18004c5b8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),psVar2,local_res8);
  if (-1 < iVar1) {
    *(undefined4 *)(param_1 + 0x4608) = local_res8[0];
    psVar2 = FUN_18001ba38(local_18,L"FingerOnThresholdLoose");
    iVar1 = (*DAT_18004c5b8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),psVar2,local_res8);
    if (-1 < iVar1) {
      *(undefined4 *)(param_1 + 0x4600) = local_res8[0];
      psVar2 = FUN_18001ba38(local_18,L"FingerOnThresholdLoose");
      iVar1 = (*DAT_18004c5b8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),psVar2,local_res8);
      if (-1 < iVar1) {
        *(undefined4 *)(param_1 + 0x4604) = local_res8[0];
      }
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5d,&DAT_18003e488,iVar1);
  }
  return iVar1;
}



undefined4 FUN_180011c6c(longlong *param_1,uint *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar2 = 0;
  *(undefined2 *)(param_1 + 10) = 5;
  *(undefined1 *)((longlong)param_1 + 0x52) = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x19,&DAT_18003e488,iVar1);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x53) == 0x45474953) &&
          (*(char *)((longlong)param_1 + 0x59) == '\x01')) {
    *param_2 = (uint)((char)param_1[0xb] != '\0');
  }
  else {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1a,&DAT_18003e488,
                    (uint)*(byte *)((longlong)param_1 + 0x59));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



undefined4 FUN_180011d80(longlong *param_1,byte param_2,undefined1 *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar2 = 0;
  *(undefined1 *)(param_1 + 10) = 0;
  *(byte *)((longlong)param_1 + 0x51) = param_2;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),10,&DAT_18003e488,(uint)param_2);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x53) == 0x45474953) &&
          (*(char *)((longlong)param_1 + 0x59) == '\x01')) {
    *param_3 = (char)param_1[0xb];
  }
  else {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xb,&DAT_18003e488,
                    (uint)*(byte *)((longlong)param_1 + 0x59));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



int FUN_180011ea0(longlong *param_1,longlong param_2,undefined1 *param_3,uint param_4)

{
  int iVar1;
  uint uVar2;
  ulonglong uVar3;
  longlong lVar4;
  undefined1 local_res20 [8];
  
  uVar3 = 0;
  iVar1 = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined1 *)(param_1 + 10) = 0;
  if (param_4 != 0) {
    lVar4 = param_2 - (longlong)param_3;
    do {
      *(undefined1 *)((longlong)param_1 + 0x51) = param_3[lVar4];
      iVar1 = (**(code **)(*param_1 + 0x60))
                        (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res20
                        );
      if (iVar1 < 0) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xc,&DAT_18003e488,
                        (uint)*(byte *)(uVar3 + param_2));
        }
        iVar1 = -0x3fffffff;
        break;
      }
      if ((*(int *)((longlong)param_1 + 0x53) != 0x45474953) ||
         (*(char *)((longlong)param_1 + 0x59) != '\x01')) {
        if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
           (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xd,&DAT_18003e488,
                        (uint)*(byte *)((longlong)param_1 + 0x59));
        }
        iVar1 = -0x3ffffebc;
        break;
      }
      uVar2 = (int)uVar3 + 1;
      uVar3 = (ulonglong)uVar2;
      *param_3 = (char)param_1[0xb];
      param_3 = param_3 + 1;
    } while (uVar2 < param_4);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (-1 < iVar1) {
    iVar1 = 0;
  }
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



void FUN_18001200c(longlong param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
                  undefined8 param_5)

{
  (**(code **)(param_1 + 0x38))(*(undefined8 *)(param_1 + 0x40),param_2,param_3,1,0,param_4,param_5)
  ;
  return;
}



undefined8 FUN_18001203c(longlong *param_1)

{
  byte bVar1;
  int iVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  uint uVar5;
  ulonglong uVar6;
  byte *pbVar7;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x62,&DAT_18003e488);
  }
  pbVar7 = (byte *)(param_1 + 0x72);
  iVar2 = (**(code **)(*param_1 + 0x168))
                    (param_1,pbVar7,(int)param_1[0x87a],*(undefined4 *)((longlong)param_1 + 0x43d4))
  ;
  if (iVar2 == 1) {
    uVar4 = FUN_180005660(pbVar7,(int)param_1[0x87a],*(uint *)((longlong)param_1 + 0x43d4),
                          (int)param_1[0x87a],0);
    *(undefined4 *)((longlong)param_1 + 0x45f4) = 0;
    uVar5 = (int)param_1[0x87a] * *(int *)((longlong)param_1 + 0x43d4);
    if (0 < (int)uVar5) {
      uVar6 = (ulonglong)uVar5;
      do {
        bVar1 = *pbVar7;
        if ((int)(uint)bVar1 <= (int)uVar4 + (0xff - (int)uVar4) / 2) {
          uVar5 = *(uint *)((longlong)param_1 + 0x45f4);
          if (*(uint *)((longlong)param_1 + 0x45f4) < (uint)bVar1) {
            uVar5 = (uint)bVar1;
          }
          *(uint *)((longlong)param_1 + 0x45f4) = uVar5;
        }
        pbVar7 = pbVar7 + 1;
        uVar6 = uVar6 - 1;
      } while (uVar6 != 0);
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),99,&DAT_18003e488);
    }
    uVar3 = 0;
  }
  else {
    uVar3 = 1;
  }
  return uVar3;
}



undefined8 FUN_180012160(longlong param_1)

{
  short *psVar1;
  short local_18 [8];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x52,&DAT_18003e488);
  }
  psVar1 = FUN_18001ba38(local_18,L"CALIBRATE_TYPE(Sensor)");
  (*DAT_18004c5e8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),psVar1,0);
  psVar1 = FUN_18001ba38(local_18,L"CALIBRATE_TYPE(Detect)");
  (*DAT_18004c5e8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),psVar1,0);
  *(undefined4 *)(param_1 + 0x4614) = 0;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x53,&DAT_18003e488);
  }
  return 0;
}



undefined8 FUN_180012238(longlong param_1)

{
  HANDLE hObject;
  
  if (*(HANDLE *)(param_1 + 0x43c0) != (HANDLE)0x0) {
    WaitForSingleObject(*(HANDLE *)(param_1 + 0x43c0),0xffffffff);
    LOCK();
    hObject = *(HANDLE *)(param_1 + 0x43c0);
    *(undefined8 *)(param_1 + 0x43c0) = 0;
    UNLOCK();
    if (hObject != (HANDLE)0x0) {
      CloseHandle(hObject);
    }
  }
  return 0;
}



undefined8 FUN_180012274(longlong *param_1)

{
  undefined1 uVar1;
  DWORD DVar2;
  int iVar3;
  short *psVar4;
  uint uVar5;
  short local_18 [8];
  
  DVar2 = GetTickCount();
  uVar5 = DVar2 - (int)param_1[0x8bf];
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x46,&DAT_18003e488,uVar5);
  }
  iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],5,2);
  if (-1 < iVar3) {
    iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],0xb,2);
    if (-1 < iVar3) {
      iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],8,1);
      if (-1 < iVar3) {
        iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],2,0xff)
        ;
        if (-1 < iVar3) {
          iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],7,0);
          if (-1 < iVar3) {
            iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                              ((longlong *)param_1[0x8c5],4,0);
            if (-1 < iVar3) {
              iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                                ((longlong *)param_1[0x8c5],3,
                                 *(undefined1 *)((longlong)param_1 + 0x45ee));
              if ((-1 < iVar3) &&
                 (iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                                    ((longlong *)param_1[0x8c5],9,
                                     *(undefined1 *)((longlong)param_1 + 0x45ef)), -1 < iVar3)) {
                if ((uVar5 < 1000) && ((int)param_1[0x8c2] != 0)) {
                  *(char *)((longlong)param_1 + 0x45f2) =
                       *(char *)((longlong)param_1 + 0x45f2) + '\x02';
                  uVar1 = *(undefined1 *)((longlong)param_1 + 0x45f2);
                  psVar4 = FUN_18001ba38(local_18,L"DETC(Detect)");
                  (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar4,uVar1);
                }
                (**(code **)(*param_1 + 0x178))(param_1,"ResumeFromSuspend");
                if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                    ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) &&
                   (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
                  FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x47,&DAT_18003e488);
                }
                return 1;
              }
            }
          }
        }
      }
    }
  }
  return 2;
}



void FUN_180012444(longlong param_1)

{
  (**(code **)(param_1 + 0x38))(*(undefined8 *)(param_1 + 0x40));
  return;
}



void FUN_180012474(longlong *param_1,int param_2)

{
  int iVar1;
  DWORD DVar2;
  short *psVar3;
  undefined1 auStack_68 [32];
  undefined1 local_48 [8];
  short local_40 [8];
  undefined1 local_30;
  undefined1 uStack_2f;
  undefined1 uStack_2e;
  undefined1 uStack_2d;
  undefined2 uStack_2c;
  undefined1 uStack_2a;
  undefined4 local_28;
  undefined2 local_24;
  undefined1 local_22;
  ulonglong local_20;
  
  local_20 = DAT_18004a880 ^ (ulonglong)auStack_68;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x27,&DAT_18003e488);
  }
  psVar3 = FUN_18001ba38(local_40,L"FPS_CTL(Detect)");
  iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar3,local_48);
  if (-1 < iVar1) {
    *(undefined1 *)((longlong)param_1 + 0x45f1) = local_48[0];
    psVar3 = FUN_18001ba38(local_40,L"PGA_CONTL(Detect)");
    iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar3,local_48);
    if (-1 < iVar1) {
      *(undefined1 *)(param_1 + 0x8be) = local_48[0];
      psVar3 = FUN_18001ba38(local_40,L"DETC(Detect)");
      iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar3,local_48);
      if (-1 < iVar1) {
        uStack_2e = local_48[0];
        *(undefined1 *)((longlong)param_1 + 0x45f2) = local_48[0];
        if (param_2 == 0) {
          local_30 = 3;
          uStack_2f = 4;
          uStack_2e = 5;
          uStack_2d = 7;
          uStack_2c = 0x908;
          uStack_2a = 0xb;
          local_28 = 0x3000101;
          local_24 = 0x301;
          local_22 = 0;
          iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                            ((longlong *)param_1[0x8c5],&local_30,&local_28,7);
        }
        else {
          local_30 = *(undefined1 *)((longlong)param_1 + 0x45f1);
          uStack_2f = (undefined1)param_1[0x8be];
          local_28 = 0x2080903;
          local_24 = 0x50c;
          local_22 = 0xb;
          uStack_2d = 2;
          uStack_2c = 0xff;
          uStack_2a = 1;
          iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                            ((longlong *)param_1[0x8c5],&local_28,&local_30);
        }
        if (iVar1 < 0) goto LAB_18001266a;
        DVar2 = GetTickCount();
        *(DWORD *)(param_1 + 0x8bf) = DVar2;
      }
    }
  }
  (**(code **)(*param_1 + 0x178))(param_1,"SetDetectModeParameters");
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x28,&DAT_18003e488,param_2);
  }
LAB_18001266a:
  FUN_18001fe50(local_20 ^ (ulonglong)auStack_68);
  return;
}



undefined4 FUN_1800126a0(longlong *param_1,undefined1 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar2 = 0;
  *(undefined2 *)(param_1 + 10) = 4;
  *(undefined1 *)((longlong)param_1 + 0x52) = param_2;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x17,&DAT_18003e488,iVar1);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x53) != 0x45474953) ||
          (*(char *)((longlong)param_1 + 0x59) != '\x01')) {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x18,&DAT_18003e488,
                    (uint)*(byte *)((longlong)param_1 + 0x59));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



void FUN_1800127a8(longlong param_1,undefined8 *param_2,longlong param_3)

{
  int iVar1;
  wchar_t **ppwVar2;
  uint uVar3;
  undefined1 auStack_d8 [32];
  undefined4 local_b8 [2];
  short local_b0 [12];
  wchar_t *local_98;
  undefined4 local_90;
  wchar_t *local_88;
  undefined4 local_80;
  wchar_t *local_78;
  undefined4 local_70;
  wchar_t *local_68;
  undefined4 local_60;
  wchar_t *local_58;
  undefined4 local_50;
  wchar_t *local_48;
  undefined4 local_40;
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_d8;
  if (param_2 != (undefined8 *)0x0) {
    if (*(longlong *)(param_1 + 0x4620) != 0) {
      (*DAT_18004c578)(DAT_18004c910);
    }
    local_70 = 0;
    local_60 = 0;
    *(undefined8 *)(param_1 + 0x4620) = *param_2;
    *param_2 = 0;
    local_98 = L"RemoteWakeupEnable";
    local_90 = 1;
    local_88 = L"FetchImageMode";
    local_80 = 0x80000000;
    local_78 = L"FingerOnMode";
    local_50 = 2;
    local_68 = L"ResumingDetectModeParameterTuningEnabled";
    local_40 = 6;
    local_58 = L"FingerOnThresholdLoose";
    uVar3 = 0;
    local_48 = L"FingerOnThreshold";
    ppwVar2 = &local_98;
    do {
      FUN_18001ba38(local_b0,*ppwVar2);
      iVar1 = (*DAT_18004c5b8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),local_b0,local_b8);
      if ((iVar1 < 0) &&
         ((param_3 == 0 ||
          (iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_3,local_b0,local_b8), iVar1 < 0)))) {
        (*DAT_18004c5e8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),local_b0,local_b8[0]);
      }
      uVar3 = uVar3 + 1;
      ppwVar2 = ppwVar2 + 2;
    } while (uVar3 < 6);
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStack_d8);
  return;
}



undefined8 FUN_180012908(longlong param_1)

{
  int iVar1;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x25,&DAT_18003e488);
  }
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                    (*(longlong **)(param_1 + 0x4628),5,2);
  if (-1 < iVar1) {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                      (*(longlong **)(param_1 + 0x4628),0xb,2);
    if (-1 < iVar1) {
      iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                        (*(longlong **)(param_1 + 0x4628),8,1);
      if (-1 < iVar1) {
        iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                          (*(longlong **)(param_1 + 0x4628),2,0xff);
        if (-1 < iVar1) {
          iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                            (*(longlong **)(param_1 + 0x4628),7,0);
          if (-1 < iVar1) {
            iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                              (*(longlong **)(param_1 + 0x4628),4,0);
            if (-1 < iVar1) {
              iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                                (*(longlong **)(param_1 + 0x4628),3,
                                 *(undefined1 *)(param_1 + 0x45ee));
              if ((-1 < iVar1) &&
                 (iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                                    (*(longlong **)(param_1 + 0x4628),9,
                                     *(undefined1 *)(param_1 + 0x45ef)), -1 < iVar1)) {
                if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                   (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0 &&
                    (3 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
                  FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x26,&DAT_18003e488);
                }
                return 1;
              }
            }
          }
        }
      }
    }
  }
  return 2;
}



undefined8 FUN_180012a64(void)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x24,&DAT_18003e488);
  }
  return 1;
}



void FUN_180012aac(longlong param_1)

{
  HANDLE hObject;
  
  *(undefined1 *)(param_1 + 0x28) = 1;
  if (*(HANDLE *)(param_1 + 0x43c0) != (HANDLE)0x0) {
    WaitForSingleObject(*(HANDLE *)(param_1 + 0x43c0),0xffffffff);
    LOCK();
    hObject = *(HANDLE *)(param_1 + 0x43c0);
    *(undefined8 *)(param_1 + 0x43c0) = 0;
    UNLOCK();
    if (hObject != (HANDLE)0x0) {
      CloseHandle(hObject);
    }
  }
  *(undefined4 *)(param_1 + 0x338) = 0;
  return;
}



undefined4 FUN_180012af0(longlong *param_1,byte param_2,undefined1 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined1 *)((longlong)param_1 + 0x52) = param_3;
  uVar2 = 0;
  *(undefined1 *)(param_1 + 10) = 1;
  *(byte *)((longlong)param_1 + 0x51) = param_2;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xe,&DAT_18003e488,(uint)param_2);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x53) != 0x45474953) ||
          (*(char *)((longlong)param_1 + 0x59) != '\x01')) {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xf,&DAT_18003e488,
                    (uint)*(byte *)((longlong)param_1 + 0x59));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



int FUN_180012c00(longlong *param_1,undefined1 param_2,byte param_3,byte param_4)

{
  int iVar1;
  byte local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  iVar1 = (**(code **)(*param_1 + 8))(param_1,param_2,local_res8);
  if (-1 < iVar1) {
    local_res8[0] = ~param_4 & local_res8[0] | param_3 & param_4;
    iVar1 = (**(code **)(*param_1 + 0x10))(param_1,param_2);
    if (-1 < iVar1) {
      iVar1 = 0;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_180012c98(longlong *param_1,longlong param_2,undefined1 *param_3,uint param_4)

{
  int iVar1;
  uint uVar2;
  ulonglong uVar3;
  longlong lVar4;
  undefined1 local_res20 [8];
  
  uVar3 = 0;
  iVar1 = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined1 *)(param_1 + 10) = 1;
  if (param_4 != 0) {
    lVar4 = param_2 - (longlong)param_3;
    do {
      *(undefined1 *)((longlong)param_1 + 0x51) = param_3[lVar4];
      *(undefined1 *)((longlong)param_1 + 0x52) = *param_3;
      iVar1 = (**(code **)(*param_1 + 0x60))
                        (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res20
                        );
      if (iVar1 < 0) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x10,&DAT_18003e488,
                        (uint)*(byte *)(uVar3 + param_2));
        }
        iVar1 = -0x3fffffff;
        break;
      }
      if ((*(int *)((longlong)param_1 + 0x53) != 0x45474953) ||
         (*(char *)((longlong)param_1 + 0x59) != '\x01')) {
        if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
           (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x11,&DAT_18003e488,
                        (uint)*(byte *)((longlong)param_1 + 0x59));
        }
        iVar1 = -0x3ffffebc;
        break;
      }
      uVar2 = (int)uVar3 + 1;
      uVar3 = (ulonglong)uVar2;
      param_3 = param_3 + 1;
    } while (uVar2 < param_4);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (-1 < iVar1) {
    iVar1 = 0;
  }
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



void FUN_180012e04(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&stack0x00000028,4,&stack0x00000030,4,0);
  return;
}



void FUN_180012e54(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined *param_4)

{
  undefined *puVar1;
  longlong lVar2;
  longlong lVar3;
  
  if (param_4 == (undefined *)0x0) {
    lVar3 = 5;
  }
  else {
    lVar2 = -1;
    do {
      lVar3 = lVar2;
      lVar2 = lVar3 + 1;
    } while (param_4[lVar2] != '\0');
    lVar3 = lVar3 + 2;
  }
  puVar1 = &DAT_18003e700;
  if (param_4 != (undefined *)0x0) {
    puVar1 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,puVar1,lVar3,&stack0x00000028,4,&stack0x00000030,4,
               &stack0x00000038,4,&stack0x00000040,4,&stack0x00000048,4,&stack0x00000050,4,
               &stack0x00000058,4,&stack0x00000060,4,&stack0x00000068,4,&stack0x00000070,4,
               &stack0x00000078,4,&stack0x00000080,4,&stack0x00000088,4,&stack0x00000090,4,
               &stack0x00000098,4,&stack0x000000a0,4,0);
  return;
}



void FUN_180012fe0(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined *param_4)

{
  undefined *puVar1;
  longlong lVar2;
  longlong lVar3;
  
  if (param_4 == (undefined *)0x0) {
    lVar3 = 5;
  }
  else {
    lVar2 = -1;
    do {
      lVar3 = lVar2;
      lVar2 = lVar3 + 1;
    } while (param_4[lVar2] != '\0');
    lVar3 = lVar3 + 2;
  }
  puVar1 = &DAT_18003e700;
  if (param_4 != (undefined *)0x0) {
    puVar1 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,puVar1,lVar3,0);
  return;
}



bool FUN_180013034(longlong param_1,int param_2,int param_3,int param_4,int param_5,int param_6)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  undefined8 uVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  int iVar8;
  byte local_res20 [8];
  byte local_58 [4];
  int local_54;
  int local_50;
  ulonglong local_48;
  
  iVar5 = 0;
  local_50 = 0;
  iVar2 = (param_5 + -1) / 2;
  iVar6 = param_4 - iVar2;
  iVar2 = iVar2 + param_4;
  if ((iVar6 < 0) || (param_2 <= iVar2)) {
    bVar1 = false;
  }
  else {
    if (iVar6 <= iVar2) {
      iVar3 = param_3 + -8;
      lVar7 = (longlong)iVar6;
      local_48 = (ulonglong)((iVar2 - iVar6) + 1);
      local_54 = iVar3;
      do {
        iVar2 = local_54;
        iVar6 = 2;
        iVar8 = 0;
        if (2 < iVar3) {
          iVar5 = param_2 * 2;
          do {
            uVar4 = FUN_180013504((byte *)(iVar5 + lVar7 + param_1),8,local_58,local_res20,param_2);
            if (param_6 < (int)((uint)uVar4 & 0xff)) {
              iVar6 = iVar6 + 8;
              iVar5 = iVar5 + param_2 * 8;
              iVar8 = iVar8 + 1;
            }
            iVar6 = iVar6 + 1;
            iVar5 = iVar5 + param_2;
          } while (iVar6 < iVar2);
          iVar3 = local_54;
          iVar5 = local_50;
          if (4 < iVar8) {
            iVar5 = local_50 + 1;
            local_50 = iVar5;
          }
        }
        lVar7 = lVar7 + 1;
        local_48 = local_48 - 1;
      } while (local_48 != 0);
    }
    bVar1 = param_5 / 2 <= iVar5;
  }
  return bVar1;
}



bool FUN_180013168(longlong param_1,int param_2,int param_3,int param_4,int param_5,int param_6)

{
  int iVar1;
  bool bVar2;
  int iVar3;
  undefined8 uVar4;
  longlong lVar5;
  int iVar6;
  int iVar7;
  ulonglong uVar8;
  byte local_res20 [8];
  
  iVar1 = param_5;
  iVar7 = 0;
  iVar3 = (param_5 + -1) / 2;
  iVar6 = param_4 - iVar3;
  iVar3 = iVar3 + param_4;
  if ((iVar6 < 0) || (param_3 <= iVar3)) {
    bVar2 = false;
  }
  else {
    if (iVar6 <= iVar3) {
      lVar5 = iVar6 * param_2 + param_1;
      uVar8 = (ulonglong)((iVar3 - iVar6) + 1);
      do {
        iVar3 = 2;
        iVar6 = 0;
        if (2 < param_2 + -8) {
          do {
            uVar4 = FUN_180013504((byte *)(iVar3 + lVar5),8,local_res20,(byte *)&param_5,1);
            if (param_6 < (int)((uint)uVar4 & 0xff)) {
              iVar3 = iVar3 + 8;
              iVar6 = iVar6 + 1;
            }
            iVar3 = iVar3 + 1;
          } while (iVar3 < param_2 + -8);
          if (4 < iVar6) {
            iVar7 = iVar7 + 1;
          }
        }
        lVar5 = lVar5 + param_2;
        uVar8 = uVar8 - 1;
      } while (uVar8 != 0);
    }
    bVar2 = iVar1 / 2 <= iVar7;
  }
  return bVar2;
}



ulonglong FUN_180013278(undefined8 *param_1,int param_2,int param_3)

{
  byte bVar1;
  byte *pbVar2;
  ulonglong uVar3;
  int iVar4;
  ulonglong uVar5;
  int iVar6;
  ulonglong uVar7;
  byte local_res8 [8];
  undefined1 local_res20 [8];
  
  uVar3 = 0;
  iVar4 = 0;
  if (((param_1 == (undefined8 *)0x0) || (param_2 == 0)) || (param_3 == 0)) {
    uVar3 = 0xffffffff;
  }
  else {
    iVar6 = param_2 * param_3;
    uVar7 = (ulonglong)iVar6;
    pbVar2 = (byte *)FUN_18001fcf8(uVar7);
    if (pbVar2 == (byte *)0x0) {
      uVar3 = 0xfffffffd;
    }
    else {
      FUN_18001fe80((undefined8 *)pbVar2,param_1,uVar7);
      FUN_1800058b0((longlong)pbVar2,param_2,param_3);
      bVar1 = FUN_180005d18(pbVar2,param_2,param_3,local_res8,local_res20);
      if (bVar1 == 0) {
        FUN_18001fcb8(pbVar2);
        uVar3 = 0xfffffffe;
      }
      else {
        FUN_1800134d0((longlong)pbVar2,param_2,param_3,local_res8[0],local_res8[0]);
        FUN_1800133a8((longlong)pbVar2,param_2,param_3,local_res8[0],local_res8[0]);
        FUN_1800133a8((longlong)pbVar2,param_2,param_3,local_res8[0],local_res8[0]);
        uVar5 = uVar3;
        if (0 < iVar6) {
          do {
            if (pbVar2[uVar3] < bVar1) {
              uVar5 = (ulonglong)((int)uVar5 + 1);
            }
            iVar4 = (int)uVar5;
            uVar3 = uVar3 + 1;
          } while ((longlong)uVar3 < (longlong)uVar7);
        }
        FUN_18001fcb8(pbVar2);
        uVar3 = (longlong)(iVar4 * 100) / (longlong)iVar6 & 0xffffffff;
      }
    }
  }
  return uVar3;
}



void FUN_1800133a8(longlong param_1,int param_2,int param_3,byte param_4,char param_5)

{
  longlong lVar1;
  char *pcVar2;
  byte bVar3;
  LPVOID pvVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  longlong lVar8;
  int iVar9;
  longlong lVar10;
  ulonglong uVar11;
  
  pvVar4 = FUN_18002062c((longlong)(param_2 * param_3),1);
  if (0 < (int)(param_3 - 1U)) {
    lVar10 = 0;
    uVar11 = (ulonglong)(param_3 - 1U);
    iVar7 = 0;
    do {
      lVar5 = 0;
      iVar9 = iVar7;
      if (0 < (longlong)(param_2 + -1)) {
        do {
          lVar6 = (longlong)iVar9;
          if ((*(byte *)(lVar6 + (longlong)pvVar4) < 2) && (*(byte *)(lVar6 + param_1) < param_4)) {
            lVar8 = (lVar10 + 1) * (longlong)param_2;
            lVar1 = lVar8 + lVar5;
            bVar3 = *(byte *)(lVar1 + param_1);
            if (param_4 < bVar3) {
              *(byte *)(lVar1 + param_1) = bVar3 - param_5;
              lVar8 = lVar8 + lVar5;
              if (*(char *)(lVar6 + (longlong)pvVar4) == '\0') {
                pcVar2 = (char *)(lVar8 + (longlong)pvVar4);
                *pcVar2 = *pcVar2 + '\x01';
              }
              else {
                pcVar2 = (char *)(lVar8 + (longlong)pvVar4);
                *pcVar2 = *pcVar2 + '\x02';
              }
            }
            if (*(byte *)(lVar6 + param_1) < param_4) {
              lVar8 = param_2 * lVar10;
              lVar1 = lVar8 + lVar5;
              bVar3 = *(byte *)(lVar1 + 1 + param_1);
              if (param_4 < bVar3) {
                lVar8 = lVar8 + lVar5;
                *(byte *)(lVar1 + 1 + param_1) = bVar3 - param_5;
                if (*(char *)(lVar6 + (longlong)pvVar4) == '\0') {
                  pcVar2 = (char *)(lVar8 + 1 + (longlong)pvVar4);
                  *pcVar2 = *pcVar2 + '\x01';
                }
                else {
                  pcVar2 = (char *)(lVar8 + 1 + (longlong)pvVar4);
                  *pcVar2 = *pcVar2 + '\x02';
                }
              }
            }
          }
          lVar5 = lVar5 + 1;
          iVar9 = iVar9 + 1;
        } while (lVar5 < param_2 + -1);
      }
      iVar7 = iVar7 + param_2;
      lVar10 = lVar10 + 1;
      uVar11 = uVar11 - 1;
    } while (uVar11 != 0);
  }
  FUN_18001fcb8(pvVar4);
  return;
}



void FUN_1800134d0(longlong param_1,int param_2,int param_3,byte param_4,byte param_5)

{
  int iVar1;
  byte *pbVar2;
  longlong lVar3;
  
  iVar1 = param_2 * param_3 + -1;
  if (-1 < iVar1) {
    pbVar2 = (byte *)(iVar1 + param_1);
    lVar3 = (longlong)iVar1 + 1;
    do {
      if (*pbVar2 < param_4) {
        iVar1 = 0;
        if (-1 < (int)((uint)*pbVar2 - (uint)param_5)) {
          iVar1 = (uint)*pbVar2 - (uint)param_5;
        }
        *pbVar2 = (byte)iVar1;
      }
      pbVar2 = pbVar2 + -1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  return;
}



undefined8 FUN_180013504(byte *param_1,int param_2,byte *param_3,byte *param_4,int param_5)

{
  ulonglong uVar1;
  uint uVar2;
  byte bVar3;
  ulonglong uVar4;
  uint uVar5;
  int iVar7;
  ulonglong uVar8;
  byte bVar9;
  ulonglong uVar6;
  
  uVar8 = 0;
  bVar9 = 0xff;
  bVar3 = 0;
  iVar7 = 0;
  uVar1 = uVar8;
  if (0 < param_2) {
    uVar4 = uVar8;
    uVar6 = uVar8;
    bVar3 = 0;
    do {
      if (*param_1 < bVar9) {
        bVar9 = *param_1;
        uVar4 = uVar6;
      }
      iVar7 = (int)uVar4;
      if (bVar3 < *param_1) {
        bVar3 = *param_1;
        uVar1 = uVar6;
      }
      uVar5 = (int)uVar6 + 1;
      uVar6 = (ulonglong)uVar5;
      param_1 = param_1 + param_5;
    } while ((int)uVar5 < param_2);
  }
  *param_3 = bVar9;
  *param_4 = bVar3;
  if ((bVar9 < bVar3) &&
     (uVar5 = (int)uVar1 - iVar7, uVar2 = (int)uVar5 >> 0x1f, uVar5 = ((uVar5 ^ uVar2) - uVar2) - 2,
     uVar1 = (ulonglong)uVar5, uVar5 < 4)) {
    uVar1 = 0;
    uVar8 = (ulonglong)((uint)bVar3 - (uint)bVar9);
  }
  return CONCAT71((int7)(uVar1 >> 8),(char)uVar8);
}



uint FUN_180013590(byte *param_1,int param_2,int param_3,int param_4)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  undefined7 extraout_var_07;
  undefined7 extraout_var_08;
  undefined7 extraout_var_09;
  undefined7 extraout_var_10;
  byte bVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  
  iVar6 = (int)((param_2 >> 0x1f & 3U) + param_2) >> 2;
  iVar2 = (int)(param_2 * 3 + (param_2 * 3 >> 0x1f & 3U)) >> 2;
  iVar3 = FUN_180005ae0(param_1,param_2,param_3);
  bVar4 = 0x12;
  if (((byte)iVar3 != 0) && (bVar4 = (byte)iVar3 >> 1, bVar4 < 0x12)) {
    bVar4 = 0x12;
  }
  bVar1 = FUN_180013168((longlong)param_1,param_2,param_3,5,param_4,(uint)bVar4);
  uVar5 = (uint)((int)CONCAT71(extraout_var,bVar1) != 0);
  bVar1 = FUN_180013168((longlong)param_1,param_2,param_3,param_3 / 2,param_4,(uint)bVar4);
  if ((int)CONCAT71(extraout_var_00,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  uVar7 = (uint)bVar4;
  bVar1 = FUN_180013168((longlong)param_1,param_2,param_3,param_3 + -5,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_01,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar1 = FUN_180013034((longlong)param_1,param_2,param_3,iVar6,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_02,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar1 = FUN_180013034((longlong)param_1,param_2,param_3,param_2 / 2,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_03,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar1 = FUN_180013034((longlong)param_1,param_2,param_3,iVar2,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_04,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  iVar3 = (int)((uint)bVar4 + (uint)bVar4 * 2) >> 1;
  bVar1 = FUN_180013168((longlong)param_1,param_2,param_3,5,param_4,iVar3);
  if ((int)CONCAT71(extraout_var_05,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar1 = FUN_180013168((longlong)param_1,param_2,param_3,param_3 / 2,param_4,iVar3);
  if ((int)CONCAT71(extraout_var_06,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar1 = FUN_180013168((longlong)param_1,param_2,param_3,param_3 + -5,param_4,iVar3);
  if ((int)CONCAT71(extraout_var_07,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar1 = FUN_180013034((longlong)param_1,param_2,param_3,iVar6,param_4,iVar3);
  if ((int)CONCAT71(extraout_var_08,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar1 = FUN_180013034((longlong)param_1,param_2,param_3,param_2 / 2,param_4,iVar3);
  if ((int)CONCAT71(extraout_var_09,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar1 = FUN_180013034((longlong)param_1,param_2,param_3,iVar2,param_4,iVar3);
  if ((int)CONCAT71(extraout_var_10,bVar1) != 0) {
    uVar5 = uVar5 + 1;
  }
  return uVar5;
}



char FUN_1800137e4(longlong *param_1,int param_2,int param_3,int param_4)

{
  longlong lVar1;
  ulonglong uVar2;
  char cVar3;
  
  lVar1 = *param_1;
  uVar2 = FUN_180013898(lVar1,param_2,0x10);
  cVar3 = (int)uVar2 < param_4;
  uVar2 = FUN_180013898((param_2 + -0x11) + lVar1,param_2,0x10);
  if ((int)uVar2 < param_4) {
    cVar3 = cVar3 + '\x01';
  }
  lVar1 = param_1[(longlong)param_3 + -0x11];
  uVar2 = FUN_180013898(lVar1 + (param_2 + -0x11),param_2,0x10);
  if ((int)uVar2 < param_4) {
    cVar3 = cVar3 + '\x01';
  }
  uVar2 = FUN_180013898(lVar1,param_2,0x10);
  if ((int)uVar2 < param_4) {
    cVar3 = cVar3 + '\x01';
  }
  return cVar3;
}



ulonglong FUN_180013898(longlong param_1,int param_2,uint param_3)

{
  byte *pbVar1;
  longlong lVar2;
  int iVar3;
  ulonglong uVar4;
  
  iVar3 = 0;
  if (0 < (int)param_3) {
    uVar4 = (ulonglong)param_3;
    do {
      lVar2 = 0;
      if (0 < (int)param_3) {
        do {
          pbVar1 = (byte *)(lVar2 + param_1);
          lVar2 = lVar2 + 1;
          iVar3 = iVar3 + (uint)*pbVar1;
        } while (lVar2 < (int)param_3);
      }
      param_1 = param_1 + param_2;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  return (longlong)iVar3 / (longlong)(int)(param_3 * param_3) & 0xffffffff;
}



int FUN_1800138e0(byte *param_1,uint param_2,uint param_3,undefined4 *param_4,int param_5)

{
  byte bVar1;
  char cVar2;
  longlong *plVar3;
  undefined8 *puVar4;
  ulonglong uVar5;
  undefined7 extraout_var;
  undefined8 *puVar6;
  undefined8 *puVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  byte local_res10 [8];
  undefined1 local_res18 [16];
  undefined4 in_stack_ffffffffffffffb0;
  
  plVar3 = (longlong *)FUN_180013b54(param_2,param_3);
  puVar4 = (undefined8 *)FUN_180013b54(param_2,param_3);
  iVar8 = (int)(((int)param_2 >> 0x1f & 0xfU) + param_2) >> 4;
  iVar9 = (int)(((int)param_3 >> 0x1f & 0xfU) + param_3) >> 4;
  uVar5 = FUN_180005660(param_1,param_2,param_3,param_2,0);
  if ((int)uVar5 < 0xf5) {
    if (param_4 != (undefined4 *)0x0) {
      FUN_18001fe80((undefined8 *)*plVar3,(undefined8 *)param_1,(longlong)(int)(param_2 * param_3));
      FUN_18000618c((byte *)*plVar3,param_2,param_3,8);
      bVar1 = FUN_180005b14((byte *)*plVar3,param_2,param_3,local_res10,local_res18);
      iVar11 = (uint)local_res10[0] -
               ((int)(((uint)local_res10[0] - (uint)bVar1) +
                     ((int)((uint)local_res10[0] - (uint)bVar1) >> 0x1f & 7U)) >> 3);
      iVar10 = 0xf5;
      if (0xf5 < iVar11) {
        iVar10 = iVar11;
      }
      cVar2 = FUN_1800137e4(plVar3,param_2,param_3,iVar10);
      *param_4 = (int)CONCAT71(extraout_var,cVar2);
    }
    uVar5 = (ulonglong)(int)(param_2 * param_3);
    FUN_18001fe80((undefined8 *)*plVar3,(undefined8 *)param_1,uVar5);
    FUN_18001497c(param_2,param_3,(longlong)plVar3);
    FUN_18001fe80((undefined8 *)*puVar4,(undefined8 *)*plVar3,uVar5);
    FUN_180014b1c(param_2,param_3,(longlong)puVar4,4);
    FUN_18001456c(param_2,param_3,(longlong)plVar3,(longlong)puVar4,0x40);
    if (param_5 == 1) {
      FUN_18001fe80((undefined8 *)param_1,(undefined8 *)*puVar4,uVar5);
    }
    FUN_18001497c(param_2,param_3,(longlong)puVar4);
    puVar6 = (undefined8 *)FUN_180013b54(iVar8,iVar9);
    puVar7 = (undefined8 *)FUN_180013b54(iVar8,iVar9);
    FUN_180013d2c(param_2,param_3,(longlong)puVar4,iVar8,iVar9,(longlong)puVar6,(longlong)puVar7,
                  CONCAT31((int3)((uint)in_stack_ffffffffffffffb0 >> 8),0x32));
    uVar5 = FUN_180013bbc(iVar8,iVar9,(longlong)puVar6,(longlong)puVar7,0x50);
    iVar10 = (int)uVar5;
    if (param_5 == 2) {
      FUN_18001fe80((undefined8 *)param_1,(undefined8 *)*puVar6,(longlong)(iVar8 * iVar9));
    }
    if (param_5 == 3) {
      FUN_18001fe80((undefined8 *)param_1,(undefined8 *)*puVar7,(longlong)(iVar8 * iVar9));
    }
    FUN_18001fcb8(puVar7);
    FUN_18001fcb8(puVar6);
  }
  else {
    if (param_4 != (undefined4 *)0x0) {
      *param_4 = 0;
    }
    iVar10 = iVar8 * iVar9;
  }
  FUN_18001fcb8(puVar4);
  FUN_18001fcb8(plVar3);
  return 0x100 - (iVar10 << 8) / (iVar8 * iVar9);
}



LPVOID FUN_180013b54(int param_1,int param_2)

{
  LPVOID pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = FUN_18001fcf8((longlong)(param_1 * param_2 + param_2 * 8));
  lVar3 = 0;
  if ((pvVar1 != (LPVOID)0x0) && (lVar2 = (longlong)pvVar1 + (longlong)(param_2 * 8), 0 < param_2))
  {
    do {
      *(longlong *)((longlong)pvVar1 + lVar3 * 8) = lVar2;
      lVar3 = lVar3 + 1;
      lVar2 = lVar2 + param_1;
    } while (lVar3 < param_2);
  }
  return pvVar1;
}



ulonglong FUN_180013bbc(int param_1,int param_2,longlong param_3,longlong param_4,byte param_5)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  ulonglong uVar4;
  longlong lVar5;
  int iVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  int iVar9;
  int iVar10;
  ulonglong uVar11;
  longlong lVar12;
  int iVar13;
  ulonglong uVar14;
  
  uVar8 = 0;
  if (0 < param_2) {
    uVar4 = uVar8;
    uVar14 = uVar8;
    do {
      uVar7 = 0;
      iVar13 = (int)uVar4;
      uVar4 = (ulonglong)(iVar13 - 1);
      if (iVar13 < 1) {
        uVar4 = uVar7;
      }
      uVar1 = iVar13 + 1U;
      if (param_2 + -2 < iVar13) {
        uVar1 = param_2 - 1;
      }
      if (0 < (longlong)param_1) {
        uVar11 = uVar7;
        do {
          iVar9 = 0;
          iVar6 = (int)uVar7;
          iVar10 = 0;
          iVar3 = iVar6 + -1;
          if (iVar6 < 1) {
            iVar3 = iVar10;
          }
          uVar2 = iVar6 + 1U;
          if (param_1 + -2 < iVar6) {
            uVar2 = param_1 - 1;
          }
          if ((longlong)(int)uVar4 <= (longlong)(int)uVar1) {
            lVar12 = (longlong)(int)uVar4;
            iVar10 = iVar9;
            do {
              if ((longlong)iVar3 <= (longlong)(int)uVar2) {
                iVar9 = iVar9 + 1 + (uVar2 - iVar3);
                lVar5 = (longlong)iVar3;
                do {
                  if (param_5 < *(byte *)(*(longlong *)(param_4 + lVar12 * 8) + lVar5)) {
                    iVar10 = iVar10 + 1;
                  }
                  lVar5 = lVar5 + 1;
                } while (lVar5 <= (int)uVar2);
              }
              lVar12 = lVar12 + 1;
            } while (lVar12 <= (int)uVar1);
          }
          if (iVar10 <= iVar9 / 2) {
            uVar8 = (ulonglong)((int)uVar8 + 1);
            *(undefined1 *)(uVar11 + *(longlong *)(param_3 + uVar14 * 8)) = 0xff;
          }
          uVar11 = uVar11 + 1;
          uVar7 = (ulonglong)(iVar6 + 1U);
        } while ((longlong)uVar11 < (longlong)param_1);
      }
      uVar14 = uVar14 + 1;
      uVar4 = (ulonglong)(iVar13 + 1U);
    } while ((longlong)uVar14 < (longlong)param_2);
  }
  return uVar8;
}



void FUN_180013d2c(int param_1,int param_2,longlong param_3,int param_4,int param_5,longlong param_6
                  ,longlong param_7,uint param_8)

{
  longlong *plVar1;
  byte *pbVar2;
  byte *pbVar3;
  undefined8 *puVar4;
  byte *pbVar5;
  byte *pbVar6;
  int *piVar7;
  byte *pbVar8;
  byte *pbVar9;
  byte *pbVar10;
  longlong lVar11;
  uint uVar12;
  char cVar13;
  uint uVar14;
  longlong *plVar15;
  longlong lVar16;
  char cVar17;
  byte bVar18;
  uint uVar19;
  undefined1 (*pauVar20) [16];
  longlong *plVar21;
  int iVar22;
  longlong lVar23;
  int iVar24;
  longlong lVar25;
  longlong lVar26;
  longlong *plVar27;
  undefined1 (*pauVar28) [16];
  int *piVar29;
  longlong lVar30;
  longlong lVar31;
  longlong lVar32;
  int iVar33;
  int iVar34;
  int iVar35;
  uint uVar36;
  longlong lVar37;
  int *piVar38;
  longlong lVar39;
  byte *pbVar40;
  int iVar41;
  longlong lVar42;
  int iVar43;
  int iVar44;
  int iVar45;
  int local_res20;
  int local_118;
  int local_114;
  int local_110;
  int local_108;
  longlong *local_100;
  longlong local_e8;
  
  lVar25 = (longlong)param_4;
  uVar14 = param_8 & 0xff;
  local_108 = 0x10;
  plVar15 = (longlong *)FUN_18001fcf8((longlong)((param_4 * 4 + 6) * 0xc));
  plVar1 = plVar15 + 3;
  plVar27 = plVar15 + 6;
  pauVar28 = (undefined1 (*) [16])(plVar15 + 9);
  FUN_180020400(pauVar28,0,(longlong)(param_4 * 0xc));
  lVar16 = (longlong)(param_4 * 4);
  piVar29 = (int *)(*pauVar28 + lVar16);
  lVar30 = (longlong)piVar29 + lVar16;
  lVar37 = (longlong)plVar15 - (longlong)plVar1;
  lVar39 = (longlong)plVar27 - (longlong)plVar1;
  lVar23 = 3;
  plVar21 = plVar1;
  lVar31 = lVar30;
  do {
    *(longlong *)(lVar37 + (longlong)plVar21) = lVar31 + lVar16;
    lVar31 = lVar31 + lVar16 + lVar16;
    *plVar21 = lVar31;
    lVar31 = lVar31 + lVar16;
    *(longlong *)(lVar39 + (longlong)plVar21) = lVar31;
    plVar21 = plVar21 + 1;
    lVar23 = lVar23 + -1;
  } while (lVar23 != 0);
  param_8 = 0;
  local_e8 = -1;
  if (-1 < param_5) {
    local_100 = (longlong *)(param_7 + -8);
    iVar35 = 0;
    do {
      lVar31 = plVar15[2];
      lVar16 = plVar15[5];
      if (iVar35 == 0) {
        iVar35 = 1;
      }
      iVar41 = local_108;
      if (local_108 == param_2) {
        iVar41 = param_2 + -1;
      }
      lVar23 = plVar15[8];
      if ((-1 < (int)(param_8 - 3)) && (0 < lVar25)) {
        pauVar20 = pauVar28;
        lVar32 = lVar25;
        do {
          *(int *)*pauVar20 =
               *(int *)*pauVar20 - *(int *)((lVar31 - (longlong)pauVar28) + (longlong)pauVar20);
          piVar38 = (int *)(((longlong)piVar29 - (longlong)pauVar28) + (longlong)pauVar20);
          *piVar38 = *piVar38 - *(int *)((lVar16 - (longlong)pauVar28) + (longlong)pauVar20);
          piVar38 = (int *)((lVar30 - (longlong)pauVar28) + (longlong)pauVar20);
          *piVar38 = *piVar38 - *(int *)((lVar23 - (longlong)pauVar28) + (longlong)pauVar20);
          pauVar20 = (undefined1 (*) [16])(*pauVar20 + 4);
          lVar32 = lVar32 + -1;
        } while (lVar32 != 0);
      }
      lVar32 = 2;
      plVar21 = plVar15 + 4;
      do {
        lVar32 = lVar32 + -1;
        *(undefined8 *)(lVar37 + 8 + (longlong)plVar21) =
             *(undefined8 *)((longlong)plVar21 + lVar37);
        plVar21[1] = *plVar21;
        puVar4 = (undefined8 *)((longlong)plVar21 + lVar39);
        plVar21 = plVar21 + -1;
        *(undefined8 *)(lVar39 + 0x10 + (longlong)plVar21) = *puVar4;
      } while (0 < lVar32);
      *plVar15 = lVar31;
      *plVar1 = lVar16;
      *plVar27 = lVar23;
      if ((int)param_8 < param_5) {
        local_110 = 0x10;
        if (0 < lVar25) {
          lVar16 = (longlong)iVar35;
          lVar31 = lVar25;
          piVar38 = piVar29;
          iVar35 = 0;
          do {
            if (iVar35 == 0) {
              iVar35 = 1;
            }
            iVar45 = local_110;
            if (local_110 == param_1) {
              iVar45 = param_1 + -1;
            }
            local_res20 = 0;
            local_118 = 0;
            local_114 = 0;
            if (lVar16 < iVar41) {
              lVar23 = (longlong)iVar35;
              iVar43 = 0;
              iVar44 = 0;
              iVar35 = 0;
              plVar21 = (longlong *)(param_3 + 8 + lVar16 * 8);
              lVar32 = iVar41 - lVar16;
              do {
                lVar11 = plVar21[-2];
                if (lVar23 < iVar45) {
                  lVar26 = *plVar21 - lVar11;
                  pbVar40 = (byte *)(lVar11 + 1 + lVar23);
                  lVar42 = iVar45 - lVar23;
                  do {
                    pbVar8 = pbVar40 + lVar26 + -2;
                    bVar18 = *pbVar40;
                    pbVar5 = pbVar40 + lVar26;
                    pbVar6 = pbVar40 + (plVar21[-1] - lVar11);
                    pbVar2 = pbVar40 + -2;
                    pbVar9 = pbVar40 + (plVar21[-1] - lVar11) + -2;
                    pbVar3 = pbVar40 + -1;
                    pbVar10 = pbVar40 + lVar26 + -1;
                    pbVar40 = pbVar40 + 1;
                    iVar22 = ((uint)*pbVar5 - (uint)*pbVar2) + ((uint)*pbVar6 - (uint)*pbVar9) * 4 +
                             ((uint)bVar18 - (uint)*pbVar8);
                    iVar33 = ((uint)*pbVar5 - (uint)*pbVar2) +
                             (((uint)*pbVar10 - (uint)*pbVar3) * 4 - ((uint)bVar18 - (uint)*pbVar8))
                    ;
                    iVar43 = iVar43 + iVar22 * iVar22;
                    iVar35 = iVar35 + iVar33 * iVar22;
                    iVar44 = iVar44 + iVar33 * iVar33;
                    lVar42 = lVar42 + -1;
                    local_res20 = iVar43;
                    local_118 = iVar44;
                    local_114 = iVar35;
                  } while (lVar42 != 0);
                }
                plVar21 = plVar21 + 1;
                lVar32 = lVar32 + -1;
              } while (lVar32 != 0);
            }
            *(int *)((longlong)piVar38 + (*plVar15 - (longlong)piVar29)) = local_res20;
            *(int *)((longlong)piVar38 + (*plVar1 - (longlong)piVar29)) = local_118;
            *(int *)((longlong)piVar38 + (*plVar27 - (longlong)piVar29)) = local_114;
            piVar7 = (int *)(((longlong)pauVar28 - (longlong)piVar29) + (longlong)piVar38);
            *piVar7 = *piVar7 + local_res20;
            *piVar38 = *piVar38 + local_118;
            piVar7 = (int *)((lVar30 - (longlong)piVar29) + (longlong)piVar38);
            *piVar7 = *piVar7 + local_114;
            piVar38 = piVar38 + 1;
            lVar31 = lVar31 + -1;
            iVar35 = local_110;
            local_110 = local_110 + 0x10;
          } while (lVar31 != 0);
        }
      }
      if (-1 < local_e8) {
        iVar35 = 0;
        iVar45 = 0;
        iVar41 = 0;
        if (-1 < lVar25) {
          piVar38 = piVar29 + -3;
          lVar31 = -1;
          do {
            if (-1 < lVar31 + -2) {
              iVar35 = iVar35 - *(int *)((longlong)piVar38 +
                                        ((longlong)pauVar28 - (longlong)piVar29));
              iVar45 = iVar45 - *piVar38;
              iVar41 = iVar41 - *(int *)((longlong)piVar38 + (lVar30 - (longlong)piVar29));
            }
            lVar16 = lVar31 + 1;
            if (lVar16 < lVar25) {
              iVar35 = iVar35 + *(int *)(((longlong)pauVar28 - (longlong)piVar29) + 0xc +
                                        (longlong)piVar38);
              iVar45 = iVar45 + piVar38[3];
              iVar41 = iVar41 + *(int *)((lVar30 - (longlong)piVar29) + 0xc + (longlong)piVar38);
            }
            if (-1 < lVar31) {
              iVar43 = (iVar35 + 0x480) / 0x900;
              iVar44 = (iVar45 + 0x480) / 0x900;
              iVar22 = (iVar41 + 0x480) / 0x900;
              uVar12 = iVar22 * 2;
              uVar36 = iVar43 - iVar44;
              if (uVar36 == 0) {
                cVar17 = '\x1e';
                if (0 < (int)uVar12) {
                  cVar17 = 'Z';
                }
              }
              else {
                iVar24 = (uVar36 ^ (int)uVar36 >> 0x1f) - ((int)uVar36 >> 0x1f);
                iVar33 = (uVar12 ^ (int)uVar12 >> 0x1f) - ((int)uVar12 >> 0x1f);
                if (iVar24 < iVar33) {
                  uVar19 = 0x1e0 - (byte)(&DAT_18003ef10)[(iVar33 / 2 + iVar24 * 0x80) / iVar33];
                }
                else {
                  uVar19 = (uint)(byte)(&DAT_18003ef10)[(iVar24 / 2 + iVar33 * 0x80) / iVar24];
                }
                cVar17 = (char)((int)(uVar19 + 8 + ((int)(uVar19 + 8) >> 0x1f & 0xfU)) >> 4);
                if ((int)uVar36 < 0) {
                  if (-1 < (int)uVar12) {
                    if (cVar17 != '\0') {
                      cVar13 = 'x';
                      goto LAB_18001434c;
                    }
                    cVar17 = '\0';
                  }
                }
                else if ((int)uVar12 < 0) {
                  cVar13 = '<';
LAB_18001434c:
                  cVar17 = cVar13 - cVar17;
                }
                else {
                  cVar17 = cVar17 + '<';
                }
              }
              *(char *)(lVar31 + *(longlong *)((param_6 - param_7) + (longlong)local_100)) = cVar17;
              iVar43 = iVar43 / 0x24;
              iVar44 = iVar44 / 0x24;
              iVar34 = iVar43 >> 2;
              iVar33 = iVar44 >> 2;
              iVar24 = iVar34 - iVar33;
              iVar33 = iVar33 + iVar34;
              iVar22 = (iVar22 / 0x24 >> 2) * 2;
              iVar33 = (iVar33 * iVar33) / 0xfe01;
              if ((iVar44 + iVar43 < (int)(uVar14 * uVar14)) || (iVar33 == 0)) {
                iVar33 = 0;
              }
              else {
                iVar33 = (iVar24 * iVar24 + iVar22 * iVar22) / iVar33;
              }
              if (iVar33 < 0xfe01) {
                lVar23 = (longlong)iVar33;
                if (iVar33 < 0x100) {
                  bVar18 = (&DAT_18003eb40)[lVar23];
                }
                else if (iVar33 < 0x400) {
                  bVar18 = (&DAT_18003ec30)[lVar23 >> 4];
                }
                else if (iVar33 < 0x1000) {
                  bVar18 = (&DAT_18003ec50)[lVar23 >> 5];
                }
                else if (iVar33 < 0x4000) {
                  bVar18 = (&DAT_18003ec90)[lVar23 >> 6];
                }
                else {
                  bVar18 = (&DAT_18003ed10)[lVar23 >> 7];
                }
                iVar43 = bVar18 + 1;
                if (iVar43 * iVar43 - iVar33 < (int)(iVar33 - (uint)bVar18 * (uint)bVar18)) {
                  bVar18 = (byte)iVar43;
                }
              }
              else {
                bVar18 = 0xff;
              }
              *(byte *)(lVar31 + *local_100) = bVar18;
            }
            piVar38 = piVar38 + 1;
            lVar31 = lVar16;
          } while (lVar16 < lVar25);
        }
      }
      local_100 = local_100 + 1;
      local_e8 = local_e8 + 1;
      param_8 = param_8 + 1;
      iVar35 = local_108;
      local_108 = local_108 + 0x10;
    } while (local_e8 < param_5);
  }
  FUN_18001fcb8(plVar15);
  return;
}



void FUN_18001456c(int param_1,int param_2,longlong param_3,longlong param_4,int param_5)

{
  undefined1 (*pauVar1) [16];
  byte *pbVar2;
  byte bVar3;
  longlong lVar4;
  byte bVar5;
  LPVOID pvVar6;
  longlong lVar7;
  longlong lVar8;
  byte bVar9;
  longlong lVar10;
  uint uVar11;
  longlong *plVar12;
  int iVar13;
  undefined1 *puVar14;
  ulonglong uVar15;
  longlong lVar16;
  byte bVar17;
  byte *pbVar18;
  longlong lVar19;
  undefined1 (*pauVar20) [16];
  longlong lVar21;
  longlong lVar22;
  longlong lVar23;
  longlong lVar24;
  int iVar25;
  int iVar26;
  int iVar27;
  ulonglong uVar28;
  longlong lVar29;
  
  lVar29 = (longlong)param_5;
  uVar28 = (ulonglong)param_1;
  lVar10 = (longlong)param_2;
  iVar25 = param_5 * 2 + 1;
  if (iVar25 < param_2) {
    param_2 = iVar25;
  }
  iVar26 = 0;
  uVar15 = (ulonglong)(param_1 << 2);
  pvVar6 = FUN_18001fcf8((longlong)(param_2 * param_1) + uVar15 + lVar10 * 8);
  pauVar1 = (undefined1 (*) [16])(lVar10 * 8 + (longlong)pvVar6);
  puVar14 = *pauVar1 + uVar15;
  FUN_180020400(pauVar1,0,uVar15);
  lVar7 = 0;
  if (0 < param_2) {
    do {
      *(undefined1 **)((longlong)pvVar6 + lVar7 * 8) = puVar14;
      lVar7 = lVar7 + 1;
      puVar14 = puVar14 + uVar28;
    } while (lVar7 < param_2);
  }
  lVar7 = (longlong)-param_5;
  if (lVar7 < lVar10) {
    lVar19 = (longlong)-iVar25;
    plVar12 = (longlong *)(lVar19 * 8 + (longlong)pvVar6);
    lVar8 = (lVar7 - lVar19) * 8 - (longlong)pvVar6;
    lVar16 = lVar7;
    do {
      lVar22 = (lVar19 - lVar7) + lVar16;
      if (-1 < lVar22) {
        pbVar18 = *(byte **)((param_3 - (longlong)pvVar6) + (longlong)plVar12);
        if (0 < (longlong)uVar28) {
          lVar21 = *plVar12 - (longlong)pbVar18;
          uVar15 = uVar28;
          pauVar20 = pauVar1;
          do {
            pbVar2 = pbVar18 + lVar21;
            bVar3 = *pbVar18;
            pbVar18 = pbVar18 + 1;
            uVar11 = (int)((uint)*pbVar2 - (uint)bVar3) >> 0x1f;
            *(uint *)*pauVar20 =
                 *(int *)*pauVar20 - (((uint)*pbVar2 - (uint)bVar3 ^ uVar11) - uVar11);
            pauVar20 = (undefined1 (*) [16])(*pauVar20 + 4);
            uVar15 = uVar15 - 1;
          } while (uVar15 != 0);
        }
        iVar26 = iVar26 + -1;
      }
      if (lVar16 - lVar7 < lVar10) {
        if (-1 < lVar22) {
          plVar12[-lVar19] = *plVar12;
        }
        FUN_18001fe80((undefined8 *)plVar12[-lVar19],
                      *(undefined8 **)
                       (((param_4 + lVar19 * -8) - (longlong)pvVar6) + (longlong)plVar12),uVar28);
        pbVar18 = *(byte **)(((param_3 + lVar19 * -8) - (longlong)pvVar6) + (longlong)plVar12);
        if (0 < (longlong)uVar28) {
          lVar22 = plVar12[-lVar19] - (longlong)pbVar18;
          pauVar20 = pauVar1;
          uVar15 = uVar28;
          do {
            pbVar2 = pbVar18 + lVar22;
            bVar3 = *pbVar18;
            pbVar18 = pbVar18 + 1;
            uVar11 = (int)((uint)*pbVar2 - (uint)bVar3) >> 0x1f;
            *(uint *)*pauVar20 =
                 *(int *)*pauVar20 + (((uint)*pbVar2 - (uint)bVar3 ^ uVar11) - uVar11);
            pauVar20 = (undefined1 (*) [16])(*pauVar20 + 4);
            uVar15 = uVar15 - 1;
          } while (uVar15 != 0);
        }
        iVar26 = iVar26 + 1;
      }
      if (-1 < lVar16) {
        lVar22 = plVar12[lVar7 - lVar19];
        lVar21 = *(longlong *)(lVar8 + param_4 + (longlong)plVar12);
        iVar13 = 0;
        iVar27 = 0;
        lVar4 = *(longlong *)(lVar8 + param_3 + (longlong)plVar12);
        lVar24 = -lVar29;
        if (lVar24 < (longlong)uVar28) {
          lVar23 = 0;
          pauVar20 = pauVar1;
          do {
            if (-1 < lVar23 - iVar25) {
              iVar13 = iVar13 - *(int *)((longlong)pauVar20 + (longlong)iVar25 * -4);
              iVar27 = iVar27 - iVar26;
            }
            if (lVar23 < (longlong)uVar28) {
              iVar13 = iVar13 + *(int *)*pauVar20;
              iVar27 = iVar27 + iVar26;
            }
            if (-1 < lVar23 + lVar24) {
              bVar3 = *(byte *)(lVar23 + (lVar22 - lVar29));
              bVar17 = (byte)((longlong)iVar13 / (longlong)iVar27);
              bVar9 = bVar3 - bVar17;
              if (bVar3 < bVar17) {
                bVar9 = 0;
              }
              bVar17 = bVar3 + bVar17;
              bVar5 = *(byte *)(lVar23 + (lVar4 - lVar29));
              if ((int)(0xff - ((uint)((longlong)iVar13 / (longlong)iVar27) & 0xff)) <
                  (int)(uint)bVar3) {
                bVar17 = 0xff;
              }
              if ((byte)(bVar17 - bVar9) != 0) {
                if (bVar9 < bVar5) {
                  if (bVar5 < bVar17) {
                    bVar5 = (byte)((int)(((uint)bVar5 - (uint)bVar9) * 0xff) /
                                  (int)(uint)(byte)(bVar17 - bVar9));
                  }
                  else {
                    bVar5 = 0xff;
                  }
                }
                else {
                  bVar5 = 0;
                }
              }
              *(byte *)(lVar23 + (lVar21 - lVar29)) = bVar5;
            }
            lVar23 = lVar23 + 1;
            pauVar20 = (undefined1 (*) [16])(*pauVar20 + 4);
          } while (lVar23 + lVar24 < (longlong)uVar28);
        }
      }
      lVar16 = lVar16 + 1;
      plVar12 = plVar12 + 1;
    } while (lVar16 < lVar10);
  }
  FUN_18001fcb8(pvVar6);
  return;
}



void FUN_18001497c(uint param_1,int param_2,longlong param_3)

{
  undefined1 (*pauVar1) [16];
  bool bVar2;
  undefined8 *puVar3;
  undefined8 *puVar4;
  longlong lVar5;
  longlong lVar6;
  int iVar7;
  longlong lVar8;
  ulonglong uVar9;
  longlong lVar10;
  int iVar11;
  int iVar12;
  undefined1 (*pauVar13) [16];
  undefined8 *puVar14;
  undefined8 *puVar15;
  undefined8 *puVar16;
  int local_res8;
  
  uVar9 = (ulonglong)(int)param_1;
  iVar7 = 0;
  lVar8 = (longlong)param_2;
  if ((param_1 & 7) != 0) {
    param_1 = (param_1 & 0xfffffff8) + 8;
  }
  puVar4 = (undefined8 *)FUN_18001fcf8((longlong)(int)(param_1 * 7));
  lVar5 = (longlong)(int)param_1;
  puVar14 = (undefined8 *)(lVar5 + (longlong)puVar4 + lVar5);
  pauVar1 = (undefined1 (*) [16])(lVar5 + (longlong)puVar14);
  FUN_180020400(pauVar1,0,uVar9 << 2);
  local_res8 = -3;
  lVar10 = -1;
  puVar3 = puVar4;
  puVar16 = (undefined8 *)(lVar5 + (longlong)puVar4);
  if (-1 < lVar8) {
    do {
      puVar15 = puVar14;
      puVar14 = puVar3;
      if (-1 < local_res8) {
        lVar5 = 0;
        if (0 < (longlong)uVar9) {
          do {
            *(uint *)(*pauVar1 + lVar5 * 4) =
                 *(int *)(*pauVar1 + lVar5 * 4) - (uint)*(byte *)(lVar5 + (longlong)puVar14);
            lVar5 = lVar5 + 1;
          } while (lVar5 < (longlong)uVar9);
        }
        iVar7 = iVar7 + -1;
      }
      lVar5 = lVar10 + 1;
      if (lVar5 < lVar8) {
        FUN_18001fe80(puVar14,*(undefined8 **)(param_3 + 8 + lVar10 * 8),uVar9);
        lVar6 = 0;
        if (0 < (longlong)uVar9) {
          do {
            *(uint *)(*pauVar1 + lVar6 * 4) =
                 *(int *)(*pauVar1 + lVar6 * 4) + (uint)*(byte *)(lVar6 + (longlong)puVar14);
            lVar6 = lVar6 + 1;
          } while (lVar6 < (longlong)uVar9);
        }
        iVar7 = iVar7 + 1;
      }
      if (-1 < lVar10) {
        iVar11 = 0;
        iVar12 = 0;
        lVar10 = *(longlong *)(param_3 + lVar10 * 8);
        if (-1 < (longlong)uVar9) {
          lVar6 = 0;
          pauVar13 = pauVar1;
          do {
            if (-1 < lVar6 + -3) {
              iVar11 = iVar11 - *(int *)(pauVar13[-1] + 4);
              iVar12 = iVar12 - iVar7;
            }
            if (lVar6 < (longlong)uVar9) {
              iVar11 = iVar11 + *(int *)*pauVar13;
              iVar12 = iVar12 + iVar7;
            }
            if (-1 < lVar6 + -1) {
              *(char *)(lVar10 + -1 + lVar6) = (char)(iVar11 / iVar12);
            }
            pauVar13 = (undefined1 (*) [16])(*pauVar13 + 4);
            bVar2 = lVar6 < (longlong)uVar9;
            lVar6 = lVar6 + 1;
          } while (bVar2);
        }
      }
      local_res8 = local_res8 + 1;
      lVar10 = lVar5;
      puVar3 = puVar16;
      puVar16 = puVar15;
    } while (lVar5 < lVar8);
  }
  FUN_18001fcb8(puVar4);
  return;
}



void FUN_180014b1c(int param_1,int param_2,longlong param_3,int param_4)

{
  undefined1 (*pauVar1) [16];
  LPVOID pvVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  longlong lVar8;
  longlong lVar9;
  undefined1 *puVar10;
  undefined1 (*pauVar11) [16];
  ulonglong uVar12;
  longlong *plVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  ulonglong uVar17;
  int iVar18;
  
  uVar17 = (ulonglong)param_1;
  lVar4 = (longlong)param_2;
  iVar16 = param_4 * 2 + 1;
  if (iVar16 < param_2) {
    param_2 = iVar16;
  }
  uVar12 = (ulonglong)(param_1 << 2);
  iVar18 = 0;
  pvVar2 = FUN_18001fcf8((longlong)(param_2 * param_1) + uVar12 + lVar4 * 8);
  pauVar1 = (undefined1 (*) [16])(lVar4 * 8 + (longlong)pvVar2);
  puVar10 = *pauVar1 + uVar12;
  FUN_180020400(pauVar1,0,uVar12);
  lVar3 = 0;
  if (0 < param_2) {
    do {
      *(undefined1 **)((longlong)pvVar2 + lVar3 * 8) = puVar10;
      lVar3 = lVar3 + 1;
      puVar10 = puVar10 + uVar17;
    } while (lVar3 < param_2);
  }
  lVar3 = (longlong)-param_4;
  if (lVar3 < lVar4) {
    lVar7 = (longlong)-iVar16;
    plVar13 = (longlong *)(lVar7 * 8 + (longlong)pvVar2);
    lVar9 = lVar3;
    do {
      lVar8 = (lVar7 - lVar3) + lVar9;
      if (-1 < lVar8) {
        lVar6 = *plVar13;
        lVar5 = 0;
        if (0 < (longlong)uVar17) {
          do {
            *(uint *)(*pauVar1 + lVar5 * 4) =
                 *(int *)(*pauVar1 + lVar5 * 4) - (uint)*(byte *)(lVar5 + lVar6);
            lVar5 = lVar5 + 1;
          } while (lVar5 < (longlong)uVar17);
        }
        iVar18 = iVar18 + -1;
      }
      if (lVar9 - lVar3 < lVar4) {
        if (-1 < lVar8) {
          plVar13[-lVar7] = *plVar13;
        }
        FUN_18001fe80((undefined8 *)plVar13[-lVar7],
                      *(undefined8 **)
                       (((param_3 + lVar7 * -8) - (longlong)pvVar2) + (longlong)plVar13),uVar17);
        lVar8 = plVar13[-lVar7];
        lVar6 = 0;
        if (0 < (longlong)uVar17) {
          do {
            *(uint *)(*pauVar1 + lVar6 * 4) =
                 *(int *)(*pauVar1 + lVar6 * 4) + (uint)*(byte *)(lVar6 + lVar8);
            lVar6 = lVar6 + 1;
          } while (lVar6 < (longlong)uVar17);
        }
        iVar18 = iVar18 + 1;
      }
      if (-1 < lVar9) {
        lVar8 = *(longlong *)
                 (((lVar3 - lVar7) * 8 - (longlong)pvVar2) + param_3 + (longlong)plVar13);
        iVar14 = 0;
        lVar6 = -(longlong)param_4;
        iVar15 = 0;
        if (lVar6 < (longlong)uVar17) {
          lVar5 = 0;
          pauVar11 = pauVar1;
          do {
            if (-1 < lVar5 - iVar16) {
              iVar14 = iVar14 - *(int *)((longlong)pauVar11 + (longlong)iVar16 * -4);
              iVar15 = iVar15 - iVar18;
            }
            if (lVar5 < (longlong)uVar17) {
              iVar14 = iVar14 + *(int *)*pauVar11;
              iVar15 = iVar15 + iVar18;
            }
            if (-1 < lVar5 + lVar6) {
              *(char *)((lVar8 - param_4) + lVar5) = (char)(iVar14 / iVar15);
            }
            lVar5 = lVar5 + 1;
            pauVar11 = (undefined1 (*) [16])(*pauVar11 + 4);
          } while (lVar5 + lVar6 < (longlong)uVar17);
        }
      }
      lVar9 = lVar9 + 1;
      plVar13 = plVar13 + 1;
    } while (lVar9 < lVar4);
  }
  FUN_18001fcb8(pvVar2);
  return;
}



int thunk_FUN_1800138e0(byte *param_1,uint param_2,uint param_3,undefined4 *param_4,int param_5)

{
  byte bVar1;
  char cVar2;
  longlong *plVar3;
  undefined8 *puVar4;
  ulonglong uVar5;
  undefined7 extraout_var;
  undefined8 *puVar6;
  undefined8 *puVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  byte abStackX_10 [8];
  undefined1 auStackX_18 [16];
  undefined4 in_stack_ffffffffffffffb0;
  
  plVar3 = (longlong *)FUN_180013b54(param_2,param_3);
  puVar4 = (undefined8 *)FUN_180013b54(param_2,param_3);
  iVar8 = (int)(((int)param_2 >> 0x1f & 0xfU) + param_2) >> 4;
  iVar9 = (int)(((int)param_3 >> 0x1f & 0xfU) + param_3) >> 4;
  uVar5 = FUN_180005660(param_1,param_2,param_3,param_2,0);
  if ((int)uVar5 < 0xf5) {
    if (param_4 != (undefined4 *)0x0) {
      FUN_18001fe80((undefined8 *)*plVar3,(undefined8 *)param_1,(longlong)(int)(param_2 * param_3));
      FUN_18000618c((byte *)*plVar3,param_2,param_3,8);
      bVar1 = FUN_180005b14((byte *)*plVar3,param_2,param_3,abStackX_10,auStackX_18);
      iVar11 = (uint)abStackX_10[0] -
               ((int)(((uint)abStackX_10[0] - (uint)bVar1) +
                     ((int)((uint)abStackX_10[0] - (uint)bVar1) >> 0x1f & 7U)) >> 3);
      iVar10 = 0xf5;
      if (0xf5 < iVar11) {
        iVar10 = iVar11;
      }
      cVar2 = FUN_1800137e4(plVar3,param_2,param_3,iVar10);
      *param_4 = (int)CONCAT71(extraout_var,cVar2);
    }
    uVar5 = (ulonglong)(int)(param_2 * param_3);
    FUN_18001fe80((undefined8 *)*plVar3,(undefined8 *)param_1,uVar5);
    FUN_18001497c(param_2,param_3,(longlong)plVar3);
    FUN_18001fe80((undefined8 *)*puVar4,(undefined8 *)*plVar3,uVar5);
    FUN_180014b1c(param_2,param_3,(longlong)puVar4,4);
    FUN_18001456c(param_2,param_3,(longlong)plVar3,(longlong)puVar4,0x40);
    if (param_5 == 1) {
      FUN_18001fe80((undefined8 *)param_1,(undefined8 *)*puVar4,uVar5);
    }
    FUN_18001497c(param_2,param_3,(longlong)puVar4);
    puVar6 = (undefined8 *)FUN_180013b54(iVar8,iVar9);
    puVar7 = (undefined8 *)FUN_180013b54(iVar8,iVar9);
    FUN_180013d2c(param_2,param_3,(longlong)puVar4,iVar8,iVar9,(longlong)puVar6,(longlong)puVar7,
                  CONCAT31((int3)((uint)in_stack_ffffffffffffffb0 >> 8),0x32));
    uVar5 = FUN_180013bbc(iVar8,iVar9,(longlong)puVar6,(longlong)puVar7,0x50);
    iVar10 = (int)uVar5;
    if (param_5 == 2) {
      FUN_18001fe80((undefined8 *)param_1,(undefined8 *)*puVar6,(longlong)(iVar8 * iVar9));
    }
    if (param_5 == 3) {
      FUN_18001fe80((undefined8 *)param_1,(undefined8 *)*puVar7,(longlong)(iVar8 * iVar9));
    }
    FUN_18001fcb8(puVar7);
    FUN_18001fcb8(puVar6);
  }
  else {
    if (param_4 != (undefined4 *)0x0) {
      *param_4 = 0;
    }
    iVar10 = iVar8 * iVar9;
  }
  FUN_18001fcb8(puVar4);
  FUN_18001fcb8(plVar3);
  return 0x100 - (iVar10 << 8) / (iVar8 * iVar9);
}



void FUN_180014dac(byte *param_1,uint param_2,uint param_3,int *param_4,int *param_5,int param_6)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  longlong *plVar7;
  longlong lVar8;
  longlong lVar9;
  longlong lVar10;
  int iVar11;
  int iVar12;
  undefined1 auStackY_118 [32];
  undefined4 in_stack_ffffffffffffff20;
  byte local_d0 [8];
  undefined8 *local_c8;
  longlong *local_c0;
  uint local_b8;
  int local_b4;
  int local_b0;
  undefined1 local_ac [4];
  undefined8 *local_a8;
  undefined4 local_a0;
  int local_9c;
  longlong local_98;
  longlong local_90;
  byte *local_88;
  ulonglong local_80;
  int local_78 [8];
  ulonglong local_58;
  
  local_58 = DAT_18004a880 ^ (ulonglong)auStackY_118;
  local_b8 = param_3;
  local_88 = param_1;
  local_c0 = (longlong *)FUN_180013b54(param_2,param_3);
  local_a8 = (undefined8 *)FUN_180013b54(param_2,param_3);
  iVar12 = 0;
  local_b4 = 0;
  local_a0 = 0;
  local_80 = 0;
  local_78[1] = 0;
  local_78[2] = 0;
  local_78[3] = 0;
  local_78[4] = 0;
  local_78[5] = 0;
  local_78[6] = 0;
  if (param_4 != (int *)0x0) {
    *param_4 = 0;
  }
  if (param_5 != (int *)0x0) {
    *param_5 = 0;
  }
  iVar2 = (int)(param_2 + ((int)param_2 >> 0x1f & 0xfU)) >> 4;
  iVar3 = (int)(param_3 + ((int)param_3 >> 0x1f & 0xfU)) >> 4;
  uVar5 = FUN_180005660(param_1,param_2,param_3,param_2,0);
  plVar7 = local_c0;
  iVar4 = (int)uVar5;
  local_9c = iVar4;
  if (iVar4 < 0xf5) {
    iVar11 = iVar2 + -4;
    local_b0 = (int)(((longlong)iVar11 / 3 + ((longlong)iVar11 >> 0x3f) & 0xffffffffU) >> 0x1f) +
               iVar11 / 3 + (iVar11 >> 0x1f);
    if ((param_4 != (int *)0x0) || (param_5 != (int *)0x0)) {
      FUN_18001fe80((undefined8 *)*local_c0,(undefined8 *)local_88,
                    (longlong)(int)(param_3 * param_2));
      FUN_18000623c((byte *)*plVar7,param_2,param_3,8);
      bVar1 = FUN_180005b14((byte *)*plVar7,param_2,param_3,local_d0,local_ac);
      iVar11 = (uint)local_d0[0] -
               ((int)(((uint)local_d0[0] - (uint)bVar1) +
                     ((int)((uint)local_d0[0] - (uint)bVar1) >> 0x1f & 7U)) >> 3);
      iVar12 = 0xf5;
      if (0xf5 < iVar11) {
        iVar12 = iVar11;
      }
      if ((0x10 < (int)param_2) && (0x10 < (int)param_3)) {
        lVar8 = *local_c0;
        uVar5 = FUN_180013898(lVar8,param_2,0x10);
        local_b4 = (int)uVar5;
        local_78[0] = local_b4;
        uVar5 = FUN_180013898((int)(param_2 - 0x11) + lVar8,param_2,0x10);
        lVar8 = local_c0[(longlong)(int)param_3 + -0x11];
        local_78[1] = (int)uVar5;
        local_c8 = (undefined8 *)(longlong)(int)param_3;
        uVar5 = FUN_180013898(lVar8 + (int)(param_2 - 0x11),param_2,0x10);
        local_78[2] = (int)uVar5;
        uVar6 = FUN_180013898(lVar8,param_2,0x10);
        iVar11 = local_b0;
        local_78[3] = (int)uVar6;
        if (param_4 != (int *)0x0) {
          if (local_b4 < iVar12) {
            *param_4 = *param_4 + 1;
          }
          if (local_78[1] < iVar12) {
            *param_4 = *param_4 + 1;
          }
          if ((int)uVar5 < iVar12) {
            *param_4 = *param_4 + 1;
          }
          if ((int)uVar6 < iVar12) {
            *param_4 = *param_4 + 1;
          }
        }
        iVar4 = local_9c;
        if ((param_5 != (int *)0x0) && (3 < iVar2)) {
          lVar9 = (longlong)(local_b0 * 0x10 + 0xf);
          lVar8 = *local_c0;
          uVar5 = FUN_180013898(lVar9 + lVar8,param_2,0x10);
          local_78[4] = (int)uVar5;
          lVar10 = (longlong)(int)(param_2 + iVar11 * -0x10 + -0x21);
          uVar5 = FUN_180013898(lVar10 + lVar8,param_2,0x10);
          local_78[5] = (int)uVar5;
          lVar8 = local_c0[(longlong)local_c8 + -0x11];
          uVar5 = FUN_180013898(lVar10 + lVar8,param_2,0x10);
          local_78[6] = (int)uVar5;
          local_80 = FUN_180013898(lVar9 + lVar8,param_2,0x10);
          lVar8 = 0;
          local_78[7] = (int)local_80;
          do {
            if (local_78[lVar8] < iVar12) {
              *param_5 = *param_5 + 1;
            }
            lVar8 = lVar8 + 1;
            iVar4 = local_9c;
            param_3 = local_b8;
          } while (lVar8 < 8);
        }
      }
    }
    local_c8 = (undefined8 *)(longlong)(int)(param_3 * param_2);
    FUN_18001fe80((undefined8 *)*local_c0,(undefined8 *)local_88,(ulonglong)local_c8);
    FUN_18001497c(param_2,param_3,(longlong)local_c0);
    FUN_18001fe80((undefined8 *)*local_a8,(undefined8 *)*local_c0,(ulonglong)local_c8);
    FUN_180014b1c(param_2,param_3,(longlong)local_a8,4);
    FUN_18001456c(param_2,param_3,(longlong)local_c0,(longlong)local_a8,0x40);
    if (param_6 == 1) {
      FUN_18001fe80((undefined8 *)local_88,(undefined8 *)*local_a8,(ulonglong)local_c8);
    }
    FUN_18001497c(param_2,param_3,(longlong)local_a8);
    local_c8 = (undefined8 *)FUN_180013b54(iVar2,iVar3);
    plVar7 = (longlong *)FUN_180013b54(iVar2,iVar3);
    FUN_180013d2c(param_2,param_3,(longlong)local_a8,iVar2,iVar3,(longlong)local_c8,(longlong)plVar7
                  ,CONCAT31((int3)((uint)in_stack_ffffffffffffff20 >> 8),0x32));
    local_90 = (longlong)iVar3;
    local_98 = (longlong)iVar2;
    uVar6 = 0;
    uVar5 = uVar6;
    if (0 < iVar3) {
      do {
        lVar8 = 0;
        if (0 < iVar2) {
          do {
            if (0x70 < (byte)(*(char *)(local_c8[uVar5] + lVar8) - 4U)) {
              uVar6 = (ulonglong)((int)uVar6 + 1);
            }
            lVar8 = lVar8 + 1;
          } while (lVar8 < local_98);
          local_a0 = (undefined4)uVar6;
        }
        uVar5 = uVar5 + 1;
        param_3 = local_b8;
        iVar4 = local_9c;
      } while ((longlong)uVar5 < local_90);
    }
    uVar5 = FUN_180013bbc(iVar2,iVar3,(longlong)local_c8,(longlong)plVar7,0x50);
    local_b8 = (uint)uVar5;
    if (param_6 == 2) {
      FUN_18001fe80((undefined8 *)local_88,(undefined8 *)*local_c8,(longlong)(iVar2 * iVar3));
    }
    if (param_6 == 3) {
      FUN_18001fe80((undefined8 *)local_88,(undefined8 *)*plVar7,(longlong)(iVar2 * iVar3));
    }
    if ((0x10 < (int)param_2) && (0x10 < (int)param_3)) {
      if (param_4 != (int *)0x0) {
        if (((local_b4 < iVar12) && (iVar4 <= local_b4)) && (*(byte *)*plVar7 < 0x50)) {
          *param_4 = *param_4 + -1;
        }
        if (((local_78[1] < iVar12) && (iVar4 <= local_78[1])) &&
           (*(byte *)(local_98 + -1 + *plVar7) < 0x50)) {
          *param_4 = *param_4 + -1;
        }
        if (((local_78[2] < iVar12) && (iVar4 <= local_78[2])) &&
           (*(byte *)(plVar7[local_90 + -1] + -1 + local_98) < 0x50)) {
          *param_4 = *param_4 + -1;
        }
        if (((local_78[3] < iVar12) && (iVar4 <= local_78[3])) &&
           (*(byte *)plVar7[local_90 + -1] < 0x50)) {
          *param_4 = *param_4 + -1;
        }
      }
      if ((param_5 != (int *)0x0) && (3 < iVar2)) {
        if ((local_b4 < iVar12) && ((iVar4 <= local_b4 && (*(byte *)*plVar7 < 0x50)))) {
          *param_5 = *param_5 + -1;
        }
        if (((local_78[1] < iVar12) && (iVar4 <= local_78[1])) &&
           (*(byte *)(local_98 + -1 + *plVar7) < 0x50)) {
          *param_5 = *param_5 + -1;
        }
        if (((local_78[2] < iVar12) && (iVar4 <= local_78[2])) &&
           (*(byte *)(plVar7[local_90 + -1] + -1 + local_98) < 0x50)) {
          *param_5 = *param_5 + -1;
        }
        if (((local_78[3] < iVar12) && (iVar4 <= local_78[3])) &&
           (*(byte *)plVar7[local_90 + -1] < 0x50)) {
          *param_5 = *param_5 + -1;
        }
        if (((local_78[4] < iVar12) && (iVar4 <= local_78[4])) &&
           (*(byte *)((longlong)local_b0 + 1 + *plVar7) < 0x50)) {
          *param_5 = *param_5 + -1;
        }
        if (((local_78[5] < iVar12) && (iVar4 <= local_78[5])) &&
           (*(byte *)((local_98 - local_b0) + -2 + *plVar7) < 0x50)) {
          *param_5 = *param_5 + -1;
        }
        if (((local_78[6] < iVar12) && (iVar4 <= local_78[6])) &&
           (*(byte *)((plVar7[local_90 + -1] - (longlong)local_b0) + -2 + local_98) < 0x50)) {
          *param_5 = *param_5 + -1;
        }
        if ((((int)local_80 < iVar12) && (iVar4 <= (int)local_80)) &&
           (*(byte *)(plVar7[local_90 + -1] + 1 + (longlong)local_b0) < 0x50)) {
          *param_5 = *param_5 + -1;
        }
      }
    }
    FUN_18001fcb8(plVar7);
    FUN_18001fcb8(local_c8);
  }
  FUN_18001fcb8(local_a8);
  FUN_18001fcb8(local_c0);
  FUN_18001fe50(local_58 ^ (ulonglong)auStackY_118);
  return;
}



void FUN_18001542c(byte *param_1,int param_2,int param_3,undefined4 *param_4)

{
  ulonglong uVar1;
  
  if (param_4 != (undefined4 *)0x0) {
    uVar1 = FUN_180013278((undefined8 *)param_1,param_2,param_3);
    *param_4 = (int)uVar1;
  }
  FUN_180013590(param_1,param_2,param_3,5);
  return;
}



undefined8 *
FUN_180015480(undefined8 *param_1,undefined2 param_2,longlong param_3,undefined8 param_4,
             uint *param_5)

{
  FUN_18000b7b4(param_1);
  FUN_180015610(param_1 + 0xe,param_2,param_3,param_4,param_5);
  *param_1 = &PTR_FUN_18003f4c0;
  param_1[0xe] = &PTR_LAB_18003f558;
  return param_1;
}



undefined8 * FUN_1800154fc(undefined8 *param_1,longlong param_2,undefined8 param_3)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  HLOCAL pvVar3;
  undefined8 *puVar4;
  uint local_res8 [2];
  
  FUN_18000e894(param_1,param_2,param_3);
  *param_1 = &PTR_FUN_18003f128;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x44,&DAT_18003f060);
  }
  *(undefined4 *)(param_1 + 0x87a) = 0x67;
  *(undefined4 *)((longlong)param_1 + 0x43d4) = 0x34;
  lstrcpyW((LPWSTR)((longlong)param_1 + 0x43ee),L"Fingerprint ET510");
  puVar2 = (undefined8 *)param_1[0x8c5];
  puVar4 = (undefined8 *)0x0;
  if (puVar2 != (undefined8 *)0x0) {
    (**(code **)*puVar2)(puVar2,1);
  }
  puVar1 = (undefined8 *)FUN_180020780(0x8d8);
  puVar2 = puVar4;
  if (puVar1 != (undefined8 *)0x0) {
    puVar2 = FUN_180015480(puVar1,*(undefined2 *)(param_2 + 0x4c),0x18001bf54,param_1,local_res8);
  }
  if (puVar2 != (undefined8 *)0x0) {
    puVar4 = puVar2 + 0xe;
  }
  param_1[0x8c5] = puVar4;
  *(undefined4 *)(param_1 + 99) = 0x14ec;
  pvVar3 = LocalReAlloc((HLOCAL)param_1[0x62],0x14ec,0x42);
  param_1[0x62] = pvVar3;
  return param_1;
}



undefined8 *
FUN_180015610(undefined8 *param_1,undefined2 param_2,longlong param_3,undefined8 param_4,
             uint *param_5)

{
  uint uVar1;
  HLOCAL pvVar2;
  
  *param_1 = &PTR_FUN_18003e498;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  param_1[7] = param_3;
  param_1[8] = param_4;
  uVar1 = ~-(uint)(param_3 != 0) & 0xc000000d;
  *(uint *)(param_1 + 1) = uVar1;
  *param_5 = uVar1;
  *param_1 = &PTR_FUN_18003f070;
  *(undefined2 *)(param_1 + 9) = param_2;
  param_1[0x8a] = 0;
  param_1[0x8b] = 0;
  *(uint *)(param_1 + 0x10c) = (uint)(((byte)param_2 & 0xf) == 1);
  if ((-1 < (int)*param_5) &&
     (*(undefined4 *)((longlong)param_1 + 0x4a) = 0x53494745, *(ushort *)(param_1 + 9) < 3)) {
    pvVar2 = LocalAlloc(0,0x1600);
    param_1[0x8a] = pvVar2;
    if (pvVar2 == (HLOCAL)0x0) {
      *param_5 = 0xc000009a;
    }
  }
  return param_1;
}



void FUN_1800156e4(undefined8 *param_1)

{
  *param_1 = &PTR_FUN_18003f070;
  if ((HLOCAL)param_1[0x8a] != (HLOCAL)0x0) {
    LocalFree((HLOCAL)param_1[0x8a]);
  }
  *param_1 = &PTR_FUN_18003e498;
                    // WARNING: Could not recover jumptable at 0x00018001571c. Too many branches
                    // WARNING: Treating indirect jump as call
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  return;
}



undefined8 * FUN_180015730(undefined8 *param_1,uint param_2)

{
  FUN_1800156e4(param_1 + 0xe);
  FUN_18000b8fc(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



undefined8 * FUN_18001576c(undefined8 *param_1,uint param_2)

{
  *param_1 = &PTR_FUN_18003f128;
  FUN_18000ea94(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



undefined8 * FUN_1800157a8(undefined8 *param_1,uint param_2)

{
  FUN_1800156e4(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



void FUN_1800157d8(longlong *param_1)

{
  undefined8 uVar1;
  bool bVar2;
  undefined4 uVar3;
  int iVar4;
  undefined7 extraout_var;
  short *psVar5;
  longlong lVar6;
  longlong *plVar7;
  uint uVar8;
  undefined1 auStack_118 [32];
  uint local_f8;
  undefined1 *local_f0;
  uint local_e8;
  uint local_e0;
  uint local_d8;
  int local_c8 [2];
  undefined8 local_c0;
  short local_b8 [8];
  undefined1 local_a8 [10];
  ushort local_9e;
  ushort local_9c;
  ushort local_9a;
  WCHAR local_98 [64];
  ulonglong local_18;
  
  local_18 = DAT_18004a880 ^ (ulonglong)auStack_118;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x62,&DAT_18003f060);
  }
  if (param_1[0x8c5] == 0) {
    lVar6 = 0;
  }
  else {
    lVar6 = param_1[0x8c5] + -0x70;
  }
  bVar2 = FUN_18000be70(lVar6,param_1[0x8c4],FUN_180018b28,FUN_180018b70);
  uVar8 = ~-(uint)((int)CONCAT71(extraout_var,bVar2) != 0) & 0xc0000001;
  if ((int)uVar8 < 0) {
    *(undefined4 *)((longlong)param_1 + 0x4614) = 0;
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),99,&DAT_18003f060,uVar8);
    }
  }
  else {
    psVar5 = FUN_18001ba38(local_b8,L"CALIBRATE_VERSION(Sensor)");
    (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar5,0x510d0100);
    uVar3 = (**(code **)(*param_1 + 0x98))(param_1);
    psVar5 = FUN_18001ba38(local_b8,L"CALIBRATE_TYPE(Sensor)");
    (*DAT_18004c5e8)(DAT_18004c910,param_1[0x8c4],psVar5,uVar3);
    GetLocalTime((LPSYSTEMTIME)local_a8);
    local_f8 = (uint)local_a8._4_4_ >> 0x10;
    local_d8 = (uint)local_9a;
    local_e0 = (uint)local_9c;
    local_e8 = (uint)local_9e;
    local_f0 = (undefined1 *)CONCAT44(local_f0._4_4_,(uint)(ushort)local_a8._8_2_);
    FUN_180020f80((undefined1 *)local_98,L"%d/%02d/%02d %02d:%02d:%02d.%03d",
                  (ulonglong)(ushort)local_a8._0_2_,(ulonglong)(ushort)local_a8._2_2_);
    psVar5 = FUN_18001ba38(local_b8,local_98);
    iVar4 = (*DAT_18004c730)(DAT_18004c910,psVar5,0,&local_c0);
    uVar1 = local_c0;
    if (-1 < iVar4) {
      psVar5 = FUN_18001ba38(local_b8,L"CALIBRATE_DATE(Sensor)");
      (*DAT_18004c5e0)(DAT_18004c910,param_1[0x8c4],psVar5,uVar1);
      (*DAT_18004c558)(DAT_18004c910,local_c0);
    }
    iVar4 = (*(code *)PTR_FUN_18004a780)(param_1 + 2,0x10000);
    if (iVar4 != 0) {
      if (param_1[0x8c5] == 0) {
        lVar6 = 0;
      }
      else {
        lVar6 = param_1[0x8c5] + -0x70;
      }
      lVar6 = FUN_18000bb40(lVar6);
      local_f8 = 0x34;
      (*(code *)PTR_FUN_18004a788)(param_1 + 2,L"vdm_bkg",lVar6,0x67);
    }
    *(undefined4 *)((longlong)param_1 + 0x4614) = 1;
    psVar5 = FUN_18001ba38(local_b8,L"RemoteWakeupEnable");
    iVar4 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar5,local_c8);
    if ((iVar4 < 0) || (local_c8[0] != 0)) {
      uVar3 = 1;
    }
    else {
      uVar3 = 0;
    }
    *(undefined4 *)(param_1 + 0x8c3) = uVar3;
    lVar6 = param_1[0x8c5];
    if (lVar6 != 0) {
      lVar6 = lVar6 + -0x70;
    }
    if (*(int *)(lVar6 + 0x8d0) != 0) {
      local_a8._0_2_ = 0x4953;
      local_a8._2_2_ = 0x4547;
      local_a8._4_4_ = 0x5750510;
      GetSystemTimeAsFileTime((LPFILETIME)(local_a8 + 8));
      plVar7 = (longlong *)param_1[0x8c5];
      if (plVar7 != (longlong *)0x0) {
        plVar7 = plVar7 + -0xe;
      }
      iVar4 = (**(code **)(*plVar7 + 0x90))(plVar7,local_a8,1);
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
         (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),100,&DAT_18003f060,iVar4);
      }
      if (-1 < iVar4) {
        psVar5 = FUN_18001ba38(local_b8,L"POA_UUID");
        local_f0 = local_a8;
        local_f8 = 0x10;
        (*DAT_18004c5c0)(DAT_18004c910,param_1[0x8c4],psVar5,3);
      }
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x65,&DAT_18003f060);
    }
  }
  FUN_18001fe50(local_18 ^ (ulonglong)auStack_118);
  return;
}



void FUN_180015bb0(longlong *param_1)

{
  undefined1 auStack_138 [32];
  undefined1 local_118 [256];
  ulonglong local_18;
  
  local_18 = DAT_18004a880 ^ (ulonglong)auStack_138;
  if ((int)param_1[0x10c] == 0) {
    *(undefined4 *)(param_1 + 1) = 0xc0000002;
  }
  else {
    (**(code **)(*param_1 + 0x80))(param_1,0xe0,1,local_118);
  }
  FUN_18001fe50(local_18 ^ (ulonglong)auStack_138);
  return;
}



void FUN_180015c44(longlong *param_1,undefined8 *param_2,int param_3,uint *param_4,int param_5)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  undefined2 uVar4;
  undefined4 uVar5;
  uint uVar6;
  undefined8 *puVar7;
  ushort uVar8;
  byte *pbVar9;
  ulonglong uVar10;
  undefined1 auStack_188 [32];
  undefined1 *local_168;
  byte local_160;
  undefined1 local_15f;
  undefined1 local_15e;
  undefined1 local_15d;
  undefined1 local_15c [4];
  int local_158;
  int local_154;
  int local_150;
  ulonglong local_58;
  
  local_58 = DAT_18004a880 ^ (ulonglong)auStack_188;
  uVar5 = 0xc0000001;
  *param_4 = (uint)(0x2ff < (*(ushort *)(param_1 + 9) & 0xfff0));
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  iVar2 = (**(code **)(*param_1 + 0x80))(param_1,0xa0,1,&local_158);
  if (iVar2 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2f,&DAT_18003f060);
    }
    goto LAB_180015fe8;
  }
  if (((local_158 == -1) && (local_154 == -1)) && (local_150 == -1)) {
    uVar3 = (uint)*(byte *)((longlong)param_2 + 3) << 8;
    uVar6 = uVar3 | (uint)*(byte *)((longlong)param_2 + 2) << 0x10 |
            (uint)*(byte *)((longlong)param_2 + 4);
    uVar10 = (ulonglong)uVar6;
    if ((param_3 == uVar6 + 0x2e) && ((uVar3 & 0xfff) == 0 && *(byte *)((longlong)param_2 + 4) == 0)
       ) {
      local_160 = *(byte *)((longlong)param_2 + 7);
      local_15f = *(undefined1 *)((longlong)param_2 + 9);
      local_15e = *(undefined1 *)((longlong)param_2 + 0xb);
      local_15c[0] = 0;
      local_15d = *(undefined1 *)((longlong)param_2 + 0xd);
      uVar3 = FUN_180021328(&local_160,&local_168,0x10);
      if (local_168 == local_15c) {
        if ((((byte)*(ushort *)(param_1 + 9) ^ (byte)uVar3) & 0xf) == 0) {
          if ((*(ushort *)(param_1 + 9) & 0xfff0) < ((ushort)uVar3 & 0xfff0)) {
            uVar8 = 0;
            if (uVar6 != 0) {
              pbVar9 = (byte *)((longlong)param_2 + 0xe);
              do {
                bVar1 = *pbVar9;
                pbVar9 = pbVar9 + 1;
                uVar8 = *(ushort *)(&DAT_18003f2c0 + (ulonglong)(byte)(bVar1 ^ (byte)uVar8) * 2) ^
                        uVar8 >> 8;
                uVar10 = uVar10 - 1;
              } while (uVar10 != 0);
            }
            if (CONCAT11(*(undefined1 *)((longlong)param_2 + 5),
                         *(undefined1 *)((longlong)param_2 + 6)) == uVar8) {
              if (param_5 != 0) {
                iVar2 = FUN_180017290(param_1,param_2,0xe);
                if (iVar2 < 0) goto LAB_180015fe8;
                puVar7 = (undefined8 *)((longlong)param_2 + 0xe);
                uVar3 = param_3 - 0xe;
                for (; uVar6 != 0; uVar6 = uVar6 - 0x1000) {
                  iVar2 = FUN_1800173b8(param_1,puVar7,0x1000);
                  if (iVar2 < 0) goto LAB_180015f6f;
                  puVar7 = puVar7 + 0x200;
                  uVar3 = uVar3 - 0x1000;
                }
                FUN_180017168(param_1,puVar7,uVar3);
              }
LAB_180015f6f:
              uVar5 = 0x103;
            }
            else {
              if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                  ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
                FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x35,&DAT_18003f060);
              }
              uVar5 = 0xc0000221;
            }
          }
          else {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x34,&DAT_18003f060,
                            uVar3 & 0xffff);
            }
            uVar5 = 0;
          }
          goto LAB_180015fe8;
        }
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x33,&DAT_18003f060,uVar3 & 0xf);
        }
        *param_4 = 0;
      }
      else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
               ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        uVar4 = 0x32;
        goto LAB_180015fd3;
      }
    }
    else if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x31,&DAT_18003f060,param_3);
    }
  }
  else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
           ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    uVar4 = 0x30;
LAB_180015fd3:
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar4,&DAT_18003f060);
  }
  uVar5 = 0xc0000144;
LAB_180015fe8:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar5;
  FUN_18001fe50(local_58 ^ (ulonglong)auStack_188);
  return;
}



void FUN_180016018(void)

{
  return;
}



undefined4 FUN_18001601c(longlong param_1,undefined4 *param_2)

{
  uint uVar1;
  undefined4 uVar2;
  undefined8 *puVar3;
  
  if (*(int *)(param_1 + 0x8d0) == 0) {
    uVar2 = 0xc0000002;
  }
  else {
    FUN_18000bde4(param_1);
    *(undefined4 *)(param_1 + 0x4c8) = 0;
    *(undefined4 *)(param_1 + 0x4cc) = 1;
    FUN_18000bdac(param_1);
    *(undefined4 *)(param_1 + 0x4cc) = 0;
    uVar1 = *(uint *)(param_1 + 0x4c8);
    puVar3 = (undefined8 *)FUN_18000bb40(param_1);
    uVar2 = FUN_1800184d4((longlong *)(param_1 + 0x70),param_2,param_1 + 0x4d0,
                          (undefined1 *)(param_1 + 0x6d0),uVar1,puVar3);
  }
  return uVar2;
}



int FUN_1800160b0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                 undefined4 param_5,undefined4 param_6,undefined8 param_7)

{
  int iVar1;
  undefined2 uVar2;
  
  iVar1 = (**(code **)(param_1 + 0x38))
                    (*(undefined8 *)(param_1 + 0x40),param_2,param_3,1,1,param_6,param_7);
  if (iVar1 < 0) {
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return iVar1;
    }
    if ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0) {
      return iVar1;
    }
    if ((byte)PTR_LOOP_18004a7b8[0x19] < 2) {
      return iVar1;
    }
    uVar2 = 0x42;
  }
  else {
    iVar1 = (**(code **)(param_1 + 0x38))
                      (*(undefined8 *)(param_1 + 0x40),param_4,param_5,1,0,param_6,param_7);
    if (-1 < iVar1) {
      return 0;
    }
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return iVar1;
    }
    if ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0) {
      return iVar1;
    }
    if ((byte)PTR_LOOP_18004a7b8[0x19] < 2) {
      return iVar1;
    }
    uVar2 = 0x43;
  }
  FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar2,&DAT_18003f060,iVar1);
  return iVar1;
}



undefined8 FUN_1800161a4(longlong *param_1,undefined1 (*param_2) [16],uint *param_3)

{
  char cVar1;
  int iVar2;
  undefined8 uVar3;
  int iVar4;
  longlong lVar5;
  longlong lVar6;
  
  if ((param_2 == (undefined1 (*) [16])0x0) || (*param_3 < 0x1524)) {
    *param_3 = 0x1524;
    uVar3 = 0xc0000023;
  }
  else {
    FUN_18001d084(param_1,param_2,param_3);
    *(undefined4 *)(param_2[1] + 8) = 0x16b016b;
    *(undefined4 *)(param_2[1] + 0xc) = 0x16b016b;
    *(undefined4 *)param_2[2] = 0x80101;
    *(longlong *)*param_2 = *(longlong *)*param_2 + 0x14fc;
    *(undefined2 *)(param_2[1] + 4) = 0x510;
    *(undefined8 *)(param_2[2] + 8) = 0;
    *(undefined8 *)param_2[3] = 0;
    *(undefined4 *)(param_2[2] + 8) = 0x14fc;
    *(undefined4 *)(param_2[2] + 0xc) = 0x340067;
    *(undefined2 *)param_2[3] = 0x100;
    param_2[3][2] = 1;
    param_2[3][3] = *(undefined1 *)((longlong)param_1 + 0x309);
    iVar2 = (**(code **)(*param_1 + 0x20))(param_1,param_1[0x62],param_2[3] + 8,0x14ec);
    if (iVar2 == 0) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
         (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x66,&DAT_18003f060);
      }
      iVar2 = 0;
      lVar6 = 0;
      do {
        iVar4 = 0;
        lVar5 = lVar6;
        do {
          cVar1 = (char)iVar4;
          iVar4 = iVar4 + 1;
          lVar6 = lVar5 + 1;
          param_2[3][lVar5 + 8] = cVar1 + (char)iVar2;
          lVar5 = lVar6;
        } while (iVar4 < 0x67);
        iVar2 = iVar2 + 1;
      } while (iVar2 < 0x34);
    }
    *param_3 = *(uint *)*param_2;
    uVar3 = 0;
  }
  return uVar3;
}



void FUN_1800162d0(longlong param_1)

{
  longlong lVar1;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x55,&DAT_18003f060);
  }
  lVar1 = 0;
  if (*(longlong *)(param_1 + 0x4628) != 0) {
    lVar1 = *(longlong *)(param_1 + 0x4628) + -0x70;
  }
  FUN_18000be1c(lVar1,(char *)(param_1 + 0x28));
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x56,&DAT_18003f060);
  }
  return;
}



ulonglong FUN_18001636c(longlong param_1,undefined1 (*param_2) [16])

{
  int iVar1;
  ulonglong uVar2;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4a,&DAT_18003f060);
  }
  uVar2 = FUN_180010384(param_1,param_2);
  if (-1 < (int)uVar2) {
    *(uint *)(param_2[0x61] + 0xc) =
         (uint)(*(ushort *)(*(longlong *)(param_1 + 0x70) + 0x4c) >> 0xc);
    *(uint *)param_2[0x62] = *(ushort *)(*(longlong *)(param_1 + 0x70) + 0x4c) >> 8 & 0xf;
    iVar1 = lstrlenW((LPCWSTR)(param_2[0x21] + 0xc));
    wsprintfW((LPWSTR)(param_2[0x21] + (longlong)iVar1 * 2 + 0xc),L" Rev%04X");
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4b,&DAT_18003f060);
  }
  return uVar2 & 0xffffffff;
}



undefined4 FUN_180016468(longlong param_1,undefined8 *param_2,int *param_3)

{
  byte *pbVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined8 uVar5;
  int iVar6;
  uint uVar7;
  longlong lVar8;
  longlong lVar9;
  undefined8 *puVar10;
  undefined4 uVar11;
  undefined8 *puVar12;
  uint uVar13;
  uint local_res8 [2];
  
  local_res8[0] = 0x14ec;
  lVar9 = *(longlong *)(param_1 + 0x4628);
  uVar11 = 99;
  if (lVar9 == 0) {
    lVar8 = 0;
  }
  else {
    lVar8 = lVar9 + -0x70;
  }
  if (*(int *)(lVar8 + 0x8d0) != 0) {
    if (lVar9 == 0) {
      lVar9 = 0;
    }
    else {
      lVar9 = lVar9 + -0x70;
    }
    pbVar1 = (byte *)(param_1 + 0x4630);
    iVar6 = (**(code **)(*(longlong *)(lVar9 + 0x70) + 0x90))
                      ((longlong *)(lVar9 + 0x70),pbVar1,local_res8);
    if ((-1 < iVar6) && (local_res8[0] != 0)) {
      lVar9 = param_1 + 0x10;
      iVar6 = (*(code *)PTR_FUN_18004a780)(lVar9,0x10000000);
      if (iVar6 != 0) {
        (*(code *)PTR_FUN_18004a788)(lVar9,L"bootRaw",pbVar1,0x67,0x34);
      }
      if (*(longlong *)(param_1 + 0x4628) == 0) {
        lVar8 = 0;
      }
      else {
        lVar8 = *(longlong *)(param_1 + 0x4628) + -0x70;
      }
      uVar7 = FUN_18000b980(lVar8,pbVar1,0x67,0x34,local_res8[0] / 0x14ec,param_3);
      uVar13 = 0;
      puVar10 = param_2;
      puVar12 = (undefined8 *)(param_1 + 0x5ab5);
      do {
        uVar5 = puVar12[1];
        uVar13 = uVar13 + 0x67;
        *puVar10 = *puVar12;
        puVar10[1] = uVar5;
        uVar5 = puVar12[3];
        puVar10[2] = puVar12[2];
        puVar10[3] = uVar5;
        uVar5 = puVar12[5];
        puVar10[4] = puVar12[4];
        puVar10[5] = uVar5;
        uVar5 = puVar12[7];
        puVar10[6] = puVar12[6];
        puVar10[7] = uVar5;
        uVar2 = *(undefined4 *)((longlong)puVar12 + 0x44);
        uVar3 = *(undefined4 *)(puVar12 + 9);
        uVar4 = *(undefined4 *)((longlong)puVar12 + 0x4c);
        *(undefined4 *)(puVar10 + 8) = *(undefined4 *)(puVar12 + 8);
        *(undefined4 *)((longlong)puVar10 + 0x44) = uVar2;
        *(undefined4 *)(puVar10 + 9) = uVar3;
        *(undefined4 *)((longlong)puVar10 + 0x4c) = uVar4;
        uVar2 = *(undefined4 *)((longlong)puVar12 + 0x54);
        uVar3 = *(undefined4 *)(puVar12 + 0xb);
        uVar4 = *(undefined4 *)((longlong)puVar12 + 0x5c);
        *(undefined4 *)(puVar10 + 10) = *(undefined4 *)(puVar12 + 10);
        *(undefined4 *)((longlong)puVar10 + 0x54) = uVar2;
        *(undefined4 *)(puVar10 + 0xb) = uVar3;
        *(undefined4 *)((longlong)puVar10 + 0x5c) = uVar4;
        *(undefined4 *)(puVar10 + 0xc) = *(undefined4 *)(puVar12 + 0xc);
        *(undefined2 *)((longlong)puVar10 + 100) = *(undefined2 *)((longlong)puVar12 + 100);
        *(undefined1 *)((longlong)puVar10 + 0x66) = *(undefined1 *)((longlong)puVar12 + 0x66);
        puVar10 = (undefined8 *)((longlong)puVar10 + 0x67);
        puVar12 = (undefined8 *)((longlong)puVar12 + -0x67);
      } while (uVar13 < 0x14ec);
      if (uVar7 == 0) {
        iVar6 = (*(code *)PTR_FUN_18004a780)(lVar9,0x20000000);
        if (iVar6 != 0) {
          (*(code *)PTR_FUN_18004a788)(lVar9,L"bootImage",param_2,0x67,0x34);
        }
        uVar11 = 1;
      }
      else {
        iVar6 = (*(code *)PTR_FUN_18004a780)(lVar9,0x40000000);
        if (iVar6 != 0) {
          (*(code *)PTR_FUN_18004a788)(lVar9,L"bootFail",param_2,0x67,0x34);
        }
      }
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5b,&DAT_18003f060,*param_3);
      }
    }
  }
  return uVar11;
}



undefined4 FUN_1800166a8(longlong *param_1,undefined8 *param_2,uint *param_3)

{
  int iVar1;
  undefined8 *hMem;
  undefined2 uVar2;
  undefined4 uVar3;
  uint uVar4;
  undefined1 local_res8 [8];
  undefined8 in_stack_ffffffffffffffc8;
  
  uVar3 = (undefined4)((ulonglong)in_stack_ffffffffffffffc8 >> 0x20);
  hMem = (undefined8 *)0x0;
  if ((int)param_1[0x10c] == 0) {
    *(undefined4 *)(param_1 + 1) = 0xc0000002;
    return 0xc0000002;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x90;
  *(undefined1 *)(param_1 + 10) = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(int *)((longlong)param_1 + 0x24a),
                     CONCAT44(uVar3,7),0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar2 = 0x2c;
LAB_18001674f:
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar2,&DAT_18003f060,iVar1);
    }
LAB_18001675f:
    uVar3 = 0xc0000001;
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) || ((char)param_1[0x4a] != '\x01')) {
      if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
         (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2d,&DAT_18003f060,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      uVar3 = 0xc0000144;
      goto LAB_180016875;
    }
    uVar4 = (uint)CONCAT11(*(undefined1 *)((longlong)param_1 + 0x24e),
                           *(undefined1 *)((longlong)param_1 + 0x24f));
    if (uVar4 == 0) {
      *param_3 = 0;
    }
    else {
      hMem = param_2;
      if (*param_3 < uVar4) {
        hMem = (undefined8 *)LocalAlloc(0,(ulonglong)uVar4);
      }
      iVar1 = (**(code **)(*param_1 + 0x58))(param_1,hMem,uVar4,0,local_res8);
      if (iVar1 < 0) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          uVar2 = 0x2e;
          goto LAB_18001674f;
        }
        goto LAB_18001675f;
      }
      if (hMem == param_2) {
        *param_3 = uVar4;
      }
      else {
        FUN_18001fe80(param_2,hMem,(ulonglong)*param_3);
      }
    }
    uVar3 = 0;
  }
LAB_180016875:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if ((hMem != (undefined8 *)0x0) && (hMem != param_2)) {
    LocalFree(hMem);
  }
  *(undefined4 *)(param_1 + 1) = uVar3;
  return uVar3;
}



int FUN_1800168c8(longlong *param_1,undefined8 *param_2,uint param_3)

{
  int iVar1;
  undefined2 uVar2;
  undefined8 *puVar3;
  uint uVar4;
  undefined1 local_res8 [8];
  
  if (*(ushort *)(param_1 + 9) < 3) {
    uVar4 = param_3 + 0x1ff & 0xfffffe00;
    puVar3 = param_2;
    if (param_3 < uVar4) {
      puVar3 = (undefined8 *)param_1[0x8a];
    }
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
    *(char *)(param_1 + 10) = (char)(param_3 + 0x1ff >> 9);
    *(undefined2 *)((longlong)param_1 + 0x4e) = 100;
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,(longlong)param_1 + 0x4a,7,puVar3,uVar4,0,local_res8);
    if (-1 < iVar1) {
      if (puVar3 != param_2) {
        FUN_18001fe80(param_2,puVar3,(ulonglong)param_3);
      }
LAB_180016993:
      iVar1 = 0;
      goto LAB_180016995;
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
        ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_18004a7b8[0x19] < 2))
    goto LAB_180016995;
    uVar2 = 0x16;
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
    *(char *)((longlong)param_1 + 0x4f) = (char)(param_3 >> 8);
    *(undefined1 *)((longlong)param_1 + 0x4e) = 100;
    *(char *)(param_1 + 10) = (char)param_3;
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,(longlong)param_1 + 0x4a,7,param_2,param_3,0,local_res8);
    if (-1 < iVar1) goto LAB_180016993;
    if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
        ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_18004a7b8[0x19] < 2))
    goto LAB_180016995;
    uVar2 = 0x17;
  }
  FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar2,&DAT_18003f060,param_3);
LAB_180016995:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



undefined4 FUN_180016a54(longlong *param_1,undefined1 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar2 = 0;
  *(undefined2 *)((longlong)param_1 + 0x4e) = 3;
  *(undefined1 *)(param_1 + 10) = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(int *)((longlong)param_1 + 0x24a),7,0,
                     local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x18,&DAT_18003f060,iVar1);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && ((char)param_1[0x4a] == '\x01')) {
    *param_2 = *(undefined1 *)((longlong)param_1 + 0x24f);
  }
  else {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x19,&DAT_18003f060,
                    (uint)*(byte *)(param_1 + 0x4a));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



undefined4
FUN_180016b70(longlong *param_1,undefined8 param_2,undefined8 *param_3,undefined4 *param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  DWORD DVar3;
  int iVar4;
  undefined8 uVar5;
  longlong *plVar6;
  undefined8 *puVar7;
  undefined2 uVar8;
  undefined8 *puVar9;
  undefined4 uVar10;
  uint uVar11;
  
  uVar11 = 0xffffffff;
  if ((HANDLE)param_1[0x878] == (HANDLE)0x0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
        ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_18004a7b8[0x19] < 4))
    goto LAB_180016c49;
    uVar8 = 0x59;
  }
  else {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      DVar3 = GetThreadId((HANDLE)param_1[0x878]);
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x57,&DAT_18003f060,DVar3);
    }
    WaitForSingleObject((HANDLE)param_1[0x878],0xffffffff);
    if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
        ((PTR_LOOP_18004a7b8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_18004a7b8[0x19] < 4))
    goto LAB_180016c49;
    uVar8 = 0x58;
  }
  FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar8,&DAT_18003f060);
LAB_180016c49:
  if ((int)param_1[0x8c3] != 0) {
    uVar11 = *(uint *)((longlong)param_1 + 0x460c);
  }
  if (param_1[0x8c5] == 0) {
    plVar6 = (longlong *)0x0;
  }
  else {
    plVar6 = (longlong *)(param_1[0x8c5] + -0x70);
  }
  uVar5 = FUN_18000b9e4(plVar6,(char *)(param_1 + 5),param_1 + 0x8c6,param_4,uVar11);
  iVar4 = (int)uVar5;
  if (iVar4 == 0) {
    uVar11 = 0;
    puVar7 = param_3;
    puVar9 = (undefined8 *)((longlong)param_1 + 0x5ab5);
    do {
      uVar5 = puVar9[1];
      uVar11 = uVar11 + 0x67;
      *puVar7 = *puVar9;
      puVar7[1] = uVar5;
      uVar5 = puVar9[3];
      puVar7[2] = puVar9[2];
      puVar7[3] = uVar5;
      uVar5 = puVar9[5];
      puVar7[4] = puVar9[4];
      puVar7[5] = uVar5;
      uVar5 = puVar9[7];
      puVar7[6] = puVar9[6];
      puVar7[7] = uVar5;
      uVar10 = *(undefined4 *)((longlong)puVar9 + 0x44);
      uVar1 = *(undefined4 *)(puVar9 + 9);
      uVar2 = *(undefined4 *)((longlong)puVar9 + 0x4c);
      *(undefined4 *)(puVar7 + 8) = *(undefined4 *)(puVar9 + 8);
      *(undefined4 *)((longlong)puVar7 + 0x44) = uVar10;
      *(undefined4 *)(puVar7 + 9) = uVar1;
      *(undefined4 *)((longlong)puVar7 + 0x4c) = uVar2;
      uVar10 = *(undefined4 *)((longlong)puVar9 + 0x54);
      uVar1 = *(undefined4 *)(puVar9 + 0xb);
      uVar2 = *(undefined4 *)((longlong)puVar9 + 0x5c);
      *(undefined4 *)(puVar7 + 10) = *(undefined4 *)(puVar9 + 10);
      *(undefined4 *)((longlong)puVar7 + 0x54) = uVar10;
      *(undefined4 *)(puVar7 + 0xb) = uVar1;
      *(undefined4 *)((longlong)puVar7 + 0x5c) = uVar2;
      *(undefined4 *)(puVar7 + 0xc) = *(undefined4 *)(puVar9 + 0xc);
      *(undefined2 *)((longlong)puVar7 + 100) = *(undefined2 *)((longlong)puVar9 + 100);
      *(undefined1 *)((longlong)puVar7 + 0x66) = *(undefined1 *)((longlong)puVar9 + 0x66);
      puVar7 = (undefined8 *)((longlong)puVar7 + 0x67);
      puVar9 = (undefined8 *)((longlong)puVar9 + -0x67);
    } while (uVar11 < 0x14ec);
    iVar4 = (*(code *)PTR_FUN_18004a780)(param_1 + 2,0x1000000);
    if (iVar4 != 0) {
      (*(code *)PTR_FUN_18004a788)(param_1 + 2,L"getImage",param_3,0x67,0x34);
    }
    (**(code **)(*param_1 + 0x170))(param_1);
    uVar10 = 1;
  }
  else if (iVar4 == 0x5b4) {
    uVar10 = 3;
  }
  else {
    uVar10 = 2;
    if (iVar4 == 0x3e3) {
      uVar10 = 0xf;
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5a,&DAT_18003f060,uVar10);
  }
  return uVar10;
}



undefined8 FUN_180016dbc(longlong *param_1)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  short *psVar4;
  undefined7 extraout_var;
  longlong lVar5;
  int local_res8 [2];
  short local_18 [8];
  
  if ((int)param_1[0x67] == 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4c,&DAT_18003f060);
    }
    FUN_18001199c((longlong)param_1);
    psVar4 = FUN_18001ba38(local_18,L"RemoteWakeupEnable");
    iVar2 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar4,local_res8);
    if ((iVar2 < 0) || (local_res8[0] != 0)) {
      uVar3 = 1;
    }
    else {
      uVar3 = 0;
    }
    *(undefined4 *)(param_1 + 0x8c3) = uVar3;
    if (param_1[0x8c5] == 0) {
      lVar5 = 0;
    }
    else {
      lVar5 = param_1[0x8c5] + -0x70;
    }
    bVar1 = FUN_18000c038(lVar5);
    if ((int)CONCAT71(extraout_var,bVar1) == 0) {
      return CONCAT71(extraout_var,bVar1);
    }
    *(undefined4 *)((longlong)param_1 + 0x4614) = 0;
    iVar2 = (**(code **)(*param_1 + 0x148))(param_1);
    if (iVar2 == 0) {
      *(undefined4 *)((longlong)param_1 + 0x4614) = 1;
    }
    else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
             ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
            (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4d,&DAT_18003f060);
    }
    *(undefined4 *)(param_1 + 0x67) = 1;
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4e,&DAT_18003f060,1);
    }
  }
  return 1;
}



ulonglong FUN_180016f18(longlong param_1,HMODULE param_2,undefined8 param_3,undefined4 param_4)

{
  DWORD DVar1;
  uint uVar2;
  HRSRC hResInfo;
  HGLOBAL hResData;
  LPVOID pvVar3;
  short *psVar4;
  ulonglong uVar5;
  short local_28 [8];
  
  uVar5 = 0;
  hResInfo = FindResourceW(param_2,(LPCWSTR)0x627,L"FW575");
  if (hResInfo != (HRSRC)0x0) {
    DVar1 = SizeofResource(param_2,hResInfo);
    hResData = LoadResource(param_2,hResInfo);
    pvVar3 = LockResource(hResData);
    if (*(longlong *)(param_1 + 0x4628) != 0) {
      uVar5 = *(longlong *)(param_1 + 0x4628) - 0x70;
    }
    uVar2 = (**(code **)(*(longlong *)(uVar5 + 0x70) + 0xa8))
                      ((longlong *)(uVar5 + 0x70),pvVar3,DVar1,param_3,param_4);
    uVar5 = (ulonglong)uVar2;
    if (uVar2 == 0x103) {
      psVar4 = FUN_18001ba38(local_28,L"CALIBRATE_VERSION(Sensor)");
      (*DAT_18004c5e8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),psVar4,0);
    }
  }
  return uVar5;
}



undefined4 FUN_180017010(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  longlong lVar2;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5c,&DAT_18003f060);
  }
  lVar2 = 0;
  if (*(longlong *)(param_1 + 0x4628) != 0) {
    lVar2 = *(longlong *)(param_1 + 0x4628) + -0x70;
  }
  uVar1 = (**(code **)(*(longlong *)(lVar2 + 0x70) + 0x30))
                    ((longlong *)(lVar2 + 0x70),param_2,param_3);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5d,&DAT_18003f060);
  }
  return uVar1;
}



undefined4 FUN_1800170cc(longlong param_1)

{
  undefined4 uVar1;
  longlong lVar2;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5e,&DAT_18003f060);
  }
  lVar2 = 0;
  if (*(longlong *)(param_1 + 0x4628) != 0) {
    lVar2 = *(longlong *)(param_1 + 0x4628) + -0x70;
  }
  uVar1 = (**(code **)(*(longlong *)(lVar2 + 0x70) + 0xb0))();
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x5f,&DAT_18003f060);
  }
  return uVar1;
}



undefined4 FUN_180017168(longlong *param_1,undefined8 *param_2,uint param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res18 [16];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x499;
  *(char *)(param_1 + 10) = (char)param_3;
  FUN_18001fe80((undefined8 *)((longlong)param_1 + 0x51),param_2,(ulonglong)param_3);
  uVar2 = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,param_3 + 7,(int *)((longlong)param_1 + 0x24a)
                     ,7,0,local_res18);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x40,&DAT_18003f060,iVar1);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) || ((char)param_1[0x4a] != '\x01')) {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x41,&DAT_18003f060,
                    (uint)*(byte *)(param_1 + 0x4a));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



undefined4 FUN_180017290(longlong *param_1,undefined8 *param_2,uint param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res18 [16];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x199;
  *(char *)(param_1 + 10) = (char)param_3;
  FUN_18001fe80((undefined8 *)((longlong)param_1 + 0x51),param_2,(ulonglong)param_3);
  uVar2 = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,param_3 + 7,(int *)((longlong)param_1 + 0x24a)
                     ,7,0,local_res18);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3a,&DAT_18003f060,iVar1);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) || ((char)param_1[0x4a] != '\x01')) {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3b,&DAT_18003f060,
                    (uint)*(byte *)(param_1 + 0x4a));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



undefined4 FUN_1800173b8(longlong *param_1,undefined8 param_2,int param_3)

{
  int iVar1;
  undefined2 uVar2;
  undefined4 uVar3;
  undefined1 local_res18 [16];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (param_3 != 0x1000) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3c,&DAT_18003f060,param_3);
    }
    uVar3 = 0xc000000d;
    goto LAB_180017544;
  }
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x299;
  *(undefined1 *)(param_1 + 10) = 0x10;
  iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res18);
  uVar3 = 0;
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar2 = 0x3d;
LAB_180017479:
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar2,&DAT_18003f060,iVar1);
    }
  }
  else {
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,param_2,0x1000,(int *)((longlong)param_1 + 0x24a),7,0,local_res18);
    if (-1 < iVar1) {
      if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) || ((char)param_1[0x4a] != '\x01')) {
        if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
           (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3f,&DAT_18003f060,
                        (uint)*(byte *)(param_1 + 0x4a));
        }
        uVar3 = 0xc0000144;
      }
      goto LAB_180017544;
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar2 = 0x3e;
      goto LAB_180017479;
    }
  }
  uVar3 = 0xc0000001;
LAB_180017544:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar3;
  return uVar3;
}



bool FUN_180017568(undefined8 param_1,LPCWSTR param_2,undefined1 *param_3)

{
  int iVar1;
  short *psVar2;
  undefined1 local_res20 [8];
  short local_18 [8];
  
  psVar2 = FUN_18001ba38(local_18,param_2);
  iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_1,psVar2,local_res20);
  if (iVar1 == 0) {
    *param_3 = local_res20[0];
  }
  return iVar1 == 0;
}



void FUN_1800175b8(longlong *param_1)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  short *psVar4;
  undefined7 extraout_var;
  longlong lVar5;
  undefined7 extraout_var_00;
  longlong *plVar6;
  undefined1 auStack_88 [32];
  undefined4 local_68;
  undefined4 *local_60;
  int local_58 [2];
  short local_50 [8];
  undefined4 local_40;
  undefined4 local_3c;
  _FILETIME local_38;
  ulonglong local_30;
  
  local_30 = DAT_18004a880 ^ (ulonglong)auStack_88;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x45,&DAT_18003f060);
  }
  psVar4 = FUN_18001ba38(local_50,L"CALIBRATE_TYPE(Sensor)");
  uVar2 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar4,local_58);
  if (-1 < (int)uVar2) {
    iVar3 = (**(code **)(*param_1 + 0x98))(param_1);
    if (local_58[0] == iVar3) {
      psVar4 = FUN_18001ba38(local_50,L"CALIBRATE_VERSION(Sensor)");
      uVar2 = (*DAT_18004c5b8)(DAT_18004c910,param_1[0x8c4],psVar4,local_58);
      if (-1 < (int)uVar2) {
        if (local_58[0] == 0x510d0100) {
          if (param_1[0x8c5] == 0) {
            lVar5 = 0;
          }
          else {
            lVar5 = param_1[0x8c5] + -0x70;
          }
          bVar1 = FUN_18000bb6c(lVar5,param_1[0x8c4],FUN_180017568,FUN_1800178d8);
          uVar2 = ~-(uint)((int)CONCAT71(extraout_var,bVar1) != 0) & 0xc0000001;
          if (-1 < (int)uVar2) {
            lVar5 = param_1[0x8c5];
            if (lVar5 != 0) {
              lVar5 = lVar5 + -0x70;
            }
            if (*(int *)(lVar5 + 0x8d0) != 0) {
              bVar1 = FUN_1800178d8(param_1[0x8c4],L"POA_UUID",&local_40,0x10);
              if ((int)CONCAT71(extraout_var_00,bVar1) != 0) {
                if (param_1[0x8c5] == 0) {
                  lVar5 = 0;
                }
                else {
                  lVar5 = param_1[0x8c5] + -0x70;
                }
                iVar3 = (**(code **)(*(longlong *)(lVar5 + 0x70) + 0xa0))
                                  ((longlong *)(lVar5 + 0x70),&local_40);
                if (-1 < iVar3) goto LAB_18001788a;
              }
              local_40 = 0x45474953;
              local_3c = 0x5750510;
              GetSystemTimeAsFileTime(&local_38);
              plVar6 = (longlong *)param_1[0x8c5];
              if (plVar6 != (longlong *)0x0) {
                plVar6 = plVar6 + -0xe;
              }
              iVar3 = (**(code **)(*plVar6 + 0x90))(plVar6,&local_40,1);
              if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                  ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
                 (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
                FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x48,&DAT_18003f060,iVar3);
              }
              if (-1 < iVar3) {
                FUN_18001ba38(local_50,L"POA_UUID");
                local_60 = &local_40;
                local_68 = 0x10;
                (*DAT_18004c5c0)(DAT_18004c910,param_1[0x8c4],local_50,3);
              }
            }
          }
        }
        else {
          if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_1800178af;
          uVar2 = 0xc0000059;
          if (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0) &&
             (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x47,&DAT_18003f060,local_58[0]
                         );
            uVar2 = 0xc0000059;
          }
        }
      }
    }
    else {
      if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_1800178af;
      uVar2 = 0xc0000059;
      if (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0) &&
         (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x46,&DAT_18003f060);
        uVar2 = 0xc0000059;
      }
    }
  }
LAB_18001788a:
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x49,&DAT_18003f060,uVar2);
  }
LAB_1800178af:
  FUN_18001fe50(local_30 ^ (ulonglong)auStack_88);
  return;
}



bool FUN_1800178d8(undefined8 param_1,LPCWSTR param_2,undefined8 param_3,undefined4 param_4)

{
  int iVar1;
  short *psVar2;
  short local_18 [8];
  
  psVar2 = FUN_18001ba38(local_18,param_2);
  iVar1 = (*DAT_18004c590)(DAT_18004c910,param_1,psVar2,param_4,param_3,0,0);
  return iVar1 == 0;
}



undefined4 FUN_180017944(longlong *param_1,byte param_2,byte param_3,undefined8 param_4)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if ((uint)param_2 + (uint)param_3 < 0x101) {
    uVar2 = 0;
    *(undefined1 *)((longlong)param_1 + 0x4e) = 0x80;
    *(byte *)((longlong)param_1 + 0x4f) = param_2;
    *(byte *)(param_1 + 10) = param_3;
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,(longlong)param_1 + 0x4a,7,param_4,(uint)param_3 << 8,0,local_res10);
    if (iVar1 < 0) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x27,&DAT_18003f060,iVar1);
      }
      uVar2 = 0xc0000001;
    }
  }
  else {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x26,&DAT_18003f060,(uint)param_2);
    }
    uVar2 = 0xc000000d;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



undefined4 FUN_180017a64(longlong *param_1,uint *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar2 = 0;
  *(undefined2 *)((longlong)param_1 + 0x4e) = 5;
  *(undefined1 *)(param_1 + 10) = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(int *)((longlong)param_1 + 0x24a),7,0,
                     local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1c,&DAT_18003f060,iVar1);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && ((char)param_1[0x4a] == '\x01')) {
    *param_2 = (uint)(*(char *)((longlong)param_1 + 0x24f) != '\0');
  }
  else {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1d,&DAT_18003f060,
                    (uint)*(byte *)(param_1 + 0x4a));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



undefined4 FUN_180017b84(longlong *param_1,byte param_2,undefined1 *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar2 = 0;
  *(undefined1 *)((longlong)param_1 + 0x4e) = 0x60;
  *(byte *)((longlong)param_1 + 0x4f) = param_2;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(int *)((longlong)param_1 + 0x24a),7,0,
                     local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),10,&DAT_18003f060,(uint)param_2);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && ((char)param_1[0x4a] == '\x01')) {
    *param_3 = *(undefined1 *)((longlong)param_1 + 0x24f);
  }
  else {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xb,&DAT_18003f060,
                    (uint)*(byte *)(param_1 + 0x4a));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



int FUN_180017cb4(longlong *param_1,ulonglong param_2,undefined8 *param_3,uint param_4)

{
  int iVar1;
  longlong lVar2;
  uint uVar3;
  undefined1 local_res8 [8];
  
  iVar1 = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (param_2 < 0x200) {
    *(char *)((longlong)param_1 + 0x4f) = (char)param_2;
    *(char *)(param_1 + 10) = (char)param_4;
    *(byte *)((longlong)param_1 + 0x4e) = (-((param_2 & 0x100) != 0) & 0xeU) + 0x62;
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,(longlong)param_1 + 0x4a,7,(int *)((longlong)param_1 + 0x24a),
                       param_4 + 7,0,local_res8);
    if (iVar1 < 0) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xc,&DAT_18003f060,
                      (uint)*(byte *)((longlong)param_1 + 0x4f));
      }
LAB_180017f29:
      iVar1 = -0x3fffffff;
    }
    else if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && ((char)param_1[0x4a] == '\x01'))
    {
      FUN_18001fe80(param_3,(undefined8 *)((longlong)param_1 + 0x251),(ulonglong)param_4);
    }
    else {
      if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
         (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xd,&DAT_18003f060,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x3ffffebc;
    }
  }
  else {
    *(undefined1 *)((longlong)param_1 + 0x4e) = 0x60;
    uVar3 = 0;
    if (param_4 != 0) {
      lVar2 = param_2 - (longlong)param_3;
      do {
        *(undefined1 *)((longlong)param_1 + 0x4f) = *(undefined1 *)(lVar2 + (longlong)param_3);
        iVar1 = (**(code **)(*param_1 + 0x60))
                          (param_1,(longlong)param_1 + 0x4a,7,(int *)((longlong)param_1 + 0x24a),7,0
                           ,local_res8);
        if (iVar1 < 0) {
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xe,&DAT_18003f060,
                          (uint)*(byte *)(uVar3 + param_2));
          }
          goto LAB_180017f29;
        }
        if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) || ((char)param_1[0x4a] != '\x01'))
        {
          if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
             (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
            FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xf,&DAT_18003f060,
                          (uint)*(byte *)(param_1 + 0x4a));
          }
          iVar1 = -0x3ffffebc;
          break;
        }
        uVar3 = uVar3 + 1;
        *(undefined1 *)param_3 = *(undefined1 *)((longlong)param_1 + 0x24f);
        param_3 = (undefined8 *)((longlong)param_3 + 1);
      } while (uVar3 < param_4);
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (-1 < iVar1) {
    iVar1 = 0;
  }
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



undefined4 FUN_180017f64(longlong *param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res18 [16];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar2 = 0;
  *(char *)((longlong)param_1 + 0x4f) = (char)((uint)param_3 >> 8);
  *(undefined1 *)((longlong)param_1 + 0x4e) = 0x72;
  *(char *)(param_1 + 10) = (char)param_3;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,param_2,param_3,0,local_res18);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x22,&DAT_18003f060,iVar1);
    }
    uVar2 = 0xc0000001;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



int FUN_180018024(longlong *param_1)

{
  int iVar1;
  undefined1 local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x98;
  *(undefined1 *)(param_1 + 10) = 0;
  iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x36,&DAT_18003f060,iVar1);
    }
    goto LAB_180018134;
  }
  iVar1 = (**(code **)(*param_1 + 0x58))(param_1,(int *)((longlong)param_1 + 0x24a),7,1,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x37,&DAT_18003f060,iVar1);
    }
    if ((*(ushort *)(param_1 + 9) & 0xff00) < 0x300) goto LAB_180018134;
  }
  else {
    if (*(int *)((longlong)param_1 + 0x24a) != 0x45474953) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x38,&DAT_18003f060);
      }
      iVar1 = -0x3ffffebc;
      goto LAB_180018134;
    }
    if (*(byte *)(param_1 + 0x4a) != 1) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x39,&DAT_18003f060,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x3ffffffe;
      goto LAB_180018134;
    }
  }
  iVar1 = 0;
LAB_180018134:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_1800181e8(longlong *param_1)

{
  int iVar1;
  char local_res8 [8];
  undefined1 local_res10 [8];
  
  if ((*(ushort *)(param_1 + 9) & 0xfff0) < 0x1071) {
    local_res8[0] = '\x01';
    iVar1 = (**(code **)(*param_1 + 8))(param_1,2,local_res8);
    if (((-1 < iVar1) && (local_res8[0] != '\x01')) &&
       (iVar1 = (**(code **)(*param_1 + 0x10))(param_1,2,1), -1 < iVar1)) {
      iVar1 = FUN_180018024(param_1);
      if (-1 < iVar1) {
        return iVar1;
      }
      (**(code **)(*param_1 + 0x10))(param_1,2,local_res8[0]);
      (**(code **)(*param_1 + 0x48))(param_1,local_res10);
      return iVar1;
    }
  }
  iVar1 = FUN_180018024(param_1);
  return iVar1;
}



int FUN_180018284(longlong *param_1)

{
  int iVar1;
  undefined1 local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x97;
  *(undefined1 *)(param_1 + 10) = 0;
  iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1e,&DAT_18003f060,iVar1);
    }
    iVar1 = -0x3fffffff;
    goto LAB_18001838a;
  }
  iVar1 = (**(code **)(*param_1 + 0x58))(param_1,(int *)((longlong)param_1 + 0x24a),7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1f,&DAT_18003f060,iVar1);
    }
    if ((*(ushort *)(param_1 + 9) & 0xff00) < 0x300) goto LAB_18001838a;
  }
  else {
    if (*(int *)((longlong)param_1 + 0x24a) != 0x45474953) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x20,&DAT_18003f060);
      }
      iVar1 = -0x3ffffebc;
      goto LAB_18001838a;
    }
    if (*(byte *)(param_1 + 0x4a) != 1) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x21,&DAT_18003f060,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x3ffffffe;
      goto LAB_18001838a;
    }
  }
  iVar1 = 0;
LAB_18001838a:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



ulonglong FUN_180018440(longlong param_1)

{
  bool bVar1;
  undefined7 extraout_var;
  longlong lVar2;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x60,&DAT_18003f060);
  }
  lVar2 = 0;
  if (*(longlong *)(param_1 + 0x4628) != 0) {
    lVar2 = *(longlong *)(param_1 + 0x4628) + -0x70;
  }
  bVar1 = FUN_18000bd4c(lVar2);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x61,&DAT_18003f060);
  }
  return CONCAT71(extraout_var,bVar1) & 0xffffffff;
}



undefined4
FUN_1800184d4(longlong *param_1,undefined4 *param_2,longlong param_3,undefined1 *param_4,
             uint param_5,undefined8 *param_6)

{
  undefined1 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  undefined8 *puVar5;
  uint uVar6;
  undefined4 uVar7;
  undefined1 *hMem;
  char *pcVar8;
  undefined1 *puVar9;
  undefined8 *puVar10;
  ulonglong uVar11;
  undefined8 *puVar12;
  char cVar13;
  longlong lVar14;
  
  cVar13 = '\0';
  if ((int)param_1[0x10c] == 0) {
    uVar7 = 0xc0000002;
    *(undefined4 *)(param_1 + 1) = 0xc0000002;
  }
  else {
    uVar6 = param_5 * 2 + 0x15 + (-(uint)(param_6 != (undefined8 *)0x0) & 0x14ec);
    hMem = (undefined1 *)LocalAlloc(0x40,(ulonglong)(uVar6 + 0x118 & 0xffffff00));
    if (param_2 != (undefined4 *)0x0) {
      uVar7 = param_2[1];
      uVar2 = param_2[2];
      uVar3 = param_2[3];
      *(undefined4 *)(hMem + 4) = *param_2;
      *(undefined4 *)(hMem + 8) = uVar7;
      *(undefined4 *)(hMem + 0xc) = uVar2;
      *(undefined4 *)(hMem + 0x10) = uVar3;
    }
    hMem[0x18] = (char)param_5;
    *(undefined2 *)(hMem + 0x14) = 0x14ec;
    *(ushort *)(hMem + 0x16) = -(ushort)(param_6 != (undefined8 *)0x0) & 0x14ec;
    if (param_5 != 0) {
      puVar9 = hMem + 0x1a;
      lVar14 = param_3 - (longlong)param_4;
      uVar11 = (ulonglong)param_5;
      do {
        puVar9[-1] = param_4[lVar14];
        uVar1 = *param_4;
        param_4 = param_4 + 1;
        *puVar9 = uVar1;
        puVar9 = puVar9 + 2;
        uVar11 = uVar11 - 1;
      } while (uVar11 != 0);
    }
    if (param_6 != (undefined8 *)0x0) {
      lVar14 = 0x29;
      puVar5 = (undefined8 *)(hMem + (ulonglong)param_5 * 2 + 0x19);
      do {
        puVar12 = param_6;
        puVar10 = puVar5;
        uVar4 = puVar12[1];
        *puVar10 = *puVar12;
        puVar10[1] = uVar4;
        uVar4 = puVar12[3];
        puVar10[2] = puVar12[2];
        puVar10[3] = uVar4;
        uVar4 = puVar12[5];
        puVar10[4] = puVar12[4];
        puVar10[5] = uVar4;
        uVar4 = puVar12[7];
        puVar10[6] = puVar12[6];
        puVar10[7] = uVar4;
        uVar4 = puVar12[9];
        puVar10[8] = puVar12[8];
        puVar10[9] = uVar4;
        uVar4 = puVar12[0xb];
        puVar10[10] = puVar12[10];
        puVar10[0xb] = uVar4;
        uVar4 = puVar12[0xd];
        puVar10[0xc] = puVar12[0xc];
        puVar10[0xd] = uVar4;
        uVar4 = puVar12[0xf];
        puVar10[0xe] = puVar12[0xe];
        puVar10[0xf] = uVar4;
        lVar14 = lVar14 + -1;
        puVar5 = puVar10 + 0x10;
        param_6 = puVar12 + 0x10;
      } while (lVar14 != 0);
      uVar4 = puVar12[0x11];
      puVar10[0x10] = puVar12[0x10];
      puVar10[0x11] = uVar4;
      uVar4 = puVar12[0x13];
      puVar10[0x12] = puVar12[0x12];
      puVar10[0x13] = uVar4;
      uVar4 = puVar12[0x15];
      puVar10[0x14] = puVar12[0x14];
      puVar10[0x15] = uVar4;
      uVar4 = puVar12[0x17];
      puVar10[0x16] = puVar12[0x16];
      puVar10[0x17] = uVar4;
      uVar7 = *(undefined4 *)((longlong)puVar12 + 0xc4);
      uVar2 = *(undefined4 *)(puVar12 + 0x19);
      uVar3 = *(undefined4 *)((longlong)puVar12 + 0xcc);
      *(undefined4 *)(puVar10 + 0x18) = *(undefined4 *)(puVar12 + 0x18);
      *(undefined4 *)((longlong)puVar10 + 0xc4) = uVar7;
      *(undefined4 *)(puVar10 + 0x19) = uVar2;
      *(undefined4 *)((longlong)puVar10 + 0xcc) = uVar3;
      uVar4 = puVar12[0x1b];
      puVar10[0x1a] = puVar12[0x1a];
      puVar10[0x1b] = uVar4;
      puVar10[0x1c] = puVar12[0x1c];
      *(undefined4 *)(puVar10 + 0x1d) = *(undefined4 *)(puVar12 + 0x1d);
    }
    uVar11 = (ulonglong)uVar6;
    pcVar8 = hMem + 4;
    if (uVar6 != 0) {
      do {
        cVar13 = cVar13 + *pcVar8;
        pcVar8 = pcVar8 + 1;
        uVar11 = uVar11 - 1;
      } while (uVar11 != 0);
    }
    *(short *)(hMem + 2) = (short)uVar6;
    *hMem = 1;
    hMem[1] = -cVar13;
    uVar7 = (**(code **)(*param_1 + 0x88))
                      (param_1,CONCAT71((uint7)(uint3)(uVar6 >> 8),0xe0),uVar6 + 0x118 >> 8,hMem);
    LocalFree(hMem);
  }
  return uVar7;
}



undefined4 FUN_1800186bc(longlong param_1,int param_2)

{
  bool bVar1;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  longlong lVar2;
  undefined4 uVar3;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x51,&DAT_18003f060);
  }
  lVar2 = *(longlong *)(param_1 + 0x4628);
  if (param_2 == 0) {
    if (lVar2 == 0) {
      lVar2 = 0;
    }
    else {
      lVar2 = lVar2 + -0x70;
    }
    bVar1 = FUN_18000bde4(lVar2);
    uVar3 = 1;
    if ((int)CONCAT71(extraout_var_00,bVar1) == 0) {
      uVar3 = 2;
    }
  }
  else {
    if (lVar2 == 0) {
      lVar2 = 0;
    }
    else {
      lVar2 = lVar2 + -0x70;
    }
    bVar1 = FUN_18000bd74(lVar2);
    uVar3 = 1;
    if ((int)CONCAT71(extraout_var,bVar1) == 0) {
      uVar3 = 2;
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x52,&DAT_18003f060,uVar3);
  }
  return uVar3;
}



undefined4 FUN_1800187a0(longlong *param_1,undefined1 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar2 = 0;
  *(undefined1 *)(param_1 + 10) = param_2;
  *(undefined2 *)((longlong)param_1 + 0x4e) = 4;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(int *)((longlong)param_1 + 0x24a),7,0,
                     local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1a,&DAT_18003f060,iVar1);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) || ((char)param_1[0x4a] != '\x01')) {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1b,&DAT_18003f060,
                    (uint)*(byte *)(param_1 + 0x4a));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



undefined8 FUN_1800188b4(longlong param_1,undefined8 *param_2,longlong param_3)

{
  int iVar1;
  undefined8 uVar2;
  wchar_t **ppwVar3;
  int iVar4;
  undefined4 local_res10 [2];
  short local_28 [8];
  wchar_t *local_18;
  undefined4 local_10;
  
  if (param_2 == (undefined8 *)0x0) {
    uVar2 = 0xc000000d;
  }
  else {
    if (*(longlong *)(param_1 + 0x4620) != 0) {
      (*DAT_18004c578)(DAT_18004c910);
    }
    local_10 = 1;
    ppwVar3 = &local_18;
    *(undefined8 *)(param_1 + 0x4620) = *param_2;
    *param_2 = 0;
    local_18 = L"RemoteWakeupEnable";
    iVar4 = 0;
    do {
      FUN_18001ba38(local_28,*ppwVar3);
      iVar1 = (*DAT_18004c5b8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),local_28,local_res10)
      ;
      if (iVar1 < 0) {
        if (param_3 != 0) {
          iVar1 = (*DAT_18004c5b8)(DAT_18004c910,param_3,local_28,local_res10);
          if (-1 < iVar1) goto LAB_180018992;
        }
        (*DAT_18004c5e8)(DAT_18004c910,*(undefined8 *)(param_1 + 0x4620),local_28,local_res10[0]);
      }
LAB_180018992:
      iVar4 = iVar4 + 1;
      ppwVar3 = ppwVar3 + 2;
    } while (iVar4 == 0);
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_1800189b8(longlong param_1)

{
  bool bVar1;
  undefined7 extraout_var;
  longlong lVar2;
  undefined4 uVar3;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x4f,&DAT_18003f060);
  }
  if (*(longlong *)(param_1 + 0x4628) == 0) {
    lVar2 = 0;
  }
  else {
    lVar2 = *(longlong *)(param_1 + 0x4628) + -0x70;
  }
  bVar1 = FUN_18000bdac(lVar2);
  uVar3 = 1;
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    uVar3 = 2;
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x50,&DAT_18003f060,uVar3);
  }
  return uVar3;
}



undefined4 FUN_180018a70(longlong param_1)

{
  bool bVar1;
  undefined7 extraout_var;
  longlong lVar2;
  undefined4 uVar3;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x53,&DAT_18003f060);
  }
  if (*(longlong *)(param_1 + 0x4628) == 0) {
    lVar2 = 0;
  }
  else {
    lVar2 = *(longlong *)(param_1 + 0x4628) + -0x70;
  }
  bVar1 = FUN_18000bde4(lVar2);
  uVar3 = 1;
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    uVar3 = 2;
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x54,&DAT_18003f060,uVar3);
  }
  return uVar3;
}



bool FUN_180018b28(undefined8 param_1,LPCWSTR param_2,undefined1 param_3)

{
  int iVar1;
  short *psVar2;
  short local_18 [8];
  
  psVar2 = FUN_18001ba38(local_18,param_2);
  iVar1 = (*DAT_18004c5e8)(DAT_18004c910,param_1,psVar2,param_3);
  return iVar1 == 0;
}



bool FUN_180018b70(undefined8 param_1,LPCWSTR param_2,undefined8 param_3,undefined4 param_4)

{
  int iVar1;
  short *psVar2;
  short local_18 [8];
  
  psVar2 = FUN_18001ba38(local_18,param_2);
  iVar1 = (*DAT_18004c5c0)(DAT_18004c910,param_1,psVar2,3,param_4,param_3);
  return iVar1 == 0;
}



undefined4 FUN_180018bd0(longlong *param_1,byte param_2,byte param_3,undefined8 param_4)

{
  int iVar1;
  undefined2 uVar2;
  undefined4 uVar3;
  undefined1 local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (0x100 < (uint)param_2 + (uint)param_3) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x28,&DAT_18003f060,(uint)param_2);
    }
    uVar3 = 0xc000000d;
    goto LAB_180018d72;
  }
  *(byte *)((longlong)param_1 + 0x4f) = param_2;
  *(undefined1 *)((longlong)param_1 + 0x4e) = 0x81;
  *(byte *)(param_1 + 10) = param_3;
  iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res10);
  uVar3 = 0;
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar2 = 0x29;
LAB_180018cad:
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar2,&DAT_18003f060,iVar1);
    }
  }
  else {
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,param_4,(ulonglong)param_3 << 8,(int *)((longlong)param_1 + 0x24a),7,
                       0,local_res10);
    if (-1 < iVar1) {
      if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) || ((char)param_1[0x4a] != '\x01')) {
        if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
           (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2b,&DAT_18003f060,
                        (uint)*(byte *)(param_1 + 0x4a));
        }
        uVar3 = 0xc0000144;
      }
      goto LAB_180018d72;
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar2 = 0x2a;
      goto LAB_180018cad;
    }
  }
  uVar3 = 0xc0000001;
LAB_180018d72:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar3;
  return uVar3;
}



undefined4 FUN_180018d9c(longlong *param_1,byte param_2,undefined1 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined1 *)((longlong)param_1 + 0x4e) = 0x61;
  *(byte *)((longlong)param_1 + 0x4f) = param_2;
  *(undefined1 *)(param_1 + 10) = param_3;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(int *)((longlong)param_1 + 0x24a),7,0,
                     local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x10,&DAT_18003f060,(uint)param_2);
    }
    uVar2 = 0xc0000001;
  }
  else if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && ((char)param_1[0x4a] == '\x01')) {
    uVar2 = 0;
    if (*(int *)((longlong)param_1 + 0x45c) != 0) {
      *(byte *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x460 + (longlong)param_1) = param_2;
      *(undefined1 *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x660 + (longlong)param_1) = param_3;
      *(int *)(param_1 + 0x8b) = (int)param_1[0x8b] + 1;
      uVar2 = 0;
      if (0x1ff < *(uint *)(param_1 + 0x8b)) {
        *(undefined4 *)((longlong)param_1 + 0x45c) = 0;
      }
    }
  }
  else {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x11,&DAT_18003f060,
                    (uint)*(byte *)(param_1 + 0x4a));
    }
    uVar2 = 0xc0000144;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar2;
  return uVar2;
}



int FUN_180018f04(longlong *param_1,ulonglong param_2,undefined8 *param_3,uint param_4)

{
  ulonglong uVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  undefined1 local_res8 [8];
  
  iVar2 = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (param_2 < 0x200) {
    *(char *)((longlong)param_1 + 0x4f) = (char)param_2;
    *(char *)(param_1 + 10) = (char)param_4;
    *(byte *)((longlong)param_1 + 0x4e) = (-((param_2 & 0x100) != 0) & 0xeU) + 99;
    FUN_18001fe80((undefined8 *)((longlong)param_1 + 0x51),param_3,(ulonglong)param_4);
    iVar2 = (**(code **)(*param_1 + 0x60))
                      (param_1,(longlong)param_1 + 0x4a,param_4 + 7,
                       (int *)((longlong)param_1 + 0x24a),param_4 + 7,0,local_res8);
    if (iVar2 < 0) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x12,&DAT_18003f060,
                      (uint)*(byte *)((longlong)param_1 + 0x4f));
      }
    }
    else if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && ((char)param_1[0x4a] == '\x01'))
    {
      if (*(int *)((longlong)param_1 + 0x45c) != 0) {
        uVar3 = 0;
        uVar1 = param_2 & 0x100;
        if (param_4 != 0) {
          do {
            *(char *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x460 + (longlong)param_1) =
                 (char)param_2;
            *(undefined1 *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x660 + (longlong)param_1) =
                 *(undefined1 *)param_3;
            *(int *)(param_1 + 0x8b) = (int)param_1[0x8b] + 1;
            if (0x1ff < *(uint *)(param_1 + 0x8b)) {
              *(undefined4 *)((longlong)param_1 + 0x45c) = 0;
              break;
            }
            uVar3 = uVar3 + 1;
            param_3 = (undefined8 *)((longlong)param_3 + 1);
            param_2 = (ulonglong)((int)param_2 + (-(uint)(uVar1 != 0) & 0xfffffffe) + 1);
          } while (uVar3 < param_4);
        }
      }
    }
    else {
      if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
         (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x13,&DAT_18003f060,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar2 = -0x3ffffebc;
    }
  }
  else {
    *(undefined1 *)((longlong)param_1 + 0x4e) = 0x61;
    uVar3 = 0;
    if (param_4 != 0) {
      lVar4 = param_2 - (longlong)param_3;
      do {
        *(undefined1 *)((longlong)param_1 + 0x4f) = *(undefined1 *)(lVar4 + (longlong)param_3);
        *(undefined1 *)(param_1 + 10) = *(undefined1 *)param_3;
        iVar2 = (**(code **)(*param_1 + 0x60))
                          (param_1,(longlong)param_1 + 0x4a,7,(int *)((longlong)param_1 + 0x24a),7,0
                           ,local_res8);
        if (iVar2 < 0) {
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x14,&DAT_18003f060,
                          (uint)*(byte *)(uVar3 + param_2));
          }
          break;
        }
        if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) || ((char)param_1[0x4a] != '\x01'))
        {
          if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
             (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
            FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x15,&DAT_18003f060,
                          (uint)*(byte *)(param_1 + 0x4a));
          }
          iVar2 = -0x3ffffebc;
          break;
        }
        if (*(int *)((longlong)param_1 + 0x45c) != 0) {
          *(undefined1 *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x460 + (longlong)param_1) =
               *(undefined1 *)(lVar4 + (longlong)param_3);
          *(undefined1 *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x660 + (longlong)param_1) =
               *(undefined1 *)param_3;
          *(int *)(param_1 + 0x8b) = (int)param_1[0x8b] + 1;
          if (0x1ff < *(uint *)(param_1 + 0x8b)) {
            *(undefined4 *)((longlong)param_1 + 0x45c) = 0;
          }
        }
        uVar3 = uVar3 + 1;
        param_3 = (undefined8 *)((longlong)param_3 + 1);
      } while (uVar3 < param_4);
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (-1 < iVar2) {
    iVar2 = 0;
  }
  *(int *)(param_1 + 1) = iVar2;
  return iVar2;
}



undefined4 FUN_18001925c(longlong *param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  undefined2 uVar2;
  undefined4 uVar3;
  undefined1 local_res18 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(char *)((longlong)param_1 + 0x4f) = (char)((uint)param_3 >> 8);
  *(undefined1 *)((longlong)param_1 + 0x4e) = 0x73;
  *(char *)(param_1 + 10) = (char)param_3;
  iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res18);
  uVar3 = 0;
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar2 = 0x23;
LAB_1800192df:
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar2,&DAT_18003f060,iVar1);
    }
  }
  else {
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,param_2,param_3,(int *)((longlong)param_1 + 0x24a),7,0,local_res18);
    if (-1 < iVar1) {
      if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) || ((char)param_1[0x4a] != '\x01')) {
        if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
           (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x25,&DAT_18003f060,
                        (uint)*(byte *)(param_1 + 0x4a));
        }
        uVar3 = 0xc0000144;
      }
      goto LAB_1800193a9;
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar2 = 0x24;
      goto LAB_1800192df;
    }
  }
  uVar3 = 0xc0000001;
LAB_1800193a9:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined4 *)(param_1 + 1) = uVar3;
  return uVar3;
}



bool FUN_1800193d4(longlong param_1,byte param_2,byte param_3,undefined8 *param_4)

{
  int iVar1;
  
  iVar1 = FUN_180017cb4((longlong *)(param_1 + 0x70),(ulonglong)param_2,param_4,(uint)param_3);
  return iVar1 == 0;
}



bool FUN_1800193fc(longlong param_1,byte param_2,byte param_3,undefined8 *param_4)

{
  int iVar1;
  
  iVar1 = FUN_180017cb4((longlong *)(param_1 + 0x70),(ulonglong)param_2 | 0x100,param_4,
                        (uint)param_3);
  return iVar1 == 0;
}



bool FUN_18001942c(longlong param_1,byte param_2,byte param_3,undefined8 *param_4)

{
  int iVar1;
  
  iVar1 = FUN_180018f04((longlong *)(param_1 + 0x70),(ulonglong)param_2,param_4,(uint)param_3);
  return iVar1 == 0;
}



bool FUN_180019454(longlong param_1,byte param_2,byte param_3,undefined8 *param_4)

{
  int iVar1;
  
  iVar1 = FUN_180018f04((longlong *)(param_1 + 0x70),(ulonglong)param_2 | 0x100,param_4,
                        (uint)param_3);
  return iVar1 == 0;
}



bool FUN_180019484(longlong param_1,undefined8 *param_2,int param_3,int param_4)

{
  int iVar1;
  
  iVar1 = FUN_1800168c8((longlong *)(param_1 + 0x70),param_2,param_3 * param_4);
  return iVar1 == 0;
}



bool FUN_1800194a4(longlong param_1,byte param_2,undefined1 *param_3)

{
  int iVar1;
  
  iVar1 = FUN_180017b84((longlong *)(param_1 + 0x70),param_2,param_3);
  return iVar1 == 0;
}



bool FUN_1800194c0(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  
  iVar1 = FUN_180017f64((longlong *)(param_1 + 0x70),param_2,param_3);
  return iVar1 == 0;
}



bool FUN_1800194dc(longlong param_1)

{
  int iVar1;
  
  iVar1 = FUN_180018284((longlong *)(param_1 + 0x70));
  return iVar1 == 0;
}



bool FUN_1800194f8(longlong param_1,byte param_2,undefined1 param_3)

{
  int iVar1;
  
  iVar1 = FUN_180018d9c((longlong *)(param_1 + 0x70),param_2,param_3);
  return iVar1 == 0;
}



bool FUN_180019514(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  
  iVar1 = FUN_18001925c((longlong *)(param_1 + 0x70),param_2,param_3);
  return iVar1 == 0;
}



undefined8 * FUN_180019530(undefined8 *param_1)

{
  HANDLE pvVar1;
  
  *param_1 = &PTR_FUN_18003f6d8;
  param_1[1] = &PTR_FUN_18003f6e0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[0xe] = 0;
  *(undefined4 *)(param_1 + 10) = 0;
  pvVar1 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[0xb] = pvVar1;
  pvVar1 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[0xc] = pvVar1;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 5));
  return param_1;
}



void FUN_1800195a4(undefined8 *param_1)

{
  int *piVar1;
  
  *param_1 = &PTR_FUN_18003f6d8;
  param_1[1] = &PTR_FUN_18003f6e0;
  if (param_1[0xe] != 0) {
    piVar1 = (int *)(param_1[0xe] + 8);
    LOCK();
    *piVar1 = *piVar1 + -1;
    UNLOCK();
    if ((*piVar1 == 0) && (piVar1 != (int *)0x0)) {
      thunk_FUN_18001fcb8(piVar1);
    }
  }
  if ((HANDLE)param_1[0xb] != (HANDLE)0x0) {
    CloseHandle((HANDLE)param_1[0xb]);
  }
  if ((HANDLE)param_1[0xc] != (HANDLE)0x0) {
    CloseHandle((HANDLE)param_1[0xc]);
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 5));
  *param_1 = &PTR_FUN_18003e238;
  return;
}



undefined8 * FUN_180019618(undefined8 *param_1,uint param_2)

{
  FUN_1800195a4(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



bool FUN_180019648(longlong param_1,DWORD param_2)

{
  DWORD DVar1;
  HANDLE local_18;
  undefined8 local_10;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x12,&DAT_18003f6c8);
  }
  local_18 = *(HANDLE *)(param_1 + 0x60);
  local_10 = *(undefined8 *)(param_1 + 0x58);
  DVar1 = WaitForMultipleObjects(2,&local_18,0,param_2);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x13,&DAT_18003f6c8,DVar1);
  }
  return DVar1 != 0x102;
}



uint FUN_180019704(longlong param_1,longlong param_2,undefined8 *param_3)

{
  undefined8 *puVar1;
  uint uVar2;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),10,&DAT_18003f6c8);
  }
  puVar1 = (undefined8 *)FUN_180020780(0x78);
  if (puVar1 == (undefined8 *)0x0) {
    puVar1 = (undefined8 *)0x0;
  }
  else {
    puVar1 = FUN_180019530(puVar1);
  }
  uVar2 = ~-(uint)(puVar1 != (undefined8 *)0x0) & 0xc000009a;
  if (-1 < (int)uVar2) {
    uVar2 = FUN_1800198a0((longlong)puVar1,param_1,param_2);
    if ((int)uVar2 < 0) {
      if (puVar1 != (undefined8 *)0x0) {
        (**(code **)*puVar1)(puVar1,1);
      }
    }
    else {
      puVar1[3] = param_1;
      *param_3 = puVar1;
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xb,&DAT_18003f6c8);
  }
  return uVar2;
}



void FUN_180019800(undefined8 param_1)

{
  undefined8 *puVar1;
  
  puVar1 = (undefined8 *)FUN_18001987c(param_1);
  if (puVar1 != (undefined8 *)0x0) {
    (**(code **)*puVar1)(puVar1,1);
  }
  return;
}



void FUN_180019824(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                  undefined4 param_5)

{
  longlong lVar1;
  
  lVar1 = FUN_18001987c(param_1);
  (*(code *)**(undefined8 **)(lVar1 + 8))
            ((undefined8 *)(lVar1 + 8),param_1,param_2,param_5,param_4,param_3);
  return;
}



undefined8 FUN_18001987c(undefined8 param_1)

{
  undefined8 *puVar1;
  
  puVar1 = (undefined8 *)(*DAT_18004c528)(DAT_18004c910,param_1,PTR_DAT_18004a830);
  return *puVar1;
}



int FUN_1800198a0(longlong param_1,longlong param_2,longlong param_3)

{
  int iVar1;
  longlong *plVar2;
  undefined2 uVar3;
  undefined8 local_res10;
  undefined4 local_b8 [2];
  code *local_b0;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined *local_88;
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_70;
  code *local_50;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xc,&DAT_18003f6c8);
  }
  local_res10 = 0;
  if (param_2 == 0) {
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return -0x3ffffff3;
    }
    if ((PTR_LOOP_18004a7b8[0x1c] & 4) == 0) {
      return -0x3ffffff3;
    }
    if ((byte)PTR_LOOP_18004a7b8[0x19] < 2) {
      return -0x3ffffff3;
    }
    uVar3 = 0xd;
  }
  else {
    if (param_3 != 0) {
      FUN_180020400((undefined1 (*) [16])&local_78,0,0x60);
      local_70 = 0;
      local_78 = 0x60;
      local_74 = 1;
      local_50 = FUN_180019824;
      FUN_180020400((undefined1 (*) [16])local_b8,0,0x38);
      local_88 = PTR_DAT_18004a830;
      local_b0 = FUN_180019800;
      local_b8[0] = 0x38;
      local_a0 = 1;
      local_9c = 1;
      iVar1 = (*DAT_18004c3f8)(DAT_18004c910,param_2,&local_78,local_b8,&local_res10);
      if (iVar1 < 0) {
        if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
          return iVar1;
        }
        if ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0) {
          if (1 < (byte)PTR_LOOP_18004a7b8[0x19]) {
            FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xf,&DAT_18003f6c8);
            return iVar1;
          }
          return iVar1;
        }
        return iVar1;
      }
      iVar1 = (*DAT_18004c290)(DAT_18004c910,param_2,local_res10,0xe);
      if (iVar1 < 0) {
        (*DAT_18004c558)(DAT_18004c910,local_res10);
      }
      else {
        plVar2 = (longlong *)(*DAT_18004c528)(DAT_18004c910,local_res10,PTR_DAT_18004a830);
        *plVar2 = param_1;
        *(longlong *)(param_1 + 0x20) = param_3;
        *(undefined8 *)(param_1 + 0x10) = local_res10;
      }
      if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
        return iVar1;
      }
      if ((PTR_LOOP_18004a7b8[0x1c] & 4) == 0) {
        return iVar1;
      }
      if (3 < (byte)PTR_LOOP_18004a7b8[0x19]) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x10,&DAT_18003f6c8);
        return iVar1;
      }
      return iVar1;
    }
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return -0x3ffffff3;
    }
    if ((PTR_LOOP_18004a7b8[0x1c] & 4) == 0) {
      return -0x3ffffff3;
    }
    if ((byte)PTR_LOOP_18004a7b8[0x19] < 2) {
      return -0x3ffffff3;
    }
    uVar3 = 0xe;
  }
  FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar3,&DAT_18003f6c8);
  return -0x3ffffff3;
}



void FUN_180019ab8(longlong param_1)

{
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x28));
  *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
  SetEvent(*(HANDLE *)(param_1 + 0x60));
                    // WARNING: Could not recover jumptable at 0x000180019aea. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x28));
  return;
}



void FUN_180019af4(longlong param_1,undefined8 param_2,longlong param_3,int param_4,
                  undefined8 param_5)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int *piVar1;
  int iVar2;
  longlong lVar3;
  undefined8 uVar4;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18001a360(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x15,&DAT_18003f6c8,param_5);
  }
  if (*(longlong *)(param_1 + 0x18) == 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x16,&DAT_18003f6c8);
    }
    uVar4 = 0xc0000144;
LAB_180019ba8:
    (*DAT_18004c668)(DAT_18004c910,param_3,uVar4);
    return;
  }
  iVar2 = *(int *)(*(longlong *)(param_1 + 0x18) + 0x5c);
  if (4 < iVar2) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x17,&DAT_18003f6c8,iVar2);
    }
    uVar4 = 0xc00002b6;
    goto LAB_180019ba8;
  }
  lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 0x20);
  EnterCriticalSection(lpCriticalSection);
  *(int *)(param_1 + 0x48) = *(int *)(param_1 + 0x48) + 1;
  if (*(int *)(param_1 + 0x48) == 1) {
    ResetEvent(*(HANDLE *)(param_1 + 0x50));
  }
  LeaveCriticalSection(lpCriticalSection);
  lVar3 = *(longlong *)(param_1 + 0x18);
  if (param_4 == 0x220000) {
    FUN_18000d634(lVar3,param_3);
    goto LAB_18001a1ff;
  }
  if (*(int *)(lVar3 + 0x38) != 0) {
    FUN_18000d70c(lVar3,param_3);
    goto LAB_18001a1ff;
  }
  if (*(longlong *)(param_1 + 0x68) == 0) {
    uVar4 = 0xc0000144;
LAB_18001a1ef:
    (*DAT_18004c668)(DAT_18004c910,param_3,uVar4);
  }
  else {
    if (param_4 - 0x440000U < 0x2000) {
      if (param_4 == 0x440004) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x18,&DAT_18003f6c8);
        }
        FUN_18001e504(*(longlong *)(param_1 + 0x68),param_3);
        goto LAB_18001a1ff;
      }
      if (param_4 == 0x440008) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x19,&DAT_18003f6c8);
        }
        (*DAT_18004c270)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),0);
        FUN_18001f334(*(longlong *)(param_1 + 0x68),param_3);
      }
      else {
        if (param_4 != 0x44000c) {
          if (param_4 == 0x440010) {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1b,&DAT_18003f6c8);
            }
            FUN_18001ef60(*(longlong *)(param_1 + 0x68),param_3);
            goto LAB_18001a1ff;
          }
          if (param_4 == 0x440014) {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1c,&DAT_18003f6c8);
            }
            FUN_18001e06c(*(LPVOID *)(param_1 + 0x68),param_3);
            goto LAB_18001a1ff;
          }
          if (param_4 == 0x440018) {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1d,&DAT_18003f6c8);
            }
            FUN_18001f634(*(undefined8 *)(param_1 + 0x68),param_3);
            goto LAB_18001a1ff;
          }
          if (param_4 == 0x44001c) {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1e,&DAT_18003f6c8);
            }
            FUN_18001f0fc(*(undefined8 *)(param_1 + 0x68),param_3);
            goto LAB_18001a1ff;
          }
          if (param_4 == 0x440020) {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1f,&DAT_18003f6c8);
            }
            FUN_18001e884(*(longlong *)(param_1 + 0x68),param_3);
            goto LAB_18001a1ff;
          }
          if (param_4 == 0x440024) {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x20,&DAT_18003f6c8);
            }
            FUN_18001f4ec(*(longlong *)(param_1 + 0x68),param_3);
            goto LAB_18001a1ff;
          }
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x21,&DAT_18003f6c8,param_4);
          }
          uVar4 = 0x80004001;
          goto LAB_18001a1ef;
        }
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1a,&DAT_18003f6c8);
        }
        (*DAT_18004c270)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),0);
        FUN_18001ddd0(*(longlong *)(param_1 + 0x68),param_3);
      }
    }
    else {
      if (param_4 == 0x442004) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x22,&DAT_18003f6c8);
        }
        FUN_18001e9c4(*(longlong *)(param_1 + 0x68));
        uVar4 = 0;
        goto LAB_18001a1ef;
      }
      if (param_4 == 0x44200c) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x23,&DAT_18003f6c8);
        }
        FUN_18001e474(*(longlong *)(param_1 + 0x68),param_3);
        goto LAB_18001a1ff;
      }
      if (param_4 == 0x442010) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x24,&DAT_18003f6c8);
        }
        (*DAT_18004c270)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),0);
        FUN_18001f27c(*(longlong *)(param_1 + 0x68),param_3);
      }
      else if (param_4 == 0x442014) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x25,&DAT_18003f6c8);
        }
        (*DAT_18004c270)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),0);
        FUN_18001f690(*(longlong *)(param_1 + 0x68),param_3);
      }
      else if (param_4 == 0x442018) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x26,&DAT_18003f6c8);
        }
        (*DAT_18004c270)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),0);
        FUN_18001e708(*(longlong *)(param_1 + 0x68),param_3);
      }
      else if (param_4 == 0x44201c) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x27,&DAT_18003f6c8);
        }
        (*DAT_18004c270)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),0);
        FUN_18001e7b8(*(longlong *)(param_1 + 0x68),param_3);
      }
      else {
        if (param_4 != 0x442020) {
          if (param_4 == 0x442024) {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x29,&DAT_18003f6c8);
            }
            FUN_18001e654(*(longlong *)(param_1 + 0x68),param_3);
            goto LAB_18001a1ff;
          }
          if (param_4 - 0x442400U < 0x3fd) {
            FUN_18001f158(*(longlong *)(param_1 + 0x68),param_3);
            goto LAB_18001a1ff;
          }
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2a,&DAT_18003f6c8,param_4);
          }
          uVar4 = 0xc0000010;
          goto LAB_18001a1ef;
        }
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x28,&DAT_18003f6c8);
        }
        (*DAT_18004c270)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),0);
        FUN_18001f1e4(*(longlong *)(param_1 + 0x68),param_3);
      }
    }
    (*DAT_18004c278)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10));
  }
LAB_18001a1ff:
  EnterCriticalSection(lpCriticalSection);
  piVar1 = (int *)(param_1 + 0x48);
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    SetEvent(*(HANDLE *)(param_1 + 0x50));
  }
  LeaveCriticalSection(lpCriticalSection);
  if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
    return;
  }
  if ((PTR_LOOP_18004a7b8[0x1c] & 4) == 0) {
    return;
  }
  if ((byte)PTR_LOOP_18004a7b8[0x19] < 5) {
    return;
  }
  FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2b,&DAT_18003f6c8);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18001a268(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x11,&DAT_18003f6c8);
  }
                    // WARNING: Could not recover jumptable at 0x00018001a2bb. Too many branches
                    // WARNING: Treating indirect jump as call
  (*_DAT_18004c410)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10),0,0);
  return;
}



void FUN_18001a2c4(longlong param_1)

{
  int *piVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x28));
  ResetEvent(*(HANDLE *)(param_1 + 0x60));
  piVar1 = (int *)(param_1 + 0x50);
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    SetEvent(*(HANDLE *)(param_1 + 0x58));
  }
                    // WARNING: Could not recover jumptable at 0x00018001a302. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x28));
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18001a30c(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x14,&DAT_18003f6c8);
  }
                    // WARNING: Could not recover jumptable at 0x00018001a359. Too many branches
                    // WARNING: Treating indirect jump as call
  (*_DAT_18004c408)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10));
  return;
}



void FUN_18001a360(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&stack0x00000028,8,&stack0x00000030,8,
               &stack0x00000038,4,0);
  return;
}



undefined8 * FUN_18001a3c0(undefined8 *param_1,undefined8 param_2)

{
  *param_1 = param_2;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[6] = 0;
  param_1[1] = 0;
  param_1[0xc] = 0;
  *(undefined4 *)(param_1 + 0xd) = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  *(undefined2 *)(param_1 + 10) = 0;
  param_1[0xb] = 0;
  return param_1;
}



void FUN_18001a3f8(longlong param_1)

{
  if (*(HLOCAL *)(param_1 + 0x58) != (HLOCAL)0x0) {
    LocalFree(*(HLOCAL *)(param_1 + 0x58));
  }
  if (*(longlong *)(param_1 + 8) != 0) {
    (*DAT_18004c558)(DAT_18004c910);
  }
  return;
}



void FUN_18001a42c(undefined8 *param_1,int param_2,undefined4 param_3,undefined4 param_4,
                  undefined4 param_5)

{
  undefined1 auStack_78 [32];
  undefined4 local_58;
  int local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  int local_40;
  undefined4 local_3c;
  undefined4 local_38;
  ulonglong local_30;
  
  local_30 = DAT_18004a880 ^ (ulonglong)auStack_78;
  FUN_180020400((undefined1 (*) [16])&local_58,0,0x24);
  local_44 = param_5;
  local_48 = 2;
  local_3c = 2;
  local_38 = 2;
  local_40 = (param_2 != 1) + 1;
  local_58 = 0x24;
  local_54 = param_2;
  local_50 = param_3;
  local_4c = param_4;
  (*DAT_18004c1d0)(DAT_18004c910,*param_1,&local_58);
  FUN_18001fe50(local_30 ^ (ulonglong)auStack_78);
  return;
}



undefined8 FUN_18001a4c8(longlong param_1,int param_2)

{
  longlong lVar1;
  
  if (param_2 != 0) {
    *(undefined4 *)(param_1 + 0x68) = 0;
  }
  LOCK();
  lVar1 = *(longlong *)(param_1 + 0x60);
  *(longlong *)(param_1 + 0x60) = 0;
  UNLOCK();
  if (lVar1 != 0) {
    (*DAT_18004c640)(DAT_18004c910,lVar1);
    (*DAT_18004c548)(DAT_18004c910,lVar1,0,0x1fc,"USBCtrl.cpp");
  }
  return 0;
}



void FUN_18001a520(undefined8 *param_1)

{
  char cVar1;
  byte bVar2;
  int iVar3;
  longlong lVar4;
  longlong lVar5;
  undefined2 uVar6;
  byte bVar7;
  undefined1 auStack_88 [32];
  int local_68;
  undefined4 local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined4 local_40;
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_88;
  local_58 = 0;
  iVar3 = (*DAT_18004c7a0)(DAT_18004c910,*param_1,0,&local_58);
  if (iVar3 < 0) {
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_18001a7f6;
    if (((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0) && (PTR_LOOP_18004a7b8[0x19] != '\0')) {
      uVar6 = 0x10;
LAB_18001a7b9:
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar6,&DAT_18003f6e8,iVar3);
    }
  }
  else {
    param_1[1] = local_58;
    cVar1 = (*DAT_18004c7e0)(DAT_18004c910);
    if (cVar1 != '\x01') {
      DebugBreak();
    }
    lVar4 = (*DAT_18004c8b0)(DAT_18004c910,local_58,0);
    if (lVar4 == 0) {
      iVar3 = -0x3fffffff;
      if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_18001a7f6;
      if (((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0) && (PTR_LOOP_18004a7b8[0x19] != '\0')) {
        uVar6 = 0x11;
        goto LAB_18001a7b9;
      }
    }
    else {
      param_1[2] = lVar4;
      bVar2 = (*DAT_18004c8c0)(DAT_18004c910,lVar4);
      if (bVar2 < 2) {
        if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_18001a7f6;
        if (((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0) && (PTR_LOOP_18004a7b8[0x19] != '\0')) {
          local_60 = 0xc0000144;
          local_68 = 2;
          FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x12,&DAT_18003f6e8,(uint)bVar2);
        }
      }
      else {
        bVar7 = 0;
        if (bVar2 != 0) {
          do {
            local_48 = 0;
            local_40 = 0;
            local_50 = 0x14;
            lVar5 = (*DAT_18004c8c8)(DAT_18004c910,lVar4,bVar7,&local_50);
            if (lVar5 == 0) {
              if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                  ((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0)) && (PTR_LOOP_18004a7b8[0x19] != '\0')) {
                local_68 = iVar3;
                FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x13,&DAT_18003f6e8,
                              (uint)bVar7);
              }
            }
            else {
              (*DAT_18004c830)(DAT_18004c910,lVar5);
              if (local_48._4_4_ == 3) {
                cVar1 = (*DAT_18004c818)(DAT_18004c910,lVar5);
                if (cVar1 == '\0') {
                  param_1[4] = lVar5;
                }
                else {
                  param_1[3] = lVar5;
                }
              }
              else if (local_48._4_4_ == 4) {
                cVar1 = (*DAT_18004c818)(DAT_18004c910,lVar5);
                if (cVar1 == '\0') {
                  param_1[6] = lVar5;
                }
                else {
                  param_1[5] = lVar5;
                }
              }
            }
            bVar7 = bVar7 + 1;
          } while (bVar7 < bVar2);
        }
        if ((param_1[3] == 0) || (param_1[4] == 0)) {
          iVar3 = -0x3ffffe7c;
          if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_18001a7f6;
          if (((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0) && (PTR_LOOP_18004a7b8[0x19] != '\0')) {
            uVar6 = 0x14;
            goto LAB_18001a7b9;
          }
        }
      }
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x15,&DAT_18003f6e8);
  }
LAB_18001a7f6:
  FUN_18001fe50(local_38 ^ (ulonglong)auStack_88);
  return;
}



void FUN_18001a820(undefined8 *param_1,undefined8 *param_2,uint param_3,int param_4,int param_5,
                  int param_6,undefined4 *param_7)

{
  ushort uVar1;
  int iVar2;
  undefined8 uVar3;
  undefined1 auStackY_58 [32];
  undefined8 local_18;
  ulonglong local_10;
  
  local_10 = DAT_18004a880 ^ (ulonglong)auStackY_58;
  if (param_6 == 0) {
    param_6 = 2000;
  }
  if ((param_2 == (undefined8 *)0x0) || (param_3 == 0)) {
    iVar2 = -0x3ffffff3;
LAB_18001a918:
    if (-1 < iVar2) goto LAB_18001a964;
  }
  else if (*(int *)(param_1 + 0xd) != 0) {
    if (param_4 == 0) {
      local_18 = *param_2;
      if (param_5 != 0) {
        uVar1 = (ushort)((ulonglong)local_18 >> 0x30);
        param_3 = (uint)uVar1;
        param_2 = (undefined8 *)(-(ulonglong)(uVar1 != 0) & (ulonglong)(param_2 + 1));
      }
      iVar2 = FUN_18001ae74((longlong)param_1,&local_18,param_2,param_3,param_7);
    }
    else {
      if (param_4 != 1) goto LAB_18001a91c;
      if (param_5 == 0) {
        uVar3 = param_1[3];
      }
      else {
        uVar3 = param_1[4];
      }
      iVar2 = FUN_18001b4ac(*param_1,uVar3,(longlong)param_2,(ulonglong)param_3,param_7,
                            (uint)(param_5 == 0),param_6,param_1 + 0xc);
    }
    goto LAB_18001a918;
  }
LAB_18001a91c:
  if (param_7 != (undefined4 *)0x0) {
    *param_7 = 0;
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1a,&DAT_18003f6e8,param_5);
  }
LAB_18001a964:
  FUN_18001fe50(local_10 ^ (ulonglong)auStackY_58);
  return;
}



int FUN_18001a980(undefined8 *param_1,longlong param_2,longlong param_3,longlong *param_4,
                 int param_5,int param_6,int param_7,undefined4 *param_8)

{
  undefined8 *puVar1;
  undefined8 uVar2;
  longlong local_res10;
  int iVar3;
  
  if (param_7 == 0) {
    param_7 = 2000;
  }
  if ((param_2 == 0) || (param_3 == 0)) {
    iVar3 = -0x3ffffff3;
  }
  else {
    if (*(int *)(param_1 + 0xd) == 0) {
      iVar3 = -0x3ff8ffeb;
      goto LAB_18001aaac;
    }
    if (param_5 == 0) {
      puVar1 = (undefined8 *)(*DAT_18004c508)(DAT_18004c910,param_3,&local_res10);
      if (param_4 != (longlong *)0x0) {
        local_res10 = param_4[1];
        puVar1 = (undefined8 *)((longlong)puVar1 + *param_4);
      }
      iVar3 = FUN_18001a820(param_1,puVar1,(uint)local_res10,0,param_6,param_7,param_8);
    }
    else {
      if (param_5 == 1) {
        if (param_6 == 0) {
          uVar2 = param_1[3];
LAB_18001aa3f:
          iVar3 = 1;
        }
        else {
          iVar3 = 0;
          uVar2 = param_1[4];
        }
      }
      else {
        if (param_5 != 2) {
          iVar3 = -0x3ffffffe;
          goto LAB_18001aaac;
        }
        if (param_6 == 0) {
          uVar2 = param_1[5];
          goto LAB_18001aa3f;
        }
        iVar3 = 0;
        uVar2 = param_1[6];
      }
      iVar3 = FUN_18001b81c(uVar2,param_2,param_3,(char *)param_4,param_8,iVar3,param_7,
                            param_1 + 0xc);
    }
  }
  if (-1 < iVar3) {
    return iVar3;
  }
LAB_18001aaac:
  if (param_8 != (undefined4 *)0x0) {
    *param_8 = 0;
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1b,&DAT_18003f6e8,param_6);
  }
  return iVar3;
}



void FUN_18001ab04(undefined8 *param_1)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  undefined8 *puVar5;
  undefined2 uVar6;
  ulonglong *puVar7;
  undefined1 auStack_298 [32];
  ulonglong *local_278;
  ushort *local_270;
  undefined1 local_268;
  undefined2 local_260;
  ushort local_258 [2];
  ushort local_254 [2];
  undefined8 local_250;
  undefined8 local_248;
  uint local_240;
  ulonglong local_238 [32];
  ulonglong local_138 [32];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_298;
  iVar3 = FUN_18001a520(param_1);
  if (iVar3 < 0) {
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_18001ae44;
    if (((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar6 = 10;
LAB_18001ab7d:
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar6,&DAT_18003f6e8,iVar3);
    }
  }
  else {
    local_248 = 0;
    local_240 = 0;
    local_250 = 0x14;
    iVar3 = (*DAT_18004c7b0)(DAT_18004c910,param_1[1],&local_250);
    if (iVar3 < 0) {
      if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_18001ae44;
      if (((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        uVar6 = 0xb;
        goto LAB_18001ab7d;
      }
    }
    else {
      *(byte *)(param_1 + 7) = (byte)(local_240 >> 1) & 2 | 1;
      (*DAT_18004c7b8)(DAT_18004c910,param_1[1],param_1 + 8);
      if (*(short *)((longlong)param_1 + 0x4a) == 0x575) {
        *(undefined4 *)((longlong)param_1 + 0x3c) = 4;
      }
      else {
        *(undefined4 *)((longlong)param_1 + 0x3c) = 0;
      }
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xc,&DAT_18003f6e8,
                      *(undefined4 *)((longlong)param_1 + 0x3c));
      }
      if (*(char *)(param_1 + 10) != '\0') {
        iVar3 = 0;
        do {
          local_268 = *(undefined1 *)(param_1 + 10);
          local_260 = 0x409;
          local_270 = local_258;
          local_278 = local_238;
          local_258[0] = 0x7e;
          iVar4 = (*DAT_18004c7c8)(DAT_18004c910,param_1[1],0,0);
          if (-1 < iVar4) {
            local_268 = *(undefined1 *)(param_1 + 10);
            local_260 = 0x409;
            local_270 = local_254;
            local_278 = local_138;
            local_254[0] = 0x7e;
            iVar4 = (*DAT_18004c7c8)(DAT_18004c910,param_1[1]);
            uVar1 = local_258[0];
            if (((-1 < iVar4) && (local_258[0] == local_254[0])) &&
               ((iVar4 = FUN_180020a30(local_238,(longlong)local_138,(ulonglong)local_258[0] * 2),
                iVar4 == 0 && (iVar4 = 0, uVar1 != 0)))) {
              puVar7 = local_238;
              do {
                uVar2 = (short)*puVar7 - 0x30;
                if ((0x36 < uVar2) || ((0x7e0000007e03ffU >> ((ulonglong)uVar2 & 0x3f) & 1) == 0))
                break;
                iVar4 = iVar4 + 1;
                puVar7 = (ulonglong *)((longlong)puVar7 + 2);
              } while (iVar4 < (int)(uint)uVar1);
              if (iVar4 < 0) {
                puVar5 = (undefined8 *)LocalAlloc(0,(longlong)(int)(uVar1 + 1) * 2);
                param_1[0xb] = puVar5;
                FUN_18001fe80(puVar5,local_238,(ulonglong)local_258[0] * 2);
                *(undefined2 *)(param_1[0xb] + (ulonglong)local_258[0] * 2) = 0;
                if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                    ((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0)) &&
                   (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
                  FUN_18000e7dc(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xd,&DAT_18003f6e8,
                                (wchar_t *)param_1[0xb]);
                }
                break;
              }
            }
          }
          iVar3 = iVar3 + 1;
        } while (iVar3 < 3);
      }
      iVar3 = FUN_18001b078(param_1);
      if (iVar3 < 0) {
        if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_18001ae44;
        if (((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          uVar6 = 0xe;
          goto LAB_18001ab7d;
        }
      }
      else {
        *(undefined4 *)(param_1 + 0xd) = 1;
      }
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xf,&DAT_18003f6e8);
  }
LAB_18001ae44:
  FUN_18001fe50(local_38 ^ (ulonglong)auStack_298);
  return;
}



void FUN_18001ae74(longlong param_1,undefined8 param_2,undefined8 param_3,int param_4,
                  undefined4 *param_5)

{
  char cVar1;
  int iVar2;
  undefined1 auStack_e8 [32];
  undefined8 **local_c8;
  undefined8 local_c0;
  longlong local_b8;
  undefined8 **local_b0;
  undefined4 local_a8;
  int local_a4;
  int local_a0;
  undefined4 local_90;
  undefined4 uStack_8c;
  longlong local_88;
  undefined8 local_58;
  undefined8 local_50;
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStack_e8;
  local_b8 = 0;
  local_b0 = (undefined8 ***)0x0;
  if (param_5 != (undefined4 *)0x0) {
    *param_5 = 0;
  }
  iVar2 = (*DAT_18004c5f0)(DAT_18004c910,0,*(undefined8 *)(param_1 + 8),&local_b8);
  if (-1 < iVar2) {
    if (param_4 != 0) {
      FUN_180020400((undefined1 (*) [16])&local_a8,0,0x38);
      local_90 = 1;
      uStack_8c = 1;
      local_88 = local_b8;
      local_c8 = &local_b0;
      local_a8 = 0x38;
      iVar2 = (*DAT_18004c500)(DAT_18004c910,&local_a8,param_3,param_4);
    }
    if (-1 < iVar2) {
      local_c0 = 0;
      local_c8 = local_b0;
      iVar2 = (*DAT_18004c7f8)(DAT_18004c910,*(undefined8 *)(param_1 + 8),local_b8,param_2);
      if (-1 < iVar2) {
        local_58 = 0x300000010;
        local_50 = 0xfffffffffeced300;
        cVar1 = (*DAT_18004c610)(DAT_18004c910,local_b8,*(undefined8 *)(param_1 + 8),&local_58);
        if (cVar1 == '\0') {
          iVar2 = (*DAT_18004c618)(DAT_18004c910);
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((PTR_LOOP_18004a7b8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x19,&DAT_18003f6e8,iVar2);
          }
        }
        if (-1 < iVar2) {
          FUN_180020400((undefined1 (*) [16])&local_a8,0,0x48);
          local_a8 = 0x48;
          local_a4 = 0xff;
          (*DAT_18004c658)(DAT_18004c910,local_b8,&local_a8);
          if ((-1 < local_a0) && (param_5 != (undefined4 *)0x0)) {
            if (local_a4 != 0x40) {
              DebugBreak();
            }
            *param_5 = *(undefined4 *)(CONCAT44(uStack_8c,local_90) + 0x18);
          }
        }
      }
    }
  }
  if (local_b8 != 0) {
    (*DAT_18004c558)(DAT_18004c910);
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStack_e8);
  return;
}



void FUN_18001b078(undefined8 *param_1)

{
  int iVar1;
  undefined1 auStackY_58 [32];
  undefined8 local_28;
  undefined4 local_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  ulonglong local_10;
  
  local_10 = DAT_18004a880 ^ (ulonglong)auStackY_58;
  iVar1 = FUN_18001a42c(param_1,1,4,10000,1);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x16,&DAT_18003f6e8,iVar1);
  }
  if (-1 < iVar1) {
    uStack_1c = 2;
    uStack_18 = 0;
    local_28 = 0x500000014;
    local_20 = 2;
    iVar1 = (*DAT_18004c1d8)(DAT_18004c910,*param_1,&local_28);
    if (iVar1 < 0) {
      if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_18001b19b;
      if (((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x17,&DAT_18003f6e8,iVar1);
      }
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x18,&DAT_18003f6e8);
  }
LAB_18001b19b:
  FUN_18001fe50(local_10 ^ (ulonglong)auStackY_58);
  return;
}



void FUN_18001b1bc(longlong param_1)

{
  undefined1 auStackY_98 [32];
  undefined2 local_68;
  undefined4 local_66;
  undefined2 local_62;
  undefined1 local_58 [64];
  ulonglong local_18;
  
  local_18 = DAT_18004a880 ^ (ulonglong)auStackY_98;
  if (*(int *)(param_1 + 0x68) != 0) {
    local_68 = 0x4018;
    local_66 = 0;
    local_62 = 0;
    FUN_18001ae74(param_1,&local_68,local_58,0x40,(undefined4 *)0x0);
  }
  FUN_18001fe50(local_18 ^ (ulonglong)auStackY_98);
  return;
}



void FUN_18001b224(undefined8 param_1,undefined4 *param_2,undefined8 *param_3,undefined8 *param_4,
                  undefined8 *param_5,undefined8 *param_6)

{
  int iVar1;
  undefined1 auStack_98 [32];
  undefined8 *local_78;
  undefined2 local_68 [4];
  longlong local_60;
  longlong local_58;
  undefined4 local_50;
  ulonglong local_40;
  
  local_40 = DAT_18004a880 ^ (ulonglong)auStack_98;
  FUN_180020400((undefined1 (*) [16])local_68,0,0x28);
  local_68[0] = 0x28;
  (*DAT_18004c678)(DAT_18004c910,param_1,local_68);
  *param_2 = local_50;
  if (local_58 == 0) {
LAB_18001b2bc:
    *param_3 = 0;
    *param_4 = 0;
  }
  else {
    local_78 = param_4;
    iVar1 = (*DAT_18004c690)(DAT_18004c910,param_1,0,param_3);
    if (iVar1 < 0) goto LAB_18001b2bc;
  }
  if (local_60 != 0) {
    local_78 = param_6;
    iVar1 = (*DAT_18004c698)(DAT_18004c910,param_1,0,param_5);
    if (-1 < iVar1) goto LAB_18001b2ee;
  }
  *param_5 = 0;
  *param_6 = 0;
LAB_18001b2ee:
  FUN_18001fe50(local_40 ^ (ulonglong)auStack_98);
  return;
}



void FUN_18001b30c(undefined8 param_1,undefined4 *param_2,undefined8 *param_3,undefined8 *param_4,
                  undefined8 *param_5,undefined8 *param_6)

{
  int iVar1;
  undefined1 auStack_88 [32];
  undefined2 local_68 [4];
  longlong local_60;
  longlong local_58;
  undefined4 local_50;
  ulonglong local_40;
  
  local_40 = DAT_18004a880 ^ (ulonglong)auStack_88;
  FUN_180020400((undefined1 (*) [16])local_68,0,0x28);
  local_68[0] = 0x28;
  (*DAT_18004c678)(DAT_18004c910,param_1,local_68);
  *param_2 = local_50;
  if (local_58 == 0) {
LAB_18001b39c:
    *param_3 = 0;
    *param_4 = 0;
  }
  else {
    iVar1 = (*DAT_18004c680)(DAT_18004c910,param_1,param_3);
    if (iVar1 < 0) goto LAB_18001b39c;
  }
  if (local_60 != 0) {
    iVar1 = (*DAT_18004c688)(DAT_18004c910,param_1,param_5);
    if (-1 < iVar1) goto LAB_18001b3c6;
  }
  *param_5 = 0;
  *param_6 = 0;
LAB_18001b3c6:
  FUN_18001fe50(local_40 ^ (ulonglong)auStack_88);
  return;
}



void FUN_18001b3e4(ushort param_1,undefined2 param_2,WORD param_3)

{
  undefined8 uVar1;
  DWORDLONG dwlConditionMask;
  undefined1 auStack_178 [32];
  _OSVERSIONINFOEXW local_158;
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_178;
  local_158.dwOSVersionInfoSize = 0x11c;
  local_158.dwMajorVersion = 0;
  local_158.dwMinorVersion = 0;
  local_158.dwBuildNumber = 0;
  local_158.dwPlatformId = 0;
  local_158.szCSDVersion[0] = L'\0';
  FUN_180020400((undefined1 (*) [16])(local_158.szCSDVersion + 1),0,0xfe);
  local_158.wServicePackMajor = 0;
  local_158.wServicePackMinor = 0;
  local_158.wSuiteMask = 0;
  local_158.wProductType = '\0';
  local_158.wReserved = '\0';
  uVar1 = VerSetConditionMask(0,2,3);
  uVar1 = VerSetConditionMask(uVar1,1,3);
  dwlConditionMask = VerSetConditionMask(uVar1,0x20,3);
  local_158.dwMinorVersion._0_2_ = param_2;
  local_158.dwMajorVersion = (uint)param_1;
  local_158.dwMinorVersion._2_2_ = 0;
  local_158.wServicePackMajor = param_3;
  VerifyVersionInfoW(&local_158,0x23,dwlConditionMask);
  FUN_18001fe50(local_38 ^ (ulonglong)auStack_178);
  return;
}



void FUN_18001b4ac(undefined8 param_1,undefined8 param_2,longlong param_3,undefined8 param_4,
                  undefined4 *param_5,int param_6,int param_7,longlong *param_8)

{
  longlong lVar1;
  char cVar2;
  int iVar3;
  undefined2 uVar4;
  undefined1 auStack_128 [32];
  char *local_108;
  longlong local_f8;
  undefined8 local_f0;
  undefined4 local_e8 [6];
  undefined4 local_d0;
  undefined4 local_cc;
  longlong local_c8;
  undefined4 local_a8;
  undefined4 local_a4;
  int local_a0;
  undefined4 local_98;
  undefined8 local_58;
  longlong local_50;
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStack_128;
  local_f8 = 0;
  local_f0 = 0;
  if (param_3 == 0) goto LAB_18001b7fd;
  iVar3 = (*DAT_18004c5f0)(DAT_18004c910,0,param_2,&local_f8);
  if (iVar3 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar4 = 0xc;
LAB_18001b7c5:
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar4,&DAT_18003f708,iVar3);
    }
  }
  else {
    FUN_180020400((undefined1 (*) [16])local_e8,0,0x38);
    local_d0 = 1;
    local_cc = 1;
    local_c8 = local_f8;
    local_108 = (char *)&local_f0;
    local_e8[0] = 0x38;
    iVar3 = (*DAT_18004c500)(DAT_18004c910,local_e8,param_3,param_4);
    if (iVar3 < 0) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        uVar4 = 0xd;
        goto LAB_18001b7c5;
      }
    }
    else {
      local_108 = (char *)0x0;
      if (param_6 == 1) {
        iVar3 = (*DAT_18004c850)();
      }
      else {
        iVar3 = (*DAT_18004c840)(DAT_18004c910,param_2,local_f8,local_f0);
      }
      if (iVar3 < 0) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          uVar4 = 0xe;
          goto LAB_18001b7c5;
        }
      }
      else {
        local_108 = "util.cpp";
        (*DAT_18004c540)(DAT_18004c910,local_f8,0,0x73);
        LOCK();
        *param_8 = local_f8;
        UNLOCK();
        uVar4 = 0x10;
        local_50 = 0;
        local_58 = 0x200000010;
        if (param_7 != 0) {
          local_58 = 0x300000010;
          local_50 = -(ulonglong)(uint)(param_7 * 10000);
        }
        cVar2 = (*DAT_18004c610)(DAT_18004c910,local_f8,param_2,&local_58);
        if ((((cVar2 == '\0') &&
             (iVar3 = (*DAT_18004c618)(DAT_18004c910,local_f8),
             (undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8)) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xf,&DAT_18003f708,iVar3);
        }
        LOCK();
        lVar1 = *param_8;
        *param_8 = 0;
        UNLOCK();
        if (lVar1 != 0) {
          local_108 = "util.cpp";
          (*DAT_18004c548)(DAT_18004c910,local_f8,0,0x81);
          if (iVar3 < 0) {
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19]))
            goto LAB_18001b7c5;
          }
          else {
            FUN_180020400((undefined1 (*) [16])&local_a8,0,0x48);
            local_a8 = 0x48;
            local_a4 = 0xff;
            (*DAT_18004c658)(DAT_18004c910,local_f8,&local_a8);
            if (local_a0 < 0) {
              if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                  ((PTR_LOOP_18004a7b8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19]))
              {
                uVar4 = 0x11;
                iVar3 = local_a0;
                goto LAB_18001b7c5;
              }
            }
            else if (param_5 != (undefined4 *)0x0) {
              *param_5 = local_98;
            }
          }
        }
      }
    }
  }
  (*DAT_18004c558)(DAT_18004c910,local_f8);
LAB_18001b7fd:
  FUN_18001fe50(local_48 ^ (ulonglong)auStack_128);
  return;
}



void FUN_18001b81c(undefined8 param_1,longlong param_2,undefined8 param_3,char *param_4,
                  undefined4 *param_5,int param_6,int param_7,longlong *param_8)

{
  longlong lVar1;
  char cVar2;
  int iVar3;
  undefined4 uVar4;
  undefined2 uVar5;
  undefined1 auStack_d8 [32];
  char *local_b8;
  undefined4 local_a8;
  undefined4 local_a4;
  int local_a0;
  undefined4 local_98;
  undefined8 local_58;
  longlong local_50;
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStack_d8;
  local_b8 = param_4;
  if (param_6 == 1) {
    iVar3 = (*DAT_18004c850)();
  }
  else {
    iVar3 = (*DAT_18004c840)(DAT_18004c910,param_1,param_2,param_3);
  }
  if (iVar3 < 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
        ((PTR_LOOP_18004a7b8[0x1c] & 0x20) == 0)) || ((byte)PTR_LOOP_18004a7b8[0x19] < 2))
    goto LAB_18001ba19;
    uVar5 = 0x12;
    local_a0 = iVar3;
  }
  else {
    local_b8 = "util.cpp";
    (*DAT_18004c540)(DAT_18004c910,param_2,0,0xbd);
    LOCK();
    *param_8 = param_2;
    UNLOCK();
    local_50 = 0;
    local_58 = 0x200000010;
    if (param_7 != 0) {
      local_58 = 0x300000010;
      local_50 = -(ulonglong)(uint)(param_7 * 10000);
    }
    cVar2 = (*DAT_18004c610)(DAT_18004c910,param_2,param_1,&local_58);
    if ((((cVar2 == '\0') &&
         (uVar4 = (*DAT_18004c618)(DAT_18004c910,param_2),
         (undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8)) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x13,&DAT_18003f708,uVar4);
    }
    LOCK();
    lVar1 = *param_8;
    *param_8 = 0;
    UNLOCK();
    if (lVar1 == 0) goto LAB_18001ba19;
    local_b8 = "util.cpp";
    (*DAT_18004c548)(DAT_18004c910,param_2,0,0xcf);
    FUN_180020400((undefined1 (*) [16])&local_a8,0,0x48);
    local_a8 = 0x48;
    local_a4 = 0xff;
    (*DAT_18004c658)(DAT_18004c910,param_2,&local_a8);
    if (-1 < local_a0) {
      if (param_5 != (undefined4 *)0x0) {
        *param_5 = local_98;
      }
      goto LAB_18001ba19;
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
        ((PTR_LOOP_18004a7b8[0x1c] & 0x20) == 0)) || ((byte)PTR_LOOP_18004a7b8[0x19] < 2))
    goto LAB_18001ba19;
    uVar5 = 0x14;
  }
  FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar5,&DAT_18003f708,local_a0);
LAB_18001ba19:
  FUN_18001fe50(local_48 ^ (ulonglong)auStack_d8);
  return;
}



short * FUN_18001ba38(short *param_1,LPCWSTR param_2)

{
  short sVar1;
  int iVar2;
  
  iVar2 = lstrlenW(param_2);
  *(LPCWSTR *)(param_1 + 4) = param_2;
  sVar1 = (short)iVar2 * 2;
  *param_1 = sVar1;
  param_1[1] = sVar1 + 2;
  return param_1;
}



undefined8 * FUN_18001ba70(undefined8 *param_1,undefined8 param_2,undefined8 param_3)

{
  DWORD DVar1;
  HANDLE pvVar2;
  
  param_1[2] = 0;
  FUN_180006f0c(param_1);
  param_1[0xd] = param_3;
  param_1[3] = 0x30;
  param_1[4] = 0x80;
  *(undefined1 *)(param_1 + 5) = 0;
  *(undefined4 *)(param_1 + 6) = 0;
  param_1[0xe] = param_2;
  *(undefined4 *)(param_1 + 0x67) = 0;
  *param_1 = &PTR_FUN_18003f738;
  param_1[0x61] = 0;
  param_1[0x62] = 0;
  param_1[99] = 0;
  param_1[100] = 0;
  param_1[0x65] = 0;
  param_1[0x66] = 0;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[7] = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[8] = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[9] = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[0xb] = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  *(undefined4 *)(param_1 + 10) = 0;
  param_1[0xc] = pvVar2;
  FUN_180020400((undefined1 (*) [16])(param_1 + 0xf),0,0x28);
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x68));
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  if (((((param_1[7] == 0) || (param_1[8] == 0)) || (param_1[9] == 0)) ||
      ((param_1[0xb] == 0 || (param_1[0xc] == 0)))) &&
     (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8 &&
      (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_18004a7b8[0x19])))))) {
    DVar1 = GetLastError();
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),10,&DAT_18003f728,DVar1);
  }
  return param_1;
}



void FUN_18001bc00(undefined8 *param_1)

{
  *param_1 = &PTR_FUN_18003f738;
  if ((HLOCAL)param_1[0x65] != (HLOCAL)0x0) {
    LocalFree((HLOCAL)param_1[0x65]);
  }
  if ((HANDLE)param_1[7] != (HANDLE)0x0) {
    CloseHandle((HANDLE)param_1[7]);
  }
  if ((HANDLE)param_1[8] != (HANDLE)0x0) {
    CloseHandle((HANDLE)param_1[8]);
  }
  if ((HANDLE)param_1[9] != (HANDLE)0x0) {
    CloseHandle((HANDLE)param_1[9]);
  }
  if ((HANDLE)param_1[0xb] != (HANDLE)0x0) {
    CloseHandle((HANDLE)param_1[0xb]);
  }
  if ((HANDLE)param_1[0xc] != (HANDLE)0x0) {
    CloseHandle((HANDLE)param_1[0xc]);
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x68));
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  FUN_180006f20(param_1);
  return;
}



undefined8 * FUN_18001bc98(undefined8 *param_1,uint param_2)

{
  FUN_18001bc00(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



void FUN_18001bcc8(longlong param_1,int param_2)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x21,&DAT_18003f728);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x340));
  *(undefined1 *)(param_1 + 0x28) = 1;
  if (*(int *)(param_1 + 0x2c) != 1) {
    *(int *)(param_1 + 0x2c) = param_2;
  }
  if (param_2 != 2) {
    SetEvent(*(HANDLE *)(param_1 + 0x48));
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x340));
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x22,&DAT_18003f728);
  }
  return;
}



int FUN_18001bd8c(longlong *param_1)

{
  int iVar1;
  int iVar2;
  HLOCAL pvVar3;
  undefined1 uVar4;
  uint local_res8 [2];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1c,&DAT_18003f728);
  }
  local_res8[0] = 0;
  FUN_18001cf4c((longlong)param_1);
  if (param_1[0x65] == 0) {
    pvVar3 = LocalAlloc(0x40,(ulonglong)*(uint *)(param_1 + 99));
    param_1[0x65] = (longlong)pvVar3;
    *(int *)(param_1 + 0x66) = (int)param_1[99];
  }
  iVar1 = (*DAT_18004c270)(DAT_18004c910,param_1[0xd],1);
  iVar2 = (**(code **)(*param_1 + 0xc0))(param_1,param_1[0x65],local_res8);
  if (-1 < iVar1) {
    (*DAT_18004c278)(DAT_18004c910,param_1[0xd]);
  }
  FUN_18001cf0c((longlong)param_1);
  if (iVar2 == 1) {
    uVar4 = 100;
    if (local_res8[0] < 100) {
      uVar4 = (undefined1)local_res8[0];
    }
    *(undefined1 *)((longlong)param_1 + 0x321) = uVar4;
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1d,&DAT_18003f728,iVar2);
  }
  return iVar2;
}



void FUN_18001bec8(longlong param_1)

{
  ulonglong uVar1;
  undefined1 *puVar2;
  
  if (*(longlong *)(param_1 + 0x328) != 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x20,&DAT_18003f728);
    }
    puVar2 = *(undefined1 **)(param_1 + 0x328);
    for (uVar1 = (ulonglong)*(uint *)(param_1 + 0x330); uVar1 != 0; uVar1 = uVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    LocalFree(*(HLOCAL *)(param_1 + 0x328));
    *(undefined8 *)(param_1 + 800) = 0;
    *(undefined8 *)(param_1 + 0x328) = 0;
    *(undefined8 *)(param_1 + 0x330) = 0;
  }
  return;
}



void FUN_18001bf68(longlong *param_1,undefined1 param_2,int *param_3)

{
  LPCRITICAL_SECTION lpCriticalSection;
  bool bVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  int iVar6;
  int iVar7;
  DWORD DVar8;
  DWORD DVar9;
  undefined1 uVar10;
  int iVar11;
  int iVar12;
  bool bVar13;
  undefined1 auStackY_118 [32];
  int local_d8;
  uint local_d4;
  int *local_d0;
  longlong local_c8;
  undefined8 local_c0;
  HANDLE local_b8;
  longlong local_b0;
  undefined4 local_a8 [2];
  wchar_t *local_a0;
  undefined4 local_98 [2];
  wchar_t *local_90;
  wchar_t local_88 [20];
  wchar_t local_60 [24];
  ulonglong local_30;
  
  local_30 = DAT_18004a880 ^ (ulonglong)auStackY_118;
  local_d0 = param_3;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xd,&DAT_18003f728);
  }
  local_b8 = (HANDLE)param_1[9];
  iVar11 = 1;
  local_b0 = 0;
  local_d4 = 0;
  iVar12 = 3;
  bVar4 = false;
  local_c8 = 0;
  iVar6 = (*DAT_18004c1e0)(DAT_18004c910,param_1[0xd],1,0x20019);
  if (-1 < iVar6) {
    local_a0 = local_60;
    builtin_wcsncpy(local_60,L"WudfPowerPolicySettings",0x18);
    local_a8[0] = 0x30002e;
    (*DAT_18004c568)(DAT_18004c910,local_c0,local_a8,0x20019);
    (*DAT_18004c578)(DAT_18004c910,local_c0);
  }
  *(undefined1 *)(param_1 + 0x61) = param_2;
  *(undefined1 *)((longlong)param_1 + 0x309) = 0;
  iVar7 = (*DAT_18004c270)(DAT_18004c910,param_1[0xd]);
  bVar13 = -1 < iVar7;
  local_98[0] = 0x260024;
  builtin_wcsncpy(local_88,L"IdleInWorkingState",0x13);
  local_90 = local_88;
  local_d8 = 1;
  bVar5 = false;
LAB_18001c114:
  do {
    do {
      if (iVar12 == 3) {
        if (local_c8 != 0) {
          (*DAT_18004c5b8)(DAT_18004c910,local_c8,local_98,&local_d8);
        }
        if ((local_d8 != 0) != bVar4) {
          if (bVar4) {
            FUN_18001a42c((undefined8 *)param_1[0xe],1,5,10000,1);
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xf,&DAT_18003f728,iVar6);
            }
            bVar4 = false;
          }
          else {
            FUN_18001a42c((undefined8 *)param_1[0xe],3,3,1,1);
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xe,&DAT_18003f728,iVar6);
            }
            bVar4 = true;
          }
        }
      }
      if ((param_3 != (int *)0x0) && (*param_3 == 0)) {
        if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
           (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (3 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x10,&DAT_18003f728);
        }
LAB_18001c703:
        iVar7 = 0xf;
LAB_18001c79a:
        if (!bVar5) goto LAB_18001c7a9;
        goto LAB_18001c7a1;
      }
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x11,&DAT_18003f728);
      }
      if (!bVar5) {
        FUN_18001cf4c((longlong)param_1);
        bVar5 = true;
      }
      lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 0x68);
      EnterCriticalSection(lpCriticalSection);
      if (*(int *)((longlong)param_1 + 0x2c) == 0) {
        *(undefined4 *)(param_1 + 6) = 2;
        LeaveCriticalSection(lpCriticalSection);
        iVar7 = (**(code **)(*param_1 + 0xb8))(param_1,param_1 + 5,param_1[0x62],&local_d4);
      }
      else {
        LeaveCriticalSection(lpCriticalSection);
        iVar7 = 0xf;
      }
      bVar3 = false;
      bVar1 = false;
      EnterCriticalSection(lpCriticalSection);
      bVar2 = true;
      if (iVar7 == 3) {
        if (*(int *)((longlong)param_1 + 0x2c) != 0) {
          iVar7 = 0xf;
          goto LAB_18001c2fe;
        }
        if (local_d8 != 0) {
          *(undefined4 *)(param_1 + 6) = 3;
          bVar3 = bVar2;
          goto LAB_18001c2f9;
        }
      }
      else {
LAB_18001c2f9:
        if (iVar7 == 0xf) {
LAB_18001c2fe:
          bVar1 = false;
          if (*(int *)((longlong)param_1 + 0x2c) - 2U < 2) {
            if (*(int *)((longlong)param_1 + 0x2c) == 3) {
              *(undefined4 *)(param_1 + 6) = 3;
              bVar3 = bVar2;
            }
            else {
              *(undefined4 *)(param_1 + 6) = 4;
            }
            *(undefined4 *)((longlong)param_1 + 0x2c) = 0;
            *(undefined1 *)(param_1 + 5) = 0;
            iVar7 = 3;
            bVar1 = bVar2;
          }
        }
      }
      LeaveCriticalSection(lpCriticalSection);
      if (iVar7 != 3) {
        if (iVar7 == 1) {
          uVar10 = 100;
          if (local_d4 < 100) {
            uVar10 = (char)local_d4;
          }
          *(undefined1 *)((longlong)param_1 + 0x309) = uVar10;
        }
        else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                 ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1a,&DAT_18003f728,
                        *(undefined4 *)((longlong)param_1 + 0x2c));
        }
        goto LAB_18001c79a;
      }
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x12,&DAT_18003f728);
      }
      iVar12 = 3;
    } while ((!bVar1) && (param_3 = local_d0, !bVar3));
    if ((bVar3) && (iVar11 = (**(code **)(*param_1 + 0xa8))(param_1,1), iVar11 != 1))
    goto LAB_18001c79a;
    if (!bVar1) {
      (*DAT_18004c278)(DAT_18004c910,param_1[0xd]);
      bVar13 = false;
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x13,&DAT_18003f728);
      }
      local_b0 = param_1[8];
      DVar8 = WaitForMultipleObjects(2,&local_b8,0,2000);
      if (DVar8 != 1) {
        if (bVar3) {
          FUN_18001cf0c((longlong)param_1);
          iVar11 = (*DAT_18004c270)(DAT_18004c910,param_1[0xd]);
          bVar13 = -1 < iVar11;
          FUN_18001cf4c((longlong)param_1);
          bVar5 = true;
          iVar11 = (**(code **)(*param_1 + 0xa8))(param_1,0);
          if (iVar11 != 1) goto LAB_18001c7a1;
        }
        if (DVar8 == 0) {
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x14,&DAT_18003f728,
                          *(undefined4 *)((longlong)param_1 + 0x2c));
          }
          goto LAB_18001c703;
        }
        param_3 = local_d0;
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x15,&DAT_18003f728);
          param_3 = local_d0;
        }
        goto LAB_18001c114;
      }
    }
    ResetEvent((HANDLE)param_1[0xc]);
    FUN_18001cf0c((longlong)param_1);
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x16,&DAT_18003f728);
    }
    local_b0 = param_1[7];
    DVar8 = WaitForMultipleObjects(2,&local_b8,0,0xffffffff);
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x17,&DAT_18003f728,DVar8);
    }
    FUN_18001cf4c((longlong)param_1);
    bVar5 = true;
    if (bVar1) {
      if ((DVar8 != 0) || (DVar9 = WaitForSingleObject((HANDLE)param_1[7],0), DVar9 == 0))
      goto LAB_18001c596;
      iVar12 = FUN_18001b1bc(param_1[0xe]);
      if (-1 < iVar12) {
        DVar9 = WaitForSingleObject((HANDLE)param_1[7],2000);
        if (DVar9 == 0) goto LAB_18001c596;
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x18,&DAT_18003f728);
        }
      }
      iVar12 = 0xf;
    }
    else {
      iVar12 = (*DAT_18004c270)(DAT_18004c910,param_1[0xd]);
      bVar13 = -1 < iVar12;
LAB_18001c596:
      if (bVar3) {
        iVar11 = (**(code **)(*param_1 + 0xa8))(param_1,0);
      }
      else {
        iVar11 = (**(code **)(*param_1 + 200))(param_1);
      }
      iVar12 = iVar7;
      if (iVar11 == 1) {
        EnterCriticalSection(lpCriticalSection);
        if ((DVar8 == 0) || (*(int *)((longlong)param_1 + 0x2c) != 0)) {
          LeaveCriticalSection(lpCriticalSection);
          if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
             (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0 && (3 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
            FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x19,&DAT_18003f728,
                          *(undefined4 *)((longlong)param_1 + 0x2c));
          }
          iVar12 = 0xf;
          iVar11 = (**(code **)(*param_1 + 0xb0))(param_1);
        }
        else {
          *(undefined4 *)(param_1 + 6) = 1;
          LeaveCriticalSection(lpCriticalSection);
        }
      }
    }
    SetEvent((HANDLE)param_1[0xc]);
    param_3 = local_d0;
    iVar7 = iVar12;
    if (iVar11 != 1) {
LAB_18001c7a1:
      FUN_18001cf0c((longlong)param_1);
LAB_18001c7a9:
      if (iVar11 != 1) {
        iVar7 = 2;
      }
      *(undefined4 *)(param_1 + 6) = 5;
      if (bVar4) {
        FUN_18001a42c((undefined8 *)param_1[0xe],1,5,10000,1);
      }
      if (bVar13) {
        (*DAT_18004c278)(DAT_18004c910,param_1[0xd]);
      }
      if (local_c8 != 0) {
        (*DAT_18004c578)(DAT_18004c910);
      }
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1b,&DAT_18003f728,iVar7);
      }
      FUN_18001fe50(local_30 ^ (ulonglong)auStackY_118);
      return;
    }
  } while( true );
}



void FUN_18001c8c0(longlong *param_1,int param_2,ulonglong *param_3,uint param_4,undefined8 *param_5
                  ,uint param_6,uint *param_7)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  longlong lVar3;
  UCHAR *pUVar4;
  undefined1 auStackY_98 [32];
  UCHAR local_68 [32];
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStackY_98;
  if (param_2 == 0x4427c0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x27,&DAT_18003f728);
    }
    bVar1 = FUN_180001330("U2Vj",0x24,&DAT_18003f888,0x20,local_68);
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      iVar2 = (**(code **)(*param_1 + 8))(param_1,&DAT_18003f8b0,0x40,local_68);
      pUVar4 = local_68;
      for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
        *pUVar4 = '\0';
        pUVar4 = pUVar4 + 1;
      }
      if (iVar2 != 0) {
        FUN_180006f98((longlong)param_1,param_3,param_4,param_5,param_6,param_7);
        goto LAB_18001cab4;
      }
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x28,&DAT_18003f728);
    }
  }
  else if (param_2 == 0x4427c4) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x29,&DAT_18003f728);
    }
    FUN_180006d10(param_1 + 2,param_5,param_6,param_7);
  }
  else if (param_2 == 0x4427c8) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2a,&DAT_18003f728);
    }
    FUN_1800064c0(param_1 + 2,(longlong)param_3,param_4);
  }
  else if (param_7 != (uint *)0x0) {
    *param_7 = 0;
  }
LAB_18001cab4:
  FUN_18001fe50(local_48 ^ (ulonglong)auStackY_98);
  return;
}



undefined8 FUN_18001cad0(longlong *param_1,int param_2,int param_3,int param_4)

{
  LPCRITICAL_SECTION lpCriticalSection;
  bool bVar1;
  DWORD DVar2;
  uint uVar3;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x23,&DAT_18003f728,param_2);
  }
  lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 0x68);
  EnterCriticalSection(lpCriticalSection);
  uVar3 = (uint)((int)param_1[6] - 1U < 2);
  if ((uVar3 != 0) || (bVar1 = false, (int)param_1[6] - 3U < 2)) {
    bVar1 = true;
  }
  *(uint *)((longlong)param_1 + 0x33c) = (uint)(param_4 == 0);
  if ((param_4 == 0) == 0) {
    if (*(int *)((longlong)param_1 + 0x2c) - 2U < 2) {
      *(undefined4 *)((longlong)param_1 + 0x2c) = 0;
      *(undefined1 *)(param_1 + 5) = 0;
    }
  }
  else if (*(int *)((longlong)param_1 + 0x2c) == 0) {
    *(undefined1 *)(param_1 + 5) = 1;
    *(uint *)((longlong)param_1 + 0x2c) = (param_3 < 4) + 2;
  }
  if (param_2 == param_3) {
    LeaveCriticalSection(lpCriticalSection);
    goto LAB_18001cc92;
  }
  if (1 < param_3) {
    ResetEvent((HANDLE)param_1[7]);
    SetEvent((HANDLE)param_1[8]);
  }
  LeaveCriticalSection(lpCriticalSection);
  if (param_3 == 2) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x24,&DAT_18003f728);
    }
LAB_18001cd26:
    WaitForSingleObject((HANDLE)param_1[0xb],0xffffffff);
    if (!bVar1) {
      (**(code **)(*param_1 + 0xb0))(param_1);
    }
  }
  else {
    if (param_3 == 3) goto LAB_18001cd26;
    if ((param_3 - 4U < 3) && (WaitForSingleObject((HANDLE)param_1[0xb],0xffffffff), !bVar1)) {
      (**(code **)(*param_1 + 0xb0))(param_1);
    }
  }
  if (param_3 == 1) {
    ResetEvent((HANDLE)param_1[8]);
    SetEvent((HANDLE)param_1[7]);
    if ((bVar1) && (DVar2 = WaitForSingleObject((HANDLE)param_1[0xc],2000), DVar2 != 0)) {
      if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
        return 1;
      }
      if (((PTR_LOOP_18004a7b8[0x1c] & 8) != 0) && (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x25,&DAT_18003f728);
      }
    }
  }
LAB_18001cc92:
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_180012e04(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x26,&DAT_18003f728,uVar3);
  }
  return 1;
}



void FUN_18001cd4c(longlong param_1,undefined1 param_2)

{
  if (*(longlong *)(param_1 + 0x328) == 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1f,&DAT_18003f728);
    }
    FUN_180020400(*(undefined1 (**) [16])(param_1 + 0x310),0,(ulonglong)*(uint *)(param_1 + 0x318));
    *(undefined2 *)(param_1 + 0x308) = 0;
  }
  else {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1e,&DAT_18003f728);
    }
    FUN_18001fe80(*(undefined8 **)(param_1 + 0x310),*(undefined8 **)(param_1 + 0x328),
                  (ulonglong)*(uint *)(param_1 + 0x330));
    *(undefined1 *)(param_1 + 0x308) = param_2;
    *(undefined1 *)(param_1 + 0x309) = *(undefined1 *)(param_1 + 0x321);
  }
  return;
}



undefined8 FUN_18001ce28(longlong param_1,byte param_2)

{
  int iVar1;
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xb,&DAT_18003f728,(uint)param_2);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x340));
  ResetEvent(*(HANDLE *)(param_1 + 0x48));
  iVar1 = *(int *)(param_1 + 0x33c);
  *(undefined4 *)(param_1 + 0x30) = 1;
  if (iVar1 == 0) {
    *(undefined4 *)(param_1 + 0x2c) = 0;
    *(undefined1 *)(param_1 + 0x28) = 0;
  }
  else {
    *(undefined4 *)(param_1 + 0x2c) = 2;
    *(undefined1 *)(param_1 + 0x28) = 1;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x340));
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((PTR_LOOP_18004a7b8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xc,&DAT_18003f728,iVar1);
  }
  return 1;
}



void FUN_18001cf0c(longlong param_1)

{
  int *piVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x368));
  piVar1 = (int *)(param_1 + 0x50);
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    SetEvent(*(HANDLE *)(param_1 + 0x58));
  }
                    // WARNING: Could not recover jumptable at 0x00018001cf45. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x368));
  return;
}



void FUN_18001cf4c(longlong param_1)

{
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x368));
  *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
  if (*(int *)(param_1 + 0x50) == 1) {
    ResetEvent(*(HANDLE *)(param_1 + 0x58));
  }
                    // WARNING: Could not recover jumptable at 0x00018001cf89. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x368));
  return;
}



undefined8 FUN_18001cf90(longlong param_1)

{
  *(undefined4 *)(param_1 + 0x30) = 5;
  return 1;
}



void FUN_18001cfa0(undefined8 param_1,undefined4 *param_2,uint *param_3)

{
  undefined1 auStack_68 [32];
  _FILETIME local_48;
  _FILETIME local_40;
  _SYSTEMTIME local_38;
  SYSTEMTIME local_28;
  ulonglong local_18;
  
  local_18 = DAT_18004a880 ^ (ulonglong)auStack_68;
  if ((param_2 == (undefined4 *)0x0) || (*param_3 < 0x30)) {
    *param_3 = 0x30;
  }
  else {
    GetSystemTime(&local_38);
    local_28.wDayOfWeek = local_38.wDayOfWeek;
    local_28.wDay = local_38.wDay;
    local_28.wHour = local_38.wHour;
    local_28.wMinute = local_38.wMinute;
    local_28.wSecond = local_38.wSecond;
    local_28.wMilliseconds = local_38.wMilliseconds;
    local_28.wMonth = local_38.wMonth;
    local_28.wYear = local_38.wYear + 1;
    SystemTimeToFileTime(&local_38,&local_40);
    SystemTimeToFileTime(&local_28,&local_48);
    *param_2 = 0x11112b72;
    *(_FILETIME *)(param_2 + 4) = local_40;
    *(_FILETIME *)(param_2 + 6) = local_40;
    *(_FILETIME *)(param_2 + 8) = local_48;
    *(undefined1 *)(param_2 + 1) = 0x20;
    param_2[2] = 8;
    *(undefined2 *)(param_2 + 3) = 0;
    *(undefined1 *)((longlong)param_2 + 0xe) = 0xff;
    param_2[10] = 0x401001b;
    param_2[0xb] = 0x401001b;
    *param_3 = 0x30;
  }
  FUN_18001fe50(local_18 ^ (ulonglong)auStack_68);
  return;
}



undefined8 FUN_18001d084(undefined8 param_1,undefined1 (*param_2) [16],uint *param_3)

{
  uint uVar1;
  undefined8 uVar2;
  
  if ((param_2 == (undefined1 (*) [16])0x0) || (*param_3 < 0x28)) {
    *param_3 = 0x28;
    uVar2 = 0xc0000023;
  }
  else {
    FUN_180020400(param_2,0,0x28);
    *(undefined8 *)*param_2 = 0x28;
    uVar1 = *(uint *)*param_2;
    *(undefined4 *)(*param_2 + 8) = 0x46495200;
    *(undefined4 *)(*param_2 + 0xc) = 0x30313000;
    *(undefined4 *)param_2[1] = 0x401001b;
    *param_3 = uVar1;
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 * FUN_18001d0e8(undefined8 *param_1)

{
  HANDLE pvVar1;
  
  *(undefined4 *)(param_1 + 1) = 1;
  *(undefined4 *)((longlong)param_1 + 0xc) = 5;
  *(undefined4 *)((longlong)param_1 + 0x2c) = 2;
  *param_1 = &PTR_FUN_18003f958;
  param_1[2] = 0;
  *(undefined2 *)(param_1 + 5) = 0;
  param_1[7] = 0;
  param_1[8] = 0;
  param_1[9] = 0;
  param_1[0xe] = 0;
  param_1[0x12] = 0;
  *(undefined4 *)(param_1 + 0x13) = 0;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1b,&DAT_18003f948);
  }
  *(undefined4 *)(param_1 + 6) = 0;
  *(undefined4 *)(param_1 + 3) = 0;
  pvVar1 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[4] = pvVar1;
  return param_1;
}



void FUN_18001d19c(longlong param_1)

{
  int *piVar1;
  undefined2 uVar2;
  bool bVar3;
  bool bVar4;
  DWORD DVar5;
  int iVar6;
  int iVar7;
  ULONGLONG UVar8;
  ULONGLONG UVar9;
  ULONGLONG UVar10;
  int *piVar11;
  undefined4 uVar12;
  undefined4 *puVar13;
  longlong lVar14;
  int iVar15;
  undefined1 (*pauVar16) [16];
  uint uVar17;
  undefined2 local_res8;
  uint local_res10;
  undefined4 uStackX_14;
  
  UVar8 = GetTickCount64();
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xd,&DAT_18003f948,
                  (uint)*(byte *)(*(longlong *)(param_1 + 0x60) + 4));
  }
  piVar1 = (int *)(param_1 + 0x9c);
LAB_18001d213:
  bVar4 = false;
  lVar14 = 0;
  if (*piVar1 != 0) {
LAB_18001d308:
    if (*(short *)(param_1 + 0x28) != 0) goto LAB_18001d313;
LAB_18001d4ce:
    iVar6 = FUN_18001bf68(*(longlong **)(param_1 + 0x78),
                          *(undefined1 *)(*(longlong *)(param_1 + 0x60) + 4),piVar1);
    if (((*piVar1 != 0) || (iVar6 != 0xf)) || (*(int *)(param_1 + 0x18) != 0)) goto LAB_18001d538;
    goto LAB_18001d213;
  }
  *piVar1 = 1;
  if (*(short *)(param_1 + 0x28) == 0) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xe,&DAT_18003f948);
    }
    UVar9 = GetTickCount64();
    FUN_18001e9c4(param_1);
    if (*(short *)(param_1 + 0x28) == 0) {
      iVar6 = FUN_18001bd8c(*(longlong **)(param_1 + 0x78));
      if (iVar6 == 1) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
           (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x10,&DAT_18003f948);
        }
        *(undefined2 *)(param_1 + 0x28) = 0xffff;
      }
    }
    else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
             ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
            (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xf,&DAT_18003f948,
                    (uint)*(ushort *)(param_1 + 0x28));
    }
    UVar10 = GetTickCount64();
    lVar14 = UVar10 - UVar9;
    goto LAB_18001d308;
  }
LAB_18001d313:
  UVar9 = GetTickCount64();
  if ((ulonglong)(*(longlong *)(param_1 + 0x80) + 0x1d4c + lVar14) < UVar9) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x11,&DAT_18003f948);
    }
LAB_18001d48e:
    FUN_18001e474(param_1,0);
    goto LAB_18001d4ce;
  }
  DVar5 = WTSGetActiveConsoleSessionId();
  if (DVar5 != 0xffffffff) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x12,&DAT_18003f948,DVar5);
    }
    iVar6 = WTSQuerySessionInformationW(0,DVar5,0x19,&local_res10,&local_res8);
    if (iVar6 != 0) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
         (4 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x13,&DAT_18003f948,
                      *(undefined4 *)(CONCAT44(uStackX_14,local_res10) + 0xc));
      }
      piVar11 = (int *)CONCAT44(uStackX_14,local_res10);
      if ((((*piVar11 != 1) ||
           ((bVar3 = true, piVar11[3] == (uint)(DAT_18004c144 != 0) && (piVar11[2] == 0)))) &&
          (bVar3 = bVar4, (undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8)) &&
         (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0 &&
          (3 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x14,&DAT_18003f948);
        piVar11 = (int *)CONCAT44(uStackX_14,local_res10);
      }
      WTSFreeMemory(piVar11);
      if (!bVar3) goto LAB_18001d48e;
    }
  }
  if ((*(ulonglong *)(param_1 + 0x80) <= UVar8) || (DVar5 = 0x5dc, *(int *)(param_1 + 0x88) != 3)) {
    DVar5 = 0xfa;
  }
  DVar5 = WaitForSingleObject(*(HANDLE *)(param_1 + 0x20),DVar5);
  if (DVar5 == 0) {
    FUN_18001cf90(*(longlong *)(param_1 + 0x78));
    iVar6 = 0xf;
    goto LAB_18001d538;
  }
  if (*(char *)(*(longlong *)(param_1 + 0x60) + 4) != '\x02') goto LAB_18001d4ce;
  if (*(short *)(param_1 + 0x28) == -1) {
    FUN_18001cd4c(*(longlong *)(param_1 + 0x78),*(undefined1 *)(*(longlong *)(param_1 + 0x60) + 4));
  }
  FUN_18001cf90(*(longlong *)(param_1 + 0x78));
  iVar6 = 1;
LAB_18001d538:
  lVar14 = *(longlong *)(param_1 + 0x68);
  pauVar16 = (undefined1 (*) [16])(lVar14 + 0x14);
  FUN_180020400(pauVar16,0,0x20);
  if (iVar6 == 1) {
    puVar13 = (undefined4 *)(lVar14 + 0x34);
    uVar17 = *(int *)(*(longlong *)(param_1 + 0x68) + 0x10) - 0x20;
    local_res10 = uVar17;
    iVar7 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x88))
                      (*(longlong **)(param_1 + 0x78),puVar13,&local_res10);
    iVar15 = (int)pauVar16;
    if (iVar7 == 0) {
      iVar7 = (int)puVar13;
      puVar13 = (undefined4 *)((longlong)puVar13 + (ulonglong)local_res10);
      uVar17 = uVar17 - local_res10;
      *(int *)(lVar14 + 0x18) = iVar7 - iVar15;
      *(uint *)*pauVar16 = local_res10;
    }
    local_res10 = uVar17;
    iVar7 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x90))
                      (*(longlong **)(param_1 + 0x78),puVar13,&local_res10);
    if (iVar7 == 0) {
      *(int *)(lVar14 + 0x20) = (int)puVar13 - iVar15;
      *(uint *)(lVar14 + 0x1c) = local_res10;
      puVar13 = (undefined4 *)((longlong)puVar13 + (ulonglong)local_res10);
    }
    if ((*(short *)(param_1 + 0x28) == 0) ||
       (*(char *)(*(longlong *)(param_1 + 0x60) + 4) != '\x02')) {
      *(undefined2 *)(puVar13 + 1) = 0;
      *puVar13 = 0;
    }
    else {
      local_res8 = 0;
      (**(code **)(**(longlong **)(param_1 + 0x78) + 0xd8))
                (*(longlong **)(param_1 + 0x78),&local_res8,1,(longlong)&local_res8 + 1);
      uVar2 = *(undefined2 *)(param_1 + 0x28);
      *puVar13 = 1;
      *(undefined2 *)(puVar13 + 1) = uVar2;
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
         (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x15,&DAT_18003f948,
                      (uint)*(ushort *)(param_1 + 0x28));
      }
    }
    *(undefined4 *)(lVar14 + 0x24) = 8;
    *(int *)(lVar14 + 0x28) = (int)puVar13 - iVar15;
  }
  if ((*(int *)(*(longlong *)(param_1 + 0x40) + 0x5c) < 3) && (*(int *)(param_1 + 0x18) == 0)) {
    if (iVar6 == 1) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
         (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x19,&DAT_18003f948);
      }
      *(undefined4 *)(param_1 + 0x50) = 0;
      *(undefined4 *)(param_1 + 0xc) = 1;
      *(undefined4 *)(*(longlong *)(param_1 + 0x68) + 4) = 0;
      *(undefined4 *)(*(longlong *)(param_1 + 0x68) + 0xc) = 0;
      *(undefined4 *)(*(longlong *)(param_1 + 0x68) + 8) = 1;
      goto LAB_18001d7f4;
    }
    if (iVar6 == 0x14) {
      uVar12 = 9;
    }
    else {
      uVar12 = 7;
      if (iVar6 == 0x1b) {
        uVar12 = 5;
      }
      else if (iVar6 != 0x1c) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
           (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x17,&DAT_18003f948);
        }
        *(undefined4 *)(param_1 + 0x50) = 0x8000ffff;
        goto LAB_18001d7ce;
      }
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x18,&DAT_18003f948,uVar12);
    }
    *(undefined4 *)(param_1 + 0x50) = 0;
    *(undefined4 *)(param_1 + 0x54) = 0x18;
    *(undefined4 *)(param_1 + 0xc) = 2;
    **(undefined4 **)(param_1 + 0x68) = 0x18;
    *(undefined4 *)(*(longlong *)(param_1 + 0x68) + 4) = 0;
    *(undefined4 *)(*(longlong *)(param_1 + 0x68) + 0xc) = uVar12;
  }
  else {
    if (((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
       (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0 && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
        ))) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x16,&DAT_18003f948);
    }
    *(undefined4 *)(param_1 + 0x50) = 0x800703e3;
LAB_18001d7ce:
    *(undefined4 *)(param_1 + 0x54) = 0x18;
    *(undefined4 *)(param_1 + 0xc) = 2;
    **(undefined4 **)(param_1 + 0x68) = 0x18;
    *(undefined4 *)(*(longlong *)(param_1 + 0x68) + 4) = 0x80098004;
  }
  *(undefined4 *)(*(longlong *)(param_1 + 0x68) + 8) = 2;
LAB_18001d7f4:
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18001f8b0(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1a,&DAT_18003f948,
                  *(undefined4 *)(param_1 + 0x50));
  }
  return;
}



undefined8 FUN_18001d85c(longlong param_1)

{
  int *piVar1;
  
  FUN_18001d19c(param_1);
  CloseHandle(*(HANDLE *)(param_1 + 0x70));
  *(undefined8 *)(param_1 + 0x70) = 0;
  FUN_18001daa0(param_1,*(undefined4 *)(param_1 + 0x50),*(undefined4 *)(param_1 + 0x54));
  piVar1 = (int *)(param_1 + 8);
  LOCK();
  *piVar1 = *piVar1 + -1;
  UNLOCK();
  if ((*piVar1 == 0) && (piVar1 != (int *)0x0)) {
    thunk_FUN_18001fcb8(piVar1);
  }
  return 0;
}



undefined4 FUN_18001d8a4(undefined8 param_1,longlong param_2)

{
  undefined4 uVar1;
  
  if (((*(byte *)(param_2 + 4) < 0x11) && ((0x10116U >> (*(byte *)(param_2 + 4) & 0x1f) & 1) != 0))
     || (*(char *)(param_2 + 4) == -0x80)) {
    if ((*(short *)(param_2 + 8) == 0x401) && (*(short *)(param_2 + 6) == 0x1b)) {
      uVar1 = 0;
      if (*(char *)(param_2 + 0x1c) != ' ') {
        uVar1 = 0x8009800d;
      }
    }
    else {
      uVar1 = 0x8009800c;
    }
  }
  else {
    uVar1 = 0x8009800e;
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2e,&DAT_18003f948,uVar1);
  }
  return uVar1;
}



undefined8
FUN_18001d934(undefined *param_1,undefined8 param_2,ulonglong param_3,ulonglong param_4,
             ulonglong param_5,ulonglong param_6,undefined4 *param_7)

{
  if (param_3 < param_4) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18001f97c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),10,&DAT_18003f948,param_1);
    }
  }
  else {
    if (param_6 == 0) {
      return 1;
    }
    if ((param_7 != (undefined4 *)0x0) && (3 < param_5)) {
      if (param_5 < param_6) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
           (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18001f97c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xc,&DAT_18003f948,param_1);
        }
        *param_7 = (int)param_6;
        (*DAT_18004c670)(DAT_18004c910,param_2,0,4);
        return 0;
      }
      return 1;
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_180012fe0(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0xb,&DAT_18003f948,param_1);
    }
  }
  (*DAT_18004c668)(DAT_18004c910,param_2,0x80070057);
  return 0;
}



void FUN_18001daa0(longlong param_1,undefined4 param_2,undefined4 param_3)

{
  longlong lVar1;
  
  LOCK();
  lVar1 = *(longlong *)(param_1 + 0x38);
  *(longlong *)(param_1 + 0x38) = 0;
  UNLOCK();
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (4 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2d,&DAT_18003f948,(int)lVar1);
  }
  if (lVar1 != 0) {
    (*DAT_18004c630)(DAT_18004c910,lVar1);
    (*DAT_18004c670)(DAT_18004c910,lVar1,param_2,param_3);
    FUN_18000e724(*(longlong *)(param_1 + 0x40),0);
  }
  return;
}



uint FUN_18001db48(undefined8 param_1,undefined8 param_2,undefined8 *param_3)

{
  uint uVar1;
  undefined8 *puVar2;
  uint uVar3;
  DWORD local_res20 [2];
  HKEY local_38 [2];
  
  puVar2 = (undefined8 *)FUN_180020780(0xa0);
  if (puVar2 == (undefined8 *)0x0) {
    puVar2 = (undefined8 *)0x0;
  }
  else {
    puVar2 = FUN_18001d0e8(puVar2);
  }
  local_38[0] = (HKEY)0x0;
  uVar3 = ~-(uint)(puVar2 != (undefined8 *)0x0) & 0xc000009a;
  if (-1 < (int)uVar3) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1d,&DAT_18003f948);
    }
    puVar2[9] = param_1;
    puVar2[8] = param_2;
    uVar3 = 0;
    *param_3 = puVar2;
    LOCK();
    *(int *)(puVar2 + 1) = *(int *)(puVar2 + 1) + 1;
    UNLOCK();
    uVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,
                          L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WUDF\\Services\\EgisTouchFP0575\\FPParameters"
                          ,0,0x20019,local_38);
    if (uVar1 == 0) {
      local_res20[0] = 4;
      uVar1 = RegQueryValueExW(local_38[0],L"VerticalFlipEnabled",(LPDWORD)0x0,(LPDWORD)0x0,
                               (LPBYTE)(puVar2 + 6),local_res20);
      if (((uVar1 != 0) && ((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8)) &&
         (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0 &&
          (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
        FUN_18001f828(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1f,&DAT_18003f948,
                      (ulonglong)uVar1);
      }
    }
    else if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
             ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
            (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18001f904(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x1e,&DAT_18003f948,(ulonglong)uVar1)
      ;
    }
    if (local_38[0] != (HKEY)0x0) {
      RegCloseKey(local_38[0]);
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x20,&DAT_18003f948);
  }
  return uVar3;
}



void FUN_18001dd30(undefined8 param_1)

{
  undefined8 uVar1;
  longlong *plVar2;
  
  uVar1 = (*DAT_18004c6c8)(DAT_18004c910,param_1);
  uVar1 = (*DAT_18004c420)(DAT_18004c910,uVar1);
  plVar2 = (longlong *)(*DAT_18004c528)(DAT_18004c910,uVar1,PTR_DAT_18004a808);
                    // WARNING: Could not recover jumptable at 0x00018001dd82. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)**(undefined8 **)(*plVar2 + 0x50))(*(undefined8 **)(*plVar2 + 0x50),param_1);
  return;
}



void FUN_18001dd88(longlong param_1)

{
  CloseHandle(*(HANDLE *)(param_1 + 0x20));
  if (*(longlong *)(param_1 + 0x10) != 0) {
    (*DAT_18004c498)(DAT_18004c910);
    (*DAT_18004c558)(DAT_18004c910,*(undefined8 *)(param_1 + 0x10));
    *(undefined8 *)(param_1 + 0x10) = 0;
  }
  return;
}



void FUN_18001ddd0(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_res18 [2];
  undefined1 (*local_res20) [16];
  ulonglong local_38;
  undefined8 local_30;
  undefined8 local_28 [2];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x34,&DAT_18003f948);
  }
  FUN_18001b224(param_2,local_res18,local_28,&local_30,&local_res20,&local_38);
  uVar2 = FUN_18001d934("CWBDIHandler::OnCalibrate",param_2,0,0,local_38,0x10,
                        (undefined4 *)&local_res20);
  if ((int)uVar2 != 0) {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x68))();
    if (iVar1 == 0) {
      iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x70))();
      if (((iVar1 < 0) && ((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8)) &&
         (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0 &&
          (1 < (byte)PTR_LOOP_18004a7b8[0x19])))) {
        FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x35,&DAT_18003f948);
      }
    }
    FUN_180020400(local_res20,0,local_38);
    *(undefined4 *)*local_res20 = 0x10;
    *(undefined4 *)(*local_res20 + 4) = 0;
    *(undefined4 *)(param_1 + 0xc) = 3;
    (*DAT_18004c670)(DAT_18004c910,param_2,0,*(undefined4 *)*local_res20);
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x36,&DAT_18003f948);
    }
  }
  return;
}



void FUN_18001df4c(longlong param_1,longlong param_2)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x100) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x29,&DAT_18003f948);
  }
  if (*(longlong *)(param_1 + 0x38) == param_2) {
    *(undefined4 *)(param_1 + 0x18) = 1;
    SetEvent(*(HANDLE *)(param_1 + 0x20));
    FUN_18001bcc8(*(longlong *)(param_1 + 0x78),1);
  }
  else if (*(longlong *)(param_1 + 0x38) == 0) {
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return;
    }
    if (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x100) != 0) &&
       (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18001f904(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2b,&DAT_18003f948,param_2);
    }
  }
  else {
    if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) {
      return;
    }
    if (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x100) != 0) &&
       (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18001f938(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2a,&DAT_18003f948,param_2);
    }
  }
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x100) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2c,&DAT_18003f948);
  }
  return;
}



void FUN_18001e06c(LPVOID param_1,longlong param_2)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  HANDLE pvVar5;
  undefined8 uVar6;
  bool bVar7;
  uint local_res20 [2];
  int **ppiVar8;
  int **ppiVar9;
  undefined4 local_68 [2];
  int *local_60;
  int local_58;
  undefined4 uStack_54;
  longlong local_50;
  ulonglong local_48 [2];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x39,&DAT_18003f948);
  }
  ppiVar8 = &local_60;
  FUN_18001b224(param_2,local_68,&local_50,local_48,ppiVar8,(undefined8 *)&local_58);
  if (((local_50 == 0) || (local_48[0] < 0x20)) ||
     ((local_60 == (int *)0x0 || (CONCAT44(uStack_54,local_58) < 4)))) {
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3a,&DAT_18003f948);
    }
    (*DAT_18004c668)(DAT_18004c910,param_2,0x80070057);
  }
  else {
    local_res20[0] = 0;
    (**(code **)(**(longlong **)((longlong)param_1 + 0x78) + 0x88))
              (*(longlong **)((longlong)param_1 + 0x78),0,local_res20);
    (**(code **)(**(longlong **)((longlong)param_1 + 0x78) + 0x90))
              (*(longlong **)((longlong)param_1 + 0x78),0);
    uVar3 = local_res20[0];
    iVar2 = local_res20[0] + 0x28;
    ppiVar9 = (int **)((ulonglong)local_res20[0] + 0x40);
    if ((int **)CONCAT44(uStack_54,local_58) < ppiVar9) {
      if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
          ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
         (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
        FUN_18001f86c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3b,&DAT_18003f948,local_58);
        ppiVar8 = ppiVar9;
      }
      uVar6 = 4;
      *local_60 = uVar3 + 0x40;
    }
    else {
      iVar4 = FUN_18001d8a4(param_1,local_50);
      if (iVar4 < 0) {
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
           (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          FUN_18000e7a8(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3c,&DAT_18003f948,iVar4);
        }
        local_60[1] = iVar4;
        *local_60 = 0x18;
        local_60[2] = 3;
      }
      else {
        LOCK();
        bVar7 = *(longlong *)((longlong)param_1 + 0x38) == 0;
        if (bVar7) {
          *(longlong *)((longlong)param_1 + 0x38) = param_2;
        }
        UNLOCK();
        if (bVar7) {
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
             (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3d,&DAT_18003f948);
          }
          *(undefined4 *)((longlong)param_1 + 0xc) = 3;
          uVar6 = FUN_18001ce28(*(longlong *)((longlong)param_1 + 0x78),*(byte *)(local_50 + 4));
          if ((int)uVar6 == 1) {
            FUN_18001f7a8((longlong)param_1,param_2,0);
            *local_60 = local_58;
            piVar1 = (int *)((longlong)param_1 + 8);
            local_60[1] = iVar4;
            local_60[2] = 3;
            local_60[3] = 0;
            local_60[4] = iVar2;
            *(undefined4 *)((longlong)param_1 + 0x50) = 0;
            iVar2 = *local_60;
            *(int **)((longlong)param_1 + 0x68) = local_60;
            *(int *)((longlong)param_1 + 0x54) = iVar2;
            *(longlong *)((longlong)param_1 + 0x60) = local_50;
            LOCK();
            *piVar1 = *piVar1 + 1;
            UNLOCK();
            pvVar5 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_18001d85c,param_1,0,(LPDWORD)0x0)
            ;
            *(HANDLE *)((longlong)param_1 + 0x70) = pvVar5;
            if (pvVar5 != (HANDLE)0x0) {
              return;
            }
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
               (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x40,&DAT_18003f948);
            }
            FUN_18001cf90(*(longlong *)((longlong)param_1 + 0x78));
            FUN_18001daa0((longlong)param_1,0x8000ffff,0);
            LOCK();
            *piVar1 = *piVar1 + -1;
            UNLOCK();
            if (*piVar1 != 0) {
              return;
            }
            if (piVar1 == (int *)0x0) {
              return;
            }
            thunk_FUN_18001fcb8(piVar1);
            return;
          }
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
             (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3e,&DAT_18003f948);
          }
          LOCK();
          *(undefined8 *)((longlong)param_1 + 0x38) = 0;
          UNLOCK();
          *local_60 = 0x18;
          local_60[1] = -0x7ff67fca;
        }
        else {
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
             (2 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x3f,&DAT_18003f948);
          }
          *local_60 = 0x18;
          local_60[1] = -0x7ff67ff5;
        }
        local_60[2] = 4;
      }
      uVar6 = 0x18;
      local_60[3] = 0;
      local_60[4] = 0;
    }
    (*DAT_18004c670)(DAT_18004c910,param_2,0,uVar6,ppiVar8);
  }
  return;
}



void FUN_18001e474(longlong param_1,longlong param_2)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x52,&DAT_18003f948);
  }
  if (*(short *)(param_1 + 0x28) == -1) {
    FUN_18001bec8(*(longlong *)(param_1 + 0x78));
  }
  *(undefined4 *)(param_1 + 0x9c) = 1;
  *(undefined2 *)(param_1 + 0x28) = 0;
  if (param_2 != 0) {
    (*DAT_18004c668)(DAT_18004c910,param_2,0);
  }
  return;
}



void FUN_18001e504(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_res18 [2];
  undefined4 *local_res20;
  undefined8 local_38;
  undefined8 local_30;
  ulonglong local_28 [2];
  
  local_res18[0] = 0;
  local_30 = 0;
  local_38 = 0;
  local_res20 = (undefined4 *)0x0;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x2f,&DAT_18003f948);
  }
  FUN_18001b224(param_2,local_res18,&local_30,&local_38,&local_res20,local_28);
  uVar2 = FUN_18001d934("CWBDIHandler::OnGetAttributes",param_2,0,0,local_28[0],0x62c,
                        (undefined4 *)&local_res20);
  if ((int)uVar2 != 0) {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x60))
                      (*(longlong **)(param_1 + 0x78),local_res20);
    if (iVar1 < 0) {
      (*DAT_18004c668)(DAT_18004c910,param_2,0x8000ffff);
    }
    else {
      FUN_18000cfa0(*(longlong *)(param_1 + 0x40),(longlong)local_res20);
      (*DAT_18004c670)(DAT_18004c910,param_2,0,*local_res20);
    }
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x30,&DAT_18003f948);
    }
  }
  return;
}



void FUN_18001e654(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_res10;
  undefined4 local_res18 [2];
  uint *local_res20;
  longlong local_38;
  longlong local_30;
  ulonglong local_28 [2];
  
  FUN_18001b224(param_2,local_res18,&local_res20,&local_38,&local_30,local_28);
  uVar2 = 0;
  if ((((local_res20 == (uint *)0x0) || (local_38 != 4)) || (local_30 == 0)) ||
     (local_28[0] < *local_res20)) {
    uVar2 = 0xc000000d;
  }
  else {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x100))();
    if (iVar1 == 0) {
      (*DAT_18004c6a0)(DAT_18004c910,param_2,local_res10);
    }
    else {
      uVar2 = 0xc0000001;
    }
  }
  (*DAT_18004c668)(DAT_18004c910,param_2,uVar2);
  return;
}



void FUN_18001e708(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_res10 [2];
  undefined4 local_res18;
  undefined4 uStackX_1c;
  undefined1 *local_res20;
  longlong local_28;
  longlong local_20;
  
  FUN_18001b224(param_2,local_res10,&local_res20,&local_28,&local_20,(undefined8 *)&local_res18);
  uVar2 = 0;
  if ((((local_res20 == (undefined1 *)0x0) || (local_28 == 0)) || (local_20 == 0)) ||
     (CONCAT44(uStackX_1c,local_res18) == 0)) {
    uVar2 = 0xc000000d;
  }
  else {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0xe8))
                      (*(longlong **)(param_1 + 0x78),local_20,local_res18,*local_res20);
    if (iVar1 == 0) {
      (*DAT_18004c6a0)(DAT_18004c910,param_2,CONCAT44(uStackX_1c,local_res18));
    }
    else {
      uVar2 = 0xc0000001;
    }
  }
  (*DAT_18004c668)(DAT_18004c910,param_2,uVar2);
  return;
}



void FUN_18001e7b8(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_res10 [2];
  undefined4 local_res18;
  undefined4 uStackX_1c;
  undefined1 *local_res20;
  undefined1 (*local_28) [16];
  longlong local_20;
  
  FUN_18001b224(param_2,local_res10,&local_res20,&local_20,&local_28,(undefined8 *)&local_res18);
  uVar2 = 0;
  if ((((local_res20 == (undefined1 *)0x0) || (local_20 == 0)) ||
      (local_28 == (undefined1 (*) [16])0x0)) || (CONCAT44(uStackX_1c,local_res18) == 0)) {
    uVar2 = 0xc000000d;
  }
  else {
    FUN_180020400(local_28,0xff,CONCAT44(uStackX_1c,local_res18));
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0xf8))
                      (*(longlong **)(param_1 + 0x78),local_28,local_res18,*local_res20);
    if (iVar1 == 0) {
      (*DAT_18004c6a0)(DAT_18004c910,param_2,CONCAT44(uStackX_1c,local_res18));
    }
    else {
      uVar2 = 0xc0000001;
    }
  }
  (*DAT_18004c668)(DAT_18004c910,param_2,uVar2);
  return;
}



void FUN_18001e884(longlong param_1,undefined8 param_2)

{
  undefined8 uVar1;
  undefined4 local_res18 [2];
  undefined8 *local_res20;
  ulonglong local_38 [4];
  
  local_res18[0] = 0;
  local_38[2] = 0;
  local_38[1] = 0;
  local_res20 = (undefined8 *)0x0;
  local_38[0] = 0;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x43,&DAT_18003f948);
  }
  FUN_18001b224(param_2,local_res18,local_38 + 2,local_38 + 1,&local_res20,local_38);
  uVar1 = FUN_18001d934("CWBDIHandler::OnGetIndicator",param_2,0,0,local_38[0],0xc,
                        (undefined4 *)&local_res20);
  if ((int)uVar1 != 0) {
    *local_res20 = 0;
    *(undefined4 *)(local_res20 + 1) = 0;
    *(undefined4 *)local_res20 = 0xc;
    *(undefined4 *)((longlong)local_res20 + 4) = 0;
    *(undefined4 *)(local_res20 + 1) = *(undefined4 *)(param_1 + 0x2c);
    (*DAT_18004c670)(DAT_18004c910,param_2,0,0xc);
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x44,&DAT_18003f948);
    }
  }
  return;
}



void FUN_18001e9c4(longlong param_1)

{
  ushort uVar1;
  longlong lVar2;
  undefined8 uVar3;
  HANDLE hHandle;
  char cVar4;
  int iVar5;
  longlong lVar6;
  ULONGLONG UVar7;
  undefined2 uVar8;
  undefined8 uStackX_8;
  undefined8 uStackX_20;
  undefined4 local_40b8;
  undefined4 local_40b4;
  undefined4 local_40a8;
  undefined8 local_4068;
  undefined8 local_4060;
  undefined1 local_4058 [14];
  ushort local_404a;
  ulonglong local_38;
  undefined8 uStack_30;
  
  uStack_30 = 0x18001e9e8;
  lVar6 = FUN_180020c30();
  lVar6 = -lVar6;
  local_38 = DAT_18004a880 ^ (ulonglong)(&stack0xffffffffffffffd8 + lVar6);
  *(undefined8 *)(&stack0x00000018 + lVar6) = 0;
  *(undefined8 *)((longlong)&uStackX_20 + lVar6) = 0;
  *(undefined8 *)(&stack0x00000028 + lVar6) = 0;
  *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ea24;
  FUN_180020400((undefined1 (*) [16])local_4058,0,0x4014);
  lVar2 = *(longlong *)(param_1 + 0x10);
  if (lVar2 == 0) {
    *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ea37;
    FUN_18001e474(param_1,0);
    if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) == 0)) ||
       ((byte)PTR_LOOP_18004a7b8[0x19] < 4)) goto LAB_18001ef35;
    uVar8 = 0x47;
  }
  else {
    if (*(longlong *)(param_1 + 0x90) != *(longlong *)(param_1 + 0x80)) {
      *(longlong *)(param_1 + 0x90) = *(longlong *)(param_1 + 0x80);
      *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ea9e;
      iVar5 = (*DAT_18004c5f0)(DAT_18004c910,0,lVar2,&stack0x00000018 + lVar6);
      if (iVar5 < 0) {
LAB_18001ee46:
        if ((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) {
          if (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0) &&
             (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            uVar8 = 0x49;
LAB_18001ee6e:
            uVar3 = *(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10);
            *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ee7d;
            FUN_18000e7a8(uVar3,uVar8,&DAT_18003f948,iVar5);
          }
LAB_18001ee84:
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
             (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            uVar1 = *(ushort *)(param_1 + 0x28);
            uVar3 = *(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10);
            *(undefined4 *)(&stack0xfffffffffffffff8 + lVar6) = *(undefined4 *)(param_1 + 0x9c);
            *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001eeb4;
            FUN_18000e850(uVar3,0x51,&DAT_18003f948,(uint)uVar1);
          }
        }
      }
      else {
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001eac1;
        FUN_180020400((undefined1 (*) [16])(&stack0x00000048 + lVar6),0,0x38);
        *(longlong *)(&stack0xfffffffffffffff8 + lVar6) = (longlong)&uStackX_20 + lVar6;
        *(undefined4 *)(&stack0x00000048 + lVar6) = 0x38;
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001eafd;
        (*DAT_18004c500)(DAT_18004c910,&stack0x00000048 + lVar6,local_4058,0x4014);
        *(undefined1 **)(&stack0xfffffffffffffff8 + lVar6) = &stack0x00000028 + lVar6;
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001eb20;
        iVar5 = (*DAT_18004c500)(DAT_18004c910,&stack0x00000048 + lVar6,local_4058,0x4014);
        if (iVar5 < 0) goto LAB_18001ee46;
        uVar3 = *(undefined8 *)(param_1 + 0x10);
        *(undefined8 *)(&stack0x00000010 + lVar6) = 0;
        *(undefined8 *)((longlong)&uStackX_8 + lVar6) = *(undefined8 *)(&stack0x00000028 + lVar6);
        *(undefined8 *)(&stack0x00000000 + lVar6) = 0;
        *(undefined8 *)(&stack0xfffffffffffffff8 + lVar6) =
             *(undefined8 *)((longlong)&uStackX_20 + lVar6);
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001eb62;
        iVar5 = (*DAT_18004c4f0)(DAT_18004c910,uVar3,*(undefined8 *)(&stack0x00000018 + lVar6),
                                 0x8010204c);
        if (iVar5 < 0) {
          if ((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) {
            if (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0) &&
               (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              uVar8 = 0x4a;
              goto LAB_18001ee6e;
            }
            goto LAB_18001ee84;
          }
          goto LAB_18001eeb4;
        }
        uVar3 = *(undefined8 *)(param_1 + 0x10);
        local_4060 = 0;
        local_4068 = 0x200000010;
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ebd0;
        cVar4 = (*DAT_18004c610)(DAT_18004c910,*(undefined8 *)(&stack0x00000018 + lVar6),uVar3,
                                 &local_4068);
        if (cVar4 == '\0') {
          *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ebe6;
          iVar5 = (*DAT_18004c618)();
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
             (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            uVar8 = 0x4b;
LAB_18001ec0e:
            uVar3 = *(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10);
            *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ec1d;
            FUN_18000e7a8(uVar3,uVar8,&DAT_18003f948,iVar5);
          }
LAB_18001ec1d:
          *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ec27;
          FUN_18001e474(param_1,0);
          goto LAB_18001ee84;
        }
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ec32;
        iVar5 = (*DAT_18004c618)(DAT_18004c910);
        if (iVar5 < 0) {
          if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
              ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
             (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
            uVar8 = 0x4c;
            goto LAB_18001ec0e;
          }
          goto LAB_18001ec1d;
        }
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ec6f;
        FUN_180020400((undefined1 (*) [16])&local_40b8,0,0x48);
        local_40b8 = 0x48;
        local_40b4 = 0xff;
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ec93;
        (*DAT_18004c658)(DAT_18004c910,*(undefined8 *)(&stack0x00000018 + lVar6),&local_40b8);
        if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
            ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
           (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
          uVar3 = *(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10);
          *(undefined4 *)(&stack0xfffffffffffffff8 + lVar6) = local_40a8;
          *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ecd3;
          FUN_18000e850(uVar3,0x4d,&DAT_18003f948,(uint)local_404a);
        }
        if (0xffe < (ushort)(local_404a - 1)) goto LAB_18001ec1d;
        uVar3 = *(undefined8 *)(&stack0x00000018 + lVar6);
        *(ushort *)(param_1 + 0x28) = local_404a;
        *(undefined8 *)(&stack0x00000030 + lVar6) = 0;
        *(undefined8 *)(&stack0x00000038 + lVar6) = 0;
        local_404a = 0;
        *(undefined8 *)(&stack0x00000040 + lVar6) = 0;
        *(undefined8 *)(&stack0x00000030 + lVar6) = 0x18;
        *(undefined4 *)(&stack0x00000038 + lVar6) = 0;
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ed2b;
        (*DAT_18004c5f8)(DAT_18004c910,uVar3,&stack0x00000030 + lVar6);
        uVar3 = *(undefined8 *)(param_1 + 0x10);
        *(undefined8 *)(&stack0x00000010 + lVar6) = 0;
        *(undefined8 *)((longlong)&uStackX_8 + lVar6) = *(undefined8 *)(&stack0x00000028 + lVar6);
        *(undefined8 *)(&stack0x00000000 + lVar6) = 0;
        *(undefined8 *)(&stack0xfffffffffffffff8 + lVar6) =
             *(undefined8 *)((longlong)&uStackX_20 + lVar6);
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ed65;
        iVar5 = (*DAT_18004c4f0)(DAT_18004c910,uVar3,*(undefined8 *)(&stack0x00000018 + lVar6),
                                 0x80102050);
        if (-1 < iVar5) {
          uVar3 = *(undefined8 *)(param_1 + 0x10);
          local_4060 = 0;
          local_4068 = 0x200000010;
          *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001edc8;
          cVar4 = (*DAT_18004c610)(DAT_18004c910,*(undefined8 *)(&stack0x00000018 + lVar6),uVar3,
                                   &local_4068);
          if (cVar4 == '\0') {
            *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001edde;
            iVar5 = (*DAT_18004c618)();
            if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
                ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
               (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              uVar8 = 0x4f;
              goto LAB_18001ec0e;
            }
            goto LAB_18001ec1d;
          }
          *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ee11;
          iVar5 = (*DAT_18004c618)(DAT_18004c910);
          if (((iVar5 + 0x80000000U & 0x80000000) == 0) && (iVar5 != -0x3fffffde)) {
            if ((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) goto LAB_18001eeb4;
            if (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0) &&
               (1 < (byte)PTR_LOOP_18004a7b8[0x19])) {
              uVar8 = 0x50;
              goto LAB_18001ee6e;
            }
          }
          goto LAB_18001ee84;
        }
        if ((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) {
          if (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) == 0) ||
             ((byte)PTR_LOOP_18004a7b8[0x19] < 2)) goto LAB_18001ee84;
          uVar8 = 0x4e;
          goto LAB_18001ee6e;
        }
      }
LAB_18001eeb4:
      if (*(longlong *)(&stack0x00000018 + lVar6) != 0) {
        *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001eecb;
        (*DAT_18004c558)(DAT_18004c910);
      }
      goto LAB_18001ef35;
    }
    *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001eed3;
    UVar7 = GetTickCount64();
    if (UVar7 - *(longlong *)(param_1 + 0x90) < 0x493e1) {
      hHandle = *(HANDLE *)(param_1 + 0x20);
      *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ef35;
      WaitForSingleObject(hHandle,0x9c4);
      goto LAB_18001ef35;
    }
    *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001eeec;
    FUN_18001e474(param_1,0);
    if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) == 0)) ||
       ((byte)PTR_LOOP_18004a7b8[0x19] < 4)) goto LAB_18001ef35;
    uVar8 = 0x48;
  }
  uVar3 = *(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10);
  *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ef24;
  FUN_18000c80c(uVar3,uVar8,&DAT_18003f948);
LAB_18001ef35:
  *(undefined8 *)((longlong)&uStack_30 + lVar6) = 0x18001ef44;
  FUN_18001fe50(local_38 ^ (ulonglong)(&stack0xffffffffffffffd8 + lVar6));
  return;
}



void FUN_18001ef60(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_res18 [2];
  undefined8 *local_res20;
  ulonglong uVar3;
  ulonglong local_38;
  undefined8 local_30;
  undefined8 local_28 [2];
  
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x37,&DAT_18003f948);
  }
  FUN_18001b224(param_2,local_res18,local_28,&local_30,&local_res20,&local_38);
  uVar2 = FUN_18001d934("CWBDIHandler::OnGetSensorStatus",param_2,0,0,local_38,0x14,
                        (undefined4 *)&local_res20);
  if ((int)uVar2 != 0) {
    *local_res20 = 0;
    local_res20[1] = 0;
    *(undefined4 *)(local_res20 + 2) = 0;
    *(undefined4 *)local_res20 = 0x14;
    if (*(int *)(*(longlong *)(param_1 + 0x40) + 0x5c) < 3) {
      *(undefined4 *)((longlong)local_res20 + 4) = 0;
      if (*(int *)(param_1 + 0xc) - 1U < 2) {
        *(undefined4 *)(param_1 + 0xc) = 3;
      }
      *(undefined4 *)(local_res20 + 1) = *(undefined4 *)(param_1 + 0xc);
      if (*(int *)(param_1 + 0xc) == 5) {
        iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x68))();
        if (iVar1 != 0) {
          *(undefined4 *)(param_1 + 0xc) = 3;
          *(undefined4 *)(local_res20 + 1) = 3;
        }
      }
    }
    else {
      *(undefined4 *)(local_res20 + 1) = 2;
      *(undefined4 *)(param_1 + 0xc) = 2;
      *(undefined4 *)((longlong)local_res20 + 4) = 0x8009800f;
    }
    uVar3 = local_38;
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      uVar3 = (ulonglong)*(uint *)((longlong)local_res20 + 4);
      FUN_18000e850(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x38,&DAT_18003f948,
                    *(undefined4 *)(local_res20 + 1));
    }
    (*DAT_18004c670)(DAT_18004c910,param_2,0,0x14,uVar3);
  }
  return;
}



void FUN_18001f0fc(undefined8 param_1,undefined8 param_2)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x42,&DAT_18003f948);
  }
                    // WARNING: Could not recover jumptable at 0x00018001f151. Too many branches
                    // WARNING: Treating indirect jump as call
  (*DAT_18004c668)(DAT_18004c910,param_2,0x80004001);
  return;
}



void FUN_18001f158(longlong param_1,undefined8 param_2)

{
  undefined4 uVar1;
  undefined4 local_res8 [4];
  undefined4 local_res18 [2];
  undefined4 local_res20 [2];
  undefined8 local_38;
  undefined4 local_30 [2];
  undefined8 local_28 [2];
  
  FUN_18001b224(param_2,local_res18,local_28,(undefined8 *)local_30,&local_38,
                (undefined8 *)local_res20);
  local_res8[0] = 0;
  uVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x118))
                    (*(longlong **)(param_1 + 0x78),local_res18[0],local_28[0],local_30[0],local_38,
                     local_res20[0],local_res8);
  (*DAT_18004c670)(DAT_18004c910,param_2,uVar1,local_res8[0]);
  return;
}



void FUN_18001f1e4(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_res10 [2];
  longlong local_res18;
  longlong local_res20;
  undefined8 local_28;
  undefined8 local_20;
  
  FUN_18001b224(param_2,local_res10,&local_20,&local_28,&local_res20,&local_res18);
  uVar2 = 0;
  if ((local_res20 == 0) || (local_res18 == 0)) {
    uVar2 = 0xc000000d;
  }
  else {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0xf0))();
    if (iVar1 == 0) {
      (*DAT_18004c6a0)(DAT_18004c910,param_2,local_res18);
    }
    else {
      uVar2 = 0xc0000001;
    }
  }
  (*DAT_18004c668)(DAT_18004c910,param_2,uVar2);
  return;
}



void FUN_18001f27c(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_res10 [2];
  ulonglong local_res18;
  longlong local_res20;
  longlong local_28;
  ulonglong local_20;
  
  FUN_18001b224(param_2,local_res10,&local_res20,&local_20,&local_28,&local_res18);
  uVar2 = 0;
  if ((((local_28 == 0) || (local_res18 == 0)) || (local_res20 == 0)) ||
     ((local_20 == 0 || (local_20 != local_res18)))) {
    uVar2 = 0xc000000d;
  }
  else {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0xd8))
                      (*(longlong **)(param_1 + 0x78),local_res20,local_20 & 0xffffffff);
    if (iVar1 == 0) {
      (*DAT_18004c6a0)(DAT_18004c910,param_2,local_res18);
    }
    else {
      uVar2 = 0xc0000001;
    }
  }
  (*DAT_18004c668)(DAT_18004c910,param_2,uVar2);
  return;
}



void FUN_18001f334(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined2 uVar3;
  undefined4 local_res18 [2];
  undefined8 *local_res20;
  ulonglong local_38;
  undefined8 local_30;
  undefined8 local_28 [2];
  
  FUN_18001b224(param_2,local_res18,local_28,&local_30,&local_res20,&local_38);
  uVar2 = FUN_18001d934("CWBDIHandler::OnReset",param_2,0,0,local_38,8,(undefined4 *)&local_res20);
  if ((int)uVar2 == 0) {
    return;
  }
  if (*(longlong *)(param_1 + 0x38) != 0) {
    FUN_18001bcc8(*(longlong *)(param_1 + 0x78),5);
    WaitForSingleObject(*(HANDLE *)(param_1 + 0x70),0xffffffff);
  }
  (**(code **)(**(longlong **)(param_1 + 0x78) + 0x40))();
  (**(code **)(**(longlong **)(param_1 + 0x78) + 0x58))();
  *local_res20 = 0;
  *(undefined4 *)local_res20 = 8;
  *(undefined4 *)((longlong)local_res20 + 4) = 0x80098036;
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x38))();
  if (iVar1 == 1) {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x68))();
    if ((iVar1 != 0) ||
       (iVar1 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0x70))(), -1 < iVar1)) {
      *(undefined4 *)((longlong)local_res20 + 4) = 0;
      *(undefined4 *)(param_1 + 0xc) = 3;
      goto LAB_18001f491;
    }
    if (((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
       (((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) == 0 || ((byte)PTR_LOOP_18004a7b8[0x19] < 2)
        ))) goto LAB_18001f491;
    uVar3 = 0x32;
  }
  else {
    if ((((undefined **)PTR_LOOP_18004a7b8 == &PTR_LOOP_18004a7b8) ||
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) == 0)) ||
       ((byte)PTR_LOOP_18004a7b8[0x19] < 2)) goto LAB_18001f491;
    uVar3 = 0x31;
  }
  FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),uVar3,&DAT_18003f948);
LAB_18001f491:
  (*DAT_18004c670)(DAT_18004c910,param_2,0,*(undefined4 *)local_res20);
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (2 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x33,&DAT_18003f948);
  }
  return;
}



void FUN_18001f4ec(longlong param_1,undefined8 param_2)

{
  undefined8 uVar1;
  undefined4 local_res18 [2];
  undefined8 *local_res20;
  ulonglong local_38;
  ulonglong local_30;
  longlong local_28 [2];
  
  local_res18[0] = 0;
  local_28[0] = 0;
  local_30 = 0;
  local_res20 = (undefined8 *)0x0;
  local_38 = 0;
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x45,&DAT_18003f948);
  }
  FUN_18001b224(param_2,local_res18,local_28,&local_30,&local_res20,&local_38);
  uVar1 = FUN_18001d934("CWBDIHandler::OnSetIndicator",param_2,local_30,8,local_38,8,
                        (undefined4 *)&local_res20);
  if ((int)uVar1 != 0) {
    *(undefined4 *)(param_1 + 0x2c) = *(undefined4 *)(local_28[0] + 4);
    *local_res20 = 0;
    *(undefined4 *)local_res20 = 8;
    *(undefined4 *)((longlong)local_res20 + 4) = 0;
    (*DAT_18004c670)(DAT_18004c910,param_2,0,8);
    if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
        ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_18004a7b8[0x19])) {
      FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x46,&DAT_18003f948);
    }
  }
  return;
}



void FUN_18001f634(undefined8 param_1,undefined8 param_2)

{
  if ((((undefined **)PTR_LOOP_18004a7b8 != &PTR_LOOP_18004a7b8) &&
      ((*(uint *)(PTR_LOOP_18004a7b8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_18004a7b8[0x19])
     ) {
    FUN_18000c80c(*(undefined8 *)(PTR_LOOP_18004a7b8 + 0x10),0x41,&DAT_18003f948);
  }
                    // WARNING: Could not recover jumptable at 0x00018001f689. Too many branches
                    // WARNING: Treating indirect jump as call
  (*DAT_18004c668)(DAT_18004c910,param_2,0x80004001);
  return;
}



void FUN_18001f690(longlong param_1,undefined8 param_2)

{
  longlong lVar1;
  undefined4 uVar2;
  int iVar3;
  undefined1 auStackY_288 [32];
  undefined8 local_258;
  undefined4 local_250 [2];
  ulonglong local_248;
  longlong local_240;
  undefined8 local_238 [2];
  undefined1 local_228 [256];
  undefined1 local_128 [256];
  ulonglong local_28;
  
  local_28 = DAT_18004a880 ^ (ulonglong)auStackY_288;
  FUN_18001b224(param_2,local_250,&local_240,&local_248,local_238,&local_258);
  uVar2 = 0;
  if (((local_240 == 0) || (local_248 == 0)) || ((local_248 & 1) != 0)) {
    uVar2 = 0xc000000d;
  }
  else {
    iVar3 = 0;
    if (local_248 >> 1 != 0) {
      lVar1 = 0;
      do {
        iVar3 = iVar3 + 1;
        local_128[lVar1] = *(undefined1 *)(local_240 + lVar1 * 2);
        local_228[lVar1] = *(undefined1 *)(local_240 + -1 + (lVar1 + 1) * 2);
        lVar1 = lVar1 + 1;
      } while ((ulonglong)(longlong)iVar3 < local_248 >> 1);
    }
    iVar3 = (**(code **)(**(longlong **)(param_1 + 0x78) + 0xe0))
                      (*(longlong **)(param_1 + 0x78),local_128,local_248 >> 1 & 0x7fffffff,
                       local_228);
    if (iVar3 == 0) {
      (*DAT_18004c6a0)(DAT_18004c910,param_2,local_258);
    }
    else {
      uVar2 = 0xc0000001;
    }
  }
  (*DAT_18004c668)(DAT_18004c910,param_2,uVar2);
  FUN_18001fe50(local_28 ^ (ulonglong)auStackY_288);
  return;
}



bool FUN_18001f7a8(longlong param_1,longlong param_2,int param_3)

{
  bool bVar1;
  
  if (param_3 == 0) {
    LOCK();
    *(longlong *)(param_1 + 0x38) = param_2;
    UNLOCK();
    if (param_2 == 0) {
      bVar1 = false;
    }
    else {
      ResetEvent(*(HANDLE *)(param_1 + 0x20));
      *(undefined4 *)(param_1 + 0x18) = 0;
      bVar1 = true;
      FUN_18000e724(*(longlong *)(param_1 + 0x40),1);
      (*DAT_18004c620)(DAT_18004c910,param_2,FUN_18001dd30);
    }
  }
  else {
    LOCK();
    bVar1 = *(longlong *)(param_1 + 0x38) == 0;
    if (bVar1) {
      *(longlong *)(param_1 + 0x38) = param_2;
    }
    UNLOCK();
  }
  return bVar1;
}



void FUN_18001f828(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&stack0x00000028,4,0);
  return;
}



void FUN_18001f86c(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&stack0x00000028,8,0);
  return;
}



void FUN_18001f8b0(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&stack0x00000028,8,&stack0x00000030,8,0);
  return;
}



void FUN_18001f904(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,0);
  return;
}



void FUN_18001f938(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&stack0x00000028,8,0);
  return;
}



void FUN_18001f97c(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined *param_4)

{
  undefined *puVar1;
  longlong lVar2;
  longlong lVar3;
  
  if (param_4 == (undefined *)0x0) {
    lVar3 = 5;
  }
  else {
    lVar2 = -1;
    do {
      lVar3 = lVar2;
      lVar2 = lVar3 + 1;
    } while (param_4[lVar2] != '\0');
    lVar3 = lVar3 + 2;
  }
  puVar1 = &DAT_18003e700;
  if (param_4 != (undefined *)0x0) {
    puVar1 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,puVar1,lVar3,&stack0x00000028,4,&stack0x00000030,4,0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ulonglong FxDriverEntryUm(uint *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  
                    // 0x1f9f8  1  FxDriverEntryUm
  if ((param_1 == (uint *)0x0) || (*param_1 < 0x38)) {
    uVar3 = 0xc000000d;
  }
  else {
    DAT_18004c918 = param_1[0xc] & 1;
    if (DAT_18004c918 != 0) {
      DbgPrintEx(0x65,3,"Wudfx2000: ");
      DbgPrintEx(0x65,3,"FxDriverEntrydUm Enter PDRIVER_OBJECT_UM 0x%p\n",param_3);
    }
    _DAT_18004c148 = *(undefined8 *)(param_1 + 10);
    uVar1 = (**(code **)(param_1 + 2))(param_2,&DAT_18004a848,&DAT_18004c910);
    uVar3 = (ulonglong)uVar1;
    if ((int)uVar1 < 0) {
      if (DAT_18004c918 != 0) {
        DbgPrintEx(0x65,3,"Wudfx2000: ");
        DbgPrintEx(0x65,3,"FxDriverEntryUm: VersionBind status %08X\n",uVar3);
      }
    }
    else {
      if (DAT_18004c918 != 0) {
        DbgPrintEx(0x65,3,"Wudfx2000: ");
        DbgPrintEx(0x65,3,
                   "FxDriverEntryUm: PDRIVER_OBJECT_UM 0x%p Successfully bound to version library\n"
                   ,param_3);
      }
      uVar2 = FUN_18001fbfc((longlong)param_1,param_2,&DAT_18004a848);
      uVar3 = uVar2 & 0xffffffff;
      if (-1 < (int)uVar2) {
        if (DAT_18004c918 != 0) {
          DbgPrintEx(0x65,3,"Wudfx2000: ");
          DbgPrintEx(0x65,3,
                     "FxDriverEntryUm: PDRIVER_OBJECT_UM 0x%p Successfully bound to class library if present\n"
                     ,param_3);
        }
        uVar1 = FUN_18000c5f8(param_3,param_4);
        uVar3 = (ulonglong)uVar1;
        if ((int)uVar1 < 0) {
          if (DAT_18004c918 != 0) {
            DbgPrintEx(0x65,3,"Wudfx2000: ");
            DbgPrintEx(0x65,3,"FxDriverEntryUm: DriverEntry status %08X\n",uVar1);
          }
        }
        else if (DAT_18004c918 != 0) {
          DbgPrintEx(0x65,3,"Wudfx2000: ");
          DbgPrintEx(0x65,3,
                     "FxDriverEntryUm: PDRIVER_OBJECT_UM 0x%p Successfully returned from driver\'s DriverEntry\n"
                     ,param_3);
        }
      }
    }
  }
  return uVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ulonglong FUN_18001fa00(uint *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  
  if ((param_1 == (uint *)0x0) || (*param_1 < 0x38)) {
    uVar3 = 0xc000000d;
  }
  else {
    DAT_18004c918 = param_1[0xc] & 1;
    if (DAT_18004c918 != 0) {
      DbgPrintEx(0x65,3,"Wudfx2000: ");
      DbgPrintEx(0x65,3,"FxDriverEntrydUm Enter PDRIVER_OBJECT_UM 0x%p\n",param_3);
    }
    _DAT_18004c148 = *(undefined8 *)(param_1 + 10);
    uVar1 = (**(code **)(param_1 + 2))(param_2,&DAT_18004a848,&DAT_18004c910);
    uVar3 = (ulonglong)uVar1;
    if ((int)uVar1 < 0) {
      if (DAT_18004c918 != 0) {
        DbgPrintEx(0x65,3,"Wudfx2000: ");
        DbgPrintEx(0x65,3,"FxDriverEntryUm: VersionBind status %08X\n",uVar3);
      }
    }
    else {
      if (DAT_18004c918 != 0) {
        DbgPrintEx(0x65,3,"Wudfx2000: ");
        DbgPrintEx(0x65,3,
                   "FxDriverEntryUm: PDRIVER_OBJECT_UM 0x%p Successfully bound to version library\n"
                   ,param_3);
      }
      uVar2 = FUN_18001fbfc((longlong)param_1,param_2,&DAT_18004a848);
      uVar3 = uVar2 & 0xffffffff;
      if (-1 < (int)uVar2) {
        if (DAT_18004c918 != 0) {
          DbgPrintEx(0x65,3,"Wudfx2000: ");
          DbgPrintEx(0x65,3,
                     "FxDriverEntryUm: PDRIVER_OBJECT_UM 0x%p Successfully bound to class library if present\n"
                     ,param_3);
        }
        uVar1 = FUN_18000c5f8(param_3,param_4);
        uVar3 = (ulonglong)uVar1;
        if ((int)uVar1 < 0) {
          if (DAT_18004c918 != 0) {
            DbgPrintEx(0x65,3,"Wudfx2000: ");
            DbgPrintEx(0x65,3,"FxDriverEntryUm: DriverEntry status %08X\n",uVar1);
          }
        }
        else if (DAT_18004c918 != 0) {
          DbgPrintEx(0x65,3,"Wudfx2000: ");
          DbgPrintEx(0x65,3,
                     "FxDriverEntryUm: PDRIVER_OBJECT_UM 0x%p Successfully returned from driver\'s DriverEntry\n"
                     ,param_3);
        }
      }
    }
  }
  return uVar3;
}



// WARNING: Removing unreachable block (ram,0x00018001fc33)

undefined8 FUN_18001fbfc(longlong param_1,undefined8 param_2,undefined8 param_3)

{
  undefined8 uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = &DAT_18004c0e0;
  while( true ) {
    if ((int *)0x18004c0df < piVar2) {
      return uVar1;
    }
    if (*piVar2 != 0x50) break;
    PTR_DAT_18004c0e8 = (undefined *)piVar2;
    if (*(code **)(piVar2 + 0xe) == (code *)0x0) {
      uVar1 = (**(code **)(param_1 + 0x18))(param_2,param_3,DAT_18004c910,piVar2);
    }
    else {
      uVar1 = (**(code **)(piVar2 + 0xe))
                        (*(undefined8 *)(param_1 + 0x18),param_2,param_3,DAT_18004c910,piVar2);
    }
    if ((int)uVar1 < 0) {
      return uVar1;
    }
    piVar2 = piVar2 + 0x14;
  }
  return 0xc0000004;
}



void TraceMessage(void)

{
                    // WARNING: Could not recover jumptable at 0x00018001fcb2. Too many branches
                    // WARNING: Treating indirect jump as call
  TraceMessage();
  return;
}



void FUN_18001fcb8(LPVOID param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  if ((param_1 != (LPVOID)0x0) && (BVar1 = HeapFree(DAT_18004ceb0,0,param_1), BVar1 == 0)) {
    pDVar3 = FUN_180021688();
    DVar2 = GetLastError();
    DVar2 = FUN_1800216a8(DVar2);
    *pDVar3 = DVar2;
  }
  return;
}



LPVOID FUN_18001fcf8(ulonglong param_1)

{
  LPVOID pvVar1;
  undefined8 uVar2;
  DWORD *pDVar3;
  SIZE_T dwBytes;
  
  if (param_1 < 0xffffffffffffffe1) {
    dwBytes = 1;
    if (param_1 != 0) {
      dwBytes = param_1;
    }
    do {
      if (DAT_18004ceb0 == (HANDLE)0x0) {
        FUN_180021c78();
        FUN_180021cec(0x1e);
        FUN_1800217a4(0xff);
      }
      pvVar1 = HeapAlloc(DAT_18004ceb0,0,dwBytes);
      if (pvVar1 != (LPVOID)0x0) {
        return pvVar1;
      }
      if (DAT_18004d558 == 0) {
        pDVar3 = FUN_180021688();
        *pDVar3 = 0xc;
        break;
      }
      uVar2 = FUN_180021724(param_1);
    } while ((int)uVar2 != 0);
    pDVar3 = FUN_180021688();
    *pDVar3 = 0xc;
  }
  else {
    FUN_180021724(param_1);
    pDVar3 = FUN_180021688();
    *pDVar3 = 0xc;
  }
  return (LPVOID)0x0;
}



undefined8 FUN_18001fdb0(undefined8 param_1,ulonglong param_2,undefined8 param_3,longlong param_4)

{
  FUN_18001fdd0(param_2,param_4,*(uint **)(param_4 + 0x38));
  return 1;
}



void FUN_18001fdd0(ulonglong param_1,longlong param_2,uint *param_3)

{
  longlong lVar1;
  ulonglong uVar2;
  
  uVar2 = param_1;
  if ((*param_3 & 4) != 0) {
    uVar2 = (longlong)(int)param_3[1] + param_1 & (longlong)(int)-param_3[2];
  }
  lVar1 = (ulonglong)*(uint *)(*(longlong *)(param_2 + 0x10) + 8) + *(longlong *)(param_2 + 8);
  if ((*(byte *)(lVar1 + 3) & 0xf) != 0) {
    param_1 = param_1 + (longlong)(int)(*(byte *)(lVar1 + 3) & 0xfffffff0);
  }
  FUN_18001fe50(param_1 ^ *(ulonglong *)((longlong)(int)(*param_3 & 0xfffffff8) + uVar2));
  return;
}



void FUN_18001fe50(longlong param_1)

{
  if ((param_1 == DAT_18004a880) && ((short)((ulonglong)param_1 >> 0x30) == 0)) {
    return;
  }
  FUN_180020b44();
  return;
}



undefined8 * FUN_18001fe80(undefined8 *param_1,undefined8 *param_2,ulonglong param_3)

{
  undefined4 *puVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined8 *puVar7;
  undefined8 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  longlong lVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  
  if (0x10 < param_3) {
    lVar11 = (longlong)param_2 - (longlong)param_1;
    if ((param_2 < param_1) && ((longlong)param_1 < (longlong)((longlong)param_2 + param_3))) {
      if ((DAT_18004d55c >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          uVar12 = (longlong)param_1 + param_3;
          if ((uVar12 & 0xf) == 0) {
            puVar9 = (undefined4 *)(uVar12 - 0x10);
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar9);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            uVar12 = param_3 - 0x10;
          }
          else {
            puVar7 = (undefined8 *)(uVar12 - 0x10);
            uVar4 = ((undefined8 *)(lVar11 + (longlong)puVar7))[1];
            puVar9 = (undefined4 *)((ulonglong)puVar7 & 0xfffffffffffffff0);
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar9);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            *puVar7 = *(undefined8 *)(lVar11 + (longlong)puVar7);
            *(undefined8 *)(uVar12 - 8) = uVar4;
            uVar12 = (longlong)puVar9 - (longlong)param_1;
          }
          uVar13 = uVar12 >> 7;
          if (uVar13 != 0) {
            *puVar9 = uVar14;
            puVar9[1] = uVar15;
            puVar9[2] = uVar16;
            puVar9[3] = uVar17;
            puVar10 = puVar9;
            while( true ) {
              puVar7 = (undefined8 *)(lVar11 + -0x10 + (longlong)puVar10);
              uVar4 = puVar7[1];
              puVar8 = (undefined8 *)(lVar11 + -0x20 + (longlong)puVar10);
              uVar5 = *puVar8;
              uVar6 = puVar8[1];
              puVar9 = puVar10 + -0x20;
              *(undefined8 *)(puVar10 + -4) = *puVar7;
              *(undefined8 *)(puVar10 + -2) = uVar4;
              *(undefined8 *)(puVar10 + -8) = uVar5;
              *(undefined8 *)(puVar10 + -6) = uVar6;
              puVar7 = (undefined8 *)(lVar11 + 0x50 + (longlong)puVar9);
              uVar4 = puVar7[1];
              puVar8 = (undefined8 *)(lVar11 + 0x40 + (longlong)puVar9);
              uVar5 = *puVar8;
              uVar6 = puVar8[1];
              uVar13 = uVar13 - 1;
              *(undefined8 *)(puVar10 + -0xc) = *puVar7;
              *(undefined8 *)(puVar10 + -10) = uVar4;
              *(undefined8 *)(puVar10 + -0x10) = uVar5;
              *(undefined8 *)(puVar10 + -0xe) = uVar6;
              puVar7 = (undefined8 *)(lVar11 + 0x30 + (longlong)puVar9);
              uVar4 = puVar7[1];
              puVar8 = (undefined8 *)(lVar11 + 0x20 + (longlong)puVar9);
              uVar5 = *puVar8;
              uVar6 = puVar8[1];
              *(undefined8 *)(puVar10 + -0x14) = *puVar7;
              *(undefined8 *)(puVar10 + -0x12) = uVar4;
              *(undefined8 *)(puVar10 + -0x18) = uVar5;
              *(undefined8 *)(puVar10 + -0x16) = uVar6;
              puVar7 = (undefined8 *)(lVar11 + 0x10 + (longlong)puVar9);
              uVar4 = *puVar7;
              uVar5 = puVar7[1];
              puVar1 = (undefined4 *)(lVar11 + (longlong)puVar9);
              uVar14 = *puVar1;
              uVar15 = puVar1[1];
              uVar16 = puVar1[2];
              uVar17 = puVar1[3];
              if (uVar13 == 0) break;
              *(undefined8 *)(puVar10 + -0x1c) = uVar4;
              *(undefined8 *)(puVar10 + -0x1a) = uVar5;
              *puVar9 = uVar14;
              puVar10[-0x1f] = uVar15;
              puVar10[-0x1e] = uVar16;
              puVar10[-0x1d] = uVar17;
              puVar10 = puVar9;
            }
            *(undefined8 *)(puVar10 + -0x1c) = uVar4;
            *(undefined8 *)(puVar10 + -0x1a) = uVar5;
            uVar12 = uVar12 & 0x7f;
          }
          for (uVar13 = uVar12 >> 4; uVar13 != 0; uVar13 = uVar13 - 1) {
            *puVar9 = uVar14;
            puVar9[1] = uVar15;
            puVar9[2] = uVar16;
            puVar9[3] = uVar17;
            puVar9 = puVar9 + -4;
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar9);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
          }
          if ((uVar12 & 0xf) != 0) {
            uVar4 = param_2[1];
            *param_1 = *param_2;
            param_1[1] = uVar4;
          }
          *puVar9 = uVar14;
          puVar9[1] = uVar15;
          puVar9[2] = uVar16;
          puVar9[3] = uVar17;
          return param_1;
        }
LAB_180020210:
        uVar4 = param_2[1];
        puVar7 = (undefined8 *)((param_3 - 0x10) + (longlong)param_1);
        uVar5 = *(undefined8 *)(lVar11 + (longlong)puVar7);
        uVar6 = ((undefined8 *)(lVar11 + (longlong)puVar7))[1];
        *param_1 = *param_2;
        param_1[1] = uVar4;
        *puVar7 = uVar5;
        puVar7[1] = uVar6;
        return param_1;
      }
      puVar7 = (undefined8 *)((longlong)param_1 + param_3);
      if (((ulonglong)puVar7 & 7) != 0) {
        if (((ulonglong)puVar7 & 1) != 0) {
          puVar7 = (undefined8 *)((longlong)puVar7 + -1);
          param_3 = param_3 - 1;
          *(undefined1 *)puVar7 = *(undefined1 *)(lVar11 + (longlong)puVar7);
        }
        if (((ulonglong)puVar7 & 2) != 0) {
          puVar7 = (undefined8 *)((longlong)puVar7 + -2);
          param_3 = param_3 - 2;
          *(undefined2 *)puVar7 = *(undefined2 *)(lVar11 + (longlong)puVar7);
        }
        if (((ulonglong)puVar7 & 4) != 0) {
          puVar7 = (undefined8 *)((longlong)puVar7 + -4);
          param_3 = param_3 - 4;
          *(undefined4 *)puVar7 = *(undefined4 *)(lVar11 + (longlong)puVar7);
        }
      }
      uVar12 = param_3 >> 5;
      puVar8 = puVar7;
      if (uVar12 != 0) {
        do {
          uVar4 = *(undefined8 *)(lVar11 + -0x10 + (longlong)puVar8);
          puVar7 = puVar8 + -4;
          puVar8[-1] = *(undefined8 *)(lVar11 + -8 + (longlong)puVar8);
          puVar8[-2] = uVar4;
          uVar4 = *(undefined8 *)(lVar11 + (longlong)puVar7);
          uVar12 = uVar12 - 1;
          puVar8[-3] = *(undefined8 *)(lVar11 + 8 + (longlong)puVar7);
          *puVar7 = uVar4;
          puVar8 = puVar7;
        } while (uVar12 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar12 = param_3 >> 3;
      if (uVar12 != 0) {
        do {
          puVar7 = puVar7 + -1;
          uVar12 = uVar12 - 1;
          *puVar7 = *(undefined8 *)(lVar11 + (longlong)puVar7);
        } while (uVar12 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_1 = (undefined8 *)((longlong)puVar7 - param_3);
      param_2 = (undefined8 *)(lVar11 + (longlong)param_1);
    }
    else {
      puVar7 = param_1;
      if ((DAT_18004d55c >> 1 & 1) != 0) {
        for (; param_3 != 0; param_3 = param_3 - 1) {
          *(undefined1 *)puVar7 = *(undefined1 *)param_2;
          param_2 = (undefined8 *)((longlong)param_2 + 1);
          puVar7 = (undefined8 *)((longlong)puVar7 + 1);
        }
        return param_1;
      }
      if ((DAT_18004d55c >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          if (((ulonglong)param_1 & 0xf) == 0) {
            puVar10 = (undefined4 *)(lVar11 + (longlong)param_1);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            puVar7 = param_1 + 2;
            uVar12 = param_3 - 0x10;
          }
          else {
            uVar4 = ((undefined8 *)(lVar11 + (longlong)param_1))[1];
            puVar7 = (undefined8 *)((ulonglong)(param_1 + 4) & 0xfffffffffffffff0);
            puVar10 = (undefined4 *)(lVar11 + -0x10 + (longlong)puVar7);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            *param_1 = *(undefined8 *)(lVar11 + (longlong)param_1);
            param_1[1] = uVar4;
            uVar12 = param_3 - ((longlong)puVar7 - (longlong)param_1);
          }
          uVar13 = uVar12 >> 7;
          if (uVar13 != 0) {
            *(undefined4 *)(puVar7 + -2) = uVar14;
            *(undefined4 *)((longlong)puVar7 + -0xc) = uVar15;
            *(undefined4 *)(puVar7 + -1) = uVar16;
            *(undefined4 *)((longlong)puVar7 + -4) = uVar17;
            puVar8 = puVar7;
            while( true ) {
              uVar4 = ((undefined8 *)(lVar11 + (longlong)puVar8))[1];
              puVar7 = (undefined8 *)(lVar11 + 0x10 + (longlong)puVar8);
              uVar5 = *puVar7;
              uVar6 = puVar7[1];
              puVar7 = puVar8 + 0x10;
              *puVar8 = *(undefined8 *)(lVar11 + (longlong)puVar8);
              puVar8[1] = uVar4;
              puVar8[2] = uVar5;
              puVar8[3] = uVar6;
              puVar2 = (undefined8 *)(lVar11 + -0x60 + (longlong)puVar7);
              uVar4 = puVar2[1];
              puVar3 = (undefined8 *)(lVar11 + -0x50 + (longlong)puVar7);
              uVar5 = *puVar3;
              uVar6 = puVar3[1];
              uVar13 = uVar13 - 1;
              puVar8[4] = *puVar2;
              puVar8[5] = uVar4;
              puVar8[6] = uVar5;
              puVar8[7] = uVar6;
              puVar2 = (undefined8 *)(lVar11 + -0x40 + (longlong)puVar7);
              uVar4 = puVar2[1];
              puVar3 = (undefined8 *)(lVar11 + -0x30 + (longlong)puVar7);
              uVar5 = *puVar3;
              uVar6 = puVar3[1];
              puVar8[8] = *puVar2;
              puVar8[9] = uVar4;
              puVar8[10] = uVar5;
              puVar8[0xb] = uVar6;
              puVar2 = (undefined8 *)(lVar11 + -0x20 + (longlong)puVar7);
              uVar4 = *puVar2;
              uVar5 = puVar2[1];
              puVar10 = (undefined4 *)(lVar11 + -0x10 + (longlong)puVar7);
              uVar14 = *puVar10;
              uVar15 = puVar10[1];
              uVar16 = puVar10[2];
              uVar17 = puVar10[3];
              if (uVar13 == 0) break;
              puVar8[0xc] = uVar4;
              puVar8[0xd] = uVar5;
              *(undefined4 *)(puVar8 + 0xe) = uVar14;
              *(undefined4 *)((longlong)puVar8 + 0x74) = uVar15;
              *(undefined4 *)(puVar8 + 0xf) = uVar16;
              *(undefined4 *)((longlong)puVar8 + 0x7c) = uVar17;
              puVar8 = puVar7;
            }
            puVar8[0xc] = uVar4;
            puVar8[0xd] = uVar5;
            uVar12 = uVar12 & 0x7f;
          }
          for (uVar13 = uVar12 >> 4; uVar13 != 0; uVar13 = uVar13 - 1) {
            *(undefined4 *)(puVar7 + -2) = uVar14;
            *(undefined4 *)((longlong)puVar7 + -0xc) = uVar15;
            *(undefined4 *)(puVar7 + -1) = uVar16;
            *(undefined4 *)((longlong)puVar7 + -4) = uVar17;
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar7);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            puVar7 = puVar7 + 2;
          }
          uVar12 = uVar12 & 0xf;
          if (uVar12 != 0) {
            puVar8 = (undefined8 *)((longlong)puVar7 + lVar11 + -0x10 + uVar12);
            uVar4 = puVar8[1];
            *(undefined8 *)((longlong)puVar7 + (uVar12 - 0x10)) = *puVar8;
            *(undefined8 *)((longlong)puVar7 + (uVar12 - 8)) = uVar4;
          }
          *(undefined4 *)(puVar7 + -2) = uVar14;
          *(undefined4 *)((longlong)puVar7 + -0xc) = uVar15;
          *(undefined4 *)(puVar7 + -1) = uVar16;
          *(undefined4 *)((longlong)puVar7 + -4) = uVar17;
          return param_1;
        }
        goto LAB_180020210;
      }
      if (((ulonglong)param_1 & 7) != 0) {
        if (((ulonglong)param_1 & 1) != 0) {
          param_3 = param_3 - 1;
          *(undefined1 *)param_1 = *(undefined1 *)(lVar11 + (longlong)param_1);
          puVar7 = (undefined8 *)((longlong)param_1 + 1);
        }
        if (((ulonglong)puVar7 & 2) != 0) {
          param_3 = param_3 - 2;
          *(undefined2 *)puVar7 = *(undefined2 *)(lVar11 + (longlong)puVar7);
          puVar7 = (undefined8 *)((longlong)puVar7 + 2);
        }
        if (((ulonglong)puVar7 & 4) != 0) {
          param_3 = param_3 - 4;
          *(undefined4 *)puVar7 = *(undefined4 *)(lVar11 + (longlong)puVar7);
          puVar7 = (undefined8 *)((longlong)puVar7 + 4);
        }
      }
      uVar12 = param_3 >> 5;
      puVar8 = puVar7;
      if (uVar12 != 0) {
        do {
          uVar4 = *(undefined8 *)(lVar11 + 8 + (longlong)puVar8);
          puVar7 = puVar8 + 4;
          *puVar8 = *(undefined8 *)(lVar11 + (longlong)puVar8);
          puVar8[1] = uVar4;
          uVar4 = *(undefined8 *)(lVar11 + -8 + (longlong)puVar7);
          uVar12 = uVar12 - 1;
          puVar8[2] = *(undefined8 *)(lVar11 + -0x10 + (longlong)puVar7);
          puVar8[3] = uVar4;
          puVar8 = puVar7;
        } while (uVar12 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar12 = param_3 >> 3;
      if (uVar12 != 0) {
        do {
          *puVar7 = *(undefined8 *)(lVar11 + (longlong)puVar7);
          puVar7 = puVar7 + 1;
          uVar12 = uVar12 - 1;
        } while (uVar12 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_2 = (undefined8 *)(lVar11 + (longlong)puVar7);
      param_1 = puVar7;
    }
  }
                    // WARNING: Could not recover jumptable at 0x00018001ff5e. Too many branches
                    // WARNING: Treating indirect jump as call
  puVar7 = (undefined8 *)
           (*(code *)((ulonglong)*(uint *)(&LAB_18001ff60 + param_3 * 4) + 0x180000000))
                     (param_1,param_2);
  return puVar7;
}



undefined1 (*) [16] FUN_180020400(undefined1 (*param_1) [16],byte param_2,ulonglong param_3)

{
  uint uVar1;
  undefined1 (*pauVar2) [16];
  undefined1 (*pauVar3) [16];
  undefined1 uVar4;
  ulonglong uVar7;
  longlong lVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  undefined1 auVar11 [16];
  undefined2 uVar5;
  undefined4 uVar6;
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 uVar19;
  
  if (0xf < param_3) {
    pauVar2 = param_1;
    if ((DAT_18004d55c >> 1 & 1) == 0) {
      uVar7 = (ulonglong)param_2 * 0x101010101010101;
      uVar4 = (undefined1)uVar7;
      if ((DAT_18004d55c >> 2 & 1) != 0) {
        uVar19 = (undefined1)(uVar7 >> 0x38);
        auVar18._8_6_ = 0;
        auVar18._0_8_ = uVar7;
        auVar18[0xe] = uVar19;
        auVar18[0xf] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x30);
        auVar17._14_2_ = auVar18._14_2_;
        auVar17._8_5_ = 0;
        auVar17._0_8_ = uVar7;
        auVar17[0xd] = uVar19;
        auVar16._13_3_ = auVar17._13_3_;
        auVar16._8_4_ = 0;
        auVar16._0_8_ = uVar7;
        auVar16[0xc] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x28);
        auVar15._12_4_ = auVar16._12_4_;
        auVar15._8_3_ = 0;
        auVar15._0_8_ = uVar7;
        auVar15[0xb] = uVar19;
        auVar14._11_5_ = auVar15._11_5_;
        auVar14._8_2_ = 0;
        auVar14._0_8_ = uVar7;
        auVar14[10] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x20);
        auVar13._10_6_ = auVar14._10_6_;
        auVar13[8] = 0;
        auVar13._0_8_ = uVar7;
        auVar13[9] = uVar19;
        auVar12._9_7_ = auVar13._9_7_;
        auVar12[8] = uVar19;
        auVar12._0_8_ = uVar7;
        uVar19 = (undefined1)(uVar7 >> 0x18);
        auVar11._8_8_ = auVar12._8_8_;
        auVar11[7] = uVar19;
        auVar11[6] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x10);
        auVar11[5] = uVar19;
        auVar11[4] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 8);
        auVar11[3] = uVar19;
        auVar11[2] = uVar19;
        auVar11[1] = uVar4;
        auVar11[0] = uVar4;
        if (((ulonglong)param_1 & 0xf) != 0) {
          *param_1 = auVar11;
          pauVar2 = (undefined1 (*) [16])((longlong)param_1 + (0x10 - ((ulonglong)param_1 & 0xf)));
          param_3 = (((ulonglong)param_1 & 0xf) - 0x10) + param_3;
        }
        uVar7 = param_3 >> 7;
        pauVar3 = pauVar2;
        if (uVar7 != 0) {
          do {
            *pauVar2 = auVar11;
            pauVar2[1] = auVar11;
            pauVar3 = pauVar2 + 8;
            pauVar2[2] = auVar11;
            pauVar2[3] = auVar11;
            uVar7 = uVar7 - 1;
            pauVar2[4] = auVar11;
            pauVar2[5] = auVar11;
            pauVar2[6] = auVar11;
            pauVar2[7] = auVar11;
            pauVar2 = pauVar3;
          } while (uVar7 != 0);
          param_3 = param_3 & 0x7f;
        }
        for (uVar7 = param_3 >> 4; uVar7 != 0; uVar7 = uVar7 - 1) {
          *pauVar3 = auVar11;
          pauVar3 = pauVar3 + 1;
        }
        if ((param_3 & 0xf) != 0) {
          *(undefined1 (*) [16])(pauVar3[-1] + (param_3 & 0xf)) = auVar11;
        }
        return param_1;
      }
      if (0x3f < param_3) {
        uVar1 = -(int)param_1 & 7;
        uVar9 = param_3;
        if (uVar1 != 0) {
          uVar9 = param_3 - uVar1;
          *(ulonglong *)*param_1 = uVar7;
        }
        param_3 = uVar9 & 0x3f;
        pauVar2 = (undefined1 (*) [16])(*param_1 + uVar1);
        for (uVar9 = uVar9 >> 6; uVar9 != 0; uVar9 = uVar9 - 1) {
          *(ulonglong *)*pauVar2 = uVar7;
          *(ulonglong *)(*pauVar2 + 8) = uVar7;
          *(ulonglong *)pauVar2[1] = uVar7;
          *(ulonglong *)(pauVar2[1] + 8) = uVar7;
          *(ulonglong *)pauVar2[2] = uVar7;
          *(ulonglong *)(pauVar2[2] + 8) = uVar7;
          *(ulonglong *)pauVar2[3] = uVar7;
          *(ulonglong *)(pauVar2[3] + 8) = uVar7;
          pauVar2 = pauVar2 + 4;
        }
      }
      uVar10 = param_3 & 7;
      for (uVar9 = param_3 >> 3; uVar9 != 0; uVar9 = uVar9 - 1) {
        *(ulonglong *)*pauVar2 = uVar7;
        pauVar2 = (undefined1 (*) [16])(*pauVar2 + 8);
      }
      for (; uVar10 != 0; uVar10 = uVar10 - 1) {
        (*pauVar2)[0] = uVar4;
        pauVar2 = (undefined1 (*) [16])(*pauVar2 + 1);
      }
    }
    else {
      for (; param_3 != 0; param_3 = param_3 - 1) {
        (*pauVar2)[0] = param_2;
        pauVar2 = (undefined1 (*) [16])(*pauVar2 + 1);
      }
    }
    return param_1;
  }
  lVar8 = (ulonglong)param_2 * 0x101010101010101;
  uVar4 = (undefined1)lVar8;
  uVar5 = (undefined2)lVar8;
  uVar6 = (undefined4)lVar8;
  switch(param_3) {
  case 0:
    return param_1;
  case 1:
    goto switchD_180020592_caseD_1;
  case 8:
    *(longlong *)(param_1[-1] + param_3 + 8) = lVar8;
    return param_1;
  case 9:
    *(longlong *)(param_1[-1] + param_3 + 7) = lVar8;
    param_1[-1][param_3 + 0xf] = uVar4;
    return param_1;
  case 10:
    *(longlong *)(param_1[-1] + param_3 + 6) = lVar8;
    *(undefined2 *)(param_1[-1] + param_3 + 0xe) = uVar5;
    return param_1;
  case 0xb:
    *(longlong *)(param_1[-1] + param_3 + 5) = lVar8;
    break;
  case 0xc:
    *(longlong *)(param_1[-1] + param_3 + 4) = lVar8;
  case 4:
    *(undefined4 *)(param_1[-1] + param_3 + 0xc) = uVar6;
    return param_1;
  case 0xd:
    *(longlong *)(param_1[-1] + param_3 + 3) = lVar8;
  case 5:
    *(undefined4 *)(param_1[-1] + param_3 + 0xb) = uVar6;
    param_1[-1][param_3 + 0xf] = uVar4;
    return param_1;
  case 0xe:
    *(longlong *)(param_1[-1] + param_3 + 2) = lVar8;
  case 6:
    *(undefined4 *)(param_1[-1] + param_3 + 10) = uVar6;
  case 2:
    *(undefined2 *)(param_1[-1] + param_3 + 0xe) = uVar5;
    return param_1;
  case 0xf:
    *(longlong *)(param_1[-1] + param_3 + 1) = lVar8;
  case 7:
    *(undefined4 *)(param_1[-1] + param_3 + 9) = uVar6;
  }
  *(undefined2 *)(param_1[-1] + param_3 + 0xd) = uVar5;
switchD_180020592_caseD_1:
  param_1[-1][param_3 + 0xf] = uVar4;
  return param_1;
}



LPVOID FUN_18002062c(ulonglong param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  DWORD *pDVar2;
  DWORD local_res18 [4];
  
  local_res18[0] = 0;
  pvVar1 = FUN_180022100(param_1,param_2,local_res18);
  if ((pvVar1 == (LPVOID)0x0) && (local_res18[0] != 0)) {
    pDVar2 = FUN_180021688();
    if (pDVar2 != (DWORD *)0x0) {
      pDVar2 = FUN_180021688();
      *pDVar2 = local_res18[0];
    }
  }
  return pvVar1;
}



LPVOID FUN_180020670(LPVOID param_1,ulonglong param_2)

{
  DWORD DVar1;
  LPVOID pvVar2;
  undefined8 uVar3;
  DWORD *pDVar4;
  
  if (param_1 == (LPVOID)0x0) {
    pvVar2 = FUN_18001fcf8(param_2);
  }
  else {
    if (param_2 == 0) {
      FUN_18001fcb8(param_1);
    }
    else {
      if (param_2 < 0xffffffffffffffe1) {
        do {
          if (param_2 == 0) {
            param_2 = 1;
          }
          pvVar2 = HeapReAlloc(DAT_18004ceb0,0,param_1,param_2);
          if (pvVar2 != (LPVOID)0x0) {
            return pvVar2;
          }
          if (DAT_18004d558 == 0) {
            pDVar4 = FUN_180021688();
            DVar1 = GetLastError();
            DVar1 = FUN_1800216a8(DVar1);
            *pDVar4 = DVar1;
            return (LPVOID)0x0;
          }
          uVar3 = FUN_180021724(param_2);
          if ((int)uVar3 == 0) {
            pDVar4 = FUN_180021688();
            DVar1 = GetLastError();
            DVar1 = FUN_1800216a8(DVar1);
            *pDVar4 = DVar1;
            goto LAB_1800206fc;
          }
        } while (param_2 < 0xffffffffffffffe1);
      }
      FUN_180021724(param_2);
      pDVar4 = FUN_180021688();
      *pDVar4 = 0xc;
    }
LAB_1800206fc:
    pvVar2 = (LPVOID)0x0;
  }
  return pvVar2;
}



void thunk_FUN_18001fcb8(LPVOID param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  if ((param_1 != (LPVOID)0x0) && (BVar1 = HeapFree(DAT_18004ceb0,0,param_1), BVar1 == 0)) {
    pDVar3 = FUN_180021688();
    DVar2 = GetLastError();
    DVar2 = FUN_1800216a8(DVar2);
    *pDVar3 = DVar2;
  }
  return;
}



undefined8 * FUN_18002074c(undefined8 *param_1,longlong param_2)

{
  FUN_1800221b8(param_1,param_2);
  *param_1 = std::bad_alloc::vftable;
  return param_1;
}



void FUN_180020780(ulonglong param_1)

{
  code *pcVar1;
  undefined8 uVar2;
  LPVOID pvVar3;
  char *local_res10 [3];
  undefined **local_28 [4];
  
  do {
    pvVar3 = FUN_18001fcf8(param_1);
    if (pvVar3 != (LPVOID)0x0) {
      return;
    }
    uVar2 = FUN_180021724(param_1);
  } while ((int)uVar2 != 0);
  local_res10[0] = "bad allocation";
  FUN_18002219c(local_28,local_res10);
  local_28[0] = std::bad_alloc::vftable;
  FUN_18002230c((longlong *)local_28,&DAT_180047e90);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined8 * FUN_1800207ec(undefined8 *param_1,uint param_2)

{
  *param_1 = std::bad_alloc::vftable;
  FUN_1800221e4(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



undefined4 FUN_180020828(void)

{
  undefined4 uVar1;
  undefined8 *Ptr;
  
  Ptr = (undefined8 *)FUN_18002244c(0x20,8);
  DAT_18004ede0 = EncodePointer(Ptr);
  DAT_18004ede8 = DAT_18004ede0;
  if (Ptr == (undefined8 *)0x0) {
    uVar1 = 0x18;
  }
  else {
    *Ptr = 0;
    uVar1 = 0;
  }
  return uVar1;
}



PVOID FUN_18002086c(PVOID param_1)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  PVOID pvVar4;
  ulonglong uVar5;
  PVOID pvVar6;
  
  FUN_180021ac8();
  puVar1 = (undefined8 *)DecodePointer(DAT_18004ede8);
  puVar2 = (undefined8 *)DecodePointer(DAT_18004ede0);
  if (puVar1 <= puVar2) {
    uVar5 = ((longlong)puVar2 - (longlong)puVar1) + 8;
    if (7 < uVar5) {
      uVar3 = FUN_180022410((longlong)puVar1);
      if (uVar3 < uVar5) {
        uVar5 = 0x1000;
        if (uVar3 < 0x1000) {
          uVar5 = uVar3;
        }
        if ((uVar5 + uVar3 < uVar3) ||
           (pvVar4 = FUN_180022548(puVar1,uVar5 + uVar3), pvVar4 == (LPVOID)0x0)) {
          pvVar6 = (PVOID)0x0;
          if ((uVar3 + 0x20 < uVar3) ||
             (pvVar4 = FUN_180022548(puVar1,uVar3 + 0x20), pvVar4 == (LPVOID)0x0))
          goto LAB_180020954;
        }
        puVar2 = (undefined8 *)((longlong)pvVar4 + ((longlong)puVar2 - (longlong)puVar1 >> 3) * 8);
        DAT_18004ede8 = EncodePointer(pvVar4);
      }
      pvVar4 = EncodePointer(param_1);
      *puVar2 = pvVar4;
      DAT_18004ede0 = EncodePointer(puVar2 + 1);
      pvVar6 = param_1;
      goto LAB_180020954;
    }
  }
  pvVar6 = (PVOID)0x0;
LAB_180020954:
  FUN_180021ad4();
  return pvVar6;
}



int FUN_180020978(PVOID param_1)

{
  PVOID pvVar1;
  
  pvVar1 = FUN_18002086c(param_1);
  return (pvVar1 != (PVOID)0x0) - 1;
}



ushort * FUN_180020990(ushort *param_1,ushort param_2)

{
  uint uVar1;
  ushort *puVar2;
  undefined1 in_XMM1 [16];
  undefined1 auVar3 [16];
  undefined1 auVar4 [16];
  undefined1 auVar5 [16];
  ushort uVar6;
  ushort uVar7;
  
  auVar3 = pshuflw(in_XMM1,ZEXT216(param_2),0);
  while( true ) {
    for (; ((uint)param_1 & 0xfff) < 0xff1; param_1 = param_1 + 8) {
      auVar5._0_2_ = -(ushort)(*param_1 == 0);
      auVar5._2_2_ = -(ushort)(param_1[1] == 0);
      auVar5._4_2_ = -(ushort)(param_1[2] == 0);
      auVar5._6_2_ = -(ushort)(param_1[3] == 0);
      auVar5._8_2_ = -(ushort)(param_1[4] == 0);
      auVar5._10_2_ = -(ushort)(param_1[5] == 0);
      auVar5._12_2_ = -(ushort)(param_1[6] == 0);
      auVar5._14_2_ = -(ushort)(param_1[7] == 0);
      uVar6 = auVar3._0_2_;
      auVar4._0_2_ = -(ushort)(*param_1 == uVar6);
      uVar7 = auVar3._2_2_;
      auVar4._2_2_ = -(ushort)(param_1[1] == uVar7);
      auVar4._4_2_ = -(ushort)(param_1[2] == uVar6);
      auVar4._6_2_ = -(ushort)(param_1[3] == uVar7);
      auVar4._8_2_ = -(ushort)(param_1[4] == uVar6);
      auVar4._10_2_ = -(ushort)(param_1[5] == uVar7);
      auVar4._12_2_ = -(ushort)(param_1[6] == uVar6);
      auVar4._14_2_ = -(ushort)(param_1[7] == uVar7);
      auVar5 = auVar5 | auVar4;
      uVar6 = (ushort)(SUB161(auVar5 >> 7,0) & 1) | (ushort)(SUB161(auVar5 >> 0xf,0) & 1) << 1 |
              (ushort)(SUB161(auVar5 >> 0x17,0) & 1) << 2 |
              (ushort)(SUB161(auVar5 >> 0x1f,0) & 1) << 3 |
              (ushort)(SUB161(auVar5 >> 0x27,0) & 1) << 4 |
              (ushort)(SUB161(auVar5 >> 0x2f,0) & 1) << 5 |
              (ushort)(SUB161(auVar5 >> 0x37,0) & 1) << 6 |
              (ushort)(SUB161(auVar5 >> 0x3f,0) & 1) << 7 |
              (ushort)(SUB161(auVar5 >> 0x47,0) & 1) << 8 |
              (ushort)(SUB161(auVar5 >> 0x4f,0) & 1) << 9 |
              (ushort)(SUB161(auVar5 >> 0x57,0) & 1) << 10 |
              (ushort)(SUB161(auVar5 >> 0x5f,0) & 1) << 0xb |
              (ushort)(SUB161(auVar5 >> 0x67,0) & 1) << 0xc |
              (ushort)(SUB161(auVar5 >> 0x6f,0) & 1) << 0xd |
              (ushort)(SUB161(auVar5 >> 0x77,0) & 1) << 0xe |
              (ushort)(byte)(auVar5[0xf] >> 7) << 0xf;
      if (uVar6 != 0) {
        uVar1 = 0;
        if (uVar6 != 0) {
          for (; (uVar6 >> uVar1 & 1) == 0; uVar1 = uVar1 + 1) {
          }
        }
        puVar2 = (ushort *)0x0;
        if (*(ushort *)((longlong)param_1 + (ulonglong)uVar1) == param_2) {
          puVar2 = (ushort *)((longlong)param_1 + (ulonglong)uVar1);
        }
        return puVar2;
      }
    }
    if (*param_1 == param_2) break;
    if (*param_1 == 0) {
      return (ushort *)0x0;
    }
    param_1 = param_1 + 1;
  }
  return param_1;
}



int FUN_180020a30(ulonglong *param_1,longlong param_2,ulonglong param_3)

{
  uint uVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong uVar4;
  bool bVar5;
  
  lVar3 = param_2 - (longlong)param_1;
  if (7 < param_3) {
    uVar4 = (ulonglong)param_1 & 7;
    while (uVar4 != 0) {
      bVar5 = (byte)*param_1 < *(byte *)(lVar3 + (longlong)param_1);
      if ((byte)*param_1 != *(byte *)(lVar3 + (longlong)param_1)) goto LAB_180020a73;
      param_1 = (ulonglong *)((longlong)param_1 + 1);
      param_3 = param_3 - 1;
      uVar4 = (ulonglong)param_1 & 7;
    }
    if (param_3 >> 3 != 0) {
      uVar4 = param_3 >> 5;
      if (uVar4 != 0) {
        do {
          uVar2 = *param_1;
          if (uVar2 != *(ulonglong *)(lVar3 + (longlong)param_1)) goto LAB_180020ae4;
          uVar2 = param_1[1];
          if (uVar2 != *(ulonglong *)(lVar3 + 8 + (longlong)param_1)) {
LAB_180020ae0:
            param_1 = param_1 + 1;
            goto LAB_180020ae4;
          }
          uVar2 = param_1[2];
          if (uVar2 != *(ulonglong *)(lVar3 + 0x10 + (longlong)param_1)) {
LAB_180020adc:
            param_1 = param_1 + 1;
            goto LAB_180020ae0;
          }
          uVar2 = param_1[3];
          if (uVar2 != *(ulonglong *)(lVar3 + 0x18 + (longlong)param_1)) {
            param_1 = param_1 + 1;
            goto LAB_180020adc;
          }
          param_1 = param_1 + 4;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar4 = param_3 >> 3;
      if (uVar4 != 0) {
        do {
          uVar2 = *param_1;
          if (uVar2 != *(ulonglong *)(lVar3 + (longlong)param_1)) {
LAB_180020ae4:
            uVar4 = *(ulonglong *)((longlong)param_1 + lVar3);
            uVar1 = (uint)((uVar2 >> 0x38 | (uVar2 & 0xff000000000000) >> 0x28 |
                            (uVar2 & 0xff0000000000) >> 0x18 | (uVar2 & 0xff00000000) >> 8 |
                            (uVar2 & 0xff000000) << 8 | (uVar2 & 0xff0000) << 0x18 |
                            (uVar2 & 0xff00) << 0x28 | uVar2 << 0x38) <
                          (uVar4 >> 0x38 | (uVar4 & 0xff000000000000) >> 0x28 |
                           (uVar4 & 0xff0000000000) >> 0x18 | (uVar4 & 0xff00000000) >> 8 |
                           (uVar4 & 0xff000000) << 8 | (uVar4 & 0xff0000) << 0x18 |
                           (uVar4 & 0xff00) << 0x28 | uVar4 << 0x38));
            return (1 - uVar1) - (uint)(uVar1 != 0);
          }
          param_1 = param_1 + 1;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        param_3 = param_3 & 7;
      }
    }
  }
  while( true ) {
    if (param_3 == 0) {
      return 0;
    }
    bVar5 = (byte)*param_1 < *(byte *)(lVar3 + (longlong)param_1);
    if ((byte)*param_1 != *(byte *)(lVar3 + (longlong)param_1)) break;
    param_1 = (ulonglong *)((longlong)param_1 + 1);
    param_3 = param_3 - 1;
  }
LAB_180020a73:
  return (1 - (uint)bVar5) - (uint)(bVar5 != 0);
}



void FUN_180020af8(undefined8 param_1)

{
  DAT_18004ce90 = IsDebuggerPresent();
  FUN_1800227b0();
  FUN_180022da8(param_1);
  if (DAT_18004ce90 == 0) {
    FUN_1800227b0();
  }
  FUN_180022d88(0xc0000409);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180020b44(void)

{
  code *pcVar1;
  BOOL BVar2;
  undefined1 *puVar3;
  undefined1 auStack_38 [8];
  undefined1 auStack_30 [48];
  
  puVar3 = auStack_38;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(2);
    puVar3 = auStack_30;
  }
  *(undefined8 *)(puVar3 + -8) = 0x180020b6e;
  FUN_180022828((PCONTEXT)&DAT_18004c9c0);
  _DAT_18004c930 = *(undefined8 *)(puVar3 + 0x38);
  _DAT_18004ca58 = puVar3 + 0x40;
  _DAT_18004ca40 = *(undefined8 *)(puVar3 + 0x40);
  _DAT_18004c920 = 0xc0000409;
  _DAT_18004c924 = 1;
  _DAT_18004c938 = 1;
  DAT_18004c940 = 2;
  *(undefined8 *)(puVar3 + 0x20) = DAT_18004a880;
  *(undefined8 *)(puVar3 + 0x28) = DAT_18004a888;
  *(undefined8 *)(puVar3 + -8) = 0x180020c10;
  DAT_18004cab8 = _DAT_18004c930;
  FUN_180020af8(&PTR_DAT_18003fce8);
  return;
}



void FUN_180020c30(void)

{
  undefined1 *in_RAX;
  undefined1 *puVar1;
  undefined1 *puVar2;
  undefined1 local_res8 [32];
  
  puVar1 = local_res8 + -(longlong)in_RAX;
  if (local_res8 < in_RAX) {
    puVar1 = (undefined1 *)0x0;
  }
  if (puVar1 < StackLimit) {
    puVar2 = (undefined1 *)StackLimit;
    do {
      puVar2 = puVar2 + -0x1000;
      *puVar2 = 0;
    } while ((undefined1 *)((ulonglong)puVar1 & 0xfffffffffffff000) != puVar2);
  }
  return;
}



double FUN_180020c80(double param_1)

{
  ulonglong uVar1;
  double dVar2;
  uint uVar3;
  undefined4 in_stack_ffffffffffffffd4;
  
  if (((ulonglong)param_1 & 0x7ff0000000000000) == 0x7ff0000000000000) {
    if (((ulonglong)param_1 & 0xfffffffffffff) == 0) {
      dVar2 = (double)((ulonglong)param_1 & 0x8000000000000000);
LAB_180020d17:
      if (dVar2 == 0.0) goto LAB_180020d69;
      uVar3 = 8;
      uVar1 = 0xfff8000000000000;
    }
    else {
      uVar1 = (ulonglong)param_1 | 0x8000000000000;
      uVar3 = 0;
    }
    dVar2 = (double)FUN_180022eec(&DAT_18003fcf8,5,uVar1,1,uVar3,
                                  CONCAT44(in_stack_ffffffffffffffd4,0x21),param_1,0,1);
  }
  else {
    if (((ulonglong)param_1 & 0x8000000000000000) != 0) {
      dVar2 = ABS(param_1);
      goto LAB_180020d17;
    }
LAB_180020d69:
    dVar2 = SQRT(param_1);
  }
  return dVar2;
}



void thunk_FUN_180020d88(void)

{
  PTR_LAB_18004aa28 = &LAB_180023ac8;
  PTR_LAB_18004aa20 = FUN_180023014;
  PTR_LAB_18004aa30 = &LAB_180023b68;
  PTR_LAB_18004aa48 = FUN_180023014;
  PTR_LAB_18004aa38 = &LAB_180023bb0;
  PTR_LAB_18004aa40 = &LAB_180023c38;
  PTR_LAB_18004aa50 = FUN_180023038;
  PTR_LAB_18004aa58 = FUN_180023b70;
  PTR_LAB_18004aa60 = FUN_180023ad0;
  PTR_LAB_18004aa68 = FUN_180023bb8;
  return;
}



void FUN_180020d88(void)

{
  PTR_LAB_18004aa28 = &LAB_180023ac8;
  PTR_LAB_18004aa20 = FUN_180023014;
  PTR_LAB_18004aa30 = &LAB_180023b68;
  PTR_LAB_18004aa48 = FUN_180023014;
  PTR_LAB_18004aa38 = &LAB_180023bb0;
  PTR_LAB_18004aa40 = &LAB_180023c38;
  PTR_LAB_18004aa50 = FUN_180023038;
  PTR_LAB_18004aa58 = FUN_180023b70;
  PTR_LAB_18004aa60 = FUN_180023ad0;
  PTR_LAB_18004aa68 = FUN_180023bb8;
  return;
}



undefined1 (*) [16] FUN_180020e10(undefined1 (*param_1) [16],uint param_2)

{
  ushort uVar1;
  ulonglong uVar2;
  uint uVar3;
  undefined1 (*pauVar4) [16];
  int iVar5;
  uint uVar6;
  char *pcVar7;
  char *pcVar8;
  bool bVar9;
  bool bVar10;
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 in_XMM1 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [16];
  char cVar11;
  char cVar16;
  char cVar17;
  char cVar18;
  
  pauVar4 = (undefined1 (*) [16])0x0;
  if (param_2 == 0) {
    pcVar7 = (char *)((ulonglong)param_1 & 0xfffffffffffffff0);
    auVar12[0] = -(*pcVar7 == '\0');
    auVar12[1] = -(pcVar7[1] == '\0');
    auVar12[2] = -(pcVar7[2] == '\0');
    auVar12[3] = -(pcVar7[3] == '\0');
    auVar12[4] = -(pcVar7[4] == '\0');
    auVar12[5] = -(pcVar7[5] == '\0');
    auVar12[6] = -(pcVar7[6] == '\0');
    auVar12[7] = -(pcVar7[7] == '\0');
    auVar12[8] = -(pcVar7[8] == '\0');
    auVar12[9] = -(pcVar7[9] == '\0');
    auVar12[10] = -(pcVar7[10] == '\0');
    auVar12[0xb] = -(pcVar7[0xb] == '\0');
    auVar12[0xc] = -(pcVar7[0xc] == '\0');
    auVar12[0xd] = -(pcVar7[0xd] == '\0');
    auVar12[0xe] = -(pcVar7[0xe] == '\0');
    auVar12[0xf] = -(pcVar7[0xf] == '\0');
    uVar3 = (uint)(ushort)((ushort)(SUB161(auVar12 >> 7,0) & 1) |
                           (ushort)(SUB161(auVar12 >> 0xf,0) & 1) << 1 |
                           (ushort)(SUB161(auVar12 >> 0x17,0) & 1) << 2 |
                           (ushort)(SUB161(auVar12 >> 0x1f,0) & 1) << 3 |
                           (ushort)(SUB161(auVar12 >> 0x27,0) & 1) << 4 |
                           (ushort)(SUB161(auVar12 >> 0x2f,0) & 1) << 5 |
                           (ushort)(SUB161(auVar12 >> 0x37,0) & 1) << 6 |
                           (ushort)(SUB161(auVar12 >> 0x3f,0) & 1) << 7 |
                           (ushort)(SUB161(auVar12 >> 0x47,0) & 1) << 8 |
                           (ushort)(SUB161(auVar12 >> 0x4f,0) & 1) << 9 |
                           (ushort)(SUB161(auVar12 >> 0x57,0) & 1) << 10 |
                           (ushort)(SUB161(auVar12 >> 0x5f,0) & 1) << 0xb |
                           (ushort)(SUB161(auVar12 >> 0x67,0) & 1) << 0xc |
                           (ushort)(SUB161(auVar12 >> 0x6f,0) & 1) << 0xd |
                           (ushort)(SUB161(auVar12 >> 0x77,0) & 1) << 0xe |
                          (ushort)(auVar12[0xf] >> 7) << 0xf) & -1 << ((byte)param_1 & 0xf);
    pcVar8 = pcVar7;
    if (uVar3 == 0) {
      do {
        pcVar7 = pcVar8 + 0x10;
        auVar13[0] = -(*pcVar7 == '\0');
        auVar13[1] = -(pcVar8[0x11] == '\0');
        auVar13[2] = -(pcVar8[0x12] == '\0');
        auVar13[3] = -(pcVar8[0x13] == '\0');
        auVar13[4] = -(pcVar8[0x14] == '\0');
        auVar13[5] = -(pcVar8[0x15] == '\0');
        auVar13[6] = -(pcVar8[0x16] == '\0');
        auVar13[7] = -(pcVar8[0x17] == '\0');
        auVar13[8] = -(pcVar8[0x18] == '\0');
        auVar13[9] = -(pcVar8[0x19] == '\0');
        auVar13[10] = -(pcVar8[0x1a] == '\0');
        auVar13[0xb] = -(pcVar8[0x1b] == '\0');
        auVar13[0xc] = -(pcVar8[0x1c] == '\0');
        auVar13[0xd] = -(pcVar8[0x1d] == '\0');
        auVar13[0xe] = -(pcVar8[0x1e] == '\0');
        auVar13[0xf] = -(pcVar8[0x1f] == '\0');
        uVar1 = (ushort)(SUB161(auVar13 >> 7,0) & 1) | (ushort)(SUB161(auVar13 >> 0xf,0) & 1) << 1 |
                (ushort)(SUB161(auVar13 >> 0x17,0) & 1) << 2 |
                (ushort)(SUB161(auVar13 >> 0x1f,0) & 1) << 3 |
                (ushort)(SUB161(auVar13 >> 0x27,0) & 1) << 4 |
                (ushort)(SUB161(auVar13 >> 0x2f,0) & 1) << 5 |
                (ushort)(SUB161(auVar13 >> 0x37,0) & 1) << 6 |
                (ushort)(SUB161(auVar13 >> 0x3f,0) & 1) << 7 |
                (ushort)(SUB161(auVar13 >> 0x47,0) & 1) << 8 |
                (ushort)(SUB161(auVar13 >> 0x4f,0) & 1) << 9 |
                (ushort)(SUB161(auVar13 >> 0x57,0) & 1) << 10 |
                (ushort)(SUB161(auVar13 >> 0x5f,0) & 1) << 0xb |
                (ushort)(SUB161(auVar13 >> 0x67,0) & 1) << 0xc |
                (ushort)(SUB161(auVar13 >> 0x6f,0) & 1) << 0xd |
                (ushort)(SUB161(auVar13 >> 0x77,0) & 1) << 0xe | (ushort)(auVar13[0xf] >> 7) << 0xf;
        uVar3 = (uint)uVar1;
        pcVar8 = pcVar7;
      } while (uVar1 == 0);
    }
    uVar6 = 0;
    if (uVar3 != 0) {
      for (; (uVar3 >> uVar6 & 1) == 0; uVar6 = uVar6 + 1) {
      }
    }
    pauVar4 = (undefined1 (*) [16])(pcVar7 + uVar6);
  }
  else if (DAT_18004aa10 < 2) {
    pcVar7 = (char *)((ulonglong)param_1 & 0xfffffffffffffff0);
    uVar3 = -1 << ((byte)param_1 & 0xf);
    auVar19 = pshuflw(in_XMM1,ZEXT416((param_2 & 0xff) << 8 | param_2 & 0xff),0);
    auVar14[0] = -(*pcVar7 == '\0');
    auVar14[1] = -(pcVar7[1] == '\0');
    auVar14[2] = -(pcVar7[2] == '\0');
    auVar14[3] = -(pcVar7[3] == '\0');
    auVar14[4] = -(pcVar7[4] == '\0');
    auVar14[5] = -(pcVar7[5] == '\0');
    auVar14[6] = -(pcVar7[6] == '\0');
    auVar14[7] = -(pcVar7[7] == '\0');
    auVar14[8] = -(pcVar7[8] == '\0');
    auVar14[9] = -(pcVar7[9] == '\0');
    auVar14[10] = -(pcVar7[10] == '\0');
    auVar14[0xb] = -(pcVar7[0xb] == '\0');
    auVar14[0xc] = -(pcVar7[0xc] == '\0');
    auVar14[0xd] = -(pcVar7[0xd] == '\0');
    auVar14[0xe] = -(pcVar7[0xe] == '\0');
    auVar14[0xf] = -(pcVar7[0xf] == '\0');
    cVar11 = auVar19[0];
    auVar15[0] = -(cVar11 == *pcVar7);
    cVar16 = auVar19[1];
    auVar15[1] = -(cVar16 == pcVar7[1]);
    cVar17 = auVar19[2];
    auVar15[2] = -(cVar17 == pcVar7[2]);
    cVar18 = auVar19[3];
    auVar15[3] = -(cVar18 == pcVar7[3]);
    auVar15[4] = -(cVar11 == pcVar7[4]);
    auVar15[5] = -(cVar16 == pcVar7[5]);
    auVar15[6] = -(cVar17 == pcVar7[6]);
    auVar15[7] = -(cVar18 == pcVar7[7]);
    auVar15[8] = -(cVar11 == pcVar7[8]);
    auVar15[9] = -(cVar16 == pcVar7[9]);
    auVar15[10] = -(cVar17 == pcVar7[10]);
    auVar15[0xb] = -(cVar18 == pcVar7[0xb]);
    auVar15[0xc] = -(cVar11 == pcVar7[0xc]);
    auVar15[0xd] = -(cVar16 == pcVar7[0xd]);
    auVar15[0xe] = -(cVar17 == pcVar7[0xe]);
    auVar15[0xf] = -(cVar18 == pcVar7[0xf]);
    uVar6 = (ushort)((ushort)(SUB161(auVar15 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar15 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar15 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar15 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar15 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar15 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar15 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar15 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar15 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar15 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar15 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar15 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar15 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar15 >> 0x6f,0) & 1) << 0xd |
                     (ushort)(SUB161(auVar15 >> 0x77,0) & 1) << 0xe |
                    (ushort)(auVar15[0xf] >> 7) << 0xf) & uVar3;
    uVar3 = (ushort)((ushort)(SUB161(auVar14 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar14 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar14 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar14 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar14 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar14 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar14 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar14 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar14 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar14 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar14 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar14 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar14 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar14 >> 0x6f,0) & 1) << 0xd |
                     (ushort)(SUB161(auVar14 >> 0x77,0) & 1) << 0xe |
                    (ushort)(auVar14[0xf] >> 7) << 0xf) & uVar3;
    pcVar8 = pcVar7;
    if (uVar3 == 0) {
      do {
        uVar3 = 0x1f;
        if (uVar6 != 0) {
          for (; uVar6 >> uVar3 == 0; uVar3 = uVar3 - 1) {
          }
        }
        if (uVar6 != 0) {
          pauVar4 = (undefined1 (*) [16])(pcVar8 + uVar3);
        }
        pcVar7 = pcVar8 + 0x10;
        auVar20[0] = -(*pcVar7 == '\0');
        auVar20[1] = -(pcVar8[0x11] == '\0');
        auVar20[2] = -(pcVar8[0x12] == '\0');
        auVar20[3] = -(pcVar8[0x13] == '\0');
        auVar20[4] = -(pcVar8[0x14] == '\0');
        auVar20[5] = -(pcVar8[0x15] == '\0');
        auVar20[6] = -(pcVar8[0x16] == '\0');
        auVar20[7] = -(pcVar8[0x17] == '\0');
        auVar20[8] = -(pcVar8[0x18] == '\0');
        auVar20[9] = -(pcVar8[0x19] == '\0');
        auVar20[10] = -(pcVar8[0x1a] == '\0');
        auVar20[0xb] = -(pcVar8[0x1b] == '\0');
        auVar20[0xc] = -(pcVar8[0x1c] == '\0');
        auVar20[0xd] = -(pcVar8[0x1d] == '\0');
        auVar20[0xe] = -(pcVar8[0x1e] == '\0');
        auVar20[0xf] = -(pcVar8[0x1f] == '\0');
        auVar19[0] = -(cVar11 == *pcVar7);
        auVar19[1] = -(cVar16 == pcVar8[0x11]);
        auVar19[2] = -(cVar17 == pcVar8[0x12]);
        auVar19[3] = -(cVar18 == pcVar8[0x13]);
        auVar19[4] = -(cVar11 == pcVar8[0x14]);
        auVar19[5] = -(cVar16 == pcVar8[0x15]);
        auVar19[6] = -(cVar17 == pcVar8[0x16]);
        auVar19[7] = -(cVar18 == pcVar8[0x17]);
        auVar19[8] = -(cVar11 == pcVar8[0x18]);
        auVar19[9] = -(cVar16 == pcVar8[0x19]);
        auVar19[10] = -(cVar17 == pcVar8[0x1a]);
        auVar19[0xb] = -(cVar18 == pcVar8[0x1b]);
        auVar19[0xc] = -(cVar11 == pcVar8[0x1c]);
        auVar19[0xd] = -(cVar16 == pcVar8[0x1d]);
        auVar19[0xe] = -(cVar17 == pcVar8[0x1e]);
        auVar19[0xf] = -(cVar18 == pcVar8[0x1f]);
        uVar1 = (ushort)(SUB161(auVar20 >> 7,0) & 1) | (ushort)(SUB161(auVar20 >> 0xf,0) & 1) << 1 |
                (ushort)(SUB161(auVar20 >> 0x17,0) & 1) << 2 |
                (ushort)(SUB161(auVar20 >> 0x1f,0) & 1) << 3 |
                (ushort)(SUB161(auVar20 >> 0x27,0) & 1) << 4 |
                (ushort)(SUB161(auVar20 >> 0x2f,0) & 1) << 5 |
                (ushort)(SUB161(auVar20 >> 0x37,0) & 1) << 6 |
                (ushort)(SUB161(auVar20 >> 0x3f,0) & 1) << 7 |
                (ushort)(SUB161(auVar20 >> 0x47,0) & 1) << 8 |
                (ushort)(SUB161(auVar20 >> 0x4f,0) & 1) << 9 |
                (ushort)(SUB161(auVar20 >> 0x57,0) & 1) << 10 |
                (ushort)(SUB161(auVar20 >> 0x5f,0) & 1) << 0xb |
                (ushort)(SUB161(auVar20 >> 0x67,0) & 1) << 0xc |
                (ushort)(SUB161(auVar20 >> 0x6f,0) & 1) << 0xd |
                (ushort)(SUB161(auVar20 >> 0x77,0) & 1) << 0xe | (ushort)(auVar20[0xf] >> 7) << 0xf;
        uVar3 = (uint)uVar1;
        uVar6 = (uint)(ushort)((ushort)(SUB161(auVar19 >> 7,0) & 1) |
                               (ushort)(SUB161(auVar19 >> 0xf,0) & 1) << 1 |
                               (ushort)(SUB161(auVar19 >> 0x17,0) & 1) << 2 |
                               (ushort)(SUB161(auVar19 >> 0x1f,0) & 1) << 3 |
                               (ushort)(SUB161(auVar19 >> 0x27,0) & 1) << 4 |
                               (ushort)(SUB161(auVar19 >> 0x2f,0) & 1) << 5 |
                               (ushort)(SUB161(auVar19 >> 0x37,0) & 1) << 6 |
                               (ushort)(SUB161(auVar19 >> 0x3f,0) & 1) << 7 |
                               (ushort)(SUB161(auVar19 >> 0x47,0) & 1) << 8 |
                               (ushort)(SUB161(auVar19 >> 0x4f,0) & 1) << 9 |
                               (ushort)(SUB161(auVar19 >> 0x57,0) & 1) << 10 |
                               (ushort)(SUB161(auVar19 >> 0x5f,0) & 1) << 0xb |
                               (ushort)(SUB161(auVar19 >> 0x67,0) & 1) << 0xc |
                               (ushort)(SUB161(auVar19 >> 0x6f,0) & 1) << 0xd |
                               (ushort)(SUB161(auVar19 >> 0x77,0) & 1) << 0xe |
                              (ushort)(auVar19[0xf] >> 7) << 0xf);
        pcVar8 = pcVar7;
      } while (uVar1 == 0);
    }
    uVar6 = uVar6 & (-uVar3 & uVar3) - 1;
    uVar3 = 0x1f;
    if (uVar6 != 0) {
      for (; uVar6 >> uVar3 == 0; uVar3 = uVar3 - 1) {
      }
    }
    if (uVar6 != 0) {
      pauVar4 = (undefined1 (*) [16])(pcVar7 + uVar3);
    }
  }
  else {
    uVar2 = (ulonglong)param_1 & 0xf;
    while (bVar10 = uVar2 == 0, !bVar10) {
      if ((int)(char)(*param_1)[0] == param_2) {
        pauVar4 = param_1;
      }
      if ((*param_1)[0] == '\0') {
        return pauVar4;
      }
      param_1 = (undefined1 (*) [16])(*param_1 + 1);
      uVar2 = (ulonglong)param_1 & 0xf;
    }
    bVar9 = false;
    while( true ) {
      iVar5 = pcmpistri(ZEXT416(param_2 & 0xff),*param_1,0x40);
      if (bVar9) {
        pauVar4 = (undefined1 (*) [16])(*param_1 + iVar5);
        bVar10 = pauVar4 == (undefined1 (*) [16])0x0;
        pcmpistri(ZEXT416(param_2 & 0xff),*param_1,0x40);
      }
      if (bVar10) break;
      bVar9 = (undefined1 (*) [16])0xffffffffffffffef < param_1;
      param_1 = param_1 + 1;
      bVar10 = param_1 == (undefined1 (*) [16])0x0;
    }
  }
  return pauVar4;
}



void FUN_180020f54(void)

{
  code *pcVar1;
  
  pcVar1 = (code *)DecodePointer(DAT_18004d568);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
  }
  FUN_180023c88(0,1);
  FUN_180023ca4();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined4 FUN_180020f80(undefined1 *param_1,WCHAR *param_2,undefined8 param_3,undefined8 param_4)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined *local_48;
  int local_40 [2];
  undefined1 *local_38;
  undefined4 local_30;
  
  local_48 = (undefined *)0x0;
  local_res18 = param_3;
  local_res20 = param_4;
  FUN_180020400((undefined1 (*) [16])local_40,0,0x28);
  if ((param_2 == (WCHAR *)0x0) || (param_1 == (undefined1 *)0x0)) {
    pDVar2 = FUN_180021688();
    *pDVar2 = 0x16;
    FUN_180023e68();
    uVar1 = 0xffffffff;
  }
  else {
    local_30 = 0x42;
    local_40[0] = 0x7fffffff;
    local_48 = param_1;
    local_38 = param_1;
    uVar1 = FUN_180024050(&local_48,param_2,(longlong *)0x0,(WCHAR *)&local_res18);
    local_40[0] = local_40[0] + -1;
    if (local_40[0] < 0) {
      FUN_180023ec4(0,&local_48);
    }
    else {
      *local_48 = 0;
      local_48 = local_48 + 1;
    }
    local_40[0] = local_40[0] + -1;
    if (local_40[0] < 0) {
      FUN_180023ec4(0,&local_48);
    }
    else {
      *local_48 = 0;
    }
  }
  return uVar1;
}



longlong * FUN_180021044(longlong *param_1,longlong *param_2)

{
  uint uVar1;
  undefined *puVar2;
  longlong lVar3;
  DWORD *pDVar4;
  int *piVar5;
  
  *(undefined1 *)(param_1 + 3) = 0;
  if (param_2 == (longlong *)0x0) {
    pDVar4 = FUN_180025acc();
    param_1[2] = (longlong)pDVar4;
    puVar2 = *(undefined **)(pDVar4 + 0x30);
    *param_1 = (longlong)puVar2;
    param_1[1] = *(longlong *)(pDVar4 + 0x2e);
    if ((puVar2 != PTR_DAT_18004b290) && ((DAT_18004b408 & pDVar4[0x32]) == 0)) {
      piVar5 = FUN_180024ed8();
      *param_1 = (longlong)piVar5;
    }
    if (((undefined *)param_1[1] != PTR_DAT_18004afb0) &&
       ((DAT_18004b408 & *(uint *)(param_1[2] + 200)) == 0)) {
      piVar5 = FUN_1800252d0();
      param_1[1] = (longlong)piVar5;
    }
    uVar1 = *(uint *)(param_1[2] + 200);
    if ((uVar1 & 2) == 0) {
      *(uint *)(param_1[2] + 200) = uVar1 | 2;
      *(undefined1 *)(param_1 + 3) = 1;
    }
  }
  else {
    lVar3 = param_2[1];
    *param_1 = *param_2;
    param_1[1] = lVar3;
  }
  return param_1;
}



uint FUN_1800210ec(longlong *param_1,byte *param_2,undefined8 *param_3,uint param_4,uint param_5)

{
  ushort uVar1;
  DWORD *pDVar2;
  undefined6 extraout_var;
  uint uVar3;
  int iVar4;
  byte *pbVar5;
  byte bVar6;
  uint uVar7;
  longlong lVar8;
  uint uVar9;
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  
  FUN_180021044(local_48,param_1);
  if (param_3 != (undefined8 *)0x0) {
    *param_3 = param_2;
  }
  if ((param_2 != (byte *)0x0) && ((param_4 == 0 || (param_4 - 2 < 0x23)))) {
    bVar6 = *param_2;
    uVar7 = 0;
    pbVar5 = param_2 + 1;
    lVar8 = local_48[0];
    while( true ) {
      if (*(int *)(lVar8 + 0xd4) < 2) {
        uVar3 = *(ushort *)(*(longlong *)(lVar8 + 0x108) + (ulonglong)bVar6 * 2) & 8;
      }
      else {
        uVar1 = FUN_180025880((uint)bVar6,8,local_48);
        uVar3 = (uint)CONCAT62(extraout_var,uVar1);
        lVar8 = local_48[0];
      }
      if (uVar3 == 0) break;
      bVar6 = *pbVar5;
      pbVar5 = pbVar5 + 1;
    }
    if (bVar6 == 0x2d) {
      param_5 = param_5 | 2;
LAB_1800211b2:
      bVar6 = *pbVar5;
      pbVar5 = pbVar5 + 1;
    }
    else if (bVar6 == 0x2b) goto LAB_1800211b2;
    if (param_4 == 0) {
LAB_1800211da:
      if (bVar6 != 0x30) {
        param_4 = 10;
        goto LAB_18002121c;
      }
      if ((*pbVar5 + 0xa8 & 0xdf) != 0) {
        param_4 = 8;
        goto LAB_18002121c;
      }
      param_4 = 0x10;
    }
    else {
      if (0x22 < param_4 - 2) {
        if (param_3 != (undefined8 *)0x0) {
          *param_3 = param_2;
        }
        goto LAB_1800211ce;
      }
      if (param_4 == 0) goto LAB_1800211da;
      if ((param_4 != 0x10) || (bVar6 != 0x30)) goto LAB_18002121c;
    }
    if ((*pbVar5 + 0xa8 & 0xdf) == 0) {
      bVar6 = pbVar5[1];
      pbVar5 = pbVar5 + 2;
    }
LAB_18002121c:
    do {
      uVar1 = *(ushort *)(*(longlong *)(lVar8 + 0x108) + (ulonglong)bVar6 * 2);
      if ((uVar1 & 4) == 0) {
        if ((uVar1 & 0x103) == 0) goto LAB_18002127d;
        iVar4 = (int)(char)bVar6;
        if ((byte)(bVar6 + 0x9f) < 0x1a) {
          iVar4 = iVar4 + -0x20;
        }
        uVar3 = iVar4 - 0x37;
      }
      else {
        uVar3 = (int)(char)bVar6 - 0x30;
      }
      if (param_4 <= uVar3) goto LAB_18002127d;
      uVar9 = (uint)(0xffffffff / (ulonglong)param_4);
      if ((uVar7 < uVar9) ||
         ((uVar7 == uVar9 && (uVar3 <= (uint)(0xffffffff % (ulonglong)param_4))))) {
        uVar7 = uVar7 * param_4 + uVar3;
        param_5 = param_5 | 8;
      }
      else {
        param_5 = param_5 | 0xc;
        if (param_3 == (undefined8 *)0x0) goto LAB_18002127d;
      }
      bVar6 = *pbVar5;
      pbVar5 = pbVar5 + 1;
    } while( true );
  }
  pDVar2 = FUN_180021688();
  *pDVar2 = 0x16;
  FUN_180023e68();
LAB_1800211ce:
  uVar7 = 0;
LAB_1800212fa:
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  return uVar7;
LAB_18002127d:
  pbVar5 = pbVar5 + -1;
  if ((param_5 & 8) == 0) {
    if (param_3 != (undefined8 *)0x0) {
      pbVar5 = param_2;
    }
    uVar7 = 0;
  }
  else if (((param_5 & 4) != 0) ||
          (((param_5 & 1) == 0 &&
           ((((param_5 & 2) != 0 && (0x80000000 < uVar7)) ||
            (((param_5 & 2) == 0 && (0x7fffffff < uVar7)))))))) {
    pDVar2 = FUN_180021688();
    *pDVar2 = 0x22;
    if ((param_5 & 1) == 0) {
      uVar7 = ((param_5 & 2) != 0) + 0x7fffffff;
    }
    else {
      uVar7 = 0xffffffff;
    }
  }
  if (param_3 != (undefined8 *)0x0) {
    *param_3 = pbVar5;
  }
  if ((param_5 & 2) != 0) {
    uVar7 = -uVar7;
  }
  goto LAB_1800212fa;
}



void FUN_180021328(byte *param_1,undefined8 *param_2,uint param_3)

{
  undefined **ppuVar1;
  
  if (DAT_18004d59c == 0) {
    ppuVar1 = &PTR_DAT_18004b3f8;
  }
  else {
    ppuVar1 = (undefined **)0x0;
  }
  FUN_1800210ec((longlong *)ppuVar1,param_1,param_2,param_3,0);
  return;
}



undefined8 FUN_180021358(undefined8 param_1,int param_2,longlong param_3)

{
  bool bVar1;
  int iVar2;
  DWORD DVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  longlong lVar5;
  DWORD *pDVar6;
  
  if (param_2 == 1) {
    bVar1 = FUN_1800216f8();
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      uVar4 = FUN_180025c38();
      if ((int)uVar4 != 0) {
        FUN_180026840();
        DAT_18004edf8 = GetCommandLineA();
        DAT_18004cea0 = FUN_18002674c();
        uVar4 = FUN_180025f04();
        if (-1 < (int)uVar4) {
          uVar4 = FUN_1800262a8();
          if (((-1 < (int)uVar4) && (uVar4 = FUN_180026564(), -1 < (int)uVar4)) &&
             (uVar4 = FUN_18002193c(), (int)uVar4 == 0)) {
            DAT_18004ce98 = DAT_18004ce98 + 1;
            goto LAB_1800214ac;
          }
          FUN_180026234();
        }
        FUN_180025cb8();
      }
      FUN_180021718();
    }
LAB_180021373:
    uVar4 = 0;
  }
  else {
    if (param_2 == 0) {
      if (DAT_18004ce98 < 1) goto LAB_180021373;
      DAT_18004ce98 = DAT_18004ce98 + -1;
      if (DAT_18004cf00 == 0) {
        FUN_18002192c();
      }
      FUN_1800217bc();
      if (param_3 == 0) {
        FUN_180026234();
        FUN_180025cb8();
        FUN_180021718();
        if (DAT_18004afb8 != 0xffffffff) {
          FUN_180025cb8();
        }
      }
    }
    else if (param_2 == 2) {
      lVar5 = FUN_1800228d4(DAT_18004afb8);
      if (lVar5 == 0) {
        pDVar6 = (DWORD *)FUN_18002244c(1,0x478);
        if (pDVar6 != (DWORD *)0x0) {
          iVar2 = FUN_1800228f0(DAT_18004afb8,pDVar6);
          if (iVar2 != 0) {
            FUN_180025b74((longlong)pDVar6,0);
            DVar3 = GetCurrentThreadId();
            *pDVar6 = DVar3;
            pDVar6[2] = 0xffffffff;
            pDVar6[3] = 0xffffffff;
            goto LAB_1800214ac;
          }
          FUN_18001fcb8(pDVar6);
        }
        goto LAB_180021373;
      }
    }
    else if (param_2 == 3) {
      FUN_180025a90((LPVOID)0x0);
    }
LAB_1800214ac:
    uVar4 = 1;
  }
  return uVar4;
}



void entry(undefined8 param_1,int param_2,longlong param_3,undefined8 param_4)

{
  if (param_2 == 1) {
    FUN_180026698();
  }
  FUN_1800214f8(param_1,param_2,param_3,param_4);
  return;
}



// WARNING: Removing unreachable block (ram,0x0001800215b7)
// WARNING: Removing unreachable block (ram,0x000180021549)
// WARNING: Removing unreachable block (ram,0x0001800215f1)

ulonglong FUN_1800214f8(undefined8 param_1,int param_2,longlong param_3,undefined8 param_4)

{
  ulonglong uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  
  if ((param_2 == 0) && (DAT_18004ce98 == 0)) {
    uVar1 = 0;
  }
  else if ((param_2 - 1U < 2) && (uVar2 = FUN_180021358(param_1,param_2,param_3), (int)uVar2 == 0))
  {
    uVar1 = 0;
  }
  else {
    uVar3 = FUN_180026744();
    uVar1 = uVar3 & 0xffffffff;
    if ((param_2 == 1) && ((uint)uVar3 == 0)) {
      FUN_180026744();
      FUN_180021358(param_1,0,param_3);
    }
    if ((param_2 == 0) || (param_2 == 3)) {
      uVar2 = FUN_180021358(param_1,param_2,param_3);
      uVar1 = (ulonglong)(-(uint)((int)uVar2 != 0) & (uint)uVar3);
    }
  }
  return uVar1;
}



DWORD * FUN_180021618(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180025af0();
  if (pDVar1 == (DWORD *)0x0) {
    pDVar1 = &DAT_18004aa0c;
  }
  else {
    pDVar1 = pDVar1 + 5;
  }
  return pDVar1;
}



void FUN_180021638(DWORD param_1)

{
  DWORD DVar1;
  DWORD *pDVar2;
  DWORD *pDVar3;
  
  pDVar2 = FUN_180025af0();
  if (pDVar2 == (DWORD *)0x0) {
    pDVar2 = &DAT_18004aa0c;
  }
  else {
    pDVar2 = pDVar2 + 5;
  }
  *pDVar2 = param_1;
  pDVar3 = FUN_180025af0();
  pDVar2 = (DWORD *)&DAT_18004aa08;
  if (pDVar3 != (DWORD *)0x0) {
    pDVar2 = pDVar3 + 4;
  }
  DVar1 = FUN_1800216a8(param_1);
  *pDVar2 = DVar1;
  return;
}



DWORD * FUN_180021688(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180025af0();
  if (pDVar1 == (DWORD *)0x0) {
    pDVar1 = (DWORD *)&DAT_18004aa08;
  }
  else {
    pDVar1 = pDVar1 + 4;
  }
  return pDVar1;
}



undefined4 FUN_1800216a8(int param_1)

{
  undefined4 uVar1;
  uint uVar2;
  int *piVar3;
  
  uVar2 = 0;
  piVar3 = &DAT_18004a8a0;
  do {
    if (param_1 == *piVar3) {
      return *(undefined4 *)(&DAT_18004a8a4 + (longlong)(int)uVar2 * 8);
    }
    uVar2 = uVar2 + 1;
    piVar3 = piVar3 + 2;
  } while (uVar2 < 0x2d);
  if (param_1 - 0x13U < 0x12) {
    return 0xd;
  }
  uVar1 = 0x16;
  if (param_1 - 0xbcU < 0xf) {
    uVar1 = 8;
  }
  return uVar1;
}



bool FUN_1800216f8(void)

{
  DAT_18004ceb0 = GetProcessHeap();
  return DAT_18004ceb0 != (HANDLE)0x0;
}



void FUN_180021718(void)

{
  DAT_18004ceb0 = 0;
  return;
}



undefined8 FUN_180021724(undefined8 param_1)

{
  int iVar1;
  code *pcVar2;
  
  pcVar2 = (code *)DecodePointer(DAT_18004ceb8);
  if ((pcVar2 != (code *)0x0) && (iVar1 = (*pcVar2)(param_1), iVar1 != 0)) {
    return 1;
  }
  return 0;
}



void FUN_180021758(undefined8 param_1)

{
  DAT_18004ceb8 = param_1;
  return;
}



void FUN_180021760(uint param_1)

{
  BOOL BVar1;
  FARPROC pFVar2;
  HMODULE local_res10 [3];
  
  BVar1 = GetModuleHandleExW(0,L"mscoree.dll",local_res10);
  if (BVar1 != 0) {
    pFVar2 = GetProcAddress(local_res10[0],"CorExitProcess");
    if (pFVar2 != (FARPROC)0x0) {
      (*pFVar2)((ulonglong)param_1);
    }
  }
  return;
}



void FUN_1800217a4(uint param_1)

{
  FUN_180021760(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



void FUN_1800217bc(void)

{
  int iVar1;
  PVOID pvVar2;
  undefined8 *puVar3;
  
  pvVar2 = DecodePointer(DAT_18004ede8);
  for (puVar3 = DAT_18004cee0; (puVar3 != (undefined8 *)0x0 && ((LPVOID)*puVar3 != (LPVOID)0x0));
      puVar3 = puVar3 + 1) {
    FUN_18001fcb8((LPVOID)*puVar3);
  }
  FUN_18001fcb8(DAT_18004cee0);
  DAT_18004cee0 = (undefined8 *)0x0;
  for (puVar3 = DAT_18004ced8; (puVar3 != (undefined8 *)0x0 && ((LPVOID)*puVar3 != (LPVOID)0x0));
      puVar3 = puVar3 + 1) {
    FUN_18001fcb8((LPVOID)*puVar3);
  }
  FUN_18001fcb8(DAT_18004ced8);
  DAT_18004ced8 = (undefined8 *)0x0;
  FUN_18001fcb8(DAT_18004ced0);
  FUN_18001fcb8(DAT_18004cec8);
  DAT_18004ced0 = (LPVOID)0x0;
  DAT_18004cec8 = (LPVOID)0x0;
  if ((pvVar2 != (PVOID)0xffffffffffffffff) && (DAT_18004ede8 != (PVOID)0x0)) {
    FUN_18001fcb8(pvVar2);
  }
  DAT_18004ede8 = EncodePointer((PVOID)0xffffffffffffffff);
  if (DAT_18004db18 != (LPVOID)0x0) {
    FUN_18001fcb8(DAT_18004db18);
    DAT_18004db18 = (LPVOID)0x0;
  }
  if (DAT_18004db20 != (LPVOID)0x0) {
    FUN_18001fcb8(DAT_18004db20);
    DAT_18004db20 = (LPVOID)0x0;
  }
  LOCK();
  iVar1 = *(int *)PTR_DAT_18004afb0;
  *(int *)PTR_DAT_18004afb0 = *(int *)PTR_DAT_18004afb0 + -1;
  UNLOCK();
  if ((iVar1 == 1) && ((undefined4 *)PTR_DAT_18004afb0 != &DAT_18004ac90)) {
    FUN_18001fcb8(PTR_DAT_18004afb0);
    PTR_DAT_18004afb0 = (undefined *)&DAT_18004ac90;
  }
  return;
}



void FUN_180021904(int param_1)

{
  code *pcVar1;
  
  FUN_180021c78();
  FUN_180021cec(param_1);
  FUN_180021ae0(0xff,1,0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_18002192c(void)

{
  FUN_180021ae0(0,0,1);
  return;
}



undefined8 FUN_18002193c(void)

{
  ulonglong uVar1;
  undefined8 uVar2;
  
  uVar1 = FUN_180026b10(0x18003fd00);
  if ((int)uVar1 != 0) {
    thunk_FUN_180020d88();
  }
  FUN_180023c4c();
  uVar2 = FUN_180021a8c((undefined8 *)&DAT_18002d500,(undefined8 *)&DAT_18002d528);
  if ((int)uVar2 == 0) {
    FUN_180020978(FUN_180026878);
    FUN_180021a2c((undefined8 *)&DAT_18002d4d8,(undefined8 *)&DAT_18002d4f8);
    if ((DAT_18004edd8 != (code *)0x0) && (uVar1 = FUN_180026b10(0x18004edd8), (int)uVar1 != 0)) {
      (*DAT_18004edd8)(0,2);
    }
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_1800219d4(UINT param_1)

{
  FUN_180021ae0(param_1,1,0);
  return;
}



void FUN_1800219e0(void)

{
  PVOID pvVar1;
  
  pvVar1 = EncodePointer((PVOID)0x0);
  FUN_180021758(pvVar1);
  FUN_180023df8(pvVar1);
  FUN_180023cfc(pvVar1);
  FUN_180026be0(pvVar1);
  FUN_180026bb0();
  FUN_180026e34(pvVar1);
  FUN_180022984();
  return;
}



void FUN_180021a2c(undefined8 *param_1,undefined8 *param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar2 = 0;
  uVar1 = (ulonglong)((longlong)param_2 + (7 - (longlong)param_1)) >> 3;
  if (param_2 < param_1) {
    uVar1 = uVar2;
  }
  if (uVar1 != 0) {
    do {
      if ((code *)*param_1 != (code *)0x0) {
        (*(code *)*param_1)();
      }
      uVar2 = uVar2 + 1;
      param_1 = param_1 + 1;
    } while (uVar2 < uVar1);
  }
  return;
}



void FUN_180021a8c(undefined8 *param_1,undefined8 *param_2)

{
  int iVar1;
  
  iVar1 = 0;
  if (param_1 < param_2) {
    do {
      if (iVar1 != 0) {
        return;
      }
      if ((code *)*param_1 != (code *)0x0) {
        iVar1 = (*(code *)*param_1)();
      }
      param_1 = param_1 + 1;
    } while (param_1 < param_2);
  }
  return;
}



void FUN_180021ac8(void)

{
  FUN_1800268b0(8);
  return;
}



void FUN_180021ad4(void)

{
  FUN_180026aa0(8);
  return;
}



void FUN_180021ae0(UINT param_1,int param_2,int param_3)

{
  longlong *plVar1;
  longlong *plVar2;
  PVOID pvVar3;
  code *pcVar4;
  longlong *plVar5;
  longlong *plVar6;
  longlong *plVar7;
  longlong *plVar8;
  
  FUN_1800268b0(8);
  if (DAT_18004cec0 != 1) {
    DAT_18004cf00 = 1;
    DAT_18004cefc = (undefined1)param_3;
    if (param_2 == 0) {
      plVar1 = (longlong *)DecodePointer(DAT_18004ede8);
      if (plVar1 != (longlong *)0x0) {
        plVar2 = (longlong *)DecodePointer(DAT_18004ede0);
        plVar7 = plVar1;
        plVar8 = plVar2;
        while (plVar2 = plVar2 + -1, plVar1 <= plVar2) {
          pvVar3 = EncodePointer((PVOID)0x0);
          if ((PVOID)*plVar2 != pvVar3) {
            if (plVar2 < plVar1) break;
            pcVar4 = (code *)DecodePointer((PVOID)*plVar2);
            pvVar3 = EncodePointer((PVOID)0x0);
            *plVar2 = (longlong)pvVar3;
            (*pcVar4)();
            plVar5 = (longlong *)DecodePointer(DAT_18004ede8);
            plVar6 = (longlong *)DecodePointer(DAT_18004ede0);
            if ((plVar7 != plVar5) || (plVar8 != plVar6)) {
              plVar1 = plVar5;
              plVar2 = plVar6;
              plVar7 = plVar5;
              plVar8 = plVar6;
            }
          }
        }
      }
      FUN_180021a2c((undefined8 *)&DAT_18002d530,(undefined8 *)&DAT_18002d550);
    }
    FUN_180021a2c((undefined8 *)&DAT_18002d558,(undefined8 *)&DAT_18002d560);
  }
  if ((param_3 != 0) && (FUN_180026aa0(8), param_3 != 0)) {
    return;
  }
  DAT_18004cec0 = 1;
  FUN_180026aa0(8);
  FUN_180021760(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



void FUN_180021c78(void)

{
  int iVar1;
  
  iVar1 = FUN_1800270d4(3);
  if (iVar1 != 1) {
    iVar1 = FUN_1800270d4(3);
    if (iVar1 != 0) {
      return;
    }
    if (DAT_18004cf20 != 1) {
      return;
    }
  }
  FUN_180021cec(0xfc);
  FUN_180021cec(0xff);
  return;
}



undefined * FUN_180021cbc(int param_1)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = &DAT_18003fd40;
  do {
    if (param_1 == *piVar2) {
      return (&PTR_u_R6002___floating_point_support_n_18003fd48)[(longlong)(int)uVar1 * 2];
    }
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 4;
  } while (uVar1 < 0x17);
  return (undefined *)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180021cec(int param_1)

{
  code *pcVar1;
  int iVar2;
  DWORD DVar3;
  short *psVar4;
  longlong lVar5;
  HANDLE hFile;
  char *pcVar6;
  ulonglong *puVar7;
  uint uVar8;
  undefined1 auStackY_268 [32];
  DWORD local_238 [4];
  ulonglong local_228 [62];
  undefined1 local_35;
  ulonglong local_28;
  
  local_28 = DAT_18004a880 ^ (ulonglong)auStackY_268;
  psVar4 = (short *)FUN_180021cbc(param_1);
  uVar8 = 0;
  if (psVar4 != (short *)0x0) {
    iVar2 = FUN_1800270d4(3);
    if (iVar2 != 1) {
      iVar2 = FUN_1800270d4(3);
      if ((iVar2 != 0) || (DAT_18004cf20 != 1)) {
        if (param_1 != 0xfc) {
          iVar2 = FUN_180026f80((undefined2 *)&DAT_18004cf30,0x314,L"Runtime Error!\n\nProgram: ");
          if (iVar2 != 0) {
            FUN_180023e88();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          _DAT_18004d16a = 0;
          DVar3 = GetModuleFileNameW((HMODULE)0x0,(LPWSTR)&DAT_18004cf62,0x104);
          if (DVar3 == 0) {
            iVar2 = FUN_180026f80((undefined2 *)&DAT_18004cf62,0x2fb,L"<program name unknown>");
            if (iVar2 != 0) {
              FUN_180023e88();
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          lVar5 = FUN_180026fec((short *)&DAT_18004cf62);
          if (0x3c < lVar5 + 1U) {
            lVar5 = FUN_180026fec((short *)&DAT_18004cf62);
            iVar2 = FUN_180027008((short *)(&DAT_18004ceec + lVar5 * 2),
                                  0x2fb - (lVar5 * 2 + -0x76 >> 1),(short *)&DAT_180040848,3);
            if (iVar2 != 0) {
              FUN_180023e88();
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          iVar2 = FUN_180026ef8((short *)&DAT_18004cf30,0x314,(short *)&DAT_180040850);
          if (iVar2 != 0) {
            FUN_180023e88();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          iVar2 = FUN_180026ef8((short *)&DAT_18004cf30,0x314,psVar4);
          if (iVar2 != 0) {
            FUN_180023e88();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          FUN_180027114((LPCWSTR)&DAT_18004cf30,L"Microsoft Visual C++ Runtime Library",0x12010);
        }
        goto LAB_180021ec7;
      }
    }
    hFile = GetStdHandle(0xfffffff4);
    if ((longlong)hFile - 1U < 0xfffffffffffffffe) {
      puVar7 = local_228;
      do {
        *(char *)puVar7 = (char)*psVar4;
        if (*psVar4 == 0) break;
        uVar8 = uVar8 + 1;
        puVar7 = (ulonglong *)((longlong)puVar7 + 1);
        psVar4 = psVar4 + 1;
      } while (uVar8 < 500);
      local_35 = 0;
      pcVar6 = FUN_180026e50(local_228);
      WriteFile(hFile,local_228,(DWORD)pcVar6,local_238,(LPOVERLAPPED)0x0);
    }
  }
LAB_180021ec7:
  FUN_18001fe50(local_28 ^ (ulonglong)auStackY_268);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180022072)
// WARNING: Removing unreachable block (ram,0x000180021fdc)
// WARNING: Removing unreachable block (ram,0x000180021f76)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180021f5c(void)

{
  int *piVar1;
  uint *puVar2;
  longlong lVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar6 = 0;
  piVar1 = (int *)cpuid_basic_info(0);
  _DAT_18004aa14 = 2;
  DAT_18004aa10 = 1;
  puVar2 = (uint *)cpuid_Version_info(1);
  uVar4 = puVar2[3];
  if (((piVar1[2] == 0x49656e69 && piVar1[3] == 0x6c65746e) && piVar1[1] == 0x756e6547) &&
     ((((uVar5 = *puVar2 & 0xfff3ff0, uVar5 == 0x106c0 || (uVar5 == 0x20660)) || (uVar5 == 0x20670))
      || ((uVar5 - 0x30650 < 0x21 &&
          ((0x100010001U >> ((ulonglong)(uVar5 - 0x30650) & 0x3f) & 1) != 0)))))) {
    DAT_18004d55c = DAT_18004d55c | 1;
  }
  if (((piVar1[1] == 0x68747541 && piVar1[2] == 0x69746e65) && piVar1[3] == 0x444d4163) &&
     (0x600eff < (*puVar2 & 0xff00f00))) {
    DAT_18004d55c = DAT_18004d55c | 4;
  }
  if (6 < *piVar1) {
    lVar3 = cpuid_Extended_Feature_Enumeration_info(7);
    uVar6 = *(uint *)(lVar3 + 4);
    if ((uVar6 >> 9 & 1) != 0) {
      DAT_18004d55c = DAT_18004d55c | 2;
    }
  }
  if ((uVar4 >> 0x14 & 1) != 0) {
    DAT_18004aa10 = 2;
    _DAT_18004aa14 = 6;
    if (((uVar4 >> 0x1b & 1) != 0) && ((uVar4 >> 0x1c & 1) != 0)) {
      DAT_18004aa10 = 3;
      _DAT_18004aa14 = 0xe;
      if ((uVar6 & 0x20) != 0) {
        DAT_18004aa10 = 5;
        _DAT_18004aa14 = 0x2e;
      }
    }
  }
  return 0;
}



LPVOID FUN_180022100(ulonglong param_1,ulonglong param_2,undefined4 *param_3)

{
  DWORD *pDVar1;
  LPVOID pvVar2;
  undefined8 uVar3;
  ulonglong dwBytes;
  
  if ((param_1 == 0) || (param_2 <= 0xffffffffffffffe0 / param_1)) {
    dwBytes = param_2 * param_1;
    if (dwBytes == 0) {
      dwBytes = 1;
    }
    do {
      pvVar2 = (LPVOID)0x0;
      if ((dwBytes < 0xffffffffffffffe1) &&
         (pvVar2 = HeapAlloc(DAT_18004ceb0,8,dwBytes), pvVar2 != (LPVOID)0x0)) {
        return pvVar2;
      }
      if (DAT_18004d558 == 0) {
        if (param_3 == (undefined4 *)0x0) {
          return pvVar2;
        }
        *param_3 = 0xc;
        return pvVar2;
      }
      uVar3 = FUN_180021724(dwBytes);
    } while ((int)uVar3 != 0);
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = 0xc;
    }
  }
  else {
    pDVar1 = FUN_180021688();
    *pDVar1 = 0xc;
  }
  return (LPVOID)0x0;
}



undefined8 * FUN_18002219c(undefined8 *param_1,undefined8 *param_2)

{
  undefined8 uVar1;
  
  *param_1 = std::exception::vftable;
  uVar1 = *param_2;
  *(undefined1 *)(param_1 + 2) = 0;
  param_1[1] = uVar1;
  return param_1;
}



undefined8 * FUN_1800221b8(undefined8 *param_1,longlong param_2)

{
  param_1[1] = 0;
  *param_1 = std::exception::vftable;
  *(undefined1 *)(param_1 + 2) = 0;
  FUN_1800221f4((longlong)param_1,param_2);
  return param_1;
}



void FUN_1800221e4(undefined8 *param_1)

{
  *param_1 = std::exception::vftable;
  FUN_1800222d0((longlong)param_1);
  return;
}



longlong FUN_1800221f4(longlong param_1,longlong param_2)

{
  if (param_1 != param_2) {
    FUN_1800222d0(param_1);
    if (*(char *)(param_2 + 0x10) == '\0') {
      *(undefined8 *)(param_1 + 8) = *(undefined8 *)(param_2 + 8);
    }
    else {
      FUN_180022274(param_1,*(ulonglong **)(param_2 + 8));
    }
  }
  return param_1;
}



undefined8 * FUN_180022238(undefined8 *param_1,uint param_2)

{
  *param_1 = std::exception::vftable;
  FUN_1800222d0((longlong)param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



void FUN_180022274(longlong param_1,ulonglong *param_2)

{
  char *pcVar1;
  undefined1 *puVar2;
  
  if (param_2 != (ulonglong *)0x0) {
    pcVar1 = FUN_180026e50(param_2);
    puVar2 = (undefined1 *)FUN_18001fcf8((ulonglong)(pcVar1 + 1));
    *(undefined1 **)(param_1 + 8) = puVar2;
    if (puVar2 != (undefined1 *)0x0) {
      FUN_180027388(puVar2,(longlong)(pcVar1 + 1),(char *)param_2);
      *(undefined1 *)(param_1 + 0x10) = 1;
    }
  }
  return;
}



void FUN_1800222d0(longlong param_1)

{
  if (*(char *)(param_1 + 0x10) != '\0') {
    FUN_18001fcb8(*(LPVOID *)(param_1 + 8));
  }
  *(undefined8 *)(param_1 + 8) = 0;
  *(undefined1 *)(param_1 + 0x10) = 0;
  return;
}



char * FUN_1800222f8(longlong param_1)

{
  char *pcVar1;
  
  pcVar1 = "Unknown exception";
  if (*(longlong *)(param_1 + 8) != 0) {
    pcVar1 = *(char **)(param_1 + 8);
  }
  return pcVar1;
}



void FUN_18002230c(longlong *param_1,byte *param_2)

{
  PVOID local_res8;
  undefined4 local_28;
  undefined4 uStack_24;
  longlong *plStack_20;
  byte *local_18;
  PVOID pvStack_10;
  
  local_28 = 0x19930520;
  uStack_24 = 0;
  plStack_20 = (longlong *)0x0;
  local_18 = (byte *)0x0;
  pvStack_10 = (PVOID)0x0;
  if ((param_2 != (byte *)0x0) && ((*param_2 & 0x10) != 0)) {
    param_2 = *(byte **)(*(longlong *)(*param_1 + -8) + 0x30);
    (**(code **)(*(longlong *)(*param_1 + -8) + 0x40))();
  }
  plStack_20 = param_1;
  local_18 = param_2;
  local_res8 = RtlPcToFileHeader(param_2,&local_res8);
  if (param_2 != (byte *)0x0) {
    if ((*param_2 & 8) == 0) {
      if (local_res8 == (PVOID)0x0) {
        local_28 = 0x1994000;
      }
    }
    else {
      local_28 = 0x1994000;
    }
  }
  pvStack_10 = local_res8;
  RaiseException(0xe06d7363,1,4,(ULONG_PTR *)&local_28);
  return;
}



undefined8 * FUN_1800223d4(undefined8 *param_1,uint param_2)

{
  *param_1 = type_info::vftable;
  FUN_180027468((longlong)param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001fcb8(param_1);
  }
  return param_1;
}



undefined8 FUN_180022410(longlong param_1)

{
  DWORD *pDVar1;
  undefined8 uVar2;
  
  if (param_1 == 0) {
    pDVar1 = FUN_180021688();
    *pDVar1 = 0x16;
    FUN_180023e68();
    return 0xffffffffffffffff;
  }
                    // WARNING: Could not recover jumptable at 0x000180022442. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar2 = HeapSize(DAT_18004ceb0,0,param_1);
  return uVar2;
}



LPVOID FUN_18002244c(ulonglong param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    pvVar1 = FUN_180022100(param_1,param_2,(undefined4 *)0x0);
    if (pvVar1 != (LPVOID)0x0) {
      return pvVar1;
    }
    if (DAT_18004d560 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_18004d560 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (LPVOID)0x0;
    }
  }
  return (LPVOID)0x0;
}



LPVOID FUN_1800224cc(ulonglong param_1)

{
  uint uVar1;
  LPVOID pvVar2;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    uVar1 = DAT_18004d560;
    pvVar2 = FUN_18001fcf8(param_1);
    if (pvVar2 != (LPVOID)0x0) {
      return pvVar2;
    }
    if (uVar1 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_18004d560 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (LPVOID)0x0;
    }
  }
  return (LPVOID)0x0;
}



LPVOID FUN_180022548(LPVOID param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  do {
    pvVar1 = FUN_180020670(param_1,param_2);
    if (pvVar1 != (LPVOID)0x0) {
      return pvVar1;
    }
    if (param_2 == 0) {
      return (LPVOID)0x0;
    }
    if (DAT_18004d560 == 0) {
      return (LPVOID)0x0;
    }
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_18004d560 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
  } while (dwMilliseconds != 0xffffffff);
  return (LPVOID)0x0;
}



undefined8
FUN_1800225cc(PEXCEPTION_RECORD param_1,PVOID param_2,undefined8 param_3,longlong *param_4)

{
  uint uVar1;
  longlong lVar2;
  uint *puVar3;
  int iVar4;
  ulonglong uVar5;
  uint uVar6;
  ulonglong uVar7;
  uint uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  PEXCEPTION_RECORD local_38;
  undefined8 local_30;
  
  lVar2 = param_4[1];
  puVar3 = (uint *)param_4[7];
  uVar10 = *param_4 - lVar2;
  if ((param_1->ExceptionFlags & 0x66) == 0) {
    local_38 = param_1;
    local_30 = param_3;
    for (uVar6 = *(uint *)(param_4 + 9); uVar6 < *puVar3; uVar6 = uVar6 + 1) {
      uVar7 = (ulonglong)uVar6;
      if (((puVar3[uVar7 * 4 + 1] <= uVar10) && (uVar10 < puVar3[uVar7 * 4 + 2])) &&
         (puVar3[uVar7 * 4 + 4] != 0)) {
        if (puVar3[uVar7 * 4 + 3] != 1) {
          iVar4 = (*(code *)((ulonglong)puVar3[uVar7 * 4 + 3] + lVar2))(&local_38,param_2);
          if (iVar4 < 0) {
            return 0;
          }
          if (iVar4 < 1) goto LAB_1800226d9;
        }
        if (((param_1->ExceptionCode == 0xe06d7363) && (DAT_18004edd0 != (code *)0x0)) &&
           (uVar5 = FUN_180026b10(0x18004edd0), (int)uVar5 != 0)) {
          (*DAT_18004edd0)(param_1,1);
        }
        FUN_180027520();
        RtlUnwindEx(param_2,(PVOID)((ulonglong)puVar3[uVar7 * 4 + 4] + lVar2),param_1,
                    (PVOID)(ulonglong)param_1->ExceptionCode,(PCONTEXT)param_4[5],
                    (PUNWIND_HISTORY_TABLE)param_4[8]);
        FUN_180027550();
      }
LAB_1800226d9:
    }
  }
  else {
    uVar7 = param_4[4] - lVar2;
    for (uVar6 = *(uint *)(param_4 + 9); uVar1 = *puVar3, uVar6 < uVar1; uVar6 = uVar6 + 1) {
      uVar5 = (ulonglong)uVar6;
      if ((puVar3[uVar5 * 4 + 1] <= uVar10) && (uVar10 < puVar3[uVar5 * 4 + 2])) {
        if ((param_1->ExceptionFlags & 0x20) != 0) {
          uVar9 = 0;
          if (uVar1 != 0) {
            do {
              if ((((puVar3[uVar9 * 4 + 1] <= uVar7) && (uVar7 < puVar3[uVar9 * 4 + 2])) &&
                  (puVar3[uVar9 * 4 + 4] == puVar3[uVar5 * 4 + 4])) &&
                 (puVar3[uVar9 * 4 + 3] == puVar3[uVar5 * 4 + 3])) break;
              uVar8 = (int)uVar9 + 1;
              uVar9 = (ulonglong)uVar8;
            } while (uVar8 < uVar1);
          }
          if ((uint)uVar9 != uVar1) {
            return 1;
          }
        }
        if (puVar3[uVar5 * 4 + 4] == 0) {
          *(uint *)(param_4 + 9) = uVar6 + 1;
          (*(code *)((ulonglong)puVar3[uVar5 * 4 + 3] + lVar2))
                    (CONCAT71((int7)(uVar5 * 2 >> 8),1),param_2);
        }
        else if (uVar7 == puVar3[uVar5 * 4 + 4]) {
          return 1;
        }
      }
    }
  }
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1800227b0(void)

{
  _DAT_18004edc8 = 0;
  return;
}



void FUN_1800227b8(PCONTEXT param_1)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18;
  
  RtlCaptureContext();
  ControlPc = param_1->Rip;
  FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
  if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,&local_res18,&local_res10,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
  }
  return;
}



void FUN_180022828(PCONTEXT param_1)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  int iVar1;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18 [2];
  
  RtlCaptureContext();
  ControlPc = param_1->Rip;
  iVar1 = 0;
  do {
    FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    if (FunctionEntry == (PRUNTIME_FUNCTION)0x0) {
      return;
    }
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,local_res18,&local_res10,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 2);
  return;
}



void FUN_18002289c(void)

{
  if ((code *)(DAT_18004ecc0 ^ DAT_18004a880) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800228ac. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004ecc0 ^ DAT_18004a880))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800228af. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsAlloc();
  return;
}



void FUN_1800228b8(void)

{
  if ((code *)(DAT_18004ecc8 ^ DAT_18004a880) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800228c8. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004ecc8 ^ DAT_18004a880))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800228cb. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsFree();
  return;
}



void FUN_1800228d4(DWORD param_1)

{
  if ((code *)(DAT_18004ecd0 ^ DAT_18004a880) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800228e4. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004ecd0 ^ DAT_18004a880))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800228e7. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsGetValue(param_1);
  return;
}



void FUN_1800228f0(DWORD param_1,LPVOID param_2)

{
  if ((code *)(DAT_18004ecd8 ^ DAT_18004a880) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180022900. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004ecd8 ^ DAT_18004a880))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180022903. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsSetValue(param_1,param_2);
  return;
}



undefined8 FUN_18002290c(LPCRITICAL_SECTION param_1,DWORD param_2)

{
  undefined8 uVar1;
  
  if ((code *)(DAT_18004ece0 ^ DAT_18004a880) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180022924. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*(code *)(DAT_18004ece0 ^ DAT_18004a880))();
    return uVar1;
  }
  InitializeCriticalSectionAndSpinCount(param_1,param_2);
  return 1;
}



bool FUN_180022938(void)

{
  int iVar1;
  bool bVar2;
  undefined4 local_res8 [8];
  
  bVar2 = DAT_18004aa18 < 0;
  if (!bVar2) goto LAB_180022979;
  local_res8[0] = 0;
  if ((code *)(DAT_18004eda8 ^ DAT_18004a880) == (code *)0x0) {
LAB_18002296f:
    DAT_18004aa18 = 0;
  }
  else {
    iVar1 = (*(code *)(DAT_18004eda8 ^ DAT_18004a880))(local_res8,0);
    DAT_18004aa18 = 1;
    if (iVar1 != 0x7a) goto LAB_18002296f;
  }
  bVar2 = false;
LAB_180022979:
  return DAT_18004aa18 != 0 && !bVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180022984(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  
  hModule = GetModuleHandleW(L"kernel32.dll");
  pFVar1 = GetProcAddress(hModule,"FlsAlloc");
  DAT_18004ecc0 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"FlsFree");
  DAT_18004ecc8 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"FlsGetValue");
  DAT_18004ecd0 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"FlsSetValue");
  DAT_18004ecd8 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"InitializeCriticalSectionEx");
  DAT_18004ece0 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"CreateEventExW");
  _DAT_18004ece8 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"CreateSemaphoreExW");
  _DAT_18004ecf0 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"SetThreadStackGuarantee");
  _DAT_18004ecf8 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"CreateThreadpoolTimer");
  _DAT_18004ed00 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"SetThreadpoolTimer");
  _DAT_18004ed08 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"WaitForThreadpoolTimerCallbacks");
  _DAT_18004ed10 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"CloseThreadpoolTimer");
  _DAT_18004ed18 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"CreateThreadpoolWait");
  _DAT_18004ed20 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"SetThreadpoolWait");
  _DAT_18004ed28 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"CloseThreadpoolWait");
  _DAT_18004ed30 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"FlushProcessWriteBuffers");
  _DAT_18004ed38 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"FreeLibraryWhenCallbackReturns");
  _DAT_18004ed40 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"GetCurrentProcessorNumber");
  _DAT_18004ed48 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"GetLogicalProcessorInformation");
  _DAT_18004ed50 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"CreateSymbolicLinkW");
  _DAT_18004ed58 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"SetDefaultDllDirectories");
  _DAT_18004ed60 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"EnumSystemLocalesEx");
  _DAT_18004ed70 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"CompareStringEx");
  _DAT_18004ed68 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"GetDateFormatEx");
  _DAT_18004ed78 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"GetLocaleInfoEx");
  _DAT_18004ed80 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"GetTimeFormatEx");
  _DAT_18004ed88 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"GetUserDefaultLocaleName");
  _DAT_18004ed90 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"IsValidLocaleName");
  _DAT_18004ed98 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"LCMapStringEx");
  DAT_18004eda0 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"GetCurrentPackageId");
  DAT_18004eda8 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"GetTickCount64");
  _DAT_18004edb0 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"GetFileInformationByHandleExW");
  _DAT_18004edb8 = (ulonglong)pFVar1 ^ DAT_18004a880;
  pFVar1 = GetProcAddress(hModule,"SetFileInformationByHandleW");
  _DAT_18004edc0 = (ulonglong)pFVar1 ^ DAT_18004a880;
  return;
}



void __stdcall Sleep(DWORD dwMilliseconds)

{
                    // WARNING: Could not recover jumptable at 0x000180022d80. Too many branches
                    // WARNING: Treating indirect jump as call
  Sleep(dwMilliseconds);
  return;
}



void FUN_180022d88(undefined4 param_1)

{
  HANDLE pvVar1;
  
  pvVar1 = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x000180022da0. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess(pvVar1,param_1);
  return;
}



void FUN_180022da8(undefined8 param_1)

{
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
                    // WARNING: Could not recover jumptable at 0x000180022dc1. Too many branches
                    // WARNING: Treating indirect jump as call
  UnhandledExceptionFilter(param_1);
  return;
}



undefined8 FUN_180022dc8(int param_1)

{
  undefined8 uVar1;
  undefined8 in_stack_00000030;
  uint in_stack_00000038;
  
  FUN_1800278d0(in_stack_00000038,0xffc0);
  uVar1 = FUN_1800062ec();
  if ((int)uVar1 == 0) {
    FUN_180027880(param_1);
  }
  return in_stack_00000030;
}



bool FUN_180022e30(uint param_1,ulonglong param_2)

{
  uint uVar1;
  
  uVar1 = param_1 & 0x1f;
  if (((param_1 & 8) == 0) || (-1 < (char)param_2)) {
    if (((param_1 & 4) == 0) || ((param_2 & 0x200) == 0)) {
      if (((param_1 & 1) == 0) || ((param_2 & 0x400) == 0)) {
        if (((param_1 & 2) != 0) && ((param_2 & 0x800) != 0)) {
          if ((param_1 & 0x10) != 0) {
            FUN_18002794c(0x10);
          }
          uVar1 = param_1 & 0x1d;
        }
      }
      else {
        FUN_18002794c(8);
        uVar1 = param_1 & 0x1e;
      }
    }
    else {
      FUN_18002794c(4);
      uVar1 = param_1 & 0x1b;
    }
  }
  else {
    FUN_18002794c(1);
    uVar1 = param_1 & 0x17;
  }
  if (((param_1 & 0x10) != 0) && ((param_2 >> 0xc & 1) != 0)) {
    FUN_18002794c(0x20);
    uVar1 = uVar1 & 0xffffffef;
  }
  return uVar1 == 0;
}



void FUN_180022eec(undefined8 param_1,uint param_2,undefined8 param_3,int param_4,uint param_5,
                  undefined8 param_6,undefined8 param_7,undefined8 param_8,int param_9)

{
  bool bVar1;
  uint uVar2;
  undefined4 extraout_var_00;
  undefined7 extraout_var;
  undefined1 auStackY_118 [32];
  ulonglong local_d8;
  undefined8 local_d0;
  undefined8 local_c8;
  uint local_b8 [12];
  undefined8 local_88;
  uint local_78;
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStackY_118;
  uVar2 = FUN_1800278d0(0x1f80,0xffc0);
  local_d8 = CONCAT44(extraout_var_00,uVar2);
  local_d0 = param_3;
  local_c8 = param_3;
  bVar1 = FUN_180022e30(param_5,local_d8);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    if (param_9 == 2) {
      local_88 = param_8;
      local_78 = local_78 & 0xffffffe3 | 3;
    }
    FUN_180027554(local_b8,&local_d8,(ulonglong)param_5,param_2,(uint *)&param_7,(uint *)&local_d0);
  }
  if ((DAT_18004b8a4 == 0) && (param_4 != 0)) {
    FUN_180022dc8(param_4);
  }
  else {
    FUN_180027880(param_4);
    FUN_1800278d0((uint)local_d8,0xffc0);
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStackY_118);
  return;
}



void FUN_180023014(ulonglong *param_1,ulonglong *param_2,ulonglong param_3,int param_4,uint param_5,
                  int param_6)

{
  FUN_180023038(param_1,param_2,param_3,param_4,param_5,param_6,(longlong *)0x0);
  return;
}



void FUN_180023038(ulonglong *param_1,ulonglong *param_2,ulonglong param_3,int param_4,uint param_5,
                  int param_6,longlong *param_7)

{
  if ((param_4 - 0x45U & 0xffffffdf) == 0) {
    FUN_180023664(param_1,(undefined1 *)param_2,param_3,param_5,param_6,param_7);
  }
  else if (param_4 == 0x66) {
    FUN_1800238c0(param_1,param_2,param_3,param_5,param_7);
  }
  else if ((param_4 - 0x41U & 0xffffffdf) == 0) {
    FUN_1800230b8(param_1,(undefined1 *)param_2,param_3,param_5,param_6,param_7);
  }
  else {
    FUN_180023994(param_1,param_2,param_3,param_5,param_6,param_7);
  }
  return;
}



DWORD FUN_1800230b8(ulonglong *param_1,undefined1 *param_2,ulonglong param_3,uint param_4,
                   int param_5,longlong *param_6)

{
  int iVar1;
  undefined1 (*pauVar2) [16];
  ushort uVar3;
  DWORD DVar4;
  DWORD *pDVar5;
  undefined1 (*pauVar6) [16];
  undefined1 (*pauVar7) [16];
  longlong lVar8;
  short sVar9;
  longlong lVar10;
  ulonglong uVar11;
  short sVar12;
  undefined1 (*pauVar13) [16];
  char *pcVar14;
  char *pcVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  
  uVar17 = 0x3ff;
  sVar12 = 0x30;
  FUN_180021044(local_48,param_6);
  uVar11 = (ulonglong)param_4;
  if ((int)param_4 < 0) {
    uVar11 = 0;
  }
  if ((param_2 == (undefined1 *)0x0) || (param_3 == 0)) {
    pDVar5 = FUN_180021688();
    DVar4 = 0x16;
  }
  else {
    iVar1 = (int)uVar11;
    *param_2 = 0;
    if ((ulonglong)(longlong)(iVar1 + 0xb) < param_3) {
      if ((*param_1 >> 0x34 & 0x7ff) == 0x7ff) {
        uVar11 = param_3 - 2;
        if (param_3 == 0xffffffffffffffff) {
          uVar11 = 0xffffffffffffffff;
        }
        DVar4 = FUN_180023664(param_1,param_2 + 2,uVar11,iVar1,0,(longlong *)0x0);
        if (DVar4 != 0) {
          *param_2 = 0;
          goto LAB_180023435;
        }
        if (param_2[2] == '-') {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        pauVar6 = FUN_180020e10((undefined1 (*) [16])(param_2 + 2),0x65);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          (*pauVar6)[0] = (-(param_5 != 0) & 0xe0U) + 0x70;
          (*pauVar6)[3] = 0;
        }
      }
      else {
        if ((*param_1 & 0x8000000000000000) != 0) {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        sVar9 = (-(ushort)(param_5 != 0) & 0xffe0) + 0x27;
        if ((*param_1 & 0x7ff0000000000000) == 0) {
          param_2[2] = 0x30;
          uVar17 = (ulonglong)(-(uint)((*param_1 & 0xfffffffffffff) != 0) & 0x3fe);
        }
        else {
          param_2[2] = 0x31;
        }
        pauVar13 = (undefined1 (*) [16])(param_2 + 3);
        pauVar6 = (undefined1 (*) [16])(param_2 + 4);
        if (iVar1 == 0) {
          (*pauVar13)[0] = 0;
        }
        else {
          (*pauVar13)[0] = *(undefined1 *)**(undefined8 **)(local_48[0] + 0xf0);
        }
        if ((*param_1 & 0xfffffffffffff) != 0) {
          uVar16 = 0xf000000000000;
          do {
            if ((int)uVar11 < 1) break;
            uVar3 = (short)((*param_1 & uVar16) >> ((byte)sVar12 & 0x3f)) + 0x30;
            if (0x39 < uVar3) {
              uVar3 = uVar3 + sVar9;
            }
            (*pauVar6)[0] = (char)uVar3;
            uVar16 = uVar16 >> 4;
            uVar11 = (ulonglong)((int)uVar11 - 1);
            pauVar6 = (undefined1 (*) [16])(*pauVar6 + 1);
            sVar12 = sVar12 + -4;
          } while (-1 < sVar12);
          if ((-1 < sVar12) &&
             (pauVar2 = pauVar6, 8 < (ushort)((*param_1 & uVar16) >> ((byte)sVar12 & 0x3f)))) {
            while (pauVar7 = (undefined1 (*) [16])(pauVar2[-1] + 0xf),
                  ((*pauVar7)[0] + 0xba & 0xdf) == 0) {
              (*pauVar7)[0] = 0x30;
              pauVar2 = pauVar7;
            }
            if (pauVar7 == pauVar13) {
              pauVar2[-1][0xe] = pauVar2[-1][0xe] + '\x01';
            }
            else if ((*pauVar7)[0] == '9') {
              (*pauVar7)[0] = (char)sVar9 + ':';
            }
            else {
              (*pauVar7)[0] = (*pauVar7)[0] + '\x01';
            }
          }
        }
        if (0 < (int)uVar11) {
          FUN_180020400(pauVar6,0x30,uVar11);
          pauVar6 = (undefined1 (*) [16])(*pauVar6 + uVar11);
        }
        if ((*pauVar13)[0] == '\0') {
          pauVar6 = pauVar13;
        }
        (*pauVar6)[0] = (-(param_5 != 0) & 0xe0U) + 0x70;
        lVar8 = ((uint)(*param_1 >> 0x34) & 0x7ff) - uVar17;
        if (lVar8 < 0) {
          (*pauVar6)[1] = 0x2d;
          lVar8 = -lVar8;
        }
        else {
          (*pauVar6)[1] = 0x2b;
        }
        pcVar14 = *pauVar6 + 2;
        *pcVar14 = '0';
        pcVar15 = pcVar14;
        if (lVar8 < 1000) {
LAB_1800233bf:
          if (99 < lVar8) goto LAB_1800233c5;
        }
        else {
          *pcVar14 = (char)(lVar8 / 1000) + '0';
          pcVar15 = *pauVar6 + 3;
          lVar8 = lVar8 % 1000;
          if (pcVar15 == pcVar14) goto LAB_1800233bf;
LAB_1800233c5:
          lVar10 = SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816(lVar8),8) + lVar8;
          lVar10 = (lVar10 >> 6) - (lVar10 >> 0x3f);
          *pcVar15 = (char)lVar10 + '0';
          pcVar15 = pcVar15 + 1;
          lVar8 = lVar8 + lVar10 * -100;
        }
        if ((pcVar15 != pcVar14) || (9 < lVar8)) {
          *pcVar15 = (char)(lVar8 / 10) + '0';
          pcVar15 = pcVar15 + 1;
          lVar8 = lVar8 % 10;
        }
        *pcVar15 = (char)lVar8 + '0';
        pcVar15[1] = '\0';
      }
      DVar4 = 0;
      goto LAB_180023435;
    }
    pDVar5 = FUN_180021688();
    DVar4 = 0x22;
  }
  *pDVar5 = DVar4;
  FUN_180023e68();
LAB_180023435:
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  return DVar4;
}



ulonglong FUN_180023468(undefined1 *param_1,ulonglong param_2,int param_3,int param_4,int *param_5,
                       char param_6,longlong *param_7)

{
  code *pcVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  char *pcVar4;
  ulonglong uVar5;
  undefined1 *puVar6;
  undefined1 *puVar7;
  uint uVar8;
  ulonglong *puVar9;
  int iVar10;
  longlong local_38 [2];
  longlong local_28;
  char local_20;
  
  FUN_180021044(local_38,param_7);
  if ((param_1 == (undefined1 *)0x0) || (param_2 == 0)) {
    pDVar3 = FUN_180021688();
    uVar8 = 0x16;
  }
  else {
    iVar10 = 0;
    if (0 < param_3) {
      iVar10 = param_3;
    }
    if ((ulonglong)(longlong)(iVar10 + 9) < param_2) {
      if (param_6 != '\0') {
        puVar9 = (ulonglong *)(param_1 + (*param_5 == 0x2d));
        if (0 < param_3 != 0) {
          pcVar4 = FUN_180026e50(puVar9);
          FUN_18001fe80((undefined8 *)((longlong)(int)(uint)(0 < param_3) + (longlong)puVar9),puVar9
                        ,(ulonglong)(pcVar4 + 1));
        }
      }
      puVar6 = param_1;
      if (*param_5 == 0x2d) {
        *param_1 = 0x2d;
        puVar6 = param_1 + 1;
      }
      if (0 < param_3) {
        *puVar6 = puVar6[1];
        puVar6 = puVar6 + 1;
        *puVar6 = *(undefined1 *)**(undefined8 **)(local_38[0] + 0xf0);
      }
      puVar6 = puVar6 + (ulonglong)(param_6 == '\0') + (longlong)param_3;
      puVar7 = param_1 + (param_2 - (longlong)puVar6);
      if (param_2 == 0xffffffffffffffff) {
        puVar7 = (undefined1 *)0xffffffffffffffff;
      }
      DVar2 = FUN_180027388(puVar6,(longlong)puVar7,"e+000");
      if (DVar2 != 0) {
        FUN_180023e88();
        pcVar1 = (code *)swi(3);
        uVar5 = (*pcVar1)();
        return uVar5;
      }
      if (param_4 != 0) {
        *puVar6 = 0x45;
      }
      if (**(char **)(param_5 + 4) != '0') {
        iVar10 = param_5[1] + -1;
        if (iVar10 < 0) {
          iVar10 = -iVar10;
          puVar6[1] = 0x2d;
        }
        if (99 < iVar10) {
          puVar6[2] = puVar6[2] + (char)(iVar10 / 100);
          iVar10 = iVar10 % 100;
        }
        if (9 < iVar10) {
          puVar6[3] = puVar6[3] + (char)(iVar10 / 10);
          iVar10 = iVar10 % 10;
        }
        puVar6[4] = puVar6[4] + (char)iVar10;
      }
      if (((DAT_18004db68 & 1) != 0) && (puVar6[2] == '0')) {
        FUN_18001fe80((undefined8 *)(puVar6 + 2),(undefined8 *)(puVar6 + 3),3);
      }
      uVar8 = 0;
      goto LAB_180023617;
    }
    pDVar3 = FUN_180021688();
    uVar8 = 0x22;
  }
  *pDVar3 = uVar8;
  FUN_180023e68();
LAB_180023617:
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return (ulonglong)uVar8;
}



void FUN_180023664(undefined8 *param_1,undefined1 *param_2,ulonglong param_3,int param_4,int param_5
                  ,longlong *param_6)

{
  DWORD DVar1;
  DWORD *pDVar2;
  ulonglong uVar3;
  undefined1 auStackY_a8 [32];
  int local_68 [6];
  undefined1 local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStackY_a8;
  FUN_180027eac(*param_1,local_68,local_50,0x16);
  if ((param_2 == (undefined1 *)0x0) || (param_3 == 0)) {
    pDVar2 = FUN_180021688();
    *pDVar2 = 0x16;
    FUN_180023e68();
  }
  else {
    uVar3 = 0xffffffffffffffff;
    if (param_3 != 0xffffffffffffffff) {
      uVar3 = (param_3 - (local_68[0] == 0x2d)) - (ulonglong)(0 < param_4);
    }
    DVar1 = FUN_180027b70(param_2 + (ulonglong)(0 < param_4) + (ulonglong)(local_68[0] == 0x2d),
                          uVar3,param_4 + 1,(longlong)local_68);
    if (DVar1 == 0) {
      FUN_180023468(param_2,param_3,param_4,param_5,local_68,'\0',param_6);
    }
    else {
      *param_2 = 0;
    }
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStackY_a8);
  return;
}



undefined4
FUN_18002375c(ulonglong *param_1,longlong param_2,int param_3,int *param_4,char param_5,
             longlong *param_6)

{
  undefined1 (*pauVar1) [16];
  DWORD *pDVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  ulonglong *puVar7;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  iVar5 = param_4[1];
  FUN_180021044(local_28,param_6);
  if ((param_1 == (ulonglong *)0x0) || (param_2 == 0)) {
    pDVar2 = FUN_180021688();
    uVar6 = 0x16;
    *pDVar2 = 0x16;
    FUN_180023e68();
  }
  else {
    if ((param_5 != '\0') && (iVar5 + -1 == param_3)) {
      *(undefined2 *)((longlong)param_1 + (longlong)(iVar5 + -1) + (ulonglong)(*param_4 == 0x2d)) =
           0x30;
    }
    if (*param_4 == 0x2d) {
      *(undefined1 *)param_1 = 0x2d;
      param_1 = (ulonglong *)((longlong)param_1 + 1);
    }
    if (param_4[1] < 1) {
      pcVar3 = FUN_180026e50(param_1);
      FUN_18001fe80((undefined8 *)((longlong)param_1 + 1),param_1,(ulonglong)(pcVar3 + 1));
      *(undefined1 *)param_1 = 0x30;
      puVar7 = (ulonglong *)((longlong)param_1 + 1);
    }
    else {
      puVar7 = (ulonglong *)((longlong)param_1 + (longlong)param_4[1]);
    }
    if (0 < param_3) {
      pauVar1 = (undefined1 (*) [16])((longlong)puVar7 + 1);
      pcVar3 = FUN_180026e50(puVar7);
      FUN_18001fe80((undefined8 *)pauVar1,puVar7,(ulonglong)(pcVar3 + 1));
      *(undefined1 *)puVar7 = *(undefined1 *)**(undefined8 **)(local_28[0] + 0xf0);
      if (param_4[1] < 0) {
        iVar4 = -param_4[1];
        iVar5 = iVar4;
        if ((param_5 == '\0') && (iVar5 = param_3, iVar4 <= param_3)) {
          iVar5 = iVar4;
        }
        if (iVar5 != 0) {
          pcVar3 = FUN_180026e50((ulonglong *)pauVar1);
          FUN_18001fe80((undefined8 *)(*pauVar1 + iVar5),(undefined8 *)pauVar1,
                        (ulonglong)(pcVar3 + 1));
        }
        FUN_180020400(pauVar1,0x30,(longlong)iVar5);
      }
    }
    uVar6 = 0;
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar6;
}



void FUN_1800238c0(undefined8 *param_1,ulonglong *param_2,longlong param_3,int param_4,
                  longlong *param_5)

{
  DWORD DVar1;
  DWORD *pDVar2;
  ulonglong uVar3;
  undefined1 auStackY_98 [32];
  int local_68;
  int local_64;
  undefined1 local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStackY_98;
  FUN_180027eac(*param_1,&local_68,local_50,0x16);
  if ((param_2 == (ulonglong *)0x0) || (param_3 == 0)) {
    pDVar2 = FUN_180021688();
    *pDVar2 = 0x16;
    FUN_180023e68();
  }
  else {
    uVar3 = 0xffffffffffffffff;
    if (param_3 != -1) {
      uVar3 = param_3 - (ulonglong)(local_68 == 0x2d);
    }
    DVar1 = FUN_180027b70((char *)((ulonglong)(local_68 == 0x2d) + (longlong)param_2),uVar3,
                          local_64 + param_4,(longlong)&local_68);
    if (DVar1 == 0) {
      FUN_18002375c(param_2,param_3,param_4,&local_68,'\0',param_5);
    }
    else {
      *(undefined1 *)param_2 = 0;
    }
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStackY_98);
  return;
}



void FUN_180023994(undefined8 *param_1,ulonglong *param_2,ulonglong param_3,int param_4,int param_5,
                  longlong *param_6)

{
  char *pcVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  ulonglong uVar4;
  char *pcVar5;
  int iVar6;
  undefined1 auStackY_a8 [32];
  int local_68;
  int local_64;
  undefined1 local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStackY_a8;
  FUN_180027eac(*param_1,&local_68,local_50,0x16);
  if ((param_2 == (ulonglong *)0x0) || (param_3 == 0)) {
    pDVar3 = FUN_180021688();
    *pDVar3 = 0x16;
    FUN_180023e68();
  }
  else {
    iVar6 = local_64 + -1;
    uVar4 = 0xffffffffffffffff;
    pcVar1 = (char *)((ulonglong)(local_68 == 0x2d) + (longlong)param_2);
    if (param_3 != 0xffffffffffffffff) {
      uVar4 = param_3 - (local_68 == 0x2d);
    }
    DVar2 = FUN_180027b70(pcVar1,uVar4,param_4,(longlong)&local_68);
    if (DVar2 == 0) {
      local_64 = local_64 + -1;
      if ((local_64 < -4) || (param_4 <= local_64)) {
        FUN_180023468((undefined1 *)param_2,param_3,param_4,param_5,&local_68,'\x01',param_6);
      }
      else {
        if (iVar6 < local_64) {
          do {
            pcVar5 = pcVar1;
            pcVar1 = pcVar5 + 1;
          } while (*pcVar5 != '\0');
          pcVar5[-1] = '\0';
        }
        FUN_18002375c(param_2,param_3,param_4,&local_68,'\x01',param_6);
      }
    }
    else {
      *(undefined1 *)param_2 = 0;
    }
  }
  FUN_18001fe50(local_38 ^ (ulonglong)auStackY_a8);
  return;
}



void FUN_180023ad0(char *param_1,longlong *param_2)

{
  char cVar1;
  char *pcVar2;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  char *pcVar3;
  
  FUN_180021044(local_28,param_2);
  cVar1 = *param_1;
  if (cVar1 != '\0') {
    do {
      if (cVar1 == *(char *)**(undefined8 **)(local_28[0] + 0xf0)) break;
      param_1 = param_1 + 1;
      cVar1 = *param_1;
    } while (cVar1 != '\0');
  }
  if (*param_1 != '\0') {
    do {
      param_1 = param_1 + 1;
      pcVar2 = param_1;
      if (*param_1 == '\0') break;
    } while ((*param_1 + 0xbbU & 0xdf) != 0);
    do {
      pcVar3 = pcVar2;
      pcVar2 = pcVar3 + -1;
    } while (*pcVar2 == '0');
    if (*pcVar2 == *(char *)**(undefined8 **)(local_28[0] + 0xf0)) {
      pcVar2 = pcVar3 + -2;
    }
    do {
      cVar1 = *param_1;
      pcVar2 = pcVar2 + 1;
      param_1 = param_1 + 1;
      *pcVar2 = cVar1;
    } while (cVar1 != '\0');
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_180023b70(int param_1,uint *param_2,byte *param_3,longlong *param_4)

{
  uint local_res8 [8];
  undefined8 local_18 [2];
  
  if (param_1 == 0) {
    FUN_180027dd4(local_res8,param_3,param_4);
    *param_2 = local_res8[0];
  }
  else {
    FUN_180027d0c((uint *)local_18,param_3,param_4);
    *(undefined8 *)param_2 = local_18[0];
  }
  return;
}



void FUN_180023bb8(byte *param_1,longlong *param_2)

{
  byte bVar1;
  uint uVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180021044(local_28,param_2);
  uVar2 = FUN_180027b50((int)(char)*param_1);
  if (uVar2 != 0x65) {
    do {
      param_1 = param_1 + 1;
      uVar3 = FUN_180027980((uint)*param_1);
    } while ((int)uVar3 != 0);
  }
  uVar2 = FUN_180027b50((int)(char)*param_1);
  if (uVar2 == 0x78) {
    param_1 = param_1 + 2;
  }
  bVar4 = *param_1;
  *param_1 = *(byte *)**(undefined8 **)(local_28[0] + 0xf0);
  do {
    param_1 = param_1 + 1;
    bVar1 = *param_1;
    *param_1 = bVar4;
    bVar4 = bVar1;
  } while (*param_1 != 0);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_180023c4c(void)

{
  undefined *puVar1;
  undefined **ppuVar2;
  uint uVar3;
  
  uVar3 = 0;
  ppuVar2 = &PTR_LAB_18004aa20;
  do {
    puVar1 = (undefined *)EncodePointer(*ppuVar2);
    uVar3 = uVar3 + 1;
    *ppuVar2 = puVar1;
    ppuVar2 = ppuVar2 + 1;
  } while (uVar3 < 10);
  return;
}



void FUN_180023c88(uint param_1,uint param_2)

{
  DAT_18004aa70 = ~param_2 & DAT_18004aa70 | param_1 & param_2;
  return;
}



void FUN_180023ca4(void)

{
  code *pcVar1;
  BOOL BVar2;
  longlong lVar3;
  undefined1 *puVar4;
  undefined1 auStack_28 [8];
  undefined1 auStack_20 [32];
  
  puVar4 = auStack_28;
  lVar3 = FUN_180026bd0();
  if (lVar3 != 0) {
    FUN_180026c00(0x16);
  }
  if (((byte)DAT_18004aa70 & 2) != 0) {
    BVar2 = IsProcessorFeaturePresent(0x17);
    puVar4 = auStack_28;
    if (BVar2 != 0) {
      pcVar1 = (code *)swi(0x29);
      (*pcVar1)(7);
      puVar4 = auStack_20;
    }
    *(undefined8 *)(puVar4 + -8) = 0x180023cee;
    FUN_180023d04(3,0x40000015,1);
  }
  *(undefined8 *)(puVar4 + -8) = 0x180023cf8;
  FUN_1800219d4(3);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_180023cfc(undefined8 param_1)

{
  DAT_18004d568 = param_1;
  return;
}



void FUN_180023d04(int param_1,undefined4 param_2,undefined4 param_3)

{
  BOOL BVar1;
  int iVar2;
  undefined1 auStackX_8 [8];
  undefined1 auStack_5b8 [32];
  undefined4 *local_598;
  _CONTEXT *local_590;
  undefined4 local_588;
  undefined1 local_584 [156];
  _CONTEXT local_4e8;
  ulonglong local_18;
  
  local_18 = DAT_18004a880 ^ (ulonglong)auStack_5b8;
  if (param_1 != -1) {
    FUN_1800227b0();
  }
  local_588 = 0;
  FUN_180020400((undefined1 (*) [16])local_584,0,0x94);
  local_598 = &local_588;
  local_590 = &local_4e8;
  FUN_1800227b8(&local_4e8);
  local_4e8.Rsp = (DWORD64)auStackX_8;
  local_588 = param_2;
  local_584._0_4_ = param_3;
  BVar1 = IsDebuggerPresent();
  iVar2 = FUN_180022da8(&local_598);
  if (((iVar2 == 0) && (BVar1 == 0)) && (param_1 != -1)) {
    FUN_1800227b0();
  }
  FUN_18001fe50(local_18 ^ (ulonglong)auStack_5b8);
  return;
}



void FUN_180023df8(undefined8 param_1)

{
  DAT_18004d570 = param_1;
  return;
}



void FUN_180023e00(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)DecodePointer(DAT_18004d570);
  if (UNRECOVERED_JUMPTABLE != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180023e52. Too many branches
                    // WARNING: Treating indirect jump as call
    (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
    return;
  }
  FUN_180023e88();
  UNRECOVERED_JUMPTABLE = (code *)swi(3);
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void FUN_180023e68(void)

{
  FUN_180023e00(0,0,0,0);
  return;
}



void FUN_180023e88(void)

{
  code *pcVar1;
  BOOL BVar2;
  undefined1 *puVar3;
  undefined1 auStack_28 [8];
  undefined1 auStack_20 [32];
  
  puVar3 = auStack_28;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(5);
    puVar3 = auStack_20;
  }
  *(undefined8 *)(puVar3 + -8) = 0x180023eb5;
  FUN_180023d04(2,0xc0000417,1);
  FUN_180022d88(0xc0000417);
  return;
}



ulonglong FUN_180023ec4(undefined4 param_1,undefined **param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  DWORD *pDVar4;
  undefined **ppuVar5;
  undefined7 extraout_var;
  longlong lVar6;
  undefined *puVar7;
  uint uVar8;
  undefined4 local_res8 [2];
  
  local_res8[0] = param_1;
  uVar2 = FUN_1800282f4((longlong)param_2);
  uVar8 = *(uint *)(param_2 + 3);
  if ((uVar8 & 0x82) == 0) {
    pDVar4 = FUN_180021688();
    *pDVar4 = 9;
  }
  else if ((uVar8 & 0x40) == 0) {
    uVar3 = 0;
    if ((uVar8 & 1) != 0) {
      *(undefined4 *)(param_2 + 1) = 0;
      if ((uVar8 & 0x10) == 0) {
        *(uint *)(param_2 + 3) = uVar8 | 0x20;
        return 0xffffffff;
      }
      *param_2 = param_2[2];
      *(uint *)(param_2 + 3) = uVar8 & 0xfffffffe;
    }
    uVar8 = *(uint *)(param_2 + 3);
    *(undefined4 *)(param_2 + 1) = 0;
    *(uint *)(param_2 + 3) = uVar8 & 0xffffffef | 2;
    if (((uVar8 & 0x10c) == 0) &&
       (((ppuVar5 = FUN_1800281e0(), param_2 != ppuVar5 + 6 &&
         (ppuVar5 = FUN_1800281e0(), param_2 != ppuVar5 + 0xc)) ||
        (bVar1 = FUN_18002831c(uVar2), (int)CONCAT71(extraout_var,bVar1) == 0)))) {
      FUN_180028dd0(param_2);
    }
    if (((ulonglong)param_2[3] & 0x108) == 0) {
      uVar8 = 1;
      uVar3 = FUN_18002837c(uVar2,(WCHAR *)local_res8,1);
    }
    else {
      uVar8 = *(int *)param_2 - *(int *)(param_2 + 2);
      *param_2 = (undefined *)((longlong)param_2[2] + 1);
      *(int *)(param_2 + 1) = *(int *)((longlong)param_2 + 0x24) + -1;
      if ((int)uVar8 < 1) {
        if (uVar2 + 2 < 2) {
          puVar7 = &DAT_18004b430;
        }
        else {
          puVar7 = (undefined *)
                   ((ulonglong)(uVar2 & 0x1f) * 0x58 + (&DAT_18004d5a0)[(longlong)(int)uVar2 >> 5]);
        }
        if (((puVar7[8] & 0x20) != 0) &&
           (lVar6 = FUN_180028c54(uVar2,(LARGE_INTEGER)0x0,2), lVar6 == -1)) goto LAB_180023efc;
      }
      else {
        uVar3 = FUN_18002837c(uVar2,(WCHAR *)param_2[2],uVar8);
      }
      *param_2[2] = (byte)local_res8[0];
    }
    if (uVar3 == uVar8) {
      return (ulonglong)(byte)local_res8[0];
    }
  }
  else {
    pDVar4 = FUN_180021688();
    *pDVar4 = 0x22;
  }
LAB_180023efc:
  *(uint *)(param_2 + 3) = *(uint *)(param_2 + 3) | 0x20;
  return 0xffffffff;
}



// WARNING: Removing unreachable block (ram,0x0001800244a9)
// WARNING: Removing unreachable block (ram,0x000180024487)
// WARNING: Removing unreachable block (ram,0x0001800245f4)
// WARNING: Removing unreachable block (ram,0x0001800245fd)
// WARNING: Removing unreachable block (ram,0x000180024605)

void FUN_180024050(undefined **param_1,WCHAR *param_2,longlong *param_3,WCHAR *param_4)

{
  WCHAR WVar1;
  short *psVar2;
  int *piVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  bool bVar8;
  bool bVar9;
  bool bVar10;
  bool bVar11;
  char cVar12;
  ushort uVar13;
  int iVar14;
  DWORD *pDVar15;
  undefined6 extraout_var_00;
  WCHAR *pWVar16;
  undefined7 extraout_var;
  code *pcVar17;
  char *pcVar18;
  WCHAR *pWVar19;
  uint uVar20;
  char *pcVar21;
  WCHAR *pWVar22;
  undefined **ppuVar23;
  ulonglong uVar24;
  char *pcVar25;
  uint uVar26;
  char *pcVar27;
  uint uVar28;
  WCHAR WVar29;
  int iVar30;
  undefined1 auStackY_518 [32];
  uint local_4d8;
  uint local_4d4;
  uint local_4d0;
  int local_4cc;
  WCHAR *local_4c8;
  uint local_4c0;
  WCHAR local_4bc [2];
  WCHAR local_4b8 [2];
  byte local_4b4;
  undefined1 local_4b3;
  uint local_4b0;
  undefined **local_4a8;
  int local_4a0;
  undefined4 local_49c;
  undefined4 local_498;
  WCHAR *local_490;
  longlong local_488 [2];
  longlong local_478;
  char local_470;
  WCHAR *local_468;
  DWORD *local_460;
  ulonglong local_458 [2];
  WCHAR local_448 [255];
  WCHAR local_249 [256];
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStackY_518;
  local_498 = 0;
  uVar28 = 0;
  bVar10 = false;
  bVar9 = false;
  bVar8 = false;
  bVar7 = false;
  bVar6 = false;
  bVar5 = false;
  bVar4 = false;
  local_4c0 = 0;
  uVar20 = 0;
  local_4d4 = 0;
  local_4d0 = 0;
  local_49c = 0;
  local_4a0 = 0;
  pWVar19 = (WCHAR *)0x0;
  local_4cc = 0;
  local_4c8 = param_4;
  local_4a8 = param_1;
  local_490 = param_2;
  FUN_180021044(local_488,param_3);
  local_460 = FUN_180021688();
  pcVar18 = (char *)0x0;
  if ((param_1 == (undefined **)0x0) || (local_490 == (WCHAR *)0x0)) {
LAB_1800240d5:
    pDVar15 = FUN_180021688();
    *pDVar15 = 0x16;
    FUN_180023e68();
    if (local_470 != '\0') {
      *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
    }
  }
  else {
    WVar29 = *local_490;
    local_4d8 = 0;
    local_468 = (WCHAR *)0x0;
    pcVar21 = pcVar18;
    pcVar27 = pcVar18;
    pWVar22 = (WCHAR *)PTR_DAT_18004b418;
    pWVar16 = local_490;
    while (PTR_DAT_18004b418 = (undefined *)pWVar22, WVar29 != L'\0') {
      pcVar25 = (char *)0x0;
      local_490 = pWVar16 + 1;
      if ((int)pcVar21 < 0) break;
      uVar26 = 0;
      if ((ushort)(WVar29 + L'') < 0x59) {
        uVar26 = (int)(char)(&DAT_180041100)[(ushort)WVar29] & 0xf;
      }
      local_4b0 = (int)(char)(&DAT_180041120)[(longlong)(int)pcVar18 + (longlong)(int)uVar26 * 8] >>
                  4;
      pcVar18 = (char *)(ulonglong)local_4b0;
      if (local_4b0 == 0) {
LAB_1800249ae:
        local_4cc = 1;
        FUN_180024ae8(WVar29,local_4a8,(int *)&local_4d8);
        pcVar21 = (char *)(ulonglong)local_4d8;
LAB_1800248ac:
        pcVar18 = (char *)(ulonglong)local_4b0;
        pWVar16 = local_490;
      }
      else if (local_4b0 == 1) {
        uVar20 = 0xffffffff;
        local_49c = 0;
        local_4a0 = 0;
        local_4c0 = 0;
        local_4d0 = 0;
        uVar28 = 0;
        bVar10 = false;
        bVar9 = false;
        bVar8 = false;
        bVar7 = false;
        bVar6 = false;
        bVar5 = false;
        bVar4 = false;
        local_4d4 = 0xffffffff;
        local_4cc = 0;
        pWVar16 = local_490;
      }
      else if (local_4b0 == 2) {
        if (WVar29 == L' ') {
          bVar10 = true;
          pWVar16 = local_490;
        }
        else if (WVar29 == L'#') {
          bVar9 = true;
          pWVar16 = local_490;
        }
        else if (WVar29 == L'+') {
          bVar6 = true;
          pWVar16 = local_490;
        }
        else if (WVar29 == L'-') {
          uVar28 = uVar28 | 4;
          pWVar16 = local_490;
        }
        else {
          pWVar16 = local_490;
          if (WVar29 == L'0') {
            uVar28 = uVar28 | 8;
          }
        }
      }
      else if (local_4b0 == 3) {
        if (WVar29 == L'*') {
          local_4c0 = *(uint *)param_4;
          param_4 = param_4 + 4;
          pWVar16 = local_490;
          local_4c8 = param_4;
          if ((int)local_4c0 < 0) {
            uVar28 = uVar28 | 4;
            local_4c0 = -local_4c0;
          }
        }
        else {
          local_4c0 = ((uint)(ushort)WVar29 + local_4c0 * 10) - 0x30;
          pWVar16 = local_490;
        }
      }
      else if (local_4b0 == 4) {
        local_4d4 = 0;
        pWVar16 = local_490;
        uVar20 = 0;
      }
      else if (local_4b0 == 5) {
        if (WVar29 == L'*') {
          uVar20 = *(uint *)param_4;
          param_4 = param_4 + 4;
          pWVar16 = local_490;
          local_4d4 = uVar20;
          local_4c8 = param_4;
          if ((int)uVar20 < 0) {
            uVar20 = 0xffffffff;
            local_4d4 = uVar20;
          }
        }
        else {
          uVar20 = (uint)(ushort)WVar29 + (uVar20 * 5 + -0x18) * 2;
          pWVar16 = local_490;
          local_4d4 = uVar20;
        }
      }
      else if (local_4b0 == 6) {
        if (WVar29 == L'I') {
          WVar1 = *local_490;
          bVar8 = true;
          if ((WVar1 == L'6') && (pWVar16[2] == L'4')) {
            bVar8 = true;
            pWVar16 = pWVar16 + 3;
          }
          else if ((WVar1 == L'3') && (pWVar16[2] == L'2')) {
            bVar8 = false;
            pWVar16 = pWVar16 + 3;
          }
          else if ((0x20 < (ushort)(WVar1 + L'')) ||
                  (pWVar16 = local_490,
                  (0x120821001U >> ((ulonglong)(ushort)(WVar1 + L'') & 0x3f) & 1) == 0)) {
            local_4b0 = 0;
            goto LAB_1800249ae;
          }
        }
        else if (WVar29 == L'h') {
          uVar28 = uVar28 | 0x20;
          pWVar16 = local_490;
        }
        else if (WVar29 == L'l') {
          if (*local_490 == L'l') {
            bVar5 = true;
            pWVar16 = pWVar16 + 2;
          }
          else {
            uVar28 = uVar28 | 0x10;
            pWVar16 = local_490;
          }
        }
        else {
          pWVar16 = local_490;
          if (WVar29 == L'w') {
            uVar28 = uVar28 | 0x800;
          }
        }
      }
      else {
        pWVar16 = local_490;
        if (local_4b0 == 7) {
          if ((ushort)WVar29 < 0x65) {
            if (WVar29 == L'd') {
LAB_1800244ee:
              bVar7 = true;
LAB_1800244f2:
              iVar14 = 10;
LAB_180024502:
              if ((bVar8) || (bVar5)) {
                uVar24 = *(ulonglong *)param_4;
              }
              else if ((uVar28 & 0x20) == 0) {
                if (bVar7) {
                  uVar24 = (ulonglong)(int)*(uint *)param_4;
                }
                else {
                  uVar24 = (ulonglong)*(uint *)param_4;
                }
              }
              else if (bVar7) {
                uVar24 = (ulonglong)*param_4;
              }
              else {
                uVar24 = (ulonglong)(ushort)*param_4;
              }
              param_4 = param_4 + 4;
              if ((bVar7) && ((longlong)uVar24 < 0)) {
                uVar24 = -uVar24;
                bVar4 = true;
              }
              if ((!bVar8) && (!bVar5)) {
                uVar24 = uVar24 & 0xffffffff;
              }
              if ((int)uVar20 < 0) {
                uVar20 = 1;
              }
              else {
                uVar28 = uVar28 & 0xfffffff7;
                if (0x200 < (int)uVar20) {
                  uVar20 = 0x200;
                }
              }
              pWVar22 = local_249;
              local_4d0 = -(uint)(uVar24 != 0) & local_4d0;
              while ((local_4d4 = uVar20 - 1, 0 < (int)uVar20 || (uVar24 != 0))) {
                uVar20 = (int)(uVar24 % (ulonglong)(longlong)iVar14) + 0x30;
                cVar12 = (char)uVar20;
                if (0x39 < uVar20) {
                  cVar12 = cVar12 + (char)local_498;
                }
                *(char *)pWVar22 = cVar12;
                pWVar22 = (WCHAR *)((longlong)pWVar22 + -1);
                uVar24 = uVar24 / (ulonglong)(longlong)iVar14;
                uVar20 = local_4d4;
              }
              pcVar21 = (char *)(ulonglong)local_4d8;
              pWVar19 = (WCHAR *)((longlong)pWVar22 + 1);
              pcVar27 = (char *)(ulonglong)(uint)((int)local_249 - (int)pWVar22);
              local_4c8 = param_4;
            }
            else {
              if (WVar29 == L'A') {
LAB_1800243b1:
                local_49c = 1;
                WVar29 = WVar29 + L' ';
                goto LAB_1800243c2;
              }
              if (WVar29 == L'C') {
                if ((uVar28 & 0x830) == 0) {
                  uVar28 = uVar28 | 0x20;
                }
LAB_180024347:
                local_4b8[0] = *param_4;
                param_4 = param_4 + 4;
                local_4cc = 1;
                local_4c8 = param_4;
                if ((uVar28 & 0x20) == 0) {
                  local_448[0] = local_4b8[0];
                }
                else {
                  local_4b4 = (byte)local_4b8[0];
                  local_4b3 = 0;
                  iVar14 = FUN_1800290bc(local_448,&local_4b4,
                                         (longlong)*(int *)(local_488[0] + 0xd4),local_488);
                  if (iVar14 < 0) {
                    local_4a0 = 1;
                  }
                }
                pcVar27 = (char *)0x1;
                pWVar19 = local_448;
              }
              else {
                if (((ushort)WVar29 - 0x45 & 0xfffffffd) == 0) goto LAB_1800243b1;
                if (WVar29 == L'S') {
                  if ((uVar28 & 0x830) == 0) {
                    uVar28 = uVar28 | 0x20;
                  }
LAB_1800242a1:
                  pWVar16 = *(WCHAR **)param_4;
                  if (local_4d4 == 0xffffffff) {
                    uVar20 = 0x7fffffff;
                  }
                  param_4 = param_4 + 4;
                  pWVar19 = pWVar16;
                  local_4c8 = param_4;
                  if ((uVar28 & 0x20) == 0) {
                    local_4cc = 1;
                    if (pWVar16 == (WCHAR *)0x0) {
                      pWVar16 = (WCHAR *)PTR_u__null__18004b420;
                      pWVar19 = (WCHAR *)PTR_u__null__18004b420;
                    }
                    for (; (uVar20 != 0 && (uVar20 = uVar20 - 1, *pWVar16 != L'\0'));
                        pWVar16 = pWVar16 + 1) {
                    }
                    pcVar27 = (char *)((longlong)pWVar16 - (longlong)pWVar19 >> 1 & 0xffffffff);
                  }
                  else {
                    if (pWVar16 == (WCHAR *)0x0) {
                      pWVar19 = pWVar22;
                    }
                    pWVar22 = pWVar19;
                    pcVar27 = pcVar25;
                    if (0 < (int)uVar20) {
                      do {
                        pcVar27 = pcVar25;
                        if ((byte)*pWVar22 == 0) break;
                        uVar13 = FUN_180028e24((uint)(byte)*pWVar22,local_488);
                        if ((int)CONCAT62(extraout_var_00,uVar13) != 0) {
                          pWVar22 = (WCHAR *)((longlong)pWVar22 + 1);
                        }
                        uVar26 = (int)pcVar25 + 1;
                        pcVar25 = (char *)(ulonglong)uVar26;
                        pWVar22 = (WCHAR *)((longlong)pWVar22 + 1);
                        pcVar27 = pcVar25;
                      } while ((int)uVar26 < (int)uVar20);
                    }
                    pcVar21 = (char *)(ulonglong)local_4d8;
                  }
                }
                else {
                  if (WVar29 == L'X') goto LAB_18002446e;
                  if (WVar29 == L'Z') {
                    psVar2 = *(short **)param_4;
                    param_4 = param_4 + 4;
                    local_4c8 = param_4;
                    if ((psVar2 == (short *)0x0) ||
                       (pWVar19 = *(WCHAR **)(psVar2 + 4), pWVar19 == (WCHAR *)0x0)) {
                      pcVar27 = FUN_180026e50((ulonglong *)pWVar22);
                      pWVar19 = pWVar22;
                    }
                    else if (uVar28 >> 0xb == 0) {
                      pcVar27 = (char *)(ulonglong)(uint)(int)*psVar2;
                      local_4cc = 0;
                    }
                    else {
                      local_4cc = 1;
                      pcVar27 = (char *)(ulonglong)(uint)((int)*psVar2 / 2);
                    }
                  }
                  else {
                    if (WVar29 == L'a') goto LAB_1800243c2;
                    if (WVar29 == L'c') goto LAB_180024347;
                  }
                }
              }
            }
LAB_180024308:
            ppuVar23 = local_4a8;
            if (local_4a0 == 0) {
              if (bVar7) {
                if (bVar4) {
                  local_4bc[0] = L'-';
                }
                else {
                  if (!bVar6) {
                    if (bVar10) {
                      local_4bc[0] = L' ';
                      local_4d0 = 1;
                    }
                    goto LAB_18002475a;
                  }
                  local_4bc[0] = L'+';
                }
                local_4d0 = 1;
              }
LAB_18002475a:
              uVar20 = local_4d0;
              iVar14 = (int)pcVar27;
              iVar30 = (local_4c0 - iVar14) - local_4d0;
              if ((uVar28 & 0xc) == 0) {
                FUN_180024b20(L' ',iVar30,local_4a8,(int *)&local_4d8);
              }
              FUN_180024b74(local_4bc,uVar20,ppuVar23,(int *)&local_4d8,(int *)local_460);
              ppuVar23 = local_4a8;
              if (((uVar28 & 8) != 0) && ((uVar28 & 4) == 0)) {
                FUN_180024b20(L'0',iVar30,local_4a8,(int *)&local_4d8);
              }
              if ((local_4cc == 0) && (0 < iVar14)) {
                uVar24 = (ulonglong)pcVar27 & 0xffffffff;
                pWVar22 = pWVar19;
                do {
                  uVar20 = (int)uVar24 - 1;
                  uVar24 = (ulonglong)uVar20;
                  iVar14 = FUN_1800290bc(local_4b8,(byte *)pWVar22,
                                         (longlong)*(int *)(local_488[0] + 0xd4),local_488);
                  if (iVar14 < 1) {
                    pcVar21 = (char *)0xffffffff;
                    local_4d8 = 0xffffffff;
                    ppuVar23 = local_4a8;
                    param_4 = local_4c8;
                    goto LAB_180024860;
                  }
                  FUN_180024ae8(local_4b8[0],local_4a8,(int *)&local_4d8);
                  pWVar22 = (WCHAR *)((longlong)pWVar22 + (longlong)iVar14);
                  ppuVar23 = local_4a8;
                  param_4 = local_4c8;
                } while (0 < (int)uVar20);
              }
              else {
                FUN_180024b74(pWVar19,iVar14,ppuVar23,(int *)&local_4d8,(int *)local_460);
              }
              pcVar21 = (char *)(ulonglong)local_4d8;
LAB_180024860:
              if ((-1 < (int)pcVar21) && ((uVar28 & 4) != 0)) {
                FUN_180024b20(L' ',iVar30,ppuVar23,(int *)&local_4d8);
                pcVar21 = (char *)(ulonglong)local_4d8;
              }
            }
          }
          else {
            if ((ushort)WVar29 < 0x68) {
LAB_1800243c2:
              pWVar19 = local_448;
              if ((int)uVar20 < 0) {
                uVar26 = 6;
LAB_1800243db:
                pWVar19 = local_448;
                iVar14 = 0x200;
                local_4d4 = uVar26;
              }
              else if (uVar20 == 0) {
                iVar14 = 0x200;
                if (WVar29 == L'g') {
                  uVar26 = 1;
                  goto LAB_1800243db;
                }
              }
              else {
                uVar26 = 0xa3;
                if (0x200 < (int)uVar20) {
                  uVar20 = 0x200;
                }
                iVar14 = 0x200;
                local_4d4 = uVar20;
                if (0xa3 < (int)uVar20) {
                  iVar14 = uVar20 + 0x15d;
                  pWVar19 = (WCHAR *)FUN_1800224cc((longlong)iVar14);
                  local_468 = pWVar19;
                  if (pWVar19 == (WCHAR *)0x0) goto LAB_1800243db;
                }
              }
              uVar20 = local_4d4;
              local_458[0] = *(ulonglong *)param_4;
              param_4 = param_4 + 4;
              local_4c8 = param_4;
              pcVar17 = (code *)DecodePointer(PTR_LAB_18004aa50);
              (*pcVar17)(local_458,pWVar19,(longlong)iVar14,(int)(char)WVar29);
              if ((bVar9) && (uVar20 == 0)) {
                pcVar17 = (code *)DecodePointer(PTR_LAB_18004aa68);
                (*pcVar17)(pWVar19,local_488);
              }
              if ((WVar29 == L'g') && (!bVar9)) {
                pcVar17 = (code *)DecodePointer(PTR_LAB_18004aa60);
                (*pcVar17)(pWVar19,local_488);
              }
              if ((char)*pWVar19 == '-') {
                bVar4 = true;
                pWVar19 = (WCHAR *)((longlong)pWVar19 + 1);
              }
              bVar7 = true;
              pcVar27 = FUN_180026e50((ulonglong *)pWVar19);
              pcVar21 = (char *)(ulonglong)local_4d8;
              pcVar27 = (char *)((ulonglong)pcVar27 & 0xffffffff);
              goto LAB_180024308;
            }
            if (WVar29 == L'i') goto LAB_1800244ee;
            if (WVar29 != L'n') {
              if (WVar29 == L'o') {
                iVar14 = 8;
              }
              else {
                if (WVar29 == L'p') {
                  uVar20 = 0x10;
                  bVar8 = true;
LAB_18002446e:
                  local_498 = 7;
                }
                else {
                  if (WVar29 == L's') goto LAB_1800242a1;
                  if (WVar29 == L'u') goto LAB_1800244f2;
                  if (WVar29 != L'x') goto LAB_180024308;
                  local_498 = 0x27;
                }
                iVar14 = 0x10;
              }
              goto LAB_180024502;
            }
            piVar3 = *(int **)param_4;
            param_4 = param_4 + 4;
            local_4c8 = param_4;
            bVar11 = FUN_180028eb0();
            if ((int)CONCAT71(extraout_var,bVar11) == 0) goto LAB_1800240d5;
            if ((uVar28 & 0x20) == 0) {
              *piVar3 = (int)pcVar21;
            }
            else {
              *(short *)piVar3 = (short)pcVar21;
            }
            local_4a0 = 1;
          }
          uVar20 = local_4d4;
          if (local_468 != (WCHAR *)0x0) {
            FUN_18001fcb8(local_468);
            local_468 = (WCHAR *)0x0;
            uVar20 = local_4d4;
          }
          goto LAB_1800248ac;
        }
      }
      pWVar22 = (WCHAR *)PTR_DAT_18004b418;
      WVar29 = *pWVar16;
    }
    if (local_470 != '\0') {
      *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
    }
  }
  FUN_18001fe50(local_48 ^ (ulonglong)auStackY_518);
  return;
}



void FUN_180024ae8(WCHAR param_1,undefined **param_2,int *param_3)

{
  short sVar1;
  
  if ((((ulonglong)param_2[3] & 0x40) == 0) || (param_2[2] != (undefined *)0x0)) {
    sVar1 = FUN_180028ec8(param_1,param_2);
    if (sVar1 == -1) {
      *param_3 = -1;
    }
    else {
      *param_3 = *param_3 + 1;
    }
  }
  else {
    *param_3 = *param_3 + 1;
  }
  return;
}



void FUN_180024b20(WCHAR param_1,int param_2,undefined **param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      FUN_180024ae8(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



void FUN_180024b74(WCHAR *param_1,int param_2,undefined **param_3,int *param_4,int *param_5)

{
  int iVar1;
  
  iVar1 = *param_5;
  if ((((ulonglong)param_3[3] & 0x40) == 0) || (param_3[2] != (undefined *)0x0)) {
    *param_5 = 0;
    if (0 < param_2) {
      do {
        param_2 = param_2 + -1;
        FUN_180024ae8(*param_1,param_3,param_4);
        param_1 = param_1 + 1;
        if (*param_4 == -1) {
          if (*param_5 != 0x2a) break;
          FUN_180024ae8(L'?',param_3,param_4);
        }
      } while (0 < param_2);
      if (*param_5 != 0) {
        return;
      }
    }
    *param_5 = iVar1;
  }
  else {
    *param_4 = *param_4 + param_2;
  }
  return;
}



void FUN_180024c10(int *param_1)

{
  int *piVar1;
  int *piVar2;
  longlong lVar3;
  
  LOCK();
  *param_1 = *param_1 + 1;
  UNLOCK();
  piVar2 = *(int **)(param_1 + 0x36);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = *(int **)(param_1 + 0x3a);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = *(int **)(param_1 + 0x38);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = *(int **)(param_1 + 0x3e);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = param_1 + 10;
  lVar3 = 6;
  do {
    if ((*(undefined **)(piVar2 + -4) != &DAT_18004afc0) &&
       (piVar1 = *(int **)piVar2, piVar1 != (int *)0x0)) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    if ((*(longlong *)(piVar2 + -6) != 0) && (piVar1 = *(int **)(piVar2 + -2), piVar1 != (int *)0x0)
       ) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    piVar2 = piVar2 + 8;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  LOCK();
  *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
       *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + 1;
  UNLOCK();
  return;
}



void FUN_180024c9c(LPVOID param_1)

{
  int *piVar1;
  undefined **ppuVar2;
  longlong lVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;
  
  if ((((*(undefined ***)((longlong)param_1 + 0xf0) != (undefined **)0x0) &&
       (*(undefined ***)((longlong)param_1 + 0xf0) != &PTR_DAT_18004bc70)) &&
      (*(int **)((longlong)param_1 + 0xd8) != (int *)0x0)) &&
     (**(int **)((longlong)param_1 + 0xd8) == 0)) {
    piVar1 = *(int **)((longlong)param_1 + 0xe8);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      FUN_18001fcb8(piVar1);
      FUN_180029218(*(longlong *)((longlong)param_1 + 0xf0));
    }
    piVar1 = *(int **)((longlong)param_1 + 0xe0);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      FUN_18001fcb8(piVar1);
      FUN_180029324(*(undefined8 **)((longlong)param_1 + 0xf0));
    }
    FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0xd8));
    FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0xf0));
  }
  if ((*(int **)((longlong)param_1 + 0xf8) != (int *)0x0) &&
     (**(int **)((longlong)param_1 + 0xf8) == 0)) {
    FUN_18001fcb8((LPVOID)(*(longlong *)((longlong)param_1 + 0x100) + -0xfe));
    FUN_18001fcb8((LPVOID)(*(longlong *)((longlong)param_1 + 0x110) + -0x80));
    FUN_18001fcb8((LPVOID)(*(longlong *)((longlong)param_1 + 0x118) + -0x80));
    FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0xf8));
  }
  ppuVar2 = *(undefined ***)((longlong)param_1 + 0x120);
  if ((ppuVar2 != &PTR_DAT_18004afd0) && (*(int *)((longlong)ppuVar2 + 0x15c) == 0)) {
    FUN_180029390(ppuVar2);
    FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0x120));
  }
  puVar4 = (undefined8 *)((longlong)param_1 + 0x128);
  puVar5 = (undefined8 *)((longlong)param_1 + 0x28);
  lVar3 = 6;
  do {
    if ((((undefined *)puVar5[-2] != &DAT_18004afc0) &&
        (piVar1 = (int *)*puVar5, piVar1 != (int *)0x0)) && (*piVar1 == 0)) {
      FUN_18001fcb8(piVar1);
      FUN_18001fcb8((LPVOID)*puVar4);
    }
    if (((puVar5[-3] != 0) && (piVar1 = (int *)puVar5[-1], piVar1 != (int *)0x0)) && (*piVar1 == 0))
    {
      FUN_18001fcb8(piVar1);
    }
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 4;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  FUN_18001fcb8(param_1);
  return;
}



int * FUN_180024e34(int *param_1)

{
  int *piVar1;
  int *piVar2;
  longlong lVar3;
  
  if (param_1 != (int *)0x0) {
    LOCK();
    *param_1 = *param_1 + -1;
    UNLOCK();
    piVar2 = *(int **)(param_1 + 0x36);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = *(int **)(param_1 + 0x3a);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = *(int **)(param_1 + 0x38);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = *(int **)(param_1 + 0x3e);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = param_1 + 10;
    lVar3 = 6;
    do {
      if ((*(undefined **)(piVar2 + -4) != &DAT_18004afc0) &&
         (piVar1 = *(int **)piVar2, piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
        UNLOCK();
      }
      if ((*(longlong *)(piVar2 + -6) != 0) &&
         (piVar1 = *(int **)(piVar2 + -2), piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
        UNLOCK();
      }
      piVar2 = piVar2 + 8;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    LOCK();
    *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
         *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + -1;
    UNLOCK();
  }
  return param_1;
}



int * FUN_180024ed8(void)

{
  DWORD *pDVar1;
  int *piVar2;
  
  pDVar1 = FUN_180025acc();
  if (((pDVar1[0x32] & DAT_18004b408) == 0) || (*(longlong *)(pDVar1 + 0x30) == 0)) {
    FUN_1800268b0(0xc);
    piVar2 = FUN_180024f50((undefined8 *)(pDVar1 + 0x30),(int *)PTR_DAT_18004b290);
    FUN_180026aa0(0xc);
  }
  else {
    pDVar1 = FUN_180025acc();
    piVar2 = *(int **)(pDVar1 + 0x30);
  }
  if (piVar2 == (int *)0x0) {
    FUN_180021904(0x20);
  }
  return piVar2;
}



int * FUN_180024f50(undefined8 *param_1,int *param_2)

{
  int *piVar1;
  
  if ((param_2 == (int *)0x0) || (param_1 == (undefined8 *)0x0)) {
    param_2 = (int *)0x0;
  }
  else {
    piVar1 = (int *)*param_1;
    if (piVar1 != param_2) {
      *param_1 = param_2;
      FUN_180024c10(param_2);
      if (((piVar1 != (int *)0x0) && (FUN_180024e34(piVar1), *piVar1 == 0)) &&
         (piVar1 != (int *)&DAT_18004b2a0)) {
        FUN_180024c9c(piVar1);
      }
    }
  }
  return param_2;
}



undefined8 FUN_180024fb4(void)

{
  if (DAT_18004edf0 == 0) {
    FUN_18002538c(0xfffffffd);
    DAT_18004edf0 = 1;
  }
  return 0;
}



UINT FUN_180024fdc(UINT param_1)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180021044(local_28,(longlong *)0x0);
  DAT_18004d598 = 0;
  if (param_1 == 0xfffffffe) {
    DAT_18004d598 = 1;
    param_1 = GetOEMCP();
  }
  else if (param_1 == 0xfffffffd) {
    DAT_18004d598 = 1;
    param_1 = GetACP();
  }
  else if (param_1 == 0xfffffffc) {
    DAT_18004d598 = 1;
    param_1 = *(UINT *)(local_28[0] + 4);
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return param_1;
}



void FUN_18002505c(longlong param_1)

{
  longlong lVar1;
  undefined1 *puVar2;
  undefined1 (*pauVar3) [16];
  longlong lVar4;
  undefined2 *puVar5;
  
  pauVar3 = (undefined1 (*) [16])(param_1 + 0x18);
  lVar4 = 0x101;
  FUN_180020400(pauVar3,0,0x101);
  *(undefined8 *)(param_1 + 4) = 0;
  *(undefined8 *)(param_1 + 0x220) = 0;
  puVar5 = (undefined2 *)(param_1 + 0xc);
  for (lVar1 = 6; lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  do {
    (*pauVar3)[0] = *(undefined1 *)(((longlong)&DAT_18004ac90 - param_1) + (longlong)pauVar3);
    pauVar3 = (undefined1 (*) [16])(*pauVar3 + 1);
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  puVar2 = (undefined1 *)(param_1 + 0x119);
  lVar1 = 0x100;
  do {
    *puVar2 = puVar2[(longlong)&DAT_18004ac90 - param_1];
    puVar2 = puVar2 + 1;
    lVar1 = lVar1 + -1;
  } while (lVar1 != 0);
  return;
}



void FUN_1800250ec(longlong param_1)

{
  byte bVar1;
  BOOL BVar2;
  uint uVar3;
  CHAR *pCVar4;
  ulonglong uVar5;
  byte *pbVar6;
  BYTE *pBVar7;
  WORD *pWVar8;
  longlong lVar9;
  undefined1 auStackY_588 [32];
  _cpinfo local_538;
  CHAR local_518 [231];
  byte abStack_431 [25];
  undefined1 local_418 [231];
  byte abStack_331 [25];
  undefined1 local_318 [256];
  WORD local_218 [256];
  ulonglong local_18;
  
  local_18 = DAT_18004a880 ^ (ulonglong)auStackY_588;
  BVar2 = GetCPInfo(*(UINT *)(param_1 + 4),&local_538);
  lVar9 = 0x100;
  if (BVar2 == 0) {
    uVar3 = 0;
    pbVar6 = (byte *)(param_1 + 0x19);
    do {
      if (uVar3 - 0x41 < 0x1a) {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = (char)uVar3 + 0x20;
LAB_180025291:
        pbVar6[0x100] = bVar1;
      }
      else {
        if (uVar3 - 0x61 < 0x1a) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = (char)uVar3 - 0x20;
          goto LAB_180025291;
        }
        pbVar6[0x100] = 0;
      }
      uVar3 = uVar3 + 1;
      pbVar6 = pbVar6 + 1;
    } while (uVar3 < 0x100);
  }
  else {
    uVar3 = 0;
    pCVar4 = local_518;
    do {
      *pCVar4 = (CHAR)uVar3;
      uVar3 = uVar3 + 1;
      pCVar4 = pCVar4 + 1;
    } while (uVar3 < 0x100);
    local_518[0] = ' ';
    pBVar7 = local_538.LeadByte;
    while (local_538.LeadByte[0] != 0) {
      bVar1 = pBVar7[1];
      uVar5 = (ulonglong)local_538.LeadByte[0];
      while ((uVar3 = (uint)uVar5, uVar3 <= bVar1 && (uVar3 < 0x100))) {
        local_518[uVar5] = ' ';
        uVar5 = (ulonglong)(uVar3 + 1);
      }
      pBVar7 = pBVar7 + 2;
      local_538.LeadByte[0] = *pBVar7;
    }
    FUN_180029c88((longlong *)0x0,1,local_518,0x100,local_218,*(UINT *)(param_1 + 4),0);
    FUN_180029a78((longlong *)0x0,*(longlong *)(param_1 + 0x220),0x100,local_518,0x100,local_418,
                  0x100,*(UINT *)(param_1 + 4),0);
    FUN_180029a78((longlong *)0x0,*(longlong *)(param_1 + 0x220),0x200,local_518,0x100,local_318,
                  0x100,*(UINT *)(param_1 + 4),0);
    pWVar8 = local_218;
    pbVar6 = (byte *)(param_1 + 0x19);
    do {
      if ((*pWVar8 & 1) == 0) {
        if ((*pWVar8 & 2) != 0) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = pbVar6[(longlong)(abStack_331 + -param_1)];
          goto LAB_18002524d;
        }
        pbVar6[0x100] = 0;
      }
      else {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = pbVar6[(longlong)(abStack_431 + -param_1)];
LAB_18002524d:
        pbVar6[0x100] = bVar1;
      }
      pbVar6 = pbVar6 + 1;
      pWVar8 = pWVar8 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
  }
  FUN_18001fe50(local_18 ^ (ulonglong)auStackY_588);
  return;
}



int * FUN_1800252d0(void)

{
  DWORD *pDVar1;
  int *piVar2;
  
  pDVar1 = FUN_180025acc();
  if (((pDVar1[0x32] & DAT_18004b408) == 0) || (*(longlong *)(pDVar1 + 0x30) == 0)) {
    FUN_1800268b0(0xd);
    piVar2 = *(int **)(pDVar1 + 0x2e);
    if (piVar2 != (int *)PTR_DAT_18004afb0) {
      if (piVar2 != (int *)0x0) {
        LOCK();
        *piVar2 = *piVar2 + -1;
        UNLOCK();
        if ((*piVar2 == 0) && (piVar2 != &DAT_18004ac90)) {
          FUN_18001fcb8(piVar2);
        }
      }
      *(undefined **)(pDVar1 + 0x2e) = PTR_DAT_18004afb0;
      piVar2 = (int *)PTR_DAT_18004afb0;
      LOCK();
      *(int *)PTR_DAT_18004afb0 = *(int *)PTR_DAT_18004afb0 + 1;
      UNLOCK();
    }
    FUN_180026aa0(0xd);
  }
  else {
    piVar2 = *(int **)(pDVar1 + 0x2e);
  }
  if (piVar2 == (int *)0x0) {
    FUN_180021904(0x20);
  }
  return piVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_18002538c(UINT param_1)

{
  int *piVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  UINT UVar4;
  int iVar5;
  DWORD *pDVar6;
  int *piVar7;
  undefined8 *puVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  longlong lVar12;
  int iVar13;
  
  iVar5 = -1;
  pDVar6 = FUN_180025acc();
  FUN_1800252d0();
  lVar12 = *(longlong *)(pDVar6 + 0x2e);
  UVar4 = FUN_180024fdc(param_1);
  if (UVar4 == *(UINT *)(lVar12 + 4)) {
    iVar5 = 0;
  }
  else {
    piVar7 = (int *)FUN_1800224cc(0x228);
    iVar13 = 0;
    if (piVar7 != (int *)0x0) {
      lVar12 = 4;
      puVar3 = *(undefined8 **)(pDVar6 + 0x2e);
      piVar1 = piVar7;
      do {
        piVar9 = piVar1;
        puVar8 = puVar3;
        uVar2 = puVar8[1];
        *(undefined8 *)piVar9 = *puVar8;
        *(undefined8 *)(piVar9 + 2) = uVar2;
        uVar2 = puVar8[3];
        *(undefined8 *)(piVar9 + 4) = puVar8[2];
        *(undefined8 *)(piVar9 + 6) = uVar2;
        uVar2 = puVar8[5];
        *(undefined8 *)(piVar9 + 8) = puVar8[4];
        *(undefined8 *)(piVar9 + 10) = uVar2;
        uVar2 = puVar8[7];
        *(undefined8 *)(piVar9 + 0xc) = puVar8[6];
        *(undefined8 *)(piVar9 + 0xe) = uVar2;
        uVar2 = puVar8[9];
        *(undefined8 *)(piVar9 + 0x10) = puVar8[8];
        *(undefined8 *)(piVar9 + 0x12) = uVar2;
        uVar2 = puVar8[0xb];
        *(undefined8 *)(piVar9 + 0x14) = puVar8[10];
        *(undefined8 *)(piVar9 + 0x16) = uVar2;
        uVar2 = puVar8[0xd];
        *(undefined8 *)(piVar9 + 0x18) = puVar8[0xc];
        *(undefined8 *)(piVar9 + 0x1a) = uVar2;
        uVar2 = puVar8[0xf];
        *(undefined8 *)(piVar9 + 0x1c) = puVar8[0xe];
        *(undefined8 *)(piVar9 + 0x1e) = uVar2;
        lVar12 = lVar12 + -1;
        puVar3 = puVar8 + 0x10;
        piVar1 = piVar9 + 0x20;
      } while (lVar12 != 0);
      uVar2 = puVar8[0x11];
      *(undefined8 *)(piVar9 + 0x20) = puVar8[0x10];
      *(undefined8 *)(piVar9 + 0x22) = uVar2;
      uVar2 = puVar8[0x13];
      *(undefined8 *)(piVar9 + 0x24) = puVar8[0x12];
      *(undefined8 *)(piVar9 + 0x26) = uVar2;
      *(undefined8 *)(piVar9 + 0x28) = puVar8[0x14];
      *piVar7 = 0;
      iVar5 = FUN_1800255d0(UVar4,(longlong)piVar7);
      if (iVar5 == 0) {
        piVar1 = *(int **)(pDVar6 + 0x2e);
        LOCK();
        *piVar1 = *piVar1 + -1;
        UNLOCK();
        if ((*piVar1 == 0) && (*(undefined4 **)(pDVar6 + 0x2e) != &DAT_18004ac90)) {
          FUN_18001fcb8(*(undefined4 **)(pDVar6 + 0x2e));
        }
        *(int **)(pDVar6 + 0x2e) = piVar7;
        LOCK();
        *piVar7 = *piVar7 + 1;
        UNLOCK();
        if (((pDVar6[0x32] & 2) == 0) && (((byte)DAT_18004b408 & 1) == 0)) {
          FUN_1800268b0(0xd);
          _DAT_18004d578 = piVar7[1];
          _DAT_18004d57c = piVar7[2];
          _DAT_18004d590 = *(undefined8 *)(piVar7 + 0x88);
          for (iVar10 = iVar13; iVar11 = iVar13, iVar10 < 5; iVar10 = iVar10 + 1) {
            *(undefined2 *)(&DAT_18004d580 + (longlong)iVar10 * 2) =
                 *(undefined2 *)((longlong)piVar7 + (longlong)iVar10 * 2 + 0xc);
          }
          for (; iVar11 < 0x101; iVar11 = iVar11 + 1) {
            (&DAT_18004aa80)[iVar11] = *(undefined1 *)((longlong)iVar11 + 0x18 + (longlong)piVar7);
          }
          for (; iVar13 < 0x100; iVar13 = iVar13 + 1) {
            (&DAT_18004ab90)[iVar13] = *(undefined1 *)((longlong)iVar13 + 0x119 + (longlong)piVar7);
          }
          LOCK();
          iVar13 = *(int *)PTR_DAT_18004afb0;
          *(int *)PTR_DAT_18004afb0 = *(int *)PTR_DAT_18004afb0 + -1;
          UNLOCK();
          if ((iVar13 == 1) && ((undefined4 *)PTR_DAT_18004afb0 != &DAT_18004ac90)) {
            FUN_18001fcb8(PTR_DAT_18004afb0);
          }
          LOCK();
          PTR_DAT_18004afb0 = (undefined *)piVar7;
          *piVar7 = *piVar7 + 1;
          UNLOCK();
          FUN_180026aa0(0xd);
        }
      }
      else if (iVar5 == -1) {
        if (piVar7 != &DAT_18004ac90) {
          FUN_18001fcb8(piVar7);
        }
        pDVar6 = FUN_180021688();
        *pDVar6 = 0x16;
      }
    }
  }
  return iVar5;
}



void FUN_1800255d0(UINT param_1,longlong param_2)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  UINT CodePage;
  BOOL BVar4;
  UINT *pUVar5;
  byte *pbVar6;
  wchar_t *pwVar7;
  ulonglong uVar8;
  longlong lVar9;
  undefined2 *puVar10;
  BYTE *pBVar11;
  byte *pbVar12;
  uint uVar13;
  uint uVar15;
  byte *pbVar16;
  undefined1 auStack_68 [32];
  _cpinfo local_48;
  ulonglong local_30;
  wchar_t *pwVar14;
  
  local_30 = DAT_18004a880 ^ (ulonglong)auStack_68;
  CodePage = FUN_180024fdc(param_1);
  pwVar7 = (wchar_t *)0x0;
  if (CodePage != 0) {
    pUVar5 = &DAT_18004aec0;
    pwVar14 = pwVar7;
LAB_180025624:
    if (*pUVar5 != CodePage) goto code_r0x00018002562c;
    FUN_180020400((undefined1 (*) [16])(param_2 + 0x18),0,0x101);
    pbVar16 = &DAT_18004aeb8;
    lVar9 = 4;
    pbVar6 = &DAT_18004aed0 + (longlong)pwVar14 * 0x30;
    do {
      bVar2 = *pbVar6;
      pbVar12 = pbVar6;
      while ((bVar2 != 0 && (pbVar12[1] != 0))) {
        bVar2 = *pbVar12;
        uVar13 = (uint)bVar2;
        if (bVar2 <= pbVar12[1]) {
          uVar15 = (uint)bVar2;
          do {
            uVar15 = uVar15 + 1;
            if (0x100 < uVar15) break;
            uVar13 = uVar13 + 1;
            pbVar1 = (byte *)((ulonglong)uVar15 + 0x18 + param_2);
            *pbVar1 = *pbVar1 | *pbVar16;
          } while (uVar13 <= pbVar12[1]);
        }
        pbVar12 = pbVar12 + 2;
        bVar2 = *pbVar12;
      }
      pbVar6 = pbVar6 + 8;
      pbVar16 = pbVar16 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
    *(UINT *)(param_2 + 4) = CodePage;
    *(undefined4 *)(param_2 + 8) = 1;
    if (CodePage == 0x3a4) {
      pwVar7 = L"ja-JP";
    }
    else if (CodePage == 0x3a8) {
      pwVar7 = L"zh-CN";
    }
    else if (CodePage == 0x3b5) {
      pwVar7 = L"ko-KR";
    }
    else if (CodePage == 0x3b6) {
      pwVar7 = L"zh-TW";
    }
    *(wchar_t **)(param_2 + 0x220) = pwVar7;
    puVar10 = (undefined2 *)(param_2 + 0xc);
    lVar9 = 6;
    do {
      *puVar10 = *(undefined2 *)
                  (&DAT_18004aeb8 + ((longlong)pwVar14 * 0x30 - param_2) + (longlong)puVar10);
      puVar10 = puVar10 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
    goto LAB_18002584e;
  }
LAB_180025605:
  FUN_18002505c(param_2);
LAB_180025858:
  FUN_18001fe50(local_30 ^ (ulonglong)auStack_68);
  return;
code_r0x00018002562c:
  uVar13 = (int)pwVar14 + 1;
  pwVar14 = (wchar_t *)(ulonglong)uVar13;
  pUVar5 = pUVar5 + 0xc;
  if (4 < uVar13) goto code_r0x000180025638;
  goto LAB_180025624;
code_r0x000180025638:
  if ((CodePage - 65000 < 2) || (BVar4 = IsValidCodePage(CodePage & 0xffff), BVar4 == 0))
  goto LAB_180025858;
  BVar4 = GetCPInfo(CodePage,&local_48);
  if (BVar4 != 0) {
    FUN_180020400((undefined1 (*) [16])(param_2 + 0x18),0,0x101);
    *(UINT *)(param_2 + 4) = CodePage;
    *(undefined8 *)(param_2 + 0x220) = 0;
    if (local_48.MaxCharSize < 2) {
      *(undefined4 *)(param_2 + 8) = 0;
    }
    else {
      pBVar11 = local_48.LeadByte;
      while ((local_48.LeadByte[0] != 0 && (pBVar11[1] != 0))) {
        bVar2 = *pBVar11;
        if ((uint)bVar2 <= (uint)pBVar11[1]) {
          pbVar6 = (byte *)(param_2 + 0x18 + (ulonglong)(bVar2 + 1));
          uVar8 = (ulonglong)(((uint)pBVar11[1] - (uint)bVar2) + 1);
          do {
            *pbVar6 = *pbVar6 | 4;
            pbVar6 = pbVar6 + 1;
            uVar8 = uVar8 - 1;
          } while (uVar8 != 0);
        }
        pBVar11 = pBVar11 + 2;
        local_48.LeadByte[0] = *pBVar11;
      }
      pbVar6 = (byte *)(param_2 + 0x1a);
      lVar9 = 0xfe;
      do {
        *pbVar6 = *pbVar6 | 8;
        pbVar6 = pbVar6 + 1;
        lVar9 = lVar9 + -1;
      } while (lVar9 != 0);
      iVar3 = *(int *)(param_2 + 4);
      if (iVar3 == 0x3a4) {
        pwVar7 = L"ja-JP";
      }
      else if (iVar3 == 0x3a8) {
        pwVar7 = L"zh-CN";
      }
      else if (iVar3 == 0x3b5) {
        pwVar7 = L"ko-KR";
      }
      else if (iVar3 == 0x3b6) {
        pwVar7 = L"zh-TW";
      }
      *(wchar_t **)(param_2 + 0x220) = pwVar7;
      *(undefined4 *)(param_2 + 8) = 1;
    }
    puVar10 = (undefined2 *)(param_2 + 0xc);
    for (lVar9 = 6; lVar9 != 0; lVar9 = lVar9 + -1) {
      *puVar10 = 0;
      puVar10 = puVar10 + 1;
    }
LAB_18002584e:
    FUN_1800250ec(param_2);
    goto LAB_180025858;
  }
  if (DAT_18004d598 == 0) goto LAB_180025858;
  goto LAB_180025605;
}



ushort FUN_180025880(int param_1,ushort param_2,longlong *param_3)

{
  ushort uVar1;
  undefined6 extraout_var;
  int iVar2;
  ushort local_res8 [4];
  CHAR local_res20;
  CHAR local_res21;
  undefined1 local_res22;
  longlong local_38 [2];
  longlong local_28;
  char local_20;
  
  FUN_180021044(local_38,param_3);
  if (param_1 + 1U < 0x101) {
    local_res8[0] = *(ushort *)(*(longlong *)(local_38[0] + 0x108) + (longlong)param_1 * 2);
  }
  else {
    uVar1 = FUN_180028e24(param_1 >> 8 & 0xff,local_38);
    iVar2 = 1;
    if ((int)CONCAT62(extraout_var,uVar1) == 0) {
      local_res21 = '\0';
      local_res20 = (CHAR)param_1;
    }
    else {
      local_res22 = 0;
      iVar2 = 2;
      local_res20 = (CHAR)((uint)param_1 >> 8);
      local_res21 = (CHAR)param_1;
    }
    iVar2 = FUN_180029c88(local_38,1,&local_res20,iVar2,local_res8,*(UINT *)(local_38[0] + 4),1);
    if (iVar2 == 0) {
      if (local_20 != '\0') {
        *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
      }
      return 0;
    }
  }
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return local_res8[0] & param_2;
}



void FUN_18002595c(LPVOID param_1)

{
  int *piVar1;
  
  if (param_1 != (LPVOID)0x0) {
    if (*(LPVOID *)((longlong)param_1 + 0x38) != (LPVOID)0x0) {
      FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0x38));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x48) != (LPVOID)0x0) {
      FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0x48));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x58) != (LPVOID)0x0) {
      FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0x58));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x68) != (LPVOID)0x0) {
      FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0x68));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x70) != (LPVOID)0x0) {
      FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0x70));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x78) != (LPVOID)0x0) {
      FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0x78));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x80) != (LPVOID)0x0) {
      FUN_18001fcb8(*(LPVOID *)((longlong)param_1 + 0x80));
    }
    if (*(undefined **)((longlong)param_1 + 0xa0) != &DAT_180041180) {
      FUN_18001fcb8(*(undefined **)((longlong)param_1 + 0xa0));
    }
    FUN_1800268b0(0xd);
    piVar1 = *(int **)((longlong)param_1 + 0xb8);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
      UNLOCK();
      if ((*piVar1 == 0) && (piVar1 != &DAT_18004ac90)) {
        FUN_18001fcb8(piVar1);
      }
    }
    FUN_180026aa0(0xd);
    FUN_1800268b0(0xc);
    piVar1 = *(int **)((longlong)param_1 + 0xc0);
    if (piVar1 != (int *)0x0) {
      FUN_180024e34(piVar1);
      if (((piVar1 != (int *)PTR_DAT_18004b290) && (piVar1 != (int *)&DAT_18004b2a0)) &&
         (*piVar1 == 0)) {
        FUN_180024c9c(piVar1);
      }
    }
    FUN_180026aa0(0xc);
    FUN_18001fcb8(param_1);
  }
  return;
}



void FUN_180025a90(LPVOID param_1)

{
  if (DAT_18004afb8 != 0xffffffff) {
    if (param_1 == (LPVOID)0x0) {
      param_1 = (LPVOID)FUN_1800228d4(DAT_18004afb8);
    }
    FUN_1800228f0(DAT_18004afb8,(LPVOID)0x0);
    FUN_18002595c(param_1);
  }
  return;
}



DWORD * FUN_180025acc(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180025af0();
  if (pDVar1 == (DWORD *)0x0) {
    FUN_180021904(0x10);
  }
  return pDVar1;
}



DWORD * FUN_180025af0(void)

{
  DWORD dwErrCode;
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  dwErrCode = GetLastError();
  pDVar3 = (DWORD *)FUN_1800228d4(DAT_18004afb8);
  if (pDVar3 == (DWORD *)0x0) {
    pDVar3 = (DWORD *)FUN_18002244c(1,0x478);
    if (pDVar3 != (DWORD *)0x0) {
      iVar1 = FUN_1800228f0(DAT_18004afb8,pDVar3);
      if (iVar1 == 0) {
        FUN_18001fcb8(pDVar3);
        pDVar3 = (DWORD *)0x0;
      }
      else {
        FUN_180025b74((longlong)pDVar3,0);
        DVar2 = GetCurrentThreadId();
        pDVar3[2] = 0xffffffff;
        pDVar3[3] = 0xffffffff;
        *pDVar3 = DVar2;
      }
    }
  }
  SetLastError(dwErrCode);
  return pDVar3;
}



void FUN_180025b74(longlong param_1,longlong param_2)

{
  *(undefined **)(param_1 + 0xa0) = &DAT_180041180;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 1;
  *(undefined4 *)(param_1 + 200) = 1;
  *(undefined2 *)(param_1 + 0x164) = 0x43;
  *(undefined2 *)(param_1 + 0x26a) = 0x43;
  *(undefined4 **)(param_1 + 0xb8) = &DAT_18004ac90;
  *(undefined8 *)(param_1 + 0x470) = 0;
  FUN_1800268b0(0xd);
  LOCK();
  **(int **)(param_1 + 0xb8) = **(int **)(param_1 + 0xb8) + 1;
  UNLOCK();
  FUN_180026aa0(0xd);
  FUN_1800268b0(0xc);
  *(longlong *)(param_1 + 0xc0) = param_2;
  if (param_2 == 0) {
    *(undefined **)(param_1 + 0xc0) = PTR_DAT_18004b290;
  }
  FUN_180024c10(*(int **)(param_1 + 0xc0));
  FUN_180026aa0(0xc);
  return;
}



undefined8 FUN_180025c38(void)

{
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  FUN_1800219e0();
  iVar1 = FUN_180026a3c();
  if ((((iVar1 != 0) && (DAT_18004afb8 = FUN_18002289c(), DAT_18004afb8 != 0xffffffff)) &&
      (pDVar3 = (DWORD *)FUN_18002244c(1,0x478), pDVar3 != (DWORD *)0x0)) &&
     (iVar1 = FUN_1800228f0(DAT_18004afb8,pDVar3), iVar1 != 0)) {
    FUN_180025b74((longlong)pDVar3,0);
    DVar2 = GetCurrentThreadId();
    pDVar3[2] = 0xffffffff;
    pDVar3[3] = 0xffffffff;
    *pDVar3 = DVar2;
    return 1;
  }
  FUN_180025cb8();
  return 0;
}



void FUN_180025cb8(void)

{
  if (DAT_18004afb8 != -1) {
    FUN_1800228b8();
    DAT_18004afb8 = -1;
  }
  FUN_1800268f4();
  return;
}



void FUN_180025cdc(void)

{
  if (PTR_DAT_18004b290 != &DAT_18004b2a0) {
    FUN_1800268b0(0xc);
    PTR_DAT_18004b290 = (undefined *)FUN_180024f50(&PTR_DAT_18004b290,(int *)&DAT_18004b2a0);
    FUN_180026aa0(0xc);
  }
  return;
}



undefined4 FUN_180025d24(int param_1,undefined8 param_2)

{
  DWORD DVar1;
  int *piVar2;
  code *pcVar3;
  undefined8 uVar4;
  DWORD *pDVar5;
  int *piVar6;
  longlong lVar7;
  longlong lVar8;
  
  pDVar5 = FUN_180025af0();
  if (pDVar5 != (DWORD *)0x0) {
    piVar2 = *(int **)(pDVar5 + 0x28);
    piVar6 = piVar2;
    do {
      if (*piVar6 == param_1) break;
      piVar6 = piVar6 + 4;
    } while (piVar6 < piVar2 + 0x30);
    if ((piVar2 + 0x30 <= piVar6) || (*piVar6 != param_1)) {
      piVar6 = (int *)0x0;
    }
    if ((piVar6 != (int *)0x0) && (pcVar3 = *(code **)(piVar6 + 2), pcVar3 != (code *)0x0)) {
      if (pcVar3 == (code *)0x5) {
        piVar6[2] = 0;
        piVar6[3] = 0;
        return 1;
      }
      if (pcVar3 != (code *)0x1) {
        uVar4 = *(undefined8 *)(pDVar5 + 0x2a);
        *(undefined8 *)(pDVar5 + 0x2a) = param_2;
        if (piVar6[1] == 8) {
          lVar7 = 0x30;
          do {
            lVar8 = lVar7 + 0x10;
            *(undefined8 *)(lVar7 + 8 + *(longlong *)(pDVar5 + 0x28)) = 0;
            lVar7 = lVar8;
          } while (lVar8 < 0xc0);
          DVar1 = pDVar5[0x2c];
          if (*piVar6 == -0x3fffff72) {
            pDVar5[0x2c] = 0x83;
          }
          else if (*piVar6 == -0x3fffff70) {
            pDVar5[0x2c] = 0x81;
          }
          else if (*piVar6 == -0x3fffff6f) {
            pDVar5[0x2c] = 0x84;
          }
          else if (*piVar6 == -0x3fffff6d) {
            pDVar5[0x2c] = 0x85;
          }
          else if (*piVar6 == -0x3fffff73) {
            pDVar5[0x2c] = 0x82;
          }
          else if (*piVar6 == -0x3fffff71) {
            pDVar5[0x2c] = 0x86;
          }
          else if (*piVar6 == -0x3fffff6e) {
            pDVar5[0x2c] = 0x8a;
          }
          else if (*piVar6 == -0x3ffffd4b) {
            pDVar5[0x2c] = 0x8d;
          }
          else if (*piVar6 == -0x3ffffd4c) {
            pDVar5[0x2c] = 0x8e;
          }
          (*pcVar3)(8,pDVar5[0x2c]);
          pDVar5[0x2c] = DVar1;
        }
        else {
          piVar6[2] = 0;
          piVar6[3] = 0;
          (*pcVar3)(piVar6[1]);
        }
        *(undefined8 *)(pDVar5 + 0x2a) = uVar4;
      }
      return 0xffffffff;
    }
  }
  return 0;
}



undefined4 FUN_180025ef0(int param_1,undefined8 param_2)

{
  undefined4 uVar1;
  
  if (param_1 == -0x1f928c9d) {
    uVar1 = FUN_180025d24(-0x1f928c9d,param_2);
    return uVar1;
  }
  return 0;
}



undefined8 FUN_180025f04(void)

{
  uint uVar1;
  byte bVar2;
  DWORD DVar3;
  undefined8 uVar4;
  HANDLE hFile;
  int iVar5;
  longlong *plVar6;
  byte *pbVar7;
  longlong lVar8;
  byte *pbVar9;
  int iVar10;
  int iVar11;
  undefined1 auStack_d8 [32];
  uint local_b8;
  longlong *local_b0;
  int local_a8;
  byte *local_a0;
  byte *local_98;
  undefined1 *local_90;
  _STARTUPINFOW local_88;
  
  local_90 = auStack_d8;
  FUN_1800268b0(0xb);
  local_b0 = (longlong *)FUN_18002244c(0x20,0x58);
  if (local_b0 == (longlong *)0x0) {
    FUN_1800274f0(auStack_d8,(PVOID)0x180025f68);
    uVar4 = 0xffffffff;
  }
  else {
    DAT_18004eca0 = 0x20;
    DAT_18004d5a0 = local_b0;
    for (; local_b0 < DAT_18004d5a0 + 0x160; local_b0 = local_b0 + 0xb) {
      *(undefined2 *)(local_b0 + 1) = 0xa00;
      *local_b0 = -1;
      *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x7f;
      *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
      *(undefined4 *)(local_b0 + 10) = 0;
      *(undefined1 *)((longlong)local_b0 + 0x4c) = 0;
    }
    GetStartupInfoW(&local_88);
    if ((local_88.cbReserved2 != 0) && ((int *)local_88.lpReserved2 != (int *)0x0)) {
      pbVar9 = (byte *)((longlong)local_88.lpReserved2 + 4);
      pbVar7 = pbVar9 + *(int *)local_88.lpReserved2;
      iVar10 = 0x800;
      if (*(int *)local_88.lpReserved2 < 0x800) {
        iVar10 = *(int *)local_88.lpReserved2;
      }
      iVar5 = 1;
      local_a0 = pbVar9;
      local_98 = pbVar7;
      while ((iVar11 = iVar10, local_a8 = iVar5, DAT_18004eca0 < iVar10 &&
             (local_b0 = (longlong *)FUN_18002244c(0x20,0x58), iVar11 = DAT_18004eca0,
             local_b0 != (longlong *)0x0))) {
        (&DAT_18004d5a0)[iVar5] = local_b0;
        DAT_18004eca0 = DAT_18004eca0 + 0x20;
        for (; local_b0 < (longlong *)((longlong)(&DAT_18004d5a0)[iVar5] + 0xb00);
            local_b0 = local_b0 + 0xb) {
          *(undefined2 *)(local_b0 + 1) = 0xa00;
          *local_b0 = -1;
          *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
          *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
          *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
          *(undefined4 *)(local_b0 + 10) = 0;
          *(undefined1 *)((longlong)local_b0 + 0x4c) = 0;
        }
        iVar5 = iVar5 + 1;
      }
      local_b8 = 0;
      while (uVar1 = local_b8, (int)local_b8 < iVar11) {
        if (((1 < (longlong)*(HANDLE *)pbVar7 + 2U) && ((*pbVar9 & 1) != 0)) &&
           (((*pbVar9 & 8) != 0 || (DVar3 = GetFileType(*(HANDLE *)pbVar7), DVar3 != 0)))) {
          plVar6 = (longlong *)
                   ((ulonglong)(uVar1 & 0x1f) * 0x58 +
                   (longlong)(&DAT_18004d5a0)[(longlong)(int)uVar1 >> 5]);
          *plVar6 = *(longlong *)pbVar7;
          *(byte *)(plVar6 + 1) = *pbVar9;
          local_b0 = plVar6;
          FUN_18002290c((LPCRITICAL_SECTION)(plVar6 + 2),4000);
          *(int *)((longlong)plVar6 + 0xc) = *(int *)((longlong)plVar6 + 0xc) + 1;
        }
        pbVar9 = pbVar9 + 1;
        pbVar7 = pbVar7 + 8;
        local_a0 = pbVar9;
        local_98 = pbVar7;
        local_b8 = uVar1 + 1;
      }
    }
    local_b8 = 0;
    while (uVar1 = local_b8, (int)local_b8 < 3) {
      lVar8 = (longlong)(int)local_b8;
      plVar6 = DAT_18004d5a0 + lVar8 * 0xb;
      local_b0 = plVar6;
      if (*plVar6 + 2U < 2) {
        *(undefined1 *)(plVar6 + 1) = 0x81;
        DVar3 = 0xfffffff5 - (local_b8 != 1);
        if (local_b8 == 0) {
          DVar3 = 0xfffffff6;
        }
        hFile = GetStdHandle(DVar3);
        if (((longlong)hFile + 1U < 2) || (DVar3 = GetFileType(hFile), DVar3 == 0)) {
          *(byte *)(plVar6 + 1) = *(byte *)(plVar6 + 1) | 0x40;
          *plVar6 = -2;
          if (DAT_18004dc90 != 0) {
            *(undefined4 *)(*(longlong *)(DAT_18004dc90 + lVar8 * 8) + 0x1c) = 0xfffffffe;
          }
        }
        else {
          *plVar6 = (longlong)hFile;
          if ((DVar3 & 0xff) == 2) {
            bVar2 = *(byte *)(plVar6 + 1) | 0x40;
LAB_1800261be:
            *(byte *)(plVar6 + 1) = bVar2;
          }
          else if ((DVar3 & 0xff) == 3) {
            bVar2 = *(byte *)(plVar6 + 1) | 8;
            goto LAB_1800261be;
          }
          FUN_18002290c((LPCRITICAL_SECTION)(plVar6 + 2),4000);
          *(int *)((longlong)plVar6 + 0xc) = *(int *)((longlong)plVar6 + 0xc) + 1;
        }
      }
      else {
        *(byte *)(plVar6 + 1) = *(byte *)(plVar6 + 1) | 0x80;
      }
      local_b8 = uVar1 + 1;
    }
    FUN_180026aa0(0xb);
    uVar4 = 0;
  }
  return uVar4;
}



void FUN_180026234(void)

{
  ulonglong uVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong *puVar4;
  
  puVar4 = &DAT_18004d5a0;
  lVar3 = 0x40;
  do {
    uVar2 = *puVar4;
    uVar1 = uVar2;
    if (uVar2 != 0) {
      for (; uVar2 < uVar1 + 0xb00; uVar2 = uVar2 + 0x58) {
        if (*(int *)(uVar2 + 0xc) != 0) {
          DeleteCriticalSection((LPCRITICAL_SECTION)(uVar2 + 0x10));
        }
        uVar1 = *puVar4;
      }
      FUN_18001fcb8((LPVOID)*puVar4);
      *puVar4 = 0;
    }
    puVar4 = puVar4 + 1;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_1800262a8(void)

{
  ulonglong uVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  byte *pbVar4;
  ulonglong uVar5;
  int local_res8 [2];
  int local_res10 [2];
  
  if (DAT_18004edf0 == 0) {
    FUN_180024fb4();
  }
  DAT_18004d8a4 = 0;
  GetModuleFileNameA((HMODULE)0x0,&DAT_18004d7a0,0x104);
  _DAT_18004cee8 = &DAT_18004d7a0;
  if ((DAT_18004edf8 == (byte *)0x0) || (pbVar4 = DAT_18004edf8, *DAT_18004edf8 == 0)) {
    pbVar4 = &DAT_18004d7a0;
  }
  FUN_18002639c(pbVar4,(undefined8 *)0x0,(byte *)0x0,local_res8,local_res10);
  uVar5 = (ulonglong)local_res8[0];
  if ((((uVar5 < 0x1fffffffffffffff) &&
       (uVar3 = (ulonglong)local_res10[0], uVar3 != 0xffffffffffffffff)) &&
      (uVar1 = uVar3 + uVar5 * 8, uVar3 <= uVar1)) &&
     (puVar2 = (undefined8 *)FUN_1800224cc(uVar1), puVar2 != (undefined8 *)0x0)) {
    FUN_18002639c(pbVar4,puVar2,(byte *)(puVar2 + uVar5),local_res8,local_res10);
    _DAT_18004cec4 = local_res8[0] + -1;
    DAT_18004cec8 = puVar2;
    return 0;
  }
  return 0xffffffff;
}



void FUN_18002639c(byte *param_1,undefined8 *param_2,byte *param_3,int *param_4,int *param_5)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  uint uVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte bVar7;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (undefined8 *)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  bVar2 = false;
  do {
    if (*param_1 == 0x22) {
      bVar2 = !bVar2;
      bVar7 = 0x22;
      pbVar5 = param_1 + 1;
    }
    else {
      *param_5 = *param_5 + 1;
      if (param_3 != (byte *)0x0) {
        *param_3 = *param_1;
        param_3 = param_3 + 1;
      }
      bVar7 = *param_1;
      pbVar5 = param_1 + 1;
      iVar3 = FUN_180029f20((uint)bVar7);
      if (iVar3 != 0) {
        *param_5 = *param_5 + 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        pbVar5 = param_1 + 2;
      }
      if (bVar7 == 0) {
        pbVar5 = pbVar5 + -1;
        goto LAB_18002644e;
      }
    }
    param_1 = pbVar5;
  } while ((bVar2) || ((bVar7 != 0x20 && (bVar7 != 9))));
  if (param_3 != (byte *)0x0) {
    param_3[-1] = 0;
  }
LAB_18002644e:
  bVar2 = false;
  while (pbVar6 = pbVar5, *pbVar5 != 0) {
    for (; (*pbVar6 == 0x20 || (*pbVar6 == 9)); pbVar6 = pbVar6 + 1) {
    }
    if (*pbVar6 == 0) break;
    if (param_2 != (undefined8 *)0x0) {
      *param_2 = param_3;
      param_2 = param_2 + 1;
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      bVar1 = true;
      uVar4 = 0;
      for (; *pbVar6 == 0x5c; pbVar6 = pbVar6 + 1) {
        uVar4 = uVar4 + 1;
      }
      pbVar5 = pbVar6;
      if (*pbVar6 == 0x22) {
        if (((uVar4 & 1) == 0) && ((!bVar2 || (pbVar5 = pbVar6 + 1, *pbVar5 != 0x22)))) {
          bVar1 = false;
          bVar2 = !bVar2;
          pbVar5 = pbVar6;
        }
        uVar4 = uVar4 >> 1;
      }
      while (uVar4 != 0) {
        uVar4 = uVar4 - 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = 0x5c;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      bVar7 = *pbVar5;
      if ((bVar7 == 0) || ((!bVar2 && ((bVar7 == 0x20 || (bVar7 == 9)))))) break;
      if (bVar1) {
        iVar3 = FUN_180029f20((int)(char)bVar7);
        if (param_3 == (byte *)0x0) {
          if (iVar3 != 0) {
            pbVar5 = pbVar5 + 1;
            *param_5 = *param_5 + 1;
          }
        }
        else {
          if (iVar3 != 0) {
            bVar7 = *pbVar5;
            pbVar5 = pbVar5 + 1;
            *param_3 = bVar7;
            param_3 = param_3 + 1;
            *param_5 = *param_5 + 1;
          }
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      pbVar6 = pbVar5 + 1;
    }
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    *param_5 = *param_5 + 1;
  }
  if (param_2 != (undefined8 *)0x0) {
    *param_2 = 0;
  }
  *param_4 = *param_4 + 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180026564(void)

{
  char cVar1;
  code *pcVar2;
  DWORD DVar3;
  char *pcVar4;
  undefined1 *puVar5;
  undefined8 uVar6;
  ulonglong *puVar7;
  int iVar8;
  undefined8 *puVar9;
  
  if (DAT_18004edf0 == 0) {
    FUN_180024fb4();
  }
  iVar8 = 0;
  puVar7 = DAT_18004cea0;
  if (DAT_18004cea0 != (ulonglong *)0x0) {
    for (; (char)*puVar7 != '\0'; puVar7 = (ulonglong *)(pcVar4 + (longlong)puVar7 + 1)) {
      if ((char)*puVar7 != '=') {
        iVar8 = iVar8 + 1;
      }
      pcVar4 = FUN_180026e50(puVar7);
    }
    DAT_18004ced8 = (undefined8 *)FUN_18002244c((longlong)(iVar8 + 1),8);
    if (DAT_18004ced8 != (undefined8 *)0x0) {
      cVar1 = (char)*DAT_18004cea0;
      puVar9 = DAT_18004ced8;
      puVar7 = DAT_18004cea0;
      do {
        if (cVar1 == '\0') {
          FUN_18001fcb8(DAT_18004cea0);
          DAT_18004cea0 = (ulonglong *)0x0;
          *puVar9 = 0;
          _DAT_18004edf4 = 1;
          return 0;
        }
        pcVar4 = FUN_180026e50(puVar7);
        iVar8 = (int)pcVar4 + 1;
        if ((char)*puVar7 != '=') {
          puVar5 = (undefined1 *)FUN_18002244c((longlong)iVar8,1);
          *puVar9 = puVar5;
          if (puVar5 == (undefined1 *)0x0) {
            FUN_18001fcb8(DAT_18004ced8);
            DAT_18004ced8 = (undefined8 *)0x0;
            return 0xffffffff;
          }
          DVar3 = FUN_180027388(puVar5,(longlong)iVar8,(char *)puVar7);
          if (DVar3 != 0) {
            FUN_180023e88();
            pcVar2 = (code *)swi(3);
            uVar6 = (*pcVar2)();
            return uVar6;
          }
          puVar9 = puVar9 + 1;
        }
        puVar7 = (ulonglong *)((longlong)puVar7 + (longlong)iVar8);
        cVar1 = (char)*puVar7;
      } while( true );
    }
  }
  return 0xffffffff;
}



void FUN_180026698(void)

{
  DWORD DVar1;
  _FILETIME local_res8;
  _FILETIME local_res10;
  LARGE_INTEGER local_res18;
  
  local_res10.dwLowDateTime = 0;
  local_res10.dwHighDateTime = 0;
  if (DAT_18004a880 == 0x2b992ddfa232) {
    GetSystemTimeAsFileTime(&local_res10);
    local_res8 = local_res10;
    DVar1 = GetCurrentThreadId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    DVar1 = GetCurrentProcessId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    QueryPerformanceCounter(&local_res18);
    DAT_18004a880 =
         ((ulonglong)local_res18.s.LowPart << 0x20 ^
          CONCAT44(local_res18.s.HighPart,local_res18.s.LowPart) ^ (ulonglong)local_res8 ^
         (ulonglong)&local_res8) & 0xffffffffffff;
    if (DAT_18004a880 == 0x2b992ddfa232) {
      DAT_18004a880 = 0x2b992ddfa233;
    }
  }
  DAT_18004a888 = ~DAT_18004a880;
  return;
}



undefined8 FUN_180026744(void)

{
  return 1;
}



LPSTR FUN_18002674c(void)

{
  WCHAR WVar1;
  int cbMultiByte;
  int iVar2;
  LPWCH lpWideCharStr;
  LPSTR lpMultiByteStr;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  
  lpWideCharStr = GetEnvironmentStringsW();
  if (lpWideCharStr != (LPWCH)0x0) {
    WVar1 = *lpWideCharStr;
    pWVar3 = lpWideCharStr;
    while (WVar1 != L'\0') {
      do {
        pWVar4 = pWVar3;
        pWVar3 = pWVar4 + 1;
      } while (*pWVar3 != L'\0');
      pWVar3 = pWVar4 + 2;
      WVar1 = *pWVar3;
    }
    iVar2 = (int)((longlong)pWVar3 - (longlong)lpWideCharStr >> 1);
    cbMultiByte = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,(LPSTR)0x0,0,(LPCSTR)0x0,
                                      (LPBOOL)0x0);
    if ((cbMultiByte != 0) &&
       (lpMultiByteStr = (LPSTR)FUN_1800224cc((longlong)cbMultiByte), lpMultiByteStr != (LPSTR)0x0))
    {
      iVar2 = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,lpMultiByteStr,cbMultiByte,(LPCSTR)0x0
                                  ,(LPBOOL)0x0);
      if (iVar2 == 0) {
        FUN_18001fcb8(lpMultiByteStr);
        lpMultiByteStr = (LPSTR)0x0;
      }
      FreeEnvironmentStringsW(lpWideCharStr);
      return lpMultiByteStr;
    }
    FreeEnvironmentStringsW(lpWideCharStr);
  }
  return (LPSTR)0x0;
}



void FUN_180026840(void)

{
  undefined8 *puVar1;
  
  for (puVar1 = &DAT_180045f10; puVar1 < &DAT_180045f10; puVar1 = puVar1 + 1) {
    if ((code *)*puVar1 != (code *)0x0) {
      (*(code *)*puVar1)();
    }
  }
  return;
}



void FUN_180026878(void)

{
  undefined8 *puVar1;
  
  for (puVar1 = &DAT_180045f20; puVar1 < &DAT_180045f20; puVar1 = puVar1 + 1) {
    if ((code *)*puVar1 != (code *)0x0) {
      (*(code *)*puVar1)();
    }
  }
  return;
}



void FUN_1800268b0(int param_1)

{
  undefined8 uVar1;
  
  if ((&DAT_18004b490)[(longlong)param_1 * 2] == 0) {
    uVar1 = FUN_18002697c(param_1);
    if ((int)uVar1 == 0) {
      FUN_180021904(0x11);
    }
  }
                    // WARNING: Could not recover jumptable at 0x0001800268ed. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(&DAT_18004b490)[(longlong)param_1 * 2]);
  return;
}



void FUN_1800268f4(void)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined8 *puVar1;
  int *piVar2;
  longlong lVar3;
  longlong lVar4;
  
  lVar4 = 0x24;
  puVar1 = &DAT_18004b490;
  lVar3 = 0x24;
  do {
    lpCriticalSection = (LPCRITICAL_SECTION)*puVar1;
    if ((lpCriticalSection != (LPCRITICAL_SECTION)0x0) && (*(int *)(puVar1 + 1) != 1)) {
      DeleteCriticalSection(lpCriticalSection);
      FUN_18001fcb8(lpCriticalSection);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 2;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  piVar2 = &DAT_18004b498;
  do {
    if ((*(LPCRITICAL_SECTION *)(piVar2 + -2) != (LPCRITICAL_SECTION)0x0) && (*piVar2 == 1)) {
      DeleteCriticalSection(*(LPCRITICAL_SECTION *)(piVar2 + -2));
    }
    piVar2 = piVar2 + 4;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return;
}



undefined8 FUN_18002697c(int param_1)

{
  LPCRITICAL_SECTION p_Var1;
  DWORD *pDVar2;
  longlong lVar3;
  
  lVar3 = (longlong)param_1;
  if (DAT_18004ceb0 == 0) {
    FUN_180021c78();
    FUN_180021cec(0x1e);
    FUN_1800217a4(0xff);
  }
  if ((&DAT_18004b490)[lVar3 * 2] == 0) {
    p_Var1 = (LPCRITICAL_SECTION)FUN_1800224cc(0x28);
    if (p_Var1 == (LPCRITICAL_SECTION)0x0) {
      pDVar2 = FUN_180021688();
      *pDVar2 = 0xc;
      return 0;
    }
    FUN_1800268b0(10);
    if ((&DAT_18004b490)[lVar3 * 2] == 0) {
      FUN_18002290c(p_Var1,4000);
      (&DAT_18004b490)[lVar3 * 2] = p_Var1;
    }
    else {
      FUN_18001fcb8(p_Var1);
    }
    LeaveCriticalSection(DAT_18004b530);
  }
  return 1;
}



undefined4 FUN_180026a3c(void)

{
  longlong lVar1;
  undefined8 *puVar2;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  puVar2 = &DAT_18004b490;
  lVar4 = 0x24;
  do {
    if (*(int *)(puVar2 + 1) == 1) {
      lVar1 = (longlong)iVar3;
      iVar3 = iVar3 + 1;
      *puVar2 = (LPCRITICAL_SECTION)(&DAT_18004d8b0 + lVar1 * 0x28);
      FUN_18002290c((LPCRITICAL_SECTION)(&DAT_18004d8b0 + lVar1 * 0x28),4000);
    }
    puVar2 = puVar2 + 2;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return 1;
}



void FUN_180026aa0(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x000180026ab1. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(&DAT_18004b490)[(longlong)param_1 * 2]);
  return;
}



longlong FUN_180026ac0(longlong param_1,ulonglong param_2)

{
  longlong lVar1;
  longlong lVar2;
  uint uVar3;
  
  uVar3 = 0;
  lVar2 = *(int *)(param_1 + 0x3c) + param_1;
  lVar1 = (ulonglong)*(ushort *)(lVar2 + 0x14) + 0x18 + lVar2;
  if (*(ushort *)(lVar2 + 6) != 0) {
    do {
      if ((*(uint *)(lVar1 + 0xc) <= param_2) &&
         (param_2 < *(int *)(lVar1 + 8) + *(uint *)(lVar1 + 0xc))) {
        return lVar1;
      }
      uVar3 = uVar3 + 1;
      lVar1 = lVar1 + 0x28;
    } while (uVar3 < *(ushort *)(lVar2 + 6));
  }
  return 0;
}



ulonglong FUN_180026b10(longlong param_1)

{
  bool bVar1;
  undefined7 extraout_var;
  ulonglong uVar2;
  
  bVar1 = FUN_180026b60((short *)&IMAGE_DOS_HEADER_180000000);
  uVar2 = CONCAT71(extraout_var,bVar1);
  if ((int)uVar2 != 0) {
    uVar2 = FUN_180026ac0(0x180000000,param_1 - 0x180000000);
    if (uVar2 != 0) {
      uVar2 = (ulonglong)(~(*(uint *)(uVar2 + 0x24) >> 0x1f) & 1);
    }
  }
  return uVar2;
}



bool FUN_180026b60(short *param_1)

{
  bool bVar1;
  
  if (*param_1 != 0x5a4d) {
    return false;
  }
  bVar1 = false;
  if (*(int *)((longlong)*(int *)(param_1 + 0x1e) + (longlong)param_1) == 0x4550) {
    bVar1 = (short)((int *)((longlong)*(int *)(param_1 + 0x1e) + (longlong)param_1))[6] == 0x20b;
  }
  return bVar1;
}



void FUN_180026b90(void)

{
  code *pcVar1;
  DWORD *pDVar2;
  
  pDVar2 = FUN_180025acc();
  if (*(code **)(pDVar2 + 0x34) != (code *)0x0) {
    (**(code **)(pDVar2 + 0x34))();
  }
  FUN_180023ca4();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180026bb0(void)

{
  _DAT_18004dae0 = EncodePointer(FUN_180026b90);
  return;
}



void FUN_180026bd0(void)

{
                    // WARNING: Could not recover jumptable at 0x000180026bd7. Too many branches
                    // WARNING: Treating indirect jump as call
  DecodePointer(DAT_18004daf8);
  return;
}



void FUN_180026be0(undefined8 param_1)

{
  DAT_18004dae8 = param_1;
  DAT_18004daf0 = param_1;
  DAT_18004daf8 = param_1;
  DAT_18004db00 = param_1;
  return;
}



undefined8 FUN_180026c00(uint param_1)

{
  ulonglong uVar1;
  bool bVar2;
  DWORD *pDVar3;
  code *pcVar4;
  undefined8 uVar5;
  PVOID pvVar6;
  ulonglong uVar7;
  int iVar8;
  undefined8 *puVar9;
  DWORD local_res10;
  
  uVar5 = 0;
  local_res10 = 0;
  bVar2 = false;
  pDVar3 = (DWORD *)0x0;
  if (param_1 == 2) {
    puVar9 = &DAT_18004dae8;
    pvVar6 = DAT_18004dae8;
    goto LAB_180026d06;
  }
  if (param_1 == 4) {
LAB_180026c9b:
    pDVar3 = FUN_180025af0();
    if (pDVar3 == (DWORD *)0x0) {
      return 0xffffffff;
    }
    uVar1 = *(ulonglong *)(pDVar3 + 0x28);
    uVar7 = uVar1;
    do {
      if (*(uint *)(uVar7 + 4) == param_1) break;
      uVar7 = uVar7 + 0x10;
    } while (uVar7 < uVar1 + 0xc0);
    if ((uVar1 + 0xc0 <= uVar7) || (*(uint *)(uVar7 + 4) != param_1)) {
      uVar7 = 0;
    }
    puVar9 = (undefined8 *)(uVar7 + 8);
    pcVar4 = (code *)*puVar9;
  }
  else {
    if (param_1 == 6) {
LAB_180026c8b:
      puVar9 = &DAT_18004daf8;
      pvVar6 = DAT_18004daf8;
    }
    else {
      if ((param_1 == 8) || (param_1 == 0xb)) goto LAB_180026c9b;
      if (param_1 == 0xf) {
        puVar9 = &DAT_18004db00;
        pvVar6 = DAT_18004db00;
      }
      else {
        if (param_1 != 0x15) {
          if (param_1 != 0x16) {
            pDVar3 = FUN_180021688();
            *pDVar3 = 0x16;
            FUN_180023e68();
            return 0xffffffff;
          }
          goto LAB_180026c8b;
        }
        puVar9 = &DAT_18004daf0;
        pvVar6 = DAT_18004daf0;
      }
    }
LAB_180026d06:
    bVar2 = true;
    pcVar4 = (code *)DecodePointer(pvVar6);
  }
  if (pcVar4 == (code *)0x1) {
    return 0;
  }
  if (pcVar4 == (code *)0x0) {
    FUN_1800219d4(3);
    pcVar4 = (code *)swi(3);
    uVar5 = (*pcVar4)();
    return uVar5;
  }
  if (bVar2) {
    FUN_1800268b0(0);
  }
  if ((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) {
    uVar5 = *(undefined8 *)(pDVar3 + 0x2a);
    pDVar3[0x2a] = 0;
    pDVar3[0x2b] = 0;
    if (param_1 == 8) {
      local_res10 = pDVar3[0x2c];
      pDVar3[0x2c] = 0x8c;
      goto LAB_180026d7e;
    }
  }
  else {
LAB_180026d7e:
    if (param_1 == 8) {
      for (iVar8 = 3; iVar8 < 0xc; iVar8 = iVar8 + 1) {
        *(undefined8 *)(*(longlong *)(pDVar3 + 0x28) + 8 + (longlong)iVar8 * 0x10) = 0;
      }
      goto LAB_180026dc7;
    }
  }
  pvVar6 = EncodePointer((PVOID)0x0);
  *puVar9 = pvVar6;
LAB_180026dc7:
  if (bVar2) {
    FUN_180026aa0(0);
  }
  if (param_1 == 8) {
    (*pcVar4)(8,pDVar3[0x2c]);
  }
  else {
    (*pcVar4)(param_1);
  }
  if (((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) &&
     (*(undefined8 *)(pDVar3 + 0x2a) = uVar5, param_1 == 8)) {
    pDVar3[0x2c] = local_res10;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180026e34(undefined8 param_1)

{
  _DAT_18004db10 = param_1;
  return;
}



char * FUN_180026e50(ulonglong *param_1)

{
  ulonglong uVar1;
  ulonglong *puVar2;
  longlong lVar3;
  
  lVar3 = -(longlong)param_1;
  uVar1 = (ulonglong)param_1 & 7;
  while (uVar1 != 0) {
    uVar1 = *param_1;
    param_1 = (ulonglong *)((longlong)param_1 + 1);
    if ((char)uVar1 == '\0') goto LAB_180026ec8;
    uVar1 = (ulonglong)param_1 & 7;
  }
  do {
    do {
      puVar2 = param_1;
      param_1 = puVar2 + 1;
    } while (((~*puVar2 ^ *puVar2 + 0x7efefefefefefeff) & 0x8101010101010100) == 0);
    uVar1 = *puVar2;
    if ((char)uVar1 == '\0') {
      return (char *)(lVar3 + -8 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 8) == '\0') {
      return (char *)(lVar3 + -7 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x10) == '\0') {
      return (char *)(lVar3 + -6 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x18) == '\0') {
      return (char *)(lVar3 + -5 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x20) == '\0') {
      return (char *)(lVar3 + -4 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x28) == '\0') {
      return (char *)(lVar3 + -3 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x30) == '\0') {
      return (char *)(lVar3 + -2 + (longlong)param_1);
    }
  } while ((char)(uVar1 >> 0x38) != '\0');
LAB_180026ec8:
  return (char *)(lVar3 + -1 + (longlong)param_1);
}



DWORD FUN_180026ef8(short *param_1,longlong param_2,short *param_3)

{
  short sVar1;
  DWORD *pDVar2;
  short *psVar3;
  longlong lVar4;
  DWORD DVar5;
  
  if ((param_1 != (short *)0x0) && (param_2 != 0)) {
    psVar3 = param_1;
    if (param_3 == (short *)0x0) {
      *param_1 = 0;
    }
    else {
      do {
        if (*psVar3 == 0) break;
        psVar3 = psVar3 + 1;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        lVar4 = (longlong)psVar3 - (longlong)param_3;
        do {
          sVar1 = *param_3;
          *(short *)(lVar4 + (longlong)param_3) = sVar1;
          param_3 = param_3 + 1;
          if (sVar1 == 0) break;
          param_2 = param_2 + -1;
        } while (param_2 != 0);
        if (param_2 != 0) {
          return 0;
        }
        *param_1 = 0;
        pDVar2 = FUN_180021688();
        DVar5 = 0x22;
        goto LAB_180026f21;
      }
      *param_1 = 0;
    }
  }
  pDVar2 = FUN_180021688();
  DVar5 = 0x16;
LAB_180026f21:
  *pDVar2 = DVar5;
  FUN_180023e68();
  return DVar5;
}



DWORD FUN_180026f80(undefined2 *param_1,longlong param_2,short *param_3)

{
  short sVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  longlong lVar4;
  
  if ((param_1 != (undefined2 *)0x0) && (param_2 != 0)) {
    if (param_3 != (short *)0x0) {
      lVar4 = (longlong)param_1 - (longlong)param_3;
      do {
        sVar1 = *param_3;
        *(short *)(lVar4 + (longlong)param_3) = sVar1;
        param_3 = param_3 + 1;
        if (sVar1 == 0) break;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        return 0;
      }
      *param_1 = 0;
      pDVar2 = FUN_180021688();
      DVar3 = 0x22;
      goto LAB_180026fa6;
    }
    *param_1 = 0;
  }
  pDVar2 = FUN_180021688();
  DVar3 = 0x16;
LAB_180026fa6:
  *pDVar2 = DVar3;
  FUN_180023e68();
  return DVar3;
}



longlong FUN_180026fec(short *param_1)

{
  short sVar1;
  short *psVar2;
  
  psVar2 = param_1;
  do {
    sVar1 = *psVar2;
    psVar2 = psVar2 + 1;
  } while (sVar1 != 0);
  return ((longlong)psVar2 - (longlong)param_1 >> 1) + -1;
}



DWORD FUN_180027008(short *param_1,longlong param_2,short *param_3,longlong param_4)

{
  short sVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  longlong lVar4;
  longlong lVar5;
  short *psVar6;
  
  if (param_4 == 0) {
    if (param_1 == (short *)0x0) {
      if (param_2 == 0) {
        return 0;
      }
    }
    else {
LAB_180027028:
      if (param_2 != 0) {
        if (param_4 == 0) {
          *param_1 = 0;
          return 0;
        }
        if (param_3 != (short *)0x0) {
          lVar4 = param_2;
          if (param_4 == -1) {
            lVar5 = (longlong)param_1 - (longlong)param_3;
            do {
              sVar1 = *param_3;
              *(short *)(lVar5 + (longlong)param_3) = sVar1;
              param_3 = param_3 + 1;
              if (sVar1 == 0) break;
              lVar4 = lVar4 + -1;
            } while (lVar4 != 0);
          }
          else {
            psVar6 = param_1;
            do {
              sVar1 = *(short *)(((longlong)param_3 - (longlong)param_1) + (longlong)psVar6);
              *psVar6 = sVar1;
              psVar6 = psVar6 + 1;
              if ((sVar1 == 0) || (lVar4 = lVar4 + -1, lVar4 == 0)) break;
              param_4 = param_4 + -1;
            } while (param_4 != 0);
            if (param_4 == 0) {
              *psVar6 = 0;
            }
          }
          if (lVar4 != 0) {
            return 0;
          }
          if (param_4 == -1) {
            param_1[param_2 + -1] = 0;
            return 0x50;
          }
          *param_1 = 0;
          pDVar2 = FUN_180021688();
          DVar3 = 0x22;
          goto LAB_180027049;
        }
        *param_1 = 0;
      }
    }
  }
  else if (param_1 != (short *)0x0) goto LAB_180027028;
  pDVar2 = FUN_180021688();
  DVar3 = 0x16;
LAB_180027049:
  *pDVar2 = DVar3;
  FUN_180023e68();
  return DVar3;
}



int FUN_1800270d4(int param_1)

{
  int iVar1;
  int iVar2;
  DWORD *pDVar3;
  
  if ((param_1 < 0) ||
     ((iVar2 = DAT_18004db28, iVar1 = param_1, 2 < param_1 && (iVar1 = DAT_18004db28, param_1 != 3))
     )) {
    pDVar3 = FUN_180021688();
    *pDVar3 = 0x16;
    FUN_180023e68();
    iVar2 = -1;
    iVar1 = DAT_18004db28;
  }
  DAT_18004db28 = iVar1;
  return iVar2;
}



void FUN_180027114(LPCWSTR param_1,undefined8 param_2,uint param_3)

{
  bool bVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  PVOID pvVar5;
  undefined7 extraout_var;
  HMODULE hModule;
  FARPROC pFVar6;
  code *pcVar7;
  code *pcVar8;
  longlong lVar9;
  longlong lVar10;
  undefined1 auStack_88 [32];
  undefined1 *local_68;
  undefined1 local_58 [8];
  undefined1 local_50 [8];
  byte local_48;
  ulonglong local_40;
  
  local_40 = DAT_18004a880 ^ (ulonglong)auStack_88;
  pvVar5 = EncodePointer((PVOID)0x0);
  lVar10 = 0;
  bVar1 = FUN_180022938();
  if (DAT_18004db30 == (PVOID)0x0) {
    hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0x800);
    if (((hModule == (HMODULE)0x0) &&
        ((DVar2 = GetLastError(), DVar2 != 0x57 ||
         (hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0), hModule == (HMODULE)0x0)))) ||
       (pFVar6 = GetProcAddress(hModule,"MessageBoxW"), pFVar6 == (FARPROC)0x0)) goto LAB_18002736b;
    DAT_18004db30 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetActiveWindow");
    DAT_18004db38 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetLastActivePopup");
    DAT_18004db40 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetUserObjectInformationW");
    DAT_18004db50 = EncodePointer(pFVar6);
    if (DAT_18004db50 != (PVOID)0x0) {
      pFVar6 = GetProcAddress(hModule,"GetProcessWindowStation");
      DAT_18004db48 = EncodePointer(pFVar6);
    }
  }
  BVar3 = IsDebuggerPresent();
  iVar4 = (int)CONCAT71(extraout_var,bVar1);
  if (BVar3 == 0) {
    if (iVar4 != 0) {
      DecodePointer(DAT_18004db30);
      goto LAB_18002736b;
    }
  }
  else {
    if (param_1 != (LPCWSTR)0x0) {
      OutputDebugStringW(param_1);
    }
    if (iVar4 != 0) goto LAB_18002736b;
  }
  if ((DAT_18004db48 == pvVar5) || (DAT_18004db50 == pvVar5)) {
LAB_180027307:
    if (((DAT_18004db38 != pvVar5) &&
        (((pcVar7 = (code *)DecodePointer(DAT_18004db38), pcVar7 != (code *)0x0 &&
          (lVar10 = (*pcVar7)(), lVar10 != 0)) && (DAT_18004db40 != pvVar5)))) &&
       (pcVar7 = (code *)DecodePointer(DAT_18004db40), pcVar7 != (code *)0x0)) {
      lVar10 = (*pcVar7)(lVar10);
    }
  }
  else {
    pcVar7 = (code *)DecodePointer(DAT_18004db48);
    pcVar8 = (code *)DecodePointer(DAT_18004db50);
    if ((pcVar7 == (code *)0x0) || (pcVar8 == (code *)0x0)) goto LAB_180027307;
    lVar9 = (*pcVar7)();
    if (lVar9 != 0) {
      local_68 = local_58;
      iVar4 = (*pcVar8)(lVar9,1,local_50);
      if ((iVar4 != 0) && ((local_48 & 1) != 0)) goto LAB_180027307;
    }
    param_3 = param_3 | 0x200000;
  }
  pcVar7 = (code *)DecodePointer(DAT_18004db30);
  if (pcVar7 != (code *)0x0) {
    (*pcVar7)(lVar10,param_1,param_2,param_3);
  }
LAB_18002736b:
  FUN_18001fe50(local_40 ^ (ulonglong)auStack_88);
  return;
}



DWORD FUN_180027388(undefined1 *param_1,longlong param_2,char *param_3)

{
  char cVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  longlong lVar4;
  
  if ((param_1 != (undefined1 *)0x0) && (param_2 != 0)) {
    if (param_3 != (char *)0x0) {
      lVar4 = (longlong)param_1 - (longlong)param_3;
      do {
        cVar1 = *param_3;
        param_3[lVar4] = cVar1;
        param_3 = param_3 + 1;
        if (cVar1 == '\0') break;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        return 0;
      }
      *param_1 = 0;
      pDVar2 = FUN_180021688();
      DVar3 = 0x22;
      goto LAB_1800273aa;
    }
    *param_1 = 0;
  }
  pDVar2 = FUN_180021688();
  DVar3 = 0x16;
LAB_1800273aa:
  *pDVar2 = DVar3;
  FUN_180023e68();
  return DVar3;
}



ulonglong FUN_180027400(ulonglong *param_1,longlong param_2)

{
  byte bVar1;
  ulonglong uVar2;
  longlong lVar3;
  
  lVar3 = param_2 - (longlong)param_1;
  uVar2 = (ulonglong)param_1 & 7;
  while( true ) {
    if (uVar2 == 0) {
      while ((((int)param_1 + (int)lVar3 & 0xfffU) < 0xff9 &&
             (uVar2 = *param_1, uVar2 == *(ulonglong *)((longlong)param_1 + lVar3)))) {
        param_1 = param_1 + 1;
        if ((~uVar2 & uVar2 + 0xfefefefefefefeff & 0x8080808080808080) != 0) {
          return 0;
        }
      }
    }
    bVar1 = (byte)*param_1;
    if (bVar1 != *(byte *)((longlong)param_1 + lVar3)) break;
    param_1 = (ulonglong *)((longlong)param_1 + 1);
    if (bVar1 == 0) {
      return 0;
    }
    uVar2 = (ulonglong)param_1 & 7;
  }
  return -(ulonglong)(bVar1 < *(byte *)((longlong)param_1 + lVar3)) | 1;
}



void FUN_180027468(longlong param_1)

{
  longlong *plVar1;
  longlong *plVar2;
  longlong *plVar3;
  
  FUN_1800268b0(0xe);
  plVar1 = DAT_18004db60;
  if (*(longlong *)(param_1 + 8) != 0) {
    plVar2 = (longlong *)&DAT_18004db58;
    do {
      plVar3 = plVar2;
      if (DAT_18004db60 == (longlong *)0x0) goto LAB_1800274b6;
      plVar2 = DAT_18004db60;
    } while (*DAT_18004db60 != *(longlong *)(param_1 + 8));
    plVar3[1] = DAT_18004db60[1];
    FUN_18001fcb8(plVar1);
LAB_1800274b6:
    FUN_18001fcb8(*(LPVOID *)(param_1 + 8));
    *(undefined8 *)(param_1 + 8) = 0;
  }
  FUN_180026aa0(0xe);
  return;
}



void FUN_1800274f0(PVOID param_1,PVOID param_2)

{
  RtlUnwindEx(param_1,param_2,(PEXCEPTION_RECORD)0x0,(PVOID)0x0,(PCONTEXT)&stack0xfffffffffffffb28,
              (PUNWIND_HISTORY_TABLE)0x0);
  return;
}



void FUN_180027520(void)

{
  FUN_180027540();
  return;
}



void FUN_180027540(void)

{
  return;
}



void FUN_180027550(void)

{
  return;
}



void FUN_180027554(uint *param_1,ulonglong *param_2,ulonglong param_3,uint param_4,uint *param_5,
                  uint *param_6)

{
  FUN_18002757c(param_1,param_2,param_3,param_4,param_5,param_6,0);
  return;
}



void FUN_18002757c(uint *param_1,ulonglong *param_2,ulonglong param_3,uint param_4,uint *param_5,
                  uint *param_6,int param_7)

{
  uint uVar1;
  DWORD dwExceptionCode;
  uint *local_res8;
  
  param_1[1] = 0;
  dwExceptionCode = 0xc000000d;
  param_1[2] = 0;
  param_1[3] = 0;
  if ((param_3 & 0x10) != 0) {
    dwExceptionCode = 0xc000008f;
    param_1[1] = param_1[1] | 1;
  }
  if ((param_3 & 2) != 0) {
    dwExceptionCode = 0xc0000093;
    param_1[1] = param_1[1] | 2;
  }
  if ((param_3 & 1) != 0) {
    dwExceptionCode = 0xc0000091;
    param_1[1] = param_1[1] | 4;
  }
  if ((param_3 & 4) != 0) {
    dwExceptionCode = 0xc000008e;
    param_1[1] = param_1[1] | 8;
  }
  if ((param_3 & 8) != 0) {
    dwExceptionCode = 0xc0000090;
    param_1[1] = param_1[1] | 0x10;
  }
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 7) << 4) ^ param_1[2]) & 0x10;
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 9) << 3) ^ param_1[2]) & 8;
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 10) << 2) ^ param_1[2]) & 4;
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 0xb) * 2) ^ param_1[2]) & 2;
  param_1[2] = param_1[2] ^ (~((uint)*param_2 >> 0xc) ^ param_1[2]) & 1;
  local_res8 = param_1;
  uVar1 = FUN_18002796c();
  if ((uVar1 & 1) != 0) {
    local_res8[3] = local_res8[3] | 0x10;
  }
  if ((uVar1 & 4) != 0) {
    local_res8[3] = local_res8[3] | 8;
  }
  if ((uVar1 & 8) != 0) {
    local_res8[3] = local_res8[3] | 4;
  }
  if ((uVar1 & 0x10) != 0) {
    local_res8[3] = local_res8[3] | 2;
  }
  if ((uVar1 & 0x20) != 0) {
    local_res8[3] = local_res8[3] | 1;
  }
  uVar1 = (uint)*param_2 & 0x6000;
  if (((uint)*param_2 & 0x6000) == 0) {
    *local_res8 = *local_res8 & 0xfffffffc;
  }
  else if (uVar1 == 0x2000) {
    *local_res8 = *local_res8 & 0xfffffffd;
    *local_res8 = *local_res8 | 1;
  }
  else if (uVar1 == 0x4000) {
    *local_res8 = *local_res8 & 0xfffffffe;
    *local_res8 = *local_res8 | 2;
  }
  else if (uVar1 == 0x6000) {
    *local_res8 = *local_res8 | 3;
  }
  *local_res8 = *local_res8 & 0xfffe001f;
  *local_res8 = *local_res8 | (param_4 & 0xfff) << 5;
  local_res8[8] = local_res8[8] | 1;
  if (param_7 == 0) {
    local_res8[8] = local_res8[8] & 0xffffffe3 | 2;
    *(undefined8 *)(local_res8 + 4) = *(undefined8 *)param_5;
    local_res8[0x18] = local_res8[0x18] | 1;
    local_res8[0x18] = local_res8[0x18] & 0xffffffe3 | 2;
    *(undefined8 *)(local_res8 + 0x14) = *(undefined8 *)param_6;
  }
  else {
    local_res8[8] = local_res8[8] & 0xffffffe1;
    local_res8[4] = *param_5;
    local_res8[0x18] = local_res8[0x18] | 1;
    local_res8[0x18] = local_res8[0x18] & 0xffffffe1;
    local_res8[0x14] = *param_6;
  }
  FUN_1800278b0();
  RaiseException(dwExceptionCode,0,1,(ULONG_PTR *)&local_res8);
  if ((local_res8[2] & 0x10) != 0) {
    *param_2 = *param_2 & 0xffffffffffffff7f;
  }
  if ((local_res8[2] & 8) != 0) {
    *param_2 = *param_2 & 0xfffffffffffffdff;
  }
  if ((local_res8[2] & 4) != 0) {
    *param_2 = *param_2 & 0xfffffffffffffbff;
  }
  if ((local_res8[2] & 2) != 0) {
    *param_2 = *param_2 & 0xfffffffffffff7ff;
  }
  if ((local_res8[2] & 1) != 0) {
    *param_2 = *param_2 & 0xffffffffffffefff;
  }
  uVar1 = *local_res8 & 3;
  if (uVar1 == 0) {
    *param_2 = *param_2 & 0xffffffffffff9fff;
  }
  else if (uVar1 == 1) {
    *param_2 = *param_2 & 0xffffffffffffbfff;
    *param_2 = *param_2 | 0x2000;
  }
  else if (uVar1 == 2) {
    *param_2 = *param_2 & 0xffffffffffffdfff;
    *param_2 = *param_2 | 0x4000;
  }
  else if (uVar1 == 3) {
    *param_2 = *param_2 | 0x6000;
  }
  if (param_7 == 0) {
    *(undefined8 *)param_6 = *(undefined8 *)(local_res8 + 0x14);
  }
  else {
    *param_6 = local_res8[0x14];
  }
  return;
}



void FUN_180027880(int param_1)

{
  DWORD *pDVar1;
  
  if (param_1 == 1) {
    pDVar1 = FUN_180021688();
    *pDVar1 = 0x21;
  }
  else if (param_1 - 2U < 2) {
    pDVar1 = FUN_180021688();
    *pDVar1 = 0x22;
  }
  return;
}



uint FUN_1800278b0(void)

{
  uint uVar1;
  
  uVar1 = FUN_18002a100();
  FUN_18002a11a();
  return uVar1 & 0x3f;
}



uint FUN_1800278d0(uint param_1,uint param_2)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = FUN_18002a100();
  uVar2 = (~param_2 | 0xffff807f) & uVar1 | param_1 & param_2;
  if ((DAT_18004b8a0 == '\0') || ((uVar2 & 0x40) == 0)) {
    FUN_18002a110(uVar2 & 0xffffffbf);
  }
  else {
    FUN_18002a110(uVar2);
  }
  return uVar1;
}



void FUN_18002794c(uint param_1)

{
  uint uVar1;
  
  uVar1 = FUN_18002a100();
  FUN_18002a110(uVar1 | param_1 & 0x3f);
  return;
}



uint FUN_18002796c(void)

{
  uint uVar1;
  
  uVar1 = FUN_18002a100();
  return uVar1 & 0x3f;
}



ulonglong FUN_180027980(int param_1)

{
  ushort uVar1;
  ulonglong uVar2;
  undefined6 extraout_var;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if (DAT_18004d59c == 0) {
    uVar2 = (ulonglong)(*(ushort *)(PTR_DAT_18004b3a8 + (longlong)param_1 * 2) & 4);
  }
  else {
    FUN_180021044(local_28,(longlong *)0x0);
    if (*(int *)(local_28[0] + 0xd4) < 2) {
      uVar2 = (ulonglong)
              (*(ushort *)(*(longlong *)(local_28[0] + 0x108) + (longlong)param_1 * 2) & 4);
    }
    else {
      uVar1 = FUN_180025880(param_1,4,local_28);
      uVar2 = CONCAT62(extraout_var,uVar1) & 0xffffffff;
    }
    if (local_10 != '\0') {
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
    }
  }
  return uVar2;
}



uint FUN_1800279fc(uint param_1,longlong *param_2)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  undefined6 extraout_var;
  undefined6 extraout_var_00;
  DWORD *pDVar4;
  CHAR local_res8;
  CHAR local_res9;
  undefined1 local_resa;
  byte local_res18;
  undefined1 local_res19;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180021044(local_28,param_2);
  if (param_1 < 0x100) {
    if (*(int *)(local_28[0] + 0xd4) < 2) {
      uVar2 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (longlong)(int)param_1 * 2) & 1;
    }
    else {
      uVar1 = FUN_180025880(param_1,1,local_28);
      uVar2 = (uint)CONCAT62(extraout_var,uVar1);
    }
    if (uVar2 == 0) {
LAB_180027a67:
      if (local_10 == '\0') {
        return param_1;
      }
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
      return param_1;
    }
    uVar2 = (uint)*(byte *)(*(longlong *)(local_28[0] + 0x110) + (longlong)(int)param_1);
  }
  else {
    if ((*(int *)(local_28[0] + 0xd4) < 2) ||
       (uVar1 = FUN_180028e24((int)param_1 >> 8 & 0xff,local_28),
       (int)CONCAT62(extraout_var_00,uVar1) == 0)) {
      pDVar4 = FUN_180021688();
      iVar3 = 1;
      *pDVar4 = 0x2a;
      local_res9 = '\0';
      local_res8 = (CHAR)param_1;
    }
    else {
      local_resa = 0;
      iVar3 = 2;
      local_res8 = (CHAR)(param_1 >> 8);
      local_res9 = (CHAR)param_1;
    }
    iVar3 = FUN_180029a78(local_28,*(longlong *)(local_28[0] + 0x138),0x100,&local_res8,iVar3,
                          &local_res18,3,*(UINT *)(local_28[0] + 4),1);
    if (iVar3 == 0) goto LAB_180027a67;
    uVar2 = (uint)local_res18;
    if (iVar3 != 1) {
      uVar2 = (uint)CONCAT11(local_res18,local_res19);
    }
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar2;
}



uint FUN_180027b50(uint param_1)

{
  uint uVar1;
  
  if (DAT_18004d59c == 0) {
    if (param_1 - 0x41 < 0x1a) {
      param_1 = param_1 + 0x20;
    }
    return param_1;
  }
  uVar1 = FUN_1800279fc(param_1,(longlong *)0x0);
  return uVar1;
}



DWORD FUN_180027b70(char *param_1,ulonglong param_2,int param_3,longlong param_4)

{
  ulonglong *puVar1;
  int iVar2;
  DWORD *pDVar3;
  ulonglong *puVar4;
  char *pcVar5;
  char cVar6;
  DWORD DVar7;
  
  pcVar5 = *(char **)(param_4 + 0x10);
  if ((param_1 == (char *)0x0) || (param_2 == 0)) {
    pDVar3 = FUN_180021688();
    DVar7 = 0x16;
  }
  else {
    *param_1 = '\0';
    iVar2 = 0;
    if (0 < param_3) {
      iVar2 = param_3;
    }
    if ((ulonglong)(longlong)(iVar2 + 1) < param_2) {
      puVar1 = (ulonglong *)(param_1 + 1);
      *param_1 = '0';
      puVar4 = puVar1;
      for (; 0 < param_3; param_3 = param_3 + -1) {
        if (*pcVar5 == '\0') {
          cVar6 = '0';
        }
        else {
          cVar6 = *pcVar5;
          pcVar5 = pcVar5 + 1;
        }
        *(char *)puVar4 = cVar6;
        puVar4 = (ulonglong *)((longlong)puVar4 + 1);
      }
      *(undefined1 *)puVar4 = 0;
      if ((-1 < param_3) && ('4' < *pcVar5)) {
        while (puVar4 = (ulonglong *)((longlong)puVar4 + -1), *(char *)puVar4 == '9') {
          *(undefined1 *)puVar4 = 0x30;
        }
        *(char *)puVar4 = *(char *)puVar4 + '\x01';
      }
      if (*param_1 == '1') {
        *(int *)(param_4 + 4) = *(int *)(param_4 + 4) + 1;
      }
      else {
        pcVar5 = FUN_180026e50(puVar1);
        FUN_18001fe80((undefined8 *)param_1,puVar1,(ulonglong)(pcVar5 + 1));
      }
      return 0;
    }
    pDVar3 = FUN_180021688();
    DVar7 = 0x22;
  }
  *pDVar3 = DVar7;
  FUN_180023e68();
  return DVar7;
}



void FUN_180027c3c(uint *param_1,byte *param_2,longlong *param_3,undefined8 *param_4)

{
  undefined1 auStackY_98 [32];
  undefined8 local_58;
  longlong local_50 [2];
  longlong local_40;
  char local_38;
  ushort local_30 [8];
  ulonglong local_20;
  
  local_20 = DAT_18004a880 ^ (ulonglong)auStackY_98;
  FUN_180021044(local_50,param_3);
  FUN_18002acc0(local_30,(ushort *)&local_58,param_2,0,0,0,0,local_50);
  if (param_4 != (undefined8 *)0x0) {
    *param_4 = local_58;
  }
  FUN_18002a708(local_30,param_1);
  if (local_38 != '\0') {
    *(uint *)(local_40 + 200) = *(uint *)(local_40 + 200) & 0xfffffffd;
  }
  FUN_18001fe50(local_20 ^ (ulonglong)auStackY_98);
  return;
}



void FUN_180027d0c(uint *param_1,byte *param_2,longlong *param_3)

{
  undefined1 auStackY_88 [32];
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  ushort local_28 [4];
  ushort local_20 [8];
  ulonglong local_10;
  
  local_10 = DAT_18004a880 ^ (ulonglong)auStackY_88;
  FUN_180021044(local_48,param_3);
  FUN_18002acc0(local_20,local_28,param_2,0,0,0,0,local_48);
  FUN_18002a150(local_20,param_1);
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  FUN_18001fe50(local_10 ^ (ulonglong)auStackY_88);
  return;
}



void FUN_180027dd4(uint *param_1,byte *param_2,longlong *param_3)

{
  FUN_180027c3c(param_1,param_2,param_3,(undefined8 *)0x0);
  return;
}



void FUN_180027ddc(uint *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  ushort uVar3;
  uint uVar4;
  ushort uVar5;
  
  uVar4 = param_2[1];
  uVar5 = *(ushort *)((longlong)param_2 + 6) & 0x8000;
  uVar1 = *param_2;
  uVar3 = *(ushort *)((longlong)param_2 + 6) >> 4 & 0x7ff;
  uVar2 = 0x80000000;
  if (uVar3 == 0) {
    if (((uVar4 & 0xfffff) == 0) && (uVar1 == 0)) {
      param_1[1] = 0;
      *param_1 = 0;
      goto LAB_180027e9e;
    }
    uVar3 = 0x3c01;
    uVar2 = 0;
  }
  else if (uVar3 == 0x7ff) {
    uVar3 = 0x7fff;
  }
  else {
    uVar3 = uVar3 + 0x3c00;
  }
  *param_1 = uVar1 << 0xb;
  uVar4 = uVar1 >> 0x15 | (uVar4 & 0xfffff) << 0xb | uVar2;
  param_1[1] = uVar4;
  if (uVar2 == 0) {
    do {
      uVar4 = *param_1 >> 0x1f | uVar4 * 2;
      *param_1 = *param_1 * 2;
      uVar3 = uVar3 - 1;
    } while (-1 < (int)uVar4);
    param_1[1] = uVar4;
  }
  uVar5 = uVar5 | uVar3;
LAB_180027e9e:
  *(ushort *)(param_1 + 2) = uVar5;
  return;
}



void FUN_180027eac(undefined8 param_1,int *param_2,undefined1 *param_3,longlong param_4)

{
  code *pcVar1;
  int iVar2;
  DWORD DVar3;
  undefined1 auStack_a8 [32];
  undefined8 local_88;
  undefined8 local_78;
  undefined2 local_70;
  undefined8 local_68;
  undefined2 local_60;
  short local_58;
  char local_56;
  char local_54 [28];
  ulonglong local_38;
  
  local_38 = DAT_18004a880 ^ (ulonglong)auStack_a8;
  local_78 = param_1;
  FUN_180027ddc((uint *)&local_68,(uint *)&local_78);
  local_78 = local_68;
  local_70 = local_60;
  iVar2 = FUN_18002b524((int *)&local_78,0x11,0,&local_58);
  *param_2 = (int)local_56;
  param_2[1] = (int)local_58;
  param_2[2] = iVar2;
  DVar3 = FUN_180027388(param_3,param_4,local_54);
  if (DVar3 == 0) {
    *(undefined1 **)(param_2 + 4) = param_3;
    FUN_18001fe50(local_38 ^ (ulonglong)auStack_a8);
    return;
  }
  local_88 = 0;
  FUN_180023e88();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined4 FUN_180027f70(longlong param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  iVar3 = 0xe3;
  do {
    iVar1 = (iVar3 + iVar4) / 2;
    iVar2 = FUN_1800280c0(param_1,(ushort *)(&PTR_DAT_1800421e0)[(longlong)iVar1 * 2],0x55);
    if (iVar2 == 0) {
      return *(undefined4 *)(&DAT_1800421e8 + (longlong)iVar1 * 0x10);
    }
    if (iVar2 < 0) {
      iVar3 = iVar1 + -1;
    }
    else {
      iVar4 = iVar1 + 1;
    }
  } while (iVar4 <= iVar3);
  return 0xffffffff;
}



undefined4 FUN_180027ffc(longlong param_1)

{
  int iVar1;
  
  if (((param_1 != 0) && (iVar1 = FUN_180027f70(param_1), -1 < iVar1)) &&
     ((ulonglong)(longlong)iVar1 < 0xe4)) {
    return *(undefined4 *)(&DAT_1800413a0 + (longlong)iVar1 * 0x10);
  }
  return 0;
}



void FUN_180028030(longlong param_1,DWORD param_2,LPCWSTR param_3,int param_4,LPWSTR param_5,
                  int param_6)

{
  LCID Locale;
  
  if ((code *)(DAT_18004eda0 ^ DAT_18004a880) == (code *)0x0) {
    Locale = FUN_180027ffc(param_1);
    LCMapStringW(Locale,param_2,param_3,param_4,param_5,param_6);
  }
  else {
    (*(code *)(DAT_18004eda0 ^ DAT_18004a880))();
  }
  return;
}



int FUN_1800280c0(longlong param_1,ushort *param_2,longlong param_3)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  if (param_3 != 0) {
    lVar4 = param_1 - (longlong)param_2;
    do {
      uVar1 = *(ushort *)(lVar4 + (longlong)param_2);
      if ((ushort)(uVar1 - 0x41) < 0x1a) {
        uVar1 = uVar1 + 0x20;
      }
      uVar2 = *param_2;
      if ((ushort)(uVar2 - 0x41) < 0x1a) {
        uVar2 = uVar2 + 0x20;
      }
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (((param_3 != 0) && (uVar1 != 0)) && (uVar1 == uVar2));
    iVar3 = (uint)uVar1 - (uint)uVar2;
  }
  return iVar3;
}



undefined8 FUN_180028118(void)

{
  undefined **ppuVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar2 = 0;
  lVar3 = 0x14;
  if (DAT_18004dc98 == 0) {
    DAT_18004dc98 = 0x200;
  }
  else if (DAT_18004dc98 < 0x14) {
    DAT_18004dc98 = 0x14;
  }
  DAT_18004dc90 = FUN_18002244c((longlong)DAT_18004dc98,8);
  if (DAT_18004dc90 == (LPVOID)0x0) {
    DAT_18004dc98 = 0x14;
    DAT_18004dc90 = FUN_18002244c(0x14,8);
    if (DAT_18004dc90 == (LPVOID)0x0) {
      return 0x1a;
    }
  }
  ppuVar1 = &PTR_DAT_18004b8b0;
  do {
    *(undefined ***)(lVar2 + (longlong)DAT_18004dc90) = ppuVar1;
    ppuVar1 = ppuVar1 + 6;
    lVar2 = lVar2 + 8;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  return 0;
}



void FUN_1800281b0(void)

{
  FUN_180029ffc();
  if (DAT_18004cefc != '\0') {
    FUN_18002bffc();
  }
  FUN_18001fcb8(DAT_18004dc90);
  DAT_18004dc90 = (LPVOID)0x0;
  return;
}



undefined ** FUN_1800281e0(void)

{
  return &PTR_DAT_18004b8b0;
}



void FUN_1800281e8(ulonglong param_1)

{
  if ((0x18004b8af < param_1) && (param_1 < 0x18004bc41)) {
    FUN_1800268b0((int)((longlong)(param_1 - 0x18004b8b0) / 0x30) + 0x10);
    *(uint *)(param_1 + 0x18) = *(uint *)(param_1 + 0x18) | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180028246. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x30));
  return;
}



void FUN_180028250(int param_1,longlong param_2)

{
  if (param_1 < 0x14) {
    FUN_1800268b0(param_1 + 0x10);
    *(uint *)(param_2 + 0x18) = *(uint *)(param_2 + 0x18) | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002827a. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x30));
  return;
}



void FUN_180028284(ulonglong param_1)

{
  if ((0x18004b8af < param_1) && (param_1 < 0x18004bc41)) {
    *(uint *)(param_1 + 0x18) = *(uint *)(param_1 + 0x18) & 0xffff7fff;
    FUN_180026aa0((int)((longlong)(param_1 - 0x18004b8b0) / 0x30) + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800282cb. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x30));
  return;
}



void FUN_1800282d4(int param_1,longlong param_2)

{
  if (param_1 < 0x14) {
    *(uint *)(param_2 + 0x18) = *(uint *)(param_2 + 0x18) & 0xffff7fff;
    FUN_180026aa0(param_1 + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800282ea. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x30));
  return;
}



undefined4 FUN_1800282f4(longlong param_1)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  
  if (param_1 == 0) {
    pDVar2 = FUN_180021688();
    *pDVar2 = 0x16;
    FUN_180023e68();
    uVar1 = 0xffffffff;
  }
  else {
    uVar1 = *(undefined4 *)(param_1 + 0x1c);
  }
  return uVar1;
}



byte FUN_18002831c(uint param_1)

{
  DWORD *pDVar1;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_180021688();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004eca0)) {
      return *(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 +
                      (ulonglong)(param_1 & 0x1f) * 0x58) & 0x40;
    }
    pDVar1 = FUN_180021688();
    *pDVar1 = 9;
    FUN_180023e68();
  }
  return 0;
}



undefined4 FUN_18002837c(uint param_1,WCHAR *param_2,uint param_3)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    pDVar2 = FUN_180021618();
    *pDVar2 = 0;
    pDVar2 = FUN_180021688();
    *pDVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004eca0)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) != 0) {
        FUN_18002c0a4(param_1);
        if ((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) == 0) {
          pDVar2 = FUN_180021688();
          *pDVar2 = 9;
          pDVar2 = FUN_180021618();
          *pDVar2 = 0;
          uVar1 = 0xffffffff;
        }
        else {
          uVar1 = FUN_180028460(param_1,param_2,(ulonglong)param_3);
        }
        FUN_18002c25c(param_1);
        return uVar1;
      }
    }
    pDVar2 = FUN_180021618();
    *pDVar2 = 0;
    pDVar2 = FUN_180021688();
    *pDVar2 = 9;
    FUN_180023e68();
  }
  return 0xffffffff;
}



void FUN_180028460(uint param_1,WCHAR *param_2,ulonglong param_3)

{
  char cVar1;
  undefined1 uVar2;
  HANDLE pvVar3;
  byte bVar4;
  WCHAR WVar5;
  ushort uVar6;
  WCHAR WVar7;
  BOOL BVar8;
  UINT UVar9;
  int iVar10;
  DWORD DVar11;
  DWORD DVar12;
  uint uVar13;
  longlong lVar14;
  DWORD *pDVar15;
  undefined7 extraout_var;
  undefined6 extraout_var_00;
  uint uVar16;
  uint uVar17;
  DWORD DVar18;
  int iVar19;
  WCHAR *pWVar20;
  longlong lVar21;
  WCHAR *pWVar22;
  uint nNumberOfBytesToWrite;
  ulonglong uVar23;
  char cVar24;
  uint uVar25;
  longlong lVar26;
  int iVar27;
  bool bVar28;
  int iStackX_8;
  WCHAR aWStackX_c [2];
  longlong lStackX_10;
  DWORD aDStackX_18 [2];
  WCHAR local_1af8 [856];
  WCHAR local_1448 [2560];
  ulonglong local_48;
  undefined8 uStack_40;
  
  uStack_40 = 0x180028482;
  lVar14 = FUN_180020c30();
  lVar14 = -lVar14;
  local_48 = DAT_18004a880 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar14);
  uVar16 = 0;
  DVar12 = 0;
  uVar13 = 0;
  nNumberOfBytesToWrite = (uint)param_3;
  uVar25 = 0;
  *(undefined4 *)((longlong)&iStackX_8 + lVar14) = 0;
  DVar18 = 0;
  if (nNumberOfBytesToWrite == 0) goto LAB_180028c27;
  if (param_2 == (WCHAR *)0x0) {
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800284c3;
    pDVar15 = FUN_180021618();
    *pDVar15 = 0;
LAB_1800284c6:
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800284cb;
    pDVar15 = FUN_180021688();
    *pDVar15 = 0x16;
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800284d6;
    FUN_180023e68();
    goto LAB_180028c27;
  }
  *(longlong *)((longlong)&lStackX_10 + lVar14) = (longlong)(int)param_1 >> 5;
  lVar21 = (&DAT_18004d5a0)[(longlong)(int)param_1 >> 5];
  lVar26 = (ulonglong)(param_1 & 0x1f) * 0x58;
  cVar24 = *(char *)(lVar26 + 0x38 + lVar21);
  *(longlong *)(&stack0x00000020 + lVar14) = lVar26;
  cVar24 = (char)(cVar24 * '\x02') >> 1;
  if (((byte)(cVar24 - 1U) < 2) && ((~nNumberOfBytesToWrite & 1) == 0)) {
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028526;
    pDVar15 = FUN_180021618();
    *pDVar15 = 0;
    goto LAB_1800284c6;
  }
  if ((*(byte *)(lVar26 + 8 + lVar21) & 0x20) != 0) {
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028541;
    FUN_180028d3c(param_1,(LARGE_INTEGER)0x0,2);
  }
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028548;
  bVar4 = FUN_18002831c(param_1);
  lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
  iVar27 = (int)param_2;
  if (((int)CONCAT71(extraout_var,bVar4) == 0) ||
     ((*(byte *)(lVar26 + 8 + (&DAT_18004d5a0)[lVar21]) & 0x80) == 0)) {
LAB_180028897:
    DVar12 = 0;
    if ((*(byte *)(lVar26 + 8 + (&DAT_18004d5a0)[lVar21]) & 0x80) != 0) {
      DVar11 = 0;
      if (cVar24 == '\0') {
        pWVar20 = param_2;
        if (nNumberOfBytesToWrite != 0) {
          do {
            uVar23 = 0;
            iVar10 = *(int *)((longlong)&iStackX_8 + lVar14);
            pWVar22 = local_1448;
            do {
              if (nNumberOfBytesToWrite <= (uint)((int)pWVar20 - iVar27)) break;
              WVar5 = *pWVar20;
              pWVar20 = (WCHAR *)((longlong)pWVar20 + 1);
              if ((char)WVar5 == '\n') {
                *(char *)pWVar22 = '\r';
                iVar10 = iVar10 + 1;
                pWVar22 = (WCHAR *)((longlong)pWVar22 + 1);
                uVar23 = uVar23 + 1;
              }
              uVar23 = uVar23 + 1;
              *(char *)pWVar22 = (char)WVar5;
              pWVar22 = (WCHAR *)((longlong)pWVar22 + 1);
            } while (uVar23 < 0x13ff);
            *(int *)((longlong)&iStackX_8 + lVar14) = iVar10;
            lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
            pvVar3 = *(HANDLE *)
                      (lVar26 + (&DAT_18004d5a0)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
            *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002894d;
            BVar8 = WriteFile(pvVar3,local_1448,(int)pWVar22 - (int)local_1448,
                              (LPDWORD)((longlong)aDStackX_18 + lVar14),
                              *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
            if (BVar8 == 0) goto LAB_180028837;
            uVar16 = uVar16 + *(int *)((longlong)aDStackX_18 + lVar14);
          } while (((longlong)pWVar22 - (longlong)local_1448 <=
                    (longlong)*(int *)((longlong)aDStackX_18 + lVar14)) &&
                  ((uint)((int)pWVar20 - iVar27) < nNumberOfBytesToWrite));
          goto LAB_18002884e;
        }
      }
      else if (cVar24 == '\x02') {
        pWVar20 = param_2;
        if (nNumberOfBytesToWrite != 0) {
          do {
            uVar23 = 0;
            iVar10 = *(int *)((longlong)&iStackX_8 + lVar14);
            pWVar22 = local_1448;
            do {
              if (nNumberOfBytesToWrite <= (uint)((int)pWVar20 - iVar27)) break;
              WVar5 = *pWVar20;
              pWVar20 = pWVar20 + 1;
              if (WVar5 == L'\n') {
                *pWVar22 = L'\r';
                iVar10 = iVar10 + 2;
                pWVar22 = pWVar22 + 1;
                uVar23 = uVar23 + 2;
              }
              uVar23 = uVar23 + 2;
              *pWVar22 = WVar5;
              pWVar22 = pWVar22 + 1;
            } while (uVar23 < 0x13fe);
            *(int *)((longlong)&iStackX_8 + lVar14) = iVar10;
            lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
            pvVar3 = *(HANDLE *)
                      (lVar26 + (&DAT_18004d5a0)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
            *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028a3a;
            BVar8 = WriteFile(pvVar3,local_1448,(int)pWVar22 - (int)local_1448,
                              (LPDWORD)((longlong)aDStackX_18 + lVar14),
                              *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
            if (BVar8 == 0) goto LAB_180028837;
            uVar16 = uVar16 + *(int *)((longlong)aDStackX_18 + lVar14);
          } while (((longlong)pWVar22 - (longlong)local_1448 <=
                    (longlong)*(int *)((longlong)aDStackX_18 + lVar14)) &&
                  ((uint)((int)pWVar20 - iVar27) < nNumberOfBytesToWrite));
          goto LAB_18002884e;
        }
      }
      else {
        pWVar20 = param_2;
        if (nNumberOfBytesToWrite != 0) {
          do {
            uVar23 = 0;
            pWVar22 = local_1af8;
            do {
              if (nNumberOfBytesToWrite <= (uint)((int)pWVar20 - iVar27)) break;
              WVar5 = *pWVar20;
              pWVar20 = pWVar20 + 1;
              if (WVar5 == L'\n') {
                *pWVar22 = L'\r';
                pWVar22 = pWVar22 + 1;
                uVar23 = uVar23 + 2;
              }
              uVar23 = uVar23 + 2;
              *pWVar22 = WVar5;
              pWVar22 = pWVar22 + 1;
            } while (uVar23 < 0x6a8);
            iVar19 = 0;
            *(undefined8 *)(&stack0x00000000 + lVar14) = 0;
            *(undefined8 *)(&stack0xfffffffffffffff8 + lVar14) = 0;
            *(undefined4 *)(&stack0xfffffffffffffff0 + lVar14) = 0xd55;
            *(WCHAR **)(&stack0xffffffffffffffe8 + lVar14) = local_1448;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028b13;
            iVar10 = WideCharToMultiByte(0xfde9,0,local_1af8,((int)pWVar22 - (int)local_1af8) / 2,
                                         *(LPSTR *)(&stack0xffffffffffffffe8 + lVar14),
                                         *(int *)(&stack0xfffffffffffffff0 + lVar14),
                                         *(LPCSTR *)(&stack0xfffffffffffffff8 + lVar14),
                                         *(LPBOOL *)(&stack0x00000000 + lVar14));
            uVar17 = uVar16;
            if (iVar10 == 0) goto LAB_180028841;
            do {
              lVar21 = (&DAT_18004d5a0)[*(longlong *)((longlong)&lStackX_10 + lVar14)];
              *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
              pvVar3 = *(HANDLE *)(*(longlong *)(&stack0x00000020 + lVar14) + lVar21);
              *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028b5c;
              BVar8 = WriteFile(pvVar3,(LPCVOID)((longlong)local_1448 + (longlong)iVar19),
                                iVar10 - iVar19,(LPDWORD)((longlong)aDStackX_18 + lVar14),
                                *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
              if (BVar8 == 0) {
                *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028b71;
                DVar12 = GetLastError();
                break;
              }
              iVar19 = iVar19 + *(int *)((longlong)aDStackX_18 + lVar14);
            } while (iVar19 < iVar10);
          } while ((iVar10 <= iVar19) &&
                  (uVar16 = (int)pWVar20 - iVar27, uVar16 < nNumberOfBytesToWrite));
          goto LAB_180028849;
        }
      }
      goto LAB_180028bef;
    }
    pvVar3 = *(HANDLE *)(lVar26 + (&DAT_18004d5a0)[lVar21]);
    *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028bb1;
    BVar8 = WriteFile(pvVar3,param_2,nNumberOfBytesToWrite,(LPDWORD)((longlong)aDStackX_18 + lVar14)
                      ,*(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
    if (BVar8 == 0) {
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028bc6;
      uVar13 = GetLastError();
      uVar16 = uVar25;
    }
    else {
      uVar16 = *(uint *)((longlong)aDStackX_18 + lVar14);
      uVar13 = uVar25;
    }
    goto LAB_180028857;
  }
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028571;
  pDVar15 = FUN_180025acc();
  lVar21 = *(longlong *)(*(longlong *)(pDVar15 + 0x30) + 0x138);
  pvVar3 = *(HANDLE *)(lVar26 + (&DAT_18004d5a0)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800285a7;
  BVar8 = GetConsoleMode(pvVar3,(LPDWORD)(&stack0x0000002c + lVar14));
  if (BVar8 == 0) {
    lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
    goto LAB_180028897;
  }
  if ((lVar21 == 0) && (cVar24 == '\0')) {
    lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
    goto LAB_180028897;
  }
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800285c6;
  UVar9 = GetConsoleCP();
  *(UINT *)(&stack0x00000030 + lVar14) = UVar9;
  WVar5 = L'\0';
  *(undefined2 *)((longlong)aWStackX_c + lVar14) = 0;
  *(undefined4 *)(&stack0x00000028 + lVar14) = 0;
  pWVar20 = param_2;
  if (nNumberOfBytesToWrite != 0) {
    do {
      bVar28 = false;
      uVar17 = uVar16;
      if (cVar24 == '\0') {
        cVar1 = (char)*pWVar20;
        lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
        *(uint *)(&stack0x0000002c + lVar14) = (uint)(cVar1 == '\n');
        lVar21 = (&DAT_18004d5a0)[*(longlong *)((longlong)&lStackX_10 + lVar14)];
        if (*(int *)(lVar26 + 0x50 + lVar21) == 0) {
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028642;
          uVar6 = FUN_180028e68((int)cVar1);
          if ((int)CONCAT62(extraout_var_00,uVar6) == 0) {
            uVar23 = 1;
            pWVar22 = pWVar20;
            goto LAB_180028683;
          }
          if ((longlong)(((param_3 & 0xffffffff) - (longlong)pWVar20) + (longlong)param_2) < 2) {
            lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
            uVar16 = uVar16 + 1;
            *(char *)(lVar26 + 0x4c + (&DAT_18004d5a0)[lVar21]) = (char)*pWVar20;
            *(undefined4 *)(lVar26 + 0x50 + (&DAT_18004d5a0)[lVar21]) = 1;
            goto LAB_180028857;
          }
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002866c;
          iVar10 = FUN_180029210((LPWSTR)((longlong)aWStackX_c + lVar14),(byte *)pWVar20,2);
          DVar11 = DVar18;
          if (iVar10 == -1) break;
          pWVar20 = (WCHAR *)((longlong)pWVar20 + 1);
        }
        else {
          uVar2 = *(undefined1 *)(lVar26 + 0x4c + lVar21);
          (&stack0x00000035)[lVar14] = cVar1;
          (&stack0x00000034)[lVar14] = uVar2;
          *(undefined4 *)(lVar26 + 0x50 + lVar21) = 0;
          uVar23 = 2;
          pWVar22 = (WCHAR *)(&stack0x00000034 + lVar14);
LAB_180028683:
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002868d;
          iVar10 = FUN_180029210((LPWSTR)((longlong)aWStackX_c + lVar14),(byte *)pWVar22,uVar23);
          DVar11 = 0;
          if (iVar10 == -1) break;
        }
        *(undefined8 *)(&stack0x00000000 + lVar14) = 0;
        *(undefined8 *)(&stack0xfffffffffffffff8 + lVar14) = 0;
        *(undefined4 *)(&stack0xfffffffffffffff0 + lVar14) = 5;
        *(undefined1 **)(&stack0xffffffffffffffe8 + lVar14) = &stack0x00000034 + lVar14;
        pWVar20 = (WCHAR *)((longlong)pWVar20 + 1);
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800286ce;
        DVar11 = WideCharToMultiByte(*(UINT *)(&stack0x00000030 + lVar14),0,
                                     (LPCWSTR)((longlong)aWStackX_c + lVar14),1,
                                     *(LPSTR *)(&stack0xffffffffffffffe8 + lVar14),
                                     *(int *)(&stack0xfffffffffffffff0 + lVar14),
                                     *(LPCSTR *)(&stack0xfffffffffffffff8 + lVar14),
                                     *(LPBOOL *)(&stack0x00000000 + lVar14));
        if (DVar11 == 0) goto LAB_180028849;
        lVar21 = (&DAT_18004d5a0)[*(longlong *)((longlong)&lStackX_10 + lVar14)];
        *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
        pvVar3 = *(HANDLE *)(*(longlong *)(&stack0x00000020 + lVar14) + lVar21);
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002870c;
        BVar8 = WriteFile(pvVar3,&stack0x00000034 + lVar14,DVar11,
                          (LPDWORD)(&stack0x00000028 + lVar14),
                          *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
        if (BVar8 == 0) goto LAB_180028841;
        uVar16 = ((int)pWVar20 - iVar27) + *(int *)((longlong)&iStackX_8 + lVar14);
        if (*(int *)(&stack0x00000028 + lVar14) < (int)DVar11) {
          lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
          lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
          uVar13 = uVar25;
          goto LAB_180028857;
        }
        if (*(int *)(&stack0x0000002c + lVar14) == 0) {
          WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
          uVar17 = uVar16;
          goto LAB_1800287f6;
        }
        (&stack0x00000034)[lVar14] = 0xd;
        *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
        lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
        pvVar3 = *(HANDLE *)
                  (lVar26 + (&DAT_18004d5a0)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002876c;
        BVar8 = WriteFile(pvVar3,&stack0x00000034 + lVar14,1,(LPDWORD)(&stack0x00000028 + lVar14),
                          *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
        if (BVar8 == 0) goto LAB_180028837;
        DVar11 = DVar18;
        if (*(int *)(&stack0x00000028 + lVar14) < 1) break;
        *(int *)((longlong)&iStackX_8 + lVar14) = *(int *)((longlong)&iStackX_8 + lVar14) + 1;
        WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
        uVar16 = uVar16 + 1;
      }
      else {
        if ((byte)(cVar24 - 1U) < 2) {
          WVar5 = *pWVar20;
          bVar28 = WVar5 == L'\n';
          *(WCHAR *)((longlong)aWStackX_c + lVar14) = WVar5;
          pWVar20 = pWVar20 + 1;
        }
        if ((byte)(cVar24 - 1U) < 2) {
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800287c3;
          WVar7 = FUN_18002c288(WVar5);
          WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
          if (WVar7 != WVar5) goto LAB_180028841;
          uVar17 = uVar16 + 2;
          if (bVar28) {
            *(undefined2 *)((longlong)aWStackX_c + lVar14) = 0xd;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800287e6;
            WVar7 = FUN_18002c288(0xd);
            WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
            if (WVar7 != WVar5) goto LAB_180028841;
            uVar17 = uVar16 + 3;
            *(int *)((longlong)&iStackX_8 + lVar14) = *(int *)((longlong)&iStackX_8 + lVar14) + 1;
          }
        }
LAB_1800287f6:
        lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
        uVar16 = uVar17;
      }
      DVar11 = DVar18;
    } while ((uint)((int)pWVar20 - iVar27) < nNumberOfBytesToWrite);
    goto LAB_18002884e;
  }
  lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
  goto LAB_180028bef;
LAB_180028841:
  uVar16 = uVar17;
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028847;
  DVar12 = GetLastError();
LAB_180028849:
  lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
  DVar11 = DVar12;
  goto LAB_18002884e;
LAB_180028837:
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002883d;
  DVar11 = GetLastError();
LAB_18002884e:
  uVar13 = DVar11;
  lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
LAB_180028857:
  if (uVar16 == 0) {
    if (uVar13 == 0) {
LAB_180028bef:
      if (((*(byte *)(lVar26 + 8 + (&DAT_18004d5a0)[lVar21]) & 0x40) == 0) ||
         ((char)*param_2 != '\x1a')) {
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028c11;
        pDVar15 = FUN_180021688();
        *pDVar15 = 0x1c;
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028c1c;
        pDVar15 = FUN_180021618();
        *pDVar15 = 0;
      }
    }
    else if (uVar13 == 5) {
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028877;
      pDVar15 = FUN_180021688();
      *pDVar15 = 9;
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028882;
      pDVar15 = FUN_180021618();
      *pDVar15 = 5;
    }
    else {
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028be5;
      FUN_180021638(uVar13);
    }
  }
LAB_180028c27:
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180028c36;
  FUN_18001fe50(local_48 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar14));
  return;
}



undefined8 FUN_180028c54(uint param_1,LARGE_INTEGER param_2,DWORD param_3)

{
  DWORD *pDVar1;
  undefined8 uVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_180021618();
    *pDVar1 = 0;
    pDVar1 = FUN_180021688();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004eca0)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) != 0) {
        FUN_18002c0a4(param_1);
        if ((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) == 0) {
          pDVar1 = FUN_180021688();
          *pDVar1 = 9;
          pDVar1 = FUN_180021618();
          *pDVar1 = 0;
          uVar2 = 0xffffffffffffffff;
        }
        else {
          uVar2 = FUN_180028d3c(param_1,param_2,param_3);
        }
        FUN_18002c25c(param_1);
        return uVar2;
      }
    }
    pDVar1 = FUN_180021618();
    *pDVar1 = 0;
    pDVar1 = FUN_180021688();
    *pDVar1 = 9;
    FUN_180023e68();
  }
  return 0xffffffffffffffff;
}



undefined8 FUN_180028d3c(uint param_1,LARGE_INTEGER param_2,DWORD param_3)

{
  byte *pbVar1;
  BOOL BVar2;
  DWORD DVar3;
  HANDLE hFile;
  DWORD *pDVar4;
  LARGE_INTEGER local_res20;
  
  hFile = (HANDLE)FUN_18002c1e8(param_1);
  if (hFile == (HANDLE)0xffffffffffffffff) {
    pDVar4 = FUN_180021688();
    *pDVar4 = 9;
  }
  else {
    BVar2 = SetFilePointerEx(hFile,param_2,&local_res20,param_3);
    if (BVar2 != 0) {
      pbVar1 = (byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 +
                       (ulonglong)(param_1 & 0x1f) * 0x58);
      *pbVar1 = *pbVar1 & 0xfd;
      return local_res20.QuadPart;
    }
    DVar3 = GetLastError();
    FUN_180021638(DVar3);
  }
  return 0xffffffffffffffff;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180028dd0(undefined8 *param_1)

{
  LPVOID pvVar1;
  
  _DAT_18004db78 = _DAT_18004db78 + 1;
  pvVar1 = FUN_1800224cc(0x1000);
  param_1[2] = pvVar1;
  if (pvVar1 == (LPVOID)0x0) {
    *(uint *)(param_1 + 3) = *(uint *)(param_1 + 3) | 4;
    *(undefined4 *)((longlong)param_1 + 0x24) = 2;
    param_1[2] = param_1 + 4;
  }
  else {
    *(uint *)(param_1 + 3) = *(uint *)(param_1 + 3) | 8;
    *(undefined4 *)((longlong)param_1 + 0x24) = 0x1000;
  }
  *(undefined4 *)(param_1 + 1) = 0;
  *param_1 = param_1[2];
  return;
}



ushort FUN_180028e24(uint param_1,longlong *param_2)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180021044(local_28,param_2);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(param_1 & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1 & 0x8000;
}



ushort FUN_180028e68(uint param_1)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180021044(local_28,(longlong *)0x0);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(param_1 & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1 & 0x8000;
}



bool FUN_180028eb0(void)

{
  return DAT_18004db80 == (DAT_18004a880 | 1);
}



void FUN_180028ec8(WCHAR param_1,undefined **param_2)

{
  undefined **ppuVar1;
  int iVar2;
  uint uVar3;
  ulonglong uVar4;
  undefined *puVar5;
  int iVar6;
  undefined *puVar7;
  char *pcVar8;
  undefined1 auStack_58 [32];
  int local_38;
  char local_34 [12];
  ulonglong local_28;
  
  local_28 = DAT_18004a880 ^ (ulonglong)auStack_58;
  if (((ulonglong)param_2[3] & 0x40) == 0) {
    iVar2 = FUN_1800282f4((longlong)param_2);
    puVar7 = &DAT_18004b430;
    if ((iVar2 == -1) || (iVar2 = FUN_1800282f4((longlong)param_2), iVar2 == -2)) {
      puVar5 = &DAT_18004b430;
    }
    else {
      iVar2 = FUN_1800282f4((longlong)param_2);
      uVar3 = FUN_1800282f4((longlong)param_2);
      puVar5 = (undefined *)
               ((ulonglong)(uVar3 & 0x1f) * 0x58 + (&DAT_18004d5a0)[(longlong)iVar2 >> 5]);
    }
    if ((puVar5[0x38] & 0x7f) != 2) {
      iVar2 = FUN_1800282f4((longlong)param_2);
      if ((iVar2 == -1) || (iVar2 = FUN_1800282f4((longlong)param_2), iVar2 == -2)) {
        puVar5 = &DAT_18004b430;
      }
      else {
        iVar2 = FUN_1800282f4((longlong)param_2);
        uVar3 = FUN_1800282f4((longlong)param_2);
        puVar5 = (undefined *)
                 ((ulonglong)(uVar3 & 0x1f) * 0x58 + (&DAT_18004d5a0)[(longlong)iVar2 >> 5]);
      }
      if ((puVar5[0x38] & 0x7f) != 1) {
        iVar2 = FUN_1800282f4((longlong)param_2);
        if ((iVar2 != -1) && (iVar2 = FUN_1800282f4((longlong)param_2), iVar2 != -2)) {
          iVar2 = FUN_1800282f4((longlong)param_2);
          uVar3 = FUN_1800282f4((longlong)param_2);
          puVar7 = (undefined *)
                   ((ulonglong)(uVar3 & 0x1f) * 0x58 + (&DAT_18004d5a0)[(longlong)iVar2 >> 5]);
        }
        if ((puVar7[8] & 0x80) != 0) {
          iVar2 = FUN_180029e90(&local_38,(undefined1 (*) [16])local_34,5,param_1);
          iVar6 = 0;
          if ((iVar2 == 0) && (0 < local_38)) {
            pcVar8 = local_34;
            do {
              ppuVar1 = param_2 + 1;
              *(int *)ppuVar1 = *(int *)ppuVar1 + -1;
              if (*(int *)ppuVar1 < 0) {
                uVar4 = FUN_180023ec4((int)*pcVar8,param_2);
                uVar3 = (uint)uVar4;
              }
              else {
                **param_2 = *pcVar8;
                uVar3 = (uint)(byte)**param_2;
                *param_2 = *param_2 + 1;
              }
              if (uVar3 == 0xffffffff) break;
              iVar6 = iVar6 + 1;
              pcVar8 = pcVar8 + 1;
            } while (iVar6 < local_38);
          }
          goto LAB_18002909b;
        }
        goto LAB_180029072;
      }
    }
    iVar2 = *(int *)(param_2 + 1);
    *(int *)(param_2 + 1) = iVar2 + -2;
    if (iVar2 + -2 < 0) {
LAB_180029090:
      FUN_18002c2e4(param_1,param_2);
      goto LAB_18002909b;
    }
    *(WCHAR *)*param_2 = param_1;
  }
  else {
LAB_180029072:
    iVar2 = *(int *)(param_2 + 1);
    *(int *)(param_2 + 1) = iVar2 + -2;
    if (iVar2 + -2 < 0) goto LAB_180029090;
    *(WCHAR *)*param_2 = param_1;
  }
  *param_2 = *param_2 + 2;
LAB_18002909b:
  FUN_18001fe50(local_28 ^ (ulonglong)auStack_58);
  return;
}



undefined4 FUN_1800290bc(LPWSTR param_1,byte *param_2,ulonglong param_3,longlong *param_4)

{
  ushort uVar1;
  int iVar2;
  undefined6 extraout_var;
  DWORD *pDVar3;
  undefined4 uVar4;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if ((param_2 != (byte *)0x0) && (param_3 != 0)) {
    if (*param_2 != 0) {
      FUN_180021044(local_28,param_4);
      if (*(longlong *)(local_28[0] + 0x138) == 0) {
        if (param_1 != (LPWSTR)0x0) {
          *param_1 = (ushort)*param_2;
        }
        uVar4 = 1;
      }
      else {
        uVar1 = FUN_180028e24((uint)*param_2,local_28);
        uVar4 = 1;
        if ((int)CONCAT62(extraout_var,uVar1) == 0) {
          iVar2 = MultiByteToWideChar(*(UINT *)(local_28[0] + 4),9,(LPCSTR)param_2,1,param_1,
                                      (uint)(param_1 != (LPWSTR)0x0));
          if (iVar2 != 0) goto LAB_1800291f3;
        }
        else {
          iVar2 = *(int *)(local_28[0] + 0xd4);
          if ((((1 < iVar2) && (iVar2 <= (int)param_3)) &&
              (iVar2 = MultiByteToWideChar(*(UINT *)(local_28[0] + 4),9,(LPCSTR)param_2,iVar2,
                                           param_1,(uint)(param_1 != (LPWSTR)0x0)), iVar2 != 0)) ||
             (((ulonglong)(longlong)*(int *)(local_28[0] + 0xd4) <= param_3 && (param_2[1] != 0))))
          {
            uVar4 = *(undefined4 *)(local_28[0] + 0xd4);
            goto LAB_1800291f3;
          }
        }
        pDVar3 = FUN_180021688();
        uVar4 = 0xffffffff;
        *pDVar3 = 0x2a;
      }
LAB_1800291f3:
      if (local_10 == '\0') {
        return uVar4;
      }
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
      return uVar4;
    }
    if (param_1 != (LPWSTR)0x0) {
      *param_1 = L'\0';
    }
  }
  return 0;
}



void FUN_180029210(LPWSTR param_1,byte *param_2,ulonglong param_3)

{
  FUN_1800290bc(param_1,param_2,param_3,(longlong *)0x0);
  return;
}



void FUN_180029218(longlong param_1)

{
  if (param_1 != 0) {
    if (*(undefined **)(param_1 + 0x18) != PTR_DAT_18004bc88) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x18));
    }
    if (*(undefined **)(param_1 + 0x20) != PTR_DAT_18004bc90) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x20));
    }
    if (*(undefined **)(param_1 + 0x28) != PTR_DAT_18004bc98) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x28));
    }
    if (*(undefined **)(param_1 + 0x30) != PTR_DAT_18004bca0) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x30));
    }
    if (*(undefined **)(param_1 + 0x38) != PTR_DAT_18004bca8) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x38));
    }
    if (*(undefined **)(param_1 + 0x40) != PTR_DAT_18004bcb0) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x40));
    }
    if (*(undefined **)(param_1 + 0x48) != PTR_DAT_18004bcb8) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x48));
    }
    if (*(undefined **)(param_1 + 0x68) != PTR_DAT_18004bcd8) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x68));
    }
    if (*(undefined **)(param_1 + 0x70) != PTR_DAT_18004bce0) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x70));
    }
    if (*(undefined **)(param_1 + 0x78) != PTR_DAT_18004bce8) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x78));
    }
    if (*(undefined **)(param_1 + 0x80) != PTR_DAT_18004bcf0) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x80));
    }
    if (*(undefined **)(param_1 + 0x88) != PTR_DAT_18004bcf8) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x88));
    }
    if (*(undefined **)(param_1 + 0x90) != PTR_DAT_18004bd00) {
      FUN_18001fcb8(*(undefined **)(param_1 + 0x90));
    }
  }
  return;
}



void FUN_180029324(undefined8 *param_1)

{
  if (param_1 != (undefined8 *)0x0) {
    if ((undefined *)*param_1 != PTR_DAT_18004bc70) {
      FUN_18001fcb8((undefined *)*param_1);
    }
    if ((undefined *)param_1[1] != PTR_DAT_18004bc78) {
      FUN_18001fcb8((undefined *)param_1[1]);
    }
    if ((undefined *)param_1[2] != PTR_DAT_18004bc80) {
      FUN_18001fcb8((undefined *)param_1[2]);
    }
    if ((undefined *)param_1[0xb] != PTR_DAT_18004bcc8) {
      FUN_18001fcb8((undefined *)param_1[0xb]);
    }
    if ((undefined *)param_1[0xc] != PTR_DAT_18004bcd0) {
      FUN_18001fcb8((undefined *)param_1[0xc]);
    }
  }
  return;
}



void FUN_180029390(undefined8 *param_1)

{
  if (param_1 != (undefined8 *)0x0) {
    FUN_18001fcb8((LPVOID)param_1[1]);
    FUN_18001fcb8((LPVOID)param_1[2]);
    FUN_18001fcb8((LPVOID)param_1[3]);
    FUN_18001fcb8((LPVOID)param_1[4]);
    FUN_18001fcb8((LPVOID)param_1[5]);
    FUN_18001fcb8((LPVOID)param_1[6]);
    FUN_18001fcb8((LPVOID)*param_1);
    FUN_18001fcb8((LPVOID)param_1[8]);
    FUN_18001fcb8((LPVOID)param_1[9]);
    FUN_18001fcb8((LPVOID)param_1[10]);
    FUN_18001fcb8((LPVOID)param_1[0xb]);
    FUN_18001fcb8((LPVOID)param_1[0xc]);
    FUN_18001fcb8((LPVOID)param_1[0xd]);
    FUN_18001fcb8((LPVOID)param_1[7]);
    FUN_18001fcb8((LPVOID)param_1[0xe]);
    FUN_18001fcb8((LPVOID)param_1[0xf]);
    FUN_18001fcb8((LPVOID)param_1[0x10]);
    FUN_18001fcb8((LPVOID)param_1[0x11]);
    FUN_18001fcb8((LPVOID)param_1[0x12]);
    FUN_18001fcb8((LPVOID)param_1[0x13]);
    FUN_18001fcb8((LPVOID)param_1[0x14]);
    FUN_18001fcb8((LPVOID)param_1[0x15]);
    FUN_18001fcb8((LPVOID)param_1[0x16]);
    FUN_18001fcb8((LPVOID)param_1[0x17]);
    FUN_18001fcb8((LPVOID)param_1[0x18]);
    FUN_18001fcb8((LPVOID)param_1[0x19]);
    FUN_18001fcb8((LPVOID)param_1[0x1a]);
    FUN_18001fcb8((LPVOID)param_1[0x1b]);
    FUN_18001fcb8((LPVOID)param_1[0x1c]);
    FUN_18001fcb8((LPVOID)param_1[0x1d]);
    FUN_18001fcb8((LPVOID)param_1[0x1e]);
    FUN_18001fcb8((LPVOID)param_1[0x1f]);
    FUN_18001fcb8((LPVOID)param_1[0x20]);
    FUN_18001fcb8((LPVOID)param_1[0x21]);
    FUN_18001fcb8((LPVOID)param_1[0x22]);
    FUN_18001fcb8((LPVOID)param_1[0x23]);
    FUN_18001fcb8((LPVOID)param_1[0x24]);
    FUN_18001fcb8((LPVOID)param_1[0x25]);
    FUN_18001fcb8((LPVOID)param_1[0x26]);
    FUN_18001fcb8((LPVOID)param_1[0x27]);
    FUN_18001fcb8((LPVOID)param_1[0x28]);
    FUN_18001fcb8((LPVOID)param_1[0x29]);
    FUN_18001fcb8((LPVOID)param_1[0x2a]);
    FUN_18001fcb8((LPVOID)param_1[0x2d]);
    FUN_18001fcb8((LPVOID)param_1[0x2e]);
    FUN_18001fcb8((LPVOID)param_1[0x2f]);
    FUN_18001fcb8((LPVOID)param_1[0x30]);
    FUN_18001fcb8((LPVOID)param_1[0x31]);
    FUN_18001fcb8((LPVOID)param_1[0x32]);
    FUN_18001fcb8((LPVOID)param_1[0x2c]);
    FUN_18001fcb8((LPVOID)param_1[0x34]);
    FUN_18001fcb8((LPVOID)param_1[0x35]);
    FUN_18001fcb8((LPVOID)param_1[0x36]);
    FUN_18001fcb8((LPVOID)param_1[0x37]);
    FUN_18001fcb8((LPVOID)param_1[0x38]);
    FUN_18001fcb8((LPVOID)param_1[0x39]);
    FUN_18001fcb8((LPVOID)param_1[0x33]);
    FUN_18001fcb8((LPVOID)param_1[0x3a]);
    FUN_18001fcb8((LPVOID)param_1[0x3b]);
    FUN_18001fcb8((LPVOID)param_1[0x3c]);
    FUN_18001fcb8((LPVOID)param_1[0x3d]);
    FUN_18001fcb8((LPVOID)param_1[0x3e]);
    FUN_18001fcb8((LPVOID)param_1[0x3f]);
    FUN_18001fcb8((LPVOID)param_1[0x40]);
    FUN_18001fcb8((LPVOID)param_1[0x41]);
    FUN_18001fcb8((LPVOID)param_1[0x42]);
    FUN_18001fcb8((LPVOID)param_1[0x43]);
    FUN_18001fcb8((LPVOID)param_1[0x44]);
    FUN_18001fcb8((LPVOID)param_1[0x45]);
    FUN_18001fcb8((LPVOID)param_1[0x46]);
    FUN_18001fcb8((LPVOID)param_1[0x47]);
    FUN_18001fcb8((LPVOID)param_1[0x48]);
    FUN_18001fcb8((LPVOID)param_1[0x49]);
    FUN_18001fcb8((LPVOID)param_1[0x4a]);
    FUN_18001fcb8((LPVOID)param_1[0x4b]);
    FUN_18001fcb8((LPVOID)param_1[0x4c]);
    FUN_18001fcb8((LPVOID)param_1[0x4d]);
    FUN_18001fcb8((LPVOID)param_1[0x4e]);
    FUN_18001fcb8((LPVOID)param_1[0x4f]);
    FUN_18001fcb8((LPVOID)param_1[0x50]);
    FUN_18001fcb8((LPVOID)param_1[0x51]);
    FUN_18001fcb8((LPVOID)param_1[0x52]);
    FUN_18001fcb8((LPVOID)param_1[0x53]);
    FUN_18001fcb8((LPVOID)param_1[0x54]);
    FUN_18001fcb8((LPVOID)param_1[0x55]);
    FUN_18001fcb8((LPVOID)param_1[0x56]);
    FUN_18001fcb8((LPVOID)param_1[0x57]);
  }
  return;
}



void FUN_18002978c(longlong *param_1,longlong param_2,uint param_3,LPCSTR param_4,int param_5,
                  undefined8 param_6,int param_7,UINT param_8,int param_9)

{
  int iVar1;
  char *pcVar2;
  longlong lVar3;
  LPCWSTR pWVar4;
  longlong lVar5;
  LPCWSTR lpWideCharStr;
  undefined1 *puVar6;
  undefined1 *puVar7;
  undefined1 *puVar8;
  int iVar9;
  ulonglong uVar10;
  undefined1 auStackY_78 [32];
  longlong local_38;
  ulonglong local_30;
  
  puVar7 = auStackY_78;
  puVar6 = auStackY_78;
  local_30 = DAT_18004a880 ^ (ulonglong)&local_38;
  pWVar4 = (LPCWSTR)0x0;
  pcVar2 = param_4;
  iVar9 = param_5;
  if (0 < param_5) {
    do {
      iVar9 = iVar9 + -1;
      if (*pcVar2 == '\0') goto LAB_1800297e6;
      pcVar2 = pcVar2 + 1;
    } while (iVar9 != 0);
    iVar9 = -1;
LAB_1800297e6:
    iVar1 = (param_5 - iVar9) + -1;
    iVar9 = param_5 - iVar9;
    if (param_5 <= iVar1) {
      iVar9 = iVar1;
    }
  }
  if (param_8 == 0) {
    param_8 = *(UINT *)(*param_1 + 4);
  }
  local_38 = param_2;
  iVar1 = MultiByteToWideChar(param_8,(-(uint)(param_9 != 0) & 8) + 1,param_4,iVar9,(LPWSTR)0x0,0);
  uVar10 = (ulonglong)iVar1;
  if (iVar1 == 0) goto LAB_180029a52;
  puVar7 = auStackY_78;
  if (((0 < iVar1) && (puVar7 = auStackY_78, 1 < 0xffffffffffffffe0 / uVar10)) &&
     (puVar7 = auStackY_78, uVar10 * 2 < uVar10 * 2 + 0x10)) {
    uVar10 = uVar10 * 2 + 0x10;
    if (uVar10 < 0x401) {
      lVar3 = FUN_180020c30();
      lVar3 = -lVar3;
      puVar7 = auStackY_78 + lVar3;
      puVar6 = auStackY_78 + lVar3;
      pWVar4 = (LPCWSTR)((longlong)&local_38 + lVar3);
      if (pWVar4 == (LPCWSTR)0x0) goto LAB_180029a52;
      pWVar4[0] = L'';
      pWVar4[1] = L'\0';
    }
    else {
      pWVar4 = (LPCWSTR)FUN_18001fcf8(uVar10);
      puVar7 = auStackY_78;
      if (pWVar4 == (LPCWSTR)0x0) goto LAB_1800298b7;
      pWVar4[0] = L'\xdddd';
      pWVar4[1] = L'\0';
    }
    pWVar4 = pWVar4 + 8;
    puVar7 = puVar6;
  }
LAB_1800298b7:
  if (pWVar4 == (LPCWSTR)0x0) goto LAB_180029a52;
  *(int *)(puVar7 + 0x28) = iVar1;
  *(LPCWSTR *)(puVar7 + 0x20) = pWVar4;
  *(undefined8 *)(puVar7 + -8) = 0x1800298de;
  iVar9 = MultiByteToWideChar(param_8,1,param_4,iVar9,*(LPWSTR *)(puVar7 + 0x20),
                              *(int *)(puVar7 + 0x28));
  lVar3 = local_38;
  puVar8 = puVar7;
  if (iVar9 != 0) {
    *(undefined4 *)(puVar7 + 0x28) = 0;
    *(undefined8 *)(puVar7 + 0x20) = 0;
    *(undefined8 *)(puVar7 + -8) = 0x180029904;
    iVar9 = FUN_180028030(lVar3,param_3,pWVar4,iVar1,*(LPWSTR *)(puVar7 + 0x20),
                          *(int *)(puVar7 + 0x28));
    uVar10 = (ulonglong)iVar9;
    if (iVar9 != 0) {
      if ((param_3 & 0x400) == 0) {
        if (((iVar9 < 1) || (0xffffffffffffffe0 / uVar10 < 2)) || (uVar10 * 2 + 0x10 <= uVar10 * 2))
        {
          lpWideCharStr = (LPCWSTR)0x0;
        }
        else {
          uVar10 = uVar10 * 2 + 0x10;
          if (uVar10 < 0x401) {
            *(undefined8 *)(puVar7 + -8) = 0x180029999;
            lVar5 = FUN_180020c30();
            lVar5 = -lVar5;
            puVar8 = puVar7 + lVar5;
            lpWideCharStr = (LPCWSTR)(puVar7 + lVar5 + 0x40);
            if (lpWideCharStr == (LPCWSTR)0x0) goto LAB_180029a3f;
            lpWideCharStr[0] = L'';
            lpWideCharStr[1] = L'\0';
            puVar7 = puVar7 + lVar5;
          }
          else {
            *(undefined8 *)(puVar7 + -8) = 0x1800299b7;
            lpWideCharStr = (LPCWSTR)FUN_18001fcf8(uVar10);
            if (lpWideCharStr == (LPCWSTR)0x0) goto LAB_1800299cd;
            lpWideCharStr[0] = L'\xdddd';
            lpWideCharStr[1] = L'\0';
          }
          lpWideCharStr = lpWideCharStr + 8;
          puVar8 = puVar7;
        }
LAB_1800299cd:
        if (lpWideCharStr != (LPCWSTR)0x0) {
          *(int *)(puVar8 + 0x28) = iVar9;
          *(LPCWSTR *)(puVar8 + 0x20) = lpWideCharStr;
          *(undefined8 *)(puVar8 + -8) = 0x1800299ec;
          iVar1 = FUN_180028030(lVar3,param_3,pWVar4,iVar1,*(LPWSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28));
          if (iVar1 != 0) {
            *(undefined8 *)(puVar8 + 0x38) = 0;
            *(undefined8 *)(puVar8 + 0x30) = 0;
            if (param_7 == 0) {
              *(undefined4 *)(puVar8 + 0x28) = 0;
              *(undefined8 *)(puVar8 + 0x20) = 0;
            }
            else {
              *(int *)(puVar8 + 0x28) = param_7;
              *(undefined8 *)(puVar8 + 0x20) = param_6;
            }
            *(undefined8 *)(puVar8 + -8) = 0x180029a2c;
            WideCharToMultiByte(param_8,0,lpWideCharStr,iVar9,*(LPSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28),*(LPCSTR *)(puVar8 + 0x30),
                                *(LPBOOL *)(puVar8 + 0x38));
          }
          if (*(int *)(lpWideCharStr + -8) == 0xdddd) {
            *(undefined8 *)(puVar8 + -8) = 0x180029a3f;
            FUN_18001fcb8(lpWideCharStr + -8);
          }
        }
      }
      else if ((param_7 != 0) && (iVar9 <= param_7)) {
        *(int *)(puVar7 + 0x28) = param_7;
        *(undefined8 *)(puVar7 + 0x20) = param_6;
        *(undefined8 *)(puVar7 + -8) = 0x18002994b;
        FUN_180028030(lVar3,param_3,pWVar4,iVar1,*(LPWSTR *)(puVar7 + 0x20),*(int *)(puVar7 + 0x28))
        ;
      }
    }
  }
LAB_180029a3f:
  puVar7 = puVar8;
  if (*(int *)(pWVar4 + -8) == 0xdddd) {
    *(undefined8 *)(puVar8 + -8) = 0x180029a50;
    FUN_18001fcb8(pWVar4 + -8);
  }
LAB_180029a52:
  uVar10 = local_30 ^ (ulonglong)&local_38;
  *(undefined8 *)(puVar7 + -8) = 0x180029a5e;
  FUN_18001fe50(uVar10);
  return;
}



void FUN_180029a78(longlong *param_1,longlong param_2,uint param_3,LPCSTR param_4,int param_5,
                  undefined8 param_6,int param_7,UINT param_8,int param_9)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180021044(local_28,param_1);
  FUN_18002978c(local_28,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_180029b10(longlong *param_1,DWORD param_2,LPCSTR param_3,int param_4,LPWORD param_5,
                  UINT param_6,int param_7)

{
  ulonglong uVar1;
  int iVar2;
  longlong lVar3;
  undefined1 (*lpSrcStr) [16];
  undefined1 *puVar4;
  undefined1 *puVar5;
  ulonglong uVar6;
  undefined1 auStackY_68 [32];
  ulonglong local_38 [2];
  
  puVar5 = auStackY_68;
  puVar4 = auStackY_68;
  local_38[0] = DAT_18004a880 ^ (ulonglong)local_38;
  lpSrcStr = (undefined1 (*) [16])0x0;
  if (param_6 == 0) {
    param_6 = *(UINT *)(*param_1 + 4);
  }
  iVar2 = MultiByteToWideChar(param_6,(-(uint)(param_7 != 0) & 8) + 1,param_3,param_4,(LPWSTR)0x0,0)
  ;
  uVar6 = (ulonglong)iVar2;
  if (iVar2 == 0) goto LAB_180029c60;
  puVar5 = auStackY_68;
  if (((0 < iVar2) && (puVar5 = auStackY_68, uVar6 < 0x7ffffffffffffff1)) &&
     (puVar5 = auStackY_68, uVar6 * 2 < uVar6 * 2 + 0x10)) {
    uVar1 = uVar6 * 2 + 0x10;
    if (uVar1 < 0x401) {
      lVar3 = FUN_180020c30();
      lVar3 = -lVar3;
      puVar5 = auStackY_68 + lVar3;
      puVar4 = auStackY_68 + lVar3;
      lpSrcStr = (undefined1 (*) [16])((longlong)local_38 + lVar3);
      if (lpSrcStr == (undefined1 (*) [16])0x0) goto LAB_180029c60;
      *(undefined4 *)*lpSrcStr = 0xcccc;
    }
    else {
      lpSrcStr = (undefined1 (*) [16])FUN_18001fcf8(uVar1);
      puVar5 = auStackY_68;
      if (lpSrcStr == (undefined1 (*) [16])0x0) goto LAB_180029bfe;
      *(undefined4 *)*lpSrcStr = 0xdddd;
    }
    lpSrcStr = lpSrcStr + 1;
    puVar5 = puVar4;
  }
LAB_180029bfe:
  if (lpSrcStr != (undefined1 (*) [16])0x0) {
    *(undefined8 *)(puVar5 + -8) = 0x180029c17;
    FUN_180020400(lpSrcStr,0,uVar6 * 2);
    *(int *)(puVar5 + 0x28) = iVar2;
    *(undefined1 (**) [16])(puVar5 + 0x20) = lpSrcStr;
    *(undefined8 *)(puVar5 + -8) = 0x180029c34;
    iVar2 = MultiByteToWideChar(param_6,1,param_3,param_4,*(LPWSTR *)(puVar5 + 0x20),
                                *(int *)(puVar5 + 0x28));
    if (iVar2 != 0) {
      *(undefined8 *)(puVar5 + -8) = 0x180029c4b;
      GetStringTypeW(param_2,(LPCWSTR)lpSrcStr,iVar2,param_5);
    }
    if (*(int *)lpSrcStr[-1] == 0xdddd) {
      *(undefined8 *)(puVar5 + -8) = 0x180029c5e;
      FUN_18001fcb8(lpSrcStr + -1);
    }
  }
LAB_180029c60:
  uVar6 = local_38[0] ^ (ulonglong)local_38;
  *(undefined8 *)(puVar5 + -8) = 0x180029c6c;
  FUN_18001fe50(uVar6);
  return;
}



void FUN_180029c88(longlong *param_1,DWORD param_2,LPCSTR param_3,int param_4,LPWORD param_5,
                  UINT param_6,int param_7)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_180021044(local_28,param_1);
  FUN_180029b10(local_28,param_2,param_3,param_4,param_5,param_6,param_7);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



DWORD FUN_180029d04(int *param_1,undefined1 (*param_2) [16],ulonglong param_3,WCHAR param_4,
                   longlong *param_5)

{
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  DWORD unaff_EBX;
  BOOL local_res10 [2];
  WCHAR local_res20 [4];
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if ((param_2 == (undefined1 (*) [16])0x0) && (param_3 != 0)) {
    if (param_1 == (int *)0x0) {
      return unaff_EBX;
    }
    *param_1 = 0;
    return unaff_EBX;
  }
  if (param_1 != (int *)0x0) {
    *param_1 = -1;
  }
  local_res20[0] = param_4;
  if (0x7fffffff < param_3) {
    pDVar3 = FUN_180021688();
    *pDVar3 = 0x16;
    FUN_180023e68();
    return unaff_EBX;
  }
  FUN_180021044(local_28,param_5);
  if (*(longlong *)(local_28[0] + 0x138) == 0) {
    if ((ushort)local_res20[0] < 0x100) {
      if (param_2 != (undefined1 (*) [16])0x0) {
        if (param_3 == 0) goto LAB_180029e78;
        (*param_2)[0] = (char)local_res20[0];
      }
      if (param_1 != (int *)0x0) {
        *param_1 = 1;
      }
      goto LAB_180029dba;
    }
    if ((param_2 != (undefined1 (*) [16])0x0) && (param_3 != 0)) {
      FUN_180020400(param_2,0,param_3);
    }
  }
  else {
    local_res10[0] = 0;
    iVar1 = WideCharToMultiByte(*(UINT *)(local_28[0] + 4),0,local_res20,1,(LPSTR)param_2,
                                (int)param_3,(LPCSTR)0x0,local_res10);
    if (iVar1 == 0) {
      DVar2 = GetLastError();
      if (DVar2 == 0x7a) {
        if ((param_2 != (undefined1 (*) [16])0x0) && (param_3 != 0)) {
          FUN_180020400(param_2,0,param_3);
        }
LAB_180029e78:
        pDVar3 = FUN_180021688();
        *pDVar3 = 0x22;
        FUN_180023e68();
        goto LAB_180029dba;
      }
    }
    else if (local_res10[0] == 0) {
      if (param_1 != (int *)0x0) {
        *param_1 = iVar1;
      }
      goto LAB_180029dba;
    }
  }
  pDVar3 = FUN_180021688();
  *pDVar3 = 0x2a;
  FUN_180021688();
LAB_180029dba:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return unaff_EBX;
}



void FUN_180029e90(int *param_1,undefined1 (*param_2) [16],ulonglong param_3,WCHAR param_4)

{
  FUN_180029d04(param_1,param_2,param_3,param_4,(longlong *)0x0);
  return;
}



uint FUN_180029ea4(longlong *param_1,uint param_2,uint param_3,byte param_4)

{
  uint uVar1;
  longlong local_28;
  longlong local_20;
  longlong local_18;
  char local_10;
  
  FUN_180021044(&local_28,param_1);
  if ((*(byte *)((ulonglong)(param_2 & 0xff) + 0x19 + local_20) & param_4) == 0) {
    if (param_3 == 0) {
      uVar1 = 0;
    }
    else {
      uVar1 = *(ushort *)(*(longlong *)(local_28 + 0x108) + (ulonglong)(param_2 & 0xff) * 2) &
              param_3;
    }
    if (uVar1 == 0) goto LAB_180029efa;
  }
  uVar1 = 1;
LAB_180029efa:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1;
}



void FUN_180029f20(uint param_1)

{
  FUN_180029ea4((longlong *)0x0,param_1,0,4);
  return;
}



ulonglong FUN_180029f34(int *param_1)

{
  int iVar1;
  uint uVar2;
  DWORD DVar3;
  undefined4 extraout_var;
  undefined8 uVar4;
  ulonglong uVar5;
  
  if (param_1 == (int *)0x0) {
    iVar1 = FUN_18002a008(0);
    return CONCAT44(extraout_var,iVar1);
  }
  uVar4 = FUN_180029f80(param_1);
  if ((int)uVar4 == 0) {
    if ((param_1[6] & 0x4000U) == 0) {
      uVar5 = 0;
    }
    else {
      uVar2 = FUN_1800282f4((longlong)param_1);
      DVar3 = FUN_18002c474(uVar2);
      uVar5 = (ulonglong)-(uint)(DVar3 != 0);
    }
  }
  else {
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



undefined8 FUN_180029f80(int *param_1)

{
  uint uVar1;
  undefined8 uVar2;
  uint uVar3;
  
  uVar2 = 0;
  if (((((byte)param_1[6] & 3) == 2) && ((param_1[6] & 0x108U) != 0)) &&
     (uVar3 = *param_1 - param_1[4], 0 < (int)uVar3)) {
    uVar1 = FUN_1800282f4((longlong)param_1);
    uVar1 = FUN_18002837c(uVar1,*(WCHAR **)(param_1 + 4),uVar3);
    if (uVar1 == uVar3) {
      uVar2 = 0;
      if ((char)param_1[6] < '\0') {
        param_1[6] = param_1[6] & 0xfffffffd;
      }
    }
    else {
      param_1[6] = param_1[6] | 0x20;
      uVar2 = 0xffffffff;
    }
  }
  param_1[2] = 0;
  *(undefined8 *)param_1 = *(undefined8 *)(param_1 + 4);
  return uVar2;
}



void FUN_180029ffc(void)

{
  FUN_18002a008(1);
  return;
}



int FUN_18002a008(int param_1)

{
  longlong lVar1;
  int *piVar2;
  ulonglong uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  
  iVar5 = 0;
  iVar6 = 0;
  FUN_1800268b0(1);
  for (iVar4 = 0; iVar4 < DAT_18004dc98; iVar4 = iVar4 + 1) {
    lVar7 = (longlong)iVar4;
    lVar1 = *(longlong *)(DAT_18004dc90 + lVar7 * 8);
    if ((lVar1 != 0) && ((*(byte *)(lVar1 + 0x18) & 0x83) != 0)) {
      FUN_180028250(iVar4,lVar1);
      piVar2 = *(int **)(DAT_18004dc90 + lVar7 * 8);
      if ((*(byte *)(piVar2 + 6) & 0x83) != 0) {
        if (param_1 == 1) {
          uVar3 = FUN_180029f34(piVar2);
          if ((int)uVar3 != -1) {
            iVar5 = iVar5 + 1;
          }
        }
        else if (((param_1 == 0) && ((*(byte *)(piVar2 + 6) & 2) != 0)) &&
                (uVar3 = FUN_180029f34(piVar2), (int)uVar3 == -1)) {
          iVar6 = -1;
        }
      }
      FUN_1800282d4(iVar4,*(longlong *)(DAT_18004dc90 + lVar7 * 8));
    }
  }
  FUN_180026aa0(1);
  if (param_1 == 1) {
    iVar6 = iVar5;
  }
  return iVar6;
}



undefined4 FUN_18002a100(void)

{
  return MXCSR;
}



void FUN_18002a110(undefined4 param_1)

{
  MXCSR = param_1;
  return;
}



void FUN_18002a11a(void)

{
  MXCSR = MXCSR & 0xffffffc0;
  return;
}



void FUN_18002a150(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  uint *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined1 auStack_88 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_18004a880 ^ (ulonglong)auStack_88;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_18004bd58 + -1;
    uVar7 = DAT_18004bd58 >> 0x1f & 0x1f;
    uVar1 = DAT_18004bd58 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_18002a271;
        }
      }
      else {
LAB_18002a271:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *puVar13 = *puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_180020400((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_18004bd54 - DAT_18004bd58) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else if (DAT_18004bd54 < iVar11) {
      uVar10 = DAT_18004bd5c >> 0x1f & 0x1f;
      iVar15 = DAT_18004bd5c + uVar10;
      bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
      iVar15 = iVar15 >> 5;
      uVar10 = ~(-1 << (bVar4 & 0x1f));
      if (iVar11 < DAT_18004bd50) {
        local_40 = local_40 & 0xffffffff7fffffff;
        iVar2 = DAT_18004bd64 + iVar11;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = *puVar13;
          *puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = puVar13 + 1;
          uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
      }
      else {
        local_40 = 0x80000000;
        local_38 = 0;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = (uint)uVar3;
          uVar3 = (ulonglong)((uVar10 & *puVar13) << (0x20 - bVar4 & 0x1f));
          *puVar13 = *puVar13 >> (bVar4 & 0x1f) | uVar1;
          puVar13 = puVar13 + 1;
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = DAT_18004bd64 + DAT_18004bd50;
      }
    }
    else {
      local_40 = local_48;
      local_38 = local_50;
      uVar10 = DAT_18004bd54 - local_68 >> 0x1f & 0x1f;
      puVar13 = (uint *)&local_40;
      iVar2 = (DAT_18004bd54 - local_68) + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      uVar6 = uVar3;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
        puVar13 = puVar13 + 1;
        uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar17 = lVar17 + -1;
      } while (lVar17 != 0);
      lVar16 = (longlong)(iVar2 >> 5);
      lVar17 = 2;
      lVar18 = 3;
      lVar5 = 2;
      do {
        if (lVar5 < lVar16) {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
        }
        lVar5 = lVar5 + -1;
      } while (-1 < lVar5);
      uVar1 = local_60 + 1 >> 0x1f & 0x1f;
      uVar10 = local_60 + 1 + uVar1;
      iVar2 = (int)uVar10 >> 5;
      uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
      bVar4 = (byte)uVar10;
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0) {
          for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
            if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_18002a44b;
          }
        }
        else {
LAB_18002a44b:
          uVar10 = local_60 >> 0x1f & 0x1f;
          iVar11 = local_60 + uVar10;
          iVar15 = iVar11 >> 5;
          uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
          uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
          uVar10 = uVar1 + uVar7;
          if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
            uVar6 = uVar9;
          }
          *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
          lVar5 = (longlong)(iVar15 + -1);
          if (-1 < iVar15 + -1) {
            do {
              if ((int)uVar6 == 0) break;
              uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
              uVar10 = uVar1 + 1;
              if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                uVar6 = uVar9;
              }
              *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
              lVar5 = lVar5 + -1;
            } while (-1 < lVar5);
          }
        }
      }
      puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar2 * 4);
      *puVar13 = *puVar13 & -1 << (bVar4 & 0x1f);
      lVar5 = (longlong)(iVar2 + 1);
      if (lVar5 < 3) {
        FUN_180020400((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
      }
      puVar13 = (uint *)&local_40;
      uVar10 = DAT_18004bd5c + 1 >> 0x1f & 0x1f;
      iVar2 = DAT_18004bd5c + 1 + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
        puVar13 = puVar13 + 1;
        uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar18 = lVar18 + -1;
      } while (lVar18 != 0);
      lVar5 = (longlong)(iVar2 >> 5);
      do {
        if (lVar17 < lVar5) {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
        }
        lVar17 = lVar17 + -1;
      } while (-1 < lVar17);
      iVar2 = 0;
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  uVar10 = iVar2 << (0x1fU - (char)DAT_18004bd5c & 0x1f) | -(uint)bVar19 & 0x80000000 |
           (uint)local_40;
  if (DAT_18004bd60 == 0x40) {
    local_58[1] = uVar10;
    *local_58 = local_40._4_4_;
  }
  else if (DAT_18004bd60 == 0x20) {
    *local_58 = uVar10;
  }
  FUN_18001fe50(local_30 ^ (ulonglong)auStack_88);
  return;
}



void FUN_18002a708(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  uint *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined1 auStack_88 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_18004a880 ^ (ulonglong)auStack_88;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_18004bd70 + -1;
    uVar7 = DAT_18004bd70 >> 0x1f & 0x1f;
    uVar1 = DAT_18004bd70 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_18002a829;
        }
      }
      else {
LAB_18002a829:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *puVar13 = *puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_180020400((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_18004bd6c - DAT_18004bd70) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else if (DAT_18004bd6c < iVar11) {
      uVar10 = DAT_18004bd74 >> 0x1f & 0x1f;
      iVar15 = DAT_18004bd74 + uVar10;
      bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
      iVar15 = iVar15 >> 5;
      uVar10 = ~(-1 << (bVar4 & 0x1f));
      if (iVar11 < DAT_18004bd68) {
        local_40 = local_40 & 0xffffffff7fffffff;
        iVar2 = DAT_18004bd7c + iVar11;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = *puVar13;
          *puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = puVar13 + 1;
          uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
      }
      else {
        local_40 = 0x80000000;
        local_38 = 0;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = (uint)uVar3;
          uVar3 = (ulonglong)((uVar10 & *puVar13) << (0x20 - bVar4 & 0x1f));
          *puVar13 = *puVar13 >> (bVar4 & 0x1f) | uVar1;
          puVar13 = puVar13 + 1;
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = DAT_18004bd7c + DAT_18004bd68;
      }
    }
    else {
      local_40 = local_48;
      local_38 = local_50;
      uVar10 = DAT_18004bd6c - local_68 >> 0x1f & 0x1f;
      puVar13 = (uint *)&local_40;
      iVar2 = (DAT_18004bd6c - local_68) + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      uVar6 = uVar3;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
        puVar13 = puVar13 + 1;
        uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar17 = lVar17 + -1;
      } while (lVar17 != 0);
      lVar16 = (longlong)(iVar2 >> 5);
      lVar17 = 2;
      lVar18 = 3;
      lVar5 = 2;
      do {
        if (lVar5 < lVar16) {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
        }
        lVar5 = lVar5 + -1;
      } while (-1 < lVar5);
      uVar1 = local_60 + 1 >> 0x1f & 0x1f;
      uVar10 = local_60 + 1 + uVar1;
      iVar2 = (int)uVar10 >> 5;
      uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
      bVar4 = (byte)uVar10;
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0) {
          for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
            if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_18002aa03;
          }
        }
        else {
LAB_18002aa03:
          uVar10 = local_60 >> 0x1f & 0x1f;
          iVar11 = local_60 + uVar10;
          iVar15 = iVar11 >> 5;
          uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
          uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
          uVar10 = uVar1 + uVar7;
          if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
            uVar6 = uVar9;
          }
          *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
          lVar5 = (longlong)(iVar15 + -1);
          if (-1 < iVar15 + -1) {
            do {
              if ((int)uVar6 == 0) break;
              uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
              uVar10 = uVar1 + 1;
              if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                uVar6 = uVar9;
              }
              *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
              lVar5 = lVar5 + -1;
            } while (-1 < lVar5);
          }
        }
      }
      puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar2 * 4);
      *puVar13 = *puVar13 & -1 << (bVar4 & 0x1f);
      lVar5 = (longlong)(iVar2 + 1);
      if (lVar5 < 3) {
        FUN_180020400((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
      }
      puVar13 = (uint *)&local_40;
      uVar10 = DAT_18004bd74 + 1 >> 0x1f & 0x1f;
      iVar2 = DAT_18004bd74 + 1 + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
        puVar13 = puVar13 + 1;
        uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar18 = lVar18 + -1;
      } while (lVar18 != 0);
      lVar5 = (longlong)(iVar2 >> 5);
      do {
        if (lVar17 < lVar5) {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
        }
        lVar17 = lVar17 + -1;
      } while (-1 < lVar17);
      iVar2 = 0;
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  uVar10 = iVar2 << (0x1fU - (char)DAT_18004bd74 & 0x1f) | -(uint)bVar19 & 0x80000000 |
           (uint)local_40;
  if (DAT_18004bd78 == 0x40) {
    local_58[1] = uVar10;
    *local_58 = local_40._4_4_;
  }
  else if (DAT_18004bd78 == 0x20) {
    *local_58 = uVar10;
  }
  FUN_18001fe50(local_30 ^ (ulonglong)auStack_88);
  return;
}



void FUN_18002acc0(ushort *param_1,ushort *param_2,byte *param_3,int param_4,int param_5,int param_6
                  ,int param_7,longlong *param_8)

{
  undefined8 uVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  DWORD *pDVar5;
  byte bVar6;
  ushort uVar7;
  ulonglong uVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  undefined **ppuVar12;
  ushort *puVar13;
  byte *pbVar14;
  ushort *puVar15;
  ushort uVar16;
  byte *pbVar17;
  uint uVar18;
  uint uVar19;
  uint *puVar20;
  int iVar21;
  uint uVar22;
  char *pcVar23;
  ushort uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  undefined1 auStack_d8 [32];
  int local_b8;
  int local_b4;
  uint local_b0;
  int local_ac;
  ushort *local_a8;
  undefined **local_a0;
  ushort *local_98;
  byte local_90;
  undefined1 uStack_8f;
  undefined4 uStack_8e;
  undefined4 uStack_8a;
  ushort uStack_86;
  undefined4 local_80;
  undefined2 uStack_7c;
  undefined2 uStack_7a;
  undefined4 uStack_78;
  undefined8 local_70;
  undefined4 local_68;
  char local_60 [23];
  char local_49;
  ulonglong local_40;
  
  local_40 = DAT_18004a880 ^ (ulonglong)auStack_d8;
  uVar9 = 0;
  uVar27 = 0;
  pcVar23 = local_60;
  uVar2 = 0;
  local_b0 = local_b0 & 0xffff0000;
  iVar10 = 0;
  local_b4 = 1;
  local_b8 = 0;
  uVar19 = 0;
  pbVar14 = param_3;
  local_ac = param_4;
  local_a8 = param_2;
  local_98 = param_1;
  if (param_8 == (longlong *)0x0) {
    pDVar5 = FUN_180021688();
    *pDVar5 = 0x16;
    FUN_180023e68();
    goto LAB_18002b4fa;
  }
  while ((uVar22 = uVar9, uVar3 = uVar9, uVar11 = uVar9, uVar18 = uVar9, uVar25 = uVar9,
         *pbVar14 < 0x21 &&
         (uVar22 = 0, uVar3 = 0, uVar11 = 0, uVar18 = 0, uVar25 = 0,
         (0x100002600U >> ((longlong)(char)*pbVar14 & 0x3fU) & 1) != 0))) {
    pbVar14 = pbVar14 + 1;
  }
LAB_18002ad5d:
  do {
    bVar6 = *pbVar14;
    pbVar17 = pbVar14 + 1;
    uVar26 = uVar27;
    if (uVar3 < 6) {
      if (uVar3 == 5) {
        local_b8 = 1;
        pbVar14 = param_3;
        uVar26 = 0;
        if (9 < (byte)(bVar6 - 0x30)) break;
        uVar3 = 4;
      }
      else {
        if (uVar3 != 0) {
          if (uVar3 == 1) {
            uVar22 = 1;
            if ((byte)(bVar6 - 0x31) < 9) {
              uVar3 = 3;
              pbVar14 = param_3;
              goto LAB_18002ae80;
            }
            if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) {
LAB_18002ae64:
              uVar22 = 1;
              uVar3 = 4;
              pbVar14 = pbVar17;
              goto LAB_18002ad5d;
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) goto LAB_18002ae14;
            if (bVar6 == 0x30) goto LAB_18002aeb8;
          }
          else {
            if (uVar3 == 2) {
              if ((byte)(bVar6 - 0x31) < 9) goto LAB_18002ae75;
              if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) goto LAB_18002ae99;
              pbVar14 = param_3;
              if (bVar6 == 0x30) goto LAB_18002aeb8;
              break;
            }
            if (uVar3 == 3) {
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
                if (uVar18 < 0x19) {
                  uVar18 = uVar18 + 1;
                  *pcVar23 = bVar6 - 0x30;
                  pcVar23 = pcVar23 + 1;
                }
                else {
                  uVar11 = uVar11 + 1;
                }
                bVar6 = *pbVar17;
                pbVar17 = pbVar17 + 1;
              }
              if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) goto LAB_18002ae64;
            }
            else {
              if (uVar3 != 4) goto LAB_18002b03b;
              local_b8 = 1;
              if (uVar18 == 0) {
                while (bVar6 == 0x30) {
                  uVar11 = uVar11 - 1;
                  bVar6 = *pbVar17;
                  pbVar17 = pbVar17 + 1;
                }
              }
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
                if (uVar18 < 0x19) {
                  uVar18 = uVar18 + 1;
                  *pcVar23 = bVar6 - 0x30;
                  pcVar23 = pcVar23 + 1;
                  uVar11 = uVar11 - 1;
                }
                bVar6 = *pbVar17;
                pbVar17 = pbVar17 + 1;
              }
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) {
LAB_18002ae14:
              uVar22 = 1;
              uVar3 = 0xb;
              pbVar14 = pbVar17 + -1;
              goto LAB_18002ad5d;
            }
          }
          uVar22 = 1;
          uVar26 = 0;
          if (((char)bVar6 < 'D') ||
             (('E' < (char)bVar6 && (uVar26 = uVar19, bVar6 != 100 && bVar6 != 0x65))))
          goto LAB_18002af35;
          uVar3 = 6;
          pbVar14 = pbVar17;
          uVar22 = 1;
          goto LAB_18002ad5d;
        }
        if (8 < (byte)(bVar6 - 0x31)) {
          if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) {
LAB_18002ae99:
            uVar3 = 5;
            pbVar14 = pbVar17;
          }
          else if (bVar6 == 0x2b) {
            uVar3 = 2;
            local_b0 = local_b0 & 0xffff0000;
            pbVar14 = pbVar17;
          }
          else if (bVar6 == 0x2d) {
            uVar3 = 2;
            local_b0 = 0x8000;
            pbVar14 = pbVar17;
          }
          else {
            uVar26 = uVar19;
            if (bVar6 != 0x30) goto LAB_18002af35;
LAB_18002aeb8:
            uVar3 = 1;
            pbVar14 = pbVar17;
          }
          goto LAB_18002ad5d;
        }
LAB_18002ae75:
        uVar3 = 3;
        pbVar14 = param_3;
      }
LAB_18002ae80:
      param_3 = pbVar14;
      pbVar14 = pbVar17 + -1;
      goto LAB_18002ad5d;
    }
    if (uVar3 == 6) {
      pbVar14 = pbVar14 + -1;
      if ((byte)(bVar6 - 0x31) < 9) goto LAB_18002b002;
      if (bVar6 != 0x2b) {
        if (bVar6 != 0x2d) goto LAB_18002b00c;
LAB_18002afb7:
        local_b4 = -1;
        uVar3 = 7;
        param_3 = pbVar14;
        pbVar14 = pbVar17;
        goto LAB_18002ad5d;
      }
      uVar3 = 7;
      param_3 = pbVar14;
    }
    else {
      if (uVar3 == 7) {
        pbVar14 = param_3;
        if ((byte)(bVar6 - 0x31) < 9) {
LAB_18002b002:
          uVar3 = 9;
          goto LAB_18002ae80;
        }
LAB_18002b00c:
        if (bVar6 != 0x30) break;
        uVar3 = 8;
        param_3 = pbVar14;
        pbVar14 = pbVar17;
        goto LAB_18002ad5d;
      }
      if (uVar3 == 8) {
        uVar25 = 1;
        while (bVar6 == 0x30) {
          bVar6 = *pbVar17;
          pbVar17 = pbVar17 + 1;
        }
        uVar26 = uVar19;
        if ((byte)(bVar6 - 0x31) < 9) {
          uVar3 = 9;
          pbVar14 = param_3;
          uVar25 = 1;
          goto LAB_18002ae80;
        }
        goto LAB_18002af35;
      }
      if (uVar3 == 9) {
        uVar25 = 1;
        uVar26 = uVar9;
        goto LAB_18002b07c;
      }
      if (uVar3 == 0xb) {
        uVar26 = uVar19;
        if (param_7 == 0) goto LAB_18002af35;
        if (bVar6 != 0x2b) {
          uVar26 = uVar27;
          if (bVar6 == 0x2d) goto LAB_18002afb7;
          break;
        }
        uVar3 = 7;
        param_3 = pbVar14;
        pbVar14 = pbVar17;
        goto LAB_18002ad5d;
      }
    }
LAB_18002b03b:
    pbVar14 = pbVar17;
  } while (uVar3 != 10);
  goto LAB_18002b0ad;
LAB_18002b07c:
  if (((char)bVar6 < '0') || ('9' < (char)bVar6)) goto LAB_18002b09a;
  uVar26 = (int)(char)bVar6 + (uVar26 * 5 + -0x18) * 2;
  if ((int)uVar26 < 0x1451) {
    bVar6 = *pbVar17;
    pbVar17 = pbVar17 + 1;
    goto LAB_18002b07c;
  }
  uVar26 = 0x1451;
LAB_18002b09a:
  while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
    bVar6 = *pbVar17;
    pbVar17 = pbVar17 + 1;
  }
LAB_18002af35:
  pbVar14 = pbVar17 + -1;
LAB_18002b0ad:
  *(byte **)param_2 = pbVar14;
  uVar7 = 0;
  uVar16 = uVar7;
  uVar24 = uVar7;
  iVar21 = iVar10;
  uStack_8e = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
  uStack_8a = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
  uStack_78 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
  local_80 = CONCAT22(local_80._2_2_,(ushort)local_80);
  if (uVar22 != 0) {
    if (0x18 < uVar18) {
      if ('\x04' < local_49) {
        local_49 = local_49 + '\x01';
      }
      pcVar23 = pcVar23 + -1;
      uVar18 = 0x18;
      uVar11 = uVar11 + 1;
    }
    uVar16 = uVar2;
    uVar24 = uVar2;
    uStack_8e = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
    uStack_8a = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
    uStack_78 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
    local_80 = CONCAT22(local_80._2_2_,(ushort)local_80);
    if (uVar18 != 0) {
      while (pcVar23 = pcVar23 + -1, *pcVar23 == '\0') {
        uVar18 = uVar18 - 1;
        uVar11 = uVar11 + 1;
      }
      FUN_18002c54c(local_60,uVar18,&local_80);
      uVar22 = CONCAT22(local_80._2_2_,(ushort)local_80);
      uVar19 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
      iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
      uVar27 = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
      if (local_b4 < 0) {
        uVar26 = -uVar26;
      }
      uVar26 = uVar26 + uVar11;
      if (uVar25 == 0) {
        uVar26 = uVar26 + param_5;
      }
      if (local_b8 == 0) {
        uVar26 = uVar26 - param_6;
      }
      local_80 = uVar22;
      if ((int)uVar26 < 0x1451) {
        if (-0x1451 < (int)uVar26) {
          ppuVar12 = &PTR_DAT_18004bd20;
          if (uVar26 != 0) {
            if ((int)uVar26 < 0) {
              uVar26 = -uVar26;
              ppuVar12 = (undefined **)0x18004be80;
            }
            if (local_ac == 0) {
              local_80._0_2_ = 0;
            }
            uVar27 = uStack_8e;
            iVar4 = uStack_8a;
            uVar19 = uStack_78;
            uVar22 = CONCAT22(local_80._2_2_,(ushort)local_80);
joined_r0x00018002b175:
            do {
              if (uVar26 == 0) break;
              uStack_78._2_2_ = (ushort)(uVar19 >> 0x10);
              ppuVar12 = (undefined **)((longlong)ppuVar12 + 0x54);
              uVar11 = (int)uVar26 >> 3;
              uVar3 = uVar26 & 7;
              uVar26 = uVar11;
              local_a0 = ppuVar12;
              if (uVar3 != 0) {
                local_a8 = (ushort *)((longlong)ppuVar12 + (longlong)(int)uVar3 * 0xc);
                if (0x7fff < *local_a8) {
                  puVar13 = local_a8 + 4;
                  uVar1 = *(undefined8 *)local_a8;
                  local_a8 = (ushort *)&local_70;
                  local_68 = *(undefined4 *)puVar13;
                  local_70._6_2_ = (undefined2)((ulonglong)uVar1 >> 0x30);
                  local_70._0_6_ = CONCAT42((int)((ulonglong)uVar1 >> 0x10) + -1,(ushort)uVar1);
                }
                local_90 = 0;
                uStack_8f = 0;
                uStack_8e._0_2_ = 0;
                uStack_8e._2_2_ = 0;
                uVar3 = 0;
                uStack_8a._0_2_ = 0;
                uVar2 = local_a8[5] & 0x7fff;
                uStack_8a._2_2_ = 0;
                iVar21 = 0;
                uStack_86 = 0;
                uVar24 = (local_a8[5] ^ uStack_78._2_2_) & 0x8000;
                uVar16 = (uStack_78._2_2_ & 0x7fff) + uVar2;
                uVar27 = 0;
                iVar4 = 0;
                if (((0x7ffe < (uStack_78._2_2_ & 0x7fff)) ||
                    (uVar27 = 0, iVar4 = 0, 0x7ffe < uVar2)) ||
                   (uVar27 = uVar3, iVar4 = iVar21, 0xbffd < uVar16)) {
LAB_18002b47b:
                  local_80._0_2_ = 0;
                  local_80._2_2_ = 0;
                  uVar22 = 0;
                  uStack_7c = 0;
                  uStack_7a = 0;
                  uVar19 = (-(uint)(uVar24 != 0) & 0x80000000) + 0x7fff8000;
                  uStack_78._0_2_ = (undefined2)uVar19;
                  uStack_78._2_2_ = (ushort)(uVar19 >> 0x10);
                  goto joined_r0x00018002b175;
                }
                if (0x3fbf < uVar16) {
                  if ((((uVar19 & 0x7fff0000) == 0) &&
                      (uVar16 = uVar16 + 1, (uVar19 & 0x7fffffff) == 0)) &&
                     ((CONCAT22(uStack_7a,uStack_7c) == 0 && (uVar22 == 0)))) {
                    uStack_78._2_2_ = 0;
                    uVar19 = uVar19 & 0xffff;
                    goto joined_r0x00018002b175;
                  }
                  if (((uVar2 != 0) ||
                      (uVar16 = uVar16 + 1, (*(uint *)(local_a8 + 4) & 0x7fffffff) != 0)) ||
                     ((*(int *)(local_a8 + 2) != 0 || (*(int *)local_a8 != 0)))) {
                    puVar20 = (uint *)&local_90;
                    iVar21 = 5;
                    uVar27 = uVar9;
                    do {
                      local_b8 = iVar21;
                      if (0 < iVar21) {
                        puVar13 = local_a8 + 4;
                        puVar15 = (ushort *)((longlong)&local_80 + (longlong)(int)(uVar27 * 2));
                        do {
                          uVar19 = *puVar20 + (uint)*puVar13 * (uint)*puVar15;
                          if ((uVar19 < *puVar20) ||
                             (iVar4 = iVar10, uVar19 < (uint)*puVar13 * (uint)*puVar15)) {
                            iVar4 = 1;
                          }
                          *puVar20 = uVar19;
                          if (iVar4 != 0) {
                            *(short *)(puVar20 + 1) = (short)puVar20[1] + 1;
                          }
                          puVar15 = puVar15 + 1;
                          puVar13 = puVar13 + -1;
                          local_b8 = local_b8 + -1;
                        } while (0 < local_b8);
                      }
                      iVar21 = iVar21 + -1;
                      puVar20 = (uint *)((longlong)puVar20 + 2);
                      uVar27 = uVar27 + 1;
                    } while (0 < iVar21);
                    uVar22 = CONCAT22(uStack_86,uStack_8a._2_2_);
                    uVar19 = CONCAT22((undefined2)uStack_8e,CONCAT11(uStack_8f,local_90));
                    uVar16 = uVar16 + 0xc002;
                    uVar27 = uVar19;
                    if ((short)uVar16 < 1) {
LAB_18002b37c:
                      uVar16 = uVar16 - 1;
                      if (-1 < (short)uVar16) goto LAB_18002b3e6;
                      uVar8 = (ulonglong)(ushort)-uVar16;
                      uVar16 = 0;
                      uVar27 = uVar9;
                      do {
                        uVar3 = uVar22;
                        if ((local_90 & 1) != 0) {
                          uVar27 = uVar27 + 1;
                        }
                        uVar11 = CONCAT22((ushort)uStack_8a,uStack_8e._2_2_);
                        uVar18 = uVar19 >> 1;
                        uStack_8a._0_2_ = (ushort)uStack_8a >> 1 | (ushort)((uVar3 << 0x1f) >> 0x10)
                        ;
                        uVar22 = uVar3 >> 1;
                        uVar19 = uVar18 | uVar11 << 0x1f;
                        uStack_8e._2_2_ = (ushort)(uVar11 >> 1);
                        local_90 = (byte)uVar18;
                        uStack_8f = (undefined1)(uVar18 >> 8);
                        uStack_8e._0_2_ = (undefined2)(uVar19 >> 0x10);
                        uVar8 = uVar8 - 1;
                      } while (uVar8 != 0);
                      uStack_8a._2_2_ = (undefined2)uVar22;
                      uStack_86 = (ushort)(uVar3 >> 0x11);
                      if (uVar27 == 0) goto LAB_18002b3e6;
                      uVar2 = (ushort)uVar18 | 1;
                      local_90 = (byte)uVar2;
                      uVar19 = CONCAT22((undefined2)uStack_8e,(ushort)uVar18) | 1;
                    }
                    else {
                      do {
                        uVar19 = uVar27;
                        if ((uVar22 & 0x80000000) != 0) break;
                        uVar3 = uVar22 * 2;
                        uVar19 = uVar27 * 2;
                        iVar21 = CONCAT22((ushort)uStack_8a,uStack_8e._2_2_) * 2;
                        uVar16 = uVar16 - 1;
                        uStack_8e._2_2_ = (ushort)iVar21 | (ushort)(uVar27 >> 0x1f);
                        uVar22 = uVar3 | (ushort)uStack_8a >> 0xf;
                        local_90 = (byte)uVar19;
                        uStack_8f = (undefined1)(uVar19 >> 8);
                        uStack_8e._0_2_ = (undefined2)(uVar19 >> 0x10);
                        uStack_8a._0_2_ = (ushort)((uint)iVar21 >> 0x10);
                        uStack_8a._2_2_ = (undefined2)uVar22;
                        uStack_86 = (ushort)(uVar3 >> 0x10);
                        uVar27 = uVar19;
                      } while (0 < (short)uVar16);
                      if ((short)uVar16 < 1) goto LAB_18002b37c;
LAB_18002b3e6:
                      uVar2 = CONCAT11(uStack_8f,local_90);
                    }
                    uVar27 = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
                    if ((0x8000 < uVar2) ||
                       (iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a),
                       (uVar19 & 0x1ffff) == 0x18000)) {
                      if (CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e) == -1) {
                        uStack_8e._0_2_ = 0;
                        uStack_8e._2_2_ = 0;
                        uVar27 = 0;
                        if (CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a) == -1) {
                          uStack_8a._0_2_ = 0;
                          uStack_8a._2_2_ = 0;
                          iVar4 = 0;
                          if (uStack_86 == 0xffff) {
                            uStack_86 = 0x8000;
                            uVar16 = uVar16 + 1;
                            iVar4 = 0;
                          }
                          else {
                            uStack_86 = uStack_86 + 1;
                          }
                        }
                        else {
                          iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a) + 1;
                          uStack_8a._0_2_ = (ushort)iVar4;
                          uStack_8a._2_2_ = (undefined2)((uint)iVar4 >> 0x10);
                        }
                        uStack_8a._2_2_ = (undefined2)((uint)iVar4 >> 0x10);
                        uVar22 = CONCAT22(uStack_86,uStack_8a._2_2_);
                      }
                      else {
                        uVar27 = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e) + 1;
                        uStack_8e._0_2_ = (undefined2)uVar27;
                        uStack_8e._2_2_ = (ushort)(uVar27 >> 0x10);
                        iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
                      }
                    }
                    uStack_8a._0_2_ = (ushort)iVar4;
                    if (0x7ffe < uVar16) goto LAB_18002b47b;
                    uStack_78._2_2_ = uVar16 | uVar24;
                    uStack_7a = (undefined2)uVar22;
                    uStack_78._0_2_ = (undefined2)(uVar22 >> 0x10);
                    uVar19 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
                    local_80 = uVar27;
                    uStack_7c = (ushort)uStack_8a;
                    uVar22 = uVar27;
                    goto joined_r0x00018002b175;
                  }
                }
                uStack_7c = 0;
                uStack_7a = 0;
                uStack_78._0_2_ = 0;
                uStack_78._2_2_ = 0;
                uVar19 = 0;
                local_80._0_2_ = 0;
                local_80._2_2_ = 0;
                uVar22 = 0;
              }
            } while( true );
          }
          local_80._2_2_ = (undefined2)(uVar22 >> 0x10);
          local_80._0_2_ = (ushort)uVar22;
          uStack_78._2_2_ = (ushort)(uVar19 >> 0x10);
          uStack_78._0_2_ = (undefined2)uVar19;
          iVar10 = CONCAT22(uStack_7c,local_80._2_2_);
          uVar16 = uStack_78._2_2_;
          uVar24 = (ushort)local_80;
          iVar21 = CONCAT22((undefined2)uStack_78,uStack_7a);
          uStack_8e = uVar27;
          uStack_8a = iVar4;
          uStack_78 = uVar19;
          local_80 = uVar22;
        }
      }
      else {
        uVar16 = 0x7fff;
        uVar24 = uVar7;
        iVar21 = -0x80000000;
      }
    }
  }
  local_98[5] = uVar16 | (ushort)local_b0;
  *local_98 = uVar24;
  *(int *)(local_98 + 1) = iVar10;
  *(int *)(local_98 + 3) = iVar21;
LAB_18002b4fa:
  FUN_18001fe50(local_40 ^ (ulonglong)auStack_d8);
  return;
}



void FUN_18002b524(int *param_1,int param_2,uint param_3,short *param_4)

{
  short *psVar1;
  undefined8 uVar2;
  code *pcVar3;
  undefined3 uVar4;
  bool bVar5;
  undefined1 uVar6;
  ushort uVar7;
  DWORD DVar8;
  short sVar9;
  ushort uVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint *puVar14;
  ulonglong uVar15;
  uint uVar16;
  uint uVar17;
  undefined **ppuVar18;
  char cVar19;
  ushort uVar20;
  uint uVar21;
  uint uVar22;
  longlong lVar23;
  short *psVar24;
  short *psVar25;
  int iVar26;
  int iVar27;
  ushort *puVar28;
  ushort *puVar29;
  undefined1 auStack_f8 [32];
  undefined8 local_d8;
  ushort local_c8;
  ushort local_c6;
  int local_c4;
  int local_c0;
  undefined2 local_bc;
  undefined **local_b8;
  undefined4 local_b0;
  int local_ac;
  int local_a8;
  short *local_a0;
  uint local_98;
  ushort *local_90;
  byte local_88;
  undefined1 uStack_87;
  undefined4 uStack_86;
  undefined4 uStack_82;
  ushort uStack_7e;
  undefined4 local_78;
  undefined2 uStack_74;
  undefined2 uStack_72;
  ushort uStack_70;
  undefined1 uStack_6e;
  byte bStack_6d;
  int local_68;
  int local_64;
  undefined4 local_60;
  undefined8 local_58;
  undefined4 local_50;
  ulonglong local_48;
  
  local_48 = DAT_18004a880 ^ (ulonglong)auStack_f8;
  iVar27 = *param_1;
  uVar21 = param_1[1];
  local_c6 = *(ushort *)(param_1 + 2) & 0x8000;
  uVar20 = *(ushort *)(param_1 + 2) & 0x7fff;
  local_68 = -0x33333334;
  local_64 = -0x33333334;
  local_60 = 0x3ffbcccc;
  if (local_c6 == 0) {
    *(undefined1 *)(param_4 + 1) = 0x20;
  }
  else {
    *(undefined1 *)(param_4 + 1) = 0x2d;
  }
  local_ac = param_2;
  local_a0 = param_4;
  local_98 = param_3;
  if (uVar20 == 0) {
    if ((uVar21 != 0) || (iVar27 != 0)) goto LAB_18002b6b6;
    uVar6 = 0x20;
    local_78 = CONCAT22(local_78._2_2_,(undefined2)local_78);
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
      local_78 = CONCAT22(local_78._2_2_,(undefined2)local_78);
    }
LAB_18002b5d1:
    *param_4 = 0;
    *(undefined1 *)(param_4 + 1) = uVar6;
    *(undefined2 *)((longlong)param_4 + 3) = 0x3001;
  }
  else {
    if (uVar20 == 0x7fff) {
      *param_4 = 1;
      if (((uVar21 == 0x80000000) && (iVar27 == 0)) || ((uVar21 >> 0x1e & 1) != 0)) {
        if ((local_c6 == 0) || (uVar21 != 0xc0000000)) {
          if ((uVar21 != 0x80000000) || (iVar27 != 0)) goto LAB_18002b68d;
          DVar8 = FUN_180027388((undefined1 *)(param_4 + 2),0x16,"1#INF");
          if (DVar8 != 0) {
            local_d8 = 0;
            FUN_180023e88();
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        else {
          if (iVar27 != 0) {
LAB_18002b68d:
            DVar8 = FUN_180027388((undefined1 *)(param_4 + 2),0x16,"1#QNAN");
            if (DVar8 != 0) {
              local_d8 = 0;
              FUN_180023e88();
              pcVar3 = (code *)swi(3);
              (*pcVar3)();
              return;
            }
            goto LAB_18002b6aa;
          }
          DVar8 = FUN_180027388((undefined1 *)(param_4 + 2),0x16,"1#IND");
          if (DVar8 != 0) {
            local_d8 = 0;
            FUN_180023e88();
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        *(undefined1 *)((longlong)param_4 + 3) = 5;
      }
      else {
        DVar8 = FUN_180027388((undefined1 *)(param_4 + 2),0x16,"1#SNAN");
        if (DVar8 != 0) {
          local_d8 = 0;
          FUN_180023e88();
          pcVar3 = (code *)swi(3);
          (*pcVar3)();
          return;
        }
LAB_18002b6aa:
        *(undefined1 *)((longlong)param_4 + 3) = 6;
      }
      goto LAB_18002bf42;
    }
LAB_18002b6b6:
    local_78._2_2_ = (undefined2)iVar27;
    uStack_74 = (undefined2)((uint)iVar27 >> 0x10);
    uStack_6e = (undefined1)uVar20;
    bStack_6d = (byte)(uVar20 >> 8);
    ppuVar18 = &PTR_DAT_18004bd20;
    uStack_72 = (undefined2)uVar21;
    uStack_70 = (ushort)(uVar21 >> 0x10);
    local_78._0_2_ = 0;
    uVar22 = iVar27 << 0x10;
    uVar12 = iVar27 << 0x10;
    local_a8 = 5;
    iVar11 = ((uint)(uVar20 >> 8) + (uVar21 >> 0x18) * 2) * 0x4d +
             (uint)uVar20 * 0x4d10 + -0x134312f4;
    local_c0 = iVar11 >> 0x10;
    sVar9 = (short)((uint)iVar11 >> 0x10);
    uVar21 = (uint)sVar9;
    if (-uVar21 == 0) {
LAB_18002ba90:
      uVar21 = CONCAT22(uStack_72,uStack_74);
      local_78 = iVar27 << 0x10;
    }
    else {
      uVar16 = -uVar21;
      if (0 < (int)uVar21) {
        ppuVar18 = (undefined **)0x18004be80;
        uVar16 = uVar21;
      }
      if (uVar16 == 0) goto LAB_18002ba90;
      uVar21 = CONCAT22(uStack_72,uStack_74);
      local_78 = iVar27 << 0x10;
      do {
        iVar27 = 0;
        ppuVar18 = (undefined **)((longlong)ppuVar18 + 0x54);
        uVar22 = (int)uVar16 >> 3;
        if ((uVar16 & 7) != 0) {
          local_90 = (ushort *)((longlong)ppuVar18 + (longlong)(int)(uVar16 & 7) * 0xc);
          if (0x7fff < *local_90) {
            puVar29 = local_90 + 4;
            uVar2 = *(undefined8 *)local_90;
            local_90 = (ushort *)&local_58;
            local_50 = *(undefined4 *)puVar29;
            local_58._6_2_ = (undefined2)((ulonglong)uVar2 >> 0x30);
            local_58._0_6_ = CONCAT42((int)((ulonglong)uVar2 >> 0x10) + -1,(ushort)uVar2);
          }
          local_c4 = 0;
          uVar10 = local_90[5] & 0x7fff;
          local_88 = 0;
          uStack_87 = 0;
          uStack_86._0_2_ = 0;
          uStack_86._2_2_ = 0;
          uStack_86 = 0;
          uStack_82._0_2_ = 0;
          uVar7 = CONCAT11(bStack_6d,uStack_6e) & 0x7fff;
          uStack_82._2_2_ = 0;
          iVar11 = 0;
          uStack_82 = 0;
          uStack_7e = 0;
          local_c8 = (local_90[5] ^ CONCAT11(bStack_6d,uStack_6e)) & 0x8000;
          uVar20 = uVar7 + uVar10;
          if (((uVar7 < 0x7fff) && (uVar10 < 0x7fff)) && (uVar20 < 0xbffe)) {
            if (0x3fbf < uVar20) {
              if (((uVar7 == 0) &&
                  (uVar20 = uVar20 + 1,
                  (CONCAT13(bStack_6d,CONCAT12(uStack_6e,uStack_70)) & 0x7fffffff) == 0)) &&
                 ((uVar21 == 0 && (local_78 == 0)))) {
                uStack_6e = 0;
                bStack_6d = 0;
                uStack_86 = 0;
                goto LAB_18002ba79;
              }
              if (((uVar10 == 0) &&
                  (uVar20 = uVar20 + 1, (*(uint *)(local_90 + 4) & 0x7fffffff) == 0)) &&
                 ((*(int *)(local_90 + 2) == 0 && (*(int *)local_90 == 0)))) goto LAB_18002b800;
              iVar11 = 5;
              puVar14 = (uint *)&local_88;
              do {
                if (0 < iVar11) {
                  puVar29 = local_90 + 4;
                  puVar28 = (ushort *)((longlong)&local_78 + (longlong)(iVar27 * 2));
                  iVar26 = iVar11;
                  do {
                    uVar21 = *puVar14 + (uint)*puVar28 * (uint)*puVar29;
                    if ((uVar21 < *puVar14) ||
                       (bVar5 = false, uVar21 < (uint)*puVar28 * (uint)*puVar29)) {
                      bVar5 = true;
                    }
                    *puVar14 = uVar21;
                    if (bVar5) {
                      *(short *)(puVar14 + 1) = (short)puVar14[1] + 1;
                    }
                    iVar26 = iVar26 + -1;
                    puVar28 = puVar28 + 1;
                    puVar29 = puVar29 + -1;
                  } while (0 < iVar26);
                }
                iVar11 = iVar11 + -1;
                puVar14 = (uint *)((longlong)puVar14 + 2);
                iVar27 = iVar27 + 1;
              } while (0 < iVar11);
              uVar12 = CONCAT22(uStack_7e,uStack_82._2_2_);
              uVar21 = CONCAT22((undefined2)uStack_86,CONCAT11(uStack_87,local_88));
              uVar20 = uVar20 + 0xc002;
              uVar16 = uVar21;
              if ((short)uVar20 < 1) {
LAB_18002b932:
                uVar20 = uVar20 - 1;
                if (-1 < (short)uVar20) goto LAB_18002b99f;
                uVar15 = (ulonglong)(ushort)-uVar20;
                local_bc = 0;
                iVar27 = local_c4;
                do {
                  uVar16 = uVar12;
                  if ((local_88 & 1) != 0) {
                    iVar27 = iVar27 + 1;
                  }
                  uVar13 = CONCAT22((ushort)uStack_82,uStack_86._2_2_);
                  uVar17 = uVar21 >> 1;
                  uStack_82._0_2_ = (ushort)uStack_82 >> 1 | (ushort)((uVar16 << 0x1f) >> 0x10);
                  uVar12 = uVar16 >> 1;
                  uVar21 = uVar17 | uVar13 << 0x1f;
                  uStack_86._2_2_ = (ushort)(uVar13 >> 1);
                  local_88 = (byte)uVar17;
                  uStack_87 = (undefined1)(uVar17 >> 8);
                  uStack_86._0_2_ = (undefined2)(uVar21 >> 0x10);
                  uVar15 = uVar15 - 1;
                } while (uVar15 != 0);
                uVar20 = 0;
                uStack_82._2_2_ = (undefined2)uVar12;
                uStack_7e = (ushort)(uVar16 >> 0x11);
                if (iVar27 == 0) goto LAB_18002b99f;
                uVar7 = (ushort)uVar17 | 1;
                local_88 = (byte)uVar7;
                uVar21 = CONCAT22((undefined2)uStack_86,(ushort)uVar17) | 1;
              }
              else {
                do {
                  uVar21 = uVar16;
                  if ((uVar12 & 0x80000000) != 0) break;
                  uVar13 = uVar12 * 2;
                  uVar21 = uVar16 * 2;
                  iVar27 = CONCAT22((ushort)uStack_82,uStack_86._2_2_) * 2;
                  uVar20 = uVar20 - 1;
                  uStack_86._2_2_ = (ushort)iVar27 | (ushort)(uVar16 >> 0x1f);
                  uVar12 = uVar13 | (ushort)uStack_82 >> 0xf;
                  local_88 = (byte)uVar21;
                  uStack_87 = (undefined1)(uVar21 >> 8);
                  uStack_86._0_2_ = (undefined2)(uVar21 >> 0x10);
                  uStack_82._0_2_ = (ushort)((uint)iVar27 >> 0x10);
                  uStack_82._2_2_ = (undefined2)uVar12;
                  uStack_7e = (ushort)(uVar13 >> 0x10);
                  uVar16 = uVar21;
                } while (0 < (short)uVar20);
                if ((short)uVar20 < 1) goto LAB_18002b932;
LAB_18002b99f:
                uVar7 = CONCAT11(uStack_87,local_88);
              }
              local_78 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86);
              if ((0x8000 < uVar7) ||
                 (uStack_82 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82),
                 (uVar21 & 0x1ffff) == 0x18000)) {
                if (CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) == -1) {
                  uStack_86._0_2_ = 0;
                  uStack_86._2_2_ = 0;
                  local_78 = 0;
                  if (CONCAT22(uStack_82._2_2_,(ushort)uStack_82) == -1) {
                    uStack_82._0_2_ = 0;
                    uStack_82._2_2_ = 0;
                    iVar27 = 0;
                    if (uStack_7e == 0xffff) {
                      uStack_7e = 0x8000;
                      uVar20 = uVar20 + 1;
                      iVar27 = 0;
                    }
                    else {
                      uStack_7e = uStack_7e + 1;
                    }
                  }
                  else {
                    iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82) + 1;
                    uStack_82._0_2_ = (ushort)iVar27;
                    uStack_82._2_2_ = (undefined2)((uint)iVar27 >> 0x10);
                  }
                  uStack_82._2_2_ = (undefined2)((uint)iVar27 >> 0x10);
                  uVar12 = CONCAT22(uStack_7e,uStack_82._2_2_);
                  uStack_82 = iVar27;
                }
                else {
                  local_78 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) + 1;
                  uStack_86._0_2_ = (undefined2)local_78;
                  uStack_86._2_2_ = (ushort)(local_78 >> 0x10);
                  uStack_82 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82);
                }
              }
              uStack_86 = local_78;
              iVar11 = uStack_82;
              if (uVar20 < 0x7fff) {
                bStack_6d = (byte)(uVar20 >> 8) | (byte)(local_c8 >> 8);
                uStack_72 = (undefined2)uVar12;
                uStack_70 = (ushort)(uVar12 >> 0x10);
                uStack_74 = (ushort)uStack_82;
                uVar21 = CONCAT22(uStack_72,(ushort)uStack_82);
                uStack_6e = (undefined1)uVar20;
                uVar12 = local_78;
                goto LAB_18002ba79;
              }
              goto LAB_18002ba5b;
            }
LAB_18002b800:
            uStack_74 = 0;
            uStack_72 = 0;
            uStack_70 = 0;
            uStack_6e = 0;
            bStack_6d = 0;
            uStack_82 = iVar11;
          }
          else {
LAB_18002ba5b:
            uStack_74 = 0;
            uStack_72 = 0;
            iVar27 = (-(uint)(local_c8 != 0) & 0x80000000) + 0x7fff8000;
            uStack_70 = (ushort)iVar27;
            uStack_6e = (undefined1)((uint)iVar27 >> 0x10);
            bStack_6d = (byte)((uint)iVar27 >> 0x18);
            uStack_82 = iVar11;
          }
          uStack_72 = 0;
          uStack_74 = 0;
          uVar21 = 0;
          local_78._0_2_ = 0;
          local_78._2_2_ = 0;
          local_78 = uVar21;
          uVar12 = 0;
        }
LAB_18002ba79:
        uVar16 = uVar22;
      } while (uVar22 != 0);
      local_b0 = 0;
      local_b8 = ppuVar18;
      uVar22 = uVar12;
    }
    iVar27 = 0;
    uVar12 = CONCAT13(bStack_6d,CONCAT12(uStack_6e,uStack_70));
    uVar20 = (ushort)(uVar12 >> 0x10);
    uVar16 = uVar21;
    if (0x3ffe < uVar20) {
      local_c0 = CONCAT22(sVar9 >> 0xf,sVar9 + 1);
      uVar16 = 0;
      local_c4 = 0;
      local_88 = 0;
      uStack_87 = 0;
      uStack_86._0_2_ = 0;
      uStack_86._2_2_ = 0;
      uStack_86 = 0;
      uStack_82._0_2_ = 0;
      uStack_82._2_2_ = 0;
      uStack_82 = 0;
      uStack_7e = 0;
      uVar10 = (local_60._2_2_ ^ uVar20) & 0x8000;
      uVar7 = (uVar20 & 0x7fff) + (local_60._2_2_ & 0x7fff);
      if ((((uVar20 & 0x7fff) < 0x7fff) && ((local_60._2_2_ & 0x7fff) < 0x7fff)) && (uVar7 < 0xbffe)
         ) {
        if (uVar7 < 0x3fc0) {
LAB_18002bb14:
          uStack_70 = 0;
          uStack_6e = 0;
          bStack_6d = 0;
          local_78 = uVar16;
        }
        else if ((((uVar12 & 0x7fff0000) == 0) &&
                 (uVar7 = uVar7 + 1,
                 (CONCAT13(bStack_6d,CONCAT12(uStack_6e,uStack_70)) & 0x7fffffff) == 0)) &&
                ((uVar21 == 0 && (local_78 == 0)))) {
          uStack_6e = 0;
          bStack_6d = 0;
          uVar16 = uVar21;
          uStack_86 = 0;
          uStack_82 = 0;
        }
        else {
          if ((((local_60 & 0x7fff0000) == 0) && (uVar7 = uVar7 + 1, (local_60 & 0x7fffffff) == 0))
             && ((local_64 == 0 && (local_68 == 0)))) goto LAB_18002bb14;
          puVar14 = (uint *)&local_88;
          uVar21 = uVar22;
          do {
            if (0 < local_a8) {
              puVar29 = (ushort *)&local_60;
              puVar28 = (ushort *)((longlong)&local_78 + (longlong)(iVar27 * 2));
              iVar11 = local_a8;
              do {
                bVar5 = false;
                uVar22 = *puVar14 + (uint)*puVar29 * (uint)*puVar28;
                if ((uVar22 < *puVar14) || (uVar22 < (uint)*puVar29 * (uint)*puVar28)) {
                  bVar5 = true;
                }
                local_78 = uVar21;
                *puVar14 = uVar22;
                uVar21 = local_78;
                if (bVar5) {
                  *(short *)(puVar14 + 1) = (short)puVar14[1] + 1;
                  uVar21 = local_78;
                }
                iVar11 = iVar11 + -1;
                puVar28 = puVar28 + 1;
                puVar29 = puVar29 + -1;
              } while (0 < iVar11);
            }
            local_a8 = local_a8 + -1;
            puVar14 = (uint *)((longlong)puVar14 + 2);
            iVar27 = iVar27 + 1;
          } while (0 < local_a8);
          uVar16 = CONCAT22(uStack_7e,uStack_82._2_2_);
          uVar12 = CONCAT22((undefined2)uStack_86,CONCAT11(uStack_87,local_88));
          uVar7 = uVar7 + 0xc002;
          uVar22 = uVar12;
          if ((short)uVar7 < 1) {
LAB_18002bc39:
            uVar7 = uVar7 - 1;
            if (-1 < (short)uVar7) goto LAB_18002bc9e;
            uVar15 = (ulonglong)(ushort)-uVar7;
            uVar7 = 0;
            iVar27 = local_c4;
            do {
              uVar22 = uVar16;
              if ((local_88 & 1) != 0) {
                iVar27 = iVar27 + 1;
              }
              uVar13 = CONCAT22((ushort)uStack_82,uStack_86._2_2_);
              uVar17 = uVar12 >> 1;
              uStack_82._0_2_ = (ushort)uStack_82 >> 1 | (ushort)((uVar22 << 0x1f) >> 0x10);
              uVar16 = uVar22 >> 1;
              uVar12 = uVar17 | uVar13 << 0x1f;
              uStack_86._2_2_ = (ushort)(uVar13 >> 1);
              local_88 = (byte)uVar17;
              uStack_87 = (undefined1)(uVar17 >> 8);
              uStack_86._0_2_ = (undefined2)(uVar12 >> 0x10);
              uVar15 = uVar15 - 1;
            } while (uVar15 != 0);
            uStack_82._2_2_ = (undefined2)uVar16;
            uStack_7e = (ushort)(uVar22 >> 0x11);
            if (iVar27 == 0) goto LAB_18002bc9e;
            uVar20 = (ushort)uVar17 | 1;
            local_88 = (byte)uVar20;
            uVar12 = CONCAT22((undefined2)uStack_86,(ushort)uVar17) | 1;
          }
          else {
            do {
              uVar12 = uVar22;
              if ((uVar16 & 0x80000000) != 0) break;
              uVar13 = uVar16 * 2;
              uVar12 = uVar22 * 2;
              iVar27 = CONCAT22((ushort)uStack_82,uStack_86._2_2_) * 2;
              uVar7 = uVar7 - 1;
              uStack_86._2_2_ = (ushort)iVar27 | (ushort)(uVar22 >> 0x1f);
              uVar16 = uVar13 | (ushort)uStack_82 >> 0xf;
              local_88 = (byte)uVar12;
              uStack_87 = (undefined1)(uVar12 >> 8);
              uStack_86._0_2_ = (undefined2)(uVar12 >> 0x10);
              uStack_82._0_2_ = (ushort)((uint)iVar27 >> 0x10);
              uStack_82._2_2_ = (undefined2)uVar16;
              uStack_7e = (ushort)(uVar13 >> 0x10);
              uVar22 = uVar12;
            } while (0 < (short)uVar7);
            if ((short)uVar7 < 1) goto LAB_18002bc39;
LAB_18002bc9e:
            uVar20 = CONCAT11(uStack_87,local_88);
          }
          uVar22 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86);
          if ((0x8000 < uVar20) ||
             (iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82), (uVar12 & 0x1ffff) == 0x18000))
          {
            if (CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) == -1) {
              uVar22 = 0;
              if (CONCAT22(uStack_82._2_2_,(ushort)uStack_82) == -1) {
                iVar27 = 0;
                if (uStack_7e == 0xffff) {
                  uStack_7e = 0x8000;
                  uVar7 = uVar7 + 1;
                  iVar27 = 0;
                }
                else {
                  uStack_7e = uStack_7e + 1;
                }
              }
              else {
                iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82) + 1;
              }
              uStack_82._2_2_ = (undefined2)((uint)iVar27 >> 0x10);
              uVar16 = CONCAT22(uStack_7e,uStack_82._2_2_);
            }
            else {
              uVar22 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) + 1;
              iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82);
            }
          }
          uStack_82._0_2_ = (ushort)iVar27;
          uStack_82 = iVar27;
          uStack_86 = uVar22;
          if (uVar7 < 0x7fff) {
            bStack_6d = (byte)(uVar7 >> 8) | (byte)(uVar10 >> 8);
            uStack_72 = (undefined2)uVar16;
            uStack_70 = (ushort)(uVar16 >> 0x10);
            uStack_6e = (undefined1)uVar7;
            uStack_74 = (ushort)uStack_82;
            uVar16 = CONCAT22(uStack_72,(ushort)uStack_82);
            local_78 = uVar22;
          }
          else {
            iVar27 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
            uStack_70 = (ushort)iVar27;
            uStack_6e = (undefined1)((uint)iVar27 >> 0x10);
            bStack_6d = (byte)((uint)iVar27 >> 0x18);
            uVar16 = 0;
            local_78 = 0;
            uVar22 = uVar21;
          }
        }
      }
      else {
        iVar27 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
        uStack_70 = (ushort)iVar27;
        uStack_6e = (undefined1)((uint)iVar27 >> 0x10);
        bStack_6d = (byte)((uint)iVar27 >> 0x18);
        local_78 = uVar16;
      }
    }
    *param_4 = (short)local_c0;
    iVar27 = param_2;
    if (((param_3 & 1) != 0) && (iVar27 = param_2 + (short)local_c0, iVar27 < 1)) {
      uVar6 = 0x20;
      local_78 = uVar22;
      if (local_c6 == 0x8000) {
        uVar6 = 0x2d;
      }
      goto LAB_18002b5d1;
    }
    uVar4 = CONCAT12(uStack_6e,uStack_70);
    uStack_6e = 0;
    uVar21 = (uint)uStack_70;
    lVar23 = 8;
    if (0x15 < iVar27) {
      iVar27 = 0x15;
    }
    iVar11 = (CONCAT13(bStack_6d,uVar4) >> 0x10) - 0x3ffe;
    do {
      uVar22 = uVar16 * 2;
      uVar12 = uVar16 >> 0x1f;
      uVar16 = uVar22 | local_78 >> 0x1f;
      uVar21 = uVar21 * 2 | uVar12;
      local_78 = local_78 * 2;
      lVar23 = lVar23 + -1;
    } while (lVar23 != 0);
    uStack_74 = (undefined2)uVar16;
    uStack_72 = (undefined2)(uVar22 >> 0x10);
    if ((iVar11 < 0) && (uVar22 = -iVar11 & 0xff, uVar22 != 0)) {
      do {
        uVar17 = uVar16 >> 1;
        uVar12 = uVar21 << 0x1f;
        uVar13 = uVar16 << 0x1f;
        uVar22 = uVar22 - 1;
        uVar21 = uVar21 >> 1;
        uVar16 = uVar17 | uVar12;
        local_78 = local_78 >> 1 | uVar13;
      } while (0 < (int)uVar22);
      uStack_74 = (undefined2)uVar17;
      uStack_72 = (undefined2)(uVar16 >> 0x10);
    }
    iVar27 = iVar27 + 1;
    psVar1 = param_4 + 2;
    psVar24 = psVar1;
    if (0 < iVar27) {
      while( true ) {
        local_58 = CONCAT26(uStack_72,CONCAT24(uStack_74,local_78));
        uVar12 = (uVar16 * 2 | local_78 >> 0x1f) * 2 | local_78 * 2 >> 0x1f;
        uVar22 = local_78 * 5;
        uVar13 = (uVar21 * 2 | uVar16 >> 0x1f) * 2 | uVar16 * 2 >> 0x1f;
        if ((uVar22 < local_78 * 4) || (uVar16 = uVar12, uVar22 < local_78)) {
          uVar16 = uVar12 + 1;
          if ((uVar16 < uVar12) || (bVar5 = false, uVar16 == 0)) {
            bVar5 = true;
          }
          if (bVar5) {
            uVar13 = uVar13 + 1;
          }
        }
        uVar12 = (uint)((ulonglong)local_58 >> 0x20);
        uVar17 = uVar16 + uVar12;
        if ((uVar17 < uVar16) || (uVar17 < uVar12)) {
          uVar13 = uVar13 + 1;
        }
        local_78 = local_78 * 10;
        uVar16 = uVar17 * 2 | uVar22 >> 0x1f;
        uVar21 = (uVar13 + uVar21) * 2;
        iVar27 = iVar27 + -1;
        uStack_70 = (ushort)uVar21 | (ushort)(uVar17 >> 0x1f);
        uStack_74 = (undefined2)uVar16;
        uStack_72 = (undefined2)(uVar17 * 2 >> 0x10);
        uStack_6e = (undefined1)(uVar21 >> 0x10);
        *(char *)psVar24 = (char)(uVar21 >> 0x18) + '0';
        psVar24 = (short *)((longlong)psVar24 + 1);
        if (iVar27 < 1) break;
        uVar21 = uVar21 & 0xffffff | uVar17 >> 0x1f;
      }
    }
    bStack_6d = 0;
    psVar25 = psVar24 + -1;
    if ('4' < *(char *)((longlong)psVar24 + -1)) {
      for (; (psVar1 <= psVar25 && ((char)*psVar25 == '9'));
          psVar25 = (short *)((longlong)psVar25 + -1)) {
        *(char *)psVar25 = '0';
      }
      if (psVar25 < psVar1) {
        psVar25 = (short *)((longlong)psVar25 + 1);
        *param_4 = *param_4 + 1;
      }
      *(char *)psVar25 = (char)*psVar25 + '\x01';
LAB_18002bf2e:
      cVar19 = ((char)psVar25 - (char)param_4) + -3;
      *(char *)((longlong)param_4 + 3) = cVar19;
      *(undefined1 *)((longlong)cVar19 + 4 + (longlong)param_4) = 0;
      goto LAB_18002bf42;
    }
    for (; (psVar1 <= psVar25 && ((char)*psVar25 == '0'));
        psVar25 = (short *)((longlong)psVar25 + -1)) {
    }
    if (psVar1 <= psVar25) goto LAB_18002bf2e;
    *param_4 = 0;
    *(undefined1 *)((longlong)param_4 + 3) = 1;
    uVar6 = 0x20;
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
    }
    *(undefined1 *)(param_4 + 1) = uVar6;
    *(char *)psVar1 = '0';
  }
  *(undefined1 *)((longlong)param_4 + 5) = 0;
LAB_18002bf42:
  FUN_18001fe50(local_48 ^ (ulonglong)auStack_f8);
  return;
}



int FUN_18002bffc(void)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  int iVar5;
  
  iVar5 = 0;
  FUN_1800268b0(1);
  for (iVar3 = 3; iVar3 < DAT_18004dc98; iVar3 = iVar3 + 1) {
    lVar4 = (longlong)iVar3;
    piVar1 = *(int **)(DAT_18004dc90 + lVar4 * 8);
    if (piVar1 != (int *)0x0) {
      if ((*(byte *)(piVar1 + 6) & 0x83) != 0) {
        iVar2 = FUN_18002c7ec(piVar1);
        if (iVar2 != -1) {
          iVar5 = iVar5 + 1;
        }
      }
      if (0x13 < iVar3) {
        DeleteCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(DAT_18004dc90 + lVar4 * 8) + 0x30))
        ;
        FUN_18001fcb8(*(LPVOID *)(DAT_18004dc90 + lVar4 * 8));
        *(undefined8 *)(DAT_18004dc90 + lVar4 * 8) = 0;
      }
    }
  }
  FUN_180026aa0(1);
  return iVar5;
}



undefined8 FUN_18002c0a4(uint param_1)

{
  int *piVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
  lVar2 = (&DAT_18004d5a0)[(longlong)(int)param_1 >> 5];
  if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
    FUN_1800268b0(10);
    if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
      FUN_18002290c((LPCRITICAL_SECTION)(lVar3 + 0x10 + lVar2),4000);
      piVar1 = (int *)(lVar3 + 0xc + lVar2);
      *piVar1 = *piVar1 + 1;
    }
    FUN_180026aa0(10);
  }
  EnterCriticalSection
            ((LPCRITICAL_SECTION)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 0x10 + lVar3));
  return 1;
}



undefined8 FUN_18002c13c(uint param_1)

{
  DWORD *pDVar1;
  DWORD nStdHandle;
  longlong lVar2;
  
  if ((-1 < (int)param_1) && (param_1 < DAT_18004eca0)) {
    lVar2 = (ulonglong)(param_1 & 0x1f) * 0x58;
    if (((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar2) & 1) != 0) &&
       (*(longlong *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + lVar2) != -1)) {
      if (DAT_18004cf20 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_18002c1b2;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_18002c1b2:
      *(undefined8 *)(lVar2 + (&DAT_18004d5a0)[(longlong)(int)param_1 >> 5]) = 0xffffffffffffffff;
      return 0;
    }
  }
  pDVar1 = FUN_180021688();
  *pDVar1 = 9;
  pDVar1 = FUN_180021618();
  *pDVar1 = 0;
  return 0xffffffff;
}



undefined8 FUN_18002c1e8(uint param_1)

{
  DWORD *pDVar1;
  longlong lVar2;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_180021618();
    *pDVar1 = 0;
    pDVar1 = FUN_180021688();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004eca0)) {
      lVar2 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar2) & 1) != 0) {
        return *(undefined8 *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + lVar2);
      }
    }
    pDVar1 = FUN_180021618();
    *pDVar1 = 0;
    pDVar1 = FUN_180021688();
    *pDVar1 = 9;
    FUN_180023e68();
  }
  return 0xffffffffffffffff;
}



void FUN_18002c25c(uint param_1)

{
                    // WARNING: Could not recover jumptable at 0x00018002c27f. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((ulonglong)(param_1 & 0x1f) * 0x58 + 0x10 +
             (&DAT_18004d5a0)[(longlong)(int)param_1 >> 5]));
  return;
}



undefined2 FUN_18002c288(undefined2 param_1)

{
  BOOL BVar1;
  undefined2 local_res8 [4];
  DWORD local_res10 [6];
  
  local_res8[0] = param_1;
  if (DAT_18004c040 == (HANDLE)0xfffffffffffffffe) {
    FUN_18002c874();
  }
  if ((DAT_18004c040 == (HANDLE)0xffffffffffffffff) ||
     (BVar1 = WriteConsoleW(DAT_18004c040,local_res8,1,local_res10,(LPVOID)0x0), BVar1 == 0)) {
    local_res8[0] = 0xffff;
  }
  return local_res8[0];
}



undefined2 FUN_18002c2e4(WCHAR param_1,undefined **param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  DWORD *pDVar4;
  undefined **ppuVar5;
  undefined7 extraout_var;
  longlong lVar6;
  undefined *puVar7;
  uint uVar8;
  WCHAR local_res10 [4];
  
  uVar2 = FUN_1800282f4((longlong)param_2);
  uVar8 = *(uint *)(param_2 + 3);
  if ((uVar8 & 0x82) == 0) {
    pDVar4 = FUN_180021688();
    *pDVar4 = 9;
  }
  else if ((uVar8 & 0x40) == 0) {
    uVar3 = 0;
    if ((uVar8 & 1) != 0) {
      *(undefined4 *)(param_2 + 1) = 0;
      if ((uVar8 & 0x10) == 0) {
        *(uint *)(param_2 + 3) = uVar8 | 0x20;
        return 0xffff;
      }
      *param_2 = param_2[2];
      *(uint *)(param_2 + 3) = uVar8 & 0xfffffffe;
    }
    uVar8 = *(uint *)(param_2 + 3);
    *(undefined4 *)(param_2 + 1) = 0;
    *(uint *)(param_2 + 3) = uVar8 & 0xffffffef | 2;
    if (((uVar8 & 0x10c) == 0) &&
       (((ppuVar5 = FUN_1800281e0(), param_2 != ppuVar5 + 6 &&
         (ppuVar5 = FUN_1800281e0(), param_2 != ppuVar5 + 0xc)) ||
        (bVar1 = FUN_18002831c(uVar2), (int)CONCAT71(extraout_var,bVar1) == 0)))) {
      FUN_180028dd0(param_2);
    }
    if (((ulonglong)param_2[3] & 0x108) == 0) {
      uVar8 = 2;
      local_res10[0] = param_1;
      uVar3 = FUN_18002837c(uVar2,local_res10,2);
    }
    else {
      uVar8 = *(int *)param_2 - *(int *)(param_2 + 2);
      *param_2 = (undefined *)((longlong)param_2[2] + 2);
      *(int *)(param_2 + 1) = *(int *)((longlong)param_2 + 0x24) + -2;
      if ((int)uVar8 < 1) {
        if (uVar2 + 2 < 2) {
          puVar7 = &DAT_18004b430;
        }
        else {
          puVar7 = (undefined *)
                   ((ulonglong)(uVar2 & 0x1f) * 0x58 + (&DAT_18004d5a0)[(longlong)(int)uVar2 >> 5]);
        }
        if (((puVar7[8] & 0x20) != 0) &&
           (lVar6 = FUN_180028c54(uVar2,(LARGE_INTEGER)0x0,2), lVar6 == -1)) goto LAB_18002c31a;
      }
      else {
        uVar3 = FUN_18002837c(uVar2,(WCHAR *)param_2[2],uVar8);
      }
      *(WCHAR *)param_2[2] = param_1;
    }
    if (uVar3 == uVar8) {
      return param_1;
    }
  }
  else {
    pDVar4 = FUN_180021688();
    *pDVar4 = 0x22;
  }
LAB_18002c31a:
  *(uint *)(param_2 + 3) = *(uint *)(param_2 + 3) | 0x20;
  return 0xffff;
}



DWORD FUN_18002c474(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  HANDLE hFile;
  longlong lVar4;
  
  if (param_1 == 0xfffffffe) {
    pDVar3 = FUN_180021688();
    *pDVar3 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004eca0)) {
      lVar4 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar4) & 1) != 0) {
        FUN_18002c0a4(param_1);
        if ((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar4) & 1) != 0) {
          hFile = (HANDLE)FUN_18002c1e8(param_1);
          BVar1 = FlushFileBuffers(hFile);
          if (BVar1 == 0) {
            DVar2 = GetLastError();
          }
          else {
            DVar2 = 0;
          }
          if (DVar2 == 0) goto LAB_18002c51f;
          pDVar3 = FUN_180021618();
          *pDVar3 = DVar2;
        }
        pDVar3 = FUN_180021688();
        *pDVar3 = 9;
        DVar2 = 0xffffffff;
LAB_18002c51f:
        FUN_18002c25c(param_1);
        return DVar2;
      }
    }
    pDVar3 = FUN_180021688();
    *pDVar3 = 9;
    FUN_180023e68();
  }
  return 0xffffffff;
}



void FUN_18002c54c(char *param_1,int param_2,uint *param_3)

{
  undefined8 uVar1;
  uint uVar2;
  bool bVar3;
  bool bVar4;
  uint uVar5;
  short sVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint local_28;
  
  *param_3 = 0;
  param_3[1] = 0;
  param_3[2] = 0;
  sVar6 = 0x404e;
  if (param_2 != 0) {
    uVar5 = 0;
    uVar10 = 0;
    uVar8 = 0;
    bVar4 = true;
    do {
      uVar1 = *(undefined8 *)param_3;
      uVar9 = param_3[2];
      uVar2 = uVar5 * 4;
      uVar7 = (uVar10 * 2 | uVar5 >> 0x1f) * 2 | uVar5 * 2 >> 0x1f;
      uVar10 = (uVar8 * 2 | uVar10 >> 0x1f) * 2 | uVar10 * 2 >> 0x1f;
      local_28 = (uint)uVar1;
      *param_3 = uVar2;
      uVar5 = uVar2 + local_28;
      param_3[1] = uVar7;
      param_3[2] = uVar10;
      if ((uVar5 < uVar2) || (bVar3 = false, uVar5 < local_28)) {
        bVar3 = bVar4;
      }
      *param_3 = uVar5;
      uVar8 = uVar7;
      if (bVar3) {
        uVar8 = uVar7 + 1;
        if ((uVar8 < uVar7) || (bVar3 = false, uVar8 == 0)) {
          bVar3 = bVar4;
        }
        param_3[1] = uVar8;
        if (bVar3) {
          uVar10 = uVar10 + 1;
          param_3[2] = uVar10;
        }
      }
      uVar2 = (uint)((ulonglong)uVar1 >> 0x20);
      uVar7 = uVar8 + uVar2;
      if ((uVar7 < uVar8) || (bVar3 = false, uVar7 < uVar2)) {
        bVar3 = bVar4;
      }
      param_3[1] = uVar7;
      if (bVar3) {
        uVar10 = uVar10 + 1;
        param_3[2] = uVar10;
      }
      uVar2 = uVar5 * 2;
      uVar8 = (uVar10 + uVar9) * 2 | uVar7 >> 0x1f;
      *param_3 = uVar2;
      param_3[2] = uVar8;
      uVar9 = uVar7 * 2 | uVar5 >> 0x1f;
      param_3[1] = uVar9;
      uVar5 = uVar2 + (int)*param_1;
      if ((uVar5 < uVar2) || (bVar3 = false, uVar5 < (uint)(int)*param_1)) {
        bVar3 = bVar4;
      }
      *param_3 = uVar5;
      uVar10 = uVar9;
      if (bVar3) {
        uVar10 = uVar9 + 1;
        if ((uVar10 < uVar9) || (bVar3 = false, uVar10 == 0)) {
          bVar3 = bVar4;
        }
        param_3[1] = uVar10;
        if (bVar3) {
          uVar8 = uVar8 + 1;
          param_3[2] = uVar8;
        }
      }
      param_1 = param_1 + 1;
      param_3[1] = uVar10;
      param_3[2] = uVar8;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  if (param_3[2] == 0) {
    uVar5 = param_3[1];
    do {
      uVar10 = *param_3;
      uVar9 = uVar5 >> 0x10;
      *param_3 = uVar10 << 0x10;
      uVar8 = uVar10 >> 0x10 | uVar5 << 0x10;
      sVar6 = sVar6 + -0x10;
      uVar10 = uVar5 >> 0x10;
      uVar5 = uVar8;
    } while (uVar10 == 0);
    param_3[1] = uVar8;
    param_3[2] = uVar9;
  }
  uVar5 = param_3[2];
  if ((uVar5 & 0x8000) == 0) {
    uVar10 = *param_3;
    uVar8 = param_3[1];
    do {
      uVar9 = uVar5 * 2;
      uVar5 = uVar8 >> 0x1f;
      uVar8 = uVar8 * 2 | uVar10 >> 0x1f;
      uVar5 = uVar9 | uVar5;
      sVar6 = sVar6 + -1;
      uVar10 = uVar10 * 2;
    } while ((uVar9 & 0x8000) == 0);
    *param_3 = uVar10;
    param_3[1] = uVar8;
    param_3[2] = uVar5;
  }
  *(short *)((longlong)param_3 + 10) = sVar6;
  return;
}



undefined4 FUN_18002c770(int *param_1)

{
  undefined4 uVar1;
  uint uVar2;
  DWORD *pDVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  
  uVar1 = 0xffffffff;
  if (param_1 == (int *)0x0) {
    pDVar3 = FUN_180021688();
    *pDVar3 = 0x16;
    FUN_180023e68();
    uVar1 = 0xffffffff;
  }
  else {
    if ((*(byte *)(param_1 + 6) & 0x83) != 0) {
      uVar4 = FUN_180029f80(param_1);
      uVar1 = (undefined4)uVar4;
      FUN_18002ca30((undefined8 *)param_1);
      uVar2 = FUN_1800282f4((longlong)param_1);
      uVar5 = FUN_18002c8b0(uVar2);
      if ((int)uVar5 < 0) {
        uVar1 = 0xffffffff;
      }
      else if (*(LPVOID *)(param_1 + 10) != (LPVOID)0x0) {
        FUN_18001fcb8(*(LPVOID *)(param_1 + 10));
        param_1[10] = 0;
        param_1[0xb] = 0;
      }
    }
    param_1[6] = 0;
  }
  return uVar1;
}



undefined4 FUN_18002c7ec(int *param_1)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  
  uVar1 = 0xffffffff;
  if (param_1 == (int *)0x0) {
    pDVar2 = FUN_180021688();
    *pDVar2 = 0x16;
    FUN_180023e68();
    uVar1 = 0xffffffff;
  }
  else if ((*(byte *)(param_1 + 6) & 0x40) == 0) {
    FUN_1800281e8((ulonglong)param_1);
    uVar1 = FUN_18002c770(param_1);
    FUN_180028284((ulonglong)param_1);
  }
  else {
    param_1[6] = 0;
  }
  return uVar1;
}



void FUN_18002c854(void)

{
  if (1 < (longlong)DAT_18004c040 + 2U) {
    CloseHandle(DAT_18004c040);
  }
  return;
}



void FUN_18002c874(void)

{
  DAT_18004c040 = CreateFileW(L"CONOUT$",0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  return;
}



ulonglong FUN_18002c8b0(uint param_1)

{
  DWORD *pDVar1;
  ulonglong uVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_180021618();
    *pDVar1 = 0;
    pDVar1 = FUN_180021688();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004eca0)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) != 0) {
        FUN_18002c0a4(param_1);
        if ((*(byte *)((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) == 0) {
          pDVar1 = FUN_180021688();
          *pDVar1 = 9;
          uVar2 = 0xffffffff;
        }
        else {
          uVar2 = FUN_18002c974(param_1);
          uVar2 = uVar2 & 0xffffffff;
        }
        FUN_18002c25c(param_1);
        return uVar2;
      }
    }
    pDVar1 = FUN_180021618();
    *pDVar1 = 0;
    pDVar1 = FUN_180021688();
    *pDVar1 = 9;
    FUN_180023e68();
  }
  return 0xffffffff;
}



undefined8 FUN_18002c974(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  longlong lVar3;
  longlong lVar4;
  HANDLE hObject;
  undefined8 uVar5;
  
  lVar3 = FUN_18002c1e8(param_1);
  if (lVar3 != -1) {
    if (((param_1 == 1) && ((*(byte *)(DAT_18004d5a0 + 0xb8) & 1) != 0)) ||
       ((param_1 == 2 && ((*(byte *)(DAT_18004d5a0 + 0x60) & 1) != 0)))) {
      lVar3 = FUN_18002c1e8(2);
      lVar4 = FUN_18002c1e8(1);
      if (lVar4 == lVar3) goto LAB_18002c9e7;
    }
    hObject = (HANDLE)FUN_18002c1e8(param_1);
    BVar1 = CloseHandle(hObject);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      goto LAB_18002c9e9;
    }
  }
LAB_18002c9e7:
  DVar2 = 0;
LAB_18002c9e9:
  FUN_18002c13c(param_1);
  *(undefined1 *)
   ((&DAT_18004d5a0)[(longlong)(int)param_1 >> 5] + 8 + (ulonglong)(param_1 & 0x1f) * 0x58) = 0;
  if (DVar2 == 0) {
    uVar5 = 0;
  }
  else {
    FUN_180021638(DVar2);
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



void FUN_18002ca30(undefined8 *param_1)

{
  if (((*(byte *)(param_1 + 3) & 0x83) != 0) && ((*(byte *)(param_1 + 3) & 8) != 0)) {
    FUN_18001fcb8((LPVOID)param_1[2]);
    *(uint *)(param_1 + 3) = *(uint *)(param_1 + 3) & 0xfffffbf7;
    *param_1 = 0;
    param_1[2] = 0;
    *(undefined4 *)(param_1 + 1) = 0;
  }
  return;
}



undefined4 * FUN_18002ca70(undefined4 *param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  DWORD DVar3;
  
  FUN_180020400((undefined1 (*) [16])(param_1 + 10),0,0x28);
  *(undefined8 *)(param_1 + 0x14) = 0;
  param_1[0x16] = 0;
  param_1[0x17] = 0;
  *(undefined8 *)(param_1 + 4) = 0x180000000;
  *(undefined8 *)(param_1 + 2) = 0x180000000;
  *param_1 = 0x60;
  *(undefined **)(param_1 + 8) = &DAT_1800458c0;
  param_1[6] = 0xc00;
  BVar2 = InitializeCriticalSectionEx((LPCRITICAL_SECTION)(param_1 + 10),0,0);
  if (BVar2 == 0) {
    DVar3 = GetLastError();
    DVar1 = DVar3 & 0xffff | 0x80070000;
    if ((int)DVar3 < 1) {
      DVar1 = DVar3;
    }
    if ((int)DVar1 < 0) {
      BVar2 = IsDebuggerPresent();
      if (BVar2 != 0) {
        OutputDebugStringW(L"ERROR : Unable to initialize critical section in CAtlBaseModule\n");
      }
      DAT_18004dc89 = 1;
    }
  }
  return param_1;
}



void FUN_18002cb18(longlong param_1)

{
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x28));
  if (*(LPVOID *)(param_1 + 0x50) != (LPVOID)0x0) {
    FUN_18001fcb8(*(LPVOID *)(param_1 + 0x50));
    *(undefined8 *)(param_1 + 0x50) = 0;
  }
  *(undefined4 *)(param_1 + 0x58) = 0;
  *(undefined4 *)(param_1 + 0x5c) = 0;
  return;
}



BOOL __stdcall IsProcessorFeaturePresent(DWORD ProcessorFeature)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018002cb4c. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsProcessorFeaturePresent(ProcessorFeature);
  return BVar1;
}



void __stdcall
RtlUnwindEx(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue,
           PCONTEXT ContextRecord,PUNWIND_HISTORY_TABLE HistoryTable)

{
                    // WARNING: Could not recover jumptable at 0x00018002cb52. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnwindEx(TargetFrame,TargetIp,ExceptionRecord,ReturnValue,ContextRecord,HistoryTable);
  return;
}



void WTSQuerySessionInformationW(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002cb58. Too many branches
                    // WARNING: Treating indirect jump as call
  WTSQuerySessionInformationW();
  return;
}



void WTSFreeMemory(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002cb5e. Too many branches
                    // WARNING: Treating indirect jump as call
  WTSFreeMemory();
  return;
}



void FUN_18002cb70(void)

{
  FUN_180021ad4();
  return;
}



void FUN_18002cb84(undefined8 param_1,longlong param_2)

{
  if ((*(longlong *)(param_2 + 0x40) == 0) && (DAT_18004afb8 != -1)) {
    FUN_180025cb8();
  }
  return;
}



void FUN_18002cbaa(undefined8 *param_1,longlong param_2)

{
  undefined4 uVar1;
  
  *(undefined8 **)(param_2 + 0x40) = param_1;
  uVar1 = *(undefined4 *)*param_1;
  *(undefined4 *)(param_2 + 0x30) = uVar1;
  *(undefined8 **)(param_2 + 0x38) = param_1;
  *(undefined4 *)(param_2 + 0x28) = uVar1;
  if (*(int *)(param_2 + 0x78) == 1) {
    FUN_180021358(*(undefined8 *)(param_2 + 0x70),0,*(longlong *)(param_2 + 0x80));
  }
  FUN_180025ef0(*(int *)(param_2 + 0x28),*(undefined8 *)(param_2 + 0x38));
  return;
}



void FUN_18002cbf3(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x80) != 0) {
    FUN_180026aa0(8);
  }
  return;
}



void FUN_18002cc17(void)

{
  FUN_180026aa0(0xd);
  return;
}



void FUN_18002cc30(void)

{
  FUN_180026aa0(0xd);
  return;
}



void FUN_18002cc49(void)

{
  FUN_180026aa0(0xc);
  return;
}



void FUN_18002cc62(void)

{
  FUN_180026aa0(0xc);
  return;
}



void FUN_18002cc7b(void)

{
  FUN_180026aa0(0xb);
  return;
}



void FUN_18002cc96(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002ccab. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection(DAT_18004b530);
  return;
}



bool FUN_18002ccc0(undefined8 *param_1)

{
  return *(int *)*param_1 == -0x3ffffffb;
}



void FUN_18002cce0(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x60) != 0) {
    FUN_180026aa0(0);
  }
  return;
}



void FUN_18002ccfe(void)

{
  FUN_180026aa0(0xe);
  return;
}



undefined8 FUN_18002cd17(undefined8 *param_1)

{
  undefined8 uVar1;
  
  if ((*(int *)*param_1 == -0x3ffffffb) || (*(int *)*param_1 == -0x3fffffe3)) {
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



void FUN_18002cd43(undefined8 param_1,longlong param_2)

{
  FUN_18002c25c(*(uint *)(param_2 + 0x50));
  return;
}



void FUN_18002cd5a(undefined8 param_1,longlong param_2)

{
  FUN_1800282d4(*(int *)(param_2 + 0x20),
                *(longlong *)(DAT_18004dc90 + (longlong)*(int *)(param_2 + 0x20) * 8));
  return;
}



void FUN_18002cd82(void)

{
  FUN_180026aa0(1);
  return;
}



void FUN_18002cd9b(void)

{
  FUN_180026aa0(1);
  return;
}



void FUN_18002cdb4(void)

{
  FUN_180026aa0(10);
  return;
}



void FUN_18002cdcd(undefined8 param_1,longlong param_2)

{
  FUN_180028284(*(ulonglong *)(param_2 + 0x30));
  return;
}



void FUN_18002cde5(undefined8 param_1,longlong param_2)

{
  FUN_18002c25c(*(uint *)(param_2 + 0x40));
  return;
}


