#include "EgisTouchFPEngine0575.h"


undefined LAB_18002b7f0;
undefined DAT_180048ba0;
undefined DAT_180049ef8;
char DAT_180049f18;
undefined DAT_180049f00;
undefined DAT_180049f08;
undefined DAT_180049f10;
ulonglong DAT_1800461a0;
undefined DAT_180040428;
undefined DAT_180044830;
undefined DAT_180035080;
undefined DAT_180035090;
undefined DAT_18004779c;
undefined DAT_180047798;
undefined4 DAT_180047754;
undefined4 DAT_180047794;
LPVOID DAT_180049f30;
undefined4 DAT_180047d7c;
undefined2 DAT_18004b158;
undefined2 DAT_18004b150;
ushort DAT_18004b154;
ushort DAT_18004b156;
int DAT_180047d7c;
undefined4 DAT_180049f28;
longlong DAT_180049f30;
undefined1 DAT_18004b140;
uint DAT_18004b15c;
int *DAT_180049f30;
uint DAT_180049f28;
uint DAT_18004b0c4;
undefined4 DAT_180048220;
undefined8 DAT_18004b0d0;
int * *DAT_180049f30;
LPVOID DAT_180049f40;
undefined4 DAT_18004b0c0;
undefined4 DAT_180048230;
undefined DAT_180048220;
undefined4 DAT_18004b0c4;
undefined1 DAT_18004b0d8;
undefined8 UNK_180048228;
int DAT_18004b0c4;
char DAT_180049f26;
int *DAT_180049f38;
int DAT_18004b15c;
IMAGE_DOS_HEADER IMAGE_DOS_HEADER_180000000;
undefined8 DAT_180049f40;
undefined DAT_18004b140;
uint DAT_180047794;
int DAT_180047754;
undefined DAT_180047758;
undefined DAT_1800477a0;
undefined DAT_180047b60;
undefined DAT_180047d40;
undefined DAT_180047d80;
undefined DAT_180047fc0;
undefined DAT_1800481a0;
undefined DAT_1800481e0;
int DAT_180046320;
undefined2 DAT_18004b152;
undefined2 DAT_18004b154;
undefined2 DAT_18004b156;
short DAT_18004b150;
undefined DAT_18004b154;
short DAT_18004b158;
undefined DAT_1800351c0;
undefined DAT_1800351e0;
undefined4 DAT_180048224;
ulonglong DAT_180049f30;
short DAT_18004b156;
ushort DAT_18004b150;
ushort DAT_18004b158;
uint DAT_180047754;
undefined DAT_180048640;
undefined DAT_180048830;
undefined1 DAT_180036710;
undefined DAT_1800355cc;
undefined DAT_180037720;
undefined DAT_180037730;
undefined1 DAT_180035208;
undefined DAT_180035670;
undefined DAT_180035690;
undefined DAT_1800356f0;
undefined DAT_180035610;
undefined DAT_180036720;
undefined DAT_180037830;
undefined DAT_18003eac0;
undefined DAT_18003f060;
undefined DAT_180038110;
undefined DAT_180037910;
undefined1 DAT_180037990;
undefined DAT_180037a50;
undefined DAT_180037b50;
undefined DAT_180037b54;
undefined DAT_180037f10;
undefined DAT_180037f50;
undefined4 *DAT_180049f30;
undefined DAT_180040e60;
undefined DAT_18003eab0;
undefined DAT_18003f600;
undefined UNK_18003ffd0;
undefined DAT_180040320;
undefined DAT_180040130;
undefined DAT_18002c560;
undefined *PTR_FUN_180046018;
undefined *PTR_FUN_180046020;
undefined FUN_1800168d0;
undefined FUN_180017250;
undefined *PTR_s_SecurityLogParameter_180046000;
undefined FUN_180017010;
undefined *PTR_s_SecurityLogMask_180046008;
undefined *PTR_s_SecurityLogPath_180046010;
undefined LAB_180016d00;
undefined FUN_180017260;
undefined FUN_180016b00;
pointer[6] vftable;
undefined4 DAT_180048a88;
undefined DAT_180048a80;
undefined4 DAT_180048a84;
int DAT_180048a88;
int DAT_180048a84;
undefined FUN_18001aa60;
undefined DAT_18002c728;
undefined DAT_18002c750;
undefined8 DAT_180046038;
undefined4 DAT_180046030;
pointer[22] vftable;
undefined DAT_18002e210;
pointer[19] vftable;
undefined DAT_18002e5b0;
pointer PTR_s_ENROLL_CTX_ENROLL_POLICY_18002e5b8;
undefined1 DAT_180049f19;
undefined DAT_18002f238;
HANDLE DAT_180048c88;
pointer[2] vftable;
undefined DAT_180044738;
PVOID DAT_18004b0a0;
PVOID DAT_18004b098;
longlong DAT_1800461a0;
uint DAT_180049204;
undefined DAT_18001d640;
pointer[1] vftable;
undefined FUN_180020268;
undefined FUN_180022004;
void *StackLimit;
PVOID DAT_180049230;
LPSTR DAT_18004b0b0;
LPSTR DAT_180048c10;
int DAT_180048c08;
int DAT_180048c68;
int DAT_180046340;
int DAT_180049b88;
PVOID DAT_180048c20;
undefined8 DAT_180048c20;
undefined8 *DAT_180048c48;
undefined8 *DAT_180048c40;
LPVOID DAT_180048c38;
LPVOID DAT_180048c30;
LPVOID DAT_180049e18;
LPVOID DAT_180049e20;
undefined *PTR_DAT_180046b70;
undefined4 DAT_180046850;
undefined *DAT_18004b090;
undefined DAT_18002c468;
undefined DAT_18002c478;
undefined DAT_18002c480;
undefined DAT_18002c4a8;
undefined FUN_180023aac;
int DAT_180048c28;
undefined4 DAT_180048c68;
undefined1 DAT_180048c64;
undefined DAT_18002c4b0;
undefined DAT_18002c4d0;
undefined DAT_18002c4d8;
undefined DAT_18002c4e0;
undefined8 DAT_180048c88;
uint DAT_180048c80;
undefined4 DAT_18004631c;
undefined DAT_180046318;
undefined4 DAT_1800461b0;
undefined DAT_1800461b4;
int DAT_180049200;
undefined8 DAT_180048e28;
undefined DAT_180048dc8;
undefined DAT_180048ca0;
undefined DAT_180048db0;
undefined DAT_180048c90;
undefined DAT_180048c94;
undefined DAT_180048ca8;
undefined8 DAT_1800461a0;
undefined8 DAT_1800461a8;
undefined8 DAT_180048cb0;
pointer PTR_DAT_18002f448;
undefined DAT_180048d30;
undefined DAT_180046324;
undefined4 DAT_180046320;
longlong *DAT_180049210;
undefined DAT_180049208;
undefined8 DAT_180049218;
PVOID DAT_180049218;
undefined DAT_180046350;
undefined8 DAT_180049240;
undefined *PTR_DAT_180047210;
uint DAT_180047378;
undefined *PTR_LAB_180046620;
undefined *PTR_LAB_180046638;
undefined *PTR_LAB_180046630;
undefined *PTR_s_(null)_180046330;
undefined *PTR_u_(null)_180046338;
undefined DAT_18002f4b0;
undefined DAT_18002f4d0;
undefined *PTR_DAT_180047388;
undefined DAT_18002f560;
undefined DAT_180047220;
undefined DAT_1800447c0;
undefined *DAT_180049220;
PVOID DAT_180049228;
undefined FUN_180022894;
uint DAT_180046344;
undefined DAT_180046344;
undefined8 DAT_180049230;
int DAT_18004b088;
longlong DAT_180049f48;
int DAT_18004b0a8;
undefined1 DAT_180049544;
byte *DAT_18004b0b0;
undefined DAT_180048c50;
undefined8 *DAT_180048c30;
undefined DAT_180048c2c;
undefined DAT_180049440;
ulonglong *DAT_180048c10;
undefined DAT_18004b0ac;
ulonglong DAT_1800461a8;
ulonglong DAT_18004af80;
ulonglong DAT_18004af88;
ulonglong DAT_18004af90;
ulonglong DAT_18004af98;
ulonglong DAT_18004afa0;
int DAT_1800463a8;
ulonglong DAT_18004b068;
undefined DAT_18004afa8;
undefined DAT_18004afb0;
undefined DAT_18004afb8;
undefined DAT_18004afc0;
undefined DAT_18004afc8;
undefined DAT_18004afd0;
undefined DAT_18004afd8;
undefined DAT_18004afe0;
undefined DAT_18004afe8;
undefined DAT_18004aff0;
undefined DAT_18004aff8;
undefined DAT_18004b000;
undefined DAT_18004b008;
undefined DAT_18004b010;
undefined DAT_18004b018;
undefined DAT_18004b020;
undefined DAT_18004b030;
undefined DAT_18004b028;
undefined DAT_18004b038;
undefined DAT_18004b040;
undefined DAT_18004b048;
undefined DAT_18004b050;
undefined DAT_18004b058;
ulonglong DAT_18004b060;
undefined DAT_18004b070;
undefined DAT_18004b078;
undefined DAT_18004b080;
undefined8 DAT_180041558;
undefined8 DAT_180041568;
int DAT_180049550;
undefined4 DAT_18002f960;
pointer PTR_u_R6002_-_floating_point_support_n_18002f968;
undefined DAT_18004979a;
undefined DAT_180030468;
undefined DAT_180030470;
undefined DAT_18004951c;
undefined DAT_180049560;
undefined DAT_180049592;
undefined8 DAT_1800463b0;
undefined4 DAT_1800463b8;
longlong DAT_180048c88;
LPCRITICAL_SECTION DAT_180046450;
undefined DAT_180049b90;
pointer PTR_LAB_1800465f0;
PVOID DAT_180049dd0;
undefined8 DAT_180049dc0;
undefined8 DAT_180049dc8;
undefined8 DAT_180049dd0;
undefined8 DAT_180049dd8;
undefined DAT_180049de8;
undefined4 DAT_180049e10;
undefined DAT_180047378;
undefined DAT_180049df0;
undefined DAT_180049df4;
undefined DAT_180049e08;
undefined DAT_180046640;
undefined1 DAT_180046750;
undefined DAT_180049df8;
int DAT_180049e10;
undefined1 DAT_180046a78;
undefined4 DAT_180046a80;
undefined DAT_180046a90;
undefined DAT_18004af60;
int DAT_180049f50;
LPVOID DAT_180049f48;
pointer PTR_DAT_180046b80;
char DAT_180048c64;
uint DAT_18004b088;
undefined DAT_180049e98;
undefined DAT_180046f44;
undefined *PTR_DAT_180046f50;
pointer PTR_DAT_180047390;
ulonglong DAT_180049ea0;
pointer PTR_DAT_1800328a0;
undefined DAT_1800328a8;
undefined DAT_180031a60;
int DAT_180049eb0;
PVOID DAT_180049eb8;
PVOID DAT_180049ec0;
PVOID DAT_180049ec8;
PVOID DAT_180049ed8;
PVOID DAT_180049ed0;
HANDLE DAT_180047440;
undefined *PTR_DAT_1800473a8;
undefined *PTR_DAT_1800473b0;
undefined *PTR_DAT_1800473b8;
undefined *PTR_DAT_1800473c0;
undefined *PTR_DAT_1800473c8;
undefined *PTR_DAT_1800473d0;
undefined *PTR_DAT_1800473d8;
undefined *PTR_DAT_1800473f8;
undefined *PTR_DAT_180047400;
undefined *PTR_DAT_180047408;
undefined *PTR_DAT_180047410;
undefined *PTR_DAT_180047418;
undefined *PTR_DAT_180047420;
undefined *PTR_DAT_180047390;
undefined *PTR_DAT_180047398;
undefined *PTR_DAT_1800473a0;
undefined *PTR_DAT_1800473e8;
undefined *PTR_DAT_1800473f0;
pointer PTR_DAT_180047210;
undefined *PTR_LAB_1800465f8;
undefined *PTR_LAB_1800465f0;
undefined *PTR_LAB_180046600;
undefined *PTR_LAB_180046618;
undefined *PTR_LAB_180046608;
undefined *PTR_LAB_180046610;
undefined *PTR_LAB_180046628;
undefined LAB_180029f38;
undefined LAB_180029fd8;
undefined LAB_18002a020;
undefined FUN_180029484;
undefined LAB_18002a0a8;
undefined FUN_1800294a8;
undefined FUN_180029f40;
undefined FUN_180029fe0;
undefined FUN_18002a028;
int DAT_180047464;
int DAT_180047468;
int DAT_180047460;
int DAT_18004745c;
int DAT_180047458;
int DAT_18004746c;
int DAT_18004747c;
int DAT_180047480;
int DAT_180047478;
int DAT_180047474;
int DAT_180047470;
int DAT_180047484;
undefined *PTR_PTR_180047430;
byte DAT_180049ef0;
int DAT_180049ee8;
undefined *PTR_DAT_180047328;

void FUN_180001000(void)

{
  FUN_18001d0a8((undefined4 *)&DAT_180048ba0);
  FUN_18001d3b8(&LAB_18002b7f0);
  return;
}



bool FUN_180001020(PUCHAR param_1,ULONG param_2)

{
  NTSTATUS NVar1;
  BCRYPT_ALG_HANDLE local_res18 [2];
  
  NVar1 = BCryptOpenAlgorithmProvider(local_res18,L"RNG",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenRandom(local_res18[0],param_1,param_2,0);
    BCryptCloseAlgorithmProvider(local_res18[0],0);
  }
  return -1 < NVar1;
}



bool FUN_180001090(undefined8 *param_1,ULONG *param_2,uint param_3,PUCHAR param_4)

{
  NTSTATUS NVar1;
  uint uVar2;
  BCRYPT_HASH_HANDLE local_28;
  BCRYPT_ALG_HANDLE local_20;
  
  uVar2 = 0;
  local_20 = (BCRYPT_ALG_HANDLE)0x0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_20,L"SHA256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_20,&local_28,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
    if (-1 < NVar1) {
      if (param_3 != 0) {
        do {
          if (((PUCHAR)*param_1 != (PUCHAR)0x0) && (*param_2 != 0)) {
            NVar1 = BCryptHashData(local_28,(PUCHAR)*param_1,*param_2,0);
            if (NVar1 < 0) goto LAB_180001165;
          }
          uVar2 = uVar2 + 1;
          param_1 = param_1 + 1;
          param_2 = param_2 + 1;
        } while (uVar2 < param_3);
      }
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_28,param_4,0x20,0);
      }
LAB_180001165:
      BCryptDestroyHash(local_28);
    }
    BCryptCloseAlgorithmProvider(local_20,0);
  }
  return -1 < NVar1;
}



void FUN_1800011b0(undefined8 param_1,ULONG param_2,PUCHAR param_3)

{
  undefined8 local_res8;
  ULONG local_res10 [6];
  
  local_res8 = param_1;
  local_res10[0] = param_2;
  FUN_180001090(&local_res8,local_res10,1,param_3);
  return;
}



bool FUN_1800011e0(PUCHAR param_1,ULONG param_2,undefined8 *param_3,ULONG *param_4,uint param_5,
                  PUCHAR param_6,undefined8 *param_7)

{
  NTSTATUS NVar1;
  uint uVar2;
  BCRYPT_HASH_HANDLE local_28 [2];
  
  NVar1 = BCryptCreateHash((BCRYPT_ALG_HANDLE)*param_7,local_28,(PUCHAR)0x0,0,param_1,param_2,0);
  if (-1 < NVar1) {
    uVar2 = 0;
    if (param_5 != 0) {
      do {
        if ((((PUCHAR)*param_3 != (PUCHAR)0x0) && (*param_4 != 0)) &&
           (NVar1 = BCryptHashData(local_28[0],(PUCHAR)*param_3,*param_4,0), NVar1 < 0))
        goto LAB_1800012a3;
        uVar2 = uVar2 + 1;
        param_3 = param_3 + 1;
        param_4 = param_4 + 1;
      } while (uVar2 < param_5);
    }
    if (-1 < NVar1) {
      NVar1 = BCryptFinishHash(local_28[0],param_6,0x20,0);
    }
LAB_1800012a3:
    BCryptDestroyHash(local_28[0]);
  }
  BCryptCloseAlgorithmProvider((BCRYPT_ALG_HANDLE)*param_7,0);
  return -1 < NVar1;
}



bool FUN_1800012f0(PUCHAR param_1,ULONG param_2,undefined8 param_3,ULONG param_4,PUCHAR param_5)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined8 local_res18;
  ULONG local_res20 [2];
  BCRYPT_ALG_HANDLE local_18 [2];
  
  local_res18 = param_3;
  local_res20[0] = param_4;
  NVar2 = BCryptOpenAlgorithmProvider(local_18,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar2) {
    bVar1 = FUN_1800011e0(param_1,param_2,&local_res18,local_res20,1,param_5,local_18);
    return bVar1;
  }
  return false;
}



NTSTATUS FUN_180001380(undefined8 *param_1,ULONG *param_2,undefined8 param_3,int *param_4,
                      undefined8 param_5,PUCHAR param_6)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined7 extraout_var;
  wchar_t *pszAlgId;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_ALG_HANDLE local_38;
  UCHAR local_30 [40];
  
  local_48[0] = 0x40;
  local_38 = (BCRYPT_ALG_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  bVar1 = FUN_180001090(param_1,param_2,1,local_30);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    NVar2 = -0x3fffffff;
  }
  else {
    pszAlgId = L"ECDSA_P256";
    if (*param_4 == 0x324b4345) {
      pszAlgId = L"ECDH_P256";
    }
    NVar2 = BCryptOpenAlgorithmProvider(&local_38,pszAlgId,(LPCWSTR)0x0,0);
    if (-1 < NVar2) {
      NVar2 = BCryptImportKeyPair(local_38,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_40,
                                  (PUCHAR)param_4,0x68,0);
      if (-1 < NVar2) {
        NVar2 = BCryptSignHash(local_40,(void *)0x0,local_30,0x20,param_6,local_48[0],local_48,0);
        if (-1 < NVar2) {
          NVar2 = 0;
        }
      }
    }
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
    local_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38,0);
  }
  return NVar2;
}



NTSTATUS FUN_1800014b0(undefined8 *param_1,ULONG *param_2,undefined8 param_3,int *param_4,
                      undefined8 param_5,PUCHAR param_6)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined7 extraout_var;
  wchar_t *pwVar3;
  BCRYPT_KEY_HANDLE local_38;
  BCRYPT_ALG_HANDLE local_30;
  UCHAR local_28 [32];
  
  local_30 = (BCRYPT_ALG_HANDLE)0x0;
  local_38 = (BCRYPT_KEY_HANDLE)0x0;
  bVar1 = FUN_180001090(param_1,param_2,1,local_28);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    NVar2 = -0x3fffffff;
  }
  else {
    pwVar3 = L"ECDSA_P256";
    if (*param_4 == 0x314b4345) {
      pwVar3 = L"ECDH_P256";
    }
    NVar2 = BCryptOpenAlgorithmProvider(&local_30,pwVar3,(LPCWSTR)0x0,0);
    if (-1 < NVar2) {
      pwVar3 = L"ECCPUBLICBLOB";
      if (*param_4 == 0x32534345) {
        pwVar3 = L"ECCPRIVATEBLOB";
      }
      NVar2 = BCryptImportKeyPair(local_30,(BCRYPT_KEY_HANDLE)0x0,pwVar3,&local_38,(PUCHAR)param_4,
                                  0x48,0);
      if (-1 < NVar2) {
        NVar2 = BCryptVerifySignature(local_38,(void *)0x0,local_28,0x20,param_6,0x40,0);
        if (-1 < NVar2) {
          NVar2 = 0;
        }
      }
    }
  }
  if (local_38 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_38);
    local_38 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_30 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_30,0);
  }
  return NVar2;
}



NTSTATUS FUN_1800015d0(PUCHAR param_1,PUCHAR param_2,PVOID param_3,ULONG param_4,PUCHAR param_5,
                      ULONG param_6)

{
  NTSTATUS NVar1;
  BCRYPT_ALG_HANDLE local_68;
  BCRYPT_SECRET_HANDLE local_60;
  BCRYPT_KEY_HANDLE local_58;
  BCRYPT_KEY_HANDLE local_50;
  BCryptBufferDesc local_48;
  _BCryptBuffer local_38;
  undefined8 local_28;
  wchar_t *local_20;
  
  local_68 = (BCRYPT_ALG_HANDLE)0x0;
  local_50 = (BCRYPT_KEY_HANDLE)0x0;
  local_58 = (BCRYPT_KEY_HANDLE)0x0;
  local_60 = (BCRYPT_SECRET_HANDLE)0x0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"ECDH_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptImportKeyPair(local_68,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_50,param_1,
                                0x68,0);
    if (-1 < NVar1) {
      NVar1 = BCryptImportKeyPair(local_68,(BCRYPT_KEY_HANDLE)0x0,L"ECCPUBLICBLOB",&local_58,param_2
                                  ,0x48,0);
      if (-1 < NVar1) {
        NVar1 = BCryptSecretAgreement(local_50,local_58,&local_60,0);
        if (-1 < NVar1) {
          local_20 = L"SHA256";
          local_48.pBuffers = &local_38;
          local_38.BufferType = 3;
          local_28 = 0xe;
          local_48.cBuffers = 2;
          local_48.ulVersion = 0;
          local_38.cbBuffer = param_4;
          local_38.pvBuffer = param_3;
          NVar1 = BCryptDeriveKey(local_60,L"HMAC",&local_48,param_5,param_6,&param_6,0);
          if (-1 < NVar1) {
            NVar1 = 0;
          }
        }
      }
    }
  }
  if (local_60 != (BCRYPT_SECRET_HANDLE)0x0) {
    BCryptDestroySecret(local_60);
  }
  if (local_58 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_58);
  }
  if (local_50 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_50);
  }
  if (local_68 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_68,0);
  }
  return NVar1;
}



bool FUN_180001790(undefined8 *param_1,undefined8 param_2,ULONG param_3,PUCHAR param_4)

{
  NTSTATUS NVar1;
  undefined8 uVar2;
  undefined8 local_res10;
  ULONG local_res18 [4];
  undefined8 in_stack_ffffffffffffff68;
  int local_78 [18];
  undefined8 local_30;
  undefined8 uStack_28;
  undefined8 local_20;
  undefined8 uStack_18;
  
  uVar2 = 0x68;
  local_res10 = param_2;
  local_res18[0] = param_3;
  FUN_18001dbc0((undefined1 (*) [16])local_78,0,0x68);
  local_30 = *param_1;
  uStack_28 = param_1[1];
  local_20 = param_1[2];
  uStack_18 = param_1[3];
  local_78[0] = 0x32534345;
  local_78[1] = 0x20;
  NVar1 = FUN_180001380(&local_res10,local_res18,uVar2,local_78,in_stack_ffffffffffffff68,param_4);
  return -1 < NVar1;
}



bool FUN_180001820(undefined8 *param_1,undefined8 param_2,undefined8 param_3,PUCHAR param_4,
                  undefined4 *param_5)

{
  NTSTATUS NVar1;
  undefined8 local_res10;
  ULONG local_res18 [4];
  undefined8 in_stack_ffffffffffffff88;
  int local_58 [2];
  undefined8 local_50;
  undefined8 uStack_48;
  undefined8 local_40;
  undefined8 uStack_38;
  undefined8 local_30;
  undefined8 uStack_28;
  undefined8 local_20;
  undefined8 uStack_18;
  
  local_res18[0] = (ULONG)param_3;
  local_50 = *param_1;
  uStack_48 = param_1[1];
  local_40 = param_1[2];
  uStack_38 = param_1[3];
  local_30 = param_1[4];
  uStack_28 = param_1[5];
  local_20 = param_1[6];
  uStack_18 = param_1[7];
  local_58[0] = 0x31534345;
  local_58[1] = 0x20;
  local_res10 = param_2;
  NVar1 = FUN_1800014b0(&local_res10,local_res18,param_3,local_58,in_stack_ffffffffffffff88,param_4)
  ;
  if (-1 < NVar1) {
    *param_5 = 1;
    return true;
  }
  *param_5 = 0;
  return NVar1 == -0x3fff6000;
}



bool FUN_1800018e0(PUCHAR param_1)

{
  NTSTATUS NVar1;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  
  local_res20 = (BCRYPT_ALG_HANDLE)0x0;
  local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"ECDSA_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptImportKeyPair(local_res20,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_res18,
                                param_1,0x68,0);
    if (-1 < NVar1) {
      NVar1 = BCryptExportKey(local_res18,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",param_1,0x68,
                              local_res10,0);
      if (-1 < NVar1) {
        NVar1 = 0;
      }
    }
  }
  if (local_res18 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res18);
    local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_res20 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_res20,0);
  }
  return -1 < NVar1;
}



bool FUN_1800019c0(PUCHAR param_1,int param_2)

{
  NTSTATUS NVar1;
  wchar_t *pszAlgId;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  
  pszAlgId = L"ECDSA_P256";
  if (param_2 != 0) {
    pszAlgId = L"ECDH_P256";
  }
  local_res20 = (BCRYPT_ALG_HANDLE)0x0;
  local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,pszAlgId,(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenerateKeyPair(local_res20,&local_res18,0x100,0);
    if (-1 < NVar1) {
      NVar1 = BCryptFinalizeKeyPair(local_res18,0);
      if (-1 < NVar1) {
        NVar1 = BCryptExportKey(local_res18,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",param_1,0x68,
                                local_res10,0);
        if (-1 < NVar1) {
          NVar1 = 0;
        }
      }
    }
  }
  if (local_res18 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res18);
    local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_res20 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_res20,0);
  }
  return -1 < NVar1;
}



undefined4 *
FUN_180001ab0(uint param_1,uint param_2,undefined8 *param_3,undefined8 *param_4,undefined8 *param_5,
             uint *param_6)

{
  undefined4 *puVar1;
  uint uVar2;
  
  uVar2 = param_2 + 0x18 + param_1;
  puVar1 = (undefined4 *)LocalAlloc(0,(ulonglong)uVar2);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = 0x31415352;
    puVar1[1] = param_1 * 8;
    *(undefined8 *)(puVar1 + 4) = 0;
    puVar1[2] = param_2;
    puVar1[3] = param_1;
    FUN_18001d560((undefined8 *)(puVar1 + 6),param_3,(ulonglong)param_2);
    FUN_18001d560((undefined8 *)((ulonglong)param_2 + (longlong)(puVar1 + 6)),param_4,
                  (ulonglong)param_1);
    *param_5 = puVar1;
    *param_6 = uVar2;
    puVar1 = (undefined4 *)0x1;
  }
  return puVar1;
}



undefined4 FUN_180001b70(longlong param_1)

{
  return *(undefined4 *)(param_1 + 4);
}



void FUN_180001b80(HLOCAL param_1)

{
  if (param_1 != (HLOCAL)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180001b85. Too many branches
                    // WARNING: Treating indirect jump as call
    LocalFree(param_1);
    return;
  }
  return;
}



bool FUN_180001b90(int *param_1,ULONG param_2,PUCHAR param_3,ULONG param_4,PUCHAR param_5,
                  ULONG param_6,ULONG *param_7)

{
  NTSTATUS NVar1;
  wchar_t *pszBlobType;
  ULONG *pcbResult;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_58;
  BCRYPT_ALG_HANDLE local_50;
  wchar_t *local_48;
  undefined8 local_40;
  undefined4 local_38;
  
  local_48 = L"SHA256";
  local_40 = 0;
  pcbResult = local_res10;
  if (param_7 != (ULONG *)0x0) {
    pcbResult = param_7;
  }
  local_50 = (BCRYPT_ALG_HANDLE)0x0;
  local_58 = (BCRYPT_KEY_HANDLE)0x0;
  local_38 = 0;
  local_res10[0] = 0;
  if (param_2 == 0) {
    if (*param_1 == 0x31415352) {
      param_2 = param_1[2] + 0x18 + param_1[3];
    }
    else if (*param_1 == 0x33415352) {
      param_2 = (param_1[4] + 8) * 3 + (param_1[5] + param_1[3]) * 2 + param_1[2];
    }
  }
  NVar1 = BCryptOpenAlgorithmProvider(&local_50,L"RSA",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    pszBlobType = L"RSAFULLPRIVATEBLOB";
    if (*param_1 == 0x31415352) {
      pszBlobType = L"RSAPUBLICBLOB";
    }
    NVar1 = BCryptImportKeyPair(local_50,(BCRYPT_KEY_HANDLE)0x0,pszBlobType,&local_58,
                                (PUCHAR)param_1,param_2,0);
    if (-1 < NVar1) {
      NVar1 = BCryptEncrypt(local_58,param_3,param_4,&local_48,(PUCHAR)0x0,0,param_5,param_6,
                            pcbResult,4);
      if (-1 < NVar1) {
        NVar1 = 0;
      }
    }
  }
  if (local_58 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_58);
    local_58 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_50 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_50,0);
  }
  return -1 < NVar1;
}



bool FUN_180001d20(undefined8 *param_1,int param_2,undefined8 *param_3,int param_4,PVOID param_5,
                  ULONG param_6,PUCHAR param_7,ULONG param_8)

{
  NTSTATUS NVar1;
  UCHAR local_c8 [8];
  undefined8 local_c0;
  undefined8 uStack_b8;
  undefined8 local_b0;
  undefined8 uStack_a8;
  undefined8 local_a0;
  undefined8 uStack_98;
  undefined8 local_90;
  undefined8 uStack_88;
  UCHAR local_78 [72];
  undefined8 local_30;
  undefined8 uStack_28;
  undefined8 local_20;
  undefined8 uStack_18;
  
  if ((param_2 == 0x20) && (param_4 == 0x40)) {
    FUN_18001dbc0((undefined1 (*) [16])local_78,0,0x68);
    local_30 = *param_1;
    uStack_28 = param_1[1];
    local_20 = param_1[2];
    uStack_18 = param_1[3];
    local_c0 = *param_3;
    uStack_b8 = param_3[1];
    builtin_memcpy(local_78,"ECK2",4);
    local_b0 = param_3[2];
    uStack_a8 = param_3[3];
    local_a0 = param_3[4];
    uStack_98 = param_3[5];
    local_78[4] = ' ';
    local_78[5] = '\0';
    local_78[6] = '\0';
    local_78[7] = '\0';
    builtin_memcpy(local_c8,"ECK1 ",6);
    local_c8[6] = '\0';
    local_c8[7] = '\0';
    local_90 = param_3[6];
    uStack_88 = param_3[7];
    NVar1 = FUN_1800015d0(local_78,local_c8,param_5,param_6,param_7,param_8);
    return -1 < NVar1;
  }
  return false;
}



bool FUN_180001e20(PUCHAR param_1,uint param_2,PUCHAR param_3,PUCHAR param_4,uint param_5,
                  PUCHAR param_6,ULONG param_7,ULONG *param_8)

{
  uint uVar1;
  PUCHAR pUVar2;
  NTSTATUS NVar3;
  uint cbInput;
  uint *pcbResult;
  BCRYPT_KEY_HANDLE local_38;
  BCRYPT_ALG_HANDLE local_30;
  
  uVar1 = param_5;
  cbInput = (param_5 / param_2) * param_2;
  pcbResult = &param_5;
  if (param_8 != (ULONG *)0x0) {
    pcbResult = param_8;
  }
  local_30 = (BCRYPT_HANDLE)0x0;
  local_38 = (BCRYPT_KEY_HANDLE)0x0;
  param_5 = 0;
  NVar3 = BCryptOpenAlgorithmProvider(&local_30,L"AES",(LPCWSTR)0x0,0);
  if ((-1 < NVar3) &&
     (NVar3 = BCryptSetProperty(local_30,L"ChainingMode",(PUCHAR)L"ChainingModeCBC",0x20,0),
     -1 < NVar3)) {
    NVar3 = BCryptGenerateSymmetricKey(local_30,&local_38,(PUCHAR)0x0,0,param_1,param_2,0);
    pUVar2 = param_6;
    if (-1 < NVar3) {
      if (cbInput != 0) {
        NVar3 = BCryptEncrypt(local_38,param_4,cbInput,(void *)0x0,param_3,0x10,param_6,param_7,
                              pcbResult,0);
        if (NVar3 < 0) goto LAB_180001f79;
        if (cbInput != *pcbResult) {
          NVar3 = -0x3fffffff;
          goto LAB_180001f79;
        }
      }
      NVar3 = 0;
      if (cbInput < uVar1) {
        if (param_4 != pUVar2) {
          FUN_18001d560((undefined8 *)(pUVar2 + cbInput),(undefined8 *)(param_4 + cbInput),
                        (ulonglong)(uVar1 - cbInput));
        }
        *pcbResult = uVar1;
      }
    }
  }
LAB_180001f79:
  if (local_38 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_38);
    local_38 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_30 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_30,0);
  }
  return -1 < NVar3;
}



bool FUN_180001fd0(PUCHAR param_1,undefined8 param_2,PUCHAR param_3,PUCHAR param_4,uint param_5,
                  PUCHAR param_6,ULONG param_7)

{
  NTSTATUS NVar1;
  uint cbInput;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE pvStack0000000000000040;
  BCRYPT_ALG_HANDLE local_38 [2];
  
  local_38[0] = (BCRYPT_HANDLE)0x0;
  pvStack0000000000000040 = (BCRYPT_KEY_HANDLE)0x0;
  cbInput = param_5 & 0xffffffe0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(local_38,L"AES",(LPCWSTR)0x0,0);
  if ((-1 < NVar1) &&
     (NVar1 = BCryptSetProperty(local_38[0],L"ChainingMode",(PUCHAR)L"ChainingModeCBC",0x20,0),
     -1 < NVar1)) {
    NVar1 = BCryptGenerateSymmetricKey(local_38[0],&stack0x00000040,(PUCHAR)0x0,0,param_1,0x20,0);
    if (-1 < NVar1) {
      if (cbInput != 0) {
        NVar1 = BCryptDecrypt(pvStack0000000000000040,param_4,cbInput,(void *)0x0,param_3,0x10,
                              param_6,param_7,local_res10,0);
        if (NVar1 < 0) goto LAB_18000211d;
        if (cbInput != local_res10[0]) {
          NVar1 = -0x3fffffff;
          goto LAB_18000211d;
        }
      }
      NVar1 = 0;
      if (cbInput < param_5) {
        if (param_4 != param_6) {
          FUN_18001d560((undefined8 *)(param_6 + cbInput),(undefined8 *)(param_4 + cbInput),
                        (ulonglong)(param_5 - cbInput));
        }
        local_res10[0] = param_5;
      }
    }
  }
LAB_18000211d:
  if (pvStack0000000000000040 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(pvStack0000000000000040);
    pvStack0000000000000040 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38[0] != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38[0],0);
  }
  return -1 < NVar1;
}



bool FUN_180002170(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5)

{
  uint uVar1;
  NTSTATUS NVar2;
  PUCHAR pUVar3;
  ulonglong uVar4;
  uint uVar5;
  uint *puVar6;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_ALG_HANDLE local_38;
  uint local_30 [6];
  
  uVar5 = 0;
  local_38 = (BCRYPT_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  local_48[0] = 0;
  NVar2 = BCryptOpenAlgorithmProvider(&local_38,L"AES",(LPCWSTR)0x0,0);
  if ((((-1 < NVar2) &&
       (NVar2 = BCryptSetProperty(local_38,L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
       -1 < NVar2)) &&
      (NVar2 = BCryptGenerateSymmetricKey(local_38,&local_40,(PUCHAR)0x0,0,param_1,0x10,0),
      -1 < NVar2)) && (NVar2 = 0, param_5 != 0)) {
    do {
      if (uVar5 == 0) {
        NVar2 = BCryptEncrypt(local_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,(PUCHAR)local_30,0x10,
                              local_48,0);
        if (NVar2 < 0) break;
        pUVar3 = param_2 + 0xf;
        do {
          *pUVar3 = *pUVar3 + '\x01';
          if (*pUVar3 != '\0') break;
          pUVar3 = pUVar3 + -1;
        } while (0 < (longlong)(pUVar3 + (1 - (longlong)param_2)));
      }
      if ((param_5 < 4) || (uVar4 = (ulonglong)(int)uVar5, 0xb < uVar4)) {
        if ((param_5 < 2) || (uVar4 = (ulonglong)(int)uVar5, 0xd < uVar4)) {
          uVar1 = *param_3;
          puVar6 = (uint *)((longlong)param_4 + 1);
          param_3 = (uint *)((longlong)param_3 + 1);
          *(byte *)param_4 = *(byte *)((longlong)local_30 + (longlong)(int)uVar5) ^ (byte)uVar1;
          uVar5 = uVar5 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          puVar6 = (uint *)((longlong)param_4 + 2);
          uVar1 = *param_3;
          param_3 = (uint *)((longlong)param_3 + 2);
          uVar5 = uVar5 + 2 & 0xf;
          *(ushort *)param_4 = *(ushort *)((longlong)local_30 + uVar4) ^ (ushort)uVar1;
          param_5 = param_5 - 2;
        }
      }
      else {
        puVar6 = param_4 + 1;
        uVar1 = *param_3;
        param_3 = param_3 + 1;
        uVar5 = uVar5 + 4 & 0xf;
        *param_4 = *(uint *)((longlong)local_30 + uVar4) ^ uVar1;
        param_5 = param_5 - 4;
      }
      param_4 = puVar6;
      NVar2 = 0;
    } while (param_5 != 0);
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
    local_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38,0);
  }
  return -1 < NVar2;
}



bool thunk_FUN_180002170(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5)

{
  uint uVar1;
  NTSTATUS NVar2;
  PUCHAR pUVar3;
  ulonglong uVar4;
  uint uVar5;
  uint *puVar6;
  ULONG aUStack_48 [2];
  BCRYPT_KEY_HANDLE pvStack_40;
  BCRYPT_ALG_HANDLE pvStack_38;
  uint auStack_30 [6];
  
  uVar5 = 0;
  pvStack_38 = (BCRYPT_HANDLE)0x0;
  pvStack_40 = (BCRYPT_KEY_HANDLE)0x0;
  aUStack_48[0] = 0;
  NVar2 = BCryptOpenAlgorithmProvider(&pvStack_38,L"AES",(LPCWSTR)0x0,0);
  if ((((-1 < NVar2) &&
       (NVar2 = BCryptSetProperty(pvStack_38,L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
       -1 < NVar2)) &&
      (NVar2 = BCryptGenerateSymmetricKey(pvStack_38,&pvStack_40,(PUCHAR)0x0,0,param_1,0x10,0),
      -1 < NVar2)) && (NVar2 = 0, param_5 != 0)) {
    do {
      if (uVar5 == 0) {
        NVar2 = BCryptEncrypt(pvStack_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,(PUCHAR)auStack_30,
                              0x10,aUStack_48,0);
        if (NVar2 < 0) break;
        pUVar3 = param_2 + 0xf;
        do {
          *pUVar3 = *pUVar3 + '\x01';
          if (*pUVar3 != '\0') break;
          pUVar3 = pUVar3 + -1;
        } while (0 < (longlong)(pUVar3 + (1 - (longlong)param_2)));
      }
      if ((param_5 < 4) || (uVar4 = (ulonglong)(int)uVar5, 0xb < uVar4)) {
        if ((param_5 < 2) || (uVar4 = (ulonglong)(int)uVar5, 0xd < uVar4)) {
          uVar1 = *param_3;
          puVar6 = (uint *)((longlong)param_4 + 1);
          param_3 = (uint *)((longlong)param_3 + 1);
          *(byte *)param_4 = *(byte *)((longlong)auStack_30 + (longlong)(int)uVar5) ^ (byte)uVar1;
          uVar5 = uVar5 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          puVar6 = (uint *)((longlong)param_4 + 2);
          uVar1 = *param_3;
          param_3 = (uint *)((longlong)param_3 + 2);
          uVar5 = uVar5 + 2 & 0xf;
          *(ushort *)param_4 = *(ushort *)((longlong)auStack_30 + uVar4) ^ (ushort)uVar1;
          param_5 = param_5 - 2;
        }
      }
      else {
        puVar6 = param_4 + 1;
        uVar1 = *param_3;
        param_3 = param_3 + 1;
        uVar5 = uVar5 + 4 & 0xf;
        *param_4 = *(uint *)((longlong)auStack_30 + uVar4) ^ uVar1;
        param_5 = param_5 - 4;
      }
      param_4 = puVar6;
      NVar2 = 0;
    } while (param_5 != 0);
  }
  if (pvStack_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(pvStack_40);
    pvStack_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (pvStack_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(pvStack_38,0);
  }
  return -1 < NVar2;
}



undefined8
FUN_1800023b0(PUCHAR param_1,undefined8 param_2,undefined8 param_3,undefined1 *param_4,
             undefined8 param_5,undefined8 *param_6)

{
  ushort uVar1;
  NTSTATUS NVar2;
  char **ppcVar3;
  ULONG *pUVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  undefined8 *puVar8;
  undefined8 local_res18;
  BCRYPT_HASH_HANDLE local_res20;
  uint uStack0000000000000038;
  BCRYPT_ALG_HANDLE local_a8;
  ULONG local_a0 [2];
  uint local_98;
  undefined4 local_94;
  char *local_90 [4];
  UCHAR local_70 [48];
  
  local_90[0] = (char *)&local_res18;
  local_90[1] = "SNBase";
  local_90[2] = (char *)&param_5;
  if (param_4 != (undefined1 *)0x0) {
    local_90[2] = param_4;
  }
  uVar7 = 0x20;
  local_90[3] = (char *)&param_5;
  local_a0[0] = 4;
  local_98 = 4;
  if (param_4 != (undefined1 *)0x0) {
    local_98 = uVar7;
  }
  local_a0[1] = 7;
  local_94 = 4;
  param_5._0_4_ = 0x10000;
  uStack0000000000000038 = 1;
  puVar8 = param_6;
  local_res18 = param_3;
  do {
    uVar5 = uStack0000000000000038;
    uVar1 = (ushort)(uStack0000000000000038 >> 0x10);
    local_res18 = CONCAT44(local_res18._4_4_,
                           ((uint)(ushort)((short)uStack0000000000000038 << 8) |
                           uStack0000000000000038 >> 8 & 0xff) << 0x10 | (uint)(ushort)(uVar1 << 8)
                           | (uint)(uVar1 >> 8));
    NVar2 = BCryptOpenAlgorithmProvider(&local_a8,L"SHA256",(LPCWSTR)0x0,8);
    if (NVar2 < 0) {
      return 0;
    }
    NVar2 = BCryptCreateHash(local_a8,&local_res20,(PUCHAR)0x0,0,param_1,0x20,0);
    if (-1 < NVar2) {
      uVar5 = 0;
      if ((param_4 != (undefined1 *)0x0) != 0xfffffffd) {
        pUVar4 = local_a0;
        ppcVar3 = local_90;
        do {
          if ((((PUCHAR)*ppcVar3 != (PUCHAR)0x0) && (*pUVar4 != 0)) &&
             (NVar2 = BCryptHashData(local_res20,(PUCHAR)*ppcVar3,*pUVar4,0), NVar2 < 0))
          goto LAB_18000254b;
          uVar5 = uVar5 + 1;
          ppcVar3 = ppcVar3 + 1;
          pUVar4 = pUVar4 + 1;
        } while (uVar5 < (param_4 != (undefined1 *)0x0) + 3);
      }
      if (-1 < NVar2) {
        NVar2 = BCryptFinishHash(local_res20,local_70,0x20,0);
      }
LAB_18000254b:
      BCryptDestroyHash(local_res20);
      uVar5 = uStack0000000000000038;
    }
    BCryptCloseAlgorithmProvider(local_a8,0);
    if (NVar2 < 0) {
      return 0;
    }
    uVar6 = 0x20;
    if (uVar7 < 0x20) {
      uVar6 = uVar7;
    }
    FUN_18001d560(puVar8,(undefined8 *)local_70,(ulonglong)uVar6);
    uStack0000000000000038 = uVar5 + 1;
    puVar8 = (undefined8 *)((longlong)puVar8 + (ulonglong)uVar6);
    uVar7 = uVar7 - uVar6;
    if (uVar7 == 0) {
      return 1;
    }
  } while( true );
}



UINT FUN_1800025c0(void)

{
  char cVar1;
  short sVar2;
  UINT BufferSize;
  UINT UVar3;
  NTSTATUS NVar4;
  HANDLE pvVar5;
  LPVOID pFirmwareTableBuffer;
  short *psVar6;
  short *psVar7;
  LPVOID pvVar8;
  int iVar9;
  short *psVar10;
  uint uVar11;
  int iVar13;
  int iVar14;
  ULONG *pUVar15;
  short **ppsVar16;
  ULONG local_res8 [2];
  BCRYPT_HASH_HANDLE local_res10;
  BCRYPT_ALG_HANDLE local_res18;
  short *local_38 [2];
  LPVOID pvVar12;
  
  pvVar12 = (LPVOID)0x0;
  iVar14 = 0;
  local_res8[0] = 0;
  local_res8[1] = 0;
  local_38[0] = (short *)0x0;
  local_38[1] = (short *)0x0;
  BufferSize = GetSystemFirmwareTable(0x52534d42,0,(PVOID)0x0,0);
  if (BufferSize == 0) {
    return BufferSize;
  }
  pvVar5 = GetProcessHeap();
  pFirmwareTableBuffer = HeapAlloc(pvVar5,0,(ulonglong)BufferSize);
  pvVar8 = pFirmwareTableBuffer;
  if (pFirmwareTableBuffer == (LPVOID)0x0) goto LAB_180002853;
  UVar3 = GetSystemFirmwareTable(0x52534d42,0,pFirmwareTableBuffer,BufferSize);
  iVar13 = iVar14;
  if (BufferSize == UVar3) {
    psVar6 = (short *)((longlong)pFirmwareTableBuffer + 8);
    psVar10 = (short *)((ulonglong)*(uint *)((longlong)pFirmwareTableBuffer + 4) +
                       (longlong)pFirmwareTableBuffer);
    if (psVar6 < psVar10) {
      while ((char)*psVar6 != '\x01') {
        psVar6 = (short *)((longlong)psVar6 + (ulonglong)*(byte *)((longlong)psVar6 + 1));
        if (psVar10 <= psVar6) goto LAB_180002740;
        sVar2 = *psVar6;
        while (sVar2 != 0) {
          if (psVar10 <= psVar6) goto LAB_180002740;
          psVar6 = (short *)((longlong)psVar6 + 1);
          sVar2 = *psVar6;
        }
        if ((psVar10 <= psVar6) || (psVar6 = psVar6 + 1, psVar10 <= psVar6)) goto LAB_180002740;
      }
      if ((*(longlong *)(psVar6 + 4) != *(longlong *)(psVar6 + 8)) ||
         (*(longlong *)(psVar6 + 4) - 1U < 0xfffffffffffffffe)) {
        iVar13 = 0x10;
        local_res8[0] = 0x10;
        local_38[0] = psVar6 + 4;
      }
      if ((*(char *)((longlong)psVar6 + 7) != '\0') &&
         (psVar7 = (short *)((longlong)psVar6 + (ulonglong)*(byte *)((longlong)psVar6 + 1)),
         psVar7 < psVar10)) {
        iVar9 = *(byte *)((longlong)psVar6 + 7) - 1;
        if (iVar9 != 0) goto LAB_1800026f0;
        goto LAB_180002714;
      }
    }
  }
  goto LAB_180002740;
  while( true ) {
    psVar7 = (short *)((longlong)psVar7 + 1);
    iVar9 = iVar9 + -1;
    if (iVar9 == 0) break;
LAB_1800026f0:
    cVar1 = (char)*psVar7;
    while (cVar1 != '\0') {
      if (psVar10 <= psVar7) goto LAB_180002710;
      psVar7 = (short *)((longlong)psVar7 + 1);
      cVar1 = *(char *)psVar7;
    }
    if (psVar10 <= psVar7) {
LAB_180002710:
      if (iVar9 != 0) goto LAB_180002740;
      break;
    }
  }
LAB_180002714:
  cVar1 = (char)*psVar7;
  psVar6 = psVar7;
  while (local_38[1] = psVar7, cVar1 != '\0') {
    if (psVar10 <= psVar6) goto LAB_180002740;
    psVar6 = (short *)((longlong)psVar6 + 1);
    cVar1 = *(char *)psVar6;
  }
  if (psVar6 < psVar10) {
    iVar14 = ((int)psVar6 - (int)psVar7) + 1;
    local_res8[1] = iVar14;
  }
LAB_180002740:
  if ((iVar13 != 0) || (pvVar8 = pvVar12, iVar14 != 0)) {
    local_res18 = (BCRYPT_ALG_HANDLE)0x0;
    NVar4 = BCryptOpenAlgorithmProvider(&local_res18,L"SHA256",(LPCWSTR)0x0,0);
    if (-1 < NVar4) {
      NVar4 = BCryptCreateHash(local_res18,&local_res10,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
      if (-1 < NVar4) {
        pUVar15 = local_res8;
        ppsVar16 = local_38;
        do {
          if (((*ppsVar16 != (short *)0x0) && (*pUVar15 != 0)) &&
             (NVar4 = BCryptHashData(local_res10,(PUCHAR)*ppsVar16,*pUVar15,0), NVar4 < 0))
          goto LAB_180002818;
          uVar11 = (int)pvVar12 + 1;
          pvVar12 = (LPVOID)(ulonglong)uVar11;
          ppsVar16 = ppsVar16 + 1;
          pUVar15 = pUVar15 + 1;
        } while (uVar11 < 2);
        if (-1 < NVar4) {
          NVar4 = BCryptFinishHash(local_res10,&DAT_180049ef8,0x20,0);
        }
LAB_180002818:
        BCryptDestroyHash(local_res10);
      }
      BCryptCloseAlgorithmProvider(local_res18,0);
    }
    pvVar8 = (LPVOID)(ulonglong)(-1 < NVar4);
  }
  pvVar5 = GetProcessHeap();
  HeapFree(pvVar5,0,pFirmwareTableBuffer);
LAB_180002853:
  return (UINT)pvVar8;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined * FUN_180002870(void)

{
  UINT UVar1;
  
  if (DAT_180049f18 == '\0') {
    UVar1 = FUN_1800025c0();
    if (UVar1 == 0) {
      _DAT_180049ef8 = 0;
      _DAT_180049f00 = 0;
      _DAT_180049f08 = 0;
      _DAT_180049f10 = 0;
    }
    DAT_180049f18 = '\x01';
  }
  return &DAT_180049ef8;
}



int FUN_1800028c0(int *param_1,int *param_2)

{
  if (*param_1 != 0x5366616b) {
    return 0;
  }
  if (param_2 != (int *)0x0) {
    *param_2 = param_1[2];
  }
  return param_1[3];
}



bool FUN_1800028e0(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5,
                  PUCHAR param_6,uint *param_7)

{
  uint uVar1;
  uint uVar2;
  NTSTATUS NVar3;
  uint uVar4;
  PUCHAR pUVar5;
  uint *puVar6;
  int iVar7;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_ALG_HANDLE local_38 [2];
  
  iVar7 = 0;
  local_38[0] = (BCRYPT_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  local_48[0] = 0;
  NVar3 = BCryptOpenAlgorithmProvider(local_38,L"AES",(LPCWSTR)0x0,0);
  if (((-1 < NVar3) &&
      (NVar3 = BCryptSetProperty(local_38[0],L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
      -1 < NVar3)) &&
     (NVar3 = BCryptGenerateSymmetricKey(local_38[0],&local_40,(PUCHAR)0x0,0,param_1,0x10,0),
     -1 < NVar3)) {
    NVar3 = iVar7;
    if (param_4 == (uint *)0x0) {
      if (param_5 != 0) {
        do {
          if (*param_7 == 0) {
            if ((param_5 < 0x11) &&
               (NVar3 = BCryptEncrypt(local_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,param_6,0x10,
                                      local_48,0), NVar3 < 0)) break;
            pUVar5 = param_2 + 0xf;
            do {
              *pUVar5 = *pUVar5 + '\x01';
              if (*pUVar5 != '\0') break;
              pUVar5 = pUVar5 + -1;
            } while (0 < (longlong)(pUVar5 + (1 - (longlong)param_2)));
          }
          *param_7 = *param_7 + 1 & 0xf;
          param_5 = param_5 - 1;
          NVar3 = iVar7;
        } while (param_5 != 0);
      }
    }
    else if (param_5 != 0) {
      do {
        if (*param_7 == 0) {
          NVar3 = BCryptEncrypt(local_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,param_6,0x10,
                                local_48,0);
          if (NVar3 < 0) break;
          pUVar5 = param_2 + 0xf;
          do {
            *pUVar5 = *pUVar5 + '\x01';
            if (*pUVar5 != '\0') break;
            pUVar5 = pUVar5 + -1;
          } while (0 < (longlong)(pUVar5 + (1 - (longlong)param_2)));
        }
        if (param_5 < 4) {
LAB_180002a60:
          if (1 < param_5) {
            uVar1 = *param_7;
            if (uVar1 < 0xe) {
              puVar6 = (uint *)((longlong)param_4 + 2);
              uVar2 = *param_3;
              param_3 = (uint *)((longlong)param_3 + 2);
              uVar4 = uVar1 + 2 & 0xf;
              *(ushort *)param_4 = *(ushort *)(param_6 + uVar1) ^ (ushort)uVar2;
              param_5 = param_5 - 2;
              goto LAB_180002aac;
            }
          }
          uVar2 = *param_3;
          uVar1 = *param_7;
          param_3 = (uint *)((longlong)param_3 + 1);
          puVar6 = (uint *)((longlong)param_4 + 1);
          *(byte *)param_4 = param_6[uVar1] ^ (byte)uVar2;
          uVar4 = uVar1 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          uVar1 = *param_7;
          if (0xb < uVar1) goto LAB_180002a60;
          puVar6 = param_4 + 1;
          uVar2 = *param_3;
          param_3 = param_3 + 1;
          uVar4 = uVar1 + 4 & 0xf;
          *param_4 = *(uint *)(param_6 + uVar1) ^ uVar2;
          param_5 = param_5 - 4;
        }
LAB_180002aac:
        *param_7 = uVar4;
        param_4 = puVar6;
        NVar3 = iVar7;
      } while (param_5 != 0);
    }
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
  }
  if (local_38[0] != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38[0],0);
  }
  return -1 < NVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8
FUN_180002bb0(int *param_1,uint *param_2,uint *param_3,uint *param_4,uint *param_5,longlong param_6)

{
  bool bVar1;
  UINT UVar2;
  NTSTATUS NVar3;
  PUCHAR pbSecret;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  int **ppiVar4;
  uint uVar5;
  ULONG *pUVar6;
  uint uVar7;
  uint local_res8 [2];
  uint *local_res10;
  BCRYPT_HASH_HANDLE local_d8;
  BCRYPT_ALG_HANDLE local_d0;
  ULONG local_c8;
  uint local_c4;
  int *local_c0;
  longlong local_b8;
  longlong local_b0;
  longlong local_a8;
  UCHAR local_a0 [16];
  UCHAR local_90 [24];
  uint local_78 [16];
  
  if (*param_1 != 0x5366616b) {
    return 0;
  }
  local_c8 = param_1[1] - 0x10;
  uVar7 = 0;
  local_b8 = param_6;
  local_res8[0] = 0;
  local_c4 = -(uint)(param_6 != 0) & 0x20;
  local_res10 = param_2;
  local_c0 = param_1;
  if (DAT_180049f18 == '\0') {
    UVar2 = FUN_1800025c0();
    if (UVar2 == 0) {
      _DAT_180049ef8 = 0;
      _DAT_180049f00 = 0;
      _DAT_180049f08 = 0;
      _DAT_180049f10 = 0;
    }
    DAT_180049f18 = '\x01';
  }
  NVar3 = BCryptOpenAlgorithmProvider(&local_d0,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar3) {
    NVar3 = BCryptCreateHash(local_d0,&local_d8,(PUCHAR)0x0,0,&DAT_180049ef8,0x20,0);
    if (-1 < NVar3) {
      uVar5 = 0;
      pUVar6 = &local_c8;
      ppiVar4 = &local_c0;
      do {
        if (((*ppiVar4 != (int *)0x0) && (*pUVar6 != 0)) &&
           (NVar3 = BCryptHashData(local_d8,(PUCHAR)*ppiVar4,*pUVar6,0), NVar3 < 0))
        goto LAB_180002d22;
        uVar5 = uVar5 + 1;
        ppiVar4 = ppiVar4 + 1;
        pUVar6 = pUVar6 + 1;
      } while (uVar5 < 2);
      if (-1 < NVar3) {
        NVar3 = BCryptFinishHash(local_d8,(PUCHAR)&local_b0,0x20,0);
      }
LAB_180002d22:
      BCryptDestroyHash(local_d8);
      param_2 = local_res10;
    }
    BCryptCloseAlgorithmProvider(local_d0,0);
    if (((((-1 < NVar3) &&
          (*(longlong *)((ulonglong)(param_1[1] - 0x10U) + (longlong)param_1) == local_b0)) &&
         (*(longlong *)((ulonglong)(param_1[1] - 0x10U) + 8 + (longlong)param_1) == local_a8)) &&
        ((param_3 == (uint *)0x0 || ((param_2 != (uint *)0x0 && ((uint)param_1[2] <= *param_3))))))
       && ((param_5 == (uint *)0x0 || ((param_4 != (uint *)0x0 && ((uint)param_1[3] <= *param_5)))))
       ) {
      local_c0 = param_1 + 4;
      local_c8 = 0x10;
      pbSecret = FUN_180002870();
      NVar3 = BCryptOpenAlgorithmProvider(&local_d0,L"SHA256",(LPCWSTR)0x0,8);
      if (-1 < NVar3) {
        NVar3 = BCryptCreateHash(local_d0,&local_d8,(PUCHAR)0x0,0,pbSecret,0x20,0);
        if (-1 < NVar3) {
          pUVar6 = &local_c8;
          ppiVar4 = &local_c0;
          do {
            if (((*ppiVar4 != (int *)0x0) && (*pUVar6 != 0)) &&
               (NVar3 = BCryptHashData(local_d8,(PUCHAR)*ppiVar4,*pUVar6,0), NVar3 < 0))
            goto LAB_180002e74;
            uVar7 = uVar7 + 1;
            ppiVar4 = ppiVar4 + 1;
            pUVar6 = pUVar6 + 1;
          } while (uVar7 < 2);
          if (-1 < NVar3) {
            NVar3 = BCryptFinishHash(local_d8,(PUCHAR)&local_b0,0x20,0);
          }
LAB_180002e74:
          BCryptDestroyHash(local_d8);
        }
        BCryptCloseAlgorithmProvider(local_d0,0);
        if (((-1 < NVar3) &&
            (bVar1 = FUN_1800028e0((PUCHAR)&local_b0,local_a0,(uint *)(param_1 + 8),local_78,0x10,
                                   local_90,local_res8), (int)CONCAT71(extraout_var,bVar1) != 0)) &&
           ((param_1[2] == 0 ||
            (bVar1 = FUN_1800028e0((PUCHAR)&local_b0,local_a0,(uint *)(param_1 + 0xc),local_res10,
                                   param_1[2],local_90,local_res8),
            (int)CONCAT71(extraout_var_00,bVar1) != 0)))) {
          if (param_3 != (uint *)0x0) {
            *param_3 = param_1[2];
          }
          if (((param_1[3] == 0) || (param_4 == (uint *)0x0)) ||
             (bVar1 = FUN_1800028e0((PUCHAR)&local_b0,local_a0,
                                    (uint *)((longlong)param_1 + (ulonglong)(uint)param_1[2] + 0x30)
                                    ,param_4,param_1[3],local_90,local_res8),
             (int)CONCAT71(extraout_var_01,bVar1) != 0)) {
            if (param_5 != (uint *)0x0) {
              *param_5 = param_1[3];
            }
            return 1;
          }
        }
      }
    }
  }
  return 0;
}



undefined8 FUN_180002f90(undefined8 param_1,PUCHAR param_2)

{
  NTSTATUS NVar1;
  int iVar2;
  ULONG *pUVar3;
  undefined8 *puVar4;
  ULONG local_res8 [4];
  BCRYPT_HASH_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  undefined8 local_38 [2];
  
  local_res8[0] = 0x20;
  local_38[0] = param_1;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    iVar2 = 0;
    NVar1 = BCryptCreateHash(local_res20,&local_res18,(PUCHAR)0x0,0,"Mzg0",0x13,0);
    if (-1 < NVar1) {
      puVar4 = local_38;
      pUVar3 = local_res8;
      do {
        if (((PUCHAR)*puVar4 != (PUCHAR)0x0) && (*pUVar3 != 0)) {
          NVar1 = BCryptHashData(local_res18,(PUCHAR)*puVar4,*pUVar3,0);
          if (NVar1 < 0) goto LAB_180003084;
        }
        iVar2 = iVar2 + 1;
        puVar4 = puVar4 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar2 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_res18,param_2,0x20,0);
      }
LAB_180003084:
      BCryptDestroyHash(local_res18);
    }
    BCryptCloseAlgorithmProvider(local_res20,0);
    if (-1 < NVar1) {
      return 0;
    }
  }
  return 1;
}



void FUN_1800030d0(longlong param_1,uint *param_2,int param_3,undefined8 *param_4,longlong param_5)

{
  bool bVar1;
  NTSTATUS NVar2;
  uint *puVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  int iVar5;
  ULONG *pUVar6;
  longlong *plVar7;
  undefined1 auStackY_138 [32];
  ULONG local_f8 [2];
  BCRYPT_HASH_HANDLE local_f0;
  BCRYPT_ALG_HANDLE local_e8;
  longlong local_e0 [2];
  uint *local_d0;
  UCHAR local_c8 [16];
  UCHAR local_b8 [16];
  ulonglong local_a8 [4];
  undefined1 local_88 [32];
  undefined8 local_68;
  undefined8 uStack_60;
  undefined8 local_58;
  undefined8 uStack_50;
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStackY_138;
  local_e0[1] = param_5;
  local_d0 = param_2;
  if ((param_3 == 0xa0) && (puVar3 = (uint *)FUN_18001ed60(0xa0), puVar3 != (uint *)0x0)) {
    local_f8[0] = 0x20;
    local_e0[0] = param_1;
    NVar2 = BCryptOpenAlgorithmProvider(&local_e8,L"SHA256",(LPCWSTR)0x0,8);
    if (-1 < NVar2) {
      iVar5 = 0;
      NVar2 = BCryptCreateHash(local_e8,&local_f0,(PUCHAR)0x0,0,"MTI4",0x1a,0);
      if (-1 < NVar2) {
        pUVar6 = local_f8;
        plVar7 = local_e0;
        do {
          if ((((PUCHAR)*plVar7 != (PUCHAR)0x0) && (*pUVar6 != 0)) &&
             (NVar2 = BCryptHashData(local_f0,(PUCHAR)*plVar7,*pUVar6,0), NVar2 < 0))
          goto LAB_18000320b;
          iVar5 = iVar5 + 1;
          plVar7 = plVar7 + 1;
          pUVar6 = pUVar6 + 1;
        } while (iVar5 == 0);
        if (-1 < NVar2) {
          NVar2 = BCryptFinishHash(local_f0,local_c8,0x20,0);
        }
LAB_18000320b:
        BCryptDestroyHash(local_f0);
        param_5 = local_e0[1];
        param_2 = local_d0;
      }
      BCryptCloseAlgorithmProvider(local_e8,0);
      if ((-1 < NVar2) &&
         (bVar1 = FUN_180002170(local_b8,local_c8,param_2,puVar3,0xa0),
         (int)CONCAT71(extraout_var,bVar1) != 0)) {
        local_f8[0] = 0x60;
        uVar4 = FUN_180002bb0((int *)puVar3,(uint *)0x0,(uint *)0x0,(uint *)local_a8,local_f8,
                              param_5);
        if ((((int)uVar4 != 0) &&
            ((local_f8[0] == 0x60 &&
             (uVar4 = FUN_180002f90(param_1,(PUCHAR)local_a8), (int)uVar4 == 0)))) &&
           (iVar5 = FUN_18001dae0(local_a8,(longlong)local_88,0x20), iVar5 == 0)) {
          *param_4 = local_68;
          param_4[1] = uStack_60;
          param_4[2] = local_58;
          param_4[3] = uStack_50;
        }
      }
    }
    FUN_18001d45c(puVar3);
  }
  FUN_18001d530(local_48 ^ (ulonglong)auStackY_138);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180003422)

void FUN_180003310(PUCHAR param_1,uint param_2,undefined8 *param_3,undefined8 *param_4,char *param_5
                  )

{
  undefined8 uVar1;
  bool bVar2;
  NTSTATUS NVar3;
  undefined7 extraout_var;
  PUCHAR pUVar4;
  undefined1 auStackY_168 [32];
  UCHAR local_128 [8];
  undefined8 local_120;
  undefined8 uStack_118;
  undefined8 local_110;
  undefined8 uStack_108;
  undefined8 local_100;
  undefined8 uStack_f8;
  undefined8 local_f0;
  undefined8 uStack_e8;
  UCHAR local_d8 [72];
  undefined8 local_90;
  undefined8 uStack_88;
  undefined8 local_80;
  undefined8 uStack_78;
  ulonglong local_68;
  ulonglong uStack_60;
  ulonglong local_58;
  ulonglong uStack_50;
  ulonglong local_48;
  ulonglong uStack_40;
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_168;
  FUN_18001dbc0((undefined1 (*) [16])local_d8,0,0x68);
  local_90 = *param_3;
  uStack_88 = param_3[1];
  local_80 = param_3[2];
  uStack_78 = param_3[3];
  pUVar4 = local_128;
  local_120 = *param_4;
  uStack_118 = param_4[1];
  builtin_memcpy(local_d8,"ECK2 ",6);
  local_d8[6] = '\0';
  local_d8[7] = '\0';
  builtin_memcpy(local_128,"ECK1 ",6);
  local_128[6] = '\0';
  local_128[7] = '\0';
  local_110 = param_4[2];
  uStack_108 = param_4[3];
  local_100 = param_4[4];
  uStack_f8 = param_4[5];
  local_f0 = param_4[6];
  uStack_e8 = param_4[7];
  NVar3 = FUN_1800015d0(local_d8,pUVar4,"SecureShare",0xb,(PUCHAR)&local_68,0x20);
  if (-1 < NVar3) {
    local_48 = local_58 ^ local_68;
    uStack_40 = uStack_50 ^ uStack_60;
    bVar2 = FUN_180001fd0((PUCHAR)&local_68,pUVar4,(PUCHAR)&local_48,param_1,param_2,param_1,param_2
                         );
    if ((int)CONCAT71(extraout_var,bVar2) != 0) {
      uVar1 = *(undefined8 *)(param_1 + 0x28);
      *(undefined8 *)param_5 = *(undefined8 *)(param_1 + 0x20);
      *(undefined8 *)(param_5 + 8) = uVar1;
      if (((((*(int *)(param_1 + 0x30) + 0xcebeacaeU & 0xfdffffff) == 0) && (*param_5 == 'R')) &&
          (param_5[2] == 'P')) &&
         (((*(uint *)(param_1 + 0x34) == (uint)((byte)param_5[1] >> 4) << (param_5[1] & 0xfU) &&
           (param_5[3] == 'B')) && (0x50f < (*(uint *)(param_1 + 0x34) & 0xfffffff8))))) {
        FUN_180001ab0(*(uint *)(param_1 + 0x3c),*(uint *)(param_1 + 0x38),
                      (undefined8 *)(param_1 + 0x48),
                      (undefined8 *)(param_1 + 0x48 + *(uint *)(param_1 + 0x38)),
                      (undefined8 *)(param_5 + 0x18),(uint *)(param_5 + 0x10));
      }
    }
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_168);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180003520(undefined8 *param_1,int *param_2,undefined8 param_3,char *param_4)

{
  undefined8 *puVar1;
  UINT UVar2;
  int iVar3;
  undefined8 uVar4;
  int *piVar5;
  PUCHAR pUVar6;
  undefined1 auStackY_e8 [32];
  undefined8 in_stack_ffffffffffffff38;
  undefined8 local_a8;
  undefined8 uStack_a0;
  undefined8 local_98;
  undefined8 uStack_90;
  undefined8 local_88;
  undefined8 uStack_80;
  undefined8 local_78;
  undefined8 uStack_70;
  undefined8 local_68 [4];
  undefined8 local_48 [4];
  ulonglong local_28;
  
  local_28 = DAT_1800461a0 ^ (ulonglong)auStackY_e8;
  if (2 < (uint)param_3) {
    pUVar6 = *(PUCHAR *)(param_4 + 0x20);
    piVar5 = param_2;
    if (pUVar6 == (PUCHAR)0x0) {
      if (DAT_180049f18 == '\0') {
        UVar2 = FUN_1800025c0();
        if (UVar2 == 0) {
          _DAT_180049ef8 = 0;
          _DAT_180049f00 = 0;
          _DAT_180049f08 = 0;
          _DAT_180049f10 = 0;
        }
        DAT_180049f18 = '\x01';
      }
      pUVar6 = &DAT_180049ef8;
    }
    if (DAT_180049f18 == '\0') {
      UVar2 = FUN_1800025c0();
      if (UVar2 == 0) {
        _DAT_180049ef8 = 0;
        _DAT_180049f00 = 0;
        _DAT_180049f08 = 0;
        _DAT_180049f10 = 0;
      }
      DAT_180049f18 = '\x01';
    }
    uVar4 = FUN_1800023b0(pUVar6,piVar5,param_3,&DAT_180049ef8,in_stack_ffffffffffffff38,local_48);
    if ((((int)uVar4 != 0) &&
        (iVar3 = FUN_1800030d0((longlong)local_48,(uint *)*param_1,*param_2,local_68,
                               *(longlong *)(param_4 + 0x20)), iVar3 == 0)) && (param_2[1] == 0x40))
    {
      puVar1 = (undefined8 *)param_1[1];
      local_a8 = *puVar1;
      uStack_a0 = puVar1[1];
      local_98 = puVar1[2];
      uStack_90 = puVar1[3];
      local_88 = puVar1[4];
      uStack_80 = puVar1[5];
      local_78 = puVar1[6];
      uStack_70 = puVar1[7];
      FUN_180003310((PUCHAR)param_1[2],param_2[2],local_68,&local_a8,param_4);
    }
  }
  FUN_18001d530(local_28 ^ (ulonglong)auStackY_e8);
  return;
}



void FUN_1800036b0(undefined8 param_1,uint param_2)

{
  FUN_1800040a0(param_1,(uint *)param_1,param_2);
  return;
}



void FUN_1800036d0(uint *param_1,uint param_2)

{
  NTSTATUS NVar1;
  undefined **ppuVar2;
  ULONG *pUVar3;
  int iVar4;
  undefined1 auStackY_b8 [32];
  ULONG local_78 [2];
  BCRYPT_HASH_HANDLE local_70;
  BCRYPT_ALG_HANDLE local_68;
  undefined *local_60;
  UCHAR local_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_b8;
  local_60 = &DAT_180040428;
  local_78[0] = 0x20;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_68,&local_70,(PUCHAR)0x0,0,"QWNj",0x15,0);
    if (-1 < NVar1) {
      iVar4 = 0;
      pUVar3 = local_78;
      ppuVar2 = &local_60;
      do {
        if (((*ppuVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
           (NVar1 = BCryptHashData(local_70,*ppuVar2,*pUVar3,0), NVar1 < 0)) goto LAB_1800037e5;
        iVar4 = iVar4 + 1;
        ppuVar2 = ppuVar2 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar4 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_70,local_58,0x20,0);
      }
LAB_1800037e5:
      BCryptDestroyHash(local_70);
    }
    BCryptCloseAlgorithmProvider(local_68,0);
    if (-1 < NVar1) {
      FUN_180002170(local_48,local_58,param_1,param_1,param_2);
    }
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_b8);
  return;
}



void FUN_180003870(longlong param_1,uint param_2,ulonglong *param_3,int param_4,longlong param_5)

{
  NTSTATUS NVar1;
  longlong *plVar2;
  ULONG *pUVar3;
  int iVar4;
  undefined8 uVar5;
  undefined1 auStackY_128 [32];
  undefined8 in_stack_fffffffffffffef8;
  uint local_e8 [2];
  int local_e0 [2];
  BCRYPT_HASH_HANDLE local_d8;
  longlong local_d0;
  ULONG local_c8 [2];
  BCRYPT_ALG_HANDLE local_c0;
  int local_b8 [20];
  UCHAR local_68 [32];
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStackY_128;
  iVar4 = 0;
  local_e0[0] = 0;
  local_e8[0] = param_2;
  if (param_4 == 0x60) {
    if (*(longlong *)(param_5 + 0x28) == 0) {
      uVar5 = 0x20;
      iVar4 = FUN_18001dae0(param_3,0x180040490,0x20);
      if (iVar4 == 0) {
        local_b8[2] = 0x7e5af32e;
        local_b8[3] = 0x6450e3f;
        local_b8[4] = -0xc2ef683;
        local_b8[5] = -0x54ede992;
        local_b8[6] = -0x5a97d7d8;
        local_b8[7] = -0x10a08b80;
        local_b8[8] = 0x4b1d13af;
        local_b8[9] = -0x379e48f7;
        local_b8[10] = -0x7d6a26da;
        local_b8[0xb] = -0x1dfc2e1a;
        local_b8[0xc] = -0x70fe801a;
        local_b8[0xd] = 0x20702292;
        local_b8[0xe] = -0x6167d619;
        local_b8[0xf] = 0x13c294b2;
        local_b8[0x10] = 0x2ad9c944;
        local_b8[0x11] = 0x127d49e5;
        local_b8[0] = 0x31534345;
        local_b8[1] = 0x20;
        local_e8[0] = param_2;
        local_d0 = param_1;
        FUN_1800014b0(&local_d0,local_e8,uVar5,local_b8,in_stack_fffffffffffffef8,
                      (PUCHAR)(param_3 + 4));
      }
    }
    else {
      local_c8[0] = 0x40;
      local_c0 = (BCRYPT_ALG_HANDLE)0x0;
      local_d0 = *(longlong *)(param_5 + 0x28);
      NVar1 = BCryptOpenAlgorithmProvider(&local_c0,L"SHA256",(LPCWSTR)0x0,0);
      if (-1 < NVar1) {
        NVar1 = BCryptCreateHash(local_c0,&local_d8,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
        if (-1 < NVar1) {
          plVar2 = &local_d0;
          pUVar3 = local_c8;
          do {
            if ((((PUCHAR)*plVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
               (NVar1 = BCryptHashData(local_d8,(PUCHAR)*plVar2,*pUVar3,0), NVar1 < 0))
            goto LAB_180003992;
            iVar4 = iVar4 + 1;
            plVar2 = plVar2 + 1;
            pUVar3 = pUVar3 + 1;
          } while (iVar4 == 0);
          if (-1 < NVar1) {
            NVar1 = BCryptFinishHash(local_d8,local_68,0x20,0);
          }
LAB_180003992:
          BCryptDestroyHash(local_d8);
          param_2 = local_e8[0];
        }
        BCryptCloseAlgorithmProvider(local_c0,0);
        if ((-1 < NVar1) && (iVar4 = FUN_18001dae0(param_3,(longlong)local_68,0x20), iVar4 == 0)) {
          FUN_180001820(*(undefined8 **)(param_5 + 0x28),param_1,(ulonglong)param_2,
                        (PUCHAR)(param_3 + 4),local_e0);
        }
      }
    }
  }
  FUN_18001d530(local_48 ^ (ulonglong)auStackY_128);
  return;
}



void FUN_180003b00(undefined4 param_1)

{
  code *pcVar1;
  undefined4 local_res8 [8];
  
  local_res8[0] = param_1;
  FUN_18001f038((longlong *)local_res8,&DAT_180044830);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_180003b20(void)

{
  code *pcVar1;
  DWORD DVar2;
  
  DVar2 = GetLastError();
  if (0 < (int)DVar2) {
    DVar2 = DVar2 & 0xffff | 0x80070000;
  }
  FUN_180003b00(DVar2);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



BOOL __stdcall
InitializeCriticalSectionEx(LPCRITICAL_SECTION lpCriticalSection,DWORD dwSpinCount,DWORD Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180003b40. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = InitializeCriticalSectionEx(lpCriticalSection,dwSpinCount,Flags);
  return BVar1;
}



void FUN_180003b50(undefined8 *param_1,undefined8 param_2,undefined8 param_3,undefined8 *param_4,
                  int *param_5)

{
  PUCHAR pUVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  int iVar4;
  NTSTATUS NVar5;
  undefined8 *puVar6;
  int iVar7;
  PUCHAR pUVar8;
  uint uVar9;
  undefined1 auStackY_c8 [32];
  uint local_88;
  BCRYPT_ALG_HANDLE local_80;
  int local_78;
  undefined8 local_70;
  undefined8 *local_68;
  undefined4 local_60;
  undefined4 local_5c;
  undefined8 local_58;
  undefined8 uStack_50;
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStackY_c8;
  iVar7 = 0;
  uVar9 = param_5[1] + *param_5;
  local_70 = param_2;
  local_68 = param_1;
  iVar4 = (*(code *)*param_1)(param_1[3],0,0x50,0);
  if (iVar4 != 0) {
    local_78 = local_88 + 0x40 + uVar9;
    puVar6 = (undefined8 *)FUN_18001ed60((longlong)local_78);
    if (puVar6 != (undefined8 *)0x0) {
      pUVar1 = (PUCHAR)(puVar6 + 8);
      pUVar8 = pUVar1 + (int)local_88;
      NVar5 = BCryptOpenAlgorithmProvider(&local_80,L"RNG",(LPCWSTR)0x0,0);
      if (-1 < NVar5) {
        BCryptGenRandom(local_80,pUVar1,0x50,0);
        BCryptCloseAlgorithmProvider(local_80,0);
      }
      *(undefined4 *)(puVar6 + 4) = 0x80000003;
      *(undefined4 *)((longlong)puVar6 + 0x24) = 0;
      *(int *)(puVar6 + 5) = (int)pUVar1 - (int)puVar6;
      *(uint *)((longlong)puVar6 + 0x2c) = local_88;
      if (0 < (int)uVar9) {
        do {
          FUN_18001d560((undefined8 *)(pUVar8 + iVar7),(undefined8 *)*param_4,(longlong)*param_5);
          iVar7 = iVar7 + *param_5;
          param_4 = param_4 + 1;
          param_5 = param_5 + 1;
        } while (iVar7 < (int)uVar9);
      }
      puVar6[6] = 0x7d3;
      *(uint *)((longlong)puVar6 + 0x3c) = uVar9;
      pUVar1 = (PUCHAR)(puVar6 + 8);
      *(int *)(puVar6 + 7) = (int)pUVar8 - (int)puVar6;
      local_58 = puVar6[0x10];
      uStack_50 = puVar6[0x11];
      FUN_180001e20(pUVar1,0x40,(PUCHAR)&local_58,pUVar8,uVar9,pUVar8,uVar9,(ULONG *)0x0);
      puVar3 = local_68;
      iVar4 = (*(code *)*local_68)(local_68[3],pUVar1,0x50,pUVar1);
      if (iVar4 != 0) {
        local_68 = (undefined8 *)0xeeccaa8866442200;
        local_60 = 0x99bbddff;
        local_5c = 0x11335577;
        FUN_180001e20(&DAT_180035090,0x20,(PUCHAR)&local_68,pUVar1,local_88,pUVar1,local_88,
                      (ULONG *)&local_80);
        *puVar6 = 0x4545464c;
        GetSystemTimeAsFileTime((LPFILETIME)(puVar6 + 1));
        uVar2 = ((undefined8 *)puVar3[2])[1];
        puVar6[2] = *(undefined8 *)puVar3[2];
        puVar6[3] = uVar2;
        local_68 = (undefined8 *)0xeeccaa8866442200;
        local_60 = 0x99bbddff;
        local_5c = 0x11335577;
        FUN_180001e20(&DAT_180035080,0x10,(PUCHAR)&local_68,(PUCHAR)(puVar6 + 4),0x20,
                      (PUCHAR)(puVar6 + 4),0x20,(ULONG *)&local_80);
        (*(code *)puVar3[1])(puVar3[3],local_70,puVar6,local_78);
      }
      FUN_18001d45c(puVar6);
    }
  }
  FUN_18001d530(local_48 ^ (ulonglong)auStackY_c8);
  return;
}



void FUN_180003e00(undefined8 *param_1,LPCSTR param_2,undefined8 param_3,int param_4,int param_5)

{
  undefined8 uVar1;
  undefined1 auStackY_198 [32];
  int local_168;
  int local_164;
  undefined4 *local_160;
  undefined8 local_158;
  undefined4 local_150;
  undefined2 local_14c;
  undefined2 local_14a;
  undefined4 local_148;
  undefined1 *local_138;
  undefined1 local_130 [264];
  ulonglong local_28;
  
  local_28 = DAT_1800461a0 ^ (ulonglong)auStackY_198;
  local_138 = local_130;
  uVar1 = 3;
  FUN_180003ed0((longlong *)&local_138,param_2,3);
  local_160 = &local_150;
  local_164 = param_4 * param_5;
  local_14a = (undefined2)param_5;
  local_150 = 0xc;
  local_148 = 0x80001;
  local_168 = 0xc;
  local_158 = param_3;
  local_14c = (short)param_4;
  FUN_180003b50(param_1,local_138,uVar1,&local_160,&local_168);
  if (local_138 != local_130) {
    FUN_18001d45c(local_138);
  }
  FUN_18001d530(local_28 ^ (ulonglong)auStackY_198);
  return;
}



void FUN_180003ed0(longlong *param_1,LPCSTR param_2,UINT param_3)

{
  code *pcVar1;
  int iVar2;
  DWORD DVar3;
  int cbMultiByte;
  longlong lVar4;
  bool bVar5;
  
  if (param_2 == (LPCSTR)0x0) {
    *param_1 = 0;
    return;
  }
  lVar4 = -1;
  do {
    lVar4 = lVar4 + 1;
  } while (param_2[lVar4] != '\0');
  cbMultiByte = (int)lVar4 + 1;
  FUN_180003fe0(param_1,cbMultiByte,param_1 + 1);
  iVar2 = MultiByteToWideChar(param_3,0,param_2,cbMultiByte,(LPWSTR)*param_1,cbMultiByte);
  bVar5 = iVar2 == 0;
  if (bVar5) {
    DVar3 = GetLastError();
    if (DVar3 == 0x7a) {
      iVar2 = MultiByteToWideChar(param_3,0,param_2,cbMultiByte,(LPWSTR)0x0,0);
      FUN_180003fe0(param_1,iVar2,param_1 + 1);
      iVar2 = MultiByteToWideChar(param_3,0,param_2,cbMultiByte,(LPWSTR)*param_1,iVar2);
      bVar5 = iVar2 == 0;
    }
    if (bVar5) {
      FUN_180003b20();
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
  }
  return;
}



void FUN_180003fe0(longlong *param_1,int param_2,LPVOID param_3)

{
  code *pcVar1;
  LPVOID pvVar2;
  
  if (param_1 == (longlong *)0x0) {
    FUN_180003b00(0x80070057);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (param_2 < 0) {
    FUN_180003b00(0x80070057);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (param_3 == (LPVOID)0x0) {
    FUN_180003b00(0x80070057);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  pvVar2 = (LPVOID)*param_1;
  if (pvVar2 == param_3) {
    if (param_2 < 0x81) {
      *param_1 = (longlong)param_3;
      goto LAB_18000404a;
    }
    pvVar2 = FUN_18001ee18((longlong)param_2,2);
  }
  else {
    if (param_2 < 0x81) {
      FUN_18001d45c(pvVar2);
      *param_1 = (longlong)param_3;
      goto LAB_18000404a;
    }
    pvVar2 = FUN_18001ecd8(pvVar2,(longlong)param_2,2);
    if (pvVar2 == (LPVOID)0x0) {
      FUN_180003b00(0x8007000e);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
  }
  *param_1 = (longlong)pvVar2;
LAB_18000404a:
  if (*param_1 != 0) {
    return;
  }
  FUN_180003b00(0x8007000e);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_1800040a0(undefined8 param_1,uint *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint *puVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  longlong *plVar9;
  uint *puVar10;
  char *in_stack_00000038;
  undefined1 auStackY_a8 [32];
  int local_78 [8];
  longlong local_58 [8];
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStackY_a8;
  if ((((0xf < param_3) && (*param_2 <= param_3)) && (param_2[1] == 2)) &&
     ((param_2[2] == 1 && (iVar4 = FUN_1800036d0(param_2 + 3,*param_2 - 0xc), iVar4 == 0)))) {
    uVar1 = param_2[3];
    uVar2 = *param_2;
    uVar6 = 0;
    if (((ulonglong)uVar1 * 4 + 0x10 <= (ulonglong)uVar2) && (uVar1 < 9)) {
      puVar10 = param_2 + (ulonglong)uVar1 + 4;
      if (uVar1 != 0) {
        puVar5 = param_2 + 4;
        plVar9 = local_58;
        uVar8 = 0;
        do {
          uVar7 = uVar8;
          uVar3 = *puVar5;
          uVar6 = uVar6 + uVar3;
          if (uVar2 - 4 < uVar6) goto LAB_1800041df;
          *plVar9 = (longlong)puVar10;
          uVar8 = uVar7 + 1;
          *(uint *)((longlong)local_78 + (-0x10 - (longlong)param_2) + (longlong)puVar5) = uVar3;
          puVar10 = (uint *)((longlong)puVar10 + (ulonglong)uVar3);
          plVar9 = plVar9 + 1;
          puVar5 = puVar5 + 1;
        } while (uVar8 < uVar1);
        if ((1 < uVar8) &&
           (iVar4 = FUN_180003870(local_58[0],uVar6 - local_78[uVar7],(ulonglong *)local_58[uVar7],
                                  local_78[uVar7],(longlong)in_stack_00000038), iVar4 == 0)) {
          FUN_180003520(local_58 + 1,local_78 + 1,(ulonglong)(uVar7 - 1),in_stack_00000038);
        }
      }
    }
  }
LAB_1800041df:
  FUN_18001d530(local_18 ^ (ulonglong)auStackY_a8);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180004200(undefined8 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  int iVar1;
  
  iVar1 = (int)param_3;
  if (iVar1 == 5) {
    _DAT_18004779c = 0x67;
    _DAT_180047798 = 0x34;
    DAT_180047754 = 0xb0;
    DAT_180047794 = 0x58;
  }
  else {
    if (iVar1 == 7) {
      _DAT_18004779c = 0x46;
      _DAT_180047798 = 0x39;
      DAT_180047754 = 0x80;
      DAT_180047794 = 0x68;
      FUN_1800051e0(param_1,param_2,param_3,param_4);
      return;
    }
    if (iVar1 == 9) {
      _DAT_18004779c = 0x89;
      _DAT_180047798 = 0x28;
      DAT_180047754 = 0xf0;
      DAT_180047794 = 0x46;
      FUN_1800051e0(param_1,param_2,param_3,param_4);
      return;
    }
    if (iVar1 == 0x13) {
      _DAT_18004779c = 0x39;
      _DAT_180047798 = 0x2e;
      DAT_180047754 = 0x6b;
      DAT_180047794 = 0x56;
      FUN_1800051e0(param_1,param_2,param_3,param_4);
      return;
    }
    if (iVar1 == 0x15) {
      _DAT_18004779c = 0x78;
      _DAT_180047798 = 0x1c;
      DAT_180047754 = 0xd2;
      DAT_180047794 = 0x31;
      FUN_1800051e0(param_1,param_2,param_3,param_4);
      return;
    }
  }
  FUN_1800051e0(param_1,param_2,param_3,param_4);
  return;
}



void thunk_FUN_1800052c0(undefined8 *param_1,uint param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_1800049b0(3,0x180040620,param_3,param_4);
  if (DAT_180049f30 != (LPVOID)0x0) {
    FUN_18001d45c(DAT_180049f30);
    DAT_180049f30 = (LPVOID)0x0;
  }
  DAT_180047d7c = 0x7fffffff;
  FUN_180004b30(param_1,param_2,param_3,param_4);
  FUN_1800049b0(3,0x180040630,(ulonglong)DAT_18004b156,(ulonglong)DAT_18004b154);
  return;
}



undefined2 *
thunk_FUN_180005360(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined4 uVar1;
  longlong lVar2;
  undefined2 *puVar3;
  LPVOID pvVar4;
  LPVOID pvVar5;
  LPVOID pvVar6;
  
  FUN_1800049b0(3,0x180040648,param_3,param_4);
  lVar2 = DAT_180049f30;
  DAT_180049f28 = 0;
  if (DAT_180047d7c != 7000) {
    return (undefined2 *)0x0;
  }
  *(undefined4 *)(DAT_180049f30 + 0x70) = 100;
  puVar3 = (undefined2 *)FUN_18001ed60(0x40);
  if (puVar3 != (undefined2 *)0x0) {
    pvVar4 = FUN_18001ee18(1,0x20);
    if (pvVar4 == (LPVOID)0x0) {
      FUN_1800049b0(1,0x180040668,param_3,param_4);
      puVar3 = (undefined2 *)0x0;
    }
    else {
      pvVar5 = FUN_18001ee18(1,0x3c);
      if (pvVar5 == (LPVOID)0x0) {
        FUN_1800049b0(1,0x180040678,param_3,param_4);
        puVar3 = (undefined2 *)0x0;
      }
      else {
        *puVar3 = 0x4452;
        uVar1 = *(undefined4 *)(lVar2 + 0x70);
        *(undefined8 *)(puVar3 + 4) = 0;
        *(undefined4 *)(puVar3 + 8) = 0;
        *(undefined4 *)(puVar3 + 0x10) = 100;
        *(undefined4 *)(puVar3 + 2) = uVar1;
        pvVar6 = FUN_18000bfc0();
        *(LPVOID *)(puVar3 + 0x1c) = pvVar5;
        *(LPVOID *)(puVar3 + 0x18) = pvVar4;
        *(LPVOID *)(puVar3 + 0xc) = pvVar6;
        *(undefined4 *)(puVar3 + 0x12) = 0xd;
        *(undefined4 *)(puVar3 + 0x14) = 0x9c;
        DAT_18004b140 = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x18) = 0xffffffff;
        **(undefined1 **)(puVar3 + 0x1c) = 1;
        DAT_180047d7c = 0x1b59;
        *(undefined1 *)(*(longlong *)(puVar3 + 0x1c) + 1) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x1c) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x20) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x24) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x28) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x2c) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x30) = 0;
        FUN_1800049b0(3,0x180040688,param_3,param_4);
      }
    }
    return puVar3;
  }
  FUN_1800049b0(1,0x180040658,param_3,param_4);
  return (undefined2 *)0x0;
}



undefined8
thunk_FUN_180005510(char *param_1,undefined4 param_2,ulonglong param_3,undefined8 param_4)

{
  longlong lVar1;
  undefined1 uVar2;
  ulonglong uVar4;
  ulonglong uVar5;
  uint uVar3;
  
  uVar4 = param_3 & 0xffffffff;
  uVar5 = param_3;
  FUN_1800049b0(3,0x180040698,param_3,param_4);
  lVar1 = DAT_180049f30;
  if (param_1 == (char *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_180047d7c == 0x1b59) {
    if ((*param_1 != 'R') || (param_1[1] != 'D')) {
      return 0xfffffc0e;
    }
    uVar2 = (undefined1)uVar4;
    uVar3 = (uint)param_3;
    switch(param_2) {
    case 0x4b0:
      *(uint *)(param_1 + 0xc) = uVar3;
      if (uVar3 == 2) {
        *(undefined4 *)(lVar1 + 0x6c) = 0;
        uVar3 = DAT_18004b15c;
        *(undefined4 *)(lVar1 + 0x8c) = 1;
        if ((uVar3 < 0x14) && ((0x84180U >> (uVar3 & 0x1f) & 1) != 0)) {
          *(undefined4 *)(lVar1 + 100) = 1;
          *(undefined4 *)(lVar1 + 0x70) = 0x1e;
          param_1[4] = '\x1e';
          param_1[5] = '\0';
          param_1[6] = '\0';
          param_1[7] = '\0';
          param_1[0x24] = '\x12';
          param_1[0x25] = '\0';
          param_1[0x26] = '\0';
          param_1[0x27] = '\0';
          param_1[0x28] = -100;
          param_1[0x29] = '\0';
          param_1[0x2a] = '\0';
          param_1[0x2b] = '\0';
        }
        else if (uVar3 == 0x12) {
          *(undefined4 *)(lVar1 + 0x70) = 0xd;
          param_1[4] = '\r';
          param_1[5] = '\0';
          param_1[6] = '\0';
          param_1[7] = '\0';
          param_1[0x24] = '\b';
          param_1[0x25] = '\0';
          param_1[0x26] = '\0';
          param_1[0x27] = '\0';
          param_1[0x28] = -0x38;
          param_1[0x29] = '\0';
          param_1[0x2a] = '\0';
          param_1[0x2b] = '\0';
        }
        else if ((uVar3 == 9) || (uVar3 == 0x15)) {
          *(undefined4 *)(lVar1 + 0x70) = 0xf;
          param_1[4] = '\x0f';
          param_1[5] = '\0';
          param_1[6] = '\0';
          param_1[7] = '\0';
          param_1[0x24] = '\x11';
          param_1[0x25] = '\0';
          param_1[0x26] = '\0';
          param_1[0x27] = '\0';
          param_1[0x28] = -100;
          param_1[0x29] = '\0';
          param_1[0x2a] = '\0';
          param_1[0x2b] = '\0';
        }
        else {
          *(undefined4 *)(lVar1 + 0x70) = 0xc;
          param_1[4] = '\f';
          param_1[5] = '\0';
          param_1[6] = '\0';
          param_1[7] = '\0';
          param_1[0x24] = '\r';
          param_1[0x25] = '\0';
          param_1[0x26] = '\0';
          param_1[0x27] = '\0';
          param_1[0x28] = -100;
          param_1[0x29] = '\0';
          param_1[0x2a] = '\0';
          param_1[0x2b] = '\0';
        }
      }
      else if (uVar3 == 3) {
        *(undefined4 *)(lVar1 + 0x8c) = 2;
        *(undefined4 *)(lVar1 + 0x90) = 1;
        *(undefined4 *)(lVar1 + 0x6c) = 0;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0xc) = 1;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x10) = 1;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x14) = 8;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x18) = 5;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x1c) = 0;
      }
      else if (uVar3 == 4) {
        *(undefined4 *)(lVar1 + 0x8c) = 2;
        *(undefined4 *)(lVar1 + 0x90) = 1;
        *(undefined4 *)(lVar1 + 0x6c) = 0;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0xc) = 0;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x10) = 0;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x14) = 8;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x18) = 100;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x1c) = 0;
      }
      else {
        *(undefined8 *)(lVar1 + 0x8c) = 0;
      }
      break;
    default:
      return 0xfffff89f;
    case 0x4bc:
    case 0x4bd:
    case 0x4bf:
      *(uint *)(DAT_180049f30 + 0x70) = uVar3;
      *(uint *)(param_1 + 4) = uVar3;
      break;
    case 0x4be:
      if (*(int *)(param_1 + 0xc) - 2U < 3) {
        return 0xfffff89f;
      }
      *(uint *)(DAT_180049f30 + 0x6c) = uVar3;
      break;
    case 0x4cd:
      *(uint *)(param_1 + 0x20) = uVar3;
      break;
    case 0x4ce:
      *(uint *)(DAT_180049f30 + 0x74) = uVar3;
      break;
    case 0x4cf:
      *(uint *)(DAT_180049f30 + 0x7c) = uVar3;
      break;
    case 0x4d0:
      *(uint *)(DAT_180049f30 + 0x80) = uVar3;
      break;
    case 0x4d1:
      DAT_18004b140 = uVar2;
      break;
    case 0x4d2:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0xc) = uVar3;
      FUN_1800049b0(3,0x1800406a8,uVar4,param_4);
      if (*(int *)(param_1 + 0xc) == 3) {
        if (0x7fffffff < uVar3) {
          return 0xfffff89f;
        }
      }
      else if ((*(int *)(param_1 + 0xc) != 4) && (uVar3 != 0)) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0xc) = uVar3;
      uVar5 = uVar4;
      break;
    case 0x4d3:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x10) = uVar3;
      FUN_1800049b0(3,0x1800406b8,uVar4,param_4);
      if (*(int *)(param_1 + 0xc) == 3) {
        if (0x7fffffff < uVar3) {
          return 0xfffff89f;
        }
      }
      else if ((*(int *)(param_1 + 0xc) != 4) && (uVar3 != 0)) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x10) = uVar3;
      uVar5 = uVar4;
      break;
    case 0x4d4:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x14) = uVar3;
      FUN_1800049b0(3,0x1800406c8,uVar4,param_4);
      uVar5 = uVar4;
      break;
    case 0x4d5:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x18) = uVar3;
      FUN_1800049b0(3,0x1800406d8,uVar4,param_4);
      uVar5 = uVar4;
      break;
    case 0x4d6:
      if (1 < uVar3) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 4) = uVar3;
      FUN_1800049b0(3,0x1800406e8,uVar4,param_4);
      uVar5 = uVar4;
      break;
    case 0x4d7:
      **(undefined1 **)(param_1 + 0x30) = uVar2;
      break;
    case 0x4d8:
      *(undefined1 *)(*(longlong *)(param_1 + 0x30) + 1) = uVar2;
      break;
    case 0x4d9:
      *(undefined1 *)(*(longlong *)(param_1 + 0x30) + 2) = uVar2;
      break;
    case 0x4da:
      if (1 < uVar3) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x1c) = uVar3;
    }
    FUN_1800049b0(3,0x1800406f8,uVar5,param_4);
    return 0;
  }
  return 0xfffffc02;
}



undefined4
thunk_FUN_180005b10(undefined8 *param_1,int param_2,ulonglong param_3,uint **param_4,uint *param_5)

{
  uint uVar1;
  longlong *plVar2;
  undefined8 uVar3;
  int *piVar4;
  char *pcVar5;
  longlong lVar6;
  int iVar7;
  longlong lVar8;
  ulonglong uVar9;
  int *piVar10;
  uint **ppuVar11;
  uint *puVar12;
  uint *puStackX_8;
  
  puStackX_8 = (uint *)0x0;
  ppuVar11 = param_4;
  FUN_1800049b0(3,0x180040738,param_3,param_4);
  if (((param_1 == (undefined8 *)0x0) || (param_4 == (uint **)0x0)) || (param_5 == (uint *)0x0)) {
    return 0xfffffc11;
  }
  if (DAT_180047d7c != 0x1b59) {
    return 0xfffffc02;
  }
  if ((*(char *)param_4 != 'R') || (*(char *)((longlong)param_4 + 1) != 'D')) {
    return 0xfffffc0e;
  }
  if (*(int *)((longlong)param_4 + 4) == 0) {
    return 0xfffffffd;
  }
  uVar1 = (uint)param_3;
  plVar2 = (longlong *)FUN_1800076f0(param_2,uVar1);
  if (plVar2 == (longlong *)0x0) {
    return 0xfffffc18;
  }
  uVar9 = (ulonglong)(int)(param_2 * uVar1);
  FUN_18001d560((undefined8 *)*plVar2,param_1,uVar9);
  if (DAT_180049f30 == (int *)0x0) {
    iVar7 = -0x3ea;
    puVar12 = (uint *)0x0;
  }
  else {
    ppuVar11 = &puStackX_8;
    uVar9 = param_3 & 0xffffffff;
    uVar3 = FUN_180016260(plVar2,param_2,uVar1,ppuVar11,DAT_180049f30);
    iVar7 = (int)uVar3;
    puVar12 = puStackX_8;
  }
  FUN_18001d45c(plVar2);
  if (iVar7 != 0) {
    FUN_1800049b0(1,0x180040748,uVar9,ppuVar11);
    return 0xfffffc05;
  }
  piVar10 = (int *)(ulonglong)*puVar12;
  FUN_1800049b0(3,0x180040758,piVar10,ppuVar11);
  uVar1 = DAT_18004b0c4;
  if ((int)*puVar12 < 0xb) {
    FUN_1800049b0(3,0x180040768,piVar10,ppuVar11);
    *param_5 = DAT_180049f28;
    FUN_18001d45c(*(LPVOID *)(puVar12 + 4));
    FUN_18001d45c(puVar12);
    return 0xffffffff;
  }
  if (*(int *)(param_4 + 2) != 0) {
    lVar6 = (longlong)(int)DAT_18004b0c4;
    piVar10 = (int *)(ulonglong)DAT_18004b0c4;
    FUN_1800049b0(3,0x180040780,piVar10,ppuVar11);
    lVar8 = 0;
    if (0 < (int)uVar1) {
      do {
        if ((uint *)(&DAT_18004b0d0)[(longlong)(int)(&DAT_180048220)[lVar8] * 3] == (uint *)0x0) {
          FUN_1800049b0(1,0x180040790,piVar10,ppuVar11);
        }
        else {
          uVar1 = FUN_1800067c0((int *)puVar12,
                                (uint *)(&DAT_18004b0d0)[(longlong)(int)(&DAT_180048220)[lVar8] * 3]
                                ,(undefined4 *)&puStackX_8,ppuVar11);
          piVar10 = (int *)(ulonglong)uVar1;
          FUN_1800049b0(3,0x1800407a0,piVar10,ppuVar11);
          if (DAT_180049f30[0x15] <= (int)uVar1) {
            FUN_1800049b0(3,0x1800407b0,(ulonglong)uVar1,(ulonglong)(uint)DAT_180049f30[0x15]);
            FUN_18001d45c(*(LPVOID *)(puVar12 + 4));
            FUN_18001d45c(puVar12);
            return 0xfffffc14;
          }
        }
        lVar8 = lVar8 + 1;
      } while (lVar8 < lVar6);
    }
  }
  piVar4 = FUN_18000d500(puVar12,(longlong)param_4[3]);
  FUN_18001d45c(*(LPVOID *)(puVar12 + 4));
  FUN_18001d45c(puVar12);
  iVar7 = (int)piVar4;
  if (*(int *)((longlong)param_4 + 0xc) == 0) {
    if (iVar7 == 3) {
      FUN_1800049b0(3,0x1800407c0,(ulonglong)*(uint *)(param_4 + 4),ppuVar11);
      piVar10 = DAT_180049f30;
      *param_5 = ((DAT_180049f30[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                 DAT_180049f30[0x1c];
      if (*(int *)(param_4 + 4) != 1) {
        return 0xfffffff8;
      }
      *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      if (0 < *(int *)((longlong)param_4 + 4)) {
        return 4;
      }
    }
    else {
      FUN_1800049b0(3,0x1800407d8,piVar10,ppuVar11);
      *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      piVar10 = DAT_180049f30;
    }
    if (*(int *)((longlong)param_4 + 4) != 0) {
      uVar9 = (longlong)((piVar10[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
              (longlong)piVar10[0x1c];
      pcVar5 = "991212==>%d";
      *param_5 = (uint)uVar9;
      piVar10 = (int *)(uVar9 & 0xffffffff);
LAB_180005ef8:
      FUN_1800049b0(3,(longlong)pcVar5,piVar10,ppuVar11);
      return 1;
    }
    pcVar5 = "991211==>done";
  }
  else {
    if (*(int *)((longlong)param_4 + 0xc) != 2) {
      FUN_1800049b0(3,0x1800408a8,piVar10,ppuVar11);
      return 0xfffffffd;
    }
    if (*(longlong *)(param_4[3] + 0x1e) == 0) {
      if (iVar7 == 3) {
        piVar10 = (int *)(ulonglong)*(uint *)(param_4 + 4);
        FUN_1800049b0(3,0x180040860,piVar10,ppuVar11);
        *param_5 = 0;
        if (*(int *)(param_4 + 4) != 1) {
          return 0xfffffff8;
        }
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        if (0 < *(int *)((longlong)param_4 + 4)) {
          return 4;
        }
      }
      else {
        FUN_1800049b0(3,0x180040878,piVar10,ppuVar11);
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      }
      if (*(int *)((longlong)param_4 + 4) != 0) {
        uVar9 = (longlong)((DAT_180049f30[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                (longlong)DAT_180049f30[0x1c];
        pcVar5 = "991221==>%d";
        DAT_180049f28 = (uint)uVar9;
        *param_5 = DAT_180049f28;
        piVar10 = (int *)(uVar9 & 0xffffffff);
        goto LAB_180005ef8;
      }
      pcVar5 = "991220==>done";
    }
    else {
      if (iVar7 == 3) {
        piVar10 = (int *)(ulonglong)*(uint *)(param_4 + 4);
        pcVar5 = "991213==>redundant %d";
        FUN_1800049b0(3,0x180040808,piVar10,ppuVar11);
        *param_5 = DAT_180049f28;
        if (*(int *)(param_4 + 4) != 1) {
          return 0xfffffff8;
        }
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        iVar7 = *(int *)((longlong)param_4 + 4);
        if (0 < iVar7) {
          return 4;
        }
      }
      else {
        pcVar5 = "991214==>accept";
        FUN_1800049b0(3,0x180040820,piVar10,ppuVar11);
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        iVar7 = *(int *)((longlong)param_4 + 4);
      }
      if (iVar7 == 0) {
        pcVar5 = "991215==>done";
      }
      else {
        uVar1 = FUN_180005980((longlong)param_4,pcVar5,piVar10,ppuVar11);
        if ((int)DAT_180049f28 < (int)uVar1) {
          if ((int)(uVar1 - DAT_180049f28) < 0x1a) {
            *param_5 = uVar1;
            DAT_180049f28 = uVar1;
          }
          else {
            *param_5 = DAT_180049f28 + 0x19;
            DAT_180049f28 = DAT_180049f28 + 0x19;
          }
        }
        else {
          *param_5 = DAT_180049f28 + 3;
          DAT_180049f28 = DAT_180049f28 + 3;
        }
        piVar10 = (int *)(ulonglong)*param_5;
        if (((int)*param_5 < 100) && (*(int *)((longlong)param_4 + 4) != 0)) {
          pcVar5 = "991217==>%d";
          goto LAB_180005ef8;
        }
        pcVar5 = "991216==>done";
      }
    }
  }
  FUN_1800049b0(3,(longlong)pcVar5,piVar10,ppuVar11);
  *param_5 = 100;
  DAT_180047d7c = 0x1b5a;
  return 2;
}



uint thunk_FUN_180006010(undefined8 *param_1,undefined8 *param_2,ulonglong param_3,ulonglong param_4
                        ,int *param_5)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  ulonglong uVar5;
  int **ppiVar6;
  int iVar7;
  int *piStackX_8;
  int *apiStack_28 [2];
  
  apiStack_28[0] = (int *)0x0;
  piStackX_8 = (int *)0x0;
  if (param_5 == (int *)0x0) {
    iVar7 = *(int *)((longlong)DAT_180049f30 + 0x54);
  }
  else {
    iVar7 = *param_5;
  }
  FUN_1800049b0(3,0x1800408b8,param_3,param_4);
  if ((((param_1 == (undefined8 *)0x0) || (param_2 == (undefined8 *)0x0)) ||
      (0x3c000 < (int)param_3)) || (0x3c000 < (int)param_4)) {
    ppiVar6 = (int **)(param_4 & 0xffffffff);
    FUN_1800049b0(1,0x1800408c8,param_3 & 0xffffffff,ppiVar6);
    uVar2 = 0xfffffc11;
  }
  else {
    ppiVar6 = &param_5;
    uVar2 = FUN_1800072b0(apiStack_28,param_1,param_3 & 0xffffffff,(byte *)ppiVar6);
    piVar1 = apiStack_28[0];
    if (uVar2 == 0) {
      ppiVar6 = &param_5;
      uVar5 = param_4 & 0xffffffff;
      uVar2 = FUN_1800072b0(&piStackX_8,param_2,uVar5,(byte *)ppiVar6);
      piVar4 = piStackX_8;
      if (uVar2 == 0) {
        ppiVar6 = DAT_180049f30;
        iVar3 = FUN_18000e0c0(piStackX_8,piVar1,uVar5,(longlong)DAT_180049f30);
        uVar2 = 0x68;
        if (iVar7 <= iVar3) {
          uVar2 = 0x65;
        }
      }
      else {
        FUN_1800049b0(1,0x1800408f0,(ulonglong)uVar2,ppiVar6);
        piVar4 = piStackX_8;
      }
    }
    else {
      FUN_1800049b0(1,0x1800408d8,(ulonglong)uVar2,ppiVar6);
      piVar4 = (int *)0x0;
    }
    if (piVar1 != (int *)0x0) {
      FUN_18000ea30(piVar1);
    }
    if (piVar4 != (int *)0x0) {
      FUN_18000ea30(piVar4);
    }
  }
  FUN_1800049b0(3,0x180040908,(ulonglong)uVar2,ppiVar6);
  return uVar2;
}



undefined8
thunk_FUN_180006270(char *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  char *pcVar2;
  
  DAT_180049f28 = 0;
  FUN_1800049b0(3,0x180040938,param_3,param_4);
  if (param_1 == (char *)0x0) {
    return 0xfffffc11;
  }
  if (1 < DAT_180047d7c - 0x1b59U) {
    return 0xfffffc02;
  }
  if ((*param_1 == 'R') && (param_1[1] == 'D')) {
    if (DAT_180049f40 != (LPVOID)0x0) {
      FUN_18001d45c(DAT_180049f40);
      DAT_180049f40 = (LPVOID)0x0;
    }
    DAT_180047d7c = 7000;
    if (*(int *)(param_1 + 8) == 0) {
      FUN_1800049b0(3,0x180040948,param_3,param_4);
      if (*(int **)(*(longlong *)(param_1 + 0x18) + 0x78) != (int *)0x0) {
        FUN_18000ea30(*(int **)(*(longlong *)(param_1 + 0x18) + 0x78));
      }
      if (*(longlong *)(*(longlong *)(param_1 + 0x18) + 0x80) != 0) {
        FUN_1800049b0(3,0x180040958,param_3,param_4);
        if (*(LPVOID *)(*(longlong *)(param_1 + 0x18) + 0x80) != (LPVOID)0x0) {
          FUN_18001d45c(*(LPVOID *)(*(longlong *)(param_1 + 0x18) + 0x80));
        }
        *(undefined8 *)(*(longlong *)(param_1 + 0x18) + 0x80) = 0;
      }
      FUN_18000c250(*(longlong *)(param_1 + 0x18));
      FUN_18000c500(*(LPVOID *)(param_1 + 0x18));
    }
    if (*(int *)(param_1 + 0x10) != 0) {
      pcVar2 = "991703==>";
      uVar1 = 3;
      FUN_1800049b0(3,0x180040958,param_3,param_4);
      FUN_180006190(uVar1,pcVar2,param_3,param_4);
      param_1[0x10] = '\0';
      param_1[0x11] = '\0';
      param_1[0x12] = '\0';
      param_1[0x13] = '\0';
    }
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x30));
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x38));
    FUN_18001d45c(param_1);
    FUN_1800049b0(3,0x180040968,param_3,param_4);
    return 0;
  }
  return 0xfffffc0e;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 thunk_FUN_1800065e0(longlong *param_1,undefined8 param_2,ulonglong param_3,byte *param_4)

{
  uint uVar1;
  undefined8 uVar2;
  char *pcVar3;
  ulonglong uVar4;
  undefined8 *puVar5;
  int iVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  
  pcVar3 = "991801==>";
  uVar2 = 3;
  FUN_1800049b0(3,0x180040978,param_3,param_4);
  if (param_1 == (longlong *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_180047d7c == 7000) {
    if (5 < (int)param_1[2]) {
      return 0xfffffc00;
    }
    FUN_180006190(uVar2,pcVar3,param_3,param_4);
    if (DAT_18004b0c0 != (int)param_1[2]) {
      DAT_180048230 = 4;
      _DAT_180048220 = 0x100000000;
      uRam0000000180048228 = 0x300000002;
      DAT_18004b0c0 = (int)param_1[2];
    }
    uVar4 = 0;
    if (0 < (int)param_1[2]) {
      puVar5 = &DAT_18004b0d0;
      uVar8 = uVar4;
      uVar9 = uVar4;
      do {
        iVar6 = (int)uVar4;
        if ((*(undefined8 **)(uVar9 + *param_1) == (undefined8 *)0x0) ||
           (param_3 = (ulonglong)*(uint *)(uVar8 + param_1[1]),
           0x3c000 < *(uint *)(uVar8 + param_1[1]))) {
          param_4 = (byte *)(ulonglong)*(uint *)(param_1[1] + uVar8);
          FUN_1800049b0(1,0x180040988,uVar4,param_4);
          param_3 = uVar4;
        }
        else {
          param_4 = &DAT_18004b0d8 + (longlong)iVar6 * 0x18;
          uVar1 = FUN_1800072b0((undefined8 *)(&DAT_18004b0c0 + ((longlong)iVar6 * 3 + 2) * 2),
                                *(undefined8 **)(uVar9 + *param_1),param_3,param_4);
          if (uVar1 == 0xfffffc0f) {
            pcVar3 = "991803==>Fail %d";
            uVar7 = 0xfffffc0f;
            uVar2 = 1;
            FUN_1800049b0(1,0x180040998,0xfffffc0f,param_4);
            FUN_180006190(uVar2,pcVar3,uVar7,param_4);
            DAT_180047d7c = 7000;
            FUN_1800049b0(3,0x1800409c0,0xfffffc0f,param_4);
            return 0xfffffc0f;
          }
          if ((uVar1 != 0) && ((int *)*puVar5 != (int *)0x0)) {
            FUN_18000ea30((int *)*puVar5);
            *puVar5 = 0;
          }
        }
        uVar4 = (ulonglong)(iVar6 + 1U);
        uVar9 = uVar9 + 8;
        puVar5 = puVar5 + 3;
        uVar8 = uVar8 + 4;
      } while ((int)(iVar6 + 1U) < (int)param_1[2]);
    }
    DAT_18004b0c4 = (undefined4)param_1[2];
    DAT_180047d7c = 0x1b5b;
    FUN_1800049b0(3,0x1800409b0,param_3,param_4);
    return 0;
  }
  return 0xfffffc02;
}



ulonglong thunk_FUN_180006a50(undefined8 *param_1,undefined8 param_2,undefined8 param_3,
                             ulonglong param_4)

{
  longlong lVar1;
  bool bVar2;
  longlong lVar3;
  int *piVar4;
  IMAGE_DOS_HEADER *pIVar5;
  uint uVar6;
  uint uVar7;
  int *piVar8;
  longlong lVar9;
  ulonglong uVar10;
  longlong lVar11;
  uint uVar12;
  IMAGE_DOS_HEADER *pIVar13;
  IMAGE_DOS_HEADER *pIVar14;
  ulonglong uVar15;
  IMAGE_DOS_HEADER *pIVar16;
  IMAGE_DOS_HEADER *pIVar17;
  int iVar18;
  uint uStackX_8;
  uint auStackX_18 [2];
  int iStackX_20;
  uint uStack_64;
  IMAGE_DOS_HEADER *pIStack_60;
  undefined8 *apuStack_58 [3];
  
  pIVar14 = (IMAGE_DOS_HEADER *)0x0;
  pIVar17 = (IMAGE_DOS_HEADER *)0x0;
  uStack_64 = 0;
  bVar2 = false;
  pIVar16 = (IMAGE_DOS_HEADER *)0x0;
  auStackX_18[0] = 0;
  pIStack_60 = (IMAGE_DOS_HEADER *)0x0;
  apuStack_58[0] = (undefined8 *)0x0;
  FUN_1800049b0(3,0x180040a70,param_3,param_4);
  if (param_1 == (undefined8 *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_180047d7c != 0x1b5b) {
    return 0xfffffc02;
  }
  uStackX_8 = 0xffffffff;
  uVar15 = 0x68;
  if ((undefined8 *)*param_1 == (undefined8 *)0x0) {
    FUN_1800049b0(1,0x180040a80,param_3,param_4);
    uVar6 = 0xffffffff;
    uVar15 = 0xfffffc05;
    pIVar16 = pIVar14;
    pIVar17 = pIVar14;
    uVar12 = 0xffffffff;
  }
  else {
    uVar12 = 0xffffffff;
    if (*(uint *)((longlong)param_1 + 0x2c) + 1 < 6) {
      pIVar13 = (IMAGE_DOS_HEADER *)(ulonglong)*(uint *)(param_1 + 1);
      iStackX_20 = DAT_18004b0c4;
      uVar6 = FUN_1800074a0(&pIStack_60,(undefined8 *)*param_1,(ulonglong)pIVar13,param_4);
      pIVar16 = pIStack_60;
      if (uVar6 == 0) {
        piVar8 = DAT_180049f38;
        if ((DAT_180049f26 != '\0') &&
           (piVar8 = FUN_18000e7b0((int *)pIStack_60), DAT_180049f38 != (int *)0x0)) {
          FUN_18000e360(DAT_180049f38,(int *)pIVar16,(int *)auStackX_18);
          pIVar13 = (IMAGE_DOS_HEADER *)(ulonglong)auStackX_18[0];
          FUN_1800049b0(3,0x180040ab8,pIVar13,param_4);
          piVar4 = DAT_180049f38;
          if (DAT_180049f38 != (int *)0x0) {
            FUN_18001d45c(*(LPVOID *)(DAT_180049f38 + 4));
            FUN_18001d45c(piVar4);
          }
        }
        DAT_180049f38 = piVar8;
        lVar9 = (longlong)iStackX_20;
        lVar11 = 0;
        pIVar5 = pIVar14;
        uVar12 = 0xffffffff;
        if (0 < lVar9) {
          do {
            pIVar17 = pIVar5;
            auStackX_18[0] = 0;
            uVar12 = (&DAT_180048220)[lVar11];
            lVar1 = (longlong)(int)uVar12 * 0x18;
            pIStack_60 = (IMAGE_DOS_HEADER *)(&DAT_18004b0d0)[(longlong)(int)uVar12 * 3];
            iVar18 = (int)pIVar14;
            if (pIStack_60 == (IMAGE_DOS_HEADER *)0x0) {
              uVar10 = 1;
              FUN_1800049b0(1,0x180040ac8,pIVar13,param_4);
              pIVar14 = pIVar13;
            }
            else {
              uVar7 = *(uint *)((longlong)param_1 + 0x2c);
              param_4 = (ulonglong)uVar7;
              if ((uVar7 == 0xffffffff) || (uVar7 == uVar12)) {
                if ((&DAT_18004b0d8)[lVar1] == '\0') {
                  FUN_1800130c0(DAT_18004b15c);
                }
                else {
                  FUN_1800130c0(DAT_18004b15c + 0x80);
                  DAT_18004b158 = *(undefined2 *)(DAT_180049f30 + 0x84);
                }
                pIVar14 = (IMAGE_DOS_HEADER *)auStackX_18;
                uVar7 = FUN_1800067c0((int *)pIVar16,(uint *)pIStack_60,(undefined4 *)pIVar14,
                                      param_4);
                lVar3 = DAT_180049f30;
                if (auStackX_18[0] != 0) {
                  bVar2 = true;
                }
                if (*(int *)(DAT_180049f30 + 0x54) <= (int)uVar7) {
                  pIVar14 = &IMAGE_DOS_HEADER_180000000;
                  uStackX_8 = uVar12;
                  if ((&DAT_18004b0d8)[lVar1] == '\0') {
                    (&DAT_18004b0d8)[lVar1] = 0;
                  }
                  else {
                    (&DAT_18004b0d8)[lVar1] = (&DAT_18004b0d8)[lVar1] + -1;
                  }
                }
                uVar12 = *(int *)(lVar3 + 0x54) * 3;
                uVar10 = (ulonglong)uVar12;
                if ((int)pIVar17 < (int)uVar7) {
                  pIVar17 = (IMAGE_DOS_HEADER *)(ulonglong)uVar7;
                }
                if ((int)uVar12 <= (int)uVar7) break;
              }
              else {
                uVar10 = 3;
                FUN_1800049b0(3,0x180040ad8,pIVar14,param_4);
              }
            }
            lVar11 = lVar11 + 1;
            pIVar13 = pIVar14;
            pIVar5 = pIVar17;
            pIVar14 = (IMAGE_DOS_HEADER *)(ulonglong)(iVar18 + 1);
          } while (lVar11 < lVar9);
          uVar15 = 0x68;
          uVar12 = uStackX_8;
          if (uStackX_8 != 0xffffffff) {
            uVar15 = 0;
            FUN_180005130(uVar10,iStackX_20,(ulonglong)uStackX_8,param_4);
          }
        }
      }
      else {
        FUN_1800049b0(1,0x180040aa0,(ulonglong)uVar6,param_4);
        pIVar16 = pIStack_60;
      }
    }
    else {
      FUN_1800049b0(1,0x180040a90,(ulonglong)*(uint *)((longlong)param_1 + 0x2c),param_4);
      uVar6 = 0xffffffff;
      uVar15 = 0xfffffbfb;
    }
  }
  *(uint *)(param_1 + 4) = uVar12;
  *(uint *)((longlong)param_1 + 0x24) = (uint)bVar2;
  *(int *)((longlong)param_1 + 0x1c) = (int)pIVar17;
  FUN_1800049b0(3,0x180040ae8,(ulonglong)uVar12,pIVar17);
  if (pIVar16 != (IMAGE_DOS_HEADER *)0x0) {
    FUN_18001d45c(*(LPVOID *)&pIVar16->e_sp);
    FUN_18001d45c(pIVar16);
  }
  if ((bVar2) && (uVar12 != 0xffffffff)) {
    pIVar17 = (IMAGE_DOS_HEADER *)(&DAT_18004b0d8 + (longlong)(int)uVar12 * 0x18);
    uVar10 = FUN_1800075e0((int *)(&DAT_18004b0d0)[(longlong)(int)uVar12 * 3],
                           (longlong *)apuStack_58,&uStack_64,(byte *)pIVar17);
    uVar12 = uStack_64;
    if ((int)uVar10 != 0) {
      FUN_1800049b0(1,0x180040af8,uVar10 & 0xffffffff,pIVar17);
      if (apuStack_58[0] != (undefined8 *)0x0) {
        FUN_18001d45c(apuStack_58[0]);
      }
      *(undefined4 *)((longlong)param_1 + 0x24) = 0;
      *(undefined4 *)(param_1 + 4) = 0xffffffff;
      param_1[3] = 0;
      FUN_1800049b0(3,0x180040b30,uVar15,pIVar17);
      return uVar15;
    }
    uVar10 = (ulonglong)(int)uStack_64;
    FUN_1800049b0(3,0x180040b10,(ulonglong)uStack_64,pIVar17);
    FUN_18001d560((undefined8 *)param_1[2],apuStack_58[0],uVar10);
    *(uint *)(param_1 + 3) = uVar12;
    FUN_18001d45c(apuStack_58[0]);
    uVar6 = 0;
  }
  FUN_1800049b0(3,0x180040b20,uVar15,pIVar17);
  if (uVar6 != 0) {
    uVar15 = (ulonglong)uVar6;
  }
  return uVar15;
}



undefined8
FUN_180004390(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  char *pcVar2;
  
  pcVar2 = "992101==>";
  uVar1 = 3;
  FUN_1800049b0(3,0x180040b40,param_3,param_4);
  if (DAT_180047d7c != 0x1b5b) {
    return 0xfffffc02;
  }
  FUN_180006190(uVar1,pcVar2,param_3,param_4);
  DAT_180047d7c = 7000;
  FUN_1800049b0(3,0x180040b50,param_3,param_4);
  return 0;
}



LPVOID thunk_FUN_180006ed0(char *param_1,uint *param_2,ulonglong param_3,undefined *param_4)

{
  int *piVar1;
  ulonglong uVar2;
  uint *puVar3;
  
  FUN_1800049b0(3,0x180040b60,param_3,param_4);
  if (DAT_180049f40 != (LPVOID)0x0) {
    return DAT_180049f40;
  }
  if ((((param_1 != (char *)0x0) && (param_2 != (uint *)0x0)) && (DAT_180047d7c == 0x1b5a)) &&
     ((*param_1 == 'R' && (param_1[1] == 'D')))) {
    if (*(longlong *)(*(longlong *)(param_1 + 0x18) + 0x80) != 0) {
      FUN_1800049b0(3,0x180040b70,param_3,param_4);
      if (*(LPVOID *)(*(longlong *)(param_1 + 0x18) + 0x80) != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)(*(longlong *)(param_1 + 0x18) + 0x80));
      }
      *(undefined8 *)(*(longlong *)(param_1 + 0x18) + 0x80) = 0;
    }
    piVar1 = FUN_18000c570(*(LPVOID *)(param_1 + 0x18));
    if (piVar1 == (int *)0x0) {
      FUN_1800049b0(1,0x180040b80,param_3,param_4);
    }
    else {
      param_4 = &DAT_18004b140;
      puVar3 = param_2;
      uVar2 = FUN_1800075e0(piVar1,(longlong *)&DAT_180049f40,param_2,&DAT_18004b140);
      if ((int)uVar2 == 0) {
        FUN_18000ea30(piVar1);
        param_1[8] = '\x01';
        param_1[9] = '\0';
        param_1[10] = '\0';
        param_1[0xb] = '\0';
        FUN_1800049b0(3,0x180040ba8,puVar3,param_4);
        return DAT_180049f40;
      }
      param_3 = uVar2 & 0xffffffff;
      FUN_1800049b0(1,0x180040b90,param_3,param_4);
    }
    if (DAT_180049f40 != (LPVOID)0x0) {
      FUN_18001d45c(DAT_180049f40);
      DAT_180049f40 = (LPVOID)0x0;
    }
    if (piVar1 != (int *)0x0) {
      FUN_18000ea30(piVar1);
    }
    *param_2 = 0;
    FUN_1800049b0(3,0x180040bb8,param_3,param_4);
    return (LPVOID)0x0;
  }
  return (LPVOID)0x0;
}



undefined8
thunk_FUN_180007060(undefined8 *param_1,int param_2,ulonglong param_3,uint **param_4,uint *param_5,
                   longlong param_6)

{
  uint uVar1;
  int iVar2;
  longlong *plVar3;
  undefined8 uVar4;
  undefined8 *puVar5;
  uint *puVar6;
  ulonglong uVar7;
  undefined8 uVar8;
  uint **ppuVar9;
  uint *puStackX_8;
  
  puStackX_8 = (uint *)0x0;
  ppuVar9 = param_4;
  FUN_1800049b0(3,0x180040bc8,param_3,param_4);
  if ((((param_1 == (undefined8 *)0x0) || (param_4 == (uint **)0x0)) || (param_5 == (uint *)0x0)) ||
     (param_6 == 0)) {
    uVar4 = 0xfffffc11;
  }
  else {
    uVar1 = (uint)param_3;
    plVar3 = (longlong *)FUN_1800076f0(param_2,uVar1);
    if (plVar3 == (longlong *)0x0) {
      uVar4 = 0xfffffc18;
    }
    else {
      uVar7 = (ulonglong)(int)(param_2 * uVar1);
      FUN_18001d560((undefined8 *)*plVar3,param_1,uVar7);
      if (DAT_180049f30 == (int *)0x0) {
        iVar2 = -0x3ea;
        puVar6 = (uint *)0x0;
      }
      else {
        ppuVar9 = &puStackX_8;
        uVar7 = param_3 & 0xffffffff;
        uVar4 = FUN_180016260(plVar3,param_2,uVar1,ppuVar9,DAT_180049f30);
        iVar2 = (int)uVar4;
        puVar6 = puStackX_8;
      }
      FUN_18001d45c(plVar3);
      if (iVar2 == 0) {
        if (puVar6 != (uint *)0x0) {
          uVar1 = FUN_18000eab0(puVar6);
          puVar5 = (undefined8 *)FUN_18001ed60((longlong)(int)(uVar1 + 8));
          if ((puVar5 != (undefined8 *)0x0) &&
             (iVar2 = FUN_18000ec70(puVar6,(undefined2 *)puVar5), -1 < iVar2)) {
            FUN_18001d45c(*(LPVOID *)(puVar6 + 4));
            FUN_18001d45c(puVar6);
            if ((int)*param_5 < (int)uVar1) {
              FUN_1800049b0(1,0x180040bf8,uVar7,ppuVar9);
              *param_5 = 0;
              FUN_18001d45c(puVar5);
              return 0xfffffbfc;
            }
            *param_5 = uVar1;
            if (uVar1 - 1 < 0xa000) {
              uVar8 = 0;
              uVar4 = FUN_180004ec0(puVar5,param_5,0,ppuVar9);
              if ((int)uVar4 != 0) {
                FUN_1800049b0(1,0x180040c18,uVar8,ppuVar9);
                FUN_18001d45c(puVar5);
                *param_5 = 0;
                return 0xfffffc0f;
              }
              uVar7 = (ulonglong)(int)*param_5;
              FUN_18001d560(param_4,puVar5,uVar7);
              FUN_18001d45c(puVar5);
              FUN_1800049b0(3,0x180040c28,uVar7,ppuVar9);
              return 0;
            }
            FUN_1800049b0(3,0x180040c08,uVar7,ppuVar9);
            *param_5 = 0;
            FUN_18001d45c(puVar5);
            return 0xfffffc10;
          }
        }
        FUN_1800049b0(1,0x180040be8,uVar7,ppuVar9);
        *param_5 = 0;
        uVar4 = 0xfffffc0e;
      }
      else {
        FUN_1800049b0(1,0x180040bd8,uVar7,ppuVar9);
        uVar4 = 0xfffffc05;
      }
    }
  }
  return uVar4;
}



int FUN_180004410(undefined8 *param_1,uint param_2,int param_3,int *param_4,int *param_5,int param_6
                 )

{
  uint uVar1;
  int iVar2;
  undefined8 *puVar3;
  undefined *puVar4;
  undefined *puVar5;
  
  uVar1 = DAT_180047794;
  if (param_6 == 5) {
    puVar4 = &DAT_180047d80;
    puVar5 = &DAT_1800481e0;
  }
  else if ((param_6 - 7U & 0xfffffffd) == 0) {
    puVar4 = &DAT_180047b60;
    puVar5 = &DAT_1800481a0;
  }
  else if (param_6 == 0x13) {
    puVar4 = &DAT_180047fc0;
    puVar5 = &DAT_180047d40;
  }
  else if (param_6 == 0x15) {
    puVar4 = &DAT_1800477a0;
    puVar5 = &DAT_180047758;
  }
  else {
    puVar4 = (undefined *)0x0;
    puVar5 = puVar4;
  }
  puVar3 = (undefined8 *)FUN_18001ed60((longlong)(int)(DAT_180047794 * DAT_180047754));
  if (puVar3 == (undefined8 *)0x0) {
    iVar2 = -0x3f1;
  }
  else {
    FUN_18001d560(puVar3,param_1,(longlong)(int)(param_2 * param_3));
    FUN_180004540((longlong)puVar3,param_2,param_3,DAT_180047754,uVar1);
    iVar2 = FUN_180008c40(puVar3,param_2,param_3,param_4,param_5,puVar4,puVar5);
    FUN_18001d45c(puVar3);
  }
  return iVar2;
}



void FUN_180004540(longlong param_1,uint param_2,int param_3,int param_4,uint param_5)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  longlong lVar4;
  longlong lVar5;
  uint uVar6;
  ulonglong uVar7;
  longlong lVar8;
  int iVar9;
  byte *pbVar10;
  byte *pbVar11;
  int *piVar12;
  longlong lVar13;
  ulonglong uVar14;
  undefined1 *puVar15;
  int iVar16;
  uint uVar17;
  longlong lVar18;
  int iVar19;
  int iVar20;
  int iVar21;
  int *piVar22;
  ulonglong uVar23;
  undefined1 in_XMM2 [16];
  undefined1 auVar24 [16];
  undefined1 auVar25 [16];
  undefined1 auVar26 [16];
  undefined1 auVar27 [16];
  undefined1 auStack_b8 [32];
  longlong local_98;
  int local_90;
  ulonglong local_88;
  int local_80;
  uint local_7c;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined8 local_60;
  int local_58 [4];
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStack_b8;
  uVar23 = (ulonglong)param_5;
  uVar14 = (ulonglong)(int)param_2;
  local_7c = param_5;
  uVar7 = uVar23 * param_2 & 0xffffffff;
  if ((int)(uVar23 * param_2 >> 0x20) != 0) {
    uVar7 = 0xffffffffffffffff;
  }
  local_98 = param_1;
  local_80 = param_4;
  local_68 = (undefined1 *)FUN_18001ed60(uVar7);
  if (local_68 != (undefined1 *)0x0) {
    local_90 = 0;
    uVar7 = (longlong)(param_3 << 10) / (longlong)(int)param_5;
    iVar1 = (int)uVar7;
    uVar3 = uVar14;
    local_70 = local_68;
    uVar17 = param_2;
    if (0 < (int)param_5) {
      do {
        local_88 = uVar23;
        iVar16 = 0;
        iVar2 = (int)(local_90 + (local_90 >> 0x1f & 0x3ffU)) >> 10;
        iVar9 = (iVar2 + 1) * 0x400 - local_90;
        local_58[0] = 0;
        local_58[1] = 0;
        local_58[2] = 0;
        local_58[3] = 0;
        if (0 < iVar1) {
          uVar23 = uVar7 & 0xffffffff;
          piVar22 = local_58;
          do {
            iVar19 = (int)uVar23;
            iVar21 = iVar9;
            if (iVar19 < iVar9) {
              iVar21 = iVar19;
            }
            iVar16 = iVar16 + 1;
            uVar23 = (ulonglong)(uint)(iVar19 - iVar21);
            *piVar22 = iVar21;
            iVar9 = 0x400;
            piVar22 = piVar22 + 1;
          } while (0 < iVar19 - iVar21);
        }
        lVar13 = (longlong)iVar16;
        if (0 < (longlong)uVar14) {
          puVar15 = local_70;
          uVar23 = uVar14;
          do {
            iVar9 = 0;
            iVar16 = 0;
            lVar18 = 0;
            pbVar11 = puVar15 + (((int)uVar3 * iVar2 + param_1) - (longlong)local_70);
            if (1 < lVar13) {
              do {
                piVar22 = local_58 + lVar18;
                pbVar10 = pbVar11 + uVar14;
                lVar18 = lVar18 + 2;
                iVar9 = iVar9 + *piVar22 * (uint)*pbVar11;
                pbVar11 = pbVar10 + uVar14;
                iVar16 = iVar16 + *(int *)((longlong)&local_60 + lVar18 * 4 + 4) * (uint)*pbVar10;
              } while (lVar18 < lVar13 + -1);
            }
            iVar21 = iVar1 / 2;
            if (lVar18 < lVar13) {
              iVar21 = local_58[lVar18] * (uint)*pbVar11 + iVar1 / 2;
            }
            *puVar15 = (char)((iVar16 + iVar9 + iVar21) / iVar1);
            uVar23 = uVar23 - 1;
            puVar15 = puVar15 + 1;
          } while (uVar23 != 0);
          uVar3 = (ulonglong)param_2;
          param_1 = local_98;
        }
        uVar17 = (uint)uVar3;
        local_70 = local_70 + uVar14;
        local_90 = local_90 + iVar1;
        uVar23 = local_88 - 1;
      } while (local_88 - 1 != 0);
      uVar23 = (ulonglong)local_7c;
      local_88 = 0;
      param_4 = local_80;
    }
    uVar7 = (longlong)(int)(uVar17 << 10) / (longlong)param_4;
    lVar13 = (longlong)param_4;
    iVar1 = (int)uVar7;
    iVar2 = iVar1 / 2;
    puVar15 = local_68;
    if (0 < (int)uVar23) {
      do {
        iVar9 = DAT_180046320;
        iVar16 = 0;
        lVar18 = 0;
        if (0 < lVar13) {
          do {
            uVar17 = 0;
            iVar21 = (int)(iVar16 + (iVar16 >> 0x1f & 0x3ffU)) >> 10;
            local_58[0] = 0;
            local_58[1] = 0;
            local_58[2] = 0;
            local_58[3] = 0;
            piVar22 = (int *)(puVar15 + iVar21);
            iVar21 = (iVar21 + 1) * 0x400 - iVar16;
            if (0 < iVar1) {
              uVar3 = uVar7 & 0xffffffff;
              piVar12 = local_58;
              do {
                iVar20 = (int)uVar3;
                iVar19 = iVar21;
                if (iVar20 < iVar21) {
                  iVar19 = iVar20;
                }
                uVar17 = uVar17 + 1;
                uVar3 = (ulonglong)(uint)(iVar20 - iVar19);
                *piVar12 = iVar19;
                iVar21 = 0x400;
                piVar12 = piVar12 + 1;
              } while (0 < iVar20 - iVar19);
            }
            lVar4 = 0;
            lVar8 = lVar4;
            iVar21 = iVar2;
            if (((0 < (int)uVar17) && (7 < uVar17)) && (1 < iVar9)) {
              iVar19 = 0;
              if (((int *)((longlong)piVar22 + (longlong)(int)(uVar17 - 1)) < local_58) ||
                 (lVar8 = 0, local_58 + (int)(uVar17 - 1) < piVar22)) {
                uVar6 = uVar17 & 0x80000007;
                if ((int)uVar6 < 0) {
                  uVar6 = (uVar6 - 1 | 0xfffffff8) + 1;
                }
                auVar27 = ZEXT816(0);
                auVar26 = ZEXT816(0);
                do {
                  lVar8 = (longlong)iVar19;
                  lVar4 = lVar4 + 8;
                  iVar21 = iVar19 + 4;
                  iVar19 = iVar19 + 8;
                  auVar24 = pmovzxbd(in_XMM2,ZEXT416(*(uint *)((longlong)piVar22 + lVar8)));
                  auVar24 = pmulld(auVar24,*(undefined1 (*) [16])(local_58 + lVar8));
                  auVar25._0_4_ = auVar24._0_4_ + auVar26._0_4_;
                  auVar25._4_4_ = auVar24._4_4_ + auVar26._4_4_;
                  auVar25._8_4_ = auVar24._8_4_ + auVar26._8_4_;
                  auVar25._12_4_ = auVar24._12_4_ + auVar26._12_4_;
                  auVar26 = pmovzxbd(auVar25,ZEXT416(*(uint *)((longlong)piVar22 + (longlong)iVar21)
                                                    ));
                  auVar26 = pmulld(auVar26,*(undefined1 (*) [16])(local_58 + iVar21));
                  in_XMM2._0_4_ = auVar26._0_4_ + auVar27._0_4_;
                  in_XMM2._4_4_ = auVar26._4_4_ + auVar27._4_4_;
                  in_XMM2._8_4_ = auVar26._8_4_ + auVar27._8_4_;
                  in_XMM2._12_4_ = auVar26._12_4_ + auVar27._12_4_;
                  auVar27 = in_XMM2;
                  auVar26 = auVar25;
                } while (iVar19 < (int)(uVar17 - uVar6));
                iVar21 = in_XMM2._0_4_ + auVar25._0_4_ + in_XMM2._8_4_ + auVar25._8_4_ +
                         in_XMM2._4_4_ + auVar25._4_4_ + in_XMM2._12_4_ + auVar25._12_4_ + iVar2;
                lVar8 = lVar4;
              }
            }
            lVar4 = (longlong)(int)uVar17;
            iVar19 = 0;
            iVar20 = 0;
            if (lVar8 < lVar4) {
              if (1 < lVar4 - lVar8) {
                lVar5 = lVar8;
                do {
                  lVar8 = lVar5 + 2;
                  iVar19 = iVar19 + (uint)*(byte *)((longlong)piVar22 + lVar5) *
                                    *(int *)((longlong)&local_60 + lVar8 * 4);
                  iVar20 = iVar20 + (uint)*(byte *)((longlong)piVar22 + lVar5 + 1) *
                                    *(int *)((longlong)&local_60 + lVar8 * 4 + 4);
                  lVar5 = lVar8;
                } while (lVar8 < lVar4 + -1);
              }
              if (lVar8 < lVar4) {
                iVar21 = iVar21 + (uint)*(byte *)((longlong)piVar22 + lVar8) * local_58[lVar8];
              }
              iVar21 = iVar21 + iVar20 + iVar19;
            }
            lVar8 = lVar18 + 1;
            iVar16 = iVar16 + iVar1;
            *(char *)(lVar18 + local_98) = (char)(iVar21 / iVar1);
            lVar18 = lVar8;
          } while (lVar8 < lVar13);
        }
        local_98 = local_98 + lVar13;
        uVar23 = uVar23 - 1;
        puVar15 = puVar15 + uVar14;
        local_88 = uVar23;
      } while (uVar23 != 0);
    }
    local_60 = uVar14;
    FUN_18001d45c(local_68);
  }
  FUN_18001d530(local_48 ^ (ulonglong)auStack_b8);
  return;
}



void FUN_1800049b0(undefined8 param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res18;
  undefined8 local_res20;
  undefined1 auStack_448 [32];
  undefined8 local_428;
  char local_418 [1024];
  ulonglong local_18;
  
  if (param_2 != 0) {
    local_18 = DAT_1800461a0 ^ (ulonglong)auStack_448;
    local_428 = 0;
    local_res18 = param_3;
    local_res20 = param_4;
    FUN_18001e094(local_418,0x400,param_2,&local_res18);
    FUN_18001e970(local_418,0x400,"\r\n");
    OutputDebugStringA(local_418);
    FUN_18001d530(local_18 ^ (ulonglong)auStack_448);
  }
  return;
}



undefined8 FUN_180004a40(char *param_1,byte param_2,undefined8 param_3,undefined8 param_4)

{
  ulonglong uVar1;
  
  uVar1 = (ulonglong)param_2;
  FUN_1800049b0(3,0x1800404b8,uVar1,param_4);
  if (param_1 == (char *)0x0) {
    return 0xfffffbfc;
  }
  if (((*param_1 == 'E') && (param_1[1] == '\x01')) && (*(ushort *)(param_1 + 2) - 1 < 0x28)) {
    param_1[0xc] = param_2;
    FUN_1800049b0(3,0x1800404c8,uVar1,param_4);
    return 0;
  }
  return 0xfffffc0e;
}



undefined8 FUN_180004ad0(longlong param_1,byte *param_2,undefined8 param_3,undefined8 param_4)

{
  byte bVar1;
  
  FUN_1800049b0(3,0x1800404d8,param_3,param_4);
  if (param_1 == 0) {
    return 0xfffffbfc;
  }
  bVar1 = *(byte *)(param_1 + 0xc);
  *param_2 = bVar1;
  FUN_1800049b0(3,0x1800404e8,(ulonglong)bVar1,param_4);
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180004b30(undefined8 *param_1,uint param_2,undefined8 param_3,undefined8 param_4)

{
  undefined1 *puVar1;
  longlong *plVar2;
  longlong lVar3;
  ulonglong uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined1 auStackY_388 [32];
  undefined8 in_stack_fffffffffffffc98;
  undefined4 uStack_34c;
  undefined4 uStack_348;
  undefined4 uStack_344;
  undefined4 uStack_340;
  longlong local_338 [60];
  byte local_158 [16];
  undefined8 local_148;
  undefined8 uStack_140;
  undefined1 local_118 [240];
  ulonglong local_28;
  
  local_28 = DAT_1800461a0 ^ (ulonglong)auStackY_388;
  uVar4 = (ulonglong)(int)param_2;
  FUN_1800049b0(3,0x1800404f8,param_3,param_4);
  FUN_18001dbc0((undefined1 (*) [16])local_158,0,uVar4);
  uStack_34c = (undefined4)_DAT_180048220;
  uStack_348 = (undefined4)((ulonglong)_DAT_180048220 >> 0x20);
  uStack_344 = (undefined4)uRam0000000180048228;
  uStack_340 = (undefined4)((ulonglong)uRam0000000180048228 >> 0x20);
  uVar5 = 0;
  local_158._2_2_ = DAT_18004b150;
  local_158._0_2_ = 0x4541;
  local_158._4_2_ = DAT_18004b152;
  local_158._6_2_ = DAT_18004b154;
  local_158._10_2_ = DAT_18004b158;
  local_158._8_2_ = DAT_18004b156;
  local_158._12_4_ = uStack_34c;
  local_148 = CONCAT44(uStack_344,uStack_348);
  uStack_140 = CONCAT44(DAT_180048230,uStack_340);
  FUN_18001dbc0((undefined1 (*) [16])local_118,0,0xf0);
  plVar2 = local_338;
  puVar1 = local_118;
  lVar3 = 0x34;
  do {
    *plVar2 = (longlong)puVar1;
    puVar1 = puVar1 + 4;
    plVar2 = plVar2 + 1;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  uVar6 = 0;
  FUN_180009050(0x1800351a8,local_338,(uint)CONCAT71((int7)((ulonglong)uVar5 >> 8),0x18),0);
  if ((uVar4 & 0xf) != 0) {
    param_2 = param_2 & 0xfffffff0;
  }
  FUN_180009290(local_158,local_338,param_2,uVar6,in_stack_fffffffffffffc98,0xc);
  FUN_18001d560(param_1,(undefined8 *)local_158,uVar4);
  FUN_1800049b0(3,0x180040508,uVar4,uVar6);
  FUN_18001d530(local_28 ^ (ulonglong)auStackY_388);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180004cc0(undefined8 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong *plVar1;
  undefined1 *puVar2;
  longlong lVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined1 auStackY_358 [32];
  undefined8 in_stack_fffffffffffffcc8;
  longlong local_328 [60];
  undefined8 local_148;
  undefined2 uStack_140;
  short sStack_13e;
  undefined4 uStack_13c;
  undefined4 local_138;
  undefined4 uStack_134;
  undefined4 uStack_130;
  undefined4 uStack_12c;
  undefined8 local_128;
  undefined8 uStack_120;
  undefined8 local_118;
  undefined8 uStack_110;
  undefined1 local_108 [240];
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStackY_358;
  FUN_1800049b0(3,0x180040518,param_3,param_4);
  local_148 = *param_1;
  uVar5 = param_1[1];
  uVar4 = 0;
  uStack_140 = (undefined2)uVar5;
  sStack_13e = (short)((ulonglong)uVar5 >> 0x10);
  uStack_13c = (undefined4)((ulonglong)uVar5 >> 0x20);
  local_128 = param_1[4];
  uStack_120 = param_1[5];
  local_138 = (undefined4)param_1[2];
  uStack_134 = (undefined4)((ulonglong)param_1[2] >> 0x20);
  uStack_130 = (undefined4)param_1[3];
  uStack_12c = (undefined4)((ulonglong)param_1[3] >> 0x20);
  local_118 = param_1[6];
  uStack_110 = param_1[7];
  FUN_18001dbc0((undefined1 (*) [16])local_108,0,0xf0);
  plVar1 = local_328;
  puVar2 = local_108;
  lVar3 = 0x34;
  do {
    *plVar1 = (longlong)puVar2;
    puVar2 = puVar2 + 4;
    plVar1 = plVar1 + 1;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  uVar6 = 1;
  FUN_180009050(0x1800351a8,local_328,(uint)CONCAT71((int7)((ulonglong)uVar4 >> 8),0x18),1);
  uVar5 = 0x40;
  FUN_1800095c0((byte *)&local_148,local_328,0x40,uVar6,in_stack_fffffffffffffcc8,0xc);
  if (((byte)local_148 == 0x41) && (local_148._1_1_ == 'E')) {
    _DAT_180048220 = CONCAT44(local_138,uStack_13c);
    uRam0000000180048228 = CONCAT44(uStack_130,uStack_134);
    DAT_18004b150 = local_148._2_2_;
    DAT_18004b152 = local_148._4_2_;
    _DAT_18004b154 = CONCAT22(uStack_140,local_148._6_2_);
    DAT_18004b158 = sStack_13e;
    DAT_180048230 = uStack_12c;
    FUN_1800049b0(3,0x180040528,uVar5,uVar6);
    if (DAT_18004b158 == 0) {
      DAT_18004b158 = *(short *)(DAT_180049f30 + 0x84);
    }
    if (DAT_18004b150 == 0) {
      DAT_18004b150 = *(short *)(DAT_180049f30 + 0x54);
    }
    FUN_1800049b0(3,0x180040538,uVar5,uVar6);
  }
  else {
    DAT_18004b150 = *(short *)(DAT_180049f30 + 0x54);
    _DAT_18004b154 = 0;
    DAT_18004b158 = *(short *)(DAT_180049f30 + 0x84);
  }
  FUN_18001d530(local_18 ^ (ulonglong)auStackY_358);
  return;
}



undefined8 FUN_180004ec0(undefined8 *param_1,uint *param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  undefined *puVar4;
  ulonglong uVar5;
  undefined1 uVar6;
  undefined7 uVar7;
  
  uVar6 = (undefined1)param_4;
  uVar7 = (undefined7)((ulonglong)param_4 >> 8);
  FUN_1800049b0(3,0x180040548,param_3,param_4);
  if ((param_1 != (undefined8 *)0x0) && (param_2 != (uint *)0x0)) {
    uVar1 = *param_2;
    if ((int)uVar1 < 1) {
      uVar2 = 0xfffffc10;
    }
    else {
      puVar3 = (undefined8 *)FUN_18001ed60((longlong)(int)(uVar1 + 5));
      if (puVar3 == (undefined8 *)0x0) {
        FUN_1800049b0(1,0x180040558,(ulonglong)uVar1,CONCAT71(uVar7,uVar6));
        uVar2 = 0xfffffc0f;
      }
      else {
        FUN_18001d560((undefined8 *)((longlong)puVar3 + 5),param_1,(longlong)(int)uVar1);
        *(undefined1 *)((longlong)puVar3 + 4) = 0x45;
        *param_2 = *param_2 + 1;
        puVar4 = &DAT_1800351e0;
        uVar6 = 0x20;
        if ((int)param_3 != 0) {
          puVar4 = &DAT_1800351c0;
        }
        FUN_180009900((byte *)((longlong)puVar3 + 4),(longlong)puVar4,*param_2,CONCAT71(uVar7,0x20))
        ;
        *(undefined1 *)puVar3 = 0x44;
        *(undefined1 *)((longlong)puVar3 + 1) = *(undefined1 *)((longlong)param_2 + 2);
        *(char *)((longlong)puVar3 + 2) = (char)(*param_2 >> 8);
        *(char *)((longlong)puVar3 + 3) = (char)*param_2;
        *param_2 = *param_2 + 4;
        FUN_1800049b0(3,0x180040570,(ulonglong)*param_2,CONCAT71(uVar7,uVar6));
        uVar5 = (ulonglong)(int)*param_2;
        FUN_18001d560(param_1,puVar3,uVar5);
        FUN_18001d45c(puVar3);
        FUN_1800049b0(3,0x180040580,uVar5,CONCAT71(uVar7,uVar6));
        uVar2 = 0;
      }
    }
    return uVar2;
  }
  return 0xfffffc11;
}



undefined8 FUN_180005010(char *param_1,int *param_2,int param_3,undefined8 param_4)

{
  undefined8 uVar1;
  uint uVar2;
  ulonglong uVar3;
  undefined1 uVar4;
  undefined7 uVar5;
  undefined *puVar6;
  
  uVar5 = (undefined7)((ulonglong)param_4 >> 8);
  puVar6 = &DAT_1800351e0;
  if (param_3 != 0) {
    puVar6 = &DAT_1800351c0;
  }
  if (param_2 == (int *)0x0) {
    return 0xfffffc11;
  }
  if (0x3c004 < *param_2 - 1U) {
    return 0xfffffc10;
  }
  if ((*param_1 != 'D') && (*param_1 != 'E')) {
    return 0xfffffc0e;
  }
  uVar2 = (uint)CONCAT21(CONCAT11(param_1[1],param_1[2]),param_1[3]);
  if (uVar2 + 4 != *param_2) {
    return 0xfffffc0e;
  }
  uVar4 = 0x20;
  FUN_1800099e0((byte *)(param_1 + 4),(longlong)puVar6,uVar2,0x20);
  if (param_1[4] == 'E') {
    uVar3 = (ulonglong)(int)(uVar2 - 1);
    FUN_18001d560((undefined8 *)param_1,(undefined8 *)(param_1 + 5),uVar3);
    *param_2 = uVar2 - 1;
    FUN_1800049b0(3,0x1800405a0,uVar3,CONCAT71(uVar5,uVar4));
    uVar1 = 0;
  }
  else {
    uVar1 = 0xfffffc0e;
  }
  return uVar1;
}



void FUN_180005130(undefined8 param_1,int param_2,ulonglong param_3,ulonglong param_4)

{
  ulonglong uVar1;
  int iVar2;
  undefined1 auStack_48 [32];
  int local_28 [6];
  ulonglong local_10;
  
  local_10 = DAT_1800461a0 ^ (ulonglong)auStack_48;
  uVar1 = param_3;
  FUN_1800049b0(3,0x1800405b0,param_3,param_4);
  iVar2 = (int)param_3;
  if (iVar2 <= param_2) {
    if (iVar2 != DAT_180048220) {
      uVar1 = 0;
      param_4 = uVar1;
      if (0 < param_2) {
        do {
          if ((&DAT_180048220)[uVar1] == iVar2) break;
          local_28[uVar1] = (&DAT_180048220)[uVar1];
          uVar1 = uVar1 + 1;
          param_4 = (ulonglong)((int)param_4 + 1);
        } while ((longlong)uVar1 < (longlong)param_2);
      }
      uVar1 = (longlong)(int)param_4 << 2;
      FUN_18001d560((undefined8 *)&DAT_180048224,(undefined8 *)local_28,uVar1);
      DAT_180048220 = iVar2;
    }
    FUN_1800049b0(3,0x1800405c0,uVar1,param_4);
  }
  FUN_18001d530(local_10 ^ (ulonglong)auStack_48);
  return;
}



undefined8
FUN_1800051e0(undefined8 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  char *pcVar1;
  undefined8 uVar2;
  
  uVar2 = param_3;
  FUN_1800049b0(2,0x1800405f0,param_3,param_4);
  if (DAT_180047d7c != 0x7fffffff) {
    return 0xfffffc02;
  }
  if (DAT_180049f30 == 0) {
    DAT_180049f30 = FUN_18000e4e0();
  }
  DAT_180047d7c = 7000;
  FUN_1800049b0(3,0x1800405d0,uVar2,param_4);
  DAT_18004b15c = (int)param_3;
  FUN_1800130c0(DAT_18004b15c);
  pcVar1 = "9906FF==>";
  FUN_1800049b0(3,0x1800405e0,uVar2,param_4);
  FUN_180004cc0(param_1,pcVar1,uVar2,param_4);
  FUN_1800049b0(3,0x180040608,(ulonglong)DAT_18004b156,(ulonglong)DAT_18004b154);
  return 0;
}



void FUN_1800052c0(undefined8 *param_1,uint param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_1800049b0(3,0x180040620,param_3,param_4);
  if (DAT_180049f30 != (LPVOID)0x0) {
    FUN_18001d45c(DAT_180049f30);
    DAT_180049f30 = (LPVOID)0x0;
  }
  DAT_180047d7c = 0x7fffffff;
  FUN_180004b30(param_1,param_2,param_3,param_4);
  FUN_1800049b0(3,0x180040630,(ulonglong)DAT_18004b156,(ulonglong)DAT_18004b154);
  return;
}



undefined2 *
FUN_180005360(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined4 uVar1;
  longlong lVar2;
  undefined2 *puVar3;
  LPVOID pvVar4;
  LPVOID pvVar5;
  LPVOID pvVar6;
  
  FUN_1800049b0(3,0x180040648,param_3,param_4);
  lVar2 = DAT_180049f30;
  DAT_180049f28 = 0;
  if (DAT_180047d7c != 7000) {
    return (undefined2 *)0x0;
  }
  *(undefined4 *)(DAT_180049f30 + 0x70) = 100;
  puVar3 = (undefined2 *)FUN_18001ed60(0x40);
  if (puVar3 != (undefined2 *)0x0) {
    pvVar4 = FUN_18001ee18(1,0x20);
    if (pvVar4 == (LPVOID)0x0) {
      FUN_1800049b0(1,0x180040668,param_3,param_4);
      puVar3 = (undefined2 *)0x0;
    }
    else {
      pvVar5 = FUN_18001ee18(1,0x3c);
      if (pvVar5 == (LPVOID)0x0) {
        FUN_1800049b0(1,0x180040678,param_3,param_4);
        puVar3 = (undefined2 *)0x0;
      }
      else {
        *puVar3 = 0x4452;
        uVar1 = *(undefined4 *)(lVar2 + 0x70);
        *(undefined8 *)(puVar3 + 4) = 0;
        *(undefined4 *)(puVar3 + 8) = 0;
        *(undefined4 *)(puVar3 + 0x10) = 100;
        *(undefined4 *)(puVar3 + 2) = uVar1;
        pvVar6 = FUN_18000bfc0();
        *(LPVOID *)(puVar3 + 0x1c) = pvVar5;
        *(LPVOID *)(puVar3 + 0x18) = pvVar4;
        *(LPVOID *)(puVar3 + 0xc) = pvVar6;
        *(undefined4 *)(puVar3 + 0x12) = 0xd;
        *(undefined4 *)(puVar3 + 0x14) = 0x9c;
        DAT_18004b140 = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x18) = 0xffffffff;
        **(undefined1 **)(puVar3 + 0x1c) = 1;
        DAT_180047d7c = 0x1b59;
        *(undefined1 *)(*(longlong *)(puVar3 + 0x1c) + 1) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x1c) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x20) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x24) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x28) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x2c) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x30) = 0;
        FUN_1800049b0(3,0x180040688,param_3,param_4);
      }
    }
    return puVar3;
  }
  FUN_1800049b0(1,0x180040658,param_3,param_4);
  return (undefined2 *)0x0;
}



undefined8 FUN_180005510(char *param_1,undefined4 param_2,ulonglong param_3,undefined8 param_4)

{
  longlong lVar1;
  undefined1 uVar2;
  ulonglong uVar4;
  ulonglong uVar5;
  uint uVar3;
  
  uVar4 = param_3 & 0xffffffff;
  uVar5 = param_3;
  FUN_1800049b0(3,0x180040698,param_3,param_4);
  lVar1 = DAT_180049f30;
  if (param_1 == (char *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_180047d7c == 0x1b59) {
    if ((*param_1 != 'R') || (param_1[1] != 'D')) {
      return 0xfffffc0e;
    }
    uVar2 = (undefined1)uVar4;
    uVar3 = (uint)param_3;
    switch(param_2) {
    case 0x4b0:
      *(uint *)(param_1 + 0xc) = uVar3;
      if (uVar3 == 2) {
        *(undefined4 *)(lVar1 + 0x6c) = 0;
        uVar3 = DAT_18004b15c;
        *(undefined4 *)(lVar1 + 0x8c) = 1;
        if ((uVar3 < 0x14) && ((0x84180U >> (uVar3 & 0x1f) & 1) != 0)) {
          *(undefined4 *)(lVar1 + 100) = 1;
          *(undefined4 *)(lVar1 + 0x70) = 0x1e;
          param_1[4] = '\x1e';
          param_1[5] = '\0';
          param_1[6] = '\0';
          param_1[7] = '\0';
          param_1[0x24] = '\x12';
          param_1[0x25] = '\0';
          param_1[0x26] = '\0';
          param_1[0x27] = '\0';
          param_1[0x28] = -100;
          param_1[0x29] = '\0';
          param_1[0x2a] = '\0';
          param_1[0x2b] = '\0';
        }
        else if (uVar3 == 0x12) {
          *(undefined4 *)(lVar1 + 0x70) = 0xd;
          param_1[4] = '\r';
          param_1[5] = '\0';
          param_1[6] = '\0';
          param_1[7] = '\0';
          param_1[0x24] = '\b';
          param_1[0x25] = '\0';
          param_1[0x26] = '\0';
          param_1[0x27] = '\0';
          param_1[0x28] = -0x38;
          param_1[0x29] = '\0';
          param_1[0x2a] = '\0';
          param_1[0x2b] = '\0';
        }
        else if ((uVar3 == 9) || (uVar3 == 0x15)) {
          *(undefined4 *)(lVar1 + 0x70) = 0xf;
          param_1[4] = '\x0f';
          param_1[5] = '\0';
          param_1[6] = '\0';
          param_1[7] = '\0';
          param_1[0x24] = '\x11';
          param_1[0x25] = '\0';
          param_1[0x26] = '\0';
          param_1[0x27] = '\0';
          param_1[0x28] = -100;
          param_1[0x29] = '\0';
          param_1[0x2a] = '\0';
          param_1[0x2b] = '\0';
        }
        else {
          *(undefined4 *)(lVar1 + 0x70) = 0xc;
          param_1[4] = '\f';
          param_1[5] = '\0';
          param_1[6] = '\0';
          param_1[7] = '\0';
          param_1[0x24] = '\r';
          param_1[0x25] = '\0';
          param_1[0x26] = '\0';
          param_1[0x27] = '\0';
          param_1[0x28] = -100;
          param_1[0x29] = '\0';
          param_1[0x2a] = '\0';
          param_1[0x2b] = '\0';
        }
      }
      else if (uVar3 == 3) {
        *(undefined4 *)(lVar1 + 0x8c) = 2;
        *(undefined4 *)(lVar1 + 0x90) = 1;
        *(undefined4 *)(lVar1 + 0x6c) = 0;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0xc) = 1;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x10) = 1;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x14) = 8;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x18) = 5;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x1c) = 0;
      }
      else if (uVar3 == 4) {
        *(undefined4 *)(lVar1 + 0x8c) = 2;
        *(undefined4 *)(lVar1 + 0x90) = 1;
        *(undefined4 *)(lVar1 + 0x6c) = 0;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0xc) = 0;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x10) = 0;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x14) = 8;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x18) = 100;
        *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x1c) = 0;
      }
      else {
        *(undefined8 *)(lVar1 + 0x8c) = 0;
      }
      break;
    default:
      return 0xfffff89f;
    case 0x4bc:
    case 0x4bd:
    case 0x4bf:
      *(uint *)(DAT_180049f30 + 0x70) = uVar3;
      *(uint *)(param_1 + 4) = uVar3;
      break;
    case 0x4be:
      if (*(int *)(param_1 + 0xc) - 2U < 3) {
        return 0xfffff89f;
      }
      *(uint *)(DAT_180049f30 + 0x6c) = uVar3;
      break;
    case 0x4cd:
      *(uint *)(param_1 + 0x20) = uVar3;
      break;
    case 0x4ce:
      *(uint *)(DAT_180049f30 + 0x74) = uVar3;
      break;
    case 0x4cf:
      *(uint *)(DAT_180049f30 + 0x7c) = uVar3;
      break;
    case 0x4d0:
      *(uint *)(DAT_180049f30 + 0x80) = uVar3;
      break;
    case 0x4d1:
      DAT_18004b140 = uVar2;
      break;
    case 0x4d2:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0xc) = uVar3;
      FUN_1800049b0(3,0x1800406a8,uVar4,param_4);
      if (*(int *)(param_1 + 0xc) == 3) {
        if (0x7fffffff < uVar3) {
          return 0xfffff89f;
        }
      }
      else if ((*(int *)(param_1 + 0xc) != 4) && (uVar3 != 0)) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0xc) = uVar3;
      uVar5 = uVar4;
      break;
    case 0x4d3:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x10) = uVar3;
      FUN_1800049b0(3,0x1800406b8,uVar4,param_4);
      if (*(int *)(param_1 + 0xc) == 3) {
        if (0x7fffffff < uVar3) {
          return 0xfffff89f;
        }
      }
      else if ((*(int *)(param_1 + 0xc) != 4) && (uVar3 != 0)) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x10) = uVar3;
      uVar5 = uVar4;
      break;
    case 0x4d4:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x14) = uVar3;
      FUN_1800049b0(3,0x1800406c8,uVar4,param_4);
      uVar5 = uVar4;
      break;
    case 0x4d5:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x18) = uVar3;
      FUN_1800049b0(3,0x1800406d8,uVar4,param_4);
      uVar5 = uVar4;
      break;
    case 0x4d6:
      if (1 < uVar3) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 4) = uVar3;
      FUN_1800049b0(3,0x1800406e8,uVar4,param_4);
      uVar5 = uVar4;
      break;
    case 0x4d7:
      **(undefined1 **)(param_1 + 0x30) = uVar2;
      break;
    case 0x4d8:
      *(undefined1 *)(*(longlong *)(param_1 + 0x30) + 1) = uVar2;
      break;
    case 0x4d9:
      *(undefined1 *)(*(longlong *)(param_1 + 0x30) + 2) = uVar2;
      break;
    case 0x4da:
      if (1 < uVar3) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x1c) = uVar3;
    }
    FUN_1800049b0(3,0x1800406f8,uVar5,param_4);
    return 0;
  }
  return 0xfffffc02;
}



uint FUN_180005980(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  int iVar1;
  int *piVar2;
  uint *puVar3;
  longlong lVar4;
  uint uVar5;
  ulonglong uVar6;
  uint uVar7;
  int iVar8;
  ulonglong uVar10;
  ulonglong uVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  ulonglong uVar15;
  ulonglong uVar9;
  
  uVar15 = 0;
  FUN_1800049b0(3,0x180040708,param_3,param_4);
  lVar4 = DAT_180049f30;
  piVar2 = *(int **)(*(longlong *)(param_1 + 0x18) + 0x78);
  uVar5 = 0;
  if (0 < *piVar2) {
    uVar6 = uVar15;
    uVar9 = uVar15;
    uVar10 = uVar15;
    uVar11 = uVar15;
    do {
      if ((int)uVar10 < (int)**(uint **)(uVar6 + *(longlong *)(piVar2 + 2))) {
        uVar10 = (ulonglong)**(uint **)(uVar6 + *(longlong *)(piVar2 + 2));
        uVar11 = uVar9;
      }
      uVar5 = (uint)uVar11;
      uVar7 = (int)uVar9 + 1;
      uVar9 = (ulonglong)uVar7;
      uVar6 = uVar6 + 8;
    } while ((int)uVar7 < *piVar2);
  }
  iVar12 = -0x400;
  puVar3 = *(uint **)(*(longlong *)(piVar2 + 2) + (longlong)(int)uVar5 * 8);
  iVar14 = 0x400;
  iVar8 = -0x400;
  uVar5 = *puVar3;
  iVar13 = 0x400;
  if (0 < (int)uVar5) {
    uVar6 = (ulonglong)uVar5;
    do {
      piVar2 = *(int **)(uVar15 + *(longlong *)(puVar3 + 6));
      uVar15 = uVar15 + 8;
      iVar1 = *piVar2;
      if (iVar1 < iVar14) {
        iVar14 = iVar1;
      }
      if (iVar12 < iVar1) {
        iVar12 = iVar1;
      }
      iVar1 = piVar2[1];
      if (iVar1 < iVar13) {
        iVar13 = iVar1;
      }
      if (iVar8 < iVar1) {
        iVar8 = iVar1;
      }
      uVar6 = uVar6 - 1;
    } while (uVar6 != 0);
  }
  if (*(int *)(DAT_180049f30 + 0x70) - *(int *)(param_1 + 4) == *(int *)(DAT_180049f30 + 0x6c) + 2)
  {
    *(int *)(*(longlong *)(param_1 + 0x18) + 0x18) = iVar8 - iVar13;
  }
  uVar5 = (((iVar8 - iVar13) - *(int *)(*(longlong *)(param_1 + 0x18) + 0x18)) * 10) /
          *(int *)(param_1 + 0x24);
  if (iVar12 - iVar14 < *(int *)(param_1 + 0x28)) {
    if ((int)uVar5 < 100) {
      uVar5 = (int)(uVar5 * 9) / 10;
    }
    else {
      uVar5 = 0x5a;
    }
  }
  uVar15 = (longlong)((*(int *)(lVar4 + 0x70) - *(int *)(param_1 + 4)) * 100) /
           (longlong)*(int *)(lVar4 + 0x70);
  uVar7 = (uint)uVar15;
  uVar15 = uVar15 & 0xffffffff;
  FUN_1800049b0(3,0x180040718,(ulonglong)uVar5,uVar15);
  if ((int)uVar7 < (int)uVar5) {
    uVar7 = uVar5;
  }
  if ((int)uVar7 < 0) {
    uVar7 = 0;
  }
  FUN_1800049b0(3,0x180040728,(ulonglong)uVar7,uVar15);
  return uVar7;
}



undefined4
FUN_180005b10(undefined8 *param_1,int param_2,ulonglong param_3,uint **param_4,uint *param_5)

{
  uint uVar1;
  longlong *plVar2;
  undefined8 uVar3;
  int *piVar4;
  char *pcVar5;
  longlong lVar6;
  int iVar7;
  longlong lVar8;
  ulonglong uVar9;
  int *piVar10;
  uint **ppuVar11;
  uint *puVar12;
  uint *local_res8;
  
  local_res8 = (uint *)0x0;
  ppuVar11 = param_4;
  FUN_1800049b0(3,0x180040738,param_3,param_4);
  if (((param_1 == (undefined8 *)0x0) || (param_4 == (uint **)0x0)) || (param_5 == (uint *)0x0)) {
    return 0xfffffc11;
  }
  if (DAT_180047d7c != 0x1b59) {
    return 0xfffffc02;
  }
  if ((*(char *)param_4 != 'R') || (*(char *)((longlong)param_4 + 1) != 'D')) {
    return 0xfffffc0e;
  }
  if (*(int *)((longlong)param_4 + 4) == 0) {
    return 0xfffffffd;
  }
  uVar1 = (uint)param_3;
  plVar2 = (longlong *)FUN_1800076f0(param_2,uVar1);
  if (plVar2 == (longlong *)0x0) {
    return 0xfffffc18;
  }
  uVar9 = (ulonglong)(int)(param_2 * uVar1);
  FUN_18001d560((undefined8 *)*plVar2,param_1,uVar9);
  if (DAT_180049f30 == (int *)0x0) {
    iVar7 = -0x3ea;
    puVar12 = (uint *)0x0;
  }
  else {
    ppuVar11 = &local_res8;
    uVar9 = param_3 & 0xffffffff;
    uVar3 = FUN_180016260(plVar2,param_2,uVar1,ppuVar11,DAT_180049f30);
    iVar7 = (int)uVar3;
    puVar12 = local_res8;
  }
  FUN_18001d45c(plVar2);
  if (iVar7 != 0) {
    FUN_1800049b0(1,0x180040748,uVar9,ppuVar11);
    return 0xfffffc05;
  }
  piVar10 = (int *)(ulonglong)*puVar12;
  FUN_1800049b0(3,0x180040758,piVar10,ppuVar11);
  uVar1 = DAT_18004b0c4;
  if ((int)*puVar12 < 0xb) {
    FUN_1800049b0(3,0x180040768,piVar10,ppuVar11);
    *param_5 = DAT_180049f28;
    FUN_18001d45c(*(LPVOID *)(puVar12 + 4));
    FUN_18001d45c(puVar12);
    return 0xffffffff;
  }
  if (*(int *)(param_4 + 2) != 0) {
    lVar6 = (longlong)(int)DAT_18004b0c4;
    piVar10 = (int *)(ulonglong)DAT_18004b0c4;
    FUN_1800049b0(3,0x180040780,piVar10,ppuVar11);
    lVar8 = 0;
    if (0 < (int)uVar1) {
      do {
        if ((uint *)(&DAT_18004b0d0)[(longlong)(int)(&DAT_180048220)[lVar8] * 3] == (uint *)0x0) {
          FUN_1800049b0(1,0x180040790,piVar10,ppuVar11);
        }
        else {
          uVar1 = FUN_1800067c0((int *)puVar12,
                                (uint *)(&DAT_18004b0d0)[(longlong)(int)(&DAT_180048220)[lVar8] * 3]
                                ,(undefined4 *)&local_res8,ppuVar11);
          piVar10 = (int *)(ulonglong)uVar1;
          FUN_1800049b0(3,0x1800407a0,piVar10,ppuVar11);
          if (DAT_180049f30[0x15] <= (int)uVar1) {
            FUN_1800049b0(3,0x1800407b0,(ulonglong)uVar1,(ulonglong)(uint)DAT_180049f30[0x15]);
            FUN_18001d45c(*(LPVOID *)(puVar12 + 4));
            FUN_18001d45c(puVar12);
            return 0xfffffc14;
          }
        }
        lVar8 = lVar8 + 1;
      } while (lVar8 < lVar6);
    }
  }
  piVar4 = FUN_18000d500(puVar12,(longlong)param_4[3]);
  FUN_18001d45c(*(LPVOID *)(puVar12 + 4));
  FUN_18001d45c(puVar12);
  iVar7 = (int)piVar4;
  if (*(int *)((longlong)param_4 + 0xc) == 0) {
    if (iVar7 == 3) {
      FUN_1800049b0(3,0x1800407c0,(ulonglong)*(uint *)(param_4 + 4),ppuVar11);
      piVar10 = DAT_180049f30;
      *param_5 = ((DAT_180049f30[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                 DAT_180049f30[0x1c];
      if (*(int *)(param_4 + 4) != 1) {
        return 0xfffffff8;
      }
      *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      if (0 < *(int *)((longlong)param_4 + 4)) {
        return 4;
      }
    }
    else {
      FUN_1800049b0(3,0x1800407d8,piVar10,ppuVar11);
      *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      piVar10 = DAT_180049f30;
    }
    if (*(int *)((longlong)param_4 + 4) != 0) {
      uVar9 = (longlong)((piVar10[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
              (longlong)piVar10[0x1c];
      pcVar5 = "991212==>%d";
      *param_5 = (uint)uVar9;
      piVar10 = (int *)(uVar9 & 0xffffffff);
LAB_180005ef8:
      FUN_1800049b0(3,(longlong)pcVar5,piVar10,ppuVar11);
      return 1;
    }
    pcVar5 = "991211==>done";
  }
  else {
    if (*(int *)((longlong)param_4 + 0xc) != 2) {
      FUN_1800049b0(3,0x1800408a8,piVar10,ppuVar11);
      return 0xfffffffd;
    }
    if (*(longlong *)(param_4[3] + 0x1e) == 0) {
      if (iVar7 == 3) {
        piVar10 = (int *)(ulonglong)*(uint *)(param_4 + 4);
        FUN_1800049b0(3,0x180040860,piVar10,ppuVar11);
        *param_5 = 0;
        if (*(int *)(param_4 + 4) != 1) {
          return 0xfffffff8;
        }
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        if (0 < *(int *)((longlong)param_4 + 4)) {
          return 4;
        }
      }
      else {
        FUN_1800049b0(3,0x180040878,piVar10,ppuVar11);
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      }
      if (*(int *)((longlong)param_4 + 4) != 0) {
        uVar9 = (longlong)((DAT_180049f30[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                (longlong)DAT_180049f30[0x1c];
        pcVar5 = "991221==>%d";
        DAT_180049f28 = (uint)uVar9;
        *param_5 = DAT_180049f28;
        piVar10 = (int *)(uVar9 & 0xffffffff);
        goto LAB_180005ef8;
      }
      pcVar5 = "991220==>done";
    }
    else {
      if (iVar7 == 3) {
        piVar10 = (int *)(ulonglong)*(uint *)(param_4 + 4);
        pcVar5 = "991213==>redundant %d";
        FUN_1800049b0(3,0x180040808,piVar10,ppuVar11);
        *param_5 = DAT_180049f28;
        if (*(int *)(param_4 + 4) != 1) {
          return 0xfffffff8;
        }
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        iVar7 = *(int *)((longlong)param_4 + 4);
        if (0 < iVar7) {
          return 4;
        }
      }
      else {
        pcVar5 = "991214==>accept";
        FUN_1800049b0(3,0x180040820,piVar10,ppuVar11);
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        iVar7 = *(int *)((longlong)param_4 + 4);
      }
      if (iVar7 == 0) {
        pcVar5 = "991215==>done";
      }
      else {
        uVar1 = FUN_180005980((longlong)param_4,pcVar5,piVar10,ppuVar11);
        if ((int)DAT_180049f28 < (int)uVar1) {
          if ((int)(uVar1 - DAT_180049f28) < 0x1a) {
            *param_5 = uVar1;
            DAT_180049f28 = uVar1;
          }
          else {
            *param_5 = DAT_180049f28 + 0x19;
            DAT_180049f28 = DAT_180049f28 + 0x19;
          }
        }
        else {
          *param_5 = DAT_180049f28 + 3;
          DAT_180049f28 = DAT_180049f28 + 3;
        }
        piVar10 = (int *)(ulonglong)*param_5;
        if (((int)*param_5 < 100) && (*(int *)((longlong)param_4 + 4) != 0)) {
          pcVar5 = "991217==>%d";
          goto LAB_180005ef8;
        }
        pcVar5 = "991216==>done";
      }
    }
  }
  FUN_1800049b0(3,(longlong)pcVar5,piVar10,ppuVar11);
  *param_5 = 100;
  DAT_180047d7c = 0x1b5a;
  return 2;
}



uint FUN_180006010(undefined8 *param_1,undefined8 *param_2,ulonglong param_3,ulonglong param_4,
                  int *param_5)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  ulonglong uVar5;
  int **ppiVar6;
  int iVar7;
  int *local_res8;
  int *local_28 [2];
  
  local_28[0] = (int *)0x0;
  local_res8 = (int *)0x0;
  if (param_5 == (int *)0x0) {
    iVar7 = *(int *)((longlong)DAT_180049f30 + 0x54);
  }
  else {
    iVar7 = *param_5;
  }
  FUN_1800049b0(3,0x1800408b8,param_3,param_4);
  if ((((param_1 == (undefined8 *)0x0) || (param_2 == (undefined8 *)0x0)) ||
      (0x3c000 < (int)param_3)) || (0x3c000 < (int)param_4)) {
    ppiVar6 = (int **)(param_4 & 0xffffffff);
    FUN_1800049b0(1,0x1800408c8,param_3 & 0xffffffff,ppiVar6);
    uVar2 = 0xfffffc11;
  }
  else {
    ppiVar6 = &param_5;
    uVar2 = FUN_1800072b0(local_28,param_1,param_3 & 0xffffffff,(byte *)ppiVar6);
    piVar1 = local_28[0];
    if (uVar2 == 0) {
      ppiVar6 = &param_5;
      uVar5 = param_4 & 0xffffffff;
      uVar2 = FUN_1800072b0(&local_res8,param_2,uVar5,(byte *)ppiVar6);
      piVar4 = local_res8;
      if (uVar2 == 0) {
        ppiVar6 = DAT_180049f30;
        iVar3 = FUN_18000e0c0(local_res8,piVar1,uVar5,(longlong)DAT_180049f30);
        uVar2 = 0x68;
        if (iVar7 <= iVar3) {
          uVar2 = 0x65;
        }
      }
      else {
        FUN_1800049b0(1,0x1800408f0,(ulonglong)uVar2,ppiVar6);
        piVar4 = local_res8;
      }
    }
    else {
      FUN_1800049b0(1,0x1800408d8,(ulonglong)uVar2,ppiVar6);
      piVar4 = (int *)0x0;
    }
    if (piVar1 != (int *)0x0) {
      FUN_18000ea30(piVar1);
    }
    if (piVar4 != (int *)0x0) {
      FUN_18000ea30(piVar4);
    }
  }
  FUN_1800049b0(3,0x180040908,(ulonglong)uVar2,ppiVar6);
  return uVar2;
}



void FUN_180006190(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  int *piVar1;
  LPVOID pvVar2;
  uint uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  undefined8 *puVar7;
  ulonglong uVar8;
  
  FUN_1800049b0(3,0x180040918,param_3,param_4);
  uVar6 = 0;
  if (0 < DAT_18004b0c4) {
    puVar7 = &DAT_18004b0d0;
    uVar8 = uVar6;
    do {
      piVar1 = (int *)*puVar7;
      if (piVar1 != (int *)0x0) {
        uVar4 = uVar6;
        uVar5 = uVar6;
        if (0 < *piVar1) {
          do {
            pvVar2 = *(LPVOID *)(uVar5 + *(longlong *)(piVar1 + 2));
            if (pvVar2 != (LPVOID)0x0) {
              FUN_18001d45c(*(LPVOID *)((longlong)pvVar2 + 0x10));
              FUN_18001d45c(pvVar2);
            }
            uVar3 = (int)uVar4 + 1;
            uVar4 = (ulonglong)uVar3;
            uVar5 = uVar5 + 8;
          } while ((int)uVar3 < *piVar1);
        }
        FUN_18001d45c(piVar1);
        *puVar7 = 0;
      }
      *(undefined4 *)(puVar7 + -1) = 0;
      *(undefined1 *)(puVar7 + 1) = 0;
      uVar3 = (int)uVar8 + 1;
      uVar8 = (ulonglong)uVar3;
      puVar7 = puVar7 + 3;
    } while ((int)uVar3 < DAT_18004b0c4);
  }
  FUN_1800049b0(3,0x180040928,param_3,param_4);
  return;
}



undefined8 FUN_180006270(char *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  char *pcVar2;
  
  DAT_180049f28 = 0;
  FUN_1800049b0(3,0x180040938,param_3,param_4);
  if (param_1 == (char *)0x0) {
    return 0xfffffc11;
  }
  if (1 < DAT_180047d7c - 0x1b59U) {
    return 0xfffffc02;
  }
  if ((*param_1 == 'R') && (param_1[1] == 'D')) {
    if (DAT_180049f40 != (LPVOID)0x0) {
      FUN_18001d45c(DAT_180049f40);
      DAT_180049f40 = (LPVOID)0x0;
    }
    DAT_180047d7c = 7000;
    if (*(int *)(param_1 + 8) == 0) {
      FUN_1800049b0(3,0x180040948,param_3,param_4);
      if (*(int **)(*(longlong *)(param_1 + 0x18) + 0x78) != (int *)0x0) {
        FUN_18000ea30(*(int **)(*(longlong *)(param_1 + 0x18) + 0x78));
      }
      if (*(longlong *)(*(longlong *)(param_1 + 0x18) + 0x80) != 0) {
        FUN_1800049b0(3,0x180040958,param_3,param_4);
        if (*(LPVOID *)(*(longlong *)(param_1 + 0x18) + 0x80) != (LPVOID)0x0) {
          FUN_18001d45c(*(LPVOID *)(*(longlong *)(param_1 + 0x18) + 0x80));
        }
        *(undefined8 *)(*(longlong *)(param_1 + 0x18) + 0x80) = 0;
      }
      FUN_18000c250(*(longlong *)(param_1 + 0x18));
      FUN_18000c500(*(LPVOID *)(param_1 + 0x18));
    }
    if (*(int *)(param_1 + 0x10) != 0) {
      pcVar2 = "991703==>";
      uVar1 = 3;
      FUN_1800049b0(3,0x180040958,param_3,param_4);
      FUN_180006190(uVar1,pcVar2,param_3,param_4);
      param_1[0x10] = '\0';
      param_1[0x11] = '\0';
      param_1[0x12] = '\0';
      param_1[0x13] = '\0';
    }
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x30));
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x38));
    FUN_18001d45c(param_1);
    FUN_1800049b0(3,0x180040968,param_3,param_4);
    return 0;
  }
  return 0xfffffc0e;
}



void FUN_1800063e0(int *param_1,longlong *param_2,int *param_3)

{
  longlong lVar1;
  int iVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  uint uVar5;
  ulonglong uVar6;
  undefined1 auStack_58 [32];
  byte local_38;
  byte bStack_37;
  byte bStack_36;
  byte bStack_35;
  byte bStack_34;
  byte bStack_33;
  byte bStack_32;
  byte bStack_31;
  byte local_30 [16];
  ulonglong local_20;
  
  local_20 = DAT_1800461a0 ^ (ulonglong)auStack_58;
  if ((param_1 != (int *)0x0) &&
     (iVar2 = FUN_18000f0f0(param_1,param_2,param_3,DAT_180049f30), iVar2 == 0)) {
    iVar2 = *param_3;
    lVar1 = *param_2;
    uVar6 = 0;
    local_30[0] = 0x78;
    local_30[1] = 0x19;
    local_30[2] = 0xfc;
    local_30[3] = 0xcd;
    local_30[4] = 0x45;
    local_30[5] = 0xab;
    local_30[6] = 0x3b;
    local_30[7] = 0x9a;
    local_30[8] = 0x15;
    local_30[9] = 0xaa;
    local_30[10] = 0x5c;
    local_30[0xb] = 0x69;
    local_30[0xc] = 0x96;
    local_30[0xd] = 0x71;
    local_30[0xe] = 0x8d;
    local_30[0xf] = 0xcd;
    uVar3 = uVar6;
    if (0 < iVar2 + -0x20) {
      do {
        uVar5 = (uint)uVar6;
        uVar4 = uVar3 + 1;
        uVar6 = (ulonglong)(uVar5 + 1);
        local_30[uVar5 & 0xf] = local_30[uVar5 & 0xf] ^ *(byte *)(uVar3 + 0x20 + lVar1);
        uVar3 = uVar4;
      } while ((longlong)uVar4 < (longlong)(iVar2 + -0x20));
    }
    local_38 = local_30[0] ^ local_30[8];
    bStack_37 = local_30[9] ^ local_30[1];
    bStack_36 = local_30[10] ^ local_30[2];
    bStack_35 = local_30[0xb] ^ local_30[3];
    bStack_34 = local_30[0xc] ^ local_30[4];
    bStack_33 = local_30[0xd] ^ local_30[5];
    bStack_32 = local_30[0xe] ^ local_30[6];
    bStack_31 = local_30[0xf] ^ local_30[7];
    *(ulonglong *)(lVar1 + 4) =
         CONCAT17(bStack_31,
                  CONCAT16(bStack_32,
                           CONCAT15(bStack_33,
                                    CONCAT14(bStack_34,
                                             CONCAT13(bStack_35,
                                                      CONCAT12(bStack_36,
                                                               CONCAT11(bStack_37,local_38)))))));
  }
  FUN_18001d530(local_20 ^ (ulonglong)auStack_58);
  return;
}



void FUN_1800064e0(longlong param_1,int param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  uint uVar3;
  byte local_28;
  byte bStack_27;
  byte bStack_26;
  byte bStack_25;
  byte bStack_24;
  byte bStack_23;
  byte bStack_22;
  byte bStack_21;
  byte local_20 [16];
  ulonglong local_10;
  
  local_10 = DAT_1800461a0 ^ (ulonglong)&local_28;
  uVar2 = 0;
  uVar1 = uVar2;
  while (*(char *)(param_1 + 4 + uVar1) == '\0') {
    uVar1 = uVar1 + 1;
    if (7 < (longlong)uVar1) goto LAB_180006513;
  }
  local_20[0] = 0x78;
  local_20[1] = 0x19;
  local_20[2] = 0xfc;
  local_20[3] = 0xcd;
  local_20[4] = 0x45;
  local_20[5] = 0xab;
  local_20[6] = 0x3b;
  local_20[7] = 0x9a;
  local_20[8] = 0x15;
  local_20[9] = 0xaa;
  local_20[10] = 0x5c;
  local_20[0xb] = 0x69;
  local_20[0xc] = 0x96;
  local_20[0xd] = 0x71;
  local_20[0xe] = 0x8d;
  local_20[0xf] = 0xcd;
  uVar1 = uVar2;
  if (0 < param_2 + -0x20) {
    do {
      uVar3 = (uint)uVar1;
      uVar2 = uVar2 + 1;
      uVar1 = (ulonglong)(uVar3 + 1);
      local_20[uVar3 & 0xf] = local_20[uVar3 & 0xf] ^ *(byte *)(param_1 + 0x1f + uVar2);
    } while ((longlong)uVar2 < (longlong)(param_2 + -0x20));
  }
  local_28 = local_20[0] ^ local_20[8];
  bStack_27 = local_20[9] ^ local_20[1];
  bStack_26 = local_20[10] ^ local_20[2];
  bStack_25 = local_20[0xb] ^ local_20[3];
  bStack_24 = local_20[0xc] ^ local_20[4];
  bStack_23 = local_20[0xd] ^ local_20[5];
  bStack_22 = local_20[0xe] ^ local_20[6];
  bStack_21 = local_20[0xf] ^ local_20[7];
  if (CONCAT17(bStack_21,
               CONCAT16(bStack_22,
                        CONCAT15(bStack_23,
                                 CONCAT14(bStack_24,
                                          CONCAT13(bStack_25,
                                                   CONCAT12(bStack_26,CONCAT11(bStack_27,local_28)))
                                         )))) != *(longlong *)(param_1 + 4)) {
    FUN_18001d530(local_10 ^ (ulonglong)&local_28);
    return;
  }
LAB_180006513:
  FUN_18001d530(local_10 ^ (ulonglong)&local_28);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_1800065e0(longlong *param_1,undefined8 param_2,ulonglong param_3,byte *param_4)

{
  uint uVar1;
  undefined8 uVar2;
  char *pcVar3;
  ulonglong uVar4;
  undefined8 *puVar5;
  int iVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  
  pcVar3 = "991801==>";
  uVar2 = 3;
  FUN_1800049b0(3,0x180040978,param_3,param_4);
  if (param_1 == (longlong *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_180047d7c == 7000) {
    if (5 < (int)param_1[2]) {
      return 0xfffffc00;
    }
    FUN_180006190(uVar2,pcVar3,param_3,param_4);
    if (DAT_18004b0c0 != (int)param_1[2]) {
      DAT_180048230 = 4;
      _DAT_180048220 = 0x100000000;
      uRam0000000180048228 = 0x300000002;
      DAT_18004b0c0 = (int)param_1[2];
    }
    uVar4 = 0;
    if (0 < (int)param_1[2]) {
      puVar5 = &DAT_18004b0d0;
      uVar8 = uVar4;
      uVar9 = uVar4;
      do {
        iVar6 = (int)uVar4;
        if ((*(undefined8 **)(uVar9 + *param_1) == (undefined8 *)0x0) ||
           (param_3 = (ulonglong)*(uint *)(uVar8 + param_1[1]),
           0x3c000 < *(uint *)(uVar8 + param_1[1]))) {
          param_4 = (byte *)(ulonglong)*(uint *)(param_1[1] + uVar8);
          FUN_1800049b0(1,0x180040988,uVar4,param_4);
          param_3 = uVar4;
        }
        else {
          param_4 = &DAT_18004b0d8 + (longlong)iVar6 * 0x18;
          uVar1 = FUN_1800072b0((undefined8 *)(&DAT_18004b0c0 + ((longlong)iVar6 * 3 + 2) * 2),
                                *(undefined8 **)(uVar9 + *param_1),param_3,param_4);
          if (uVar1 == 0xfffffc0f) {
            pcVar3 = "991803==>Fail %d";
            uVar7 = 0xfffffc0f;
            uVar2 = 1;
            FUN_1800049b0(1,0x180040998,0xfffffc0f,param_4);
            FUN_180006190(uVar2,pcVar3,uVar7,param_4);
            DAT_180047d7c = 7000;
            FUN_1800049b0(3,0x1800409c0,0xfffffc0f,param_4);
            return 0xfffffc0f;
          }
          if ((uVar1 != 0) && ((int *)*puVar5 != (int *)0x0)) {
            FUN_18000ea30((int *)*puVar5);
            *puVar5 = 0;
          }
        }
        uVar4 = (ulonglong)(iVar6 + 1U);
        uVar9 = uVar9 + 8;
        puVar5 = puVar5 + 3;
        uVar8 = uVar8 + 4;
      } while ((int)(iVar6 + 1U) < (int)param_1[2]);
    }
    DAT_18004b0c4 = (undefined4)param_1[2];
    DAT_180047d7c = 0x1b5b;
    FUN_1800049b0(3,0x1800409b0,param_3,param_4);
    return 0;
  }
  return 0xfffffc02;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_1800067c0(int *param_1,uint *param_2,undefined4 *param_3,undefined8 param_4)

{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  uint uVar6;
  uint *puVar7;
  ulonglong uVar8;
  short local_res8 [4];
  
  FUN_1800049b0(3,0x1800409d0,param_3,param_4);
  uVar1 = *param_2;
  puVar7 = (uint *)0x0;
  *param_3 = 0;
  puVar3 = (uint *)FUN_18001ee18(1,((longlong)(int)uVar1 + 2) * 0x10);
  if (puVar3 != (uint *)0x0) {
    *puVar3 = uVar1;
    *(uint **)(puVar3 + 4) = puVar3 + 8;
    *(uint **)(puVar3 + 6) = puVar3 + 8 + (longlong)(int)uVar1 * 2;
    puVar7 = puVar3;
  }
  FUN_1800049b0(3,0x1800409e0,(ulonglong)*param_2,(longlong)*param_1);
  uVar8 = DAT_180049f30;
  uVar1 = FUN_18000bad0((int *)param_2,param_1,(longlong)puVar7,DAT_180049f30,0);
  FUN_1800049b0(3,0x1800409f8,(ulonglong)uVar1,uVar8);
  uVar2 = (uint)DAT_18004b150;
  if ((DAT_18004b156 == 1) && ((int)uVar2 < (int)uVar1)) {
    _DAT_18004b154 = 1;
  }
  if ((int)uVar2 < (int)uVar1) {
    uVar8 = (ulonglong)*(uint *)(DAT_180049f30 + 0x84);
    DAT_18004b158 = DAT_18004b158 - 0x50;
    uVar6 = (uint)DAT_18004b158;
    _DAT_18004b154 = CONCAT22(1,DAT_18004b154);
    if ((int)(uint)DAT_18004b158 < (int)*(uint *)(DAT_180049f30 + 0x84)) {
      FUN_1800049b0(3,0x180040a08,(ulonglong)DAT_18004b158,uVar8);
      DAT_18004b158 = *(ushort *)(DAT_180049f30 + 0x84);
      uVar6 = (uint)DAT_18004b158;
    }
  }
  else {
    uVar6 = (uint)DAT_18004b158;
    _DAT_18004b154 = 0;
    uVar2 = (DAT_18004b150 >> 1) + uVar2;
    if (uVar6 <= uVar2) {
      uVar6 = (uint)(ushort)(DAT_18004b158 + 0x3c);
    }
    if (uVar2 < uVar6) {
      uVar6 = uVar2 & 0xffff;
    }
    DAT_18004b158 = (ushort)uVar6;
    if (puVar7 != (uint *)0x0) {
      uVar8 = (ulonglong)puVar7[2];
      FUN_1800049b0(3,0x180040a20,(ulonglong)uVar2,uVar8);
      uVar6 = (uint)DAT_18004b158;
    }
  }
  uVar5 = DAT_180049f30;
  if (((int)uVar6 < (int)uVar1) && ((int)puVar7[2] < *(int *)(DAT_180049f30 + 0x68))) {
    if ((0x27 < *param_2 - 1) || (*(longlong *)(param_2 + 2) == 0)) goto LAB_180006a07;
    uVar4 = FUN_18000efd0((int *)param_2,local_res8,*(int *)(DAT_180049f30 + 0x58));
    if (((int)uVar4 < 0) || (*(int *)(uVar5 + 0x88) <= (int)uVar4 + 0x20)) goto LAB_180006a07;
    uVar8 = (ulonglong)(_DAT_18004b154 & 0xffff);
    FUN_1800049b0(3,0x180040a30,3,uVar8);
    uVar5 = FUN_18000d880((int *)param_2,(int *)puVar7,DAT_180049f30);
    if ((int)uVar5 == 0) {
      *param_3 = 1;
      goto LAB_180006a07;
    }
    FUN_1800049b0(1,0x180040a48,uVar5 & 0xffffffff,uVar8);
  }
  *param_3 = 0;
LAB_180006a07:
  FUN_18000e960((int *)puVar7);
  FUN_1800049b0(3,0x180040a60,(ulonglong)uVar1,uVar8);
  return uVar1;
}



ulonglong FUN_180006a50(undefined8 *param_1,undefined8 param_2,undefined8 param_3,ulonglong param_4)

{
  longlong lVar1;
  bool bVar2;
  longlong lVar3;
  int *piVar4;
  IMAGE_DOS_HEADER *pIVar5;
  uint uVar6;
  uint uVar7;
  int *piVar8;
  longlong lVar9;
  ulonglong uVar10;
  longlong lVar11;
  uint uVar12;
  IMAGE_DOS_HEADER *pIVar13;
  IMAGE_DOS_HEADER *pIVar14;
  ulonglong uVar15;
  IMAGE_DOS_HEADER *pIVar16;
  IMAGE_DOS_HEADER *pIVar17;
  int iVar18;
  uint local_res8;
  uint local_res18 [2];
  int local_res20;
  uint local_64;
  IMAGE_DOS_HEADER *local_60;
  undefined8 *local_58 [3];
  
  pIVar14 = (IMAGE_DOS_HEADER *)0x0;
  pIVar17 = (IMAGE_DOS_HEADER *)0x0;
  local_64 = 0;
  bVar2 = false;
  pIVar16 = (IMAGE_DOS_HEADER *)0x0;
  local_res18[0] = 0;
  local_60 = (IMAGE_DOS_HEADER *)0x0;
  local_58[0] = (undefined8 *)0x0;
  FUN_1800049b0(3,0x180040a70,param_3,param_4);
  if (param_1 == (undefined8 *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_180047d7c != 0x1b5b) {
    return 0xfffffc02;
  }
  local_res8 = 0xffffffff;
  uVar15 = 0x68;
  if ((undefined8 *)*param_1 == (undefined8 *)0x0) {
    FUN_1800049b0(1,0x180040a80,param_3,param_4);
    uVar6 = 0xffffffff;
    uVar15 = 0xfffffc05;
    pIVar16 = pIVar14;
    pIVar17 = pIVar14;
    uVar12 = 0xffffffff;
  }
  else {
    uVar12 = 0xffffffff;
    if (*(uint *)((longlong)param_1 + 0x2c) + 1 < 6) {
      pIVar13 = (IMAGE_DOS_HEADER *)(ulonglong)*(uint *)(param_1 + 1);
      local_res20 = DAT_18004b0c4;
      uVar6 = FUN_1800074a0(&local_60,(undefined8 *)*param_1,(ulonglong)pIVar13,param_4);
      pIVar16 = local_60;
      if (uVar6 == 0) {
        piVar8 = DAT_180049f38;
        if ((DAT_180049f26 != '\0') &&
           (piVar8 = FUN_18000e7b0((int *)local_60), DAT_180049f38 != (int *)0x0)) {
          FUN_18000e360(DAT_180049f38,(int *)pIVar16,(int *)local_res18);
          pIVar13 = (IMAGE_DOS_HEADER *)(ulonglong)local_res18[0];
          FUN_1800049b0(3,0x180040ab8,pIVar13,param_4);
          piVar4 = DAT_180049f38;
          if (DAT_180049f38 != (int *)0x0) {
            FUN_18001d45c(*(LPVOID *)(DAT_180049f38 + 4));
            FUN_18001d45c(piVar4);
          }
        }
        DAT_180049f38 = piVar8;
        lVar9 = (longlong)local_res20;
        lVar11 = 0;
        pIVar5 = pIVar14;
        uVar12 = 0xffffffff;
        if (0 < lVar9) {
          do {
            pIVar17 = pIVar5;
            local_res18[0] = 0;
            uVar12 = (&DAT_180048220)[lVar11];
            lVar1 = (longlong)(int)uVar12 * 0x18;
            local_60 = (IMAGE_DOS_HEADER *)(&DAT_18004b0d0)[(longlong)(int)uVar12 * 3];
            iVar18 = (int)pIVar14;
            if (local_60 == (IMAGE_DOS_HEADER *)0x0) {
              uVar10 = 1;
              FUN_1800049b0(1,0x180040ac8,pIVar13,param_4);
              pIVar14 = pIVar13;
            }
            else {
              uVar7 = *(uint *)((longlong)param_1 + 0x2c);
              param_4 = (ulonglong)uVar7;
              if ((uVar7 == 0xffffffff) || (uVar7 == uVar12)) {
                if ((&DAT_18004b0d8)[lVar1] == '\0') {
                  FUN_1800130c0(DAT_18004b15c);
                }
                else {
                  FUN_1800130c0(DAT_18004b15c + 0x80);
                  DAT_18004b158 = *(undefined2 *)(DAT_180049f30 + 0x84);
                }
                pIVar14 = (IMAGE_DOS_HEADER *)local_res18;
                uVar7 = FUN_1800067c0((int *)pIVar16,(uint *)local_60,(undefined4 *)pIVar14,param_4)
                ;
                lVar3 = DAT_180049f30;
                if (local_res18[0] != 0) {
                  bVar2 = true;
                }
                if (*(int *)(DAT_180049f30 + 0x54) <= (int)uVar7) {
                  pIVar14 = &IMAGE_DOS_HEADER_180000000;
                  local_res8 = uVar12;
                  if ((&DAT_18004b0d8)[lVar1] == '\0') {
                    (&DAT_18004b0d8)[lVar1] = 0;
                  }
                  else {
                    (&DAT_18004b0d8)[lVar1] = (&DAT_18004b0d8)[lVar1] + -1;
                  }
                }
                uVar12 = *(int *)(lVar3 + 0x54) * 3;
                uVar10 = (ulonglong)uVar12;
                if ((int)pIVar17 < (int)uVar7) {
                  pIVar17 = (IMAGE_DOS_HEADER *)(ulonglong)uVar7;
                }
                if ((int)uVar12 <= (int)uVar7) break;
              }
              else {
                uVar10 = 3;
                FUN_1800049b0(3,0x180040ad8,pIVar14,param_4);
              }
            }
            lVar11 = lVar11 + 1;
            pIVar13 = pIVar14;
            pIVar5 = pIVar17;
            pIVar14 = (IMAGE_DOS_HEADER *)(ulonglong)(iVar18 + 1);
          } while (lVar11 < lVar9);
          uVar15 = 0x68;
          uVar12 = local_res8;
          if (local_res8 != 0xffffffff) {
            uVar15 = 0;
            FUN_180005130(uVar10,local_res20,(ulonglong)local_res8,param_4);
          }
        }
      }
      else {
        FUN_1800049b0(1,0x180040aa0,(ulonglong)uVar6,param_4);
        pIVar16 = local_60;
      }
    }
    else {
      FUN_1800049b0(1,0x180040a90,(ulonglong)*(uint *)((longlong)param_1 + 0x2c),param_4);
      uVar6 = 0xffffffff;
      uVar15 = 0xfffffbfb;
    }
  }
  *(uint *)(param_1 + 4) = uVar12;
  *(uint *)((longlong)param_1 + 0x24) = (uint)bVar2;
  *(int *)((longlong)param_1 + 0x1c) = (int)pIVar17;
  FUN_1800049b0(3,0x180040ae8,(ulonglong)uVar12,pIVar17);
  if (pIVar16 != (IMAGE_DOS_HEADER *)0x0) {
    FUN_18001d45c(*(LPVOID *)&pIVar16->e_sp);
    FUN_18001d45c(pIVar16);
  }
  if ((bVar2) && (uVar12 != 0xffffffff)) {
    pIVar17 = (IMAGE_DOS_HEADER *)(&DAT_18004b0d8 + (longlong)(int)uVar12 * 0x18);
    uVar10 = FUN_1800075e0((int *)(&DAT_18004b0d0)[(longlong)(int)uVar12 * 3],(longlong *)local_58,
                           &local_64,(byte *)pIVar17);
    uVar12 = local_64;
    if ((int)uVar10 != 0) {
      FUN_1800049b0(1,0x180040af8,uVar10 & 0xffffffff,pIVar17);
      if (local_58[0] != (undefined8 *)0x0) {
        FUN_18001d45c(local_58[0]);
      }
      *(undefined4 *)((longlong)param_1 + 0x24) = 0;
      *(undefined4 *)(param_1 + 4) = 0xffffffff;
      param_1[3] = 0;
      FUN_1800049b0(3,0x180040b30,uVar15,pIVar17);
      return uVar15;
    }
    uVar10 = (ulonglong)(int)local_64;
    FUN_1800049b0(3,0x180040b10,(ulonglong)local_64,pIVar17);
    FUN_18001d560((undefined8 *)param_1[2],local_58[0],uVar10);
    *(uint *)(param_1 + 3) = uVar12;
    FUN_18001d45c(local_58[0]);
    uVar6 = 0;
  }
  FUN_1800049b0(3,0x180040b20,uVar15,pIVar17);
  if (uVar6 != 0) {
    uVar15 = (ulonglong)uVar6;
  }
  return uVar15;
}



LPVOID FUN_180006ed0(char *param_1,uint *param_2,ulonglong param_3,undefined *param_4)

{
  int *piVar1;
  ulonglong uVar2;
  uint *puVar3;
  
  FUN_1800049b0(3,0x180040b60,param_3,param_4);
  if (DAT_180049f40 != (LPVOID)0x0) {
    return DAT_180049f40;
  }
  if ((((param_1 != (char *)0x0) && (param_2 != (uint *)0x0)) && (DAT_180047d7c == 0x1b5a)) &&
     ((*param_1 == 'R' && (param_1[1] == 'D')))) {
    if (*(longlong *)(*(longlong *)(param_1 + 0x18) + 0x80) != 0) {
      FUN_1800049b0(3,0x180040b70,param_3,param_4);
      if (*(LPVOID *)(*(longlong *)(param_1 + 0x18) + 0x80) != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)(*(longlong *)(param_1 + 0x18) + 0x80));
      }
      *(undefined8 *)(*(longlong *)(param_1 + 0x18) + 0x80) = 0;
    }
    piVar1 = FUN_18000c570(*(LPVOID *)(param_1 + 0x18));
    if (piVar1 == (int *)0x0) {
      FUN_1800049b0(1,0x180040b80,param_3,param_4);
    }
    else {
      param_4 = &DAT_18004b140;
      puVar3 = param_2;
      uVar2 = FUN_1800075e0(piVar1,(longlong *)&DAT_180049f40,param_2,&DAT_18004b140);
      if ((int)uVar2 == 0) {
        FUN_18000ea30(piVar1);
        param_1[8] = '\x01';
        param_1[9] = '\0';
        param_1[10] = '\0';
        param_1[0xb] = '\0';
        FUN_1800049b0(3,0x180040ba8,puVar3,param_4);
        return DAT_180049f40;
      }
      param_3 = uVar2 & 0xffffffff;
      FUN_1800049b0(1,0x180040b90,param_3,param_4);
    }
    if (DAT_180049f40 != (LPVOID)0x0) {
      FUN_18001d45c(DAT_180049f40);
      DAT_180049f40 = (LPVOID)0x0;
    }
    if (piVar1 != (int *)0x0) {
      FUN_18000ea30(piVar1);
    }
    *param_2 = 0;
    FUN_1800049b0(3,0x180040bb8,param_3,param_4);
    return (LPVOID)0x0;
  }
  return (LPVOID)0x0;
}



undefined8
FUN_180007060(undefined8 *param_1,int param_2,ulonglong param_3,uint **param_4,uint *param_5,
             longlong param_6)

{
  uint uVar1;
  int iVar2;
  longlong *plVar3;
  undefined8 uVar4;
  undefined8 *puVar5;
  uint *puVar6;
  ulonglong uVar7;
  undefined8 uVar8;
  uint **ppuVar9;
  uint *local_res8;
  
  local_res8 = (uint *)0x0;
  ppuVar9 = param_4;
  FUN_1800049b0(3,0x180040bc8,param_3,param_4);
  if ((((param_1 == (undefined8 *)0x0) || (param_4 == (uint **)0x0)) || (param_5 == (uint *)0x0)) ||
     (param_6 == 0)) {
    uVar4 = 0xfffffc11;
  }
  else {
    uVar1 = (uint)param_3;
    plVar3 = (longlong *)FUN_1800076f0(param_2,uVar1);
    if (plVar3 == (longlong *)0x0) {
      uVar4 = 0xfffffc18;
    }
    else {
      uVar7 = (ulonglong)(int)(param_2 * uVar1);
      FUN_18001d560((undefined8 *)*plVar3,param_1,uVar7);
      if (DAT_180049f30 == (int *)0x0) {
        iVar2 = -0x3ea;
        puVar6 = (uint *)0x0;
      }
      else {
        ppuVar9 = &local_res8;
        uVar7 = param_3 & 0xffffffff;
        uVar4 = FUN_180016260(plVar3,param_2,uVar1,ppuVar9,DAT_180049f30);
        iVar2 = (int)uVar4;
        puVar6 = local_res8;
      }
      FUN_18001d45c(plVar3);
      if (iVar2 == 0) {
        if (puVar6 != (uint *)0x0) {
          uVar1 = FUN_18000eab0(puVar6);
          puVar5 = (undefined8 *)FUN_18001ed60((longlong)(int)(uVar1 + 8));
          if ((puVar5 != (undefined8 *)0x0) &&
             (iVar2 = FUN_18000ec70(puVar6,(undefined2 *)puVar5), -1 < iVar2)) {
            FUN_18001d45c(*(LPVOID *)(puVar6 + 4));
            FUN_18001d45c(puVar6);
            if ((int)*param_5 < (int)uVar1) {
              FUN_1800049b0(1,0x180040bf8,uVar7,ppuVar9);
              *param_5 = 0;
              FUN_18001d45c(puVar5);
              return 0xfffffbfc;
            }
            *param_5 = uVar1;
            if (uVar1 - 1 < 0xa000) {
              uVar8 = 0;
              uVar4 = FUN_180004ec0(puVar5,param_5,0,ppuVar9);
              if ((int)uVar4 != 0) {
                FUN_1800049b0(1,0x180040c18,uVar8,ppuVar9);
                FUN_18001d45c(puVar5);
                *param_5 = 0;
                return 0xfffffc0f;
              }
              uVar7 = (ulonglong)(int)*param_5;
              FUN_18001d560(param_4,puVar5,uVar7);
              FUN_18001d45c(puVar5);
              FUN_1800049b0(3,0x180040c28,uVar7,ppuVar9);
              return 0;
            }
            FUN_1800049b0(3,0x180040c08,uVar7,ppuVar9);
            *param_5 = 0;
            FUN_18001d45c(puVar5);
            return 0xfffffc10;
          }
        }
        FUN_1800049b0(1,0x180040be8,uVar7,ppuVar9);
        *param_5 = 0;
        uVar4 = 0xfffffc0e;
      }
      else {
        FUN_1800049b0(1,0x180040bd8,uVar7,ppuVar9);
        uVar4 = 0xfffffc05;
      }
    }
  }
  return uVar4;
}



uint FUN_1800072b0(undefined8 *param_1,undefined8 *param_2,ulonglong param_3,byte *param_4)

{
  ushort uVar1;
  uint uVar2;
  char *pcVar3;
  ulonglong uVar4;
  LPVOID pvVar5;
  ulonglong uVar6;
  byte *pbVar7;
  int local_res18 [2];
  
  local_res18[0] = (int)param_3;
  uVar6 = (ulonglong)local_res18[0];
  uVar4 = param_3;
  pbVar7 = param_4;
  FUN_1800049b0(3,0x180040c68,param_3,param_4);
  FUN_1800049b0(3,0x180040c38,uVar4,pbVar7);
  pcVar3 = (char *)FUN_18001ed60(uVar6);
  if (pcVar3 == (char *)0x0) {
    uVar2 = 0xfffffc0f;
    FUN_1800049b0(1,0x180040c78,0xfffffc0f,pbVar7);
  }
  else {
    FUN_1800049b0(3,0x180040c48,param_3 & 0xffffffff,pbVar7);
    FUN_18001d560((undefined8 *)pcVar3,param_2,uVar6);
    FUN_1800049b0(3,0x180040c58,uVar6,pbVar7);
    FUN_1800049b0(3,0x180040590,uVar6,pbVar7);
    uVar4 = FUN_180005010(pcVar3,local_res18,1,pbVar7);
    uVar2 = (uint)uVar4;
    if (uVar2 == 0) {
      uVar1 = *(ushort *)(pcVar3 + 2);
      uVar4 = (ulonglong)uVar1;
      if (uVar1 - 1 < 0x28) {
        pvVar5 = FUN_18000e850((uint)uVar1);
        *param_1 = pvVar5;
        uVar2 = FUN_1800064e0((longlong)pcVar3,local_res18[0]);
        if (uVar2 == 0) {
          uVar4 = FUN_180004ad0((longlong)pcVar3,param_4,uVar4,pbVar7);
          uVar2 = (uint)uVar4;
          FUN_1800049b0(3,0x180040cd8,(ulonglong)*param_4,pbVar7);
          if (uVar2 == 0) {
            uVar2 = FUN_18000f280((uint *)*param_1,pcVar3);
            if (uVar2 != 0) {
              FUN_1800049b0(1,0x180040d00,(ulonglong)uVar2,pbVar7);
            }
          }
          else {
            FUN_1800049b0(1,0x180040ce8,uVar4 & 0xffffffff,pbVar7);
          }
        }
        else {
          FUN_1800049b0(1,0x180040cc0,(ulonglong)uVar2,pbVar7);
        }
      }
      else {
        FUN_1800049b0(1,0x180040ca8,uVar4,pbVar7);
        uVar2 = 0xfffffc17;
      }
    }
    else {
      FUN_1800049b0(1,0x180040c90,uVar4 & 0xffffffff,pbVar7);
    }
    FUN_18001d45c(pcVar3);
  }
  FUN_1800049b0(3,0x180040d18,(ulonglong)uVar2,pbVar7);
  return uVar2;
}



uint FUN_1800074a0(undefined8 *param_1,undefined8 *param_2,ulonglong param_3,undefined8 param_4)

{
  uint uVar1;
  int iVar2;
  char *pcVar3;
  ulonglong uVar4;
  uint *puVar5;
  ulonglong uVar6;
  undefined8 uVar7;
  int local_res18 [4];
  
  local_res18[0] = (int)param_3;
  uVar6 = (ulonglong)local_res18[0];
  uVar4 = param_3;
  FUN_1800049b0(3,0x180040d28,param_3,param_4);
  FUN_1800049b0(3,0x180040c38,uVar4,param_4);
  pcVar3 = (char *)FUN_18001ed60(uVar6);
  if (pcVar3 == (char *)0x0) {
    uVar1 = 0xfffffc0f;
    FUN_1800049b0(1,0x180040d38,0xfffffc0f,param_4);
  }
  else {
    FUN_1800049b0(3,0x180040c48,param_3 & 0xffffffff,param_4);
    FUN_18001d560((undefined8 *)pcVar3,param_2,uVar6);
    FUN_1800049b0(3,0x180040c58,uVar6,param_4);
    FUN_1800049b0(3,0x180040590,uVar6,param_4);
    uVar7 = 0;
    uVar4 = FUN_180005010(pcVar3,local_res18,0,param_4);
    uVar1 = (uint)uVar4;
    if (uVar1 == 0) {
      puVar5 = (uint *)FUN_18000e600((uint)*(ushort *)(pcVar3 + 2));
      *param_1 = puVar5;
      iVar2 = FUN_18000ed50(puVar5,pcVar3);
      if (iVar2 < 0) {
        FUN_1800049b0(1,0x180040d68,uVar7,param_4);
        uVar1 = 0xfffffbfd;
      }
    }
    else {
      FUN_1800049b0(1,0x180040d50,uVar4 & 0xffffffff,param_4);
    }
    FUN_18001d45c(pcVar3);
  }
  FUN_1800049b0(3,0x180040d78,(ulonglong)uVar1,param_4);
  return uVar1;
}



ulonglong FUN_1800075e0(int *param_1,longlong *param_2,uint *param_3,byte *param_4)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  byte *pbVar5;
  
  pbVar5 = param_4;
  FUN_1800049b0(3,0x180040d88,param_3,param_4);
  uVar1 = FUN_1800063e0(param_1,param_2,(int *)param_3);
  uVar3 = (ulonglong)uVar1;
  if (uVar1 == 0) {
    uVar1 = *param_3;
    if (uVar1 < 0x3c001) {
      uVar2 = FUN_180004a40((char *)*param_2,*param_4,(ulonglong)uVar1,pbVar5);
      uVar3 = uVar2 & 0xffffffff;
      if ((int)uVar2 == 0) {
        uVar4 = 1;
        uVar2 = FUN_180004ec0((undefined8 *)*param_2,param_3,1,pbVar5);
        uVar3 = uVar2 & 0xffffffff;
        if ((int)uVar2 == 0) {
          FUN_1800049b0(3,0x180040df8,uVar4,pbVar5);
          uVar3 = 0;
        }
        else {
          FUN_1800049b0(1,0x180040de0,uVar2 & 0xffffffff,pbVar5);
        }
      }
      else {
        FUN_1800049b0(1,0x180040dc8,uVar2 & 0xffffffff,pbVar5);
      }
    }
    else {
      FUN_1800049b0(1,0x180040db0,(ulonglong)uVar1,pbVar5);
      uVar3 = 0xfffffc10;
    }
  }
  else {
    FUN_1800049b0(1,0x180040d98,(ulonglong)uVar1,pbVar5);
  }
  return uVar3;
}



LPVOID FUN_1800076f0(int param_1,int param_2)

{
  LPVOID pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = FUN_18001ed60((longlong)(param_1 * param_2 + param_2 * 8));
  if (pvVar1 != (LPVOID)0x0) {
    lVar2 = 0;
    lVar3 = (longlong)pvVar1 + (longlong)(param_2 * 8);
    if (0 < param_2) {
      do {
        *(longlong *)((longlong)pvVar1 + lVar2 * 8) = lVar3;
        lVar2 = lVar2 + 1;
        lVar3 = lVar3 + param_1;
      } while (lVar2 < param_2);
    }
    return pvVar1;
  }
  return (LPVOID)0x0;
}



void FUN_180007780(int param_1,int param_2,longlong param_3,int param_4)

{
  int iVar1;
  longlong lVar2;
  LPVOID pvVar3;
  int *piVar4;
  LPVOID pvVar5;
  longlong lVar6;
  longlong lVar7;
  ulonglong uVar8;
  longlong lVar9;
  int iVar10;
  longlong lVar11;
  longlong *plVar12;
  int iVar13;
  longlong lVar14;
  longlong lVar15;
  int iVar16;
  int *piVar17;
  longlong lVar18;
  int iVar19;
  
  lVar2 = (longlong)param_2;
  uVar8 = (ulonglong)param_1;
  iVar19 = param_4 * 2 + 1;
  iVar1 = param_2;
  if (iVar19 < param_2) {
    iVar1 = iVar19;
  }
  iVar10 = 0;
  pvVar3 = FUN_18001ed60(lVar2 * 8);
  piVar4 = (int *)FUN_18001ee18(uVar8,4);
  lVar11 = 0;
  if (0 < (longlong)iVar1) {
    do {
      pvVar5 = FUN_18001ed60(uVar8);
      lVar11 = lVar11 + 1;
      *(LPVOID *)((longlong)pvVar3 + lVar11 * 8 + -8) = pvVar5;
    } while (lVar11 < iVar1);
  }
  lVar11 = (longlong)-param_4;
  if (lVar11 < lVar2) {
    lVar14 = (longlong)-iVar19;
    plVar12 = (longlong *)(lVar14 * 8 + (longlong)pvVar3);
    lVar9 = lVar11;
    do {
      lVar15 = (lVar14 - lVar11) + lVar9;
      if (-1 < lVar15) {
        lVar18 = *plVar12;
        lVar6 = 0;
        if (0 < (longlong)uVar8) {
          do {
            lVar7 = lVar6 + 1;
            piVar4[lVar6] = piVar4[lVar6] - (uint)*(byte *)(lVar6 + lVar18);
            lVar6 = lVar7;
          } while (lVar7 < (longlong)uVar8);
        }
        iVar10 = iVar10 + -1;
      }
      if (lVar9 - lVar11 < lVar2) {
        if (-1 < lVar15) {
          plVar12[-lVar14] = *plVar12;
        }
        FUN_18001d560((undefined8 *)plVar12[-lVar14],
                      *(undefined8 **)
                       (((param_3 + lVar14 * -8) - (longlong)pvVar3) + (longlong)plVar12),uVar8);
        lVar15 = plVar12[-lVar14];
        lVar18 = 0;
        if (0 < (longlong)uVar8) {
          do {
            lVar6 = lVar18 + 1;
            piVar4[lVar18] = piVar4[lVar18] + (uint)*(byte *)(lVar18 + lVar15);
            lVar18 = lVar6;
          } while (lVar6 < (longlong)uVar8);
        }
        iVar10 = iVar10 + 1;
      }
      if (-1 < lVar9) {
        lVar15 = *(longlong *)
                  (((lVar11 - lVar14) * 8 - (longlong)pvVar3) + param_3 + (longlong)plVar12);
        iVar13 = 0;
        lVar18 = -(longlong)param_4;
        iVar16 = 0;
        if (lVar18 < (longlong)uVar8) {
          lVar6 = 0;
          piVar17 = piVar4;
          do {
            if (-1 < lVar6 - iVar19) {
              iVar13 = iVar13 - piVar17[-(longlong)iVar19];
              iVar16 = iVar16 - iVar10;
            }
            if (lVar6 < (longlong)uVar8) {
              iVar13 = iVar13 + *piVar17;
              iVar16 = iVar16 + iVar10;
            }
            if (-1 < lVar6 + lVar18) {
              *(char *)((lVar15 - param_4) + lVar6) = (char)(iVar13 / iVar16);
            }
            lVar6 = lVar6 + 1;
            piVar17 = piVar17 + 1;
          } while (lVar6 + lVar18 < (longlong)uVar8);
        }
      }
      lVar9 = lVar9 + 1;
      plVar12 = plVar12 + 1;
    } while (lVar9 < lVar2);
  }
  for (lVar11 = (longlong)(param_2 - iVar1); lVar11 < lVar2; lVar11 = lVar11 + 1) {
    FUN_18001d45c(*(LPVOID *)((longlong)pvVar3 + lVar11 * 8));
  }
  FUN_18001d45c(pvVar3);
  FUN_18001d45c(piVar4);
  return;
}



void FUN_180007a30(int param_1,int param_2,longlong param_3,longlong param_4)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  int iVar4;
  byte bVar5;
  int iVar6;
  LPVOID pvVar7;
  int *piVar8;
  LPVOID pvVar9;
  byte *pbVar10;
  byte bVar11;
  int *piVar12;
  ulonglong uVar13;
  longlong lVar14;
  longlong lVar15;
  uint uVar16;
  byte bVar17;
  ulonglong uVar18;
  int iVar19;
  longlong lVar20;
  longlong lVar21;
  longlong *plVar22;
  int iVar23;
  longlong local_70;
  
  lVar21 = (longlong)param_2;
  uVar13 = (ulonglong)param_1;
  iVar4 = param_2;
  if (0x11 < param_2) {
    iVar4 = 0x11;
  }
  iVar23 = 0;
  pvVar7 = FUN_18001ed60(lVar21 * 8);
  piVar8 = (int *)FUN_18001ee18(uVar13,4);
  lVar14 = 0;
  if (0 < (longlong)iVar4) {
    do {
      pvVar9 = FUN_18001ed60(uVar13);
      lVar14 = lVar14 + 1;
      *(LPVOID *)((longlong)pvVar7 + lVar14 * 8 + -8) = pvVar9;
    } while (lVar14 < iVar4);
  }
  if (-8 < lVar21) {
    plVar22 = (longlong *)((longlong)pvVar7 + -0x88);
    local_70 = -8;
    lVar14 = param_3 - (longlong)pvVar7;
    do {
      if (-1 < local_70 + -9) {
        pbVar10 = *(byte **)(lVar14 + (longlong)plVar22);
        if (0 < (longlong)uVar13) {
          lVar20 = *plVar22 - (longlong)pbVar10;
          piVar12 = piVar8;
          uVar18 = uVar13;
          do {
            iVar6 = (uint)pbVar10[lVar20] - (uint)*pbVar10;
            if (iVar6 < 0) {
              iVar6 = (uint)*pbVar10 - (uint)pbVar10[lVar20];
            }
            *piVar12 = *piVar12 - iVar6;
            piVar12 = piVar12 + 1;
            pbVar10 = pbVar10 + 1;
            uVar18 = uVar18 - 1;
          } while (uVar18 != 0);
        }
        iVar23 = iVar23 + -1;
      }
      if (local_70 + 8 < lVar21) {
        if (-1 < local_70 + -9) {
          plVar22[0x11] = *plVar22;
        }
        FUN_18001d560((undefined8 *)plVar22[0x11],
                      *(undefined8 **)((param_4 - (longlong)pvVar7) + 0x88 + (longlong)plVar22),
                      uVar13);
        pbVar10 = *(byte **)(lVar14 + 0x88 + (longlong)plVar22);
        if (0 < (longlong)uVar13) {
          lVar20 = plVar22[0x11] - (longlong)pbVar10;
          piVar12 = piVar8;
          uVar18 = uVar13;
          do {
            iVar6 = (uint)pbVar10[lVar20] - (uint)*pbVar10;
            if (iVar6 < 0) {
              iVar6 = (uint)*pbVar10 - (uint)pbVar10[lVar20];
            }
            *piVar12 = *piVar12 + iVar6;
            piVar12 = piVar12 + 1;
            pbVar10 = pbVar10 + 1;
            uVar18 = uVar18 - 1;
          } while (uVar18 != 0);
        }
        iVar23 = iVar23 + 1;
      }
      if (-1 < local_70) {
        lVar20 = *(longlong *)(lVar14 + 0x48 + (longlong)plVar22);
        lVar2 = plVar22[9];
        lVar3 = *(longlong *)((param_4 - (longlong)pvVar7) + 0x48 + (longlong)plVar22);
        iVar19 = 0;
        iVar6 = 0;
        if (-8 < (longlong)uVar13) {
          piVar12 = piVar8;
          lVar15 = 0;
          do {
            if (-1 < lVar15 + -0x11) {
              iVar19 = iVar19 - piVar12[-0x11];
              iVar6 = iVar6 - iVar23;
            }
            if (lVar15 < (longlong)uVar13) {
              iVar19 = iVar19 + *piVar12;
              iVar6 = iVar6 + iVar23;
            }
            if (-1 < lVar15 + -8) {
              bVar5 = (byte)((longlong)iVar19 / (longlong)iVar6);
              bVar11 = *(byte *)(lVar15 + lVar2 + -8);
              if (bVar11 < bVar5) {
                uVar16 = 0;
              }
              else {
                uVar16 = (uint)(byte)(bVar11 - bVar5);
              }
              if ((int)(0xff - ((uint)((longlong)iVar19 / (longlong)iVar6) & 0xff)) <
                  (int)(uint)bVar11) {
                bVar11 = 0xff;
              }
              else {
                bVar11 = bVar11 + bVar5;
              }
              bVar5 = *(byte *)(lVar15 + lVar20 + -8);
              bVar17 = bVar11 - (byte)uVar16;
              if (bVar17 != 0) {
                if ((byte)uVar16 < bVar5) {
                  if (bVar5 < bVar11) {
                    bVar5 = (byte)((int)((bVar5 - uVar16) * 0xff) / (int)(uint)bVar17);
                  }
                  else {
                    bVar5 = 0xff;
                  }
                }
                else {
                  bVar5 = 0;
                }
              }
              *(byte *)(lVar15 + lVar3 + -8) = bVar5;
            }
            piVar12 = piVar12 + 1;
            lVar1 = lVar15 + -7;
            lVar15 = lVar15 + 1;
          } while (lVar1 < (longlong)uVar13);
        }
      }
      local_70 = local_70 + 1;
      plVar22 = plVar22 + 1;
    } while (local_70 < lVar21);
  }
  for (lVar14 = (longlong)(param_2 - iVar4); lVar14 < lVar21; lVar14 = lVar14 + 1) {
    FUN_18001d45c(*(LPVOID *)((longlong)pvVar7 + lVar14 * 8));
  }
  FUN_18001d45c(pvVar7);
  FUN_18001d45c(piVar8);
  return;
}



void FUN_180007d90(byte *param_1,int param_2,int param_3,undefined1 *param_4,undefined1 *param_5)

{
  byte bVar1;
  uint uVar2;
  longlong lVar3;
  uint uVar4;
  uint uVar5;
  longlong lVar6;
  uint uVar7;
  int *piVar8;
  int iVar9;
  ulonglong uVar10;
  undefined1 auStack_498 [32];
  uint local_478;
  int local_474;
  uint local_470;
  int local_46c;
  int local_468;
  ulonglong local_460;
  undefined1 *local_458;
  undefined1 *local_450;
  int local_448 [256];
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStack_498;
  uVar2 = 0;
  local_450 = param_5;
  iVar9 = param_2 * param_3;
  local_470 = 1;
  local_46c = 1;
  uVar5 = 0;
  local_460 = 0;
  local_478 = 0;
  local_474 = 0;
  local_458 = param_4;
  FUN_18001dbc0((undefined1 (*) [16])local_448,0,0x400);
  lVar3 = (longlong)iVar9;
  uVar4 = uVar2;
  uVar7 = uVar2;
  if (0 < iVar9) {
    do {
      bVar1 = *param_1;
      if (bVar1 < 0xf0) {
        uVar7 = uVar7 + bVar1;
        local_448[bVar1] = local_448[bVar1] + 1;
        uVar5 = uVar4;
      }
      else {
        uVar5 = uVar4 + 1;
      }
      param_1 = param_1 + 1;
      lVar3 = lVar3 + -1;
      uVar4 = uVar5;
    } while (lVar3 != 0);
  }
  local_468 = iVar9 - uVar5;
  piVar8 = local_448;
  uVar4 = uVar2;
  uVar5 = uVar2;
  do {
    iVar9 = *piVar8;
    if (iVar9 != 0) {
      uVar5 = uVar5 + iVar9;
      uVar4 = uVar4 + iVar9 * uVar2;
      iVar9 = local_468 - uVar5;
      if ((uVar5 != 0) && (iVar9 != 0)) {
        lVar6 = (longlong)(int)uVar4;
        lVar3 = (longlong)(int)(uVar7 - uVar4);
        uVar10 = (ulonglong)(lVar6 * lVar6 * (longlong)iVar9) / (ulonglong)(longlong)(int)uVar5 +
                 (ulonglong)((int)uVar5 * lVar3 * lVar3) / (ulonglong)(longlong)iVar9 +
                 lVar6 * lVar3 * -2;
        if (local_460 < uVar10) {
          local_478 = uVar4;
          local_474 = uVar7 - uVar4;
          local_470 = uVar5;
          local_46c = iVar9;
          local_460 = uVar10;
        }
      }
    }
    uVar2 = uVar2 + 1;
    piVar8 = piVar8 + 1;
  } while (uVar2 < 0x100);
  if (local_458 != (undefined1 *)0x0) {
    *local_458 = (char)(local_474 / local_46c);
  }
  if (local_450 != (undefined1 *)0x0) {
    *local_450 = (char)((int)local_478 / (int)local_470);
  }
  FUN_18001d530(local_48 ^ (ulonglong)auStack_498);
  return;
}



void FUN_180007f60(byte *param_1,int param_2,int param_3)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  ulonglong uVar7;
  int iVar8;
  int *piVar9;
  longlong lVar10;
  int iVar11;
  ulonglong uVar12;
  int iVar13;
  undefined1 auStack_458 [32];
  int local_438 [256];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStack_458;
  iVar13 = 0;
  iVar11 = param_2 * param_3;
  uVar12 = 0;
  iVar6 = 0;
  iVar5 = 0;
  iVar8 = 0;
  FUN_18001dbc0((undefined1 (*) [16])local_438,0,0x400);
  lVar4 = (longlong)iVar11;
  if (0 < iVar11) {
    do {
      bVar1 = *param_1;
      if (bVar1 < 0xf0) {
        iVar13 = iVar13 + (uint)bVar1;
        local_438[bVar1] = local_438[bVar1] + 1;
      }
      else {
        iVar6 = iVar6 + 1;
      }
      param_1 = param_1 + 1;
      lVar4 = lVar4 + -1;
    } while (lVar4 != 0);
  }
  uVar3 = 0;
  piVar9 = local_438;
  do {
    iVar2 = *piVar9;
    if (iVar2 != 0) {
      iVar5 = iVar5 + iVar2;
      iVar8 = iVar8 + iVar2 * uVar3;
      iVar2 = (iVar11 - iVar6) - iVar5;
      if ((iVar5 != 0) && (iVar2 != 0)) {
        lVar4 = (longlong)(iVar13 - iVar8);
        lVar10 = (longlong)iVar8;
        uVar7 = (ulonglong)(lVar10 * lVar10 * (longlong)iVar2) / (ulonglong)(longlong)iVar5 +
                (ulonglong)(iVar5 * lVar4 * lVar4) / (ulonglong)(longlong)iVar2 +
                lVar10 * lVar4 * -2;
        if (uVar12 < uVar7) {
          uVar12 = uVar7;
        }
      }
    }
    uVar3 = uVar3 + 1;
    piVar9 = piVar9 + 1;
  } while (uVar3 < 0x100);
  FUN_18001d530(local_38 ^ (ulonglong)auStack_458);
  return;
}



undefined8 FUN_1800080a0(byte *param_1,int param_2,int param_3,byte param_4,byte param_5)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  uint uVar7;
  byte local_res20 [8];
  
  local_res20[0] = param_4;
  bVar2 = FUN_180007d90(param_1,param_2,param_3,&param_5,local_res20);
  if ((((local_res20[0] != 0) && (param_5 != 0)) && (bVar2 != local_res20[0])) && (param_5 != bVar2)
     ) {
    uVar7 = (uint)bVar2;
    iVar5 = uVar7 - local_res20[0];
    bVar3 = (char)((iVar5 * 0x96) / (int)((uint)param_5 - (uint)local_res20[0])) + 0x46;
    lVar6 = (longlong)(param_2 * param_3);
    if (0 < param_2 * param_3) {
      do {
        bVar1 = *param_1;
        if (bVar1 < bVar2) {
          iVar4 = (uVar7 - bVar1) * ((int)((bVar3 - 0x46) * 0x10) / iVar5);
          iVar4 = (uint)bVar3 - ((int)((iVar4 >> 0x1f & 0xfU) + iVar4) >> 4);
        }
        else {
          iVar4 = (bVar1 - uVar7) *
                  ((int)((0xdc - (uint)bVar3) * 0x10) / (int)((uint)param_5 - (uint)bVar2));
          iVar4 = ((int)(iVar4 + (iVar4 >> 0x1f & 0xfU)) >> 4) + (uint)bVar3;
        }
        if (iVar4 < 0) {
          iVar4 = 0;
        }
        else if (0xff < iVar4) {
          iVar4 = 0xff;
        }
        *param_1 = (byte)iVar4;
        param_1 = param_1 + 1;
        lVar6 = lVar6 + -1;
      } while (lVar6 != 0);
    }
    return 1;
  }
  return 0;
}



void FUN_1800081d0(undefined8 *param_1,int param_2,int param_3,int *param_4,int *param_5)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  int iVar5;
  ulonglong uVar6;
  longlong lVar7;
  longlong lVar8;
  longlong lVar9;
  longlong lVar10;
  int iVar11;
  int iVar12;
  longlong lVar13;
  
  iVar11 = 0;
  iVar5 = 0;
  iVar12 = 0;
  bVar1 = FUN_180007f60((byte *)*param_1,param_2,param_3);
  lVar13 = 0;
  if (-1 < param_3 + -0xc) {
    do {
      lVar7 = param_1[lVar13];
      if (-1 < param_2 + -0xc) {
        uVar6 = (ulonglong)(param_2 - 6) / 6;
        iVar11 = iVar11 + (int)uVar6;
        do {
          iVar2 = 0;
          iVar3 = 0;
          lVar10 = 0xc;
          lVar9 = lVar7;
          do {
            pbVar4 = (byte *)(lVar9 + 1);
            lVar8 = 2;
            do {
              if (pbVar4[-1] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (*pbVar4 < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (pbVar4[1] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (pbVar4[2] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (pbVar4[3] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (pbVar4[4] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              pbVar4 = pbVar4 + 6;
              lVar8 = lVar8 + -1;
            } while (lVar8 != 0);
            lVar9 = lVar9 + param_2;
            lVar10 = lVar10 + -1;
          } while (lVar10 != 0);
          if (iVar2 < 0x87) {
            if (0x86 < iVar3) {
              iVar12 = iVar12 + 1;
            }
          }
          else {
            iVar5 = iVar5 + 1;
          }
          lVar7 = lVar7 + 6;
          uVar6 = uVar6 - 1;
        } while (uVar6 != 0);
      }
      lVar13 = lVar13 + 6;
    } while (lVar13 <= param_3 + -0xc);
    if (0 < iVar11) {
      if (param_5 != (int *)0x0) {
        *param_5 = (iVar12 * 100) / iVar11;
      }
      if (param_4 != (int *)0x0) {
        *param_4 = (iVar5 * 100) / iVar11;
      }
    }
  }
  return;
}



ulonglong FUN_180008360(longlong param_1,int param_2,uint param_3,int param_4)

{
  byte *pbVar1;
  longlong lVar2;
  int iVar3;
  ulonglong uVar4;
  int iVar5;
  uint uVar6;
  longlong lVar7;
  
  lVar7 = (longlong)param_4;
  uVar6 = 0;
  uVar4 = (ulonglong)param_3;
  if (0 < (int)param_3) {
    do {
      iVar3 = 0;
      iVar5 = 0;
      lVar2 = 0;
      if (1 < lVar7) {
        do {
          pbVar1 = (byte *)(param_1 + lVar2);
          lVar2 = lVar2 + 2;
          iVar3 = iVar3 + (uint)*pbVar1;
          iVar5 = iVar5 + (uint)*(byte *)(param_1 + -1 + lVar2);
        } while (lVar2 < lVar7 + -1);
      }
      if (lVar2 < lVar7) {
        uVar6 = uVar6 + *(byte *)(lVar2 + param_1);
      }
      param_1 = param_1 + param_2;
      uVar6 = uVar6 + iVar5 + iVar3;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  return (ulonglong)uVar6 / (ulonglong)(param_3 * param_4);
}



void FUN_180008400(undefined8 *param_1,uint param_2,uint param_3,int *param_4,int *param_5,
                  undefined4 *param_6,int *param_7,int *param_8,uint *param_9)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  longlong *plVar7;
  ulonglong uVar8;
  undefined8 *puVar9;
  longlong *plVar10;
  ulonglong uVar11;
  uint uVar12;
  ulonglong uVar13;
  longlong lVar14;
  byte *pbVar15;
  ulonglong uVar16;
  longlong *plVar17;
  longlong lVar18;
  undefined1 auStackY_2c8 [32];
  int *in_stack_fffffffffffffd58;
  undefined8 in_stack_fffffffffffffd60;
  int local_238 [120];
  ulonglong local_58;
  
  local_58 = DAT_1800461a0 ^ (ulonglong)auStackY_2c8;
  puVar5 = (undefined8 *)FUN_18000ff90(param_2,param_3);
  puVar6 = (undefined8 *)FUN_18000ff90(param_2,param_3);
  plVar7 = (longlong *)FUN_18000ff90(param_2,param_3);
  uVar11 = 0;
  uVar2 = (int)(param_2 + ((int)param_2 >> 0x1f & 0xfU)) >> 4;
  lVar18 = (longlong)(int)uVar2;
  iVar3 = (int)(param_3 + ((int)param_3 >> 0x1f & 0xfU)) >> 4;
  uVar8 = FUN_180008360((longlong)param_1,param_2,param_3,param_2);
  iVar4 = 0;
  if ((int)uVar8 < 0xf5) {
    FUN_18001d560((undefined8 *)*puVar5,param_1,(longlong)(int)(param_3 * param_2));
    FUN_180010020(param_2,param_3,(longlong)puVar5);
    FUN_18001d560((undefined8 *)*puVar6,(undefined8 *)*puVar5,(longlong)(int)(param_3 * param_2));
    if ((param_4 != (int *)0x0) && (param_5 != (int *)0x0)) {
      FUN_1800081d0(puVar6,param_2,param_3,param_4,param_5);
      in_stack_fffffffffffffd58 = param_5;
    }
    FUN_180010210(param_2,param_3,(longlong)puVar6);
    FUN_1800103e0(param_2,param_3,(longlong)puVar5,puVar6,in_stack_fffffffffffffd58,
                  in_stack_fffffffffffffd60,(longlong)plVar7);
    FUN_180010020(param_2,param_3,(longlong)puVar6);
    lVar14 = (longlong)iVar3;
    puVar9 = (undefined8 *)FUN_18000ff90(uVar2,iVar3);
    plVar10 = (longlong *)FUN_18000ff90(uVar2,iVar3);
    FUN_180010c00(param_2,param_3,(longlong)puVar6,uVar2,iVar3,(longlong)puVar9,(longlong)plVar10);
    FUN_1800115b0(uVar2,iVar3,(longlong)puVar9,(longlong)plVar10);
    if (param_8 != (int *)0x0) {
      if (0 < lVar14) {
        uVar8 = uVar11;
        uVar16 = uVar11;
        plVar17 = plVar10;
        do {
          if (0 < (int)uVar2) {
            uVar13 = uVar11;
            do {
              if (*(char *)(*(longlong *)
                             (((longlong)puVar9 - (longlong)plVar10) + (longlong)plVar17) + uVar13)
                  != -1) {
                uVar8 = (ulonglong)((int)uVar8 + (uint)*(byte *)(*plVar17 + uVar13));
                uVar16 = (ulonglong)((int)uVar16 + 1);
              }
              uVar13 = uVar13 + 1;
            } while ((longlong)uVar13 < lVar18);
          }
          plVar17 = plVar17 + 1;
          lVar14 = lVar14 + -1;
        } while (lVar14 != 0);
        if ((int)uVar16 != 0) {
          iVar4 = (int)uVar8 / (int)uVar16;
        }
      }
      *param_8 = iVar4;
    }
    if (param_9 != (uint *)0x0) {
      bVar1 = 0x50 < ((byte *)*plVar10)[lVar18 + -1];
      uVar12 = (uint)bVar1;
      if (0x50 < *(byte *)*plVar10) {
        uVar12 = bVar1 + 1;
      }
      if (0x50 < *(byte *)plVar10[(longlong)iVar3 + -1]) {
        uVar12 = uVar12 + 1;
      }
      if (0x50 < ((byte *)plVar10[(longlong)iVar3 + -1])[lVar18 + -1]) {
        uVar12 = uVar12 + 1;
      }
      *param_9 = uVar12;
    }
    if (param_6 != (undefined4 *)0x0) {
      uVar8 = FUN_180011740(plVar7,param_2,param_3,(longlong)plVar10);
      *param_6 = (int)uVar8;
    }
    if (param_7 != (int *)0x0) {
      pbVar15 = (byte *)*puVar9;
      iVar4 = 0;
      FUN_18001dbc0((undefined1 (*) [16])local_238,0,0x1e0);
      lVar18 = (longlong)(int)(uVar2 * iVar3);
      uVar8 = uVar11;
      if (0 < (int)(uVar2 * iVar3)) {
        do {
          if (*pbVar15 != 0xff) {
            local_238[*pbVar15] = local_238[*pbVar15] + 1;
            uVar8 = (ulonglong)((int)uVar8 + 1);
          }
          iVar4 = (int)uVar8;
          pbVar15 = pbVar15 + 1;
          lVar18 = lVar18 + -1;
        } while (lVar18 != 0);
      }
      lVar18 = -10;
      lVar14 = 0x82;
      uVar8 = uVar11;
      uVar16 = uVar11;
      do {
        iVar3 = (int)uVar16;
        if (-1 < lVar18) {
          if ((int)uVar8 < iVar3) {
            uVar8 = uVar16;
          }
          iVar3 = iVar3 - local_238[lVar18];
        }
        if (0x77 < (longlong)uVar11) {
          uVar11 = uVar11 - 0x78;
        }
        uVar16 = (ulonglong)(uint)(iVar3 + local_238[uVar11]);
        uVar11 = uVar11 + 1;
        lVar18 = lVar18 + 1;
        lVar14 = lVar14 + -1;
      } while (lVar14 != 0);
      if (iVar4 < 1) {
        *param_7 = -1;
      }
      else {
        *param_7 = ((int)uVar8 * 100) / iVar4;
      }
    }
    FUN_18001d45c(plVar10);
    FUN_18001d45c(puVar9);
  }
  else {
    if (param_4 != (int *)0x0) {
      *param_4 = 0;
    }
    if (param_5 != (int *)0x0) {
      *param_5 = 0;
    }
    if (param_6 != (undefined4 *)0x0) {
      *param_6 = 0;
    }
    if (param_7 != (int *)0x0) {
      *param_7 = 0;
    }
    if (param_8 != (int *)0x0) {
      *param_8 = 0;
    }
    if (param_9 != (uint *)0x0) {
      *param_9 = 0;
    }
  }
  FUN_18001d45c(puVar6);
  FUN_18001d45c(plVar7);
  FUN_18001d45c(puVar5);
  FUN_18001d530(local_58 ^ (ulonglong)auStackY_2c8);
  return;
}



int FUN_180008830(int param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  
  if (((param_2 != (int *)0x0) && (param_2[1] == 6)) && (*param_2 == 8)) {
    piVar9 = *(int **)(param_2 + 6);
    iVar1 = *piVar9;
    iVar2 = piVar9[2];
    iVar3 = piVar9[3];
    iVar4 = piVar9[6];
    iVar5 = piVar9[7];
    iVar6 = piVar9[5];
    iVar7 = piVar9[4];
    iVar8 = piVar9[1];
    if (-1 < param_1) {
      iVar11 = iVar1;
      if (iVar2 < 100) {
        iVar11 = (iVar1 * 100) / (100 - iVar2);
      }
      if (iVar2 + iVar8 < 100) {
        iVar10 = ((int)(iVar3 + (iVar3 >> 0x1f & 0x7fU)) >> 7) * (0x100 - iVar5) * iVar1;
        iVar10 = (((int)(iVar10 + (iVar10 >> 0x1f & 0xffffU)) >> 0x10) * 100) /
                 ((100 - iVar2) - iVar8);
      }
      else {
        iVar10 = 0;
      }
      if (param_1 == 0) {
        if (((((0xdf < iVar1) && (0x3e1c < iVar3)) && ((0x87 < iVar6 && (1 < iVar4)))) ||
            (((200 < iVar1 && (0x2e18 < iVar3)) && ((0xab < iVar6 && (iVar4 == 2)))))) ||
           ((((0x10 < iVar10 && (12000 < iVar3)) ||
             ((0xdc < iVar1 &&
              ((((9000 < iVar3 && (0x14 < iVar8)) && (0x77 < iVar6)) && (iVar5 < 0x78)))))) ||
            (((0xfa < iVar1 && (0x32 < iVar2)) && ((0x2cec < iVar3 && (0x96 < iVar6)))))))) {
          param_1 = 3;
        }
        if (((((0xcc < iVar1) && (0xe < iVar2)) &&
             ((0x2cec < iVar3 && ((0x50 < iVar7 && (0x99 < iVar6)))))) ||
            (((0x7d < iVar1 && (((0x1b < iVar2 && (0x283c < iVar3)) && (iVar7 < 0x25)))) &&
             (iVar4 < 3)))) ||
           ((((9000 < iVar3 && (iVar7 == 100)) && ((0x77 < iVar6 && (iVar5 < 0xa0)))) ||
            ((((0xaa < iVar1 && (0x2008 < iVar3)) && (0x19 < iVar2)) &&
             ((0x81 < iVar6 && (iVar4 == 2)))))))) {
          param_1 = 4;
        }
        if ((((100 < iVar1) && (0x32 < iVar2)) && (7000 < iVar3)) &&
           ((0x87 < iVar6 && (iVar4 == 2)))) {
          param_1 = 5;
        }
        if (((iVar10 - 0x1cU < 0x13) && (iVar1 < 0x8c)) && (iVar5 < 0x82)) {
          param_1 = 2;
        }
      }
      else if (param_1 == 2) {
        if (((((0xe8 < iVar1) && (0x31 < iVar8)) && (0x206c < iVar3)) &&
            ((0x8a < iVar6 && (2 < iVar4)))) ||
           (((0xdc < iVar1 && ((15000 < iVar3 && (0x96 < iVar6)))) && (1 < iVar4)))) {
          param_1 = 3;
        }
        if (((((((((0xa1 < iVar11) && (0x1b < iVar2)) && (0x1af4 < iVar3)) &&
                ((0x6b < iVar6 && (iVar4 == 2)))) && (0x8f < iVar5)) ||
              (((0xac < iVar1 && (0x1d < iVar2)) && ((10000 < iVar3 && (0x9a < iVar5)))))) ||
             ((((0x94 < iVar1 && (0x36 < iVar2)) && (0x238c < iVar3)) &&
              ((0x7d < iVar6 && (0xd0 < iVar5)))))) ||
            (((0xb4 < iVar1 &&
              (((0xf < iVar2 && (13000 < iVar3)) && ((200 < iVar6 && (iVar4 < 3)))))) ||
             ((((200 < iVar1 && (0x10 < iVar2)) && (0xa9 < iVar6)) && (iVar4 == 2)))))) ||
           ((((0x9f < iVar1 && (0x1d < iVar2)) && (0x96 < iVar6)) && (iVar4 == 2)))) {
          param_1 = 4;
        }
        if (((((((iVar4 == 0 && iVar6 == 0) && iVar7 == 0) && iVar3 == 0) && iVar2 == 0) &&
             iVar8 == 0) && iVar1 == 0) && (iVar5 == 0xfe)) {
          param_1 = 1;
        }
      }
      else if ((param_1 == 4) &&
              ((((0xf0 < iVar1 && (15000 < iVar3)) && (iVar2 < 0xf)) ||
               (((0xf9 < iVar1 && (15000 < iVar3)) && (iVar4 == 4)))))) {
        param_1 = 3;
      }
    }
  }
  return param_1;
}



int FUN_180008c40(undefined8 *param_1,int param_2,int param_3,int *param_4,int *param_5,
                 undefined *param_6,undefined *param_7)

{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  undefined8 uVar5;
  longlong lVar6;
  longlong lVar7;
  uint *puVar8;
  undefined *puVar9;
  int iVar10;
  uint uVar11;
  ulonglong uVar12;
  int iVar13;
  byte bVar14;
  int iVar16;
  int local_res10 [2];
  int local_res18 [4];
  byte in_stack_ffffffffffffff98;
  int local_38;
  int local_34;
  int local_30;
  uint local_2c;
  int *piVar15;
  
  uVar11 = 0;
  iVar16 = 0;
  iVar3 = 0;
  iVar2 = DAT_180047754 * DAT_180047794;
  uVar12 = (ulonglong)iVar2;
  piVar15 = param_4;
  local_res10[0] = param_2;
  local_res18[0] = param_3;
  pbVar4 = (byte *)FUN_18001ed60(uVar12);
  bVar14 = (byte)piVar15;
  if (pbVar4 == (byte *)0x0) {
    iVar3 = -1;
  }
  else {
    FUN_18001d560((undefined8 *)pbVar4,param_1,uVar12);
    uVar5 = FUN_1800080a0(pbVar4,DAT_180047754,DAT_180047794,bVar14,in_stack_ffffffffffffff98);
    if ((int)uVar5 < 1) {
      iVar3 = -2;
      iVar2 = local_res18[0];
    }
    else {
      iVar10 = 0;
      iVar13 = 0;
      iVar16 = 0;
      lVar7 = 0;
      if (1 < (longlong)uVar12) {
        iVar16 = (iVar2 - 2U & 0xfffffffe) + 2;
        lVar6 = lVar7;
        iVar13 = 0;
        do {
          lVar7 = lVar6 + 2;
          iVar10 = iVar10 + (uint)pbVar4[lVar6];
          iVar13 = iVar13 + (uint)pbVar4[lVar6 + 1];
          lVar6 = lVar7;
        } while (lVar7 < (longlong)(uVar12 - 1));
      }
      if (lVar7 < (longlong)uVar12) {
        uVar11 = (uint)pbVar4[lVar7];
        iVar16 = iVar16 + 1;
      }
      iVar16 = (int)(iVar13 + iVar10 + uVar11) / iVar16;
      iVar2 = FUN_180008400((undefined8 *)pbVar4,DAT_180047754,DAT_180047794,local_res18,local_res10
                            ,&local_38,&local_34,&local_30,&local_2c);
    }
    FUN_18001d45c(pbVar4);
    if (-1 < iVar3) {
      puVar8 = FUN_180016850();
      piVar15 = *(int **)(puVar8 + 6);
      puVar1 = *(undefined4 **)(puVar8 + 8);
      *piVar15 = iVar2;
      piVar15[1] = local_res18[0];
      piVar15[2] = local_res10[0];
      piVar15[3] = local_38;
      piVar15[4] = local_34;
      piVar15[5] = local_30;
      piVar15[6] = local_2c;
      piVar15[7] = iVar16;
      *puVar1 = 2;
      puVar1[1] = 3;
      puVar1[2] = 3;
      puVar1[3] = 0xfffffffb;
      puVar1[4] = 3;
      puVar1[5] = 2;
      puVar1[6] = 8;
      puVar1[7] = 2;
      puVar9 = &DAT_180048640;
      if (param_6 != (undefined *)0x0) {
        puVar9 = param_6;
      }
      *(undefined **)(puVar8 + 10) = puVar9;
      puVar9 = &DAT_180048830;
      if (param_7 != (undefined *)0x0) {
        puVar9 = param_7;
      }
      *(undefined **)(puVar8 + 0xc) = puVar9;
      uVar12 = FUN_180016680(puVar8);
      iVar3 = FUN_180008830((int)uVar12,(int *)puVar8);
      if (param_4 != (int *)0x0) {
        *param_4 = local_38;
      }
      if (param_5 != (int *)0x0) {
        *param_5 = iVar2;
      }
      if (*(LPVOID *)(puVar8 + 2) != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)(puVar8 + 2));
      }
      if (*(LPVOID *)(puVar8 + 6) != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)(puVar8 + 6));
      }
      if (*(LPVOID *)(puVar8 + 8) != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)(puVar8 + 8));
      }
      FUN_18001d45c(puVar8);
    }
  }
  return iVar3;
}



void FUN_180008eb0(longlong param_1,undefined8 param_2,char param_3)

{
  byte bVar1;
  byte *pbVar2;
  byte bVar3;
  byte *pbVar4;
  int iVar5;
  longlong lVar6;
  longlong lVar7;
  byte *pbVar8;
  longlong lVar9;
  byte bVar10;
  longlong lVar11;
  ulonglong uVar12;
  undefined8 *puVar13;
  byte local_res20 [8];
  byte local_38 [4];
  byte local_34;
  byte local_33;
  byte local_32;
  byte local_31;
  byte local_30;
  byte local_2f;
  byte local_2e;
  byte local_2d;
  byte local_2c;
  byte local_2b;
  byte local_2a;
  byte local_29;
  
  if (4 < (byte)(param_3 << 2)) {
    puVar13 = (undefined8 *)(param_1 + 0x20);
    uVar12 = (ulonglong)(((byte)(param_3 << 2) - 5 >> 2) + 1);
    do {
      lVar7 = 4;
      do {
        pbVar2 = (byte *)*puVar13;
        lVar11 = 0;
        pbVar8 = pbVar2;
        do {
          local_res20[0] = *pbVar8;
          lVar9 = 4;
          do {
            bVar1 = (&DAT_180036710)[lVar11];
            bVar10 = 0;
            bVar3 = bVar1;
            if ((local_res20[0] != 1) && (bVar3 = local_res20[0], bVar1 != 1)) {
              pbVar4 = local_res20;
              lVar6 = 7;
              do {
                bVar3 = *pbVar4;
                pbVar4 = pbVar4 + 1;
                if (bVar3 < 0x80) {
                  bVar3 = bVar3 * '\x02';
                }
                else {
                  bVar3 = bVar3 * '\x02' ^ 0x1b;
                }
                *pbVar4 = bVar3;
                lVar6 = lVar6 + -1;
              } while (lVar6 != 0);
              pbVar4 = local_res20;
              iVar5 = 0;
              do {
                if ((bVar1 >> ((byte)iVar5 & 0x1f) & 1) != 0) {
                  bVar10 = bVar10 ^ *pbVar4;
                }
                iVar5 = iVar5 + 1;
                pbVar4 = pbVar4 + 1;
                bVar3 = bVar10;
              } while (iVar5 < 8);
            }
            local_38[lVar11] = bVar3;
            lVar11 = lVar11 + 1;
            lVar9 = lVar9 + -1;
          } while (lVar9 != 0);
          pbVar8 = pbVar8 + 1;
        } while (lVar11 < 0x10);
        puVar13 = puVar13 + 1;
        *pbVar2 = local_38[0] ^ local_2c ^ local_30 ^ local_34;
        pbVar2[1] = local_33 ^ local_2f ^ local_2b ^ local_38[1];
        pbVar2[2] = local_32 ^ local_2e ^ local_2a ^ local_38[2];
        pbVar2[3] = local_31 ^ local_2d ^ local_29 ^ local_38[3];
        lVar7 = lVar7 + -1;
      } while (lVar7 != 0);
      uVar12 = uVar12 - 1;
    } while (uVar12 != 0);
  }
  return;
}



void FUN_180009050(longlong param_1,longlong *param_2,uint param_3,int param_4)

{
  undefined1 *puVar1;
  byte bVar2;
  undefined4 uVar3;
  ulonglong uVar4;
  undefined1 *puVar5;
  ulonglong uVar6;
  uint uVar7;
  int iVar8;
  ulonglong uVar9;
  longlong lVar10;
  longlong lVar11;
  longlong *plVar12;
  longlong *plVar13;
  undefined1 auStack_68 [32];
  int local_48;
  undefined4 local_44;
  ulonglong local_40;
  
  local_40 = DAT_1800461a0 ^ (ulonglong)auStack_68;
  uVar4 = ((ulonglong)param_3 & 0xff) >> 2;
  uVar7 = (uint)uVar4;
  uVar6 = 0x180000000;
  bVar2 = (&DAT_180037720)[((longlong)(int)(uVar7 / 2) + -2) * 3];
  if (uVar7 != 0) {
    puVar5 = (undefined1 *)(param_1 + 2);
    lVar10 = 0;
    do {
      lVar11 = lVar10 + 1;
      *(undefined1 *)param_2[lVar10] = puVar5[-2];
      *(undefined1 *)(param_2[lVar10] + 1) = puVar5[-1];
      *(undefined1 *)(param_2[lVar10] + 2) = *puVar5;
      uVar6 = param_2[lVar10];
      puVar1 = puVar5 + 1;
      puVar5 = puVar5 + 4;
      *(undefined1 *)(uVar6 + 3) = *puVar1;
      lVar10 = lVar11;
    } while (lVar11 < (longlong)uVar4);
  }
  uVar9 = (ulonglong)(int)((uint)bVar2 * 4 + 4);
  if (uVar4 < uVar9) {
    lVar10 = uVar9 - uVar4;
    uVar9 = uVar4;
    plVar12 = param_2;
    do {
      uVar3 = *(undefined4 *)plVar12[uVar4 - 1];
      iVar8 = (int)uVar9;
      local_44._0_1_ = (byte)uVar3;
      local_44._2_1_ = (byte)((uint)uVar3 >> 0x10);
      local_44._3_1_ = (byte)((uint)uVar3 >> 0x18);
      local_44._1_1_ = (byte)((uint)uVar3 >> 8);
      if (iVar8 % (int)uVar7 == 0) {
        uVar9 = (ulonglong)local_44._1_1_;
        uVar6 = (ulonglong)(byte)local_44;
        local_44._1_1_ = (&DAT_180037730)[local_44._2_1_];
        local_44._0_1_ =
             (&DAT_180037730)[uVar9] ^ (&DAT_1800355cc)[(longlong)(iVar8 / (int)uVar7) * 4];
        local_44._2_1_ = (&DAT_180037730)[local_44._3_1_];
        local_44._3_1_ = (&DAT_180037730)[uVar6];
      }
      else if ((6 < uVar7) && (iVar8 % (int)uVar7 == 4)) {
        local_44._0_1_ = (&DAT_180037730)[(byte)local_44];
        local_44._1_1_ = (&DAT_180037730)[local_44._1_1_];
        local_44._2_1_ = (&DAT_180037730)[local_44._2_1_];
        local_44._3_1_ = (&DAT_180037730)[local_44._3_1_];
      }
      uVar9 = (ulonglong)(iVar8 + 1);
      plVar13 = plVar12 + 1;
      *(byte *)plVar13[uVar4 - 1] = *(byte *)*plVar12 ^ (byte)local_44;
      *(byte *)(plVar13[uVar4 - 1] + 1) = *(byte *)(*plVar12 + 1) ^ local_44._1_1_;
      *(byte *)(plVar13[uVar4 - 1] + 2) = *(byte *)(*plVar12 + 2) ^ local_44._2_1_;
      local_44._3_1_ = *(byte *)(*plVar12 + 3) ^ local_44._3_1_;
      uVar6 = (ulonglong)local_44._3_1_;
      *(byte *)(plVar13[uVar4 - 1] + 3) = local_44._3_1_;
      lVar10 = lVar10 + -1;
      plVar12 = plVar13;
      local_44 = uVar3;
    } while (lVar10 != 0);
  }
  local_48 = param_4;
  if (param_4 != 0) {
    FUN_180008eb0((longlong)param_2,uVar6,bVar2);
  }
  FUN_18001d530(local_40 ^ (ulonglong)auStack_68);
  return;
}



void FUN_180009290(byte *param_1,longlong *param_2,int param_3,undefined8 param_4,undefined8 param_5
                  ,int param_6)

{
  char cVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong lVar6;
  longlong lVar7;
  byte *pbVar8;
  int iVar9;
  longlong lVar10;
  char *pcVar11;
  byte *pbVar12;
  byte *pbVar13;
  byte **ppbVar14;
  byte bVar15;
  longlong *plVar16;
  byte *pbVar17;
  ulonglong uVar18;
  byte local_88 [8];
  ulonglong local_80;
  longlong *local_78;
  longlong local_70;
  byte *local_68 [4];
  byte local_48 [16];
  ulonglong local_38;
  
  if (param_3 != 0) {
    local_38 = DAT_1800461a0 ^ (ulonglong)local_88;
    local_70 = -(longlong)local_48;
    local_88[0] = (char)param_6 << 2;
    local_80 = (ulonglong)((param_3 - 1U >> 4) + 1);
    do {
      uVar5 = 4;
      pbVar13 = &DAT_180035208;
      lVar10 = 4;
      plVar16 = param_2;
      do {
        bVar15 = *pbVar13;
        lVar7 = *plVar16;
        lVar6 = 4;
        pbVar12 = local_48 + bVar15;
        do {
          *pbVar12 = pbVar12[(lVar7 - (ulonglong)bVar15) - (longlong)local_48] ^
                     pbVar12[local_70 + (longlong)param_1];
          lVar6 = lVar6 + -1;
          pbVar12 = pbVar12 + 1;
        } while (lVar6 != 0);
        pbVar13 = pbVar13 + 1;
        plVar16 = plVar16 + 1;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      if (1 < param_6) {
        uVar18 = (ulonglong)(param_6 - 1);
        pbVar13 = local_48;
        pbVar12 = param_1;
        do {
          pbVar8 = pbVar13;
          iVar9 = 0;
          plVar16 = param_2 + uVar5;
          do {
            iVar3 = 0;
            pcVar11 = "";
            bVar15 = (char)iVar9 * '\x04';
            lVar10 = 0;
            ppbVar14 = local_68;
            do {
              cVar1 = *pcVar11;
              pcVar11 = pcVar11 + 1;
              cVar2 = (char)iVar3;
              iVar3 = iVar3 + 1;
              lVar7 = (ulonglong)pbVar8[(byte)(&DAT_180035670)[(byte)(cVar1 + cVar2 + bVar15)]] +
                      lVar10;
              lVar10 = lVar10 + 0x100;
              *ppbVar14 = &DAT_1800356f0 + lVar7 * 4;
              ppbVar14 = ppbVar14 + 1;
            } while (iVar3 < 4);
            pbVar13 = (byte *)*plVar16;
            iVar9 = iVar9 + 1;
            pbVar17 = pbVar12 + bVar15;
            plVar16 = plVar16 + 1;
            *pbVar17 = *local_68[0] ^ *local_68[1] ^ *local_68[2] ^ *pbVar13 ^ *local_68[3];
            pbVar17[1] = pbVar13[1] ^ local_68[0][1] ^ local_68[1][1] ^ local_68[2][1] ^
                         local_68[3][1];
            pbVar17[2] = pbVar13[2] ^ local_68[0][2] ^ local_68[1][2] ^ local_68[2][2] ^
                         local_68[3][2];
            pbVar17[3] = pbVar13[3] ^ local_68[0][3] ^ local_68[1][3] ^ local_68[2][3] ^
                         local_68[3][3];
          } while (iVar9 < 4);
          uVar5 = (ulonglong)(byte)((char)uVar5 + 4);
          uVar18 = uVar18 - 1;
          pbVar13 = pbVar12;
          pbVar12 = pbVar8;
        } while (uVar18 != 0);
      }
      pbVar13 = &DAT_180035208;
      lVar10 = 4;
      pbVar12 = &DAT_180035208;
      do {
        bVar15 = *pbVar12;
        iVar9 = 0;
        do {
          uVar4 = (uint)bVar15 + iVar9;
          iVar9 = iVar9 + 1;
          uVar4 = uVar4 & 0xff;
          local_48[uVar4] = (&DAT_180037730)[param_1[uVar4]];
        } while (iVar9 < 4);
        pbVar12 = pbVar12 + 1;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      iVar9 = 0;
      lVar10 = 0;
      do {
        uVar5 = (ulonglong)*pbVar13;
        lVar6 = 4;
        lVar7 = param_2[iVar9 + (uint)local_88[0] & 0xff];
        pbVar12 = param_1 + uVar5;
        do {
          *pbVar12 = local_48[pbVar12[(longlong)
                                      (&DAT_180035690 + ((lVar10 - uVar5) - (longlong)param_1))]] ^
                     pbVar12[(lVar7 - uVar5) - (longlong)param_1];
          lVar6 = lVar6 + -1;
          pbVar12 = pbVar12 + 1;
        } while (lVar6 != 0);
        iVar9 = iVar9 + 1;
        pbVar13 = pbVar13 + 1;
        lVar10 = lVar10 + 4;
      } while (iVar9 < 4);
      param_1 = param_1 + 0x10;
      local_80 = local_80 - 1;
    } while (local_80 != 0);
    local_78 = param_2;
    FUN_18001d530(local_38 ^ (ulonglong)local_88);
  }
  return;
}



void FUN_1800095c0(byte *param_1,longlong *param_2,int param_3,undefined8 param_4,undefined8 param_5
                  ,int param_6)

{
  char cVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  longlong lVar5;
  longlong lVar6;
  byte *pbVar7;
  longlong *plVar8;
  int iVar9;
  longlong lVar10;
  longlong lVar11;
  char *pcVar12;
  byte *pbVar13;
  byte *pbVar14;
  byte **ppbVar15;
  byte bVar16;
  byte *pbVar17;
  ulonglong uVar18;
  byte bVar19;
  byte local_88;
  byte local_87;
  ulonglong local_80;
  longlong *local_78;
  longlong local_70;
  byte *local_68 [4];
  byte local_48 [16];
  ulonglong local_38;
  
  if (param_3 != 0) {
    local_38 = DAT_1800461a0 ^ (ulonglong)&local_88;
    local_87 = ((char)param_6 + -1) * '\x04';
    local_70 = -(longlong)local_48;
    local_88 = (char)param_6 << 2;
    local_80 = (ulonglong)((param_3 - 1U >> 4) + 1);
    do {
      pbVar14 = &DAT_180035208;
      lVar10 = 4;
      plVar8 = param_2 + local_88;
      do {
        bVar19 = *pbVar14;
        lVar6 = *plVar8;
        lVar5 = 4;
        pbVar13 = local_48 + bVar19;
        do {
          *pbVar13 = pbVar13[(lVar6 - (ulonglong)bVar19) - (longlong)local_48] ^
                     (pbVar13 + 1)[(longlong)(param_1 + local_70 + -1)];
          lVar5 = lVar5 + -1;
          pbVar13 = pbVar13 + 1;
        } while (lVar5 != 0);
        plVar8 = plVar8 + 1;
        pbVar14 = pbVar14 + 1;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      if (1 < param_6) {
        uVar18 = (ulonglong)(param_6 - 1);
        pbVar14 = local_48;
        pbVar13 = param_1;
        bVar19 = local_87;
        do {
          pbVar7 = pbVar14;
          iVar9 = 0;
          plVar8 = param_2 + bVar19;
          do {
            iVar3 = 0;
            pcVar12 = "";
            bVar16 = (char)iVar9 * '\x04';
            lVar10 = 0;
            ppbVar15 = local_68;
            do {
              cVar2 = (char)iVar3;
              iVar3 = iVar3 + 1;
              cVar1 = *pcVar12;
              pcVar12 = pcVar12 + 1;
              lVar6 = (ulonglong)pbVar7[(byte)(&DAT_180035670)[(byte)(bVar16 + cVar2 + cVar1)]] +
                      lVar10;
              lVar10 = lVar10 + 0x100;
              *ppbVar15 = &DAT_180036720 + lVar6 * 4;
              ppbVar15 = ppbVar15 + 1;
            } while (iVar3 < 4);
            pbVar14 = (byte *)*plVar8;
            iVar9 = iVar9 + 1;
            pbVar17 = pbVar13 + bVar16;
            plVar8 = plVar8 + 1;
            *pbVar17 = *local_68[0] ^ *local_68[1] ^ *local_68[2] ^ *local_68[3] ^ *pbVar14;
            pbVar17[1] = pbVar14[1] ^ local_68[0][1] ^ local_68[1][1] ^ local_68[2][1] ^
                         local_68[3][1];
            pbVar17[2] = pbVar14[2] ^ local_68[0][2] ^ local_68[1][2] ^ local_68[2][2] ^
                         local_68[3][2];
            pbVar17[3] = pbVar14[3] ^ local_68[0][3] ^ local_68[1][3] ^ local_68[2][3] ^
                         local_68[3][3];
          } while (iVar9 < 4);
          bVar19 = bVar19 - 4;
          uVar18 = uVar18 - 1;
          pbVar14 = pbVar13;
          pbVar13 = pbVar7;
        } while (uVar18 != 0);
      }
      pbVar14 = &DAT_180035208;
      lVar10 = 4;
      pbVar13 = &DAT_180035208;
      do {
        bVar19 = *pbVar13;
        iVar9 = 0;
        do {
          uVar4 = (uint)bVar19 + iVar9;
          iVar9 = iVar9 + 1;
          uVar4 = uVar4 & 0xff;
          local_48[uVar4] = (&DAT_180037830)[param_1[uVar4]];
        } while (iVar9 < 4);
        pbVar13 = pbVar13 + 1;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      lVar6 = 0;
      lVar10 = 4;
      plVar8 = param_2;
      do {
        uVar18 = (ulonglong)*pbVar14;
        lVar5 = *plVar8;
        lVar11 = 4;
        pbVar13 = param_1 + uVar18;
        do {
          *pbVar13 = local_48[pbVar13[(longlong)
                                      (&DAT_180035610 + ((lVar6 - uVar18) - (longlong)param_1))]] ^
                     pbVar13[(lVar5 - uVar18) - (longlong)param_1];
          lVar11 = lVar11 + -1;
          pbVar13 = pbVar13 + 1;
        } while (lVar11 != 0);
        pbVar14 = pbVar14 + 1;
        plVar8 = plVar8 + 1;
        lVar6 = lVar6 + 4;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      param_1 = param_1 + 0x10;
      local_80 = local_80 - 1;
    } while (local_80 != 0);
    local_78 = param_2;
    FUN_18001d530(local_38 ^ (ulonglong)&local_88);
  }
  return;
}



void FUN_180009900(byte *param_1,longlong param_2,uint param_3,ulonglong param_4)

{
  byte bVar1;
  undefined1 *puVar2;
  longlong *plVar3;
  uint uVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  undefined1 auStackY_338 [32];
  undefined8 in_stack_fffffffffffffce8;
  longlong local_308 [60];
  undefined1 local_128 [240];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_338;
  bVar1 = (&DAT_180037720)[(((param_4 & 0xff) >> 3) - 2) * 3];
  FUN_18001dbc0((undefined1 (*) [16])local_128,0,0xf0);
  uVar4 = (uint)bVar1 * 4 + 4;
  uVar5 = (ulonglong)uVar4;
  if (uVar4 != 0) {
    plVar3 = local_308;
    puVar2 = local_128;
    do {
      *plVar3 = (longlong)puVar2;
      puVar2 = puVar2 + 4;
      plVar3 = plVar3 + 1;
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  uVar6 = 0;
  FUN_180009050(param_2,local_308,(uint)param_4 & 0xff,0);
  if ((param_3 & 0xf) != 0) {
    param_3 = param_3 & 0xfffffff0;
  }
  FUN_180009290(param_1,local_308,param_3,uVar6,in_stack_fffffffffffffce8,(uint)bVar1);
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_338);
  return;
}



void FUN_1800099e0(byte *param_1,longlong param_2,uint param_3,byte param_4)

{
  byte bVar1;
  undefined1 *puVar2;
  longlong *plVar3;
  uint uVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  undefined1 auStackY_338 [32];
  undefined8 in_stack_fffffffffffffce8;
  longlong local_308 [60];
  undefined1 local_128 [240];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_338;
  bVar1 = (&DAT_180037720)[((ulonglong)(param_4 >> 3) - 2) * 3];
  FUN_18001dbc0((undefined1 (*) [16])local_128,0,0xf0);
  uVar4 = (uint)bVar1 * 4 + 4;
  uVar5 = (ulonglong)uVar4;
  if (uVar4 != 0) {
    plVar3 = local_308;
    puVar2 = local_128;
    do {
      *plVar3 = (longlong)puVar2;
      puVar2 = puVar2 + 4;
      plVar3 = plVar3 + 1;
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  if ((param_3 & 0xf) != 0) {
    param_3 = param_3 & 0xfffffff0;
  }
  uVar6 = 1;
  FUN_180009050(param_2,local_308,(uint)param_4,1);
  FUN_1800095c0(param_1,local_308,param_3,uVar6,in_stack_fffffffffffffce8,(uint)bVar1);
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_338);
  return;
}



void FUN_180009ad0(int *param_1,int param_2,int param_3)

{
  int *piVar1;
  longlong lVar2;
  int iVar3;
  
  iVar3 = 0;
  if (0 < *param_1) {
    lVar2 = 0;
    do {
      iVar3 = iVar3 + 1;
      **(int **)(lVar2 + *(longlong *)(param_1 + 6)) =
           **(int **)(lVar2 + *(longlong *)(param_1 + 6)) - param_2;
      piVar1 = (int *)(*(longlong *)(lVar2 + *(longlong *)(param_1 + 6)) + 4);
      *piVar1 = *piVar1 - param_3;
      lVar2 = lVar2 + 8;
    } while (iVar3 < *param_1);
  }
  return;
}



ulonglong FUN_180009b20(int *param_1,int param_2)

{
  undefined4 *puVar1;
  short sVar2;
  undefined4 uVar3;
  ulonglong uVar4;
  int iVar5;
  int iVar6;
  LPVOID pvVar7;
  ulonglong uVar8;
  short sVar9;
  undefined4 *puVar10;
  int *piVar11;
  int *piVar12;
  longlong lVar13;
  int iVar14;
  longlong *plVar15;
  undefined4 *puVar16;
  int iVar17;
  int iVar18;
  int iVar19;
  int iVar20;
  longlong lVar21;
  longlong lVar22;
  int local_res10;
  
  iVar20 = param_2 + 0x168;
  pvVar7 = FUN_18001ee18((longlong)iVar20,4);
  lVar22 = (longlong)*param_1;
  lVar13 = (longlong)(param_2 / 2);
  iVar5 = 0;
  puVar1 = (undefined4 *)((longlong)pvVar7 + lVar13 * 4);
  local_res10 = 0;
  if (0 < lVar22) {
    plVar15 = *(longlong **)(param_1 + 10);
    lVar21 = *(longlong *)(param_1 + 8) - (longlong)plVar15;
    piVar12 = *(int **)(param_1 + 2);
    do {
      sVar2 = *(short *)(*(longlong *)(lVar21 + (longlong)plVar15) + 0xe);
      sVar9 = *(short *)(*plVar15 + 0xe);
      if (sVar9 < sVar2) {
        sVar9 = (sVar9 - sVar2) + 0x168;
      }
      else {
        sVar9 = sVar9 - sVar2;
      }
      plVar15 = plVar15 + 1;
      puVar1[sVar9] =
           puVar1[sVar9] + ((int)((0x80 - *piVar12) + (0x80 - *piVar12 >> 0x1f & 0xfU)) >> 4) + 1;
      lVar22 = lVar22 + -1;
      piVar12 = piVar12 + 1;
    } while (lVar22 != 0);
  }
  if (0 < lVar13) {
    puVar16 = puVar1 + 0x167;
    lVar22 = 0;
    puVar10 = puVar1;
    do {
      puVar10 = puVar10 + -1;
      lVar21 = lVar22 + 1;
      puVar1[lVar22 + 0x168] = puVar1[lVar22];
      uVar3 = *puVar16;
      puVar16 = puVar16 + -1;
      *puVar10 = uVar3;
      lVar22 = lVar21;
    } while (lVar21 < lVar13);
  }
  iVar14 = 0;
  iVar6 = -(param_2 / 2);
  iVar18 = iVar6 - param_2;
  if (0 < iVar20) {
    piVar12 = puVar1 + iVar6;
    piVar11 = puVar1 + iVar18;
    iVar17 = iVar5;
    iVar19 = iVar5;
    do {
      if (param_2 <= iVar14) {
        iVar17 = iVar17 - *piVar11;
        iVar19 = iVar19 - *piVar11 * iVar18;
      }
      iVar17 = iVar17 + *piVar12;
      iVar19 = iVar19 + (iVar6 + iVar14) * *piVar12;
      if (iVar5 < iVar17) {
        iVar5 = iVar17;
        local_res10 = iVar19;
      }
      iVar14 = iVar14 + 1;
      piVar12 = piVar12 + 1;
      iVar18 = iVar18 + 1;
      piVar11 = piVar11 + 1;
    } while (iVar14 < iVar20);
  }
  FUN_18001d45c(pvVar7);
  if (iVar5 == 0) {
    uVar8 = 0;
  }
  else {
    uVar4 = (longlong)(iVar5 / 2 + local_res10) / (longlong)iVar5;
    uVar8 = uVar4 & 0xffffffff;
    iVar5 = (int)uVar4;
    if (0x167 < iVar5) {
      uVar8 = (ulonglong)(iVar5 - 0x168);
    }
    if ((int)uVar8 < 0) {
      uVar8 = (ulonglong)((int)uVar8 + 0x168);
    }
  }
  return uVar8;
}



int FUN_180009cd0(uint *param_1,int param_2,int param_3)

{
  short sVar1;
  short *psVar2;
  short *psVar3;
  short sVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  LPVOID pvVar8;
  longlong lVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int *piVar13;
  longlong lVar14;
  ulonglong uVar15;
  ulonglong uVar16;
  int iVar17;
  uint uVar18;
  int local_res8;
  int local_res18;
  
  uVar18 = *param_1;
  piVar7 = (int *)FUN_18001ed60((longlong)(int)uVar18 << 2);
  iVar12 = 0x1000;
  iVar6 = -0x1000;
  iVar17 = 0;
  iVar11 = 0;
  local_res8 = 0;
  iVar10 = 0;
  local_res18 = 0x1000;
  if (0 < (int)uVar18) {
    lVar9 = *(longlong *)(param_1 + 2);
    uVar16 = (ulonglong)uVar18;
    lVar14 = 0;
    piVar13 = piVar7;
    iVar12 = 0x1000;
    do {
      if ((*(uint *)((lVar9 - (longlong)piVar7) + (longlong)piVar13) & 0x8000) == 0) {
        psVar2 = *(short **)(lVar14 + *(longlong *)(param_1 + 8));
        psVar3 = *(short **)(lVar14 + *(longlong *)(param_1 + 10));
        if (param_2 == 0xe) {
          sVar1 = psVar2[7];
          sVar4 = psVar3[7];
          if (sVar4 < sVar1) {
            sVar4 = (sVar4 - sVar1) + 0x168;
          }
          else {
            sVar4 = sVar4 - sVar1;
          }
        }
        else if (param_2 == 0) {
          sVar4 = *psVar3 - *psVar2;
        }
        else {
          sVar4 = psVar3[2] - psVar2[2];
        }
        iVar5 = (int)sVar4;
        *piVar13 = iVar5;
        if (iVar6 < iVar5) {
          iVar6 = iVar5;
        }
        iVar12 = local_res18;
        if (iVar5 < local_res18) {
          local_res18 = iVar5;
          iVar12 = iVar5;
        }
      }
      lVar14 = lVar14 + 8;
      piVar13 = piVar13 + 1;
      uVar16 = uVar16 - 1;
    } while (uVar16 != 0);
    uVar18 = *param_1;
  }
  uVar16 = (ulonglong)((iVar6 - iVar12) + 1);
  pvVar8 = FUN_18001ee18(uVar16,4);
  if (0 < (int)uVar18) {
    lVar9 = *(longlong *)(param_1 + 2);
    uVar15 = (ulonglong)uVar18;
    lVar14 = 0;
    do {
      if ((*(uint *)(lVar14 + lVar9) >> 0xf & 1) == 0) {
        piVar13 = (int *)((longlong)pvVar8 +
                         ((longlong)*(int *)(lVar14 + (longlong)piVar7) - (longlong)local_res18) * 4
                         );
        iVar6 = 0x80 - *(uint *)(lVar14 + lVar9);
        *piVar13 = *piVar13 + ((int)(iVar6 + (iVar6 >> 0x1f & 0xfU)) >> 4) + 1;
      }
      lVar14 = lVar14 + 4;
      uVar15 = uVar15 - 1;
    } while (uVar15 != 0);
  }
  iVar6 = -param_3;
  iVar12 = 0;
  lVar9 = 0;
  if (0 < (longlong)uVar16) {
    lVar14 = (longlong)iVar6;
    do {
      if (-1 < iVar6) {
        iVar5 = *(int *)((longlong)pvVar8 + lVar14 * 4);
        iVar11 = iVar11 - iVar5;
        iVar10 = iVar10 - iVar5 * iVar6;
        if ((iVar11 == 0) && (*(int *)((longlong)pvVar8 + lVar9 * 4) == 0)) {
          for (; (lVar9 < (longlong)uVar16 && (*(int *)((longlong)pvVar8 + lVar9 * 4) < 1));
              lVar9 = lVar9 + 1) {
            iVar12 = iVar12 + 1;
            iVar6 = iVar6 + 1;
            lVar14 = lVar14 + 1;
          }
        }
      }
      iVar5 = *(int *)((longlong)pvVar8 + lVar9 * 4);
      iVar11 = iVar11 + iVar5;
      iVar10 = iVar10 + iVar5 * iVar12;
      if (iVar17 < iVar11) {
        iVar17 = iVar11;
        local_res8 = iVar10;
      }
      lVar9 = lVar9 + 1;
      iVar12 = iVar12 + 1;
      iVar6 = iVar6 + 1;
      lVar14 = lVar14 + 1;
    } while (lVar9 < (longlong)uVar16);
  }
  FUN_18001d45c(pvVar8);
  FUN_18001d45c(piVar7);
  if (iVar17 == 0) {
    return 0;
  }
  return (iVar17 / 2 + local_res8) / iVar17 + local_res18;
}



int FUN_180009f10(uint *param_1,int param_2)

{
  uint uVar1;
  ushort uVar2;
  short sVar3;
  short sVar4;
  int iVar5;
  ulonglong uVar6;
  int iVar7;
  longlong *plVar8;
  longlong lVar9;
  ulonglong uVar10;
  longlong lVar11;
  
  iVar7 = 0;
  uVar6 = FUN_180009b20((int *)param_1,param_2);
  uVar1 = *param_1;
  if (0 < (int)uVar1) {
    plVar8 = *(longlong **)(param_1 + 10);
    lVar9 = 0;
    uVar10 = (ulonglong)uVar1;
    lVar11 = *(longlong *)(param_1 + 8) - (longlong)plVar8;
    do {
      sVar4 = *(short *)(*(longlong *)(lVar11 + (longlong)plVar8) + 0xe);
      sVar3 = *(short *)(*plVar8 + 0xe);
      if (sVar3 < sVar4) {
        sVar3 = (sVar3 - sVar4) + 0x168;
      }
      else {
        sVar3 = sVar3 - sVar4;
      }
      iVar5 = (int)(short)uVar6 - (int)sVar3;
      uVar2 = (ushort)(iVar5 >> 0x1f);
      sVar4 = ((ushort)iVar5 ^ uVar2) - uVar2;
      if (0xb4 < sVar4) {
        sVar4 = 0x168 - sVar4;
      }
      if (param_2 < sVar4) {
        *(uint *)(lVar9 + *(longlong *)(param_1 + 2)) =
             *(uint *)(lVar9 + *(longlong *)(param_1 + 2)) | 0x8000;
        iVar7 = iVar7 + 1;
      }
      plVar8 = plVar8 + 1;
      lVar9 = lVar9 + 4;
      uVar10 = uVar10 - 1;
    } while (uVar10 != 0);
  }
  *(short *)(param_1 + 5) = (short)uVar6;
  return uVar1 - iVar7;
}



void FUN_180009ff0(int *param_1,longlong param_2,int param_3,longlong param_4,int param_5,
                  int param_6)

{
  int iVar1;
  int iVar2;
  longlong *plVar3;
  longlong lVar4;
  longlong lVar5;
  
  iVar1 = *param_1;
  lVar4 = (longlong)iVar1;
  iVar2 = 0;
  if (0 < iVar1) {
    plVar3 = *(longlong **)(param_1 + 10);
    do {
      if (*plVar3 == *(longlong *)(*(longlong *)(param_4 + 0x18) + (longlong)param_5 * 8)) {
        if (-1 < iVar2) {
          lVar5 = (longlong)iVar2;
          lVar4 = *(longlong *)(param_1 + 2);
          if (*(int *)(lVar4 + lVar5 * 4) <= param_6) {
            return;
          }
          *(undefined8 *)(*(longlong *)(param_1 + 8) + lVar5 * 8) =
               *(undefined8 *)(*(longlong *)(param_2 + 0x18) + (longlong)param_3 * 8);
          *(int *)(lVar4 + lVar5 * 4) = param_6;
          return;
        }
        break;
      }
      iVar2 = iVar2 + 1;
      plVar3 = plVar3 + 1;
    } while (iVar2 < iVar1);
  }
  *(undefined8 *)(*(longlong *)(param_1 + 8) + lVar4 * 8) =
       *(undefined8 *)(*(longlong *)(param_2 + 0x18) + (longlong)param_3 * 8);
  *(undefined8 *)(*(longlong *)(param_1 + 10) + lVar4 * 8) =
       *(undefined8 *)(*(longlong *)(param_4 + 0x18) + (longlong)param_5 * 8);
  *(int *)(*(longlong *)(param_1 + 2) + lVar4 * 4) = param_6;
  *param_1 = iVar1 + 1;
  return;
}



int * FUN_18000a0b0(int *param_1,int *param_2,int param_3,int *param_4)

{
  int *piVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  short sVar6;
  int *piVar7;
  short sVar8;
  
  piVar5 = (int *)0x0;
  sVar8 = 0x168;
  piVar7 = piVar5;
  if (0 < (longlong)*param_1) {
    do {
      piVar1 = *(int **)(*(longlong *)(param_1 + 6) + (longlong)piVar7 * 8);
      if (((-1 < *(short *)((longlong)piVar1 + 0xe)) &&
          (iVar3 = (piVar1[1] - param_2[1]) * (piVar1[1] - param_2[1]), iVar3 < param_3)) &&
         (iVar3 = iVar3 + (*piVar1 - *param_2) * (*piVar1 - *param_2), iVar3 <= param_3)) {
        iVar4 = (int)*(short *)((longlong)piVar1 + 0xe) - (int)*(short *)((longlong)param_2 + 0xe);
        uVar2 = (ushort)(iVar4 >> 0x1f);
        sVar6 = ((ushort)iVar4 ^ uVar2) - uVar2;
        if (0xb4 < sVar6) {
          sVar6 = 0x168 - sVar6;
        }
        if ((iVar3 != param_3) || (sVar6 <= sVar8)) {
          piVar5 = piVar1;
          param_3 = iVar3;
          sVar8 = sVar6;
        }
      }
      piVar7 = (int *)((longlong)piVar7 + 1);
    } while ((longlong)piVar7 < (longlong)*param_1);
  }
  if (param_4 != (int *)0x0) {
    *param_4 = param_3;
  }
  return piVar5;
}



void FUN_18000a1b0(int *param_1,short param_2)

{
  ushort uVar1;
  ushort uVar2;
  int *piVar3;
  short sVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  longlong *plVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  uint uVar15;
  int iVar16;
  uint uVar17;
  
  uVar1 = *(ushort *)(param_1 + 1);
  uVar2 = *(ushort *)((longlong)param_1 + 6);
  iVar9 = 0;
  uVar5 = ((uint)uVar1 * 0x400) / 2;
  uVar6 = ((uint)uVar2 * 0x400) / 2;
  if (param_2 == 0) {
    sVar4 = 0;
  }
  else {
    sVar4 = param_2;
    if (param_2 < 1) {
      sVar4 = param_2 + 0x168;
    }
    sVar4 = 0x168 - sVar4;
  }
  plVar10 = *(longlong **)(param_1 + 6);
  iVar14 = (uint)(0 < *(int *)(&DAT_18003f060 + (longlong)sVar4 * 4)) +
           *(int *)(&DAT_18003f060 + (longlong)sVar4 * 4) + 0x1f;
  uVar15 = iVar14 >> 6;
  iVar16 = (uint)(0 < *(int *)(&DAT_18003eac0 + (longlong)sVar4 * 4)) +
           *(int *)(&DAT_18003eac0 + (longlong)sVar4 * 4) + 0x1f;
  uVar7 = iVar14 >> 0x1f;
  uVar17 = iVar16 >> 6;
  iVar14 = ((uVar15 ^ uVar7) - uVar7) + -0x400;
  uVar7 = iVar16 >> 0x1f;
  iVar11 = (uVar17 ^ uVar7) - uVar7;
  iVar16 = (int)(iVar11 * (uint)uVar2 + iVar14 * (uint)uVar1) / 2;
  iVar14 = (int)(iVar11 * (uint)uVar1 + iVar14 * (uint)uVar2) / 2;
  if ((param_2 != 0) && (0 < *param_1)) {
    do {
      piVar3 = (int *)*plVar10;
      iVar12 = piVar3[1] * 0x400 - uVar6;
      iVar13 = *piVar3 * 0x400 - uVar5;
      iVar11 = iVar13 * uVar15;
      iVar8 = iVar12 * uVar17;
      iVar12 = iVar12 * uVar15;
      iVar13 = iVar13 * uVar17;
      iVar8 = ((int)((((0 < iVar11 - iVar8) + 0x1ff) - iVar8) + iVar11) >> 10) + uVar5;
      iVar11 = ((int)((0 < iVar13 + iVar12) + 0x1ff + iVar13 + iVar12) >> 10) + uVar6;
      *piVar3 = (int)((uint)(0 < iVar8 + iVar16) + iVar8 + 0x1ff + iVar16) >> 10;
      *(int *)(*plVar10 + 4) = (int)((0 < iVar11 + iVar14) + 0x1ff + iVar11 + iVar14) >> 10;
      sVar4 = *(short *)(*plVar10 + 0xe) - param_2;
      if (sVar4 < 0) {
        sVar4 = sVar4 + 0x168;
      }
      else if (0x167 < sVar4) {
        sVar4 = sVar4 + -0x168;
      }
      iVar9 = iVar9 + 1;
      *(short *)(*plVar10 + 0xe) = sVar4;
      plVar10 = plVar10 + 1;
    } while (iVar9 < *param_1);
  }
  return;
}



void FUN_18000a3c0(longlong *param_1,ulonglong param_2,int param_3,int param_4,longlong param_5)

{
  int *piVar1;
  
  if (*param_1 == 0) {
    piVar1 = FUN_18000f3c0(param_3,param_4);
    *param_1 = (longlong)piVar1;
    piVar1 = FUN_18000f3c0(param_3,param_4);
    param_1[1] = (longlong)piVar1;
    piVar1 = FUN_18000f3c0(param_3,param_4);
    param_1[2] = (longlong)piVar1;
    FUN_180013690(**(ulonglong **)(*param_1 + 8),param_2,param_3 * param_4);
    if (*(int *)(param_5 + 0x28) == 1) {
      FUN_18000fc20((int *)*param_1,param_1[1],param_1[2]);
    }
    else if (*(int *)(param_5 + 0x28) == 2) {
      FUN_18000fde0((uint *)*param_1,param_1[1],param_1[2]);
    }
  }
  return;
}



void FUN_18000a470(int param_1,int param_2,int *param_3,int *param_4,int param_5,int param_6,
                  int param_7,int param_8,int param_9)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  short sVar6;
  int iVar7;
  uint uVar8;
  
  if (param_7 == 0) {
    sVar6 = 0;
  }
  else {
    if (param_7 < 1) {
      param_7 = param_7 + 0x168;
    }
    sVar6 = 0x168 - (short)param_7;
  }
  iVar7 = (uint)(0 < *(int *)(&DAT_18003f060 + (longlong)sVar6 * 4)) +
          *(int *)(&DAT_18003f060 + (longlong)sVar6 * 4) + 0x1f;
  uVar8 = iVar7 >> 6;
  iVar3 = (uint)(0 < *(int *)(&DAT_18003eac0 + (longlong)sVar6 * 4)) +
          *(int *)(&DAT_18003eac0 + (longlong)sVar6 * 4) + 0x1f;
  uVar4 = iVar3 >> 6;
  uVar1 = iVar7 >> 0x1f;
  iVar7 = ((uVar8 ^ uVar1) - uVar1) + -0x400;
  uVar1 = iVar3 >> 0x1f;
  iVar5 = (uVar4 ^ uVar1) - uVar1;
  iVar2 = ((param_1 + param_5) * 0x400 - (iVar5 * param_9 + iVar7 * param_8) / 2) + param_8 * -0x200
  ;
  iVar3 = iVar2 * uVar8;
  iVar5 = ((param_2 + param_6) * 0x400 - (iVar7 * param_9 + iVar5 * param_8) / 2) + param_9 * -0x200
  ;
  iVar7 = iVar5 * uVar4;
  iVar7 = (int)((uint)(0 < iVar3 + iVar7) + iVar3 + 0x1ff + iVar7) >> 10;
  iVar5 = iVar5 * uVar8;
  iVar2 = iVar2 * uVar4;
  *param_3 = (int)((0 < iVar7 + param_8 * 0x200) + 0x1ff + iVar7 + param_8 * 0x200) >> 10;
  iVar7 = (int)((((0 < iVar5 - iVar2) + 0x1ff) - iVar2) + iVar5) >> 10;
  *param_4 = (int)((0 < iVar7 + param_9 * 0x200) + 0x1ff + iVar7 + param_9 * 0x200) >> 10;
  return;
}



longlong FUN_18000a610(uint *param_1,int *param_2,char *param_3)

{
  longlong lVar1;
  longlong *plVar2;
  longlong lVar3;
  int iVar4;
  ulonglong uVar5;
  longlong lVar6;
  uint uVar7;
  char *pcVar8;
  longlong *plVar9;
  
  plVar9 = *(longlong **)(param_1 + 6);
  lVar6 = 0;
  uVar7 = 0x2000;
  if (0 < (int)*param_1) {
    uVar5 = (ulonglong)*param_1;
    pcVar8 = param_3;
    do {
      lVar1 = *plVar9;
      if ((-1 < *(short *)(lVar1 + 0xe)) && ((param_3 == (char *)0x0 || (*pcVar8 == '\0')))) {
        iVar4 = 0;
        lVar3 = 0;
        if (0 < *param_2) {
          plVar2 = *(longlong **)(param_2 + 10);
          do {
            if (*plVar2 == lVar1) {
              if (-1 < iVar4) goto LAB_18000a68e;
              break;
            }
            lVar3 = lVar3 + 1;
            iVar4 = iVar4 + 1;
            plVar2 = plVar2 + 1;
          } while (lVar3 < *param_2);
        }
        if (*(uint *)(lVar1 + 8) < uVar7) {
          lVar6 = lVar1;
          uVar7 = *(uint *)(lVar1 + 8);
        }
      }
LAB_18000a68e:
      pcVar8 = pcVar8 + 1;
      plVar9 = plVar9 + 1;
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  return lVar6;
}



undefined8
FUN_18000a6c0(int *param_1,uint *param_2,undefined8 *param_3,int *param_4,int param_5,int param_6,
             char *param_7,longlong param_8)

{
  char cVar1;
  ushort uVar2;
  int iVar3;
  int *piVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  char *pcVar8;
  int *piVar9;
  int *piVar10;
  short sVar11;
  longlong *plVar12;
  ulonglong *puVar13;
  int iVar14;
  char *pcVar15;
  longlong lVar16;
  longlong lVar17;
  char cVar18;
  char local_78;
  int local_74;
  longlong local_68;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  int local_48;
  char *local_40;
  
  uVar5 = param_2[1];
  iVar14 = *param_1;
  uVar2 = *(ushort *)((longlong)param_2 + 6);
  iVar6 = *(int *)(param_8 + 0x10) * 0x16a0a;
  piVar10 = (int *)0x0;
  local_4c = (int)((uint)(0 < iVar6) + iVar6 + 0x7fff) >> 0x10;
  local_48 = (int)((uint)(byte)param_2[2] * 0xa2 + 7) >> 3;
  pcVar8 = (char *)FUN_18001ee18((longlong)iVar14,1);
  cVar18 = '\0';
  iVar6 = 0;
  local_78 = '\0';
  local_40 = pcVar8;
  if (0 < iVar14) {
    lVar16 = 0;
    pcVar15 = pcVar8;
    do {
      if (*(short *)(*(longlong *)(lVar16 + *(longlong *)(param_1 + 6)) + 0xe) < 0) {
        *pcVar15 = '\x01';
      }
      else {
        cVar1 = *(char *)(*(longlong *)(lVar16 + *(longlong *)(param_1 + 6)) + 0xd);
        if (cVar18 < cVar1) {
          cVar18 = cVar1;
        }
      }
      iVar6 = iVar6 + 1;
      pcVar15 = pcVar15 + 1;
      lVar16 = lVar16 + 8;
      local_78 = cVar18;
    } while (iVar6 < *param_1);
  }
  do {
    if (local_78 < '\0') {
      FUN_18001d45c(pcVar8);
      return 0;
    }
    local_74 = 0;
    pcVar15 = pcVar8;
    if (0 < *param_1) {
      local_68 = 0;
      do {
        lVar16 = (longlong)param_6;
        piVar4 = *(int **)(local_68 + *(longlong *)(param_1 + 6));
        if ((*pcVar8 == '\0') && (local_78 <= *(char *)((longlong)piVar4 + 0xd))) {
          iVar14 = *param_4;
          iVar6 = 0;
          *pcVar8 = '\x01';
          if (0 < iVar14) {
            lVar17 = 0;
            do {
              iVar3 = **(int **)(lVar17 + *(longlong *)(param_4 + 8));
              iVar7 = iVar3 - *piVar4;
              if (iVar7 < 0) {
                iVar7 = *piVar4 - iVar3;
              }
              if (iVar7 < 10) {
                iVar3 = (*(int **)(lVar17 + *(longlong *)(param_4 + 8)))[1];
                iVar7 = iVar3 - piVar4[1];
                if (iVar7 < 0) {
                  iVar7 = piVar4[1] - iVar3;
                }
                if (iVar7 < 10) {
                  if (-1 < iVar6) goto LAB_18000aaee;
                  break;
                }
              }
              iVar6 = iVar6 + 1;
              lVar17 = lVar17 + 8;
            } while (iVar6 < iVar14);
          }
          piVar9 = FUN_18000a0b0((int *)param_2,piVar4,0x24,&local_54);
          iVar14 = 0;
          if (0 < *param_4) {
            plVar12 = *(longlong **)(param_4 + 10);
            do {
              if ((int *)*plVar12 == piVar9) {
                if (-1 < iVar14) goto LAB_18000aaee;
                break;
              }
              iVar14 = iVar14 + 1;
              plVar12 = plVar12 + 1;
            } while (iVar14 < *param_4);
          }
          if (local_54 < 10) {
            iVar14 = 0;
            if (0 < lVar16) {
              puVar13 = (ulonglong *)(piVar4 + 4);
              do {
                iVar14 = iVar14 + (int)POPCOUNT(*(ulonglong *)
                                                 ((longlong)piVar9 + (0x10 - (longlong)(piVar4 + 4))
                                                 + (longlong)puVar13) ^ *puVar13);
                lVar16 = lVar16 + -1;
                puVar13 = puVar13 + 1;
              } while (lVar16 != 0);
            }
            if (param_5 < iVar14) goto LAB_18000a917;
LAB_18000aa93:
            iVar6 = *param_4;
            lVar16 = (longlong)iVar6;
            piVar10 = (int *)0x0;
            *(int **)(*(longlong *)(param_4 + 8) + lVar16 * 8) = piVar4;
            *(int **)(*(longlong *)(param_4 + 10) + lVar16 * 8) = piVar9;
            *(int *)(*(longlong *)(param_4 + 2) + lVar16 * 4) = iVar14;
            iVar6 = iVar6 + 1;
            *param_4 = iVar6;
            pcVar15 = local_40;
            if ((int)*param_2 <= iVar6) break;
          }
          else {
LAB_18000a917:
            iVar14 = param_4[5];
            FUN_18000a470(*piVar4,piVar4[1],&local_58,&local_50,
                          (int)*(short *)((longlong)param_4 + 0x16),(int)(short)param_4[6],
                          (int)(short)iVar14,(uint)(ushort)uVar5,(uint)uVar2);
            iVar3 = local_50;
            iVar6 = local_58;
            if ((((local_4c <= local_58) && (local_4c <= local_50)) &&
                (local_58 <= (int)((uint)(ushort)uVar5 - local_4c))) &&
               (local_50 <= (int)((uint)uVar2 - local_4c))) {
              if ((piVar10 == (int *)0x0) &&
                 (piVar10 = (int *)FUN_18000a610(param_2,param_4,param_7), pcVar15 = local_40,
                 piVar10 == (int *)0x0)) break;
              FUN_18001dbc0((undefined1 (*) [16])(piVar10 + 4),0,(longlong)local_48);
              sVar11 = *(short *)((longlong)piVar4 + 0xe) + (short)iVar14;
              if (sVar11 < 0) {
                sVar11 = sVar11 + 0x168;
              }
              else if (0x167 < sVar11) {
                sVar11 = sVar11 + -0x168;
              }
              *(short *)((longlong)piVar10 + 0xe) = sVar11;
              FUN_180015b70((longlong)piVar10,param_3,iVar6 << 0x10,iVar3 << 0x10,param_8);
              lVar16 = (longlong)param_6;
              iVar14 = 0;
              if (0 < lVar16) {
                puVar13 = (ulonglong *)(piVar4 + 4);
                do {
                  iVar14 = iVar14 + (int)POPCOUNT(*(ulonglong *)
                                                   (((longlong)(piVar10 + 4) -
                                                    (longlong)(piVar4 + 4)) + (longlong)puVar13) ^
                                                  *puVar13);
                  lVar16 = lVar16 + -1;
                  puVar13 = puVar13 + 1;
                } while (lVar16 != 0);
              }
              if (iVar14 <= param_5) {
                *piVar10 = *piVar4;
                piVar10[1] = piVar4[1];
                piVar10[2] = piVar4[2];
                piVar9 = piVar10;
                goto LAB_18000aa93;
              }
            }
          }
        }
LAB_18000aaee:
        local_74 = local_74 + 1;
        local_68 = local_68 + 8;
        pcVar8 = pcVar8 + 1;
        pcVar15 = local_40;
      } while (local_74 < *param_1);
    }
    pcVar8 = pcVar15;
    local_78 = local_78 + -1;
  } while( true );
}



int FUN_18000ab80(uint *param_1,uint *param_2,longlong param_3,undefined8 *param_4,int param_5,
                 char *param_6,longlong *param_7)

{
  int iVar1;
  short *psVar2;
  short *psVar3;
  ushort uVar4;
  bool bVar5;
  ulonglong uVar6;
  short sVar7;
  int iVar8;
  uint uVar9;
  undefined8 uVar10;
  longlong *plVar11;
  int *piVar12;
  longlong *plVar13;
  LPVOID pvVar14;
  uint uVar15;
  uint uVar16;
  char *pcVar17;
  ulonglong *puVar18;
  longlong lVar19;
  uint uVar20;
  int *piVar21;
  uint uVar22;
  int iVar23;
  ulonglong uVar24;
  ulonglong uVar25;
  ulonglong uVar26;
  longlong lVar27;
  ulonglong uVar28;
  uint *puVar29;
  uint *puVar30;
  longlong *plVar31;
  ulonglong *puVar32;
  uint uVar33;
  ulonglong uVar34;
  ulonglong uVar35;
  int local_118;
  uint local_114;
  uint local_108;
  uint local_104;
  uint local_100;
  undefined4 uStack_fc;
  uint *puStack_f8;
  undefined4 local_f0;
  short sStack_ec;
  short sStack_ea;
  short sStack_e8;
  undefined6 uStack_e6;
  longlong *local_e0;
  longlong *plStack_d8;
  short local_d0;
  short sStack_ce;
  undefined4 uStack_cc;
  int local_c8;
  int local_c4;
  int local_c0;
  longlong local_b8;
  int local_b0;
  longlong local_a8;
  ulonglong local_a0;
  int local_98;
  uint local_90 [2];
  uint *local_88;
  LPVOID local_70;
  longlong *local_68;
  longlong *local_58;
  
  uVar22 = *param_2;
  uVar15 = *param_1;
  local_98 = *(int *)(param_3 + 0x40);
  uVar16 = uVar15;
  if ((int)uVar22 < (int)uVar15) {
    uVar16 = uVar22;
  }
  local_118 = 0;
  if (((int)uVar22 < 1) || ((int)uVar15 < 1)) {
    if (param_4 != (undefined8 *)0x0) {
      *(undefined4 *)param_4 = 0;
    }
    return 0;
  }
  if (param_5 == 0) {
    local_b0 = *(int *)(param_3 + 0x48);
    if ((byte)param_2[2] < 3) {
      iVar23 = 3;
      if (1 < (byte)param_2[2]) {
        iVar23 = 6;
      }
    }
    else {
      iVar23 = 8;
    }
    local_c0 = 0x80;
  }
  else {
    local_c0 = 0x20;
    local_b0 = (int)((*(int *)(param_3 + 0x48) >> 0x1f & 3U) + *(int *)(param_3 + 0x48)) >> 2;
    iVar23 = (1 < (byte)param_2[2]) + 1;
  }
  iVar8 = *(int *)(param_3 + 0x44) * local_b0 + 0x200;
  local_c8 = (int)(iVar8 + (iVar8 >> 0x1f & 0x3ffU)) >> 10;
  local_c4 = iVar23;
  uVar10 = FUN_18000e890(&local_100,uVar16);
  if ((int)uVar10 != 0) {
    return -1000;
  }
  if ((*(int *)(param_3 + 100) == 1) && (uVar10 = FUN_18000e890(local_90,uVar16), (int)uVar10 != 0))
  {
    if (puStack_f8 != (uint *)0x0) {
      FUN_18001d45c(puStack_f8);
    }
    if (local_e0 != (longlong *)0x0) {
      FUN_18001d45c(local_e0);
    }
    if (plStack_d8 == (longlong *)0x0) {
      return -1000;
    }
    FUN_18001d45c(plStack_d8);
    return -1000;
  }
  local_b8 = (longlong)iVar23;
  local_114 = 0;
  uVar22 = local_100;
  if ((int)*param_1 < 1) {
    local_108 = local_90[0];
  }
  else {
    pcVar17 = (char *)(**(longlong **)(param_1 + 6) + 0xc);
    local_a8 = 0;
    local_104 = local_100;
    local_108 = local_90[0];
    do {
      uVar26 = 0xffffffffffffffff;
      uVar15 = 0x1e8;
      iVar23 = -1;
      local_a0 = 0xffffffffffffffff;
      uVar16 = 0x1e8;
      if (-1 < *(short *)(pcVar17 + 2)) {
        if (param_5 != 0) {
          uVar9 = local_114 & 0x80000003;
          if ((int)uVar9 < 0) {
            uVar9 = (uVar9 - 1 | 0xfffffffc) + 1;
          }
          if (uVar9 == 0) goto LAB_18000afbe;
        }
        uVar25 = 0;
        local_58 = *(longlong **)(param_2 + 6);
        uVar9 = local_90[0];
        if (0 < (int)*param_2) {
          puVar32 = (ulonglong *)(*local_58 + 0x10);
          uVar24 = uVar25;
          uVar34 = 0xffffffff;
          uVar33 = uVar15;
          do {
            uVar35 = uVar34;
            uVar22 = uVar16;
            uVar6 = local_a0;
            uVar15 = uVar33;
            if ((*pcVar17 == *(char *)((longlong)puVar32 + -4)) &&
               (-1 < *(short *)((longlong)puVar32 + -2))) {
              uVar9 = 0;
              uVar28 = uVar26;
              if (0 < local_b8) {
                puVar18 = puVar32;
                lVar27 = local_b8;
                do {
                  uVar9 = uVar9 + (int)POPCOUNT(*(ulonglong *)
                                                 (pcVar17 + (4 - (longlong)puVar32) +
                                                 (longlong)puVar18) ^ *puVar18);
                  lVar27 = lVar27 + -1;
                  puVar18 = puVar18 + 1;
                  uVar28 = local_a0;
                } while (lVar27 != 0);
              }
              uVar26 = uVar24;
              uVar35 = uVar25;
              uVar22 = uVar9;
              uVar6 = uVar24;
              uVar15 = uVar16;
              if (((int)uVar16 <= (int)uVar9) &&
                 (uVar26 = uVar28, uVar35 = uVar34, uVar22 = uVar16, uVar6 = local_a0,
                 uVar15 = uVar33, (int)uVar9 < (int)uVar33)) {
                uVar15 = uVar9;
              }
            }
            local_a0 = uVar6;
            uVar16 = uVar22;
            iVar23 = (int)uVar35;
            uVar20 = (int)uVar25 + 1;
            uVar25 = (ulonglong)uVar20;
            uVar24 = uVar24 + 1;
            puVar32 = puVar32 + 10;
            uVar34 = uVar35;
            uVar22 = local_104;
            uVar9 = local_108;
            uVar33 = uVar15;
          } while ((int)uVar20 < (int)*param_2);
        }
        local_90[0] = uVar9;
        if ((int)uVar16 <= local_b0) {
          if ((local_98 == 0) || ((int)(uVar16 * 0x400) < (int)(uVar15 * local_98))) {
            FUN_180009ff0((int *)&local_100,(longlong)param_1,local_114,(longlong)param_2,iVar23,
                          uVar16);
            uVar26 = 0;
            uVar22 = local_100;
            if ((*(int *)(param_3 + 100) == 1) && (0 < (int)uVar9)) {
              uVar25 = uVar26;
              do {
                if (local_68[uVar26] == *(longlong *)(*(longlong *)(param_2 + 6) + local_a0 * 8)) {
                  if (-1 < (int)uVar25) {
                    local_68[uVar26] = 0;
                    local_104 = local_100;
                    goto LAB_18000afbe;
                  }
                  break;
                }
                uVar15 = (int)uVar25 + 1;
                uVar25 = (ulonglong)uVar15;
                uVar26 = uVar26 + 1;
              } while ((int)uVar15 < (int)uVar9);
            }
            local_104 = local_100;
          }
          else {
            uVar25 = 0;
            if (((int)uVar16 < local_c8) && (*(int *)(param_3 + 100) != 0)) {
              if (0 < (int)uVar22) {
                plVar11 = plStack_d8;
                uVar24 = uVar25;
                do {
                  if (*plVar11 == local_58[uVar26]) {
                    if (-1 < (int)uVar24) goto LAB_18000afbe;
                    break;
                  }
                  uVar15 = (int)uVar24 + 1;
                  uVar24 = (ulonglong)uVar15;
                  plVar11 = plVar11 + 1;
                } while ((int)uVar15 < (int)uVar22);
              }
              if (0 < (int)uVar9) {
                uVar24 = uVar25;
                do {
                  if (local_68[uVar24] == local_58[uVar26]) {
                    if (-1 < (longlong)uVar24) {
                      if ((int)uVar16 < (int)local_88[uVar24]) {
                        *(undefined8 *)((longlong)local_70 + uVar24 * 8) =
                             *(undefined8 *)(local_a8 + *(longlong *)(param_1 + 6));
                        local_88[uVar24] = uVar16;
                      }
                      goto LAB_18000afbe;
                    }
                    break;
                  }
                  uVar15 = (int)uVar25 + 1;
                  uVar25 = (ulonglong)uVar15;
                  uVar24 = uVar24 + 1;
                } while ((int)uVar15 < (int)uVar9);
              }
              lVar27 = (longlong)(int)uVar9;
              local_108 = uVar9 + 1;
              *(undefined8 *)((longlong)local_70 + lVar27 * 8) =
                   *(undefined8 *)(local_a8 + *(longlong *)(param_1 + 6));
              local_68[lVar27] = *(longlong *)(*(longlong *)(param_2 + 6) + uVar26 * 8);
              local_88[lVar27] = uVar16;
              local_90[0] = local_108;
            }
          }
        }
      }
LAB_18000afbe:
      local_a8 = local_a8 + 8;
      local_114 = local_114 + 1;
      pcVar17 = pcVar17 + 0x50;
    } while ((int)local_114 < (int)*param_1);
  }
  lVar27 = 0;
  if (0 < (int)uVar22) {
    iVar23 = FUN_180009f10(&local_100,*(int *)(param_3 + 0x4c));
    if (iVar23 < 2) {
      uVar22 = 0;
      if (0 < (int)local_100) {
        uVar26 = (ulonglong)local_100;
        lVar19 = lVar27;
        plVar11 = plStack_d8;
        plVar31 = plStack_d8;
        do {
          if ((puStack_f8[lVar27] >> 0xf & 1) == 0) {
            if (lVar27 != lVar19) {
              *(undefined8 *)(((longlong)local_e0 - (longlong)plStack_d8) + (longlong)plVar11) =
                   *(undefined8 *)(((longlong)local_e0 - (longlong)plStack_d8) + (longlong)plVar31);
              *plVar11 = *plVar31;
              puStack_f8[lVar19] = puStack_f8[lVar27];
            }
            uVar22 = uVar22 + 1;
            lVar19 = lVar19 + 1;
            plVar11 = plVar11 + 1;
          }
          else {
            puStack_f8[lVar27] = puStack_f8[lVar27] & 0xffff7fff;
          }
          lVar27 = lVar27 + 1;
          plVar31 = plVar31 + 1;
          uVar26 = uVar26 - 1;
        } while (uVar26 != 0);
      }
      iVar23 = 0;
      local_100 = uVar22;
      goto LAB_18000b3bc;
    }
    FUN_18000a1b0((int *)param_2,sStack_ec);
    iVar23 = *(int *)(param_3 + 0x50);
    iVar8 = FUN_180009cd0(&local_100,0,iVar23);
    uVar26 = (ulonglong)local_100;
    sVar7 = (short)iVar8;
    if (0 < (int)local_100) {
      uVar25 = (ulonglong)local_100;
      puVar29 = puStack_f8;
      plVar11 = local_e0;
      do {
        if ((*puVar29 >> 0xf & 1) == 0) {
          psVar2 = *(short **)(((longlong)plStack_d8 - (longlong)local_e0) + (longlong)plVar11);
          psVar3 = (short *)*plVar11;
          iVar8 = (int)sVar7;
          if (((int)*psVar3 - (int)*psVar2) + iVar8 < 0) {
            iVar8 = ((int)*psVar2 - (int)*psVar3) - iVar8;
          }
          else {
            iVar8 = ((int)*psVar3 - (int)*psVar2) + iVar8;
          }
          if (iVar23 < iVar8) {
            *puVar29 = *puVar29 | 0x8000;
          }
        }
        plVar11 = plVar11 + 1;
        puVar29 = puVar29 + 1;
        uVar25 = uVar25 - 1;
      } while (uVar25 != 0);
    }
    iVar23 = *(int *)(param_3 + 0x50);
    sStack_ea = sVar7;
    iVar8 = FUN_180009cd0(&local_100,4,iVar23);
    plVar11 = local_e0;
    puVar29 = puStack_f8;
    sStack_e8 = (short)iVar8;
    if (0 < (int)local_100) {
      uVar25 = uVar26;
      puVar30 = puStack_f8;
      plVar31 = local_e0;
      do {
        if ((*puVar30 >> 0xf & 1) == 0) {
          lVar27 = *(longlong *)((longlong)plVar31 + ((longlong)plStack_d8 - (longlong)local_e0));
          lVar19 = *plVar31;
          iVar8 = (int)sStack_e8;
          if (((int)*(short *)(lVar19 + 4) - (int)*(short *)(lVar27 + 4)) + iVar8 < 0) {
            iVar8 = ((int)*(short *)(lVar27 + 4) - (int)*(short *)(lVar19 + 4)) - iVar8;
          }
          else {
            iVar8 = ((int)*(short *)(lVar19 + 4) - (int)*(short *)(lVar27 + 4)) + iVar8;
          }
          if (iVar23 < iVar8) {
            *puVar30 = *puVar30 | 0x8000;
          }
        }
        plVar31 = plVar31 + 1;
        puVar30 = puVar30 + 1;
        uVar25 = uVar25 - 1;
      } while (uVar25 != 0);
    }
    uVar22 = 0;
    if (0 < (int)local_100) {
      lVar27 = 0;
      lVar19 = 0;
      plVar31 = plStack_d8;
      plVar13 = plStack_d8;
      do {
        if ((puStack_f8[lVar27] >> 0xf & 1) == 0) {
          if (lVar27 != lVar19) {
            *(undefined8 *)(((longlong)local_e0 - (longlong)plStack_d8) + (longlong)plVar31) =
                 *(undefined8 *)(((longlong)local_e0 - (longlong)plStack_d8) + (longlong)plVar13);
            *plVar31 = *plVar13;
            puStack_f8[lVar19] = puStack_f8[lVar27];
          }
          uVar22 = uVar22 + 1;
          lVar19 = lVar19 + 1;
          plVar31 = plVar31 + 1;
        }
        else {
          puStack_f8[lVar27] = puStack_f8[lVar27] & 0xffff7fff;
        }
        lVar27 = lVar27 + 1;
        plVar13 = plVar13 + 1;
        uVar26 = uVar26 - 1;
      } while (uVar26 != 0);
    }
    local_100 = uVar22;
    FUN_180009ad0((int *)param_2,(int)sVar7,(int)sStack_e8);
    if (((1 < (int)uVar22) && (*(int *)(param_3 + 100) == 1)) && (0 < (int)local_108)) {
      uVar26 = (ulonglong)local_108;
      plVar31 = local_68;
      puVar30 = local_88;
      do {
        piVar21 = (int *)*plVar31;
        if (piVar21 != (int *)0x0) {
          piVar12 = *(int **)(((longlong)local_70 - (longlong)local_68) + (longlong)plVar31);
          uVar15 = piVar21[1] - piVar12[1] >> 0x1f;
          if (((int)((piVar21[1] - piVar12[1] ^ uVar15) - uVar15) <= *(int *)(param_3 + 0x50)) &&
             (uVar15 = *piVar21 - *piVar12 >> 0x1f,
             (int)((*piVar21 - *piVar12 ^ uVar15) - uVar15) <= *(int *)(param_3 + 0x50))) {
            iVar23 = (int)*(short *)((longlong)piVar21 + 0xe) -
                     (int)*(short *)((longlong)piVar12 + 0xe);
            uVar4 = (ushort)(iVar23 >> 0x1f);
            sVar7 = ((ushort)iVar23 ^ uVar4) - uVar4;
            if (0xb4 < sVar7) {
              sVar7 = 0x168 - sVar7;
            }
            if ((int)sVar7 <= *(int *)(param_3 + 0x4c)) {
              local_100 = uVar22 + 1;
              plVar11[(int)uVar22] = (longlong)piVar12;
              plStack_d8[(int)uVar22] = *plVar31;
              puVar29[(int)uVar22] = *puVar30;
              uVar22 = local_100;
            }
          }
        }
        plVar31 = plVar31 + 1;
        puVar30 = puVar30 + 1;
        uVar26 = uVar26 - 1;
      } while (uVar26 != 0);
    }
  }
  iVar23 = local_118;
  if (*(int *)(param_3 + 0x58) <= (int)uVar22) {
    if (param_7 == (longlong *)0x0) {
      iVar8 = 0;
      iVar23 = 0;
      piVar21 = (int *)**(undefined8 **)(param_1 + 6);
      if (0 < (int)*param_1) {
        do {
          plVar31 = plStack_d8;
          plVar11 = local_e0;
          uVar26 = 0;
          if (-1 < *(short *)((longlong)piVar21 + 0xe)) {
            if (0 < (int)uVar22) {
              plVar13 = local_e0;
              uVar25 = uVar26;
              do {
                if (*(int **)(((longlong)plStack_d8 - (longlong)local_e0) + (longlong)plVar13) ==
                    piVar21) {
                  lVar27 = local_e0[uVar25];
LAB_18000b474:
                  if (lVar27 != 0) goto LAB_18000b5c4;
                  break;
                }
                if ((int *)*plVar13 == piVar21) {
                  lVar27 = plStack_d8[uVar25];
                  goto LAB_18000b474;
                }
                uVar15 = (int)uVar26 + 1;
                uVar26 = (ulonglong)uVar15;
                uVar25 = uVar25 + 1;
                plVar13 = plVar13 + 1;
              } while ((int)uVar15 < (int)uVar22);
            }
            piVar12 = FUN_18000a0b0((int *)param_2,piVar21,9,(int *)0x0);
            if (piVar12 != (int *)0x0) {
              if ((char)piVar12[3] == (char)piVar21[3]) {
                iVar23 = (int)*(short *)((longlong)piVar21 + 0xe) -
                         (int)*(short *)((longlong)piVar12 + 0xe);
                uVar4 = (ushort)(iVar23 >> 0x1f);
                sVar7 = ((ushort)iVar23 ^ uVar4) - uVar4;
                if (0xb4 < sVar7) {
                  sVar7 = 0x168 - sVar7;
                }
                uVar26 = 0;
                if ((int)sVar7 <= *(int *)(param_3 + 0x4c)) {
                  uVar15 = 0;
                  if (0 < local_b8) {
                    puVar32 = (ulonglong *)(piVar21 + 4);
                    uVar25 = uVar26;
                    lVar27 = local_b8;
                    do {
                      uVar15 = (int)uVar25 +
                               (int)POPCOUNT(*(ulonglong *)
                                              ((longlong)piVar12 + (0x10 - (longlong)(piVar21 + 4))
                                              + (longlong)puVar32) ^ *puVar32);
                      uVar25 = (ulonglong)uVar15;
                      lVar27 = lVar27 + -1;
                      puVar32 = puVar32 + 1;
                    } while (lVar27 != 0);
                  }
                  uVar16 = uVar22;
                  if ((int)uVar15 < local_c8) {
                    if (0 < (int)uVar22) {
                      plVar13 = plVar11;
                      uVar25 = uVar26;
                      do {
                        if (*(int **)(((longlong)plVar31 - (longlong)plVar11) + (longlong)plVar13)
                            == piVar12) {
                          lVar27 = plVar11[uVar25];
LAB_18000b564:
                          if (lVar27 != 0) goto LAB_18000b5c4;
                          break;
                        }
                        if ((int *)*plVar13 == piVar12) {
                          lVar27 = plVar31[uVar25];
                          goto LAB_18000b564;
                        }
                        uVar16 = (int)uVar26 + 1;
                        uVar26 = (ulonglong)uVar16;
                        uVar25 = uVar25 + 1;
                        plVar13 = plVar13 + 1;
                      } while ((int)uVar16 < (int)uVar22);
                    }
                    uVar16 = uVar22 + 1;
                    plVar11[(int)uVar22] = (longlong)piVar21;
                    plVar31[(int)uVar22] = (longlong)piVar12;
                    puStack_f8[(int)uVar22] = uVar15;
                    local_100 = uVar16;
                  }
                  uVar22 = uVar16;
                  if (0x100 < (int)uVar15) {
                    if (*(char *)((longlong)piVar21 + 0xd) == -5) {
                      local_118 = local_118 - ((int)(uVar15 + ((int)uVar15 >> 0x1f & 3U)) >> 2);
                    }
                    else {
                      local_118 = local_118 - (int)uVar15 / 2;
                    }
                  }
                }
              }
              else {
                local_118 = local_118 + -2;
              }
            }
          }
LAB_18000b5c4:
          iVar8 = iVar8 + 1;
          piVar21 = piVar21 + 0x14;
          iVar23 = local_118;
        } while (iVar8 < (int)*param_1);
      }
    }
    else {
      FUN_18000a3c0(param_7,*(ulonglong *)(param_2 + 4),(uint)(ushort)param_2[1],
                    (uint)*(ushort *)((longlong)param_2 + 6),param_3);
      uVar10 = FUN_18000a6c0((int *)param_1,param_2,param_7,(int *)&local_100,local_c8,local_c4,
                             param_6,param_3);
      uVar22 = local_100;
      iVar23 = (int)uVar10;
    }
  }
LAB_18000b3bc:
  plVar11 = local_e0;
  if (*(int *)(param_3 + 100) == 1) {
    if (local_88 != (uint *)0x0) {
      FUN_18001d45c(local_88);
    }
    if (local_70 != (LPVOID)0x0) {
      FUN_18001d45c(local_70);
    }
    if (local_68 != (longlong *)0x0) {
      FUN_18001d45c(local_68);
    }
  }
  if ((param_6 == (char *)0x0) || ((int)uVar22 < *(int *)(param_3 + 0x58))) {
    bVar5 = false;
  }
  else {
    bVar5 = true;
  }
  lVar19 = 0;
  lVar27 = (longlong)(int)uVar22;
  if (0 < (int)uVar22) {
    do {
      iVar8 = local_c0 - puStack_f8[lVar19];
      if (param_5 != 0) {
        iVar8 = iVar8 * 4;
      }
      iVar1 = *(int *)(param_3 + 0x94);
      if ((0 < iVar1) && (iVar8 < iVar1 * 2)) {
        iVar8 = iVar1 + iVar8 / 2;
      }
      iVar23 = iVar23 + iVar8;
      if (bVar5) {
        iVar1 = (int)((plStack_d8[lVar19] - **(longlong **)(param_2 + 6)) / 0x50);
        if (param_6[iVar1] == '\x01') {
          local_d0 = local_d0 + (short)iVar8;
          sStack_ce = sStack_ce + 1;
        }
        else {
          param_6[iVar1] = '\x01';
        }
      }
      lVar19 = lVar19 + 1;
      plVar11 = local_e0;
    } while (lVar19 < lVar27);
  }
  if (iVar23 < 0) {
    iVar23 = 0;
  }
  if (param_4 == (undefined8 *)0x0) {
    if (puStack_f8 != (uint *)0x0) {
      FUN_18001d45c(puStack_f8);
    }
    if (local_e0 != (longlong *)0x0) {
      FUN_18001d45c(local_e0);
    }
    if (plStack_d8 != (longlong *)0x0) {
      FUN_18001d45c(plStack_d8);
      return iVar23;
    }
    return iVar23;
  }
  puStack_f8 = (uint *)FUN_180023ae4(puStack_f8,lVar27 * 4);
  local_e0 = (longlong *)FUN_180023ae4(plVar11,lVar27 * 8);
  pvVar14 = FUN_180023ae4(plStack_d8,lVar27 * 8);
  *param_4 = CONCAT44(uStack_fc,local_100);
  param_4[1] = puStack_f8;
  param_4[2] = CONCAT26(sStack_ea,CONCAT24(sStack_ec,local_f0));
  param_4[3] = CONCAT62(uStack_e6,sStack_e8);
  param_4[4] = local_e0;
  param_4[5] = pvVar14;
  param_4[6] = CONCAT44(uStack_cc,CONCAT22(sStack_ce,local_d0));
  return iVar23;
}



int FUN_18000b7b0(uint *param_1,uint *param_2,longlong param_3,undefined8 *param_4)

{
  int iVar1;
  longlong *plVar2;
  
  plVar2 = (longlong *)0x0;
  if (*(longlong *)(param_2 + 4) != 0) {
    plVar2 = (longlong *)FUN_18001ee18(1,0x18);
  }
  iVar1 = FUN_18000ab80(param_1,param_2,param_3,param_4,0,(char *)0x0,plVar2);
  if (plVar2 != (longlong *)0x0) {
    if ((LPVOID)*plVar2 != (LPVOID)0x0) {
      FUN_18001d45c((LPVOID)*plVar2);
    }
    if ((LPVOID)plVar2[1] != (LPVOID)0x0) {
      FUN_18001d45c((LPVOID)plVar2[1]);
    }
    if ((LPVOID)plVar2[2] != (LPVOID)0x0) {
      FUN_18001d45c((LPVOID)plVar2[2]);
    }
    FUN_18001d45c(plVar2);
  }
  return iVar1;
}



void FUN_18000b870(int *param_1)

{
  char cVar1;
  int iVar2;
  longlong lVar3;
  
  iVar2 = 0;
  if (0 < *param_1) {
    lVar3 = 0;
    do {
      cVar1 = *(char *)(*(longlong *)(lVar3 + *(longlong *)(param_1 + 8)) + 0xd);
      if (cVar1 < '\x7f') {
        *(char *)(*(longlong *)(lVar3 + *(longlong *)(param_1 + 8)) + 0xd) = cVar1 + '\x01';
      }
      cVar1 = *(char *)(*(longlong *)(lVar3 + *(longlong *)(param_1 + 10)) + 0xd);
      if (cVar1 < '\x7f') {
        *(char *)(*(longlong *)(lVar3 + *(longlong *)(param_1 + 10)) + 0xd) = cVar1 + '\x01';
      }
      iVar2 = iVar2 + 1;
      lVar3 = lVar3 + 8;
    } while (iVar2 < *param_1);
  }
  return;
}



ulonglong FUN_18000b8c0(int *param_1,char *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  longlong *plVar4;
  ulonglong uVar5;
  uint uVar6;
  longlong lVar7;
  longlong *plVar8;
  uint uVar9;
  ulonglong uVar10;
  longlong lVar11;
  ulonglong uVar12;
  longlong lVar13;
  char *pcVar14;
  ulonglong uVar15;
  uint local_res20 [2];
  longlong local_58;
  
  uVar6 = (uint)(*(ushort *)((longlong)param_1 + 6) >> 2);
  uVar1 = (uint)(*(ushort *)(param_1 + 1) >> 2);
  plVar4 = (longlong *)FUN_1800076f0(uVar1,uVar6);
  if (plVar4 != (longlong *)0x0) {
    uVar15 = (ulonglong)(int)(uVar6 * uVar1);
    lVar11 = 0;
    local_58 = 2;
    do {
      uVar12 = 0;
      FUN_18001dbc0((undefined1 (*) [16])*plVar4,0,uVar15);
      iVar3 = *param_1;
      local_res20[lVar11] = 0;
      uVar10 = uVar12;
      uVar5 = uVar12;
      pcVar14 = param_2;
      if (0 < iVar3) {
        do {
          if ((lVar11 != 1) || (*pcVar14 != '\0')) {
            iVar3 = **(int **)(uVar5 + *(longlong *)(param_1 + 6));
            iVar2 = (int)(iVar3 + (iVar3 >> 0x1f & 3U)) >> 2;
            iVar3 = (*(int **)(uVar5 + *(longlong *)(param_1 + 6)))[1];
            iVar3 = (int)(iVar3 + (iVar3 >> 0x1f & 3U)) >> 2;
            if ((0 < iVar2) &&
               (((iVar2 < (int)(uVar1 - 1) && (0 < iVar3)) && (iVar3 < (int)(uVar6 - 1))))) {
              lVar7 = (longlong)(iVar3 + -1);
              if (lVar7 <= iVar3 + 1) {
                plVar8 = plVar4 + lVar7;
                lVar13 = ((iVar3 + 1) - lVar7) + 1;
                lVar7 = (longlong)iVar2 + -1;
                do {
                  for (; lVar7 <= iVar2 + 1; lVar7 = lVar7 + 1) {
                    *(undefined1 *)(lVar7 + *plVar8) = 1;
                  }
                  plVar8 = plVar8 + 1;
                  lVar13 = lVar13 + -1;
                  lVar7 = (longlong)iVar2 + -1;
                } while (lVar13 != 0);
              }
            }
          }
          uVar9 = (int)uVar10 + 1;
          uVar10 = (ulonglong)uVar9;
          uVar5 = uVar5 + 8;
          pcVar14 = pcVar14 + 1;
        } while ((int)uVar9 < *param_1);
      }
      uVar10 = 0;
      if (uVar15 != 0) {
        lVar7 = *plVar4;
        uVar5 = uVar10;
        do {
          if (*(char *)(lVar7 + uVar5) == '\x01') {
            uVar9 = (int)uVar12 + 1;
            uVar12 = (ulonglong)uVar9;
            local_res20[lVar11] = uVar9;
          }
          uVar5 = uVar5 + 1;
        } while ((longlong)uVar5 < (longlong)uVar15);
      }
      lVar11 = lVar11 + 1;
      local_58 = local_58 + -1;
    } while (local_58 != 0);
    FUN_18001d45c(plVar4);
    if (local_res20[0] != 0) {
      uVar10 = (longlong)(int)(local_res20[1] * 100) / (longlong)(int)local_res20[0] & 0xffffffff;
    }
    return uVar10;
  }
  return 0;
}



int FUN_18000bad0(int *param_1,int *param_2,longlong param_3,longlong param_4,int param_5)

{
  int iVar1;
  char *pcVar2;
  longlong *plVar3;
  uint *puVar4;
  int *piVar5;
  ulonglong uVar6;
  int iVar7;
  int iVar8;
  longlong lVar9;
  int local_res10;
  
  iVar8 = 0;
  plVar3 = (longlong *)0x0;
  local_res10 = 0;
  if (*param_2 < 1) {
    return 0;
  }
  pcVar2 = (char *)FUN_18001ee18((longlong)*param_2,1);
  if (pcVar2 == (char *)0x0) {
    iVar1 = -1000;
  }
  else {
    if (*(longlong *)(param_2 + 4) != 0) {
      plVar3 = (longlong *)FUN_18001ee18(1,0x18);
    }
    iVar7 = 0;
    iVar1 = 0;
    if (0 < *param_1) {
      lVar9 = 0;
      do {
        puVar4 = (uint *)FUN_18000e7b0(param_2);
        piVar5 = (int *)FUN_18001ee18(1,0x38);
        if (puVar4 == (uint *)0x0) goto LAB_18000bc50;
        if (piVar5 == (int *)0x0) {
LAB_18000bc95:
          if (puVar4 != (uint *)0x0) {
            FUN_18001d45c(*(LPVOID *)(puVar4 + 4));
            FUN_18001d45c(puVar4);
          }
        }
        else {
          *(undefined8 *)(puVar4 + 4) = *(undefined8 *)(param_2 + 4);
          iVar1 = FUN_18000ab80(*(uint **)(*(longlong *)(param_1 + 2) + lVar9),puVar4,param_4,
                                (undefined8 *)piVar5,param_5,pcVar2,plVar3);
          puVar4[4] = 0;
          puVar4[5] = 0;
          piVar5[4] = iVar1;
          if (*piVar5 < *(int *)(param_4 + 0x58)) {
            if (param_3 != 0) {
              *(undefined8 *)(lVar9 + *(longlong *)(param_3 + 0x10)) = 0;
            }
LAB_18000bc50:
            if (piVar5 != (int *)0x0) {
              if (*(LPVOID *)(piVar5 + 2) != (LPVOID)0x0) {
                FUN_18001d45c(*(LPVOID *)(piVar5 + 2));
              }
              if (*(LPVOID *)(piVar5 + 8) != (LPVOID)0x0) {
                FUN_18001d45c(*(LPVOID *)(piVar5 + 8));
              }
              if (*(LPVOID *)(piVar5 + 10) != (LPVOID)0x0) {
                FUN_18001d45c(*(LPVOID *)(piVar5 + 10));
              }
              piVar5[2] = 0;
              piVar5[3] = 0;
              piVar5[8] = 0;
              piVar5[9] = 0;
              piVar5[10] = 0;
              piVar5[0xb] = 0;
              FUN_18001d45c(piVar5);
            }
            goto LAB_18000bc95;
          }
          if (param_5 == 0) {
            FUN_18000b870(piVar5);
          }
          iVar8 = iVar8 + (*piVar5 - (int)*(short *)((longlong)piVar5 + 0x32));
          local_res10 = local_res10 + (iVar1 - (short)piVar5[0xc]);
          if (param_3 == 0) goto LAB_18000bc50;
          *(uint **)(lVar9 + *(longlong *)(param_3 + 0x18)) = puVar4;
          *(int **)(lVar9 + *(longlong *)(param_3 + 0x10)) = piVar5;
          *(int *)(param_3 + 4) = iVar8;
        }
        iVar7 = iVar7 + 1;
        lVar9 = lVar9 + 8;
        iVar1 = local_res10;
      } while (iVar7 < *param_1);
    }
    if (plVar3 != (longlong *)0x0) {
      if ((LPVOID)*plVar3 != (LPVOID)0x0) {
        FUN_18001d45c((LPVOID)*plVar3);
      }
      if ((LPVOID)plVar3[1] != (LPVOID)0x0) {
        FUN_18001d45c((LPVOID)plVar3[1]);
      }
      if ((LPVOID)plVar3[2] != (LPVOID)0x0) {
        FUN_18001d45c((LPVOID)plVar3[2]);
      }
      FUN_18001d45c(plVar3);
    }
    if ((0 < iVar1) && (param_3 != 0)) {
      uVar6 = FUN_18000b8c0(param_2,pcVar2);
      *(int *)(param_3 + 8) = (int)uVar6;
    }
    FUN_18001d45c(pcVar2);
  }
  return iVar1;
}



void FUN_18000bd40(int *param_1,short param_2)

{
  short *psVar1;
  ushort uVar2;
  ushort uVar3;
  uint uVar4;
  uint uVar5;
  int *piVar6;
  short sVar7;
  int iVar8;
  int iVar9;
  longlong lVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  
  uVar2 = *(ushort *)(param_1 + 1);
  uVar3 = *(ushort *)((longlong)param_1 + 6);
  iVar11 = 0;
  if (param_2 == 0) {
    sVar7 = 0;
  }
  else {
    sVar7 = param_2;
    if (param_2 < 1) {
      sVar7 = param_2 + 0x168;
    }
    sVar7 = 0x168 - sVar7;
  }
  uVar4 = *(uint *)(&DAT_18003eac0 + (longlong)sVar7 * 4);
  uVar5 = *(uint *)(&DAT_18003f060 + (longlong)sVar7 * 4);
  iVar15 = (uVar4 ^ (int)uVar4 >> 0x1f) - ((int)uVar4 >> 0x1f);
  iVar14 = (uVar5 ^ (int)uVar5 >> 0x1f) - ((int)uVar5 >> 0x1f);
  iVar12 = iVar15 * (uint)uVar3;
  iVar9 = iVar14 * (uint)uVar2;
  iVar15 = iVar15 * (uint)uVar2;
  iVar14 = iVar14 * (uint)uVar3;
  if ((param_2 != 0) && (0 < *param_1)) {
    lVar10 = 0;
    do {
      piVar6 = *(int **)(lVar10 + *(longlong *)(param_1 + 6));
      iVar16 = *piVar6 - (uint)(uVar2 >> 1);
      iVar17 = piVar6[1] - (uint)(uVar3 >> 1);
      iVar8 = iVar16 * uVar5;
      iVar13 = iVar17 * uVar4;
      iVar17 = iVar17 * uVar5;
      iVar16 = iVar16 * uVar4;
      *piVar6 = ((int)((((0 < iVar8 - iVar13) + 0x7fff) - iVar13) + iVar8) >> 0x10) +
                (int)(((int)((uint)(0 < iVar9 + iVar12) + iVar9 + 0x7fff + iVar12) >> 0x10) -
                     (uint)uVar2) / 2 + (uint)(uVar2 >> 1);
      *(uint *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 4) =
           ((int)((0 < iVar16 + iVar17) + 0x7fff + iVar16 + iVar17) >> 0x10) +
           (int)(((int)((0 < iVar14 + iVar15) + 0x7fff + iVar14 + iVar15) >> 0x10) - (uint)uVar3) /
           2 + (uint)(uVar3 >> 1);
      psVar1 = (short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe);
      *psVar1 = *psVar1 - param_2;
      sVar7 = *(short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe);
      if (sVar7 < 0) {
        *(short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe) = sVar7 + 0x168;
      }
      sVar7 = *(short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe);
      if (0x167 < sVar7) {
        *(short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe) = sVar7 + -0x168;
      }
      iVar11 = iVar11 + 1;
      lVar10 = lVar10 + 8;
    } while (iVar11 < *param_1);
  }
  return;
}



LPVOID FUN_18000bf30(int param_1,int param_2)

{
  LPVOID pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = FUN_18001ee18(1,(longlong)(param_2 * 8) + (longlong)(param_1 * param_2) * 8);
  if (pvVar1 == (LPVOID)0x0) {
    return (LPVOID)0x0;
  }
  lVar2 = (longlong)pvVar1 + (longlong)(param_2 * 8);
  lVar3 = 0;
  if (0 < param_2) {
    do {
      *(longlong *)((longlong)pvVar1 + lVar3 * 8) = lVar2;
      lVar3 = lVar3 + 1;
      lVar2 = lVar2 + (longlong)param_1 * 8;
    } while (lVar3 < param_2);
  }
  return pvVar1;
}



LPVOID FUN_18000bfc0(void)

{
  int iVar1;
  LPVOID pvVar2;
  undefined8 *puVar3;
  LPVOID pvVar4;
  ulonglong uVar5;
  
  iVar1 = *(int *)(DAT_180049f30 + 0x70);
  uVar5 = (ulonglong)iVar1;
  pvVar2 = FUN_18001ee18(1,0x90);
  if (pvVar2 == (LPVOID)0x0) {
    return (LPVOID)0x0;
  }
  *(int *)((longlong)pvVar2 + 0x10) = iVar1;
  puVar3 = (undefined8 *)FUN_1800076f0(iVar1,iVar1);
  if (puVar3 != (undefined8 *)0x0) {
    FUN_18001dbc0((undefined1 (*) [16])*puVar3,0,(longlong)(iVar1 * iVar1));
  }
  *(undefined8 **)((longlong)pvVar2 + 0x40) = puVar3;
  pvVar4 = FUN_18000bf30(iVar1,iVar1);
  *(LPVOID *)((longlong)pvVar2 + 0x88) = pvVar4;
  pvVar4 = FUN_18000bf30(iVar1,iVar1);
  *(LPVOID *)((longlong)pvVar2 + 0x50) = pvVar4;
  pvVar4 = FUN_18001ee18(uVar5,8);
  *(LPVOID *)((longlong)pvVar2 + 0x48) = pvVar4;
  pvVar4 = FUN_18001ee18(uVar5,8);
  *(LPVOID *)((longlong)pvVar2 + 0x58) = pvVar4;
  pvVar4 = FUN_18001ee18(uVar5,1);
  *(LPVOID *)((longlong)pvVar2 + 0x38) = pvVar4;
  pvVar4 = FUN_18001ee18(uVar5,8);
  *(LPVOID *)((longlong)pvVar2 + 0x68) = pvVar4;
  return pvVar2;
}



uint FUN_18000c0a0(int *param_1)

{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  ulonglong uVar4;
  undefined8 *puVar5;
  longlong lVar6;
  
  lVar6 = (longlong)*param_1;
  uVar3 = 0x2000;
  if (0 < lVar6) {
    puVar5 = *(undefined8 **)(param_1 + 2);
    do {
      uVar1 = *(uint *)*puVar5;
      if (0 < (int)uVar1) {
        puVar2 = (uint *)(**(longlong **)((uint *)*puVar5 + 6) + 8);
        uVar4 = (ulonglong)uVar1;
        do {
          if (-1 < *(short *)((longlong)puVar2 + 6)) {
            if (*puVar2 < uVar3) {
              uVar3 = *puVar2;
            }
          }
          puVar2 = puVar2 + 0x14;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
      }
      puVar5 = puVar5 + 1;
      lVar6 = lVar6 + -1;
    } while (lVar6 != 0);
  }
  return uVar3;
}



undefined8 FUN_18000c0f0(int *param_1,longlong param_2)

{
  byte bVar1;
  int *piVar2;
  ulonglong uVar3;
  short *psVar4;
  int iVar5;
  char cVar6;
  longlong lVar7;
  uint uVar8;
  uint uVar9;
  short local_res8 [4];
  
  cVar6 = '\0';
  bVar1 = *(byte *)(**(longlong **)(param_1 + 2) + 8);
  if ((*param_1 - 1U < 0x28) && (*(longlong **)(param_1 + 2) != (longlong *)0x0)) {
    uVar3 = FUN_18000efd0(param_1,local_res8,*(int *)(param_2 + 0x58));
    if (-1 < (int)uVar3) {
      iVar5 = *(int *)(param_2 + 0x88);
      uVar8 = (int)uVar3 + 0x20;
      uVar3 = (ulonglong)uVar8;
      if (iVar5 < (int)uVar8) {
        do {
          uVar8 = FUN_18000c0a0(param_1);
          if (iVar5 < (int)uVar3) {
            do {
              uVar8 = uVar8 + 10;
              if (0x1ffe < uVar8) break;
              lVar7 = (longlong)(*param_1 + -1);
              if (-1 < *param_1 + -1) {
                do {
                  iVar5 = 0;
                  piVar2 = *(int **)(*(longlong *)(param_1 + 2) + lVar7 * 8);
                  if (0 < *piVar2) {
                    psVar4 = (short *)(**(longlong **)(piVar2 + 6) + 0xe);
                    do {
                      if (((-1 < *psVar4) && (*(uint *)(psVar4 + -3) < uVar8)) &&
                         (*(char *)((longlong)psVar4 + -1) <= cVar6)) {
                        uVar9 = (int)uVar3 - (((int)((uint)bVar1 * 0xa2 + 7) >> 3) + 8);
                        uVar3 = (ulonglong)uVar9;
                        *psVar4 = -1;
                        if ((int)uVar9 <= *(int *)(param_2 + 0x88)) {
                          return 0;
                        }
                      }
                      iVar5 = iVar5 + 1;
                      psVar4 = psVar4 + 0x28;
                    } while (iVar5 < *piVar2);
                  }
                  lVar7 = lVar7 + -1;
                } while (-1 < lVar7);
              }
              iVar5 = *(int *)(param_2 + 0x88);
            } while (iVar5 < (int)uVar3);
          }
          cVar6 = cVar6 + '\x01';
        } while (cVar6 < '\x7f');
      }
      return 0;
    }
  }
  return 0xfffffc17;
}



void FUN_18000c250(longlong param_1)

{
  LPVOID pvVar1;
  longlong lVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  uint uVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  
  uVar8 = 0;
  if (*(LPVOID *)(param_1 + 0x38) != (LPVOID)0x0) {
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x38));
    *(undefined8 *)(param_1 + 0x38) = 0;
  }
  if (*(longlong *)(param_1 + 0x48) != 0) {
    uVar3 = uVar8;
    uVar7 = uVar8;
    if (0 < *(int *)(param_1 + 4)) {
      do {
        pvVar1 = *(LPVOID *)(uVar7 + *(longlong *)(param_1 + 0x48));
        if (pvVar1 != (LPVOID)0x0) {
          FUN_18001d45c(*(LPVOID *)((longlong)pvVar1 + 0x10));
          FUN_18001d45c(pvVar1);
          *(undefined8 *)(uVar7 + *(longlong *)(param_1 + 0x48)) = 0;
        }
        uVar5 = (int)uVar3 + 1;
        uVar3 = (ulonglong)uVar5;
        uVar7 = uVar7 + 8;
      } while ((int)uVar5 < *(int *)(param_1 + 4));
    }
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x48));
    *(undefined8 *)(param_1 + 0x48) = 0;
  }
  if (*(longlong *)(param_1 + 0x50) != 0) {
    uVar3 = uVar8;
    uVar7 = uVar8;
    if (0 < *(int *)(param_1 + 4)) {
      do {
        uVar4 = uVar8;
        uVar6 = uVar8;
        if (0 < *(int *)(param_1 + 4)) {
          do {
            pvVar1 = *(LPVOID *)(uVar6 + *(longlong *)(uVar7 + *(longlong *)(param_1 + 0x50)));
            if (pvVar1 != (LPVOID)0x0) {
              FUN_18001d45c(pvVar1);
              *(undefined8 *)(uVar6 + *(longlong *)(uVar7 + *(longlong *)(param_1 + 0x50))) = 0;
            }
            uVar5 = (int)uVar4 + 1;
            uVar4 = (ulonglong)uVar5;
            uVar6 = uVar6 + 8;
          } while ((int)uVar5 < *(int *)(param_1 + 4));
        }
        uVar5 = (int)uVar3 + 1;
        uVar3 = (ulonglong)uVar5;
        uVar7 = uVar7 + 8;
      } while ((int)uVar5 < *(int *)(param_1 + 4));
    }
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x50));
    *(undefined8 *)(param_1 + 0x50) = 0;
  }
  if (*(longlong *)(param_1 + 0x88) != 0) {
    uVar3 = uVar8;
    uVar7 = uVar8;
    if (0 < *(int *)(param_1 + 4)) {
      do {
        uVar4 = uVar8;
        uVar6 = uVar8;
        if (0 < *(int *)(param_1 + 4)) {
          do {
            lVar2 = *(longlong *)(uVar6 + *(longlong *)(*(longlong *)(param_1 + 0x88) + uVar3));
            if (lVar2 != 0) {
              if (*(LPVOID *)(lVar2 + 8) != (LPVOID)0x0) {
                FUN_18001d45c(*(LPVOID *)(lVar2 + 8));
              }
              if (*(LPVOID *)(lVar2 + 0x20) != (LPVOID)0x0) {
                FUN_18001d45c(*(LPVOID *)(lVar2 + 0x20));
              }
              if (*(LPVOID *)(lVar2 + 0x28) != (LPVOID)0x0) {
                FUN_18001d45c(*(LPVOID *)(lVar2 + 0x28));
              }
              *(undefined8 *)(lVar2 + 8) = 0;
              *(undefined8 *)(lVar2 + 0x20) = 0;
              *(undefined8 *)(lVar2 + 0x28) = 0;
              FUN_18001d45c(*(LPVOID *)
                             (*(longlong *)(*(longlong *)(param_1 + 0x88) + uVar3) + uVar6));
              *(undefined8 *)(uVar6 + *(longlong *)(*(longlong *)(param_1 + 0x88) + uVar3)) = 0;
            }
            uVar5 = (int)uVar4 + 1;
            uVar4 = (ulonglong)uVar5;
            uVar6 = uVar6 + 8;
          } while ((int)uVar5 < *(int *)(param_1 + 4));
        }
        uVar5 = (int)uVar7 + 1;
        uVar3 = uVar3 + 8;
        uVar7 = (ulonglong)uVar5;
      } while ((int)uVar5 < *(int *)(param_1 + 4));
    }
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x88));
    *(undefined8 *)(param_1 + 0x88) = 0;
  }
  if (*(LPVOID *)(param_1 + 0x40) != (LPVOID)0x0) {
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x40));
    *(undefined8 *)(param_1 + 0x40) = 0;
  }
  return;
}



void FUN_18000c450(longlong param_1)

{
  LPVOID pvVar1;
  ulonglong uVar2;
  uint uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  
  uVar2 = 0;
  if (*(longlong *)(param_1 + 0x58) != 0) {
    uVar4 = uVar2;
    uVar5 = uVar2;
    if (0 < *(int *)(param_1 + 0x1c)) {
      do {
        pvVar1 = *(LPVOID *)(uVar5 + *(longlong *)(param_1 + 0x58));
        if (pvVar1 != (LPVOID)0x0) {
          FUN_18001d45c(pvVar1);
          *(undefined8 *)(uVar5 + *(longlong *)(param_1 + 0x58)) = 0;
        }
        uVar3 = (int)uVar4 + 1;
        uVar4 = (ulonglong)uVar3;
        uVar5 = uVar5 + 8;
      } while ((int)uVar3 < *(int *)(param_1 + 0x1c));
    }
    *(undefined4 *)(param_1 + 0x1c) = 0;
  }
  if (*(longlong *)(param_1 + 0x68) != 0) {
    uVar4 = uVar2;
    if (0 < *(int *)(param_1 + 0x28)) {
      do {
        pvVar1 = *(LPVOID *)(uVar4 + *(longlong *)(param_1 + 0x68));
        if (pvVar1 != (LPVOID)0x0) {
          FUN_18001d45c(pvVar1);
          *(undefined8 *)(uVar4 + *(longlong *)(param_1 + 0x68)) = 0;
        }
        uVar3 = (int)uVar2 + 1;
        uVar2 = (ulonglong)uVar3;
        uVar4 = uVar4 + 8;
      } while ((int)uVar3 < *(int *)(param_1 + 0x28));
    }
    *(undefined4 *)(param_1 + 0x28) = 0;
  }
  return;
}



void FUN_18000c500(LPVOID param_1)

{
  LPVOID pvVar1;
  
  FUN_18000c450((longlong)param_1);
  FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x58));
  FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x68));
  if (*(LPVOID *)((longlong)param_1 + 0x70) != (LPVOID)0x0) {
    FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x70));
    *(undefined8 *)((longlong)param_1 + 0x70) = 0;
  }
  pvVar1 = *(LPVOID *)((longlong)param_1 + 0x60);
  if (pvVar1 != (LPVOID)0x0) {
    FUN_18001d45c(*(LPVOID *)((longlong)pvVar1 + 0x10));
    FUN_18001d45c(pvVar1);
    *(undefined8 *)((longlong)param_1 + 0x60) = 0;
  }
  FUN_18001d45c(param_1);
  return;
}



int * FUN_18000c570(LPVOID param_1)

{
  int *piVar1;
  longlong lVar2;
  LPVOID pvVar3;
  longlong lVar4;
  undefined8 uVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  longlong lVar9;
  longlong lVar10;
  
  lVar10 = DAT_180049f30;
  piVar6 = *(int **)((longlong)param_1 + 0x78);
  if (piVar6 == (int *)0x0) {
    pvVar3 = FUN_18001ee18(1,0x150);
    if (pvVar3 != (LPVOID)0x0) {
      *(longlong *)((longlong)pvVar3 + 8) = (longlong)pvVar3 + 0x10;
    }
    *(LPVOID *)((longlong)param_1 + 0x78) = pvVar3;
    FUN_18000d2c0((longlong)param_1,lVar10);
    FUN_18000c250((longlong)param_1);
    piVar6 = *(int **)((longlong)param_1 + 0x78);
  }
  FUN_18000c450((longlong)param_1);
  FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x58));
  FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x68));
  if (*(LPVOID *)((longlong)param_1 + 0x70) != (LPVOID)0x0) {
    FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x70));
    *(undefined8 *)((longlong)param_1 + 0x70) = 0;
  }
  pvVar3 = *(LPVOID *)((longlong)param_1 + 0x60);
  if (pvVar3 != (LPVOID)0x0) {
    FUN_18001d45c(*(LPVOID *)((longlong)pvVar3 + 0x10));
    FUN_18001d45c(pvVar3);
    *(undefined8 *)((longlong)param_1 + 0x60) = 0;
  }
  FUN_18001d45c(param_1);
  if (piVar6 != (int *)0x0) {
    iVar8 = 0;
    if (0 < *piVar6) {
      lVar9 = 0;
      do {
        iVar7 = 0;
        piVar1 = *(int **)(lVar9 + *(longlong *)(piVar6 + 2));
        if (0 < *piVar1) {
          lVar4 = 0;
          do {
            lVar2 = *(longlong *)(*(longlong *)(piVar1 + 6) + lVar4);
            if (*(int *)(lVar10 + 0x8c) == 0) {
              *(char *)(lVar2 + 0xd) = *(char *)(lVar2 + 0xd) << 2;
            }
            else {
              *(undefined1 *)(lVar2 + 0xd) = 0xfb;
            }
            iVar7 = iVar7 + 1;
            lVar4 = lVar4 + 8;
          } while (iVar7 < *piVar1);
        }
        iVar8 = iVar8 + 1;
        lVar9 = lVar9 + 8;
      } while (iVar8 < *piVar6);
    }
    if ((*piVar6 == 0) || (uVar5 = FUN_18000c0f0(piVar6,lVar10), (int)uVar5 < 0)) {
      iVar8 = 0;
      if (0 < *piVar6) {
        lVar10 = 0;
        do {
          pvVar3 = *(LPVOID *)(lVar10 + *(longlong *)(piVar6 + 2));
          if (pvVar3 != (LPVOID)0x0) {
            FUN_18001d45c(*(LPVOID *)((longlong)pvVar3 + 0x10));
            FUN_18001d45c(pvVar3);
          }
          iVar8 = iVar8 + 1;
          lVar10 = lVar10 + 8;
        } while (iVar8 < *piVar6);
      }
      FUN_18001d45c(piVar6);
      return (int *)0x0;
    }
  }
  return piVar6;
}



int FUN_18000c730(longlong *param_1,longlong param_2,uint param_3)

{
  int iVar1;
  longlong lVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  iVar1 = *(int *)(param_2 + 4);
  iVar5 = 0;
  iVar6 = 0;
  iVar4 = -1;
  if (0 < iVar1) {
    do {
      iVar3 = 0;
      lVar2 = 0;
      if (0 < iVar1) {
        do {
          if ((*(byte *)(*(longlong *)(param_2 + 0x38) + lVar2) == param_3) &&
             (*(char *)(lVar2 + *param_1) != '\0')) {
            iVar3 = iVar3 + 1;
          }
          lVar2 = lVar2 + 1;
        } while (lVar2 < iVar1);
      }
      if (iVar5 < iVar3) {
        iVar4 = iVar6;
        iVar5 = iVar3;
      }
      iVar6 = iVar6 + 1;
      param_1 = param_1 + 1;
    } while (iVar6 < iVar1);
  }
  iVar6 = -1;
  if ((int)((5 < iVar1) + 2) <= iVar5) {
    iVar6 = iVar4;
  }
  return iVar6;
}



void FUN_18000c7e0(int *param_1,int *param_2,int *param_3,int param_4,longlong param_5)

{
  char cVar1;
  int iVar2;
  undefined8 *puVar3;
  undefined8 uVar4;
  int iVar5;
  int *piVar6;
  longlong lVar7;
  int iVar8;
  longlong lVar9;
  longlong lVar10;
  int *piVar11;
  int iVar12;
  undefined8 *puVar13;
  int iVar14;
  
  iVar8 = -1;
  iVar14 = 0;
  if (param_5 == 0) {
    param_5._0_4_ = 0;
  }
  else {
    iVar8 = *(int *)(param_5 + 0x5c);
    param_5._0_4_ = *(int *)(param_5 + 0x60);
  }
  iVar2 = *param_2;
  lVar10 = 0;
  if ((longlong)iVar2 < 1) {
    *param_2 = 0;
    return;
  }
  lVar9 = 0;
  do {
    lVar7 = 0;
    piVar6 = *(int **)(*(longlong *)(param_2 + 6) + lVar10 * 8);
    if (0 < *param_3) {
      do {
        if (*(int **)(*(longlong *)(param_3 + 10) + lVar7 * 8) == piVar6) {
          piVar11 = *(int **)(*(longlong *)(param_3 + 8) + lVar7 * 8);
LAB_18000c91e:
          if (piVar11 != (int *)0x0) {
            if ((0 < (int)*(char *)((longlong)piVar6 + 0xd) -
                     (int)*(char *)((longlong)piVar11 + 0xd)) ||
               (((int)*(char *)((longlong)piVar6 + 0xd) == (int)*(char *)((longlong)piVar11 + 0xd)
                && ((uint)piVar11[2] < (uint)piVar6[2])))) {
              uVar4 = *(undefined8 *)(piVar6 + 2);
              *(undefined8 *)piVar11 = *(undefined8 *)piVar6;
              *(undefined8 *)(piVar11 + 2) = uVar4;
              uVar4 = *(undefined8 *)(piVar6 + 6);
              *(undefined8 *)(piVar11 + 4) = *(undefined8 *)(piVar6 + 4);
              *(undefined8 *)(piVar11 + 6) = uVar4;
              uVar4 = *(undefined8 *)(piVar6 + 10);
              *(undefined8 *)(piVar11 + 8) = *(undefined8 *)(piVar6 + 8);
              *(undefined8 *)(piVar11 + 10) = uVar4;
              uVar4 = *(undefined8 *)(piVar6 + 0xe);
              *(undefined8 *)(piVar11 + 0xc) = *(undefined8 *)(piVar6 + 0xc);
              *(undefined8 *)(piVar11 + 0xe) = uVar4;
              uVar4 = *(undefined8 *)(piVar6 + 0x12);
              *(undefined8 *)(piVar11 + 0x10) = *(undefined8 *)(piVar6 + 0x10);
              *(undefined8 *)(piVar11 + 0x12) = uVar4;
            }
            if (0 < iVar8) {
              puVar13 = *(undefined8 **)(param_1 + 6);
              iVar12 = 0;
              if (0 < *param_1) {
                do {
                  piVar6 = (int *)*puVar13;
                  iVar5 = *piVar6 - *piVar11;
                  if (iVar5 < 0) {
                    iVar5 = *piVar11 - *piVar6;
                  }
                  if (iVar5 < iVar8) {
                    iVar5 = piVar6[1] - piVar11[1];
                    if (iVar5 < 0) {
                      iVar5 = piVar11[1] - piVar6[1];
                    }
                    if ((iVar5 < iVar8) &&
                       ((int)param_5 <
                        (int)*(char *)((longlong)piVar11 + 0xd) -
                        (int)*(char *)((longlong)piVar6 + 0xd))) {
                      *(undefined2 *)((longlong)piVar6 + 0xe) = 0xffff;
                    }
                  }
                  iVar12 = iVar12 + 1;
                  puVar13 = puVar13 + 1;
                } while (iVar12 < *param_1);
              }
            }
            goto LAB_18000c8eb;
          }
          break;
        }
        if (*(int **)(*(longlong *)(param_3 + 8) + lVar7 * 8) == piVar6) {
          piVar11 = *(int **)(*(longlong *)(param_3 + 10) + lVar7 * 8);
          goto LAB_18000c91e;
        }
        lVar7 = lVar7 + 1;
      } while (lVar7 < *param_3);
    }
    piVar6 = FUN_18000a0b0(param_1,piVar6,9,(int *)0x0);
    if (piVar6 == (int *)0x0) {
      if (lVar9 != lVar10) {
        puVar13 = *(undefined8 **)(*(longlong *)(param_2 + 6) + lVar10 * 8);
        puVar3 = *(undefined8 **)(*(longlong *)(param_2 + 6) + lVar9 * 8);
        uVar4 = puVar13[1];
        *puVar3 = *puVar13;
        puVar3[1] = uVar4;
        uVar4 = puVar13[3];
        puVar3[2] = puVar13[2];
        puVar3[3] = uVar4;
        uVar4 = puVar13[5];
        puVar3[4] = puVar13[4];
        puVar3[5] = uVar4;
        uVar4 = puVar13[7];
        puVar3[6] = puVar13[6];
        puVar3[7] = uVar4;
        uVar4 = puVar13[9];
        puVar3[8] = puVar13[8];
        puVar3[9] = uVar4;
      }
      iVar14 = iVar14 + 1;
      lVar9 = lVar9 + 1;
    }
    else if (param_4 != 0) {
      cVar1 = *(char *)((longlong)piVar6 + 0xd);
      puVar13 = *(undefined8 **)(*(longlong *)(param_2 + 6) + lVar10 * 8);
      if ((cVar1 < *(char *)((longlong)puVar13 + 0xd)) && (-1 < cVar1)) {
        uVar4 = puVar13[1];
        *(undefined8 *)piVar6 = *puVar13;
        *(undefined8 *)(piVar6 + 2) = uVar4;
        uVar4 = puVar13[3];
        *(undefined8 *)(piVar6 + 4) = puVar13[2];
        *(undefined8 *)(piVar6 + 6) = uVar4;
        uVar4 = puVar13[5];
        *(undefined8 *)(piVar6 + 8) = puVar13[4];
        *(undefined8 *)(piVar6 + 10) = uVar4;
        uVar4 = puVar13[7];
        *(undefined8 *)(piVar6 + 0xc) = puVar13[6];
        *(undefined8 *)(piVar6 + 0xe) = uVar4;
        uVar4 = puVar13[9];
        *(undefined8 *)(piVar6 + 0x10) = puVar13[8];
        *(undefined8 *)(piVar6 + 0x12) = uVar4;
      }
      else if ((((uint)piVar6[2] < *(uint *)(puVar13 + 1)) ||
               (*(char *)((longlong)puVar13 + 0xc) != (char)piVar6[3])) &&
              (*(char *)((longlong)piVar6 + 0xd) = cVar1 + -1, (char)(cVar1 + -1) < -3)) {
        *(undefined2 *)((longlong)piVar6 + 0xe) = 0xffff;
        puVar13 = *(undefined8 **)(*(longlong *)(param_2 + 6) + lVar10 * 8);
        uVar4 = puVar13[1];
        *(undefined8 *)piVar6 = *puVar13;
        *(undefined8 *)(piVar6 + 2) = uVar4;
        uVar4 = puVar13[3];
        *(undefined8 *)(piVar6 + 4) = puVar13[2];
        *(undefined8 *)(piVar6 + 6) = uVar4;
        uVar4 = puVar13[5];
        *(undefined8 *)(piVar6 + 8) = puVar13[4];
        *(undefined8 *)(piVar6 + 10) = uVar4;
        uVar4 = puVar13[7];
        *(undefined8 *)(piVar6 + 0xc) = puVar13[6];
        *(undefined8 *)(piVar6 + 0xe) = uVar4;
        uVar4 = puVar13[9];
        *(undefined8 *)(piVar6 + 0x10) = puVar13[8];
        *(undefined8 *)(piVar6 + 0x12) = uVar4;
      }
    }
LAB_18000c8eb:
    lVar10 = lVar10 + 1;
    if (iVar2 <= lVar10) {
      *param_2 = iVar14;
      return;
    }
  } while( true );
}



int * FUN_18000cab0(int *param_1,int param_2,longlong *param_3,longlong param_4,int param_5,
                   int param_6,short param_7,int param_8,longlong param_9)

{
  int *piVar1;
  short sVar2;
  int *piVar3;
  int *piVar4;
  longlong lVar5;
  int iVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  longlong *plVar11;
  int iVar12;
  int *local_res8;
  int local_48;
  longlong local_40;
  
  local_48 = 0;
  local_res8 = param_1;
  if (0 < *(int *)(param_4 + 4)) {
    local_40 = 0;
    do {
      if ((*(char *)(*(longlong *)(param_4 + 0x38) + local_40) == '\0') &&
         (lVar5 = (longlong)param_2 * 8, *(char *)(param_3[param_2] + local_40) != '\0')) {
        piVar3 = *(int **)(*(longlong *)(param_4 + 0x48) + local_40 * 8);
        piVar4 = *(int **)(*(longlong *)(*(longlong *)(param_4 + 0x88) + lVar5) + local_40 * 8);
        FUN_18000bd40(piVar3,(short)piVar4[5]);
        iVar12 = piVar4[6];
        sVar2 = *(short *)((longlong)piVar4 + 0x16);
        iVar10 = 0;
        if (0 < *piVar3) {
          lVar7 = 0;
          do {
            iVar10 = iVar10 + 1;
            **(int **)(lVar7 + *(longlong *)(piVar3 + 6)) =
                 **(int **)(lVar7 + *(longlong *)(piVar3 + 6)) - (int)sVar2;
            piVar1 = (int *)(*(longlong *)(lVar7 + *(longlong *)(piVar3 + 6)) + 4);
            *piVar1 = *piVar1 - (int)(short)iVar12;
            lVar7 = lVar7 + 8;
          } while (iVar10 < *piVar3);
        }
        lVar7 = 0;
        iVar12 = 0;
        if (0 < *piVar3) {
          do {
            iVar12 = iVar12 + 1;
            *(undefined1 *)(*(longlong *)(*(longlong *)(piVar3 + 6) + -8 + (lVar7 + 1) * 8) + 0xd) =
                 *(undefined1 *)
                  (lVar7 + *(longlong *)
                            (*(longlong *)(lVar5 + *(longlong *)(param_4 + 0x50)) + local_40 * 8));
            lVar7 = lVar7 + 1;
          } while (iVar12 < *piVar3);
        }
        iVar12 = 0;
        if (0 < *piVar4) {
          lVar5 = 0;
          do {
            plVar11 = (longlong *)(*(longlong *)(piVar4 + 10) + lVar5);
            iVar12 = iVar12 + 1;
            lVar5 = lVar5 + 8;
            *(longlong *)(*(longlong *)(piVar4 + 10) + -8 + lVar5) =
                 (*(longlong **)(piVar3 + 6))
                 [(int)((*plVar11 - **(longlong **)(piVar3 + 6)) / 0x50)];
          } while (iVar12 < *piVar4);
        }
        FUN_18000bd40(piVar3,param_7);
        iVar12 = 0;
        if (0 < *piVar3) {
          lVar5 = 0;
          do {
            iVar12 = iVar12 + 1;
            **(int **)(lVar5 + *(longlong *)(piVar3 + 6)) =
                 **(int **)(lVar5 + *(longlong *)(piVar3 + 6)) - param_5;
            piVar1 = (int *)(*(longlong *)(*(longlong *)(piVar3 + 6) + -8 + lVar5 + 8) + 4);
            *piVar1 = *piVar1 - param_6;
            lVar5 = lVar5 + 8;
          } while (iVar12 < *piVar3);
        }
        iVar12 = *local_res8;
        FUN_18000c7e0(local_res8,piVar3,piVar4,0,param_9);
        iVar10 = *piVar3;
        piVar4 = local_res8;
        if (iVar10 != 0) {
          iVar9 = iVar10 + iVar12;
          if (0x1000 < iVar9) {
            iVar9 = 0x1000;
            iVar10 = 0x1000 - iVar12;
            *piVar3 = iVar10;
          }
          piVar4 = FUN_18000e6f0(local_res8,iVar9);
          if (piVar4 == (int *)0x0) goto LAB_18000cd9a;
          FUN_18001d560(*(undefined8 **)(*(longlong *)(piVar4 + 6) + (longlong)iVar12 * 8),
                        (undefined8 *)**(undefined8 **)(piVar3 + 6),(longlong)iVar10 * 0x50);
          *piVar4 = iVar9;
        }
        if (piVar4 != (int *)0x0) {
          FUN_18001d45c(*(LPVOID *)(piVar3 + 4));
          FUN_18001d45c(piVar3);
          *(undefined8 *)(*(longlong *)(param_4 + 0x48) + local_40 * 8) = 0;
          iVar12 = 0;
          *(char *)(*(longlong *)(param_4 + 0x38) + local_40) = (char)param_8 + '\x01';
          lVar5 = 0;
          local_res8 = piVar4;
          if (0 < *(int *)(param_4 + 4)) {
            do {
              iVar12 = iVar12 + 1;
              *(undefined1 *)(param_3[lVar5] + local_40) = 0;
              *(undefined1 *)(lVar5 + param_3[local_40]) = 0;
              lVar5 = lVar5 + 1;
            } while (iVar12 < *(int *)(param_4 + 4));
          }
        }
      }
LAB_18000cd9a:
      local_40 = local_40 + 1;
      local_48 = local_48 + 1;
    } while (local_48 < *(int *)(param_4 + 4));
  }
  while( true ) {
    iVar12 = *(int *)(param_4 + 4);
    iVar10 = -1;
    iVar9 = 0;
    iVar8 = 0;
    plVar11 = param_3;
    iVar6 = -1;
    if (0 < iVar12) {
      do {
        iVar10 = iVar6;
        iVar6 = 0;
        lVar5 = 0;
        if (0 < iVar12) {
          do {
            if (((uint)*(byte *)(*(longlong *)(param_4 + 0x38) + lVar5) == param_8 + 1U) &&
               (*(char *)(lVar5 + *plVar11) != '\0')) {
              iVar6 = iVar6 + 1;
            }
            lVar5 = lVar5 + 1;
          } while (lVar5 < iVar12);
        }
        if (iVar9 < iVar6) {
          iVar10 = iVar8;
          iVar9 = iVar6;
        }
        iVar8 = iVar8 + 1;
        plVar11 = plVar11 + 1;
        iVar6 = iVar10;
      } while (iVar8 < iVar12);
    }
    iVar6 = -1;
    if ((int)((5 < iVar12) + 2) <= iVar9) {
      iVar6 = iVar10;
    }
    if (iVar6 < 0) break;
    lVar5 = *(longlong *)
             (*(longlong *)(*(longlong *)(param_4 + 0x88) + (longlong)param_2 * 8) +
             (longlong)iVar6 * 8);
    local_res8 = FUN_18000cab0(local_res8,iVar6,param_3,param_4,(int)*(short *)(lVar5 + 0x16),
                               (int)*(short *)(lVar5 + 0x18),*(short *)(lVar5 + 0x14),param_8 + 1,
                               param_9);
  }
  return local_res8;
}



void FUN_18000cee0(longlong param_1,int param_2,int param_3,int *param_4,longlong param_5)

{
  longlong lVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  uint *puVar6;
  LPVOID pvVar7;
  ulonglong uVar8;
  undefined1 uVar9;
  uint uVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  longlong lVar13;
  
  lVar13 = (longlong)param_3;
  piVar5 = (int *)FUN_18001ee18(1,0x38);
  if (piVar5 != (int *)0x0) {
    puVar6 = (uint *)FUN_18000e7b0(param_4);
    lVar1 = (longlong)param_2 * 8;
    iVar4 = FUN_18000b7b0(*(uint **)(lVar1 + *(longlong *)(param_1 + 0x48)),puVar6,param_5,
                          (undefined8 *)piVar5);
    iVar3 = *piVar5;
    uVar12 = 0;
    if ((iVar3 < 2) || (iVar4 < *(int *)(param_5 + 0x78))) {
      uVar9 = 0;
    }
    else {
      if (0xff < iVar3) {
        iVar3 = 0xff;
      }
      uVar9 = (undefined1)iVar3;
    }
    *(undefined1 *)(lVar13 + *(longlong *)(lVar1 + *(longlong *)(param_1 + 0x40))) = uVar9;
    if (*(byte *)(lVar13 + *(longlong *)(lVar1 + *(longlong *)(param_1 + 0x40))) < 2) {
      if (*(LPVOID *)(piVar5 + 2) != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)(piVar5 + 2));
      }
      if (*(LPVOID *)(piVar5 + 8) != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)(piVar5 + 8));
      }
      if (*(LPVOID *)(piVar5 + 10) != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)(piVar5 + 10));
      }
      piVar5[2] = 0;
      piVar5[3] = 0;
      piVar5[8] = 0;
      piVar5[9] = 0;
      piVar5[10] = 0;
      piVar5[0xb] = 0;
      FUN_18001d45c(piVar5);
    }
    else {
      uVar8 = uVar12;
      uVar11 = uVar12;
      if (0 < *piVar5) {
        do {
          cVar2 = *(char *)(*(longlong *)(uVar8 + *(longlong *)(piVar5 + 8)) + 0xd);
          if (cVar2 < '\x7f') {
            *(char *)(*(longlong *)(uVar8 + *(longlong *)(piVar5 + 8)) + 0xd) = cVar2 + '\x01';
          }
          cVar2 = *(char *)(*(longlong *)(*(longlong *)(piVar5 + 10) + uVar8) + 0xd);
          if (cVar2 < '\x7f') {
            *(char *)(*(longlong *)(*(longlong *)(piVar5 + 10) + uVar8) + 0xd) = cVar2 + '\x01';
          }
          uVar10 = (int)uVar11 + 1;
          uVar8 = uVar8 + 8;
          uVar11 = (ulonglong)uVar10;
        } while ((int)uVar10 < *piVar5);
      }
      uVar8 = uVar12;
      uVar11 = uVar12;
      if (0 < *piVar5) {
        do {
          uVar10 = (int)uVar8 + 1;
          *(longlong *)(*(longlong *)(piVar5 + 10) + -8 + uVar11 + 8) =
               ((*(longlong *)(*(longlong *)(piVar5 + 10) + uVar11) - **(longlong **)(puVar6 + 6)) /
               0x50) * 0x50 +
               **(longlong **)(*(longlong *)(*(longlong *)(param_1 + 0x48) + lVar13 * 8) + 0x18);
          uVar8 = (ulonglong)uVar10;
          uVar11 = uVar11 + 8;
        } while ((int)uVar10 < *piVar5);
      }
      *(int **)(*(longlong *)(*(longlong *)(param_1 + 0x88) + lVar1) + lVar13 * 8) = piVar5;
      pvVar7 = FUN_18001ed60((longlong)(int)*puVar6);
      *(LPVOID *)(*(longlong *)(*(longlong *)(param_1 + 0x50) + lVar1) + lVar13 * 8) = pvVar7;
      uVar8 = uVar12;
      if (0 < (int)*puVar6) {
        do {
          uVar10 = (int)uVar12 + 1;
          uVar12 = (ulonglong)uVar10;
          *(undefined1 *)
           (uVar8 + *(longlong *)(*(longlong *)(*(longlong *)(param_1 + 0x50) + lVar1) + lVar13 * 8)
           ) = *(undefined1 *)
                (*(longlong *)(*(longlong *)(puVar6 + 6) + -8 + (uVar8 + 1) * 8) + 0xd);
          uVar8 = uVar8 + 1;
        } while ((int)uVar10 < (int)*puVar6);
      }
    }
    if (puVar6 != (uint *)0x0) {
      FUN_18001d45c(*(LPVOID *)(puVar6 + 4));
      FUN_18001d45c(puVar6);
    }
  }
  return;
}



LPVOID FUN_18000d110(uint *param_1,uint *param_2,longlong param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  LPVOID pvVar4;
  undefined2 *puVar5;
  undefined4 *puVar6;
  LPVOID pvVar7;
  LPVOID pvVar8;
  LPVOID pvVar9;
  uint uVar10;
  undefined8 local_58;
  LPVOID local_50;
  undefined8 local_48;
  undefined8 local_40;
  LPVOID local_38;
  LPVOID local_30;
  undefined8 local_28;
  
  pvVar7 = (LPVOID)0x0;
  pvVar8 = (LPVOID)0x0;
  pvVar4 = FUN_18001ed60((longlong)(int)*param_2 * 0xc);
  pvVar9 = pvVar4;
  if (pvVar4 != (LPVOID)0x0) {
    if (0 < (int)*param_2) {
      puVar5 = (undefined2 *)((longlong)pvVar4 + 8);
      puVar6 = (undefined4 *)**(undefined8 **)(param_2 + 6);
      pvVar9 = pvVar7;
      do {
        uVar10 = (int)pvVar9 + 1;
        pvVar9 = (LPVOID)(ulonglong)uVar10;
        *(undefined4 *)(puVar5 + -4) = *puVar6;
        *(undefined4 *)(puVar5 + -2) = puVar6[1];
        *puVar5 = *(undefined2 *)((longlong)puVar6 + 0xe);
        puVar5 = puVar5 + 6;
        puVar6 = puVar6 + 0x14;
      } while ((int)uVar10 < (int)*param_2);
    }
    local_58 = 0;
    local_50 = (LPVOID)0x0;
    local_48 = 0;
    local_40 = 0;
    local_38 = (LPVOID)0x0;
    local_30 = (LPVOID)0x0;
    local_28 = 0;
    iVar2 = FUN_18000ab80(param_1,param_2,param_3,&local_58,0,(char *)0x0,(longlong *)0x0);
    pvVar9 = pvVar7;
    if ((1 < (int)local_58) && (pvVar9 = pvVar8, *(int *)(param_3 + 0x78) <= iVar2)) {
      iVar1 = *(int *)(param_3 + 0x74);
      iVar2 = iVar1 * 2 + 10;
      if (iVar1 != 0) {
        iVar3 = (int)local_48._6_2_;
        if (local_48 < 0) {
          iVar3 = -iVar3;
        }
        if (iVar3 < iVar1 * 4) {
          iVar3 = (int)(short)local_40;
          if ((short)local_40 < 0) {
            iVar3 = -iVar3;
          }
          if ((SBORROW4(iVar3,iVar1 * 4) != iVar3 + iVar1 * -4 < 0) &&
             ((local_48._4_2_ < iVar2 || (0x168 - iVar2 < (int)local_48._4_2_)))) {
            pvVar9 = (LPVOID)0x1;
          }
        }
      }
    }
    if (local_50 != (LPVOID)0x0) {
      FUN_18001d45c(local_50);
    }
    if (local_38 != (LPVOID)0x0) {
      FUN_18001d45c(local_38);
    }
    if (local_30 != (LPVOID)0x0) {
      FUN_18001d45c(local_30);
    }
    if (0 < (int)*param_2) {
      puVar5 = (undefined2 *)((longlong)pvVar4 + 8);
      puVar6 = (undefined4 *)**(undefined8 **)(param_2 + 6);
      do {
        uVar10 = (int)pvVar7 + 1;
        pvVar7 = (LPVOID)(ulonglong)uVar10;
        *puVar6 = *(undefined4 *)(puVar5 + -4);
        puVar6[1] = *(undefined4 *)(puVar5 + -2);
        *(undefined2 *)((longlong)puVar6 + 0xe) = *puVar5;
        puVar5 = puVar5 + 6;
        puVar6 = puVar6 + 0x14;
      } while ((int)uVar10 < (int)*param_2);
    }
    FUN_18001d45c(pvVar4);
  }
  return pvVar9;
}



undefined8 FUN_18000d2c0(longlong param_1,longlong param_2)

{
  int iVar1;
  undefined8 *puVar2;
  int iVar3;
  longlong *plVar4;
  int *piVar5;
  longlong lVar6;
  int *piVar7;
  int *piVar8;
  longlong *plVar9;
  longlong lVar10;
  ulonglong uVar11;
  uint uVar12;
  ulonglong uVar13;
  
  iVar3 = *(int *)(param_1 + 0x10);
  puVar2 = *(undefined8 **)(param_1 + 0x40);
  plVar4 = (longlong *)FUN_1800076f0(iVar3,iVar3);
  plVar9 = (longlong *)0x0;
  if (plVar4 != (longlong *)0x0) {
    FUN_18001d560((undefined8 *)*plVar4,(undefined8 *)*puVar2,(longlong)(iVar3 * iVar3));
    plVar9 = plVar4;
  }
  FUN_18001dbc0(*(undefined1 (**) [16])(param_1 + 0x38),0,(longlong)*(int *)(param_2 + 0x70));
  do {
    iVar3 = FUN_18000c730(plVar9,param_1,0);
    if (iVar3 < 0) break;
    piVar7 = *(int **)(*(longlong *)(param_1 + 0x48) + (longlong)iVar3 * 8);
    lVar10 = (longlong)*piVar7;
    piVar5 = (int *)FUN_18001ee18(1,(longlong)(*piVar7 * 0x58 + 0x20));
    if (piVar5 == (int *)0x0) {
      piVar5 = (int *)0x0;
    }
    else {
      piVar8 = piVar5 + 8 + lVar10 * 2;
      lVar6 = 0;
      *(int **)(piVar5 + 6) = piVar5 + 8;
      if (0 < lVar10) {
        do {
          lVar6 = lVar6 + 1;
          *(int **)(*(longlong *)(piVar5 + 6) + -8 + lVar6 * 8) = piVar8;
          piVar8 = piVar8 + 0x14;
        } while (lVar6 < lVar10);
      }
      *piVar5 = *piVar7;
      *(short *)(piVar5 + 1) = (short)piVar7[1];
      *(undefined2 *)((longlong)piVar5 + 6) = *(undefined2 *)((longlong)piVar7 + 6);
      *(char *)(piVar5 + 2) = (char)piVar7[2];
      *(undefined1 *)((longlong)piVar5 + 9) = *(undefined1 *)((longlong)piVar7 + 9);
      *(undefined1 *)((longlong)piVar5 + 10) = *(undefined1 *)((longlong)piVar7 + 10);
      if ((*(undefined8 **)(piVar5 + 4) != (undefined8 *)0x0) &&
         (*(undefined8 **)(piVar7 + 4) != (undefined8 *)0x0)) {
        FUN_18001d560(*(undefined8 **)(piVar5 + 4),*(undefined8 **)(piVar7 + 4),
                      (longlong)
                      (int)((uint)*(ushort *)(piVar7 + 1) * (uint)*(ushort *)((longlong)piVar7 + 6))
                     );
      }
      FUN_18001d560((undefined8 *)**(undefined8 **)(piVar5 + 6),
                    (undefined8 *)**(undefined8 **)(piVar7 + 6),(longlong)*piVar7 * 0x50);
    }
    iVar1 = *piVar5;
    *(undefined1 *)((longlong)iVar3 + *(longlong *)(param_1 + 0x38)) = 1;
    piVar7 = FUN_18000cab0(piVar5,iVar3,plVar9,param_1,0,0,0,1,param_2);
    *(int **)(*(longlong *)(*(int **)(param_1 + 0x78) + 2) +
             (longlong)**(int **)(param_1 + 0x78) * 8) = piVar7;
    **(int **)(param_1 + 0x78) = **(int **)(param_1 + 0x78) + 1;
  } while (iVar1 < *piVar7);
  uVar11 = 0;
  FUN_18001d45c(plVar9);
  uVar13 = uVar11;
  if (0 < *(int *)(param_1 + 4)) {
    do {
      if (*(char *)(uVar11 + *(longlong *)(param_1 + 0x38)) == '\0') {
        *(undefined8 *)
         (*(longlong *)(*(int **)(param_1 + 0x78) + 2) + (longlong)**(int **)(param_1 + 0x78) * 8) =
             *(undefined8 *)(*(longlong *)(param_1 + 0x48) + uVar11 * 8);
        **(int **)(param_1 + 0x78) = **(int **)(param_1 + 0x78) + 1;
        *(undefined8 *)(*(longlong *)(param_1 + 0x48) + uVar11 * 8) = 0;
      }
      uVar12 = (int)uVar13 + 1;
      uVar11 = uVar11 + 1;
      uVar13 = (ulonglong)uVar12;
    } while ((int)uVar12 < *(int *)(param_1 + 4));
  }
  return 0;
}



int * FUN_18000d500(uint *param_1,longlong param_2)

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  LPVOID pvVar4;
  int *piVar5;
  undefined8 uVar6;
  int *piVar7;
  int *piVar8;
  int *piVar9;
  bool bVar10;
  
  lVar1 = DAT_180049f30;
  piVar9 = (int *)0x0;
  bVar10 = *(int *)(DAT_180049f30 + 0x90) != 0;
  piVar8 = piVar9;
  if ((!bVar10) && (piVar8 = (int *)0x0, *(int *)(DAT_180049f30 + 0x7c) == 1)) {
    if (*(uint **)(param_2 + 0x60) != (uint *)0x0) {
      pvVar4 = FUN_18000d110(*(uint **)(param_2 + 0x60),param_1,DAT_180049f30);
      if (0 < (int)pvVar4) {
        piVar8 = (int *)0x3;
        goto LAB_18000d589;
      }
      pvVar4 = *(LPVOID *)(param_2 + 0x60);
      if (pvVar4 != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)((longlong)pvVar4 + 0x10));
        FUN_18001d45c(pvVar4);
      }
    }
    piVar7 = FUN_18000e7b0((int *)param_1);
    *(int **)(param_2 + 0x60) = piVar7;
  }
LAB_18000d589:
  iVar2 = *(int *)(param_2 + 4);
  if (*(int *)(lVar1 + 0x6c) < iVar2) {
    piVar7 = *(int **)(param_2 + 0x78);
    if (piVar7 == (int *)0x0) {
      piVar5 = (int *)FUN_18001ee18(1,0x150);
      piVar7 = piVar9;
      if (piVar5 != (int *)0x0) {
        *(int **)(piVar5 + 2) = piVar5 + 4;
        piVar7 = piVar5;
      }
      *(int **)(param_2 + 0x78) = piVar7;
      FUN_18000d2c0(param_2,lVar1);
      FUN_18000c250(param_2);
      piVar7 = *(int **)(param_2 + 0x78);
      if ((!bVar10) && (*(int *)(lVar1 + 0x7c) == 2)) {
        iVar2 = FUN_18000de50(piVar7);
        *(int *)(param_2 + 0x14) = iVar2;
      }
    }
    iVar2 = *piVar7;
    piVar5 = (int *)FUN_18001ee18(1,((longlong)iVar2 + 2) * 0x10);
    if (piVar5 != (int *)0x0) {
      *piVar5 = iVar2;
      *(int **)(piVar5 + 4) = piVar5 + 8;
      *(int **)(piVar5 + 6) = piVar5 + 8 + (longlong)iVar2 * 2;
      piVar9 = piVar5;
    }
    iVar2 = FUN_18000bad0(piVar7,(int *)param_1,(longlong)piVar9,lVar1,(uint)bVar10);
    if (iVar2 < *(int *)(lVar1 + 0x78)) {
      piVar7 = FUN_18000ddc0(piVar7,(int *)param_1,lVar1);
      if ((!bVar10) && (*(int *)(lVar1 + 0x7c) == 2)) {
        iVar2 = FUN_18000de50(piVar7);
        *(int *)(param_2 + 0x14) = iVar2;
      }
    }
    else {
      uVar6 = FUN_18000d880(piVar7,piVar9,lVar1);
      if ((int)uVar6 == -0x3eb) {
        piVar7 = FUN_18000ddc0(piVar7,(int *)param_1,lVar1);
      }
      if ((!bVar10) && (*(int *)(lVar1 + 0x7c) == 2)) {
        iVar2 = *(int *)(param_2 + 0x14);
        iVar3 = FUN_18000de50(piVar7);
        iVar3 = iVar3 - iVar2;
        *(int *)(param_2 + 0x14) = iVar2 + iVar3;
        if ((-1 < iVar3) && (iVar3 < *(int *)(lVar1 + 0x80))) {
          FUN_18000e960(piVar9);
          return (int *)0x3;
        }
      }
    }
    FUN_18000e960(piVar9);
  }
  else {
    piVar7 = FUN_18000e7b0((int *)param_1);
    *(int **)(*(longlong *)(param_2 + 0x48) + (longlong)*(int *)(param_2 + 4) * 8) = piVar7;
    if (*(longlong *)(*(longlong *)(param_2 + 0x48) + (longlong)*(int *)(param_2 + 4) * 8) == 0) {
      piVar8 = (int *)0xfffffc18;
    }
    else {
      iVar3 = *(int *)(param_2 + 4) + 1;
      *(int *)(param_2 + 4) = iVar3;
      if (!bVar10) {
        piVar7 = piVar9;
        piVar5 = piVar9;
        if (0 < iVar3) {
          do {
            iVar3 = (int)piVar7;
            if (iVar3 != iVar2) {
              FUN_18000cee0(param_2,iVar3,iVar2,(int *)param_1,lVar1);
              FUN_18000cee0(param_2,iVar2,iVar3,
                            *(int **)((longlong)piVar5 + *(longlong *)(param_2 + 0x48)),lVar1);
            }
            piVar7 = (int *)(ulonglong)(iVar3 + 1U);
            piVar5 = piVar5 + 2;
          } while ((int)(iVar3 + 1U) < *(int *)(param_2 + 4));
        }
        if ((*(int *)(lVar1 + 0x7c) == 2) && (0 < iVar2)) {
          do {
            pvVar4 = FUN_18000d110(*(uint **)(*(longlong *)(param_2 + 0x48) + (longlong)piVar9 * 8),
                                   param_1,lVar1);
            if (0 < (int)pvVar4) {
              piVar8 = (int *)0x3;
            }
            piVar9 = (int *)((longlong)piVar9 + 1);
          } while ((longlong)piVar9 < (longlong)iVar2);
        }
      }
    }
  }
  return piVar8;
}



int * FUN_18000d7d0(int *param_1,int *param_2,int *param_3,int param_4,longlong param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = *param_1;
  FUN_18000c7e0(param_1,param_2,param_3,param_4,param_5);
  iVar2 = *param_2;
  if (iVar2 != 0) {
    iVar3 = iVar2 + iVar1;
    if (0x1000 < iVar3) {
      iVar3 = 0x1000;
      iVar2 = 0x1000 - iVar1;
      *param_2 = iVar2;
    }
    param_1 = FUN_18000e6f0(param_1,iVar3);
    if (param_1 != (int *)0x0) {
      FUN_18001d560(*(undefined8 **)(*(longlong *)(param_1 + 6) + (longlong)iVar1 * 8),
                    (undefined8 *)**(undefined8 **)(param_2 + 6),(longlong)iVar2 * 0x50);
      *param_1 = iVar3;
    }
  }
  return param_1;
}



undefined8 FUN_18000d880(int *param_1,int *param_2,longlong param_3)

{
  char cVar1;
  uint *puVar2;
  uint *puVar3;
  longlong lVar4;
  int *piVar5;
  LPVOID pvVar6;
  LPVOID pvVar7;
  int iVar8;
  int *piVar9;
  undefined8 uVar10;
  LPVOID pvVar11;
  longlong *plVar12;
  undefined2 *puVar13;
  longlong *plVar14;
  undefined4 *puVar15;
  ulonglong uVar16;
  longlong lVar17;
  int iVar18;
  ulonglong uVar19;
  uint uVar20;
  ulonglong uVar21;
  int iVar22;
  int local_res20;
  int local_98;
  longlong local_80;
  ulonglong local_78;
  LPVOID local_70;
  undefined8 local_68;
  undefined8 local_60;
  LPVOID local_58;
  longlong *local_50;
  undefined8 local_48;
  
  iVar8 = *(int *)(param_3 + 0x78);
  local_98 = 0;
  if (param_2 == (int *)0x0) {
    return 0xfffffc16;
  }
  iVar18 = 0;
  iVar22 = 0;
  if (0 < *param_1) {
    lVar17 = 0;
    do {
      piVar9 = *(int **)(lVar17 + *(longlong *)(param_2 + 4));
      if ((piVar9 != (int *)0x0) && (iVar8 * 2 <= piVar9[4])) {
        iVar22 = iVar22 + 1;
        piVar9 = FUN_18000d7d0(*(int **)(*(longlong *)(param_1 + 2) + lVar17),
                               *(int **)(lVar17 + *(longlong *)(param_2 + 6)),piVar9,1,param_3);
        if (piVar9 != (int *)0x0) {
          *(int **)(lVar17 + *(longlong *)(param_1 + 2)) = piVar9;
          pvVar11 = *(LPVOID *)(lVar17 + *(longlong *)(param_2 + 6));
          if (pvVar11 != (LPVOID)0x0) {
            FUN_18001d45c(*(LPVOID *)((longlong)pvVar11 + 0x10));
            FUN_18001d45c(pvVar11);
          }
          *(undefined8 *)(lVar17 + *(longlong *)(param_2 + 6)) = 0;
        }
      }
      iVar18 = iVar18 + 1;
      lVar17 = lVar17 + 8;
    } while (iVar18 < *param_1);
    if (iVar22 != 0) {
      iVar8 = 0;
      if (0 < *param_1) {
        lVar17 = 0;
        do {
          if ((*(int **)(*(longlong *)(param_2 + 4) + lVar17) != (int *)0x0) &&
             (3 < **(int **)(*(longlong *)(param_2 + 4) + lVar17))) {
            if (-1 < iVar8) {
              if (*param_2 < 2) goto LAB_18000dd74;
              lVar17 = (longlong)iVar8;
              local_80 = 0;
              local_res20 = 0;
              goto LAB_18000d9f0;
            }
            break;
          }
          iVar8 = iVar8 + 1;
          lVar17 = lVar17 + 8;
        } while (iVar8 < *param_1);
      }
      uVar10 = FUN_18000c0f0(param_1,param_3);
      return uVar10;
    }
  }
  return 0xfffffc15;
LAB_18000d9f0:
  if ((local_80 != lVar17) && (*(longlong *)(*(longlong *)(param_2 + 4) + local_80 * 8) != 0)) {
    piVar9 = *(int **)(*(longlong *)(param_1 + 2) + local_80 * 8);
    iVar8 = *piVar9;
    pvVar11 = FUN_18001ed60((longlong)iVar8 * 0xc);
    if (pvVar11 != (LPVOID)0x0) {
      plVar12 = (longlong *)0x0;
      if (0 < iVar8) {
        puVar13 = (undefined2 *)((longlong)pvVar11 + 8);
        puVar15 = (undefined4 *)**(undefined8 **)(piVar9 + 6);
        plVar14 = plVar12;
        do {
          uVar20 = (int)plVar14 + 1;
          plVar14 = (longlong *)(ulonglong)uVar20;
          *(undefined4 *)(puVar13 + -4) = *puVar15;
          *(undefined4 *)(puVar13 + -2) = puVar15[1];
          *puVar13 = *(undefined2 *)((longlong)puVar15 + 0xe);
          puVar13 = puVar13 + 6;
          puVar15 = puVar15 + 0x14;
        } while ((int)uVar20 < *piVar9);
      }
      local_78 = 0;
      local_70 = (LPVOID)0x0;
      local_68 = 0;
      local_60 = 0;
      local_58 = (LPVOID)0x0;
      local_50 = (longlong *)0x0;
      local_48 = 0;
      puVar2 = *(uint **)(*(longlong *)(param_1 + 2) + local_80 * 8);
      puVar3 = *(uint **)(*(longlong *)(param_1 + 2) + lVar17 * 8);
      if (*(longlong *)(puVar2 + 4) != 0) {
        plVar12 = (longlong *)FUN_18001ee18(1,0x18);
      }
      iVar8 = FUN_18000ab80(puVar3,puVar2,param_3,&local_78,0,(char *)0x0,plVar12);
      if (plVar12 != (longlong *)0x0) {
        if ((LPVOID)*plVar12 != (LPVOID)0x0) {
          FUN_18001d45c((LPVOID)*plVar12);
        }
        if ((LPVOID)plVar12[1] != (LPVOID)0x0) {
          FUN_18001d45c((LPVOID)plVar12[1]);
        }
        if ((LPVOID)plVar12[2] != (LPVOID)0x0) {
          FUN_18001d45c((LPVOID)plVar12[2]);
        }
        FUN_18001d45c(plVar12);
      }
      plVar12 = local_50;
      pvVar7 = local_58;
      if (iVar8 < *(int *)(param_3 + 0x78)) {
        iVar8 = 0;
        piVar9 = *(int **)(*(longlong *)(param_1 + 2) + local_80 * 8);
        if (0 < *piVar9) {
          puVar13 = (undefined2 *)((longlong)pvVar11 + 8);
          puVar15 = (undefined4 *)**(undefined8 **)(piVar9 + 6);
          do {
            iVar8 = iVar8 + 1;
            *puVar15 = *(undefined4 *)(puVar13 + -4);
            puVar15[1] = *(undefined4 *)(puVar13 + -2);
            *(undefined2 *)((longlong)puVar15 + 0xe) = *puVar13;
            puVar13 = puVar13 + 6;
            puVar15 = puVar15 + 0x14;
          } while (iVar8 < *piVar9);
        }
      }
      else {
        if (0 < (int)local_78) {
          uVar19 = local_78 & 0xffffffff;
          plVar14 = local_50;
          do {
            lVar4 = *(longlong *)(((longlong)local_58 - (longlong)local_50) + (longlong)plVar14);
            cVar1 = *(char *)(lVar4 + 0xd);
            if (cVar1 < '\x7f') {
              *(char *)(lVar4 + 0xd) = cVar1 + '\x01';
            }
            cVar1 = *(char *)(*plVar14 + 0xd);
            if (cVar1 < '{') {
              *(char *)(*plVar14 + 0xd) = cVar1 + '\x04';
            }
            plVar14 = plVar14 + 1;
            uVar19 = uVar19 - 1;
          } while (uVar19 != 0);
        }
        piVar9 = *(int **)(*(longlong *)(param_1 + 2) + lVar17 * 8);
        piVar5 = *(int **)(*(longlong *)(param_1 + 2) + local_80 * 8);
        iVar8 = *piVar9;
        FUN_18000c7e0(piVar9,piVar5,(int *)&local_78,1,param_3);
        iVar18 = *piVar5;
        if (iVar18 != 0) {
          iVar22 = iVar18 + iVar8;
          if (0x1000 < iVar22) {
            iVar22 = 0x1000;
            iVar18 = 0x1000 - iVar8;
            *piVar5 = iVar18;
          }
          piVar9 = FUN_18000e6f0(piVar9,iVar22);
          if (piVar9 == (int *)0x0) goto LAB_18000dca7;
          FUN_18001d560(*(undefined8 **)(*(longlong *)(piVar9 + 6) + (longlong)iVar8 * 8),
                        (undefined8 *)**(undefined8 **)(piVar5 + 6),(longlong)iVar18 * 0x50);
          *piVar9 = iVar22;
        }
        if (piVar9 != (int *)0x0) {
          local_98 = local_98 + 1;
          *(int **)(*(longlong *)(param_1 + 2) + lVar17 * 8) = piVar9;
          pvVar6 = *(LPVOID *)(*(longlong *)(param_1 + 2) + local_80 * 8);
          if (pvVar6 != (LPVOID)0x0) {
            FUN_18001d45c(*(LPVOID *)((longlong)pvVar6 + 0x10));
            FUN_18001d45c(pvVar6);
          }
          *(undefined8 *)(*(longlong *)(param_1 + 2) + local_80 * 8) = 0;
        }
      }
LAB_18000dca7:
      FUN_18001d45c(pvVar11);
      if (local_70 != (LPVOID)0x0) {
        FUN_18001d45c(local_70);
      }
      if (pvVar7 != (LPVOID)0x0) {
        FUN_18001d45c(pvVar7);
      }
      if (plVar12 != (longlong *)0x0) {
        FUN_18001d45c(plVar12);
      }
    }
  }
  uVar19 = 1;
  local_res20 = local_res20 + 1;
  local_80 = local_80 + 1;
  if (*param_1 <= local_res20) {
    if (0 < *param_1) {
      lVar17 = 0;
      uVar21 = uVar19;
      do {
        lVar4 = *(longlong *)(param_1 + 2);
        iVar8 = (int)uVar19;
        if ((*(longlong *)(lVar4 + lVar17) == 0) && (iVar8 < *param_1)) {
          plVar12 = (longlong *)(lVar4 + 8 + lVar17);
          uVar16 = uVar21;
          do {
            if (*plVar12 != 0) {
              *(undefined8 *)(lVar4 + lVar17) = *(undefined8 *)(lVar4 + uVar16 * 8);
              *(undefined8 *)(*(longlong *)(param_1 + 2) + uVar16 * 8) = 0;
              break;
            }
            uVar20 = (int)uVar19 + 1;
            uVar19 = (ulonglong)uVar20;
            uVar16 = uVar16 + 1;
            plVar12 = plVar12 + 1;
          } while ((int)uVar20 < *param_1);
        }
        uVar19 = (ulonglong)(iVar8 + 1);
        uVar21 = uVar21 + 1;
        lVar17 = lVar17 + 8;
      } while (iVar8 < *param_1);
    }
    *param_1 = *param_1 - local_98;
LAB_18000dd74:
    uVar10 = FUN_18000c0f0(param_1,param_3);
    return uVar10;
  }
  goto LAB_18000d9f0;
}



int * FUN_18000ddc0(int *param_1,int *param_2,longlong param_3)

{
  int *piVar1;
  int *piVar2;
  undefined8 uVar3;
  
  piVar1 = param_1;
  if (param_1 == (int *)0x0) {
    piVar1 = (int *)FUN_18001ee18(1,0x150);
    if (piVar1 == (int *)0x0) {
      return (int *)0x0;
    }
    *(int **)(piVar1 + 2) = piVar1 + 4;
  }
  if ((*piVar1 < 0x28) && (piVar2 = FUN_18000e7b0(param_2), piVar2 != (int *)0x0)) {
    *(int **)(*(longlong *)(piVar1 + 2) + (longlong)*piVar1 * 8) = piVar2;
    *piVar1 = *piVar1 + 1;
  }
  uVar3 = FUN_18000c0f0(param_1,param_3);
  if ((int)uVar3 < 0) {
    piVar1 = (int *)0x0;
  }
  return piVar1;
}



int FUN_18000de50(int *param_1)

{
  undefined8 *puVar1;
  uint *puVar2;
  int iVar3;
  int iVar4;
  longlong *plVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  longlong lVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  ulonglong uVar14;
  int iVar15;
  int local_res10;
  int local_res18;
  longlong local_50;
  
  iVar8 = 0;
  local_res10 = 0;
  local_res18 = 0;
  if (0 < *param_1) {
    local_50 = 0;
    do {
      iVar12 = 0x400;
      iVar15 = -0x400;
      puVar2 = *(uint **)(local_50 + *(longlong *)(param_1 + 2));
      iVar8 = 0;
      iVar11 = 0x400;
      iVar9 = -0x400;
      if (0 < (int)*puVar2) {
        lVar10 = 0;
        uVar14 = (ulonglong)*puVar2;
        do {
          puVar1 = (undefined8 *)(lVar10 + *(longlong *)(puVar2 + 6));
          lVar10 = lVar10 + 8;
          iVar13 = *(int *)*puVar1;
          iVar3 = ((int *)*puVar1)[1];
          if (iVar13 < iVar12) {
            iVar12 = iVar13;
          }
          if (iVar3 < iVar11) {
            iVar11 = iVar3;
          }
          if (iVar15 < iVar13) {
            iVar15 = iVar13;
          }
          if (iVar9 < iVar3) {
            iVar9 = iVar3;
          }
          uVar14 = uVar14 - 1;
        } while (uVar14 != 0);
      }
      iVar15 = ((int)((iVar15 - iVar12 >> 0x1f & 3U) + (iVar15 - iVar12)) >> 2) + 1;
      iVar9 = ((int)((iVar9 - iVar11 >> 0x1f & 3U) + (iVar9 - iVar11)) >> 2) + 1;
      plVar5 = (longlong *)FUN_18001ed60((longlong)(iVar9 * iVar15 + iVar9 * 8));
      lVar10 = (longlong)iVar9;
      if (plVar5 == (longlong *)0x0) {
        plVar5 = (longlong *)0x0;
      }
      else {
        lVar7 = (longlong)plVar5 + (longlong)(iVar9 * 8);
        lVar6 = 0;
        if (0 < lVar10) {
          do {
            plVar5[lVar6] = lVar7;
            lVar6 = lVar6 + 1;
            lVar7 = lVar7 + iVar15;
          } while (lVar6 < lVar10);
        }
        FUN_18001dbc0((undefined1 (*) [16])*plVar5,0,(longlong)(iVar9 * iVar15));
      }
      iVar13 = 0;
      if (0 < (int)*puVar2) {
        lVar6 = 0;
        do {
          iVar13 = iVar13 + 1;
          iVar3 = (*(int **)(lVar6 + *(longlong *)(puVar2 + 6)))[1] - iVar11;
          iVar4 = **(int **)(lVar6 + *(longlong *)(puVar2 + 6)) - iVar12;
          *(undefined1 *)
           ((longlong)((int)(iVar4 + (iVar4 >> 0x1f & 3U)) >> 2) +
           plVar5[(int)(iVar3 + (iVar3 >> 0x1f & 3U)) >> 2]) = 0xff;
          lVar6 = lVar6 + 8;
        } while (iVar13 < (int)*puVar2);
      }
      FUN_1800128f0(plVar5,iVar15,iVar9);
      lVar6 = 0;
      if (0 < lVar10) {
        do {
          lVar7 = 0;
          if (0 < iVar15) {
            do {
              if (*(char *)(plVar5[lVar6] + lVar7) == -1) {
                iVar8 = iVar8 + 1;
              }
              lVar7 = lVar7 + 1;
            } while (lVar7 < iVar15);
          }
          lVar6 = lVar6 + 1;
        } while (lVar6 < lVar10);
      }
      FUN_18001d45c(plVar5);
      local_res18 = local_res18 + 1;
      iVar8 = local_res10 + iVar8;
      local_50 = local_50 + 8;
      local_res10 = iVar8;
    } while (local_res18 < *param_1);
  }
  return iVar8;
}



int FUN_18000e0c0(int *param_1,int *param_2,undefined8 param_3,longlong param_4)

{
  int *piVar1;
  int iVar2;
  char *pcVar3;
  longlong *plVar4;
  uint *puVar5;
  int *piVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  int local_res8;
  int local_68;
  longlong local_58;
  
  iVar9 = 0;
  local_res8 = 0;
  if ((*param_1 < 1) || (*param_2 < 1)) {
    return 0;
  }
  local_68 = 0;
  if (0 < *param_2) {
    local_58 = 0;
    do {
      iVar9 = 0;
      plVar4 = (longlong *)0x0;
      piVar1 = *(int **)(*(longlong *)(param_2 + 2) + local_58);
      if (0 < *piVar1) {
        pcVar3 = (char *)FUN_18001ee18((longlong)*piVar1,1);
        if (pcVar3 == (char *)0x0) {
          iVar9 = -1000;
        }
        else {
          if (*(longlong *)(piVar1 + 4) != 0) {
            plVar4 = (longlong *)FUN_18001ee18(1,0x18);
          }
          iVar8 = 0;
          if (0 < *param_1) {
            lVar7 = 0;
            do {
              puVar5 = (uint *)FUN_18000e7b0(piVar1);
              piVar6 = (int *)FUN_18001ee18(1,0x38);
              if (puVar5 == (uint *)0x0) {
LAB_18000e246:
                if (piVar6 != (int *)0x0) {
                  if (*(LPVOID *)(piVar6 + 2) != (LPVOID)0x0) {
                    FUN_18001d45c(*(LPVOID *)(piVar6 + 2));
                  }
                  if (*(LPVOID *)(piVar6 + 8) != (LPVOID)0x0) {
                    FUN_18001d45c(*(LPVOID *)(piVar6 + 8));
                  }
                  if (*(LPVOID *)(piVar6 + 10) != (LPVOID)0x0) {
                    FUN_18001d45c(*(LPVOID *)(piVar6 + 10));
                  }
                  piVar6[2] = 0;
                  piVar6[3] = 0;
                  piVar6[8] = 0;
                  piVar6[9] = 0;
                  piVar6[10] = 0;
                  piVar6[0xb] = 0;
                  FUN_18001d45c(piVar6);
                }
              }
              else if (piVar6 != (int *)0x0) {
                *(undefined8 *)(puVar5 + 4) = *(undefined8 *)(piVar1 + 4);
                iVar2 = FUN_18000ab80(*(uint **)(*(longlong *)(param_1 + 2) + lVar7),puVar5,param_4,
                                      (undefined8 *)piVar6,1,pcVar3,plVar4);
                puVar5[4] = 0;
                puVar5[5] = 0;
                piVar6[4] = iVar2;
                if (*(int *)(param_4 + 0x58) <= *piVar6) {
                  iVar9 = iVar9 + (iVar2 - (short)piVar6[0xc]);
                }
                goto LAB_18000e246;
              }
              if (puVar5 != (uint *)0x0) {
                FUN_18001d45c(*(LPVOID *)(puVar5 + 4));
                FUN_18001d45c(puVar5);
              }
              iVar8 = iVar8 + 1;
              lVar7 = lVar7 + 8;
            } while (iVar8 < *param_1);
          }
          if (plVar4 != (longlong *)0x0) {
            if ((LPVOID)*plVar4 != (LPVOID)0x0) {
              FUN_18001d45c((LPVOID)*plVar4);
            }
            if ((LPVOID)plVar4[1] != (LPVOID)0x0) {
              FUN_18001d45c((LPVOID)plVar4[1]);
            }
            if ((LPVOID)plVar4[2] != (LPVOID)0x0) {
              FUN_18001d45c((LPVOID)plVar4[2]);
            }
            FUN_18001d45c(plVar4);
          }
          FUN_18001d45c(pcVar3);
        }
      }
      local_68 = local_68 + 1;
      iVar9 = local_res8 + iVar9;
      local_58 = local_58 + 8;
      local_res8 = iVar9;
    } while (local_68 < *param_2);
  }
  return iVar9;
}



void FUN_18000e360(int *param_1,int *param_2,int *param_3)

{
  int iVar1;
  longlong lVar2;
  int iVar3;
  ulonglong *puVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int *piVar8;
  longlong lVar9;
  int *piVar10;
  int iVar11;
  
  lVar2 = DAT_180049f30;
  if ((param_2 != (int *)0x0) && (iVar7 = 0, DAT_180049f30 != 0)) {
    if (*(byte *)(param_2 + 2) < 3) {
      iVar5 = 3;
      if (1 < *(byte *)(param_2 + 2)) {
        iVar5 = 6;
      }
    }
    else {
      iVar5 = 8;
    }
    iVar1 = *(int *)(DAT_180049f30 + 0x48);
    iVar11 = 0;
    piVar10 = (int *)**(undefined8 **)(param_1 + 6);
    if (0 < *param_1) {
      do {
        if (-1 < *(short *)((longlong)piVar10 + 0xe)) {
          iVar6 = 0;
          piVar8 = (int *)**(undefined8 **)(param_2 + 6);
          if (0 < *param_2) {
            do {
              if (((char)piVar10[3] == (char)piVar8[3]) && (-1 < *(short *)((longlong)piVar8 + 0xe))
                 ) {
                iVar3 = *piVar10 - *piVar8;
                if (iVar3 < 0) {
                  iVar3 = *piVar8 - *piVar10;
                }
                if (iVar3 <= *(int *)(lVar2 + 0x98)) {
                  iVar3 = piVar10[1] - piVar8[1];
                  if (iVar3 < 0) {
                    iVar3 = piVar8[1] - piVar10[1];
                  }
                  if (iVar3 <= *(int *)(lVar2 + 0x98)) {
                    iVar3 = 0;
                    if ((longlong)iVar5 != 0) {
                      puVar4 = (ulonglong *)(piVar10 + 4);
                      lVar9 = (longlong)iVar5;
                      do {
                        iVar3 = iVar3 + (int)POPCOUNT(*(ulonglong *)
                                                       ((longlong)piVar8 +
                                                        (0x10 - (longlong)(piVar10 + 4)) +
                                                       (longlong)puVar4) ^ *puVar4);
                        lVar9 = lVar9 + -1;
                        puVar4 = puVar4 + 1;
                      } while (lVar9 != 0);
                    }
                    if (iVar3 <= iVar1) {
                      *(undefined2 *)((longlong)piVar8 + 0xe) = 0xffff;
                      iVar7 = iVar7 + 1;
                    }
                  }
                }
              }
              iVar6 = iVar6 + 1;
              piVar8 = piVar8 + 0x14;
            } while (iVar6 < *param_2);
          }
        }
        iVar11 = iVar11 + 1;
        piVar10 = piVar10 + 0x14;
      } while (iVar11 < *param_1);
    }
    *param_3 = (iVar7 << 7) / *param_2;
  }
  return;
}



void FUN_18000e4e0(void)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_18001ed60(0xa8);
  if (puVar1 == (undefined4 *)0x0) {
    return;
  }
  *puVar1 = 0x10;
  *(undefined8 *)(puVar1 + 1) = 1000;
  *(undefined8 *)(puVar1 + 10) = 1;
  puVar1[3] = 3;
  puVar1[4] = 9;
  puVar1[9] = 0;
  *(undefined8 *)(puVar1 + 0x24) = 0;
  *(undefined8 *)(puVar1 + 0x28) = 0;
  *(undefined8 *)(puVar1 + 0xc) = 0;
  puVar1[0xe] = 0;
  puVar1[6] = 1;
  puVar1[8] = 1;
  puVar1[7] = 2;
  puVar1[0x10] = 700;
  puVar1[0x11] = 0x400;
  puVar1[0x12] = 0x73;
  puVar1[0x13] = 7;
  puVar1[0x14] = 8;
  puVar1[5] = 0x700;
  puVar1[0x15] = 0x294;
  puVar1[0x16] = 5;
  puVar1[0x17] = 0xffffffff;
  *(undefined8 *)(puVar1 + 0x18) = 0x18;
  puVar1[0x1a] = 100;
  puVar1[0x1b] = 10;
  puVar1[0x1c] = 0x14;
  puVar1[0x1d] = 5;
  puVar1[0x1e] = 0xf0;
  puVar1[0x1f] = 1;
  puVar1[0x20] = 0x14;
  puVar1[0x21] = 0x2df;
  *(undefined8 *)(puVar1 + 0x22) = 170000;
  *(undefined8 *)(puVar1 + 0x26) = 2;
  puVar1[0xf] = 0x288;
  return;
}



LPVOID FUN_18000e600(int param_1)

{
  LPVOID pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = FUN_18001ee18(1,(longlong)(param_1 * 0x58 + 0x20));
  if (pvVar1 == (LPVOID)0x0) {
    return (LPVOID)0x0;
  }
  lVar2 = 0;
  lVar3 = (longlong)pvVar1 + 0x20 + (longlong)param_1 * 8;
  *(longlong *)((longlong)pvVar1 + 0x18) = (longlong)pvVar1 + 0x20;
  if (0 < param_1) {
    do {
      lVar2 = lVar2 + 1;
      *(longlong *)(*(longlong *)((longlong)pvVar1 + 0x18) + -8 + lVar2 * 8) = lVar3;
      lVar3 = lVar3 + 0x50;
    } while (lVar2 < param_1);
  }
  return pvVar1;
}



void FUN_18000e660(int *param_1,int *param_2)

{
  *param_1 = *param_2;
  *(short *)(param_1 + 1) = (short)param_2[1];
  *(undefined2 *)((longlong)param_1 + 6) = *(undefined2 *)((longlong)param_2 + 6);
  *(char *)(param_1 + 2) = (char)param_2[2];
  *(undefined1 *)((longlong)param_1 + 9) = *(undefined1 *)((longlong)param_2 + 9);
  *(undefined1 *)((longlong)param_1 + 10) = *(undefined1 *)((longlong)param_2 + 10);
  if ((*(undefined8 **)(param_1 + 4) != (undefined8 *)0x0) &&
     (*(undefined8 **)(param_2 + 4) != (undefined8 *)0x0)) {
    FUN_18001d560(*(undefined8 **)(param_1 + 4),*(undefined8 **)(param_2 + 4),
                  (longlong)
                  (int)((uint)*(ushort *)(param_2 + 1) * (uint)*(ushort *)((longlong)param_2 + 6)));
  }
  FUN_18001d560((undefined8 *)**(undefined8 **)(param_1 + 6),
                (undefined8 *)**(undefined8 **)(param_2 + 6),(longlong)*param_2 * 0x50);
  return;
}



int * FUN_18000e6f0(int *param_1,int param_2)

{
  int *piVar1;
  longlong lVar2;
  int *piVar3;
  
  piVar1 = param_1;
  if ((int)((ulonglong)(**(longlong **)(param_1 + 6) - (longlong)*(longlong **)(param_1 + 6)) >> 3)
      != param_2) {
    piVar1 = (int *)FUN_18001ee18(1,(longlong)(param_2 * 0x58 + 0x20));
    if (piVar1 == (int *)0x0) {
      return (int *)0x0;
    }
    lVar2 = 0;
    piVar3 = piVar1 + 8 + (longlong)param_2 * 2;
    *(int **)(piVar1 + 6) = piVar1 + 8;
    if (0 < param_2) {
      do {
        lVar2 = lVar2 + 1;
        *(int **)(*(longlong *)(piVar1 + 6) + -8 + lVar2 * 8) = piVar3;
        piVar3 = piVar3 + 0x14;
      } while (lVar2 < param_2);
    }
    FUN_18000e660(piVar1,param_1);
    FUN_18001d45c(*(LPVOID *)(param_1 + 4));
    FUN_18001d45c(param_1);
  }
  return piVar1;
}



int * FUN_18000e7b0(int *param_1)

{
  int iVar1;
  int *piVar2;
  longlong lVar3;
  int *piVar4;
  
  iVar1 = *param_1;
  piVar2 = (int *)FUN_18001ee18(1,(longlong)(iVar1 * 0x58 + 0x20));
  if (piVar2 == (int *)0x0) {
    return (int *)0x0;
  }
  lVar3 = 0;
  piVar4 = piVar2 + 8 + (longlong)iVar1 * 2;
  *(int **)(piVar2 + 6) = piVar2 + 8;
  if (0 < iVar1) {
    do {
      lVar3 = lVar3 + 1;
      *(int **)(*(longlong *)(piVar2 + 6) + -8 + lVar3 * 8) = piVar4;
      piVar4 = piVar4 + 0x14;
    } while (lVar3 < iVar1);
  }
  FUN_18000e660(piVar2,param_1);
  return piVar2;
}



LPVOID FUN_18000e850(int param_1)

{
  LPVOID pvVar1;
  
  pvVar1 = FUN_18001ee18(1,(longlong)param_1 * 8 + 0x10);
  if (pvVar1 == (LPVOID)0x0) {
    return (LPVOID)0x0;
  }
  *(longlong *)((longlong)pvVar1 + 8) = (longlong)pvVar1 + 0x10;
  return pvVar1;
}



undefined8 FUN_18000e890(undefined4 *param_1,int param_2)

{
  ulonglong uVar1;
  LPVOID pvVar2;
  LPVOID pvVar3;
  LPVOID pvVar4;
  
  *param_1 = 0;
  *(undefined8 *)(param_1 + 4) = 0;
  *(undefined2 *)(param_1 + 6) = 0;
  param_1[0xc] = 0;
  pvVar2 = FUN_18001ed60((longlong)param_2 * 4);
  uVar1 = (longlong)param_2 * 8;
  *(LPVOID *)(param_1 + 2) = pvVar2;
  pvVar3 = FUN_18001ed60(uVar1);
  *(LPVOID *)(param_1 + 8) = pvVar3;
  pvVar4 = FUN_18001ed60(uVar1);
  *(LPVOID *)(param_1 + 10) = pvVar4;
  if (pvVar2 != (LPVOID)0x0) {
    if ((pvVar3 != (LPVOID)0x0) && (pvVar4 != (LPVOID)0x0)) {
      return 0;
    }
    FUN_18001d45c(pvVar2);
  }
  if (pvVar3 != (LPVOID)0x0) {
    FUN_18001d45c(pvVar3);
  }
  if (pvVar4 != (LPVOID)0x0) {
    FUN_18001d45c(pvVar4);
  }
  *(undefined8 *)(param_1 + 2) = 0;
  *(undefined8 *)(param_1 + 8) = 0;
  *(undefined8 *)(param_1 + 10) = 0;
  return 0xfffffc18;
}



void FUN_18000e960(int *param_1)

{
  LPVOID pvVar1;
  longlong lVar2;
  uint uVar3;
  ulonglong uVar5;
  ulonglong uVar4;
  
  uVar4 = 0;
  uVar5 = uVar4;
  if (0 < *param_1) {
    do {
      pvVar1 = *(LPVOID *)(uVar5 + *(longlong *)(param_1 + 6));
      if (pvVar1 != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)((longlong)pvVar1 + 0x10));
        FUN_18001d45c(pvVar1);
      }
      lVar2 = *(longlong *)(uVar5 + *(longlong *)(param_1 + 4));
      if (lVar2 != 0) {
        if (*(LPVOID *)(lVar2 + 8) != (LPVOID)0x0) {
          FUN_18001d45c(*(LPVOID *)(lVar2 + 8));
        }
        if (*(LPVOID *)(lVar2 + 0x20) != (LPVOID)0x0) {
          FUN_18001d45c(*(LPVOID *)(lVar2 + 0x20));
        }
        if (*(LPVOID *)(lVar2 + 0x28) != (LPVOID)0x0) {
          FUN_18001d45c(*(LPVOID *)(lVar2 + 0x28));
        }
        *(undefined8 *)(lVar2 + 8) = 0;
        *(undefined8 *)(lVar2 + 0x20) = 0;
        *(undefined8 *)(lVar2 + 0x28) = 0;
        FUN_18001d45c(*(LPVOID *)(*(longlong *)(param_1 + 4) + uVar5));
      }
      uVar3 = (int)uVar4 + 1;
      uVar4 = (ulonglong)uVar3;
      uVar5 = uVar5 + 8;
    } while ((int)uVar3 < *param_1);
  }
  FUN_18001d45c(param_1);
  return;
}



void FUN_18000ea30(int *param_1)

{
  LPVOID pvVar1;
  int iVar2;
  longlong lVar3;
  
  if (param_1 != (int *)0x0) {
    iVar2 = 0;
    if (0 < *param_1) {
      lVar3 = 0;
      do {
        pvVar1 = *(LPVOID *)(lVar3 + *(longlong *)(param_1 + 2));
        if (pvVar1 != (LPVOID)0x0) {
          FUN_18001d45c(*(LPVOID *)((longlong)pvVar1 + 0x10));
          FUN_18001d45c(pvVar1);
        }
        iVar2 = iVar2 + 1;
        lVar3 = lVar3 + 8;
      } while (iVar2 < *param_1);
    }
    FUN_18001d45c(param_1);
  }
  return;
}



int FUN_18000eab0(uint *param_1)

{
  int iVar1;
  short *psVar2;
  uint uVar3;
  ulonglong uVar4;
  
  if (param_1 == (uint *)0x0) {
    return 0;
  }
  uVar3 = *param_1;
  if (0 < (int)uVar3) {
    psVar2 = (short *)(**(longlong **)(param_1 + 6) + 0xe);
    uVar4 = (ulonglong)uVar3;
    do {
      if (*psVar2 < 0) {
        uVar3 = uVar3 - 1;
      }
      psVar2 = psVar2 + 0x28;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  iVar1 = (((int)((uint)(byte)param_1[2] * 0xa2 + 7) >> 3) + 8) * uVar3 + 0xb;
  if (*(longlong *)(param_1 + 4) != 0) {
    iVar1 = iVar1 + (uint)*(ushort *)((longlong)param_1 + 6) * (uint)(ushort)param_1[1];
  }
  return iVar1;
}



undefined8 FUN_18000eb20(uint *param_1,undefined2 *param_2)

{
  undefined1 uVar1;
  short *psVar2;
  uint uVar3;
  ulonglong uVar4;
  
  if (((byte)param_1[2] < 4) && (*(byte *)((longlong)param_1 + 9) < 0x81)) {
    *param_2 = 0x147;
    uVar1 = *(undefined1 *)((longlong)param_2 + 1);
    if (*(longlong *)(param_1 + 4) != 0) {
      uVar1 = 3;
    }
    *(undefined1 *)((longlong)param_2 + 1) = uVar1;
    uVar3 = *param_1;
    if (0 < (int)uVar3) {
      psVar2 = (short *)(**(longlong **)(param_1 + 6) + 0xe);
      uVar4 = (ulonglong)uVar3;
      do {
        if (*psVar2 < 0) {
          uVar3 = uVar3 - 1;
        }
        psVar2 = psVar2 + 0x28;
        uVar4 = uVar4 - 1;
      } while (uVar4 != 0);
    }
    param_2[1] = (short)uVar3;
    param_2[2] = (short)param_1[1];
    param_2[3] = *(undefined2 *)((longlong)param_1 + 6);
    *(char *)(param_2 + 4) = (char)param_1[2];
    *(undefined1 *)((longlong)param_2 + 9) = *(undefined1 *)((longlong)param_1 + 9);
    *(undefined1 *)(param_2 + 5) = *(undefined1 *)((longlong)param_1 + 10);
    return 0;
  }
  return 0xfffffc17;
}



undefined8 FUN_18000ebb0(uint *param_1,undefined1 *param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  
  if (((byte)param_1[3] < 2) && (*(short *)((longlong)param_1 + 0xe) < 0x169)) {
    uVar1 = *param_1;
    uVar2 = param_1[1];
    param_2[1] = (char)uVar2;
    *param_2 = (char)uVar1;
    param_2[2] = *(undefined1 *)((longlong)param_1 + 0xe);
    *(uint *)(param_2 + 3) =
         (((((byte)param_1[3] & 1) << 0xc | uVar1 & 0x700) << 4 | uVar2 & 0x700) * 2 |
         (int)*(short *)((longlong)param_1 + 0xe) & 0x100U) << 5 |
         (uVar2 >> 4 & 0x8000000 | uVar1 & 0x800003ff) >> 10 | param_1[2] & 0x1fff;
    param_2[7] = *(undefined1 *)((longlong)param_1 + 0xd);
    FUN_18001d560((undefined8 *)(param_2 + 8),(undefined8 *)(param_1 + 4),(longlong)param_3);
    return 0;
  }
  return 0xfffffc17;
}



int FUN_18000ec70(uint *param_1,undefined2 *param_2)

{
  int iVar1;
  undefined8 uVar2;
  int iVar3;
  undefined8 *puVar4;
  int iVar5;
  
  puVar4 = *(undefined8 **)(param_1 + 6);
  iVar1 = (int)((uint)(byte)param_1[2] * 0xa2 + 7) >> 3;
  uVar2 = FUN_18000eb20(param_1,param_2);
  if ((int)uVar2 == 0) {
    iVar5 = 0;
    iVar3 = 0xb;
    if (0 < (int)*param_1) {
      do {
        if (-1 < *(short *)((longlong)*puVar4 + 0xe)) {
          uVar2 = FUN_18000ebb0((uint *)*puVar4,(undefined1 *)((longlong)iVar3 + (longlong)param_2),
                                iVar1);
          if ((int)uVar2 < 0) {
            return -0x3e9;
          }
          iVar3 = iVar3 + iVar1 + 8;
        }
        iVar5 = iVar5 + 1;
        puVar4 = puVar4 + 1;
      } while (iVar5 < (int)*param_1);
    }
    if (*(undefined8 **)(param_1 + 4) != (undefined8 *)0x0) {
      iVar1 = (uint)*(ushort *)((longlong)param_1 + 6) * (uint)(ushort)param_1[1];
      FUN_18001d560((undefined8 *)((longlong)iVar3 + (longlong)param_2),
                    *(undefined8 **)(param_1 + 4),(longlong)iVar1);
      iVar3 = iVar3 + iVar1;
    }
  }
  else {
    iVar3 = -0x3e9;
  }
  return iVar3;
}



int FUN_18000ed50(uint *param_1,char *param_2)

{
  ushort *puVar1;
  byte bVar2;
  byte bVar3;
  ushort uVar4;
  uint uVar5;
  undefined8 *puVar6;
  int iVar7;
  uint uVar8;
  int iVar10;
  uint uVar11;
  uint uVar12;
  ulonglong uVar13;
  ulonglong uVar9;
  
  if ((param_2 == (char *)0x0) || (param_1 == (uint *)0x0)) {
    return -0x3ea;
  }
  if (*param_2 == 'G') {
    uVar4 = *(ushort *)(param_2 + 2);
    if (uVar4 < 0x1001) {
      *param_1 = (uint)uVar4;
      *(undefined2 *)(param_1 + 1) = *(undefined2 *)(param_2 + 4);
      iVar10 = 0xb;
      *(undefined2 *)((longlong)param_1 + 6) = *(undefined2 *)(param_2 + 6);
      bVar2 = param_2[8];
      *(byte *)(param_1 + 2) = bVar2;
      bVar3 = param_2[9];
      *(byte *)((longlong)param_1 + 9) = bVar3;
      *(char *)((longlong)param_1 + 10) = param_2[10];
      if ((3 < bVar2) || (0x80 < bVar3)) {
        return -0x3e9;
      }
      uVar9 = 0;
      iVar7 = 0;
      uVar5 = (int)((uint)bVar2 * 0xa2 + 7) >> 3;
      uVar13 = uVar9;
      if (uVar4 != 0) {
        do {
          bVar2 = param_2[iVar10];
          bVar3 = param_2[iVar10 + 1];
          *(ushort *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xe) =
               (ushort)(byte)param_2[iVar10 + 2];
          uVar8 = *(uint *)(param_2 + (iVar10 + 3));
          uVar11 = (uint)bVar2 | (int)uVar8 >> 10 & 0x700U;
          *(byte *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xc) =
               (byte)((int)uVar8 >> 0x16) & 1;
          uVar12 = (uint)bVar3 | (int)uVar8 >> 6 & 0x700U;
          if ((uVar8 >> 0x15 & 1) != 0) {
            uVar11 = uVar11 | 0xfffff800;
          }
          if ((uVar8 >> 0x11 & 1) != 0) {
            uVar12 = uVar12 | 0xfffff800;
          }
          **(uint **)(uVar13 + *(longlong *)(param_1 + 6)) = uVar11;
          *(uint *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 4) = uVar12;
          puVar1 = (ushort *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xe);
          *puVar1 = *puVar1 | (ushort)((int)uVar8 >> 5) & 0x100;
          if (0x169 < (ushort)(*(short *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xe)
                              + 1U)) {
            return -0x3e9;
          }
          *(uint *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 8) = uVar8 & 0x1fff;
          *(char *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xd) = param_2[iVar10 + 7];
          FUN_18001d560((undefined8 *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0x10),
                        (undefined8 *)(param_2 + (iVar10 + 8)),(ulonglong)uVar5);
          uVar8 = (int)uVar9 + 1;
          uVar9 = (ulonglong)uVar8;
          iVar10 = iVar10 + 8 + uVar5;
          uVar13 = uVar13 + 8;
        } while ((int)uVar8 < (int)*param_1);
      }
      if ((param_2[1] & 2U) != 0) {
        iVar7 = (uint)*(ushort *)((longlong)param_1 + 6) * (uint)(ushort)param_1[1];
        puVar6 = (undefined8 *)FUN_18001ed60((longlong)iVar7);
        *(undefined8 **)(param_1 + 4) = puVar6;
        if (puVar6 != (undefined8 *)0x0) {
          FUN_18001d560(puVar6,(undefined8 *)(param_2 + iVar10),(longlong)iVar7);
        }
      }
      return (uVar5 + 8) * *param_1 + 0xb + iVar7;
    }
  }
  return -0x3e9;
}



ulonglong FUN_18000efd0(int *param_1,short *param_2,int param_3)

{
  uint *puVar1;
  short *psVar2;
  uint uVar3;
  ulonglong uVar4;
  uint uVar5;
  int iVar6;
  ulonglong uVar7;
  short sVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  undefined8 *puVar11;
  
  sVar8 = (short)*param_1;
  uVar7 = 0;
  uVar9 = uVar7;
  if (0 < *param_1) {
    puVar11 = *(undefined8 **)(param_1 + 2);
    do {
      puVar1 = (uint *)*puVar11;
      if (puVar1 == (uint *)0x0) {
        return 0xfffffc17;
      }
      uVar3 = *puVar1;
      uVar4 = (ulonglong)uVar3;
      if (0x1000 < uVar3) {
        return 0xfffffc17;
      }
      uVar5 = uVar3;
      if (0 < (int)uVar3) {
        psVar2 = (short *)(**(longlong **)(puVar1 + 6) + 0xe);
        uVar10 = (ulonglong)uVar3;
        do {
          if (*psVar2 < 0) {
            uVar5 = uVar5 - 1;
          }
          psVar2 = psVar2 + 0x28;
          uVar10 = uVar10 - 1;
        } while (uVar10 != 0);
      }
      if ((int)uVar5 < param_3) {
        sVar8 = sVar8 + -1;
      }
      else {
        if (0 < (int)uVar3) {
          psVar2 = (short *)(**(longlong **)(puVar1 + 6) + 0xe);
          uVar10 = uVar4;
          do {
            if (*psVar2 < 0) {
              uVar4 = (ulonglong)((int)uVar4 - 1);
            }
            uVar3 = (uint)uVar4;
            psVar2 = psVar2 + 0x28;
            uVar10 = uVar10 - 1;
          } while (uVar10 != 0);
        }
        iVar6 = (((int)((uint)(byte)puVar1[2] * 0xa2 + 7) >> 3) + 8) * uVar3 + 0xb;
        if (*(longlong *)(puVar1 + 4) != 0) {
          iVar6 = iVar6 + (uint)*(ushort *)((longlong)puVar1 + 6) * (uint)(ushort)puVar1[1];
        }
        uVar9 = (ulonglong)(uint)((int)uVar9 + iVar6);
      }
      uVar7 = uVar7 + 1;
      puVar11 = puVar11 + 1;
    } while ((longlong)uVar7 < (longlong)*param_1);
  }
  *param_2 = sVar8;
  return uVar9;
}



int FUN_18000f0f0(int *param_1,undefined8 *param_2,int *param_3,longlong param_4)

{
  uint *puVar1;
  int iVar2;
  ulonglong uVar3;
  undefined8 *puVar4;
  short *psVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  longlong lVar9;
  short local_res18 [4];
  
  if (param_3 == (int *)0x0) {
    return -0x3ea;
  }
  if ((*param_1 - 1U < 0x28) && (*(longlong *)(param_1 + 2) != 0)) {
    uVar3 = FUN_18000efd0(param_1,local_res18,*(int *)(param_4 + 0x58));
    iVar7 = (int)uVar3;
    if (-1 < iVar7) {
      *param_3 = iVar7 + 0x20;
      if (param_2 == (undefined8 *)0x0) {
        return 0;
      }
      puVar4 = (undefined8 *)FUN_18001ed60((longlong)(iVar7 + 0x28));
      *param_2 = puVar4;
      if (puVar4 == (undefined8 *)0x0) {
        iVar2 = -1000;
LAB_18000f195:
        if ((LPVOID)*param_2 != (LPVOID)0x0) {
          FUN_18001d45c((LPVOID)*param_2);
          *param_2 = 0;
        }
      }
      else {
        iVar8 = 0;
        iVar7 = 0x20;
        *puVar4 = 0;
        puVar4[1] = 0;
        puVar4[2] = 0;
        puVar4[3] = 0;
        *(undefined2 *)puVar4 = 0x145;
        *(short *)((longlong)puVar4 + 2) = local_res18[0];
        if (0 < *param_1) {
          lVar9 = 0;
          do {
            puVar1 = *(uint **)(lVar9 + *(longlong *)(param_1 + 2));
            uVar6 = *puVar1;
            if (0 < (int)uVar6) {
              psVar5 = (short *)(**(longlong **)(puVar1 + 6) + 0xe);
              uVar3 = (ulonglong)uVar6;
              do {
                if (*psVar5 < 0) {
                  uVar6 = uVar6 - 1;
                }
                psVar5 = psVar5 + 0x28;
                uVar3 = uVar3 - 1;
              } while (uVar3 != 0);
            }
            if (*(int *)(param_4 + 0x58) <= (int)uVar6) {
              iVar2 = FUN_18000ec70(puVar1,(undefined2 *)((longlong)iVar7 + (longlong)puVar4));
              if (iVar2 < 0) goto LAB_18000f195;
              iVar7 = iVar7 + iVar2;
            }
            iVar8 = iVar8 + 1;
            lVar9 = lVar9 + 8;
          } while (iVar8 < *param_1);
        }
        iVar2 = 0;
      }
      return iVar2;
    }
  }
  return -0x3e9;
}



int FUN_18000f280(uint *param_1,char *param_2)

{
  ushort uVar1;
  int iVar2;
  LPVOID pvVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong lVar6;
  int iVar7;
  ulonglong uVar8;
  int iVar9;
  
  if ((param_2 == (char *)0x0) || (param_1 == (uint *)0x0)) {
    return -0x3ea;
  }
  if ((*param_2 != 'E') || (uVar1 = *(ushort *)(param_2 + 2), 0x27 < uVar1 - 1)) {
    return -0x3e9;
  }
  uVar5 = 0;
  iVar9 = 0x20;
  *param_1 = (uint)uVar1;
  uVar8 = uVar5;
  if (uVar1 != 0) {
    do {
      iVar7 = (int)uVar8;
      uVar4 = (uint)*(ushort *)(param_2 + iVar9 + 2);
      if (0x1000 < uVar4) {
        return -0x3e9;
      }
      pvVar3 = FUN_18000e600(uVar4);
      *(LPVOID *)(uVar5 + *(longlong *)(param_1 + 2)) = pvVar3;
      if (*(uint **)(uVar5 + *(longlong *)(param_1 + 2)) == (uint *)0x0) {
        iVar2 = -1000;
        iVar7 = iVar7 + -1;
LAB_18000f365:
        lVar6 = (longlong)iVar7;
        if (iVar7 < 0) {
          return iVar2;
        }
        do {
          pvVar3 = *(LPVOID *)(*(longlong *)(param_1 + 2) + lVar6 * 8);
          if (pvVar3 != (LPVOID)0x0) {
            FUN_18001d45c(*(LPVOID *)((longlong)pvVar3 + 0x10));
            FUN_18001d45c(pvVar3);
          }
          lVar6 = lVar6 + -1;
          *(undefined8 *)(*(longlong *)(param_1 + 2) + 8 + lVar6 * 8) = 0;
        } while (-1 < lVar6);
        return iVar2;
      }
      iVar2 = FUN_18000ed50(*(uint **)(uVar5 + *(longlong *)(param_1 + 2)),param_2 + iVar9);
      if (iVar2 < 0) goto LAB_18000f365;
      iVar9 = iVar9 + iVar2;
      uVar5 = uVar5 + 8;
      uVar8 = (ulonglong)(iVar7 + 1U);
    } while ((int)(iVar7 + 1U) < (int)*param_1);
  }
  return 0;
}



int * FUN_18000f3c0(int param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  longlong lVar3;
  longlong lVar4;
  
  piVar1 = (int *)FUN_18001ee18((longlong)(param_2 * 8) + ((longlong)(param_1 * param_2) + 4) * 4,1)
  ;
  if (piVar1 == (int *)0x0) {
    return (int *)0x0;
  }
  *piVar1 = param_1;
  piVar1[1] = param_2;
  piVar2 = piVar1 + 4;
  *(int **)(piVar1 + 2) = piVar2;
  lVar3 = (longlong)piVar2 + (longlong)(param_2 * 8);
  lVar4 = 0;
  if (0 < param_2) {
    do {
      *(longlong *)(piVar2 + lVar4 * 2) = lVar3;
      lVar4 = lVar4 + 1;
      lVar3 = lVar3 + (longlong)param_1 * 4;
    } while (lVar4 < param_2);
  }
  return piVar1;
}



void FUN_18000f460(longlong param_1,int param_2,int param_3,uint *param_4)

{
  uint uVar1;
  longlong lVar2;
  int iVar3;
  
  uVar1 = *param_4;
  if (((uVar1 & 0x3fffffff) != 0) && (iVar3 = 0, 0 < (int)param_4[1])) {
    lVar2 = 0;
    do {
      FUN_18001d560(*(undefined8 **)(*(longlong *)(param_4 + 2) + lVar2),
                    (undefined8 *)
                    (*(longlong *)(*(longlong *)(param_1 + 8) + (longlong)param_3 * 8 + lVar2) +
                    (longlong)param_2 * 4),(longlong)(int)(uVar1 << 2));
      iVar3 = iVar3 + 1;
      lVar2 = lVar2 + 8;
    } while (iVar3 < (int)param_4[1]);
  }
  return;
}



void FUN_18000f500(int *param_1)

{
  undefined8 *puVar1;
  longlong lVar2;
  longlong lVar3;
  int iVar4;
  ulonglong uVar5;
  
  iVar4 = *param_1 * 4;
  if ((iVar4 != 0) &&
     (puVar1 = (undefined8 *)FUN_18001ed60((longlong)*param_1 << 2), puVar1 != (undefined8 *)0x0)) {
    lVar2 = 0;
    lVar3 = (longlong)(param_1[1] + -1);
    if (0 < param_1[1] + -1) {
      uVar5 = (ulonglong)iVar4;
      do {
        FUN_18001d560(puVar1,*(undefined8 **)(*(longlong *)(param_1 + 2) + lVar2 * 8),uVar5);
        FUN_18001d560(*(undefined8 **)(*(longlong *)(param_1 + 2) + lVar2 * 8),
                      *(undefined8 **)(*(longlong *)(param_1 + 2) + lVar3 * 8),uVar5);
        FUN_18001d560(*(undefined8 **)(*(longlong *)(param_1 + 2) + lVar3 * 8),puVar1,uVar5);
        lVar2 = lVar2 + 1;
        lVar3 = lVar3 + -1;
      } while (lVar2 < lVar3);
    }
    FUN_18001d45c(puVar1);
  }
  return;
}



void FUN_18000f5d0(longlong param_1,int param_2,int param_3,int *param_4)

{
  int iVar1;
  longlong lVar2;
  int iVar3;
  
  iVar1 = *param_4;
  iVar3 = 0;
  if (0 < param_4[1]) {
    lVar2 = 0;
    do {
      FUN_18001d560((undefined8 *)
                    (*(longlong *)(*(longlong *)(param_1 + 8) + (longlong)param_3 * 8 + lVar2) +
                    (longlong)param_2 * 4),*(undefined8 **)(*(longlong *)(param_4 + 2) + lVar2),
                    (longlong)(iVar1 << 2));
      iVar3 = iVar3 + 1;
      lVar2 = lVar2 + 8;
    } while (iVar3 < param_4[1]);
  }
  return;
}



int * FUN_18000f670(int *param_1)

{
  int *piVar1;
  
  piVar1 = FUN_18000f3c0(*param_1,param_1[1]);
  if (piVar1 == (int *)0x0) {
    return (int *)0x0;
  }
  FUN_18001d560((undefined8 *)**(undefined8 **)(piVar1 + 2),
                (undefined8 *)**(undefined8 **)(param_1 + 2),(longlong)(*param_1 * param_1[1]) << 2)
  ;
  return piVar1;
}



void FUN_18000f6d0(uint *param_1,longlong param_2)

{
  int *piVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  ulonglong *puVar12;
  LPVOID pvVar13;
  LPVOID pvVar14;
  longlong lVar15;
  longlong lVar16;
  longlong lVar17;
  int *piVar18;
  int iVar19;
  longlong lVar20;
  longlong lVar21;
  int iVar22;
  ulonglong *puVar23;
  ulonglong uVar24;
  
  uVar3 = *param_1;
  uVar24 = (ulonglong)(int)uVar3;
  uVar4 = param_1[1];
  lVar17 = (longlong)(int)uVar4;
  iVar22 = 0;
  puVar12 = (ulonglong *)FUN_18001ed60(lVar17 * 8);
  pvVar13 = FUN_18001ee18(uVar24,4);
  lVar21 = 0;
  do {
    pvVar14 = FUN_18001ed60(uVar24 * 4);
    lVar20 = lVar21 + 1;
    puVar12[lVar21] = (ulonglong)pvVar14;
    lVar21 = lVar20;
  } while (lVar20 < 3);
  if (-1 < lVar17) {
    lVar21 = -1;
    puVar23 = puVar12;
    do {
      if (-1 < lVar21 + -2) {
        pvVar14 = (LPVOID)puVar23[-3];
        lVar20 = 0;
        if ((0 < (int)uVar3) && (7 < uVar3)) {
          iVar19 = 0;
          if (((LPVOID)((longlong)pvVar14 + (longlong)(int)(uVar3 - 1) * 4) < pvVar13) ||
             ((LPVOID)((longlong)pvVar13 + (longlong)(int)(uVar3 - 1) * 4) < pvVar14)) {
            uVar10 = uVar3 & 0x80000007;
            if ((int)uVar10 < 0) {
              uVar10 = (uVar10 - 1 | 0xfffffff8) + 1;
            }
            do {
              lVar15 = (longlong)iVar19;
              lVar20 = lVar20 + 8;
              piVar18 = (int *)((longlong)pvVar14 + lVar15 * 4);
              iVar11 = piVar18[1];
              iVar5 = piVar18[2];
              iVar6 = piVar18[3];
              piVar1 = (int *)((longlong)pvVar13 + lVar15 * 4);
              iVar7 = piVar1[1];
              iVar8 = piVar1[2];
              iVar9 = piVar1[3];
              piVar2 = (int *)((longlong)pvVar13 + lVar15 * 4);
              *piVar2 = *piVar1 - *piVar18;
              piVar2[1] = iVar7 - iVar11;
              piVar2[2] = iVar8 - iVar5;
              piVar2[3] = iVar9 - iVar6;
              iVar11 = iVar19 + 4;
              iVar19 = iVar19 + 8;
              lVar15 = (longlong)iVar11;
              piVar18 = (int *)((longlong)pvVar13 + lVar15 * 4);
              iVar11 = piVar18[1];
              iVar5 = piVar18[2];
              iVar6 = piVar18[3];
              piVar1 = (int *)((longlong)pvVar14 + lVar15 * 4);
              iVar7 = piVar1[1];
              iVar8 = piVar1[2];
              iVar9 = piVar1[3];
              piVar2 = (int *)((longlong)pvVar13 + lVar15 * 4);
              *piVar2 = *piVar18 - *piVar1;
              piVar2[1] = iVar11 - iVar7;
              piVar2[2] = iVar5 - iVar8;
              piVar2[3] = iVar6 - iVar9;
            } while (iVar19 < (int)(uVar3 - uVar10));
          }
        }
        if (lVar20 < (longlong)uVar24) {
          lVar15 = uVar24 - lVar20;
          piVar18 = (int *)((longlong)pvVar13 + lVar20 * 4);
          do {
            *piVar18 = *piVar18 -
                       *(int *)(((longlong)pvVar14 - (longlong)pvVar13) + (longlong)piVar18);
            lVar15 = lVar15 + -1;
            piVar18 = piVar18 + 1;
          } while (lVar15 != 0);
        }
        iVar22 = iVar22 + -1;
      }
      lVar20 = lVar21 + 1;
      if (lVar20 < lVar17) {
        if (-1 < lVar21 + -2) {
          *puVar23 = puVar23[-3];
        }
        FUN_18001d560((undefined8 *)*puVar23,
                      *(undefined8 **)
                       ((*(longlong *)(param_1 + 2) - (longlong)puVar12) + (longlong)puVar23),
                      uVar24 * 4);
        pvVar14 = (LPVOID)*puVar23;
        lVar15 = 0;
        if ((0 < (int)uVar3) && (7 < uVar3)) {
          iVar19 = 0;
          if (((LPVOID)((longlong)pvVar14 + (longlong)(int)(uVar3 - 1) * 4) < pvVar13) ||
             ((LPVOID)((longlong)pvVar13 + (longlong)(int)(uVar3 - 1) * 4) < pvVar14)) {
            uVar10 = uVar3 & 0x80000007;
            if ((int)uVar10 < 0) {
              uVar10 = (uVar10 - 1 | 0xfffffff8) + 1;
            }
            do {
              lVar16 = (longlong)iVar19;
              lVar15 = lVar15 + 8;
              piVar18 = (int *)((longlong)pvVar13 + lVar16 * 4);
              iVar11 = piVar18[1];
              iVar5 = piVar18[2];
              iVar6 = piVar18[3];
              piVar1 = (int *)((longlong)pvVar14 + lVar16 * 4);
              iVar7 = piVar1[1];
              iVar8 = piVar1[2];
              iVar9 = piVar1[3];
              piVar2 = (int *)((longlong)pvVar13 + lVar16 * 4);
              *piVar2 = *piVar1 + *piVar18;
              piVar2[1] = iVar7 + iVar11;
              piVar2[2] = iVar8 + iVar5;
              piVar2[3] = iVar9 + iVar6;
              iVar11 = iVar19 + 4;
              iVar19 = iVar19 + 8;
              lVar16 = (longlong)iVar11;
              piVar18 = (int *)((longlong)pvVar14 + lVar16 * 4);
              iVar11 = piVar18[1];
              iVar5 = piVar18[2];
              iVar6 = piVar18[3];
              piVar1 = (int *)((longlong)pvVar13 + lVar16 * 4);
              iVar7 = piVar1[1];
              iVar8 = piVar1[2];
              iVar9 = piVar1[3];
              piVar2 = (int *)((longlong)pvVar13 + lVar16 * 4);
              *piVar2 = *piVar18 + *piVar1;
              piVar2[1] = iVar11 + iVar7;
              piVar2[2] = iVar5 + iVar8;
              piVar2[3] = iVar6 + iVar9;
            } while (iVar19 < (int)(uVar3 - uVar10));
          }
        }
        if (lVar15 < (longlong)uVar24) {
          lVar16 = uVar24 - lVar15;
          piVar18 = (int *)((longlong)pvVar13 + lVar15 * 4);
          do {
            *piVar18 = *piVar18 +
                       *(int *)((longlong)piVar18 + ((longlong)pvVar14 - (longlong)pvVar13));
            lVar16 = lVar16 + -1;
            piVar18 = piVar18 + 1;
          } while (lVar16 != 0);
        }
        iVar22 = iVar22 + 1;
      }
      if (-1 < lVar21) {
        lVar15 = -1;
        iVar11 = 0;
        iVar19 = 0;
        lVar21 = *(longlong *)
                  ((longlong)puVar23 + *(longlong *)(param_1 + 2) + (-8 - (longlong)puVar12));
        if (-1 < (longlong)uVar24) {
          piVar18 = (int *)((longlong)pvVar13 + -0xc);
          lVar16 = (*(longlong *)
                     ((longlong)puVar23 + *(longlong *)(param_2 + 8) + (-8 - (longlong)puVar12)) -
                   (longlong)pvVar13) + 8;
          do {
            if (-1 < lVar15 + -2) {
              iVar11 = iVar11 - *piVar18;
              iVar19 = iVar19 - iVar22;
            }
            if (lVar15 + 1 < (longlong)uVar24) {
              iVar11 = iVar11 + piVar18[3];
              iVar19 = iVar19 + iVar22;
            }
            if (-1 < lVar15) {
              if (iVar19 == 9) {
                *(int *)(lVar16 + (longlong)piVar18) =
                     ((*(int *)((lVar21 - (longlong)pvVar13) + 8 + (longlong)piVar18) + iVar11 * 4)
                      * 2 + 0x25) / 0x4a;
              }
              else {
                *(int *)(lVar16 + (longlong)piVar18) = iVar11 / iVar19;
              }
            }
            lVar15 = lVar15 + 1;
            piVar18 = piVar18 + 1;
          } while (lVar15 < (longlong)uVar24);
        }
      }
      puVar23 = puVar23 + 1;
      lVar21 = lVar20;
    } while (lVar20 < lVar17);
  }
  for (lVar21 = (longlong)(int)(uVar4 - 3); lVar21 < lVar17; lVar21 = lVar21 + 1) {
    FUN_18001d45c((LPVOID)puVar12[lVar21]);
  }
  FUN_18001d45c(puVar12);
  FUN_18001d45c(pvVar13);
  return;
}



void FUN_18000fa80(int *param_1,longlong param_2,longlong param_3,int param_4)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  int iVar4;
  longlong lVar5;
  longlong *plVar6;
  longlong lVar7;
  longlong lVar8;
  int iVar9;
  longlong *plVar10;
  longlong lVar11;
  longlong lVar12;
  int iVar13;
  
  lVar8 = 1;
  if (param_4 < 2) {
    iVar9 = 1 - param_4;
  }
  else {
    iVar9 = param_4 + -2;
  }
  iVar4 = param_1[1] + -2;
  if (param_4 < iVar4) {
    iVar4 = param_4 + 2;
  }
  else if (param_4 == iVar4) {
    iVar4 = param_1[1] + -1;
  }
  lVar1 = *(longlong *)(param_1 + 2);
  iVar13 = 0;
  if (0 < *param_1) {
    lVar5 = 0;
    plVar6 = (longlong *)((longlong)iVar4 * 8 + lVar1);
    plVar10 = (longlong *)((longlong)iVar9 * 8 + lVar1);
    lVar11 = (longlong)(*param_1 + -2);
    do {
      lVar7 = lVar8;
      if (1 < lVar5) {
        lVar7 = lVar5 + -2;
      }
      if (lVar5 < lVar11) {
        lVar12 = lVar5 + 2;
      }
      else {
        lVar12 = lVar11 + 1;
        if (lVar5 != lVar11) {
          lVar12 = lVar11;
        }
      }
      if (param_2 != 0) {
        lVar2 = *plVar6;
        lVar3 = *plVar10;
        iVar9 = (((*(int *)(lVar3 + lVar12 * 4) - *(int *)(lVar3 + lVar7 * 4)) -
                 *(int *)(lVar2 + lVar7 * 4)) + *(int *)(lVar2 + lVar12 * 4)) * 3;
        lVar2 = *(longlong *)(lVar1 + (longlong)param_4 * 8);
        iVar4 = (*(int *)(lVar2 + lVar12 * 4) - *(int *)(lVar2 + lVar7 * 4)) * 10;
        *(int *)(param_2 + lVar5 * 4) = (int)((uint)(0 < iVar4 + iVar9) + iVar4 + 0x1f + iVar9) >> 6
        ;
      }
      lVar2 = *plVar6;
      lVar3 = *plVar10;
      iVar9 = (((*(int *)(lVar2 + lVar7 * 4) - *(int *)(lVar3 + lVar7 * 4)) -
               *(int *)(lVar3 + lVar12 * 4)) + *(int *)(lVar2 + lVar12 * 4)) * 3;
      iVar4 = (*(int *)(lVar2 + lVar5 * 4) - *(int *)(lVar3 + lVar5 * 4)) * 10;
      iVar13 = iVar13 + 1;
      lVar5 = lVar5 + 1;
      lVar8 = lVar8 + -1;
      *(int *)(param_3 + -4 + lVar5 * 4) = (int)((0 < iVar4 + iVar9) + 0x1f + iVar4 + iVar9) >> 6;
    } while (iVar13 < *param_1);
  }
  return;
}



void FUN_18000fc20(int *param_1,longlong param_2,longlong param_3)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  longlong lVar4;
  ulonglong uVar5;
  int iVar6;
  int iVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  int iVar10;
  longlong lVar11;
  int iVar12;
  longlong lVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  longlong lVar16;
  uint uVar17;
  longlong local_res10;
  ulonglong uVar18;
  
  uVar8 = 0;
  if (param_2 == 0) {
    iVar7 = param_1[1];
    if (0 < iVar7) {
      iVar12 = *param_1;
      local_res10 = 1;
      uVar9 = uVar8;
      uVar5 = uVar8;
      do {
        lVar1 = *(longlong *)(*(longlong *)(param_3 + 8) + uVar9 * 8);
        lVar13 = local_res10;
        if (1 < (longlong)uVar9) {
          lVar13 = uVar9 - 2;
        }
        iVar6 = iVar7 + -2;
        iVar10 = (int)uVar5;
        if (iVar10 < iVar6) {
          iVar6 = iVar10 + 2;
        }
        else if (iVar10 == iVar6) {
          iVar6 = iVar7 + -1;
        }
        lVar2 = *(longlong *)(param_1 + 2);
        if (0 < iVar12) {
          uVar15 = (ulonglong)(iVar12 + -2);
          lVar11 = 1;
          uVar5 = uVar8;
          uVar18 = uVar8;
          do {
            lVar16 = lVar11;
            if (1 < (longlong)uVar5) {
              lVar16 = uVar5 - 2;
            }
            if ((longlong)uVar5 < (longlong)uVar15) {
              uVar14 = uVar5 + 2;
            }
            else {
              uVar14 = uVar15 + 1;
              if (uVar5 != uVar15) {
                uVar14 = uVar15;
              }
            }
            lVar3 = *(longlong *)(lVar2 + (longlong)iVar6 * 8);
            lVar4 = *(longlong *)(lVar2 + lVar13 * 8);
            iVar7 = (((*(int *)(lVar3 + lVar16 * 4) - *(int *)(lVar4 + lVar16 * 4)) -
                     *(int *)(lVar4 + uVar14 * 4)) + *(int *)(lVar3 + uVar14 * 4)) * 3;
            iVar12 = (*(int *)(lVar3 + uVar5 * 4) - *(int *)(lVar4 + uVar5 * 4)) * 10;
            uVar17 = (int)uVar18 + 1;
            uVar18 = (ulonglong)uVar17;
            uVar5 = uVar5 + 1;
            lVar11 = lVar11 + -1;
            *(int *)(lVar1 + -4 + uVar5 * 4) =
                 (int)((0 < iVar12 + iVar7) + 0x1f + iVar12 + iVar7) >> 6;
            iVar12 = *param_1;
          } while ((int)uVar17 < iVar12);
        }
        iVar7 = param_1[1];
        local_res10 = local_res10 + -1;
        uVar5 = (ulonglong)(iVar10 + 1U);
        uVar9 = uVar9 + 1;
      } while ((int)(iVar10 + 1U) < iVar7);
      return;
    }
  }
  else {
    uVar9 = uVar8;
    if (0 < param_1[1]) {
      do {
        FUN_18000fa80(param_1,*(longlong *)(*(longlong *)(param_2 + 8) + uVar9),
                      *(longlong *)(*(longlong *)(param_3 + 8) + uVar9),(int)uVar8);
        uVar17 = (int)uVar8 + 1;
        uVar8 = (ulonglong)uVar17;
        uVar9 = uVar9 + 8;
      } while ((int)uVar17 < param_1[1]);
    }
  }
  return;
}



void FUN_18000fde0(uint *param_1,longlong param_2,longlong param_3)

{
  uint uVar1;
  uint uVar2;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  longlong lVar9;
  int iVar10;
  ulonglong uVar11;
  longlong lVar12;
  ulonglong uVar13;
  longlong lVar14;
  int local_res20;
  
  uVar1 = param_1[1];
  uVar2 = *param_1;
  uVar11 = (ulonglong)(int)uVar2;
  lVar9 = 0;
  local_res20 = 0;
  if (0 < (int)uVar1) {
    uVar13 = uVar11;
    do {
      if (lVar9 == 0) {
        lVar6 = 0;
      }
      else {
        lVar6 = lVar9 + -1;
      }
      lVar7 = *(longlong *)(param_1 + 2);
      lVar3 = *(longlong *)(lVar7 + lVar6 * 8);
      lVar4 = *(longlong *)(lVar7 + lVar9 * 8);
      lVar6 = (longlong)(int)uVar1 + -1;
      if (local_res20 != uVar1 - 1) {
        lVar6 = lVar9 + 1;
      }
      lVar6 = *(longlong *)(lVar7 + lVar6 * 8);
      iVar10 = 0;
      lVar7 = 0;
      if (0 < (longlong)uVar11) {
        do {
          if (lVar7 == 0) {
            lVar14 = 0;
          }
          else {
            lVar14 = lVar7 + -1;
          }
          lVar12 = uVar11 - 1;
          if (iVar10 != (int)uVar13 + -1) {
            lVar12 = lVar7 + 1;
          }
          if (param_2 != 0) {
            iVar8 = (((*(int *)(lVar4 + lVar12 * 4) - *(int *)(lVar4 + lVar14 * 4)) * 2 -
                     *(int *)(lVar6 + lVar14 * 4)) - *(int *)(lVar3 + lVar14 * 4)) +
                    *(int *)(lVar6 + lVar12 * 4) + *(int *)(lVar3 + lVar12 * 4);
            iVar5 = -4;
            if (0 < iVar8) {
              iVar5 = 4;
            }
            iVar5 = iVar5 + iVar8;
            *(int *)(*(longlong *)(*(longlong *)(param_2 + 8) + lVar9 * 8) + lVar7 * 4) =
                 (int)(iVar5 + (iVar5 >> 0x1f & 7U)) >> 3;
          }
          if (param_3 != 0) {
            iVar8 = (((*(int *)(lVar6 + lVar7 * 4) - *(int *)(lVar3 + lVar7 * 4)) * 2 -
                     *(int *)(lVar3 + lVar14 * 4)) - *(int *)(lVar3 + lVar12 * 4)) +
                    *(int *)(lVar6 + lVar14 * 4) + *(int *)(lVar6 + lVar12 * 4);
            iVar5 = -4;
            if (0 < iVar8) {
              iVar5 = 4;
            }
            iVar5 = iVar5 + iVar8;
            *(int *)(*(longlong *)(*(longlong *)(param_3 + 8) + lVar9 * 8) + lVar7 * 4) =
                 (int)(iVar5 + (iVar5 >> 0x1f & 7U)) >> 3;
          }
          lVar7 = lVar7 + 1;
          iVar10 = iVar10 + 1;
        } while (lVar7 < (longlong)uVar11);
        uVar13 = (ulonglong)uVar2;
      }
      local_res20 = local_res20 + 1;
      lVar9 = lVar9 + 1;
    } while (lVar9 < (int)uVar1);
  }
  return;
}



LPVOID FUN_18000ff90(int param_1,int param_2)

{
  LPVOID pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = FUN_18001ee18((longlong)(param_1 * param_2 + param_2 * 8),1);
  if (pvVar1 != (LPVOID)0x0) {
    lVar2 = 0;
    lVar3 = (longlong)pvVar1 + (longlong)(param_2 * 8);
    if (0 < param_2) {
      do {
        *(longlong *)((longlong)pvVar1 + lVar2 * 8) = lVar3;
        lVar2 = lVar2 + 1;
        lVar3 = lVar3 + param_1;
      } while (lVar2 < param_2);
    }
    return pvVar1;
  }
  return (LPVOID)0x0;
}



void FUN_180010020(int param_1,int param_2,longlong param_3)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  int *piVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  longlong lVar8;
  int iVar9;
  ulonglong uVar10;
  int iVar11;
  char *pcVar12;
  int iVar13;
  int *piVar14;
  int iVar15;
  undefined8 *puVar16;
  undefined8 *local_48;
  
  uVar10 = (ulonglong)param_1;
  lVar7 = (longlong)param_2;
  iVar9 = 0;
  puVar1 = (undefined8 *)FUN_18001ed60(uVar10);
  puVar2 = (undefined8 *)FUN_18001ed60(uVar10);
  local_48 = (undefined8 *)FUN_18001ed60(uVar10);
  piVar3 = (int *)FUN_18001ee18(uVar10,4);
  iVar15 = -3;
  lVar8 = -1;
  if (-1 < lVar7) {
    do {
      puVar16 = puVar1;
      puVar1 = puVar2;
      if (-1 < iVar15) {
        lVar4 = 0;
        if (0 < (longlong)uVar10) {
          do {
            lVar5 = lVar4 + 1;
            piVar3[lVar4] = piVar3[lVar4] - (uint)*(byte *)(lVar4 + (longlong)puVar16);
            lVar4 = lVar5;
          } while (lVar5 < (longlong)uVar10);
        }
        iVar9 = iVar9 + -1;
      }
      lVar4 = lVar8 + 1;
      if (lVar4 < lVar7) {
        FUN_18001d560(puVar16,*(undefined8 **)(param_3 + 8 + lVar8 * 8),uVar10);
        lVar5 = 0;
        if (0 < (longlong)uVar10) {
          do {
            lVar6 = lVar5 + 1;
            piVar3[lVar5] = piVar3[lVar5] + (uint)*(byte *)(lVar5 + (longlong)puVar16);
            lVar5 = lVar6;
          } while (lVar6 < (longlong)uVar10);
        }
        iVar9 = iVar9 + 1;
      }
      if (-1 < lVar8) {
        iVar11 = 0;
        iVar13 = 0;
        lVar8 = *(longlong *)(param_3 + lVar8 * 8);
        if (-1 < (longlong)uVar10) {
          pcVar12 = (char *)(lVar8 + -1);
          lVar8 = -lVar8;
          piVar14 = piVar3;
          do {
            if (-1 < (longlong)(pcVar12 + lVar8 + 1 + -3)) {
              iVar11 = iVar11 - piVar14[-3];
              iVar13 = iVar13 - iVar9;
            }
            if ((longlong)(pcVar12 + lVar8 + 1) < (longlong)uVar10) {
              iVar11 = iVar11 + *piVar14;
              iVar13 = iVar13 + iVar9;
            }
            if (-1 < lVar8 + (longlong)pcVar12) {
              if (iVar13 == 9) {
                *pcVar12 = ((char)(iVar11 >> 10) - (char)(iVar11 >> 6)) + (char)(iVar11 >> 3);
              }
              else {
                *pcVar12 = (char)(iVar11 / iVar13);
              }
            }
            pcVar12 = pcVar12 + 1;
            piVar14 = piVar14 + 1;
          } while (lVar8 + (longlong)pcVar12 < (longlong)uVar10);
        }
      }
      iVar15 = iVar15 + 1;
      lVar8 = lVar4;
      puVar2 = local_48;
      local_48 = puVar16;
    } while (lVar4 < lVar7);
  }
  FUN_18001d45c(puVar1);
  FUN_18001d45c(puVar2);
  FUN_18001d45c(local_48);
  FUN_18001d45c(piVar3);
  return;
}



void FUN_180010210(int param_1,int param_2,longlong param_3)

{
  longlong lVar1;
  int iVar2;
  LPVOID pvVar3;
  int *piVar4;
  LPVOID pvVar5;
  longlong lVar6;
  longlong lVar7;
  ulonglong uVar8;
  int iVar9;
  longlong lVar10;
  longlong *plVar11;
  int iVar12;
  int iVar13;
  int *piVar14;
  longlong lVar15;
  
  lVar15 = (longlong)param_2;
  uVar8 = (ulonglong)param_1;
  iVar2 = param_2;
  if (9 < param_2) {
    iVar2 = 9;
  }
  iVar9 = 0;
  pvVar3 = FUN_18001ed60((longlong)(param_2 * 8));
  piVar4 = (int *)FUN_18001ee18(uVar8,4);
  lVar10 = 0;
  if (0 < (longlong)iVar2) {
    do {
      pvVar5 = FUN_18001ed60(uVar8);
      lVar10 = lVar10 + 1;
      *(LPVOID *)((longlong)pvVar3 + lVar10 * 8 + -8) = pvVar5;
    } while (lVar10 < iVar2);
  }
  if (-4 < lVar15) {
    lVar10 = -4;
    plVar11 = (longlong *)((longlong)pvVar3 + -0x48);
    do {
      if (-1 < lVar10 + -5) {
        lVar1 = *plVar11;
        lVar6 = 0;
        if (0 < (longlong)uVar8) {
          do {
            lVar7 = lVar6 + 1;
            piVar4[lVar6] = piVar4[lVar6] - (uint)*(byte *)(lVar6 + lVar1);
            lVar6 = lVar7;
          } while (lVar7 < (longlong)uVar8);
        }
        iVar9 = iVar9 + -1;
      }
      if (lVar10 + 4 < lVar15) {
        if (-1 < lVar10 + -5) {
          plVar11[9] = *plVar11;
        }
        FUN_18001d560((undefined8 *)plVar11[9],
                      *(undefined8 **)((param_3 - (longlong)pvVar3) + 0x48 + (longlong)plVar11),
                      uVar8);
        lVar1 = plVar11[9];
        lVar6 = 0;
        if (0 < (longlong)uVar8) {
          do {
            lVar7 = lVar6 + 1;
            piVar4[lVar6] = piVar4[lVar6] + (uint)*(byte *)(lVar6 + lVar1);
            lVar6 = lVar7;
          } while (lVar7 < (longlong)uVar8);
        }
        iVar9 = iVar9 + 1;
      }
      if (-1 < lVar10) {
        lVar1 = *(longlong *)((param_3 - (longlong)pvVar3) + 0x28 + (longlong)plVar11);
        iVar12 = 0;
        iVar13 = 0;
        if (-4 < (longlong)uVar8) {
          lVar6 = 0;
          piVar14 = piVar4;
          do {
            if (-1 < lVar6 + -9) {
              iVar12 = iVar12 - piVar14[-9];
              iVar13 = iVar13 - iVar9;
            }
            if (lVar6 < (longlong)uVar8) {
              iVar12 = iVar12 + *piVar14;
              iVar13 = iVar13 + iVar9;
            }
            if (-1 < lVar6 + -4) {
              *(char *)(lVar1 + -4 + lVar6) = (char)(iVar12 / iVar13);
            }
            piVar14 = piVar14 + 1;
            lVar7 = lVar6 + -3;
            lVar6 = lVar6 + 1;
          } while (lVar7 < (longlong)uVar8);
        }
      }
      lVar10 = lVar10 + 1;
      plVar11 = plVar11 + 1;
    } while (lVar10 < lVar15);
  }
  for (lVar10 = (longlong)(param_2 - iVar2); lVar10 < lVar15; lVar10 = lVar10 + 1) {
    FUN_18001d45c(*(LPVOID *)((longlong)pvVar3 + lVar10 * 8));
  }
  FUN_18001d45c(pvVar3);
  FUN_18001d45c(piVar4);
  return;
}



void FUN_1800103e0(uint param_1,int param_2,longlong param_3,undefined8 *param_4,undefined8 param_5,
                  undefined8 param_6,longlong param_7)

{
  longlong lVar1;
  byte *pbVar2;
  int *piVar3;
  byte bVar4;
  int *piVar5;
  int *piVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  LPVOID pvVar10;
  uint uVar11;
  LPVOID pvVar12;
  longlong lVar13;
  byte *pbVar14;
  uint uVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  int iVar18;
  ulonglong uVar19;
  longlong lVar20;
  int *piVar21;
  byte bVar22;
  int iVar23;
  int iVar24;
  int *piVar25;
  byte bVar26;
  ulonglong uVar27;
  longlong *plVar28;
  ulonglong uVar29;
  undefined1 auVar30 [16];
  undefined1 in_XMM2 [16];
  undefined1 auVar31 [16];
  undefined1 auVar32 [16];
  undefined1 auVar33 [16];
  undefined1 auStack_328 [32];
  int local_308;
  uint local_304;
  int local_300;
  longlong local_2f8;
  int local_2f0;
  LPVOID local_2e8;
  longlong *local_2e0;
  longlong local_2d8;
  longlong local_2c8;
  int local_2c0;
  longlong local_2b8;
  int *local_2b0;
  longlong local_2a8;
  undefined8 *local_2a0;
  longlong local_298;
  longlong local_290;
  longlong local_288;
  longlong local_280;
  ulonglong local_278;
  longlong local_270;
  longlong local_268;
  byte local_258 [256];
  int local_158 [64];
  ulonglong local_58;
  
  local_58 = DAT_1800461a0 ^ (ulonglong)auStack_328;
  uVar27 = (ulonglong)(int)param_1;
  iVar18 = param_2;
  if (0x11 < param_2) {
    iVar18 = 0x11;
  }
  uVar29 = 0;
  local_308 = 0;
  local_2f0 = param_2;
  local_2c8 = param_3;
  local_2c0 = iVar18;
  local_2a0 = param_4;
  local_2e0 = (longlong *)FUN_18000ff90(param_1,param_2);
  local_304 = 0;
  local_300 = 0;
  local_2e8 = FUN_18001ed60((longlong)(param_2 * 8));
  local_2b0 = (int *)FUN_18001ee18(uVar27,4);
  pvVar10 = local_2e8;
  uVar19 = uVar29;
  if (0 < (longlong)iVar18) {
    do {
      pvVar12 = FUN_18001ed60(uVar27);
      uVar19 = uVar19 + 1;
      *(LPVOID *)((longlong)pvVar10 + uVar19 * 8 + -8) = pvVar12;
    } while ((longlong)uVar19 < (longlong)iVar18);
  }
  piVar21 = local_2b0;
  FUN_18001dbc0((undefined1 (*) [16])local_258,0,0x100);
  FUN_18001dbc0((undefined1 (*) [16])local_158,0,0x100);
  iVar18 = local_2f0;
  lVar20 = (longlong)local_2f0;
  local_278 = (ulonglong)(int)(local_2f0 * param_1);
  FUN_18001dbc0((undefined1 (*) [16])*local_2e0,0,local_278);
  uVar19 = uVar29;
  local_2d8 = lVar20;
  if (-8 < lVar20) {
    local_268 = (longlong)local_2e0 - param_7;
    local_270 = (longlong)local_2a0 - param_7;
    local_2f8 = (longlong)local_2e8 - param_7;
    local_2c8 = local_2c8 - param_7;
    local_2a8 = local_270 + 0x40;
    local_288 = local_2c8 + -0x48;
    local_298 = local_2c8 + 0x40;
    local_2b8 = -8;
    plVar28 = (longlong *)(param_7 + -0x40);
    uVar19 = uVar27;
    do {
      lVar20 = local_2b8;
      uVar15 = (uint)uVar19;
      if (-1 < local_2b8 + -9) {
        piVar5 = *(int **)(local_288 + (longlong)plVar28);
        piVar6 = *(int **)(local_2f8 + -0x48 + (longlong)plVar28);
        uVar16 = 0;
        uVar17 = uVar29;
        if (((0 < (int)uVar15) && (7 < uVar15)) && (uVar17 = uVar16, 1 < DAT_180046320)) {
          lVar13 = (longlong)(int)(uVar15 - 1);
          if ((((int *)(lVar13 + (longlong)piVar5) < piVar21) || (piVar21 + lVar13 < piVar5)) &&
             (((int *)(lVar13 + (longlong)piVar6) < piVar21 || (piVar21 + lVar13 < piVar6)))) {
            uVar11 = uVar15 & 0x80000007;
            if ((int)uVar11 < 0) {
              uVar11 = (uVar11 - 1 | 0xfffffff8) + 1;
            }
            uVar17 = uVar29;
            uVar16 = uVar29;
            do {
              iVar23 = (int)uVar16;
              lVar13 = (longlong)iVar23;
              uVar17 = uVar17 + 8;
              piVar25 = piVar21 + lVar13;
              iVar18 = piVar25[1];
              iVar8 = piVar25[2];
              iVar9 = piVar25[3];
              auVar31 = pmovzxbd(in_XMM2,ZEXT416(*(uint *)(lVar13 + (longlong)piVar6)));
              auVar30 = pmovzxbd(ZEXT416(*(uint *)(lVar13 + (longlong)piVar6)),
                                 ZEXT416(*(uint *)(lVar13 + (longlong)piVar5)));
              auVar32._0_4_ = auVar31._0_4_ - auVar30._0_4_;
              auVar32._4_4_ = auVar31._4_4_ - auVar30._4_4_;
              auVar32._8_4_ = auVar31._8_4_ - auVar30._8_4_;
              auVar32._12_4_ = auVar31._12_4_ - auVar30._12_4_;
              auVar30 = pabsd(ZEXT416(*(uint *)(lVar13 + (longlong)piVar5)),auVar32);
              piVar3 = piVar21 + lVar13;
              *piVar3 = *piVar25 - auVar30._0_4_;
              piVar3[1] = iVar18 - auVar30._4_4_;
              piVar3[2] = iVar8 - auVar30._8_4_;
              piVar3[3] = iVar9 - auVar30._12_4_;
              uVar16 = (ulonglong)(iVar23 + 8U);
              lVar13 = (longlong)(iVar23 + 4);
              piVar25 = piVar21 + lVar13;
              iVar18 = piVar25[1];
              iVar8 = piVar25[2];
              iVar9 = piVar25[3];
              auVar31 = pmovzxbd(auVar32,ZEXT416(*(uint *)(lVar13 + (longlong)piVar6)));
              auVar30 = pmovzxbd(ZEXT416(*(uint *)(lVar13 + (longlong)piVar6)),
                                 ZEXT416(*(uint *)(lVar13 + (longlong)piVar5)));
              in_XMM2._0_4_ = auVar31._0_4_ - auVar30._0_4_;
              in_XMM2._4_4_ = auVar31._4_4_ - auVar30._4_4_;
              in_XMM2._8_4_ = auVar31._8_4_ - auVar30._8_4_;
              in_XMM2._12_4_ = auVar31._12_4_ - auVar30._12_4_;
              auVar30 = pabsd(ZEXT416(*(uint *)(lVar13 + (longlong)piVar5)),in_XMM2);
              piVar3 = piVar21 + lVar13;
              *piVar3 = *piVar25 - auVar30._0_4_;
              piVar3[1] = iVar18 - auVar30._4_4_;
              piVar3[2] = iVar8 - auVar30._8_4_;
              piVar3[3] = iVar9 - auVar30._12_4_;
            } while ((int)(iVar23 + 8U) < (int)(uVar15 - uVar11));
          }
        }
        if ((longlong)uVar17 < (longlong)uVar27) {
          pbVar14 = (byte *)(uVar17 + (longlong)piVar5);
          lVar13 = uVar27 - uVar17;
          piVar25 = piVar21 + uVar17;
          do {
            pbVar2 = pbVar14 + ((longlong)piVar6 - (longlong)piVar5);
            bVar22 = *pbVar14;
            pbVar14 = pbVar14 + 1;
            uVar11 = (int)((uint)*pbVar2 - (uint)bVar22) >> 0x1f;
            *piVar25 = *piVar25 - (((uint)*pbVar2 - (uint)bVar22 ^ uVar11) - uVar11);
            lVar13 = lVar13 + -1;
            piVar25 = piVar25 + 1;
          } while (lVar13 != 0);
        }
        local_308 = local_308 + -1;
      }
      iVar18 = local_308;
      if (local_2b8 + 8 < local_2d8) {
        if (-1 < local_2b8 + -9) {
          *(undefined8 *)(local_2f8 + 0x40 + (longlong)plVar28) =
               *(undefined8 *)(local_2f8 + -0x48 + (longlong)plVar28);
        }
        FUN_18001d560(*(undefined8 **)(local_2f8 + 0x40 + (longlong)plVar28),
                      *(undefined8 **)(local_2a8 + (longlong)plVar28),uVar27);
        piVar5 = *(int **)(local_298 + (longlong)plVar28);
        piVar6 = *(int **)(local_2f8 + 0x40 + (longlong)plVar28);
        uVar16 = 0;
        uVar17 = uVar29;
        if (((0 < (int)uVar15) && (7 < uVar15)) && (uVar17 = uVar16, 1 < DAT_180046320)) {
          lVar13 = (longlong)(int)(uVar15 - 1);
          if ((((int *)(lVar13 + (longlong)piVar5) < piVar21) || (piVar21 + lVar13 < piVar5)) &&
             (((int *)(lVar13 + (longlong)piVar6) < piVar21 || (piVar21 + lVar13 < piVar6)))) {
            uVar11 = uVar15 & 0x80000007;
            if ((int)uVar11 < 0) {
              uVar11 = (uVar11 - 1 | 0xfffffff8) + 1;
            }
            uVar17 = uVar29;
            uVar16 = uVar29;
            do {
              iVar24 = (int)uVar16;
              lVar13 = (longlong)iVar24;
              uVar17 = uVar17 + 8;
              auVar31 = pmovzxbd(in_XMM2,ZEXT416(*(uint *)(lVar13 + (longlong)piVar6)));
              auVar30 = pmovzxbd(ZEXT416(*(uint *)(lVar13 + (longlong)piVar6)),
                                 ZEXT416(*(uint *)(lVar13 + (longlong)piVar5)));
              auVar33._0_4_ = auVar31._0_4_ - auVar30._0_4_;
              auVar33._4_4_ = auVar31._4_4_ - auVar30._4_4_;
              auVar33._8_4_ = auVar31._8_4_ - auVar30._8_4_;
              auVar33._12_4_ = auVar31._12_4_ - auVar30._12_4_;
              auVar30 = pabsd(ZEXT416(*(uint *)(lVar13 + (longlong)piVar5)),auVar33);
              piVar25 = piVar21 + lVar13;
              iVar8 = piVar25[1];
              iVar9 = piVar25[2];
              iVar23 = piVar25[3];
              piVar3 = piVar21 + lVar13;
              *piVar3 = auVar30._0_4_ + *piVar25;
              piVar3[1] = auVar30._4_4_ + iVar8;
              piVar3[2] = auVar30._8_4_ + iVar9;
              piVar3[3] = auVar30._12_4_ + iVar23;
              uVar16 = (ulonglong)(iVar24 + 8U);
              lVar13 = (longlong)(iVar24 + 4);
              auVar31 = pmovzxbd(auVar33,ZEXT416(*(uint *)(lVar13 + (longlong)piVar6)));
              auVar30 = pmovzxbd(ZEXT416(*(uint *)(lVar13 + (longlong)piVar6)),
                                 ZEXT416(*(uint *)(lVar13 + (longlong)piVar5)));
              in_XMM2._0_4_ = auVar31._0_4_ - auVar30._0_4_;
              in_XMM2._4_4_ = auVar31._4_4_ - auVar30._4_4_;
              in_XMM2._8_4_ = auVar31._8_4_ - auVar30._8_4_;
              in_XMM2._12_4_ = auVar31._12_4_ - auVar30._12_4_;
              auVar30 = pabsd(ZEXT416(*(uint *)(lVar13 + (longlong)piVar5)),in_XMM2);
              piVar25 = piVar21 + lVar13;
              iVar8 = piVar25[1];
              iVar9 = piVar25[2];
              iVar23 = piVar25[3];
              piVar3 = piVar21 + lVar13;
              *piVar3 = auVar30._0_4_ + *piVar25;
              piVar3[1] = auVar30._4_4_ + iVar8;
              piVar3[2] = auVar30._8_4_ + iVar9;
              piVar3[3] = auVar30._12_4_ + iVar23;
            } while ((int)(iVar24 + 8U) < (int)(uVar15 - uVar11));
          }
        }
        if ((longlong)uVar17 < (longlong)uVar27) {
          pbVar14 = (byte *)(uVar17 + (longlong)piVar5);
          lVar13 = uVar27 - uVar17;
          piVar25 = piVar21 + uVar17;
          do {
            pbVar2 = pbVar14 + ((longlong)piVar6 - (longlong)piVar5);
            bVar22 = *pbVar14;
            pbVar14 = pbVar14 + 1;
            uVar15 = (int)((uint)*pbVar2 - (uint)bVar22) >> 0x1f;
            *piVar25 = *piVar25 + (((uint)*pbVar2 - (uint)bVar22 ^ uVar15) - uVar15);
            lVar13 = lVar13 + -1;
            piVar25 = piVar25 + 1;
          } while (lVar13 != 0);
        }
        local_308 = iVar18 + 1;
      }
      if (-1 < lVar20) {
        lVar20 = local_2b8;
        if (-8 < (longlong)uVar27) {
          local_290 = *(longlong *)(local_2f8 + (longlong)plVar28) + -8;
          local_280 = *(longlong *)(local_2c8 + (longlong)plVar28) + -8;
          lVar13 = *(longlong *)(local_270 + (longlong)plVar28) + -8;
          uVar19 = uVar29;
          uVar17 = uVar29;
          uVar16 = uVar29;
          do {
            if (-1 < (longlong)(uVar19 - 0x11)) {
              uVar17 = (ulonglong)(uint)((int)uVar17 - piVar21[-0x11]);
              uVar16 = (ulonglong)(uint)((int)uVar16 - local_308);
            }
            if ((longlong)uVar19 < (longlong)uVar27) {
              uVar17 = (ulonglong)(uint)((int)uVar17 + *piVar21);
              uVar16 = (ulonglong)(uint)((int)uVar16 + local_308);
            }
            lVar1 = uVar19 - 8;
            if (-1 < lVar1) {
              bVar22 = *(byte *)(local_290 + uVar19);
              lVar7 = (longlong)(int)uVar17 / (longlong)(int)uVar16;
              bVar4 = (byte)lVar7;
              if (bVar22 < bVar4) {
                uVar15 = 0;
              }
              else {
                uVar15 = (uint)(byte)(bVar22 - bVar4);
              }
              if ((int)(0xff - ((uint)lVar7 & 0xff)) < (int)(uint)bVar22) {
                bVar22 = 0xff;
              }
              else {
                bVar22 = bVar22 + bVar4;
              }
              bVar4 = *(byte *)(local_280 + uVar19);
              bVar26 = bVar22 - (byte)uVar15;
              if (bVar26 < 4) {
                *(byte *)(lVar13 + uVar19) = bVar4;
                *(undefined1 *)(lVar1 + *(longlong *)(local_268 + (longlong)plVar28)) = 0xff;
                local_304 = local_304 + bVar4;
                local_300 = local_300 + 1;
              }
              else {
                if ((byte)uVar15 < bVar4) {
                  if (bVar4 < bVar22) {
                    bVar22 = (byte)((int)((bVar4 - uVar15) * 0xff) / (int)(uint)bVar26);
                  }
                  else {
                    bVar22 = 0xff;
                  }
                }
                else {
                  bVar22 = 0;
                }
                *(byte *)(lVar13 + uVar19) = bVar22;
                *(uint *)(local_258 + (ulonglong)(bVar4 >> 2) * 4) =
                     *(int *)(local_258 + (ulonglong)(bVar4 >> 2) * 4) + (uint)bVar22;
                local_158[bVar4 >> 2] = local_158[bVar4 >> 2] + 1;
              }
              *(byte *)(lVar1 + *plVar28) = bVar26;
            }
            piVar21 = piVar21 + 1;
            lVar1 = uVar19 - 7;
            uVar19 = uVar19 + 1;
          } while (lVar1 < (longlong)uVar27);
          uVar19 = (ulonglong)param_1;
          piVar21 = local_2b0;
        }
      }
      local_2b8 = lVar20 + 1;
      plVar28 = plVar28 + 1;
    } while (local_2b8 < local_2d8);
    uVar19 = (ulonglong)local_304;
    iVar18 = local_2f0;
  }
  lVar20 = local_2d8;
  pvVar10 = local_2e8;
  lVar13 = (longlong)(iVar18 - local_2c0);
  if (lVar13 < local_2d8) {
    do {
      FUN_18001d45c(*(LPVOID *)((longlong)pvVar10 + lVar13 * 8));
      lVar13 = lVar13 + 1;
    } while (lVar13 < lVar20);
    uVar19 = (ulonglong)local_304;
  }
  FUN_18001d45c(local_2e8);
  FUN_18001d45c(piVar21);
  lVar20 = 0x40;
  do {
    if (1 < *(int *)((longlong)local_158 + uVar29)) {
      *(int *)(local_258 + uVar29) =
           *(int *)(local_258 + uVar29) / *(int *)((longlong)local_158 + uVar29);
    }
    uVar29 = uVar29 + 4;
    lVar20 = lVar20 + -1;
  } while (lVar20 != 0);
  if (1 < local_300) {
    uVar19 = (longlong)(int)uVar19 / (longlong)local_300 & 0xffffffff;
  }
  pbVar14 = (byte *)*local_2a0;
  if (0 < (longlong)local_278) {
    lVar20 = *local_2e0 - (longlong)pbVar14;
    uVar27 = local_278;
    do {
      if (pbVar14[lVar20] == 0xff) {
        if (local_158[*pbVar14 >> 2] < 1) {
          *pbVar14 = (byte)uVar19;
        }
        else {
          *pbVar14 = local_258[(ulonglong)(*pbVar14 >> 2) * 4];
        }
      }
      pbVar14 = pbVar14 + 1;
      uVar27 = uVar27 - 1;
    } while (uVar27 != 0);
  }
  FUN_18001d45c(local_2e0);
  FUN_18001d530(local_58 ^ (ulonglong)auStack_328);
  return;
}



uint FUN_180010b40(uint param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  if (param_1 == 0) {
    uVar2 = 0x1e;
    if (0 < (int)param_2) {
      uVar2 = 0x5a;
    }
    return uVar2;
  }
  iVar3 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  iVar1 = (param_2 ^ (int)param_2 >> 0x1f) - ((int)param_2 >> 0x1f);
  if (iVar3 < iVar1) {
    uVar2 = 0x1e0 - (byte)(&DAT_180038110)[(iVar1 / 2 + iVar3 * 0x80) / iVar1];
  }
  else {
    uVar2 = (uint)(byte)(&DAT_180038110)[(iVar3 / 2 + iVar1 * 0x80) / iVar3];
  }
  uVar2 = (int)(uVar2 + 8 + ((int)(uVar2 + 8) >> 0x1f & 0xfU)) >> 4;
  if ((int)param_1 < 0) {
    if (-1 < (int)param_2) {
      if ((char)uVar2 == '\0') {
        return uVar2;
      }
      return 0x78 - (uVar2 & 0xff);
    }
  }
  else {
    if ((int)param_2 < 0) {
      return 0x3c - (uVar2 & 0xff);
    }
    uVar2 = (uVar2 & 0xff) + 0x3c;
  }
  return uVar2;
}



// WARNING: Removing unreachable block (ram,0x000180011443)
// WARNING: Removing unreachable block (ram,0x000180011468)

void FUN_180010c00(int param_1,int param_2,longlong param_3,uint param_4,int param_5,
                  longlong param_6,longlong param_7)

{
  longlong *plVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  int *piVar6;
  longlong lVar7;
  uint uVar8;
  longlong *plVar9;
  longlong *plVar10;
  longlong *plVar11;
  int *piVar12;
  int *piVar13;
  int *piVar14;
  longlong lVar15;
  LPVOID pvVar16;
  byte *pbVar17;
  int *piVar18;
  longlong *plVar19;
  undefined1 uVar20;
  int iVar21;
  ulonglong uVar22;
  longlong lVar23;
  int iVar24;
  int iVar25;
  longlong lVar26;
  int *piVar27;
  ulonglong uVar28;
  int iVar29;
  longlong lVar30;
  longlong lVar31;
  int *piVar32;
  int iVar33;
  int *piVar34;
  int iVar35;
  int iVar36;
  longlong lVar37;
  longlong lVar38;
  int iVar39;
  int iVar40;
  int iVar41;
  int iStack0000000000000040;
  int local_f8;
  longlong local_d8;
  int local_c8;
  longlong *local_b8;
  
  uVar22 = (ulonglong)(int)param_4;
  local_f8 = 0x10;
  plVar9 = (longlong *)FUN_18001ed60(0x18);
  plVar10 = (longlong *)FUN_18001ed60(0x18);
  plVar11 = (longlong *)FUN_18001ed60(0x18);
  piVar12 = (int *)FUN_18001ee18(uVar22,4);
  piVar13 = (int *)FUN_18001ee18(uVar22,4);
  piVar14 = (int *)FUN_18001ee18(uVar22,4);
  lVar26 = 3;
  uVar28 = (ulonglong)(int)(param_4 * 4);
  lVar38 = (longlong)plVar9 - (longlong)plVar10;
  lVar15 = (longlong)plVar11 - (longlong)plVar10;
  plVar19 = plVar10;
  do {
    pvVar16 = FUN_18001ed60(uVar28);
    *(LPVOID *)(lVar38 + (longlong)plVar19) = pvVar16;
    pvVar16 = FUN_18001ed60(uVar28);
    *plVar19 = (longlong)pvVar16;
    pvVar16 = FUN_18001ed60(uVar28);
    plVar19 = plVar19 + 1;
    *(LPVOID *)(lVar15 + -8 + (longlong)plVar19) = pvVar16;
    lVar26 = lVar26 + -1;
  } while (lVar26 != 0);
  iStack0000000000000040 = 0;
  local_d8 = -1;
  if (-1 < param_5) {
    local_b8 = (longlong *)(param_7 + -8);
    iVar29 = 0;
    do {
      piVar27 = (int *)plVar10[2];
      piVar6 = (int *)plVar9[2];
      if (iVar29 == 0) {
        iVar29 = 1;
      }
      piVar32 = (int *)plVar11[2];
      iVar39 = local_f8;
      if (local_f8 == param_2) {
        iVar39 = param_2 + -1;
      }
      if (-1 < iStack0000000000000040 + -3) {
        lVar31 = 0;
        lVar30 = 0;
        lVar26 = lVar30;
        if ((0 < (int)param_4) && (3 < param_4)) {
          iVar41 = param_4 - 1;
          piVar18 = piVar14 + iVar41;
          piVar34 = piVar13 + iVar41;
          if (((((piVar34 < piVar14) || (piVar18 < piVar13)) &&
               ((piVar2 = piVar12 + iVar41, lVar26 = lVar31, piVar2 < piVar14 || (piVar18 < piVar12)
                ))) && (((((piVar3 = piVar32 + iVar41, piVar3 < piVar14 || (piVar18 < piVar32)) &&
                          ((((piVar4 = piVar27 + iVar41, piVar4 < piVar14 || (piVar18 < piVar27)) &&
                            ((piVar5 = piVar6 + iVar41, piVar5 < piVar14 ||
                             (lVar26 = lVar30, piVar18 < piVar6)))) &&
                           ((piVar2 < piVar13 || (lVar26 = lVar30, piVar34 < piVar12)))))) &&
                         ((piVar3 < piVar13 || (lVar26 = lVar30, piVar34 < piVar32)))) &&
                        ((((piVar4 < piVar13 || (lVar26 = lVar30, piVar34 < piVar27)) &&
                          ((piVar5 < piVar13 || (lVar26 = lVar30, piVar34 < piVar6)))) &&
                         (((piVar3 < piVar12 || (lVar26 = lVar30, piVar2 < piVar32)) &&
                          ((piVar4 < piVar12 || (lVar26 = lVar30, piVar2 < piVar27)))))))))) &&
             ((piVar5 < piVar12 || (lVar26 = lVar30, piVar2 < piVar6)))) {
            uVar8 = param_4 & 0x80000003;
            if ((int)uVar8 < 0) {
              uVar8 = (uVar8 - 1 | 0xfffffffc) + 1;
            }
            iVar41 = 0;
            do {
              iVar21 = iVar41 + 4;
              lVar31 = lVar31 + 4;
              piVar18 = piVar6 + iVar41;
              iVar24 = piVar18[1];
              iVar25 = piVar18[2];
              iVar40 = piVar18[3];
              piVar34 = piVar12 + iVar41;
              iVar35 = piVar34[1];
              iVar33 = piVar34[2];
              iVar36 = piVar34[3];
              piVar2 = piVar12 + iVar41;
              *piVar2 = *piVar34 - *piVar18;
              piVar2[1] = iVar35 - iVar24;
              piVar2[2] = iVar33 - iVar25;
              piVar2[3] = iVar36 - iVar40;
              piVar18 = piVar27 + iVar41;
              iVar24 = piVar18[1];
              iVar25 = piVar18[2];
              iVar40 = piVar18[3];
              piVar34 = piVar13 + iVar41;
              iVar35 = piVar34[1];
              iVar33 = piVar34[2];
              iVar36 = piVar34[3];
              piVar2 = piVar13 + iVar41;
              *piVar2 = *piVar34 - *piVar18;
              piVar2[1] = iVar35 - iVar24;
              piVar2[2] = iVar33 - iVar25;
              piVar2[3] = iVar36 - iVar40;
              piVar18 = piVar14 + iVar41;
              iVar24 = piVar18[1];
              iVar25 = piVar18[2];
              iVar40 = piVar18[3];
              piVar34 = piVar32 + iVar41;
              iVar35 = piVar34[1];
              iVar33 = piVar34[2];
              iVar36 = piVar34[3];
              piVar2 = piVar14 + iVar41;
              *piVar2 = *piVar18 - *piVar34;
              piVar2[1] = iVar24 - iVar35;
              piVar2[2] = iVar25 - iVar33;
              piVar2[3] = iVar40 - iVar36;
              lVar26 = lVar31;
              iVar41 = iVar21;
            } while (iVar21 < (int)(param_4 - uVar8));
          }
        }
        if (lVar26 < (longlong)uVar22) {
          lVar30 = uVar22 - lVar26;
          piVar18 = piVar12 + lVar26;
          do {
            piVar34 = piVar18 + 1;
            *piVar18 = *piVar18 -
                       *(int *)(((longlong)piVar6 - (longlong)piVar12) + (longlong)piVar18);
            piVar18 = (int *)((longlong)piVar13 + (-4 - (longlong)piVar12) + (longlong)piVar34);
            *piVar18 = *piVar18 -
                       *(int *)((longlong)piVar27 + (-4 - (longlong)piVar12) + (longlong)piVar34);
            piVar18 = (int *)((longlong)piVar14 + (-4 - (longlong)piVar12) + (longlong)piVar34);
            *piVar18 = *piVar18 -
                       *(int *)((longlong)piVar32 + (-4 - (longlong)piVar12) + (longlong)piVar34);
            lVar30 = lVar30 + -1;
            piVar18 = piVar34;
          } while (lVar30 != 0);
        }
      }
      lVar26 = 2;
      plVar19 = plVar10 + 1;
      do {
        lVar26 = lVar26 + -1;
        plVar1 = plVar19 + -1;
        *(undefined8 *)(lVar38 + 0x10 + (longlong)plVar1) =
             *(undefined8 *)((longlong)plVar19 + lVar38);
        plVar19[1] = *plVar19;
        *(undefined8 *)(lVar15 + 0x10 + (longlong)plVar1) =
             *(undefined8 *)((longlong)plVar19 + lVar15);
        plVar19 = plVar1;
      } while (0 < lVar26);
      *plVar9 = (longlong)piVar6;
      *plVar10 = (longlong)piVar27;
      *plVar11 = (longlong)piVar32;
      if (iStack0000000000000040 < param_5) {
        local_c8 = 0x10;
        if (0 < (longlong)uVar22) {
          lVar26 = (longlong)iVar29;
          piVar27 = piVar13;
          uVar28 = uVar22;
          iVar29 = 0;
          do {
            if (iVar29 == 0) {
              iVar29 = 1;
            }
            iVar25 = 0;
            iVar24 = 0;
            iVar40 = 0;
            iVar41 = local_c8;
            if (local_c8 == param_1) {
              iVar41 = param_1 + -1;
            }
            if (lVar26 < iVar39) {
              lVar30 = (longlong)iVar29;
              lVar31 = iVar39 - lVar26;
              plVar19 = (longlong *)(param_3 + 8 + lVar26 * 8);
              do {
                lVar7 = plVar19[-2];
                if (lVar30 < iVar41) {
                  lVar23 = *plVar19 - lVar7;
                  lVar37 = iVar41 - lVar30;
                  pbVar17 = (byte *)(lVar7 + 1 + lVar30);
                  do {
                    iVar29 = ((uint)pbVar17[lVar23] - (uint)pbVar17[-2]) +
                             ((uint)pbVar17[plVar19[-1] - lVar7] -
                             (uint)pbVar17[(plVar19[-1] - lVar7) + -2]) * 4 +
                             ((uint)*pbVar17 - (uint)pbVar17[lVar23 + -2]);
                    iVar35 = ((uint)pbVar17[lVar23] - (uint)pbVar17[-2]) +
                             (((uint)(pbVar17 + 1)[lVar23 + -2] - (uint)pbVar17[-1]) * 4 -
                             ((uint)*pbVar17 - (uint)pbVar17[lVar23 + -2]));
                    iVar25 = iVar25 + iVar29 * iVar29;
                    iVar40 = iVar40 + iVar35 * iVar29;
                    iVar24 = iVar24 + iVar35 * iVar35;
                    lVar37 = lVar37 + -1;
                    pbVar17 = pbVar17 + 1;
                  } while (lVar37 != 0);
                }
                plVar19 = plVar19 + 1;
                lVar31 = lVar31 + -1;
              } while (lVar31 != 0);
            }
            piVar32 = piVar27 + 1;
            *(int *)((longlong)piVar27 + (*plVar9 - (longlong)piVar13)) = iVar25;
            *(int *)((longlong)piVar27 + (*plVar10 - (longlong)piVar13)) = iVar24;
            *(int *)((longlong)piVar27 + (*plVar11 - (longlong)piVar13)) = iVar40;
            piVar6 = (int *)((longlong)piVar12 + (-4 - (longlong)piVar13) + (longlong)piVar32);
            *piVar6 = *piVar6 + iVar25;
            *piVar27 = *piVar27 + iVar24;
            piVar27 = (int *)((longlong)piVar14 + (-4 - (longlong)piVar13) + (longlong)piVar32);
            *piVar27 = *piVar27 + iVar40;
            uVar28 = uVar28 - 1;
            piVar27 = piVar32;
            iVar29 = local_c8;
            local_c8 = local_c8 + 0x10;
          } while (uVar28 != 0);
        }
      }
      if (-1 < local_d8) {
        iVar29 = 0;
        iVar41 = 0;
        iVar39 = 0;
        if (-1 < (longlong)uVar22) {
          piVar27 = piVar13 + -3;
          lVar26 = -1;
          do {
            if (-1 < lVar26 + -2) {
              iVar29 = iVar29 - *(int *)(((longlong)piVar12 - (longlong)piVar13) + (longlong)piVar27
                                        );
              iVar41 = iVar41 - *piVar27;
              iVar39 = iVar39 - *(int *)(((longlong)piVar14 - (longlong)piVar13) + (longlong)piVar27
                                        );
            }
            lVar30 = lVar26 + 1;
            if (lVar30 < (longlong)uVar22) {
              iVar29 = iVar29 + *(int *)(((longlong)piVar12 - (longlong)piVar13) + 0xc +
                                        (longlong)piVar27);
              iVar41 = iVar41 + piVar27[3];
              iVar39 = iVar39 + *(int *)(((longlong)piVar14 - (longlong)piVar13) + 0xc +
                                        (longlong)piVar27);
            }
            if (-1 < lVar26) {
              iVar25 = (iVar29 + 0x480) / 0x900;
              iVar40 = (iVar41 + 0x480) / 0x900;
              iVar24 = (iVar39 + 0x480) / 0x900;
              uVar8 = FUN_180010b40(iVar25 - iVar40,iVar24 * 2);
              *(char *)(lVar26 + *(longlong *)((param_6 - param_7) + (longlong)local_b8)) =
                   (char)uVar8;
              iVar40 = iVar40 / 0x24;
              iVar33 = iVar25 / 0x24 >> 2;
              iVar35 = iVar40 >> 2;
              iVar36 = iVar33 - iVar35;
              iVar35 = iVar35 + iVar33;
              iVar24 = (iVar24 / 0x24 >> 2) * 2;
              iVar35 = (iVar35 * iVar35) / 0xfe01;
              if ((iVar40 + iVar25 / 0x24 < 0x9c4) || (iVar35 == 0)) {
                iVar35 = 0;
LAB_180011427:
                uVar8 = (uint)(byte)(&DAT_180037990)[iVar35];
LAB_18001143a:
                if (uVar8 + 1 < 0x100) {
                  iVar24 = *(int *)(&DAT_180037b54 + (longlong)(int)uVar8 * 4);
                }
                else {
                  iVar24 = 0xfe01;
                }
                if (uVar8 < 0x100) {
                  iVar25 = *(int *)(&DAT_180037b50 + (longlong)(int)uVar8 * 4);
                }
                else {
                  iVar25 = 0xfe01;
                }
                uVar20 = (undefined1)uVar8;
                if (iVar24 - iVar35 < iVar35 - iVar25) {
                  uVar20 = (undefined1)(uVar8 + 1);
                }
              }
              else {
                iVar35 = (iVar36 * iVar36 + iVar24 * iVar24) / iVar35;
                lVar31 = (longlong)iVar35;
                if (iVar35 < 0xfe01) {
                  if (iVar35 < 0x100) goto LAB_180011427;
                  if (iVar35 < 0x400) {
                    uVar8 = (uint)(byte)(&DAT_180037f50)[lVar31 >> 4];
                  }
                  else if (iVar35 < 0x1000) {
                    uVar8 = (uint)(byte)(&DAT_180037910)[lVar31 >> 5];
                  }
                  else if (iVar35 < 0x4000) {
                    uVar8 = (uint)(byte)(&DAT_180037a50)[lVar31 >> 6];
                  }
                  else {
                    uVar8 = (uint)(byte)(&DAT_180037f10)[lVar31 >> 7];
                  }
                  goto LAB_18001143a;
                }
                uVar20 = 0xff;
              }
              *(undefined1 *)(lVar26 + *local_b8) = uVar20;
            }
            piVar27 = piVar27 + 1;
            lVar26 = lVar30;
          } while (lVar30 < (longlong)uVar22);
        }
      }
      local_b8 = local_b8 + 1;
      local_d8 = local_d8 + 1;
      iStack0000000000000040 = iStack0000000000000040 + 1;
      iVar29 = local_f8;
      local_f8 = local_f8 + 0x10;
    } while (local_d8 < param_5);
  }
  lVar26 = 3;
  plVar19 = plVar10;
  do {
    FUN_18001d45c(*(LPVOID *)((longlong)plVar19 + lVar38));
    FUN_18001d45c((LPVOID)*plVar19);
    FUN_18001d45c(*(LPVOID *)((longlong)plVar19 + lVar15));
    plVar19 = plVar19 + 1;
    lVar26 = lVar26 + -1;
  } while (lVar26 != 0);
  FUN_18001d45c(plVar9);
  FUN_18001d45c(plVar10);
  FUN_18001d45c(plVar11);
  FUN_18001d45c(piVar12);
  FUN_18001d45c(piVar13);
  FUN_18001d45c(piVar14);
  return;
}



int FUN_1800115b0(int param_1,int param_2,longlong param_3,longlong param_4)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  longlong lVar8;
  longlong lVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  int local_res8;
  
  iVar10 = 0;
  lVar12 = 0;
  local_res8 = 0;
  if (0 < (longlong)param_2) {
    iVar10 = 0;
    do {
      if (lVar12 < 1) {
        lVar11 = 0;
      }
      else {
        lVar11 = lVar12 + -1;
      }
      iVar1 = param_2 + -1;
      if (local_res8 <= param_2 + -2) {
        iVar1 = local_res8 + 1;
      }
      iVar5 = 0;
      lVar4 = 0;
      if (0 < (longlong)param_1) {
        do {
          if (lVar4 < 1) {
            lVar9 = 0;
          }
          else {
            lVar9 = lVar4 + -1;
          }
          iVar2 = param_1 + -1;
          if (iVar5 <= param_1 + -2) {
            iVar2 = iVar5 + 1;
          }
          iVar7 = 0;
          iVar6 = 0;
          for (lVar8 = lVar11; lVar8 <= iVar1; lVar8 = lVar8 + 1) {
            if (lVar9 <= iVar2) {
              iVar6 = iVar6 + 1 + (iVar2 - (int)lVar9);
              lVar3 = lVar9;
              do {
                if (0x50 < *(byte *)(*(longlong *)(param_4 + lVar8 * 8) + lVar3)) {
                  iVar7 = iVar7 + 1;
                }
                lVar3 = lVar3 + 1;
              } while (lVar3 <= iVar2);
            }
          }
          if (iVar7 <= iVar6 / 2) {
            iVar10 = iVar10 + 1;
            *(undefined1 *)(lVar4 + *(longlong *)(param_3 + lVar12 * 8)) = 0xff;
          }
          lVar4 = lVar4 + 1;
          iVar5 = iVar5 + 1;
        } while (lVar4 < param_1);
      }
      lVar12 = lVar12 + 1;
      local_res8 = local_res8 + 1;
    } while (lVar12 < param_2);
  }
  return iVar10;
}



ulonglong FUN_180011740(longlong *param_1,int param_2,int param_3,longlong param_4)

{
  longlong lVar1;
  byte *pbVar2;
  int iVar3;
  longlong *plVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  int iVar13;
  longlong local_38;
  
  iVar10 = 0;
  iVar13 = 0;
  local_38 = 0;
  lVar12 = (longlong)((int)(param_2 + (param_2 >> 0x1f & 0xfU)) >> 4);
  lVar1 = (longlong)((int)(param_3 + (param_3 >> 0x1f & 0xfU)) >> 4);
  if (0 < lVar1) {
    do {
      lVar5 = 0;
      if (0 < lVar12) {
        lVar6 = 0;
        do {
          if (*(char *)(*(longlong *)(param_4 + local_38 * 8) + lVar5) != -1) {
            lVar7 = 0x10;
            plVar4 = param_1;
            do {
              iVar3 = 0;
              iVar8 = 0;
              iVar9 = 0;
              lVar11 = 4;
              pbVar2 = (byte *)(*plVar4 + 1 + lVar6);
              do {
                iVar10 = iVar10 + (uint)pbVar2[-1];
                iVar9 = iVar9 + (uint)*pbVar2;
                iVar8 = iVar8 + (uint)pbVar2[1];
                iVar3 = iVar3 + (uint)pbVar2[2];
                lVar11 = lVar11 + -1;
                pbVar2 = pbVar2 + 4;
              } while (lVar11 != 0);
              plVar4 = plVar4 + 1;
              iVar10 = iVar10 + iVar3 + iVar8 + iVar9;
              lVar7 = lVar7 + -1;
            } while (lVar7 != 0);
            iVar13 = iVar13 + 1;
          }
          lVar5 = lVar5 + 1;
          lVar6 = lVar6 + 0x10;
        } while (lVar5 < lVar12);
      }
      local_38 = local_38 + 1;
      param_1 = param_1 + 0x10;
    } while (local_38 < lVar1);
  }
  return (longlong)iVar10 / (longlong)iVar13 & 0xffffffff;
}



void FUN_180011880(undefined8 *param_1,int param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  byte *pbVar3;
  longlong lVar4;
  longlong lVar5;
  uint uVar6;
  uint uVar7;
  
  uVar7 = 0;
  uVar6 = 0xff;
  lVar5 = (longlong)(param_2 * param_3);
  pbVar3 = (byte *)*param_1;
  lVar4 = lVar5;
  if (0 < param_2 * param_3) {
    do {
      uVar1 = (uint)*pbVar3;
      if (uVar7 < *pbVar3) {
        uVar7 = uVar1;
      }
      if (uVar1 < uVar6) {
        uVar6 = uVar1;
      }
      lVar4 = lVar4 + -1;
      pbVar3 = pbVar3 + 1;
    } while (lVar4 != 0);
    if (uVar7 == uVar6) {
      return;
    }
  }
  pbVar3 = (byte *)*param_1;
  if (0 < lVar5) {
    do {
      iVar2 = (*pbVar3 - uVar6) * (int)(0x3fc00 / (longlong)(int)(uVar7 - uVar6)) + 0x200;
      *pbVar3 = (byte)((int)(iVar2 + (iVar2 >> 0x1f & 0x3ffU)) >> 10);
      lVar5 = lVar5 + -1;
      pbVar3 = pbVar3 + 1;
    } while (lVar5 != 0);
  }
  return;
}



longlong * FUN_180011900(longlong param_1,int param_2,int param_3,uint param_4,uint param_5)

{
  longlong lVar1;
  int iVar2;
  undefined1 uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  longlong *plVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  uint uVar11;
  longlong lVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  int iVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  byte *pbVar18;
  longlong lVar19;
  longlong *plVar20;
  
  uVar17 = (ulonglong)param_5;
  plVar7 = (longlong *)FUN_1800076f0(param_4,param_5);
  iVar8 = (param_3 << 10) / (int)param_5;
  iVar2 = (param_2 << 10) / (int)param_4;
  if (plVar7 == (longlong *)0x0) {
    return (longlong *)0x0;
  }
  if (0 < (int)param_5) {
    iVar9 = iVar8 * -0x200;
    plVar20 = plVar7;
    do {
      uVar14 = (ulonglong)param_4;
      iVar4 = iVar9 + (iVar9 >> 0x1f & 0x3ffU);
      uVar11 = iVar4 >> 0x1f & 0x3ff;
      uVar5 = (iVar4 >> 10) + uVar11;
      iVar4 = (int)uVar5 >> 10;
      uVar16 = (ulonglong)((uVar5 & 0x3ff) - uVar11);
      if (iVar4 == param_3 + -1) {
        uVar16 = 0;
      }
      if (0 < (int)param_4) {
        lVar19 = (longlong)iVar4;
        iVar4 = iVar2 * -0x200;
        uVar13 = 0;
        do {
          iVar6 = iVar4 + (iVar4 >> 0x1f & 0x3ffU);
          uVar11 = iVar6 >> 0x1f & 0x3ff;
          uVar5 = (iVar6 >> 10) + uVar11;
          iVar10 = (int)uVar5 >> 10;
          iVar6 = (uVar5 & 0x3ff) - uVar11;
          if (iVar10 == param_2 + -1) {
            iVar6 = 0;
          }
          iVar15 = (int)uVar16;
          if (iVar15 < 1) {
            if (iVar6 < 1) {
              uVar3 = *(undefined1 *)((longlong)iVar10 + *(longlong *)(param_1 + lVar19 * 8));
            }
            else {
LAB_180011a95:
              lVar12 = (longlong)iVar10;
              if (iVar15 < 1) {
                lVar1 = *(longlong *)(param_1 + lVar19 * 8);
                iVar6 = ((uint)*(byte *)(lVar12 + lVar1) * (0x400 - iVar6) + 0x200 +
                        (uint)*(byte *)(lVar12 + 1 + lVar1) * iVar6) * 0x400;
                iVar6 = iVar6 + (iVar6 >> 0x1f & 0xfffffU);
              }
              else {
                lVar1 = *(longlong *)(param_1 + 8 + lVar19 * 8);
                pbVar18 = (byte *)(*(longlong *)(param_1 + lVar19 * 8) + lVar12);
                iVar6 = ((uint)*(byte *)(lVar1 + lVar12) * iVar15 +
                        (uint)*pbVar18 * (0x400 - iVar15)) * (0x400 - iVar6) + 0x80000 +
                        ((uint)*(byte *)(lVar1 + 1 + lVar12) * iVar15 +
                        (uint)pbVar18[1] * (0x400 - iVar15)) * iVar6;
                iVar6 = iVar6 + (iVar6 >> 0x1f & 0xfffffU);
              }
              uVar3 = (undefined1)(iVar6 >> 0x14);
            }
          }
          else {
            if (0 < iVar6) goto LAB_180011a95;
            iVar6 = ((uint)*(byte *)(*(longlong *)(param_1 + 8 + lVar19 * 8) + (longlong)iVar10) *
                     iVar15 + (uint)*(byte *)((longlong)iVar10 + *(longlong *)(param_1 + lVar19 * 8)
                                             ) * (0x400 - iVar15) + 0x200) * 0x400;
            uVar3 = (undefined1)((int)(iVar6 + (iVar6 >> 0x1f & 0xfffffU)) >> 0x14);
          }
          iVar4 = iVar4 + iVar2 * 0x400;
          *(undefined1 *)(uVar13 + *plVar20) = uVar3;
          uVar14 = uVar14 - 1;
          uVar13 = uVar13 + 1;
        } while (uVar14 != 0);
      }
      plVar20 = plVar20 + 1;
      iVar9 = iVar9 + iVar8 * 0x400;
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
  }
  return plVar7;
}



undefined8 FUN_180011bc0(undefined8 *param_1,int param_2,int param_3)

{
  undefined8 *puVar1;
  
  puVar1 = (undefined8 *)FUN_1800076f0(param_2,param_3);
  FUN_18001d560((undefined8 *)*puVar1,(undefined8 *)*param_1,(longlong)(param_2 * param_3));
  FUN_180007780(param_2,param_3,(longlong)puVar1,5);
  FUN_180007a30(param_2,param_3,(longlong)param_1,(longlong)puVar1);
  FUN_18001d560((undefined8 *)*param_1,(undefined8 *)*puVar1,(longlong)(param_2 * param_3));
  FUN_18001d45c(puVar1);
  return 0;
}



ulonglong FUN_180011c60(longlong param_1,uint param_2,int param_3)

{
  byte *pbVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  longlong lVar7;
  longlong lVar8;
  longlong lVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  undefined1 in_XMM1 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  
  iVar12 = 0;
  lVar8 = 0;
  lVar9 = (longlong)(int)param_2;
  if (0 < param_3) {
    do {
      lVar2 = *(longlong *)(param_1 + lVar8 * 8);
      iVar11 = 0;
      iVar10 = 0;
      lVar6 = 0;
      if (1 < lVar9) {
        do {
          pbVar1 = (byte *)(lVar2 + lVar6);
          lVar6 = lVar6 + 2;
          iVar11 = iVar11 + (uint)*pbVar1;
          iVar10 = iVar10 + (uint)*(byte *)(lVar2 + -1 + lVar6);
        } while (lVar6 < lVar9 + -1);
      }
      if (lVar6 < lVar9) {
        iVar12 = iVar12 + (uint)*(byte *)(lVar6 + lVar2);
      }
      lVar8 = lVar8 + 1;
      iVar12 = iVar12 + iVar10 + iVar11;
    } while (lVar8 < param_3);
  }
  iVar10 = 0;
  iVar12 = iVar12 / (int)(param_2 * param_3);
  if (0 < param_3) {
    auVar17 = ZEXT816(0);
    lVar8 = 0;
    auVar13 = auVar17;
    do {
      lVar2 = *(longlong *)(param_1 + lVar8 * 8);
      lVar6 = 0;
      if (((0 < (int)param_2) && (7 < param_2)) && (1 < DAT_180046320)) {
        iVar11 = 0;
        uVar3 = param_2 & 0x80000007;
        if ((int)uVar3 < 0) {
          uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
        }
        auVar15 = auVar13;
        do {
          lVar7 = (longlong)iVar11;
          lVar6 = lVar6 + 8;
          iVar4 = iVar11 + 4;
          iVar11 = iVar11 + 8;
          auVar13 = pmovzxbd(in_XMM1,ZEXT416(*(uint *)(lVar7 + lVar2)));
          auVar14._0_4_ = auVar13._0_4_ - iVar12;
          auVar14._4_4_ = auVar13._4_4_ - iVar12;
          auVar14._8_4_ = auVar13._8_4_ - iVar12;
          auVar14._12_4_ = auVar13._12_4_ - iVar12;
          auVar14 = pmulld(auVar14,auVar14);
          auVar13._0_4_ = auVar14._0_4_ + auVar15._0_4_;
          auVar13._4_4_ = auVar14._4_4_ + auVar15._4_4_;
          auVar13._8_4_ = auVar14._8_4_ + auVar15._8_4_;
          auVar13._12_4_ = auVar14._12_4_ + auVar15._12_4_;
          auVar15 = pmovzxbd(auVar13,ZEXT416(*(uint *)(iVar4 + lVar2)));
          auVar16._0_4_ = auVar15._0_4_ - iVar12;
          auVar16._4_4_ = auVar15._4_4_ - iVar12;
          auVar16._8_4_ = auVar15._8_4_ - iVar12;
          auVar16._12_4_ = auVar15._12_4_ - iVar12;
          auVar15 = pmulld(auVar16,auVar16);
          in_XMM1._0_4_ = auVar15._0_4_ + auVar17._0_4_;
          in_XMM1._4_4_ = auVar15._4_4_ + auVar17._4_4_;
          in_XMM1._8_4_ = auVar15._8_4_ + auVar17._8_4_;
          in_XMM1._12_4_ = auVar15._12_4_ + auVar17._12_4_;
          auVar17 = in_XMM1;
          auVar15 = auVar13;
        } while (iVar11 < (int)(param_2 - uVar3));
      }
      iVar11 = 0;
      iVar4 = 0;
      if (lVar6 < lVar9) {
        if (1 < lVar9 - lVar6) {
          do {
            pbVar1 = (byte *)(lVar2 + lVar6);
            lVar6 = lVar6 + 2;
            iVar5 = (uint)*pbVar1 - iVar12;
            iVar11 = iVar11 + iVar5 * iVar5;
            iVar5 = (uint)*(byte *)(lVar2 + -1 + lVar6) - iVar12;
            iVar4 = iVar4 + iVar5 * iVar5;
          } while (lVar6 < lVar9 + -1);
        }
        if (lVar6 < lVar9) {
          iVar5 = (uint)*(byte *)(lVar6 + lVar2) - iVar12;
          iVar10 = iVar10 + iVar5 * iVar5;
        }
        iVar10 = iVar10 + iVar4 + iVar11;
      }
      lVar8 = lVar8 + 1;
    } while (lVar8 < param_3);
    iVar10 = iVar10 + auVar17._0_4_ + auVar13._0_4_ + auVar17._8_4_ + auVar13._8_4_ +
                      auVar17._4_4_ + auVar13._4_4_ + auVar17._12_4_ + auVar13._12_4_;
  }
  return (longlong)iVar10 / (longlong)(int)(param_2 * param_3) & 0xffffffff;
}



int FUN_180011e50(longlong param_1,int param_2,int param_3,undefined1 *param_4,int param_5)

{
  byte *pbVar1;
  byte *pbVar2;
  longlong lVar3;
  longlong lVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  byte *pbVar8;
  longlong lVar9;
  longlong lVar10;
  longlong *plVar11;
  longlong lVar12;
  int iVar13;
  longlong lVar14;
  int iVar15;
  int iVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  int iVar20;
  uint uVar21;
  longlong lVar22;
  int iVar23;
  int iVar24;
  int local_res18;
  
  iVar16 = 0;
  lVar22 = (longlong)param_3;
  local_res18 = 0;
  iVar24 = 0;
  iVar23 = 0;
  iVar13 = 0;
  if (lVar22 < param_3 + 0xc) {
    lVar14 = (param_3 + 0xc) - lVar22;
    iVar24 = 0;
    plVar11 = (longlong *)(param_1 + lVar22 * 8);
    do {
      if ((longlong)param_2 < (longlong)(param_2 + 0xc)) {
        lVar22 = *plVar11;
        lVar9 = plVar11[-1];
        lVar10 = plVar11[1];
        lVar12 = (longlong)param_2;
        do {
          pbVar5 = (byte *)(lVar10 + -1 + lVar12);
          pbVar6 = (byte *)(lVar9 + -1 + lVar12);
          pbVar7 = (byte *)(lVar10 + 1 + lVar12);
          pbVar8 = (byte *)(lVar9 + 1 + lVar12);
          lVar3 = lVar12 + 1;
          pbVar1 = (byte *)(lVar10 + lVar12);
          iVar23 = iVar23 + (uint)*(byte *)(lVar12 + lVar22);
          lVar4 = lVar12 + -1;
          pbVar2 = (byte *)(lVar9 + lVar12);
          lVar12 = lVar12 + 1;
          uVar19 = (uint)*pbVar5;
          uVar17 = (uint)*pbVar6;
          uVar18 = (uint)*pbVar8;
          uVar21 = (uint)*pbVar7;
          iVar15 = ((((uint)*(byte *)(lVar3 + lVar22) - (uint)*(byte *)(lVar4 + lVar22)) * 4 -
                    uVar19) - uVar17) + uVar21 + uVar18;
          iVar13 = ((((uint)*pbVar1 - (uint)*pbVar2) * 4 - uVar17) - uVar18) + uVar19 + uVar21;
          iVar16 = iVar16 + iVar15 * iVar15;
          iVar24 = iVar24 + iVar13 * iVar13;
          local_res18 = local_res18 + iVar13 * iVar15;
        } while (lVar12 < param_2 + 0xc);
      }
      lVar14 = lVar14 + -1;
      iVar13 = local_res18;
      plVar11 = plVar11 + 1;
    } while (lVar14 != 0);
  }
  iVar15 = (iVar16 - iVar24 >> 0x1f & 0x7fU) + (iVar16 - iVar24);
  iVar13 = (iVar13 * 2 >> 0x1f & 0x7fU) + iVar13 * 2;
  iVar20 = ((int)((iVar24 >> 0x1f & 0x7fU) + iVar24) >> 7) +
           ((int)(iVar16 + (iVar16 >> 0x1f & 0x7fU)) >> 7);
  iVar13 = (int)((iVar13 >> 0x1f & 7U) + (iVar13 >> 7)) >> 3;
  iVar24 = (int)((iVar15 >> 0x1f & 7U) + (iVar15 >> 7)) >> 3;
  iVar15 = iVar24 * iVar24 + iVar13 * iVar13;
  iVar13 = (int)((iVar20 >> 0x1f & 7U) + iVar20) >> 3;
  iVar13 = (iVar13 * iVar13) / 0xfe01;
  iVar16 = param_5 * 0x42 + 0xa39;
  iVar24 = 0x1324;
  if ((0x1323 < iVar16) && (iVar24 = iVar16, 0x1b90 < iVar16)) {
    iVar24 = 0x1b90;
  }
  if ((iVar13 < 1) || (iVar20 <= iVar24)) {
    *param_4 = 0;
  }
  else if (iVar15 < iVar13 * 0x6400) {
    *param_4 = iVar13 * 0x1900 <= iVar15;
  }
  else {
    *param_4 = 2;
  }
  return iVar23 / 0x90;
}



void FUN_1800120b0(undefined8 *param_1,uint param_2,int param_3,longlong *param_4)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined8 *puVar4;
  ulonglong uVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  longlong lVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  undefined1 auStackY_b8 [32];
  byte local_88 [4];
  int local_84;
  int local_80;
  uint local_7c;
  int local_78;
  int local_74;
  int local_70 [4];
  int local_60 [4];
  ulonglong local_50;
  
  local_50 = DAT_1800461a0 ^ (ulonglong)auStackY_b8;
  iVar10 = 0;
  local_60[0] = 0;
  local_60[1] = 0;
  local_60[2] = 0;
  local_70[0] = 0;
  local_70[1] = 0;
  iVar2 = param_3 * param_2;
  local_70[2] = 0;
  local_84 = 0;
  local_80 = iVar2;
  local_7c = param_2;
  local_78 = param_3;
  local_74 = iVar2;
  puVar4 = (undefined8 *)FUN_1800076f0(param_2,param_3);
  uVar5 = FUN_180011c60((longlong)param_1,param_2,param_3);
  FUN_18001d560((undefined8 *)*puVar4,(undefined8 *)*param_1,(longlong)iVar2);
  FUN_18001dbc0((undefined1 (*) [16])*param_4,0,(longlong)iVar2);
  uVar1 = local_7c;
  iVar2 = 1;
  if (1 < param_3 + -0xc) {
    iVar8 = local_7c - 0xc;
    iVar10 = local_84;
    do {
      iVar7 = 1;
      if (1 < iVar8) {
        iVar10 = iVar10 + (uVar1 - 0xe) / 0xc + 1;
        do {
          iVar3 = FUN_180011e50((longlong)puVar4,iVar7,iVar2,local_88,(int)uVar5);
          iVar7 = iVar7 + 0xc;
          local_60[local_88[0]] = local_60[local_88[0]] + iVar3;
          local_70[local_88[0]] = local_70[local_88[0]] + 1;
        } while (iVar7 < iVar8);
      }
      iVar2 = iVar2 + 0xc;
    } while (iVar2 < param_3 + -0xc);
    local_84 = iVar10;
    if (0 < local_70[2]) {
      iVar10 = local_60[2] / local_70[2];
      goto LAB_1800121f9;
    }
    if (0 < local_70[1]) {
      iVar10 = local_60[1] / local_70[1];
      goto LAB_1800121f9;
    }
    iVar10 = local_60[0];
  }
  iVar10 = iVar10 / local_70[0];
LAB_1800121f9:
  iVar2 = local_78;
  uVar1 = local_7c;
  lVar12 = (longlong)local_78;
  lVar9 = (longlong)(int)local_7c;
  FUN_180007780(local_7c,local_78,(longlong)puVar4,0xc);
  if (0 < iVar2) {
    lVar11 = (longlong)puVar4 - (longlong)param_4;
    do {
      lVar6 = 0;
      if (0 < (int)uVar1) {
        do {
          if (((0xff - iVar10) / 2 - (0xff - iVar10)) + 0xff <=
              (int)(uint)*(byte *)(*(longlong *)(lVar11 + (longlong)param_4) + lVar6)) {
            *(undefined1 *)(lVar6 + *param_4) = 0xff;
          }
          lVar6 = lVar6 + 1;
        } while (lVar6 < lVar9);
      }
      param_4 = param_4 + 1;
      lVar12 = lVar12 + -1;
    } while (lVar12 != 0);
  }
  FUN_18001d45c(puVar4);
  FUN_18001d530(local_50 ^ (ulonglong)auStackY_b8);
  return;
}



ulonglong FUN_1800122c0(longlong *param_1,uint param_2,uint param_3,longlong *param_4)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte bVar7;
  int iVar8;
  int iVar9;
  LPVOID pvVar10;
  int *piVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  byte *pbVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  longlong lVar18;
  int iVar19;
  int iVar20;
  longlong lVar21;
  byte *pbVar22;
  ulonglong uVar23;
  longlong lVar24;
  int iVar25;
  int iVar26;
  int *piVar27;
  longlong lVar28;
  longlong *plVar29;
  int iStack0000000000000028;
  int iStack0000000000000038;
  
  iVar12 = param_2 * param_3;
  iVar19 = 0;
  iStack0000000000000038 = 0;
  iStack0000000000000028 = iVar12;
  if (param_4 != (longlong *)0x0) {
    FUN_18001dbc0((undefined1 (*) [16])*param_4,0,(longlong)iVar12);
  }
  uVar16 = (ulonglong)
           (((int)param_2 / 6) *
           ((int)param_3 / 6 + ((int)param_3 >> 0x1f) +
           (int)(((longlong)(int)param_3 / 6 + ((longlong)(int)param_3 >> 0x3f) & 0xffffffffU) >>
                0x1f)));
  pvVar10 = FUN_18001ee18(uVar16,4);
  piVar11 = (int *)FUN_18001ed60(uVar16 * 4);
  iVar1 = param_3 - 6;
  iVar25 = 0;
  if (0 < iVar1) {
    lVar21 = 0;
    lVar28 = ((longlong)iVar1 - 1U) / 6 + 1;
    plVar29 = param_1;
    do {
      lVar18 = 0;
      if (0 < (int)(param_2 - 6)) {
        piVar27 = (int *)(lVar21 * 4 + (longlong)pvVar10);
        uVar17 = (ulonglong)((param_2 - 7) / 6 + 1);
        lVar21 = lVar21 + uVar17;
        do {
          iVar25 = 0;
          lVar24 = 6;
          pbVar22 = (byte *)(*plVar29 + lVar18);
          pbVar15 = pbVar22;
          do {
            pbVar2 = pbVar15 + 4;
            pbVar3 = pbVar15 + 5;
            pbVar4 = pbVar15 + 3;
            pbVar5 = pbVar15 + 2;
            pbVar6 = pbVar15 + 1;
            bVar7 = *pbVar15;
            pbVar15 = pbVar15 + (int)param_2;
            iVar25 = iVar25 + (uint)bVar7 +
                     (uint)*pbVar3 + (uint)*pbVar2 + (uint)*pbVar4 + (uint)*pbVar5 + (uint)*pbVar6;
            lVar24 = lVar24 + -1;
          } while (lVar24 != 0);
          if (piVar27 != (int *)0x0) {
            iVar13 = 0;
            lVar24 = 6;
            iVar8 = iVar25 / 0x24;
            do {
              bVar7 = *pbVar22;
              pbVar15 = pbVar22 + 1;
              pbVar2 = pbVar22 + 2;
              pbVar3 = pbVar22 + 3;
              pbVar4 = pbVar22 + 4;
              pbVar5 = pbVar22 + 5;
              pbVar22 = pbVar22 + (int)param_2;
              iVar13 = iVar13 + ((uint)bVar7 - iVar8) * ((uint)bVar7 - iVar8) +
                       ((uint)*pbVar15 - iVar8) * ((uint)*pbVar15 - iVar8) +
                       ((uint)*pbVar2 - iVar8) * ((uint)*pbVar2 - iVar8) +
                       ((uint)*pbVar3 - iVar8) * ((uint)*pbVar3 - iVar8) +
                       ((uint)*pbVar4 - iVar8) * ((uint)*pbVar4 - iVar8) +
                       ((uint)*pbVar5 - iVar8) * ((uint)*pbVar5 - iVar8);
              lVar24 = lVar24 + -1;
            } while (lVar24 != 0);
            *piVar27 = iVar13 / 0x24;
          }
          *(int *)(((longlong)piVar11 - (longlong)pvVar10) + (longlong)piVar27) = iVar25;
          if (iVar19 < *piVar27) {
            iVar19 = *piVar27;
          }
          piVar27 = piVar27 + 1;
          lVar18 = lVar18 + 6;
          uVar17 = uVar17 - 1;
        } while (uVar17 != 0);
      }
      plVar29 = plVar29 + 6;
      lVar28 = lVar28 + -1;
      iVar25 = iStack0000000000000038;
    } while (lVar28 != 0);
  }
  uVar23 = (ulonglong)(int)param_2;
  uVar17 = uVar23;
  if (0 < (int)param_3) {
    uVar17 = (ulonglong)param_3;
    do {
      lVar21 = 0;
      if (1 < (longlong)uVar23) {
        do {
          lVar21 = lVar21 + 2;
        } while (lVar21 < (longlong)(uVar23 - 1));
      }
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
    uVar17 = (ulonglong)param_2;
  }
  iVar8 = (int)(iVar19 * 0xf + (iVar19 * 0xf >> 0x1f & 0x7fU)) >> 7;
  iVar19 = 0x14;
  if (0x14 < iVar8) {
    iVar19 = iVar8;
  }
  iVar8 = iVar25;
  if (0 < (longlong)uVar16) {
    piVar27 = piVar11;
    do {
      if (iVar19 < *(int *)(((longlong)pvVar10 - (longlong)piVar11) + (longlong)piVar27)) {
        iVar8 = iVar8 + *piVar27;
        iVar25 = iVar25 + 1;
      }
      piVar27 = piVar27 + 1;
      uVar16 = uVar16 - 1;
    } while (uVar16 != 0);
    if (0 < iVar25) {
      iVar25 = (iVar8 / iVar25) * 9;
      iVar8 = (int)((iVar25 >> 0x1f & 7U) + iVar25) >> 3;
    }
  }
  iVar25 = iVar8 * 0x80 + 0x40;
  if (0 < (int)param_3) {
    lVar28 = -2;
    iVar8 = -2;
    lVar21 = (longlong)(int)param_3;
    plVar29 = param_4;
    do {
      lVar18 = 0;
      if (0 < (longlong)uVar23) {
        iVar13 = (int)uVar17 + -6;
        iVar20 = -2;
        do {
          iVar9 = iVar20;
          if (iVar20 < 0) {
            iVar9 = 0;
          }
          lVar24 = lVar28;
          iVar26 = iVar8;
          if (lVar28 < 0) {
            lVar24 = 0;
            iVar26 = 0;
          }
          if (iVar13 < iVar9) {
            iVar9 = iVar13;
          }
          if (iVar1 < iVar26) {
            lVar24 = (longlong)(int)param_3 + -6;
          }
          iVar26 = 0;
          pbVar22 = (byte *)((longlong)iVar9 + param_1[lVar24]);
          lVar24 = 6;
          pbVar15 = pbVar22;
          do {
            pbVar2 = pbVar15 + 4;
            pbVar3 = pbVar15 + 5;
            pbVar4 = pbVar15 + 3;
            pbVar5 = pbVar15 + 2;
            pbVar6 = pbVar15 + 1;
            bVar7 = *pbVar15;
            pbVar15 = pbVar15 + uVar23;
            iVar26 = iVar26 + (uint)bVar7 +
                     (uint)*pbVar3 + (uint)*pbVar2 + (uint)*pbVar4 + (uint)*pbVar5 + (uint)*pbVar6;
            lVar24 = lVar24 + -1;
          } while (lVar24 != 0);
          iVar14 = 0;
          lVar24 = 6;
          iVar9 = iVar26 / 0x24;
          do {
            bVar7 = *pbVar22;
            pbVar15 = pbVar22 + 1;
            pbVar2 = pbVar22 + 2;
            pbVar3 = pbVar22 + 3;
            pbVar4 = pbVar22 + 4;
            pbVar5 = pbVar22 + 5;
            pbVar22 = pbVar22 + uVar23;
            iVar14 = iVar14 + ((uint)bVar7 - iVar9) * ((uint)bVar7 - iVar9) +
                     ((uint)*pbVar15 - iVar9) * ((uint)*pbVar15 - iVar9) +
                     ((uint)*pbVar2 - iVar9) * ((uint)*pbVar2 - iVar9) +
                     ((uint)*pbVar3 - iVar9) * ((uint)*pbVar3 - iVar9) +
                     ((uint)*pbVar4 - iVar9) * ((uint)*pbVar4 - iVar9) +
                     ((uint)*pbVar5 - iVar9) * ((uint)*pbVar5 - iVar9);
            lVar24 = lVar24 + -1;
          } while (lVar24 != 0);
          if (((iVar14 / 0x24 < 0xf) ||
              ((int)(iVar25 + (iVar25 >> 0x1f & 0x7fU)) >> 7 <= iVar26 && iVar14 / 0x24 <= iVar19))
             && (iStack0000000000000028 = iStack0000000000000028 + -1, param_4 != (longlong *)0x0))
          {
            *(undefined1 *)(lVar18 + *plVar29) = 0xff;
          }
          lVar18 = lVar18 + 1;
          iVar20 = iVar20 + 1;
        } while (lVar18 < (longlong)uVar23);
      }
      uVar17 = (ulonglong)param_2;
      iVar8 = iVar8 + 1;
      lVar28 = lVar28 + 1;
      plVar29 = plVar29 + 1;
      lVar21 = lVar21 + -1;
    } while (lVar21 != 0);
  }
  FUN_18001d45c(pvVar10);
  FUN_18001d45c(piVar11);
  return (longlong)(iStack0000000000000028 << 7) / (longlong)iVar12 & 0xffffffff;
}



void FUN_180012820(longlong *param_1,int param_2,uint param_3)

{
  int iVar1;
  undefined8 *puVar2;
  longlong lVar3;
  ulonglong uVar4;
  longlong lVar5;
  
  puVar2 = (undefined8 *)FUN_1800076f0(param_2,param_3);
  FUN_18001d560((undefined8 *)*puVar2,(undefined8 *)*param_1,(longlong)(int)(param_2 * param_3));
  FUN_180007780(param_2,param_3,(longlong)puVar2,3);
  if (0 < (int)param_3) {
    uVar4 = (ulonglong)param_3;
    lVar5 = (longlong)puVar2 - (longlong)param_1;
    do {
      lVar3 = 0;
      if (0 < (longlong)param_2) {
        do {
          iVar1 = ((uint)*(byte *)(*param_1 + lVar3) -
                  (uint)*(byte *)(lVar3 + *(longlong *)(lVar5 + (longlong)param_1))) + 0x80;
          if (iVar1 < 0) {
            iVar1 = 0;
          }
          else if (0xff < iVar1) {
            iVar1 = 0xff;
          }
          *(char *)(*param_1 + lVar3) = (char)iVar1;
          lVar3 = lVar3 + 1;
        } while (lVar3 < param_2);
      }
      param_1 = param_1 + 1;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  FUN_18001d45c(puVar2);
  return;
}



void FUN_1800128f0(longlong *param_1,int param_2,int param_3)

{
  longlong lVar1;
  char *pcVar2;
  longlong lVar3;
  longlong *plVar4;
  int iVar5;
  char *pcVar6;
  ulonglong uVar7;
  longlong lVar8;
  longlong lVar9;
  longlong lVar10;
  
  pcVar6 = (char *)*param_1;
  lVar9 = 1;
  iVar5 = param_3 + -1;
  lVar10 = (longlong)param_2;
  if (1 < iVar5) {
    lVar8 = 1;
    uVar7 = (ulonglong)(param_3 - 2);
    do {
      lVar3 = 1;
      if (1 < (longlong)(param_2 + -1)) {
        do {
          if (*(char *)(lVar3 + param_1[lVar8]) == -1) {
            if (*(char *)(param_1[lVar8 + -1] + -1 + lVar3) != -1) {
              *(undefined1 *)(param_1[lVar8 + -1] + -1 + lVar3) = 0x80;
            }
            if (*(char *)(param_1[lVar8 + -1] + lVar3) != -1) {
              *(undefined1 *)(param_1[lVar8 + -1] + lVar3) = 0x80;
            }
            if (*(char *)(param_1[lVar8 + -1] + 1 + lVar3) != -1) {
              *(undefined1 *)(param_1[lVar8 + -1] + 1 + lVar3) = 0x80;
            }
            if (*(char *)(lVar3 + 1 + param_1[lVar8]) != -1) {
              *(undefined1 *)(lVar3 + 1 + param_1[lVar8]) = 0x80;
            }
            if (*(char *)(param_1[lVar8 + 1] + 1 + lVar3) != -1) {
              *(undefined1 *)(param_1[lVar8 + 1] + 1 + lVar3) = 0x80;
            }
            if (*(char *)(param_1[lVar8 + 1] + lVar3) != -1) {
              *(undefined1 *)(param_1[lVar8 + 1] + lVar3) = 0x80;
            }
            if (*(char *)(param_1[lVar8 + 1] + -1 + lVar3) != -1) {
              *(undefined1 *)(param_1[lVar8 + 1] + -1 + lVar3) = 0x80;
            }
            if (*(char *)(lVar3 + -1 + param_1[lVar8]) != -1) {
              *(undefined1 *)(lVar3 + -1 + param_1[lVar8]) = 0x80;
            }
          }
          lVar3 = lVar3 + 1;
        } while (lVar3 < param_2 + -1);
      }
      lVar8 = lVar8 + 1;
      uVar7 = uVar7 - 1;
    } while (uVar7 != 0);
  }
  lVar8 = 1;
  lVar3 = (longlong)(param_2 + -1);
  if (1 < lVar3) {
    do {
      lVar1 = *param_1;
      if (*(char *)(lVar8 + lVar1) == -1) {
        if (*(char *)(lVar8 + 1 + lVar1) != -1) {
          *(undefined1 *)(lVar8 + 1 + lVar1) = 0x80;
        }
        if (*(char *)(lVar8 + 1 + param_1[1]) != -1) {
          *(undefined1 *)(lVar8 + 1 + param_1[1]) = 0x80;
        }
        if (*(char *)(lVar8 + param_1[1]) != -1) {
          *(undefined1 *)(lVar8 + param_1[1]) = 0x80;
        }
        if (*(char *)(lVar8 + -1 + param_1[1]) != -1) {
          *(undefined1 *)(lVar8 + -1 + param_1[1]) = 0x80;
        }
        if (*(char *)(lVar8 + -1 + *param_1) != -1) {
          *(undefined1 *)(lVar8 + -1 + *param_1) = 0x80;
        }
      }
      lVar8 = lVar8 + 1;
    } while (lVar8 < lVar3);
    if (1 < lVar3) {
      do {
        if (*(char *)(lVar9 + param_1[(longlong)param_3 + -1]) == -1) {
          if (*(char *)(lVar9 + -1 + param_1[(longlong)param_3 + -2]) != -1) {
            *(undefined1 *)(lVar9 + -1 + param_1[(longlong)param_3 + -2]) = 0x80;
          }
          if (*(char *)(lVar9 + param_1[(longlong)param_3 + -2]) != -1) {
            *(undefined1 *)(lVar9 + param_1[(longlong)param_3 + -2]) = 0x80;
          }
          if (*(char *)(lVar9 + 1 + param_1[(longlong)param_3 + -2]) != -1) {
            *(undefined1 *)(lVar9 + 1 + param_1[(longlong)param_3 + -2]) = 0x80;
          }
          if (*(char *)(lVar9 + 1 + param_1[(longlong)param_3 + -1]) != -1) {
            *(undefined1 *)(lVar9 + 1 + param_1[(longlong)param_3 + -1]) = 0x80;
          }
          if (*(char *)(lVar9 + -1 + param_1[(longlong)param_3 + -1]) != -1) {
            *(undefined1 *)(lVar9 + -1 + param_1[(longlong)param_3 + -1]) = 0x80;
          }
        }
        lVar9 = lVar9 + 1;
      } while (lVar9 < lVar3);
    }
  }
  if (1 < iVar5) {
    plVar4 = param_1 + 2;
    uVar7 = (ulonglong)(param_3 - 2);
    do {
      if (*(char *)plVar4[-1] == -1) {
        if (*(char *)plVar4[-2] != -1) {
          *(char *)plVar4[-2] = -0x80;
        }
        if (*(char *)(plVar4[-2] + 1) != -1) {
          *(undefined1 *)(plVar4[-2] + 1) = 0x80;
        }
        if (*(char *)(plVar4[-1] + 1) != -1) {
          *(undefined1 *)(plVar4[-1] + 1) = 0x80;
        }
        if (*(char *)(*plVar4 + 1) != -1) {
          *(undefined1 *)(*plVar4 + 1) = 0x80;
        }
        if (*(char *)*plVar4 != -1) {
          *(char *)*plVar4 = -0x80;
        }
      }
      plVar4 = plVar4 + 1;
      uVar7 = uVar7 - 1;
    } while (uVar7 != 0);
    if (1 < iVar5) {
      plVar4 = param_1 + 2;
      uVar7 = (ulonglong)(param_3 - 2);
      do {
        if (*(char *)(plVar4[-1] + -1 + lVar10) == -1) {
          if (*(char *)(plVar4[-2] + -2 + lVar10) != -1) {
            *(undefined1 *)(plVar4[-2] + -2 + lVar10) = 0x80;
          }
          if (*(char *)(plVar4[-2] + -1 + lVar10) != -1) {
            *(undefined1 *)(plVar4[-2] + -1 + lVar10) = 0x80;
          }
          if (*(char *)(lVar10 + -1 + *plVar4) != -1) {
            *(undefined1 *)(lVar10 + -1 + *plVar4) = 0x80;
          }
          if (*(char *)(lVar10 + -2 + *plVar4) != -1) {
            *(undefined1 *)(lVar10 + -2 + *plVar4) = 0x80;
          }
          if (*(char *)(plVar4[-1] + -2 + lVar10) != -1) {
            *(undefined1 *)(plVar4[-1] + -2 + lVar10) = 0x80;
          }
        }
        plVar4 = plVar4 + 1;
        uVar7 = uVar7 - 1;
      } while (uVar7 != 0);
    }
  }
  pcVar2 = (char *)*param_1;
  if (*pcVar2 == -1) {
    if (pcVar2[1] != -1) {
      pcVar2[1] = -0x80;
    }
    if (*(char *)(param_1[1] + 1) != -1) {
      *(undefined1 *)(param_1[1] + 1) = 0x80;
    }
    if (*(char *)param_1[1] != -1) {
      *(char *)param_1[1] = -0x80;
    }
  }
  if (*(char *)(lVar10 + -1 + *param_1) == -1) {
    if (*(char *)(lVar10 + -1 + param_1[1]) != -1) {
      *(undefined1 *)(lVar10 + -1 + param_1[1]) = 0x80;
    }
    if (*(char *)(lVar10 + -2 + param_1[1]) != -1) {
      *(undefined1 *)(lVar10 + -2 + param_1[1]) = 0x80;
    }
    if (*(char *)(lVar10 + -2 + *param_1) != -1) {
      *(undefined1 *)(lVar10 + -2 + *param_1) = 0x80;
    }
  }
  if (*(char *)(lVar10 + -1 + param_1[(longlong)param_3 + -1]) == -1) {
    if (*(char *)(lVar10 + -2 + param_1[(longlong)param_3 + -2]) != -1) {
      *(undefined1 *)(lVar10 + -2 + param_1[(longlong)param_3 + -2]) = 0x80;
    }
    if (*(char *)(lVar10 + -1 + param_1[(longlong)param_3 + -2]) != -1) {
      *(undefined1 *)(lVar10 + -1 + param_1[(longlong)param_3 + -2]) = 0x80;
    }
    if (*(char *)(lVar10 + -2 + param_1[(longlong)param_3 + -1]) != -1) {
      *(undefined1 *)(lVar10 + -2 + param_1[(longlong)param_3 + -1]) = 0x80;
    }
  }
  if (*(char *)param_1[(longlong)param_3 + -1] == -1) {
    if (*(char *)param_1[(longlong)param_3 + -2] != -1) {
      *(char *)param_1[(longlong)param_3 + -2] = -0x80;
    }
    if (*(char *)(param_1[(longlong)param_3 + -2] + 1) != -1) {
      *(undefined1 *)(param_1[(longlong)param_3 + -2] + 1) = 0x80;
    }
    if (*(char *)(param_1[(longlong)param_3 + -1] + 1) != -1) {
      *(undefined1 *)(param_1[(longlong)param_3 + -1] + 1) = 0x80;
    }
  }
  lVar9 = (longlong)(param_2 * param_3);
  if (0 < lVar9) {
    do {
      if (*pcVar6 == -0x80) {
        *pcVar6 = -1;
      }
      pcVar6 = pcVar6 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
  }
  return;
}



void FUN_180012ce0(int param_1,int param_2,longlong param_3,int param_4)

{
  longlong lVar1;
  longlong lVar2;
  int iVar3;
  longlong lVar4;
  LPVOID pvVar5;
  int *piVar6;
  LPVOID pvVar7;
  int *piVar8;
  longlong lVar9;
  byte *pbVar10;
  ulonglong uVar11;
  longlong lVar12;
  undefined8 *puVar13;
  int iVar14;
  ulonglong uVar15;
  int iVar16;
  int iVar17;
  
  lVar4 = (longlong)param_2;
  uVar11 = (ulonglong)param_1;
  iVar3 = param_2;
  if (5 < param_2) {
    iVar3 = 5;
  }
  iVar17 = 0;
  pvVar5 = FUN_18001ed60(lVar4 * 8);
  piVar6 = (int *)FUN_18001ee18(uVar11,4);
  lVar12 = 0;
  if (0 < (longlong)iVar3) {
    do {
      pvVar7 = FUN_18001ed60(uVar11);
      lVar12 = lVar12 + 1;
      *(LPVOID *)((longlong)pvVar5 + lVar12 * 8 + -8) = pvVar7;
    } while (lVar12 < iVar3);
  }
  if (-2 < lVar4) {
    puVar13 = (undefined8 *)((longlong)pvVar5 + -0x28);
    lVar12 = -2;
    do {
      if (-1 < lVar12 + -3) {
        pbVar10 = (byte *)*puVar13;
        piVar8 = piVar6;
        uVar15 = uVar11;
        if (0 < (longlong)uVar11) {
          do {
            if ((int)(uint)*pbVar10 < param_4) {
              *piVar8 = *piVar8 + ((uint)*pbVar10 - param_4);
            }
            pbVar10 = pbVar10 + 1;
            uVar15 = uVar15 - 1;
            piVar8 = piVar8 + 1;
          } while (uVar15 != 0);
        }
        iVar17 = iVar17 + -1;
      }
      if (lVar12 + 2 < lVar4) {
        if (-1 < lVar12 + -3) {
          puVar13[5] = *puVar13;
        }
        FUN_18001d560((undefined8 *)puVar13[5],
                      *(undefined8 **)((param_3 - (longlong)pvVar5) + 0x28 + (longlong)puVar13),
                      uVar11);
        pbVar10 = (byte *)puVar13[5];
        piVar8 = piVar6;
        uVar15 = uVar11;
        if (0 < (longlong)uVar11) {
          do {
            if ((int)(uint)*pbVar10 < param_4) {
              *piVar8 = *piVar8 + (param_4 - (uint)*pbVar10);
            }
            pbVar10 = pbVar10 + 1;
            uVar15 = uVar15 - 1;
            piVar8 = piVar8 + 1;
          } while (uVar15 != 0);
        }
        iVar17 = iVar17 + 1;
      }
      if (-1 < lVar12) {
        lVar2 = *(longlong *)((param_3 - (longlong)pvVar5) + 0x18 + (longlong)puVar13);
        iVar14 = 0;
        iVar16 = 0;
        if (-2 < (longlong)uVar11) {
          lVar9 = 0;
          piVar8 = piVar6;
          do {
            if (-1 < lVar9 + -5) {
              iVar14 = iVar14 - piVar8[-5];
              iVar16 = iVar16 - iVar17;
            }
            if (lVar9 < (longlong)uVar11) {
              iVar14 = iVar14 + *piVar8;
              iVar16 = iVar16 + iVar17;
            }
            if (-1 < lVar9 + -2) {
              *(char *)(lVar2 + -2 + lVar9) = (char)(iVar14 / iVar16);
            }
            piVar8 = piVar8 + 1;
            lVar1 = lVar9 + -1;
            lVar9 = lVar9 + 1;
          } while (lVar1 < (longlong)uVar11);
        }
      }
      lVar12 = lVar12 + 1;
      puVar13 = puVar13 + 1;
    } while (lVar12 < lVar4);
  }
  for (lVar12 = (longlong)(param_2 - iVar3); lVar12 < lVar4; lVar12 = lVar12 + 1) {
    FUN_18001d45c(*(LPVOID *)((longlong)pvVar5 + lVar12 * 8));
  }
  FUN_18001d45c(pvVar5);
  FUN_18001d45c(piVar6);
  return;
}



void FUN_180012ef0(longlong *param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte bVar2;
  longlong lVar3;
  undefined8 *puVar4;
  int iVar5;
  longlong lVar6;
  undefined1 uVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  int iVar11;
  longlong lVar12;
  longlong lVar13;
  longlong lVar14;
  undefined1 auStack_488 [48];
  int local_458;
  undefined8 *local_450;
  int local_448 [256];
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStack_488;
  lVar13 = (longlong)param_2;
  lVar14 = (longlong)param_3;
  uVar9 = 0;
  local_458 = param_3 * param_2;
  iVar11 = (local_458 >> 0x1f & 7U) + local_458;
  local_450 = (undefined8 *)FUN_1800076f0(param_2,param_3);
  FUN_18001dbc0((undefined1 (*) [16])local_448,0,0x400);
  puVar4 = local_450;
  lVar12 = 0;
  if (0 < param_3) {
    do {
      lVar6 = 0;
      if (0 < param_2) {
        lVar3 = param_1[lVar12];
        do {
          pbVar1 = (byte *)(lVar3 + lVar6);
          lVar6 = lVar6 + 1;
          local_448[*pbVar1] = local_448[*pbVar1] + 1;
        } while (lVar6 < lVar13);
      }
      lVar12 = lVar12 + 1;
    } while (lVar12 < lVar14);
  }
  iVar5 = 0;
  iVar8 = 0xff;
  lVar12 = 0xff;
  do {
    iVar5 = iVar5 + local_448[lVar12];
    iVar10 = iVar8;
    if (iVar11 >> 3 < iVar5) break;
    iVar8 = iVar8 + -1;
    lVar12 = lVar12 + -1;
    iVar10 = 0xff;
  } while (-1 < lVar12);
  FUN_18001d560((undefined8 *)*local_450,(undefined8 *)*param_1,(longlong)local_458);
  FUN_180012ce0(param_2,param_3,(longlong)puVar4,iVar10);
  lVar12 = 0;
  if (0 < param_3) {
    do {
      lVar6 = 0;
      if (0 < param_2) {
        do {
          if (uVar9 < *(byte *)(puVar4[lVar12] + lVar6)) {
            uVar9 = (uint)*(byte *)(puVar4[lVar12] + lVar6);
          }
          lVar6 = lVar6 + 1;
        } while (lVar6 < lVar13);
      }
      lVar12 = lVar12 + 1;
    } while (lVar12 < lVar14);
    if (0 < param_3) {
      lVar12 = (longlong)puVar4 - (longlong)param_1;
      do {
        lVar6 = 0;
        if (0 < param_2) {
          do {
            bVar2 = *(byte *)(lVar6 + *(longlong *)(lVar12 + (longlong)param_1));
            if (bVar2 == 0) {
              *(char *)(lVar6 + *param_1) = (char)iVar10;
            }
            else {
              lVar3 = *param_1;
              if ((int)(uint)*(byte *)(lVar3 + lVar6) < iVar10) {
                iVar11 = iVar10 - (int)((iVar10 - (uint)*(byte *)(lVar3 + lVar6)) * uVar9) /
                                  (int)(uint)bVar2;
                uVar7 = 0;
                if (0 < iVar11) {
                  uVar7 = (char)iVar11;
                }
                *(undefined1 *)(lVar3 + lVar6) = uVar7;
              }
              else {
                *(char *)(lVar3 + lVar6) = (char)iVar10;
              }
            }
            lVar6 = lVar6 + 1;
          } while (lVar6 < lVar13);
        }
        param_1 = param_1 + 1;
        lVar14 = lVar14 + -1;
      } while (lVar14 != 0);
    }
  }
  FUN_18001d45c(puVar4);
  FUN_18001d530(local_48 ^ (ulonglong)auStack_488);
  return;
}



int FUN_1800130c0(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  
  puVar1 = DAT_180049f30;
  iVar2 = 0;
  iVar3 = 0;
  *DAT_180049f30 = 0x10;
  *(undefined8 *)(puVar1 + 1) = 1000;
  puVar1[3] = 3;
  puVar1[4] = 9;
  puVar1[5] = 0x700;
  puVar1[6] = 1;
  puVar1[7] = 2;
  *(undefined8 *)(puVar1 + 8) = 2;
  *(undefined8 *)(puVar1 + 10) = 1;
  *(undefined8 *)(puVar1 + 0xc) = 0;
  puVar1[0xe] = 0;
  puVar1[0xf] = 0x288;
  puVar1[0x11] = 0x400;
  puVar1[0x12] = 0x73;
  puVar1[0x13] = 7;
  puVar1[0x14] = 8;
  puVar1[0x16] = 5;
  puVar1[0x17] = 0xffffffff;
  *(undefined8 *)(puVar1 + 0x18) = 0x18;
  *(undefined8 *)(puVar1 + 0x24) = 0;
  puVar1[0x1b] = 10;
  puVar1[0x1c] = 0x14;
  puVar1[0x1d] = 5;
  puVar1[0x1e] = 0xf0;
  puVar1[0x1f] = 1;
  puVar1[0x20] = 0x14;
  *(undefined8 *)(puVar1 + 0x22) = 170000;
  puVar1[0x1a] = 100;
  puVar1[0x26] = 2;
  switch(param_1) {
  case 5:
    puVar1[0x10] = 700;
    puVar1[0x15] = 0x294;
    puVar1[0x1a] = 0x55;
    puVar1[0x21] = 0x2df;
    break;
  default:
    iVar3 = -0x3ea;
    break;
  case 7:
  case 0x87:
    puVar1[1] = 0x4b0;
    puVar1[0x10] = 0x2d0;
    puVar1[0x15] = 0x26c;
    puVar1[0x17] = 8;
    puVar1[0x18] = 0x1c;
    puVar1[0x21] = 0x366;
    break;
  case 8:
  case 0x88:
    puVar1[0x10] = 900;
    puVar1[0x15] = 0x294;
    puVar1[0x16] = 7;
    puVar1[0x17] = 6;
    puVar1[0x18] = 0x24;
    puVar1[0x19] = 1;
    puVar1[0x21] = 0x44c;
    puVar1[0xb] = 1;
    puVar1[0x25] = 0x20;
    break;
  case 9:
  case 0x89:
    puVar1[0x10] = 0x2d0;
    puVar1[0x15] = 0x294;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x1a;
    puVar1[0x21] = 0x3c5;
    puVar1[0x25] = 0xc;
    puVar1[0xf] = 0x25c;
    iVar3 = iVar2;
    break;
  case 0xb:
    puVar1[5] = 0x400;
    goto LAB_180013319;
  case 0xe:
    puVar1[1] = 0x4b0;
    puVar1[0x10] = 0x2d0;
    puVar1[0x15] = 0x26c;
    puVar1[0x17] = 8;
    puVar1[0x18] = 0x1c;
    puVar1[0x21] = 0x2df;
    break;
  case 0x10:
    puVar1[1] = 0x4b5;
    puVar1[2] = 1;
    puVar1[5] = 0x467;
    puVar1[0x10] = 0x3aa;
    puVar1[0x12] = 0x7f;
    puVar1[0x13] = 8;
    puVar1[0x14] = 7;
    puVar1[0x15] = 0x294;
    puVar1[0x21] = 0x2df;
    puVar1[0xc] = 1;
    break;
  case 0x11:
    puVar1[5] = 0x500;
LAB_180013319:
    puVar1[0x10] = 700;
    goto LAB_180013320;
  case 0x12:
    puVar1[1] = 0x4e7;
    puVar1[5] = 0x500;
    puVar1[0x10] = 0x368;
    puVar1[0x12] = 0x7b;
    puVar1[0x13] = 9;
    puVar1[0x14] = 6;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x20;
    goto LAB_180013320;
  case 0x13:
  case 0x93:
    *puVar1 = 0xf;
    puVar1[5] = 0x780;
    puVar1[0x10] = 0x2d0;
    puVar1[0x15] = 0x26c;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x1a;
    puVar1[0x21] = 0x29e;
    iVar3 = iVar2;
    break;
  case 0x14:
    puVar1[1] = 0x4b5;
    puVar1[5] = 0x467;
    puVar1[0x10] = 0x3aa;
    puVar1[0x12] = 0x7f;
    puVar1[0x13] = 8;
    puVar1[0x14] = 7;
LAB_180013320:
    puVar1[0x15] = 0x294;
    puVar1[0x21] = 0x2df;
    break;
  case 0x15:
  case 0x95:
    puVar1[1] = 0;
    puVar1[2] = 1;
    puVar1[0x10] = 800;
    puVar1[0x12] = 0x7d;
    puVar1[0x15] = 0x226;
    puVar1[0x16] = 7;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x18;
    puVar1[0x19] = 1;
    puVar1[0x21] = 0x307;
    *(undefined8 *)(puVar1 + 0x25) = 0x14;
    iVar3 = iVar2;
    break;
  case 0x16:
    puVar1[5] = 0x800;
    puVar1[0x10] = 0x2d0;
    puVar1[0x12] = 0x6c;
    puVar1[0x15] = 500;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x1e;
    puVar1[0x1b] = 0;
    puVar1[0x21] = 0x226;
    puVar1[0xd] = 400;
    puVar1[0xe] = 1000;
    break;
  case 0x17:
    puVar1[5] = 0x938;
    puVar1[0xd] = 400;
    puVar1[0x10] = 700;
    puVar1[0x12] = 0x75;
    puVar1[0x15] = 0x1c2;
    puVar1[0x16] = 6;
    puVar1[0x17] = 8;
    puVar1[0x18] = 0x18;
    puVar1[0x19] = 1;
    puVar1[0x1a] = 0x55;
    puVar1[0x21] = 500;
  }
  if ((((param_1 == 0x87) || (param_1 == 0x88)) || (param_1 == 0x89)) ||
     ((param_1 == 0x93 || (param_1 == 0x95)))) {
    puVar1[0x25] = puVar1[0x25] + 8;
    puVar1[0x21] = puVar1[0x15];
  }
  else if (iVar3 != 0) {
    return -0x3ea;
  }
  return iVar3;
}



void FUN_180013600(undefined8 *param_1)

{
  if ((LPVOID)*param_1 != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)*param_1);
  }
  if ((LPVOID)param_1[1] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[1]);
  }
  if ((LPVOID)param_1[5] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[5]);
  }
  if ((LPVOID)param_1[6] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[6]);
  }
  if ((LPVOID)param_1[2] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[2]);
  }
  if ((LPVOID)param_1[3] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[3]);
  }
  if ((LPVOID)param_1[4] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[4]);
  }
  if ((LPVOID)param_1[7] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[7]);
  }
  FUN_18001d45c(param_1);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180013690(ulonglong param_1,ulonglong param_2,uint param_3)

{
  byte *pbVar1;
  undefined1 auVar2 [16];
  uint uVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined1 in_XMM1 [16];
  undefined1 auVar8 [16];
  undefined1 auVar9 [16];
  undefined1 auVar10 [16];
  
  auVar2 = _DAT_180040e60;
  iVar6 = 0;
  iVar5 = 0;
  iVar7 = iVar6;
  if ((((0 < (int)param_3) && (iVar7 = iVar5, 7 < param_3)) && (1 < DAT_180046320)) &&
     (((longlong)(int)(param_3 - 1) + param_2 < param_1 ||
      (param_1 + (longlong)(int)(param_3 - 1) * 4 < param_2)))) {
    uVar3 = param_3 & 0x80000007;
    if ((int)uVar3 < 0) {
      uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
    }
    auVar10 = ZEXT416(0x10);
    do {
      auVar8 = pmovzxbd(in_XMM1,ZEXT416(*(uint *)((longlong)iVar6 + param_2)));
      auVar8 = pmulld(auVar8,auVar2);
      auVar9._0_4_ = auVar8._0_4_ + 0x8000 >> auVar10;
      auVar9._4_4_ = auVar8._4_4_ + 0x8000 >> auVar10;
      auVar9._8_4_ = auVar8._8_4_ + 0x8000 >> auVar10;
      auVar9._12_4_ = auVar8._12_4_ + 0x8000 >> auVar10;
      *(undefined1 (*) [16])(param_1 + (longlong)iVar6 * 4) = auVar9;
      iVar7 = iVar6 + 4;
      iVar6 = iVar6 + 8;
      auVar8 = pmovzxbd(auVar9,ZEXT416(*(uint *)((longlong)iVar7 + param_2)));
      auVar8 = pmulld(auVar8,auVar2);
      in_XMM1._0_4_ = auVar8._0_4_ + 0x8000 >> auVar10;
      in_XMM1._4_4_ = auVar8._4_4_ + 0x8000 >> auVar10;
      in_XMM1._8_4_ = auVar8._8_4_ + 0x8000 >> auVar10;
      in_XMM1._12_4_ = auVar8._12_4_ + 0x8000 >> auVar10;
      *(undefined1 (*) [16])(param_1 + (longlong)iVar7 * 4) = in_XMM1;
      iVar7 = iVar6;
    } while (iVar6 < (int)(param_3 - uVar3));
  }
  lVar4 = (longlong)iVar7;
  while (lVar4 < (int)param_3) {
    pbVar1 = (byte *)(lVar4 + param_2);
    lVar4 = lVar4 + 1;
    *(int *)((param_1 - 4) + lVar4 * 4) = (int)((uint)*pbVar1 * 0x202020 + 0x8000) >> 0x10;
  }
  return;
}



void FUN_1800137a0(int *param_1,uint param_2,int param_3,int param_4)

{
  int *piVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  uint *puVar6;
  int *piVar7;
  int *piVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  longlong lVar11;
  int iVar12;
  ulonglong uVar13;
  longlong lVar14;
  ulonglong uVar15;
  uint uVar16;
  ulonglong uVar17;
  uint uVar18;
  uint uVar19;
  longlong lVar20;
  longlong lVar21;
  undefined1 auStack_198 [32];
  uint local_178;
  int *local_170;
  int local_168;
  int *local_160;
  ulonglong local_158;
  longlong local_150;
  int local_148 [8];
  uint local_128 [8];
  int local_108 [8];
  int local_e8 [8];
  int local_c8 [8];
  int local_a8 [8];
  int local_88 [16];
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStack_198;
  uVar13 = (ulonglong)(int)param_2;
  lVar20 = (longlong)param_3;
  local_178 = param_2;
  local_168 = param_3;
  local_160 = param_1;
  piVar5 = FUN_18000f3c0(*param_1 + param_2 * 2,param_1[1] + param_3 * 2);
  local_170 = piVar5;
  if (piVar5 != (int *)0x0) {
    if (param_4 == 0) {
      FUN_18000f5d0((longlong)piVar5,param_2,param_3,param_1);
      lVar21 = 0;
      local_150 = lVar20;
      if (0 < param_3) {
        lVar14 = (longlong)(piVar5[1] - param_3) * 8;
        lVar11 = lVar21;
        do {
          FUN_18001d560((undefined8 *)
                        (*(longlong *)(*(longlong *)(piVar5 + 2) + lVar11 * 8) + uVar13 * 4),
                        (undefined8 *)**(undefined8 **)(param_1 + 2),(longlong)*param_1 << 2);
          FUN_18001d560((undefined8 *)
                        (*(longlong *)(*(longlong *)(piVar5 + 2) + lVar14) + uVar13 * 4),
                        *(undefined8 **)(*(longlong *)(param_1 + 2) + -8 + (longlong)param_1[1] * 8)
                        ,(longlong)*param_1 << 2);
          lVar11 = lVar11 + 1;
          lVar14 = lVar14 + 8;
        } while (lVar11 < lVar20);
        uVar13 = (ulonglong)local_178;
      }
      iVar12 = (int)uVar13;
      puVar6 = (uint *)FUN_18000f3c0(1,param_1[1]);
      if (puVar6 != (uint *)0x0) {
        FUN_18000f460((longlong)param_1,0,0,puVar6);
        if (0 < iVar12) {
          uVar16 = puVar6[1];
          local_158 = uVar13 & 0xffffffff;
          do {
            piVar5 = local_170;
            uVar13 = 0;
            uVar19 = *puVar6;
            if (0 < (int)uVar16) {
              lVar14 = lVar20 * 8;
              uVar9 = uVar13;
              do {
                FUN_18001d560((undefined8 *)
                              (*(longlong *)(*(longlong *)(piVar5 + 2) + lVar14 + uVar13) + lVar21),
                              *(undefined8 **)(*(longlong *)(puVar6 + 2) + uVar13),
                              (longlong)(int)(uVar19 << 2));
                uVar16 = puVar6[1];
                uVar18 = (int)uVar9 + 1;
                uVar9 = (ulonglong)uVar18;
                uVar13 = uVar13 + 8;
                lVar20 = local_150;
              } while ((int)uVar18 < (int)uVar16);
            }
            lVar21 = lVar21 + 4;
            local_158 = local_158 - 1;
          } while (local_158 != 0);
          uVar13 = (ulonglong)local_178;
          local_158 = 0;
          param_1 = local_160;
        }
        piVar5 = local_160;
        uVar9 = 0;
        uVar16 = *puVar6;
        iVar12 = *param_1;
        if (((uVar16 & 0x3fffffff) != 0) && (0 < (int)puVar6[1])) {
          uVar13 = uVar9;
          uVar15 = uVar9;
          do {
            FUN_18001d560(*(undefined8 **)(*(longlong *)(puVar6 + 2) + uVar13),
                          (undefined8 *)
                          (*(longlong *)(uVar13 + *(longlong *)(piVar5 + 2)) +
                          (longlong)(iVar12 + -1) * 4),(longlong)(int)(uVar16 << 2));
            uVar19 = (int)uVar15 + 1;
            uVar15 = (ulonglong)uVar19;
            uVar13 = uVar13 + 8;
          } while ((int)uVar19 < (int)puVar6[1]);
          uVar13 = (ulonglong)local_178;
        }
        local_158 = local_158 & 0xffffffff00000000;
        iVar12 = (int)uVar13;
        if (0 < iVar12) {
          uVar16 = puVar6[1];
          do {
            lVar20 = local_150;
            piVar5 = local_170;
            uVar15 = 0;
            uVar19 = *puVar6;
            iVar12 = *local_170;
            iVar3 = (int)uVar9;
            if (0 < (int)uVar16) {
              uVar13 = uVar15;
              do {
                FUN_18001d560((undefined8 *)
                              (*(longlong *)(*(longlong *)(piVar5 + 2) + uVar15 + lVar20 * 8) +
                              (longlong)((iVar12 - (int)uVar9) + -1) * 4),
                              *(undefined8 **)(*(longlong *)(puVar6 + 2) + uVar15),
                              (longlong)(int)(uVar19 << 2));
                uVar16 = puVar6[1];
                uVar18 = (int)uVar13 + 1;
                uVar13 = (ulonglong)uVar18;
                uVar15 = uVar15 + 8;
              } while ((int)uVar18 < (int)uVar16);
              uVar13 = (ulonglong)local_178;
              iVar3 = (int)local_158;
            }
            uVar19 = iVar3 + 1;
            uVar9 = (ulonglong)uVar19;
            local_158 = CONCAT44(local_158._4_4_,uVar19);
            iVar12 = (int)uVar13;
          } while ((int)uVar19 < iVar12);
        }
        FUN_18001d45c(puVar6);
        param_1 = local_160;
        lVar20 = local_150;
      }
      iVar4 = local_168;
      uVar13 = 0;
      iVar3 = local_168 * 8;
      piVar7 = (int *)FUN_18001ee18((longlong)iVar3 + ((longlong)(local_168 * iVar12) + 4) * 4,1);
      piVar5 = local_170;
      if (piVar7 != (int *)0x0) {
        *piVar7 = iVar12;
        piVar1 = piVar7 + 1;
        piVar8 = piVar7 + 4;
        *(int **)(piVar7 + 2) = piVar8;
        lVar21 = (longlong)piVar8 + (longlong)iVar3;
        *piVar1 = iVar4;
        if (0 < lVar20) {
          uVar9 = uVar13;
          do {
            *(longlong *)(piVar8 + uVar9 * 2) = lVar21;
            uVar9 = uVar9 + 1;
            lVar21 = lVar21 + (longlong)(int)local_178 * 4;
          } while ((longlong)uVar9 < lVar20);
        }
        uVar2 = *(undefined4 *)**(undefined8 **)(param_1 + 2);
        if (0 < *piVar1) {
          iVar12 = *piVar7;
          uVar9 = uVar13;
          uVar15 = uVar13;
          do {
            uVar10 = uVar13;
            uVar17 = uVar13;
            if (0 < iVar12) {
              do {
                uVar16 = (int)uVar17 + 1;
                *(undefined4 *)(uVar10 + *(longlong *)(*(longlong *)(piVar7 + 2) + uVar9)) = uVar2;
                iVar12 = *piVar7;
                uVar10 = uVar10 + 4;
                uVar17 = (ulonglong)uVar16;
              } while ((int)uVar16 < iVar12);
            }
            uVar16 = (int)uVar15 + 1;
            uVar15 = (ulonglong)uVar16;
            uVar9 = uVar9 + 8;
          } while ((int)uVar16 < *piVar1);
        }
        iVar12 = *piVar7;
        if (0 < *piVar1) {
          uVar9 = uVar13;
          uVar15 = uVar13;
          do {
            FUN_18001d560(*(undefined8 **)(*(longlong *)(piVar5 + 2) + uVar9),
                          *(undefined8 **)(*(longlong *)(piVar7 + 2) + uVar9),
                          (longlong)(iVar12 << 2));
            uVar16 = (int)uVar15 + 1;
            uVar15 = (ulonglong)uVar16;
            uVar9 = uVar9 + 8;
            param_1 = local_160;
          } while ((int)uVar16 < *piVar1);
        }
        piVar8 = local_170;
        uVar2 = *(undefined4 *)(**(longlong **)(param_1 + 2) + -4 + (longlong)*param_1 * 4);
        if (0 < *piVar1) {
          iVar12 = *piVar7;
          uVar9 = uVar13;
          uVar15 = uVar13;
          do {
            uVar10 = uVar13;
            uVar17 = uVar13;
            if (0 < iVar12) {
              do {
                uVar16 = (int)uVar17 + 1;
                *(undefined4 *)(uVar10 + *(longlong *)(*(longlong *)(piVar7 + 2) + uVar9)) = uVar2;
                iVar12 = *piVar7;
                uVar10 = uVar10 + 4;
                uVar17 = (ulonglong)uVar16;
              } while ((int)uVar16 < iVar12);
            }
            uVar16 = (int)uVar15 + 1;
            uVar15 = (ulonglong)uVar16;
            uVar9 = uVar9 + 8;
          } while ((int)uVar16 < *piVar1);
        }
        iVar12 = *piVar7;
        iVar3 = *piVar5 - local_178;
        if (0 < *piVar1) {
          uVar9 = uVar13;
          do {
            FUN_18001d560((undefined8 *)
                          (*(longlong *)(uVar13 + *(longlong *)(piVar8 + 2)) + (longlong)iVar3 * 4),
                          *(undefined8 **)(*(longlong *)(piVar7 + 2) + uVar13),
                          (longlong)(iVar12 << 2));
            uVar16 = (int)uVar9 + 1;
            uVar9 = (ulonglong)uVar16;
            uVar13 = uVar13 + 8;
            param_1 = local_160;
            piVar5 = local_170;
          } while ((int)uVar16 < *piVar1);
        }
        piVar8 = local_170;
        uVar13 = 0;
        uVar2 = **(undefined4 **)(*(longlong *)(param_1 + 2) + -8 + (longlong)param_1[1] * 8);
        if (0 < *piVar1) {
          iVar12 = *piVar7;
          uVar9 = uVar13;
          uVar15 = uVar13;
          do {
            uVar10 = uVar13;
            uVar17 = uVar13;
            if (0 < iVar12) {
              do {
                uVar16 = (int)uVar17 + 1;
                *(undefined4 *)(uVar10 + *(longlong *)(*(longlong *)(piVar7 + 2) + uVar9)) = uVar2;
                iVar12 = *piVar7;
                uVar10 = uVar10 + 4;
                uVar17 = (ulonglong)uVar16;
              } while ((int)uVar16 < iVar12);
            }
            uVar16 = (int)uVar15 + 1;
            uVar15 = (ulonglong)uVar16;
            uVar9 = uVar9 + 8;
          } while ((int)uVar16 < *piVar1);
        }
        iVar12 = *piVar7;
        if (0 < *piVar1) {
          iVar3 = piVar5[1] - local_168;
          uVar9 = uVar13;
          do {
            FUN_18001d560(*(undefined8 **)(uVar13 + (longlong)iVar3 * 8 + *(longlong *)(piVar8 + 2))
                          ,*(undefined8 **)(*(longlong *)(piVar7 + 2) + uVar13),
                          (longlong)(iVar12 << 2));
            uVar16 = (int)uVar9 + 1;
            uVar9 = (ulonglong)uVar16;
            uVar13 = uVar13 + 8;
            param_1 = local_160;
          } while ((int)uVar16 < *piVar1);
        }
        uVar13 = 0;
        uVar2 = *(undefined4 *)
                 (*(longlong *)(*(longlong *)(param_1 + 2) + -8 + (longlong)param_1[1] * 8) + -4 +
                 (longlong)*param_1 * 4);
        if (0 < *piVar1) {
          iVar12 = *piVar7;
          uVar9 = uVar13;
          uVar15 = uVar13;
          do {
            uVar10 = uVar13;
            uVar17 = uVar13;
            if (0 < iVar12) {
              do {
                uVar16 = (int)uVar17 + 1;
                *(undefined4 *)(uVar10 + *(longlong *)(*(longlong *)(piVar7 + 2) + uVar9)) = uVar2;
                iVar12 = *piVar7;
                uVar10 = uVar10 + 4;
                uVar17 = (ulonglong)uVar16;
              } while ((int)uVar16 < iVar12);
            }
            uVar16 = (int)uVar15 + 1;
            uVar15 = (ulonglong)uVar16;
            uVar9 = uVar9 + 8;
          } while ((int)uVar16 < *piVar1);
        }
        iVar12 = *piVar7;
        iVar3 = *local_170 - local_178;
        if (0 < *piVar1) {
          iVar4 = local_170[1] - local_168;
          uVar9 = uVar13;
          do {
            FUN_18001d560((undefined8 *)
                          (*(longlong *)(uVar9 + (longlong)iVar4 * 8 + *(longlong *)(local_170 + 2))
                          + (longlong)iVar3 * 4),*(undefined8 **)(*(longlong *)(piVar7 + 2) + uVar9)
                          ,(longlong)(iVar12 << 2));
            uVar16 = (int)uVar13 + 1;
            uVar13 = (ulonglong)uVar16;
            uVar9 = uVar9 + 8;
          } while ((int)uVar16 < *piVar1);
        }
        FUN_18001d45c(piVar7);
      }
    }
    else if (param_4 == 4) {
      local_108[0] = *param_1;
      local_148[2] = param_1[1];
      uVar9 = 0;
      local_a8[2] = 0;
      local_a8[3] = 0;
      local_a8[4] = 1;
      local_a8[5] = 1;
      local_88[0xc] = 1;
      local_88[0xd] = 1;
      local_88[0xe] = 1;
      local_88[0xf] = 1;
      local_108[1] = local_108[0];
      local_88[0] = 1;
      local_88[1] = 1;
      local_88[2] = 0;
      local_88[3] = 0;
      local_c8[3] = (local_108[0] - param_2) + -1;
      local_148[3] = local_148[2];
      local_88[8] = 0;
      local_88[9] = 0;
      local_88[10] = 1;
      local_88[0xb] = 1;
      local_c8[5] = local_c8[3];
      local_c8[7] = local_c8[3];
      local_a8[1] = (local_148[2] - param_3) + -1;
      local_108[2] = param_2;
      local_108[3] = param_2;
      local_a8[6] = local_a8[1];
      local_a8[7] = local_a8[1];
      local_108[4] = param_2;
      local_108[5] = param_2;
      local_88[4] = 1;
      local_88[5] = 1;
      local_88[6] = 1;
      local_88[7] = 1;
      local_128[3] = *piVar5 - param_2;
      local_108[6] = param_2;
      local_108[7] = param_2;
      local_128[5] = local_128[3];
      local_128[7] = local_128[3];
      local_128[0] = param_2;
      local_128[1] = param_2;
      local_e8[1] = piVar5[1] - param_3;
      local_148[0] = param_3;
      local_148[1] = param_3;
      local_148[4] = param_3;
      local_148[5] = param_3;
      local_148[6] = param_3;
      local_e8[6] = local_e8[1];
      local_e8[7] = local_e8[1];
      local_148[7] = param_3;
      local_c8[0] = 0;
      local_c8[1] = 0;
      local_c8[2] = 1;
      local_c8[4] = 1;
      local_c8[6] = 1;
      local_a8[0] = 1;
      local_128[2] = 0;
      local_128[4] = 0;
      local_128[6] = 0;
      local_e8[0] = 0;
      local_e8[2] = param_3;
      local_e8[3] = param_3;
      local_e8[4] = 0;
      local_e8[5] = 0;
      uVar13 = uVar9;
      do {
        puVar6 = (uint *)FUN_18000f3c0(*(int *)((longlong)local_108 + uVar13),
                                       *(int *)((longlong)local_148 + uVar13));
        if (puVar6 != (uint *)0x0) {
          FUN_18000f460((longlong)param_1,*(int *)((longlong)local_c8 + uVar13),
                        *(int *)((longlong)local_a8 + uVar13),puVar6);
          if (*(int *)((longlong)local_88 + uVar13) != 0) {
            FUN_18000f500((int *)puVar6);
          }
          if ((*(int *)((longlong)local_88 + uVar13 + 0x20) != 0) &&
             (uVar15 = uVar9, uVar10 = uVar9, 0 < (int)puVar6[1])) {
            do {
              lVar20 = (longlong)(int)(*puVar6 - 1);
              uVar17 = uVar9;
              if (0 < lVar20) {
                do {
                  lVar20 = lVar20 + -1;
                  uVar17 = uVar17 + 1;
                  lVar21 = *(longlong *)(uVar15 + *(longlong *)(puVar6 + 2));
                  uVar2 = *(undefined4 *)(lVar21 + -4 + uVar17 * 4);
                  *(undefined4 *)(lVar21 + -4 + uVar17 * 4) =
                       *(undefined4 *)(lVar21 + 4 + lVar20 * 4);
                  *(undefined4 *)
                   (*(longlong *)(*(longlong *)(puVar6 + 2) + uVar15) + 4 + lVar20 * 4) = uVar2;
                } while ((longlong)uVar17 < lVar20);
              }
              uVar16 = (int)uVar10 + 1;
              uVar15 = uVar15 + 8;
              uVar10 = (ulonglong)uVar16;
            } while ((int)uVar16 < (int)puVar6[1]);
          }
          FUN_18000f5d0((longlong)piVar5,*(int *)((longlong)local_128 + uVar13),
                        *(int *)((longlong)local_e8 + uVar13),(int *)puVar6);
          FUN_18001d45c(puVar6);
        }
        uVar13 = uVar13 + 4;
      } while ((longlong)uVar13 < 0x20);
      FUN_18000f5d0((longlong)piVar5,local_178,param_3,param_1);
    }
  }
  FUN_18001d530(local_48 ^ (ulonglong)auStack_198);
  return;
}



void FUN_180013fe0(int *param_1,int *param_2,longlong param_3,int param_4)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  int iVar7;
  longlong lVar8;
  uint uVar9;
  longlong lVar10;
  longlong lVar11;
  int iVar12;
  longlong lVar13;
  
  iVar2 = param_2[1] / 2;
  uVar3 = *param_2 / 2;
  piVar5 = (int *)FUN_1800137a0(param_1,uVar3,iVar2,param_4);
  if (piVar5 != (int *)0x0) {
    if (iVar2 < piVar5[1] - iVar2) {
      iVar7 = *piVar5 - uVar3;
      lVar13 = 0;
      iVar12 = iVar2;
      do {
        if ((int)uVar3 < iVar7) {
          lVar10 = 0;
          uVar9 = uVar3;
          do {
            iVar7 = 0;
            lVar11 = 0;
            if (0 < (longlong)param_2[1]) {
              do {
                if (0 < (longlong)*param_2) {
                  piVar1 = *(int **)(*(longlong *)(param_2 + 2) + lVar11 * 8);
                  piVar6 = piVar1;
                  lVar8 = (longlong)*param_2;
                  do {
                    iVar7 = iVar7 + *(int *)((*(longlong *)
                                               (*(longlong *)(piVar5 + 2) + lVar13 + lVar11 * 8) -
                                             (longlong)piVar1) + lVar10 + (longlong)piVar6) *
                                    *piVar6;
                    lVar8 = lVar8 + -1;
                    piVar6 = piVar6 + 1;
                  } while (lVar8 != 0);
                }
                lVar11 = lVar11 + 1;
              } while (lVar11 < param_2[1]);
            }
            iVar4 = -0x2000;
            if (0 < iVar7) {
              iVar4 = 0x2000;
            }
            uVar9 = uVar9 + 1;
            *(int *)(lVar10 + *(longlong *)(lVar13 + *(longlong *)(param_3 + 8))) =
                 (int)(iVar4 + iVar7 + (iVar4 + iVar7 >> 0x1f & 0x3fffU)) >> 0xe;
            iVar7 = *piVar5 - uVar3;
            lVar10 = lVar10 + 4;
          } while ((int)uVar9 < iVar7);
        }
        iVar12 = iVar12 + 1;
        lVar13 = lVar13 + 8;
      } while (iVar12 < piVar5[1] - iVar2);
    }
    FUN_18001d45c(piVar5);
  }
  return;
}



void FUN_180014160(int *param_1,longlong param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  undefined1 auStack_68 [32];
  ushort local_48 [12];
  ulonglong local_30;
  
  local_30 = DAT_1800461a0 ^ (ulonglong)auStack_68;
  local_48[10] = 0x24a;
  iVar1 = param_3 + -10;
  local_48[0] = 0;
  local_48[1] = 0x19;
  local_48[2] = 0x32;
  local_48[3] = 0x4b;
  local_48[4] = 0x7c;
  local_48[5] = 0xad;
  local_48[6] = 0xde;
  local_48[7] = 0x12f;
  local_48[8] = 0x180;
  local_48[9] = 0x1d1;
  piVar2 = FUN_18000f3c0((uint)(byte)(&DAT_18003eab0)[iVar1],(uint)(byte)(&DAT_18003eab0)[iVar1]);
  if (piVar2 != (int *)0x0) {
    FUN_18001d560((undefined8 *)**(undefined8 **)(piVar2 + 2),
                  (undefined8 *)(&DAT_18003f600 + (ulonglong)local_48[iVar1] * 4),
                  (longlong)
                  (int)((uint)(byte)(&DAT_18003eab0)[iVar1] * (uint)(byte)(&DAT_18003eab0)[iVar1])
                  << 2);
    FUN_180013fe0(param_1,piVar2,param_2,0);
    FUN_18001d45c(piVar2);
  }
  FUN_18001d530(local_30 ^ (ulonglong)auStack_68);
  return;
}



LPVOID FUN_180014250(int param_1,int param_2)

{
  int iVar1;
  LPVOID pvVar2;
  int *piVar3;
  int iVar4;
  
  iVar1 = param_2 / 2;
  pvVar2 = FUN_18001ed60((longlong)(param_1 + iVar1 * 2) << 2);
  if (pvVar2 == (LPVOID)0x0) {
    return (LPVOID)0x0;
  }
  iVar4 = -iVar1;
  if (iVar4 < iVar1 + param_1) {
    piVar3 = (int *)((longlong)pvVar2 + ((longlong)iVar1 + (longlong)iVar4) * 4);
    do {
      if (iVar4 < 0) {
        *piVar3 = 0;
      }
      else if (iVar4 < param_1) {
        *piVar3 = iVar4;
      }
      else {
        *piVar3 = param_1 + -1;
      }
      iVar4 = iVar4 + 1;
      piVar3 = piVar3 + 1;
    } while (iVar4 < iVar1 + param_1);
  }
  return pvVar2;
}



undefined8 FUN_1800142d0(int *param_1,int *param_2,uint param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  longlong lVar3;
  longlong *plVar4;
  longlong lVar5;
  uint uVar6;
  int iVar7;
  int *piVar8;
  LPVOID pvVar9;
  longlong lVar10;
  int *piVar11;
  longlong lVar12;
  int *piVar13;
  longlong lVar14;
  longlong *plVar15;
  int iVar16;
  int iVar17;
  longlong lVar18;
  longlong lVar19;
  longlong lVar20;
  longlong lVar21;
  longlong lVar22;
  int iVar23;
  int iVar24;
  int iVar29;
  int iVar30;
  int iVar31;
  int iVar32;
  undefined1 auVar25 [16];
  undefined1 auVar26 [16];
  int iVar33;
  undefined1 auVar28 [16];
  int iVar34;
  undefined1 auVar27 [16];
  
  iVar17 = param_1[1];
  lVar22 = (longlong)iVar17;
  iVar24 = *param_1;
  lVar14 = (longlong)iVar24;
  lVar20 = (longlong)(int)param_3;
  piVar8 = FUN_18000f3c0(iVar24,iVar17);
  lVar3 = *(longlong *)(param_1 + 2);
  plVar4 = *(longlong **)(piVar8 + 2);
  pvVar9 = FUN_180014250(iVar24,param_3);
  if (0 < lVar22) {
    lVar18 = lVar3 - (longlong)plVar4;
    lVar12 = lVar22;
    plVar15 = plVar4;
    iVar24 = DAT_180046320;
    do {
      lVar21 = 0;
      if (0 < lVar14) {
        piVar11 = (int *)((longlong)pvVar9 + 8);
        do {
          iVar16 = 0;
          lVar19 = 0;
          if (((0 < (int)param_3) && (7 < param_3)) && (1 < iVar24)) {
            lVar5 = *(longlong *)(lVar18 + (longlong)plVar15);
            uVar6 = param_3 & 0x80000007;
            if ((int)uVar6 < 0) {
              uVar6 = (uVar6 - 1 | 0xfffffff8) + 1;
            }
            iVar23 = 0;
            iVar29 = 0;
            iVar31 = 0;
            iVar33 = 0;
            piVar13 = piVar11;
            iVar24 = iVar23;
            iVar30 = iVar29;
            iVar32 = iVar31;
            iVar34 = iVar33;
            do {
              uVar1 = *(undefined4 *)(lVar5 + (longlong)*piVar13 * 4);
              uVar2 = *(undefined4 *)(lVar5 + (longlong)piVar13[-2] * 4);
              lVar10 = (longlong)iVar16;
              auVar25._4_4_ = uVar1;
              auVar25._0_4_ = uVar2;
              lVar19 = lVar19 + 8;
              iVar7 = iVar16 + 4;
              iVar16 = iVar16 + 8;
              auVar25._8_4_ = uVar1;
              auVar25._12_4_ = *(undefined4 *)(lVar5 + (longlong)piVar13[1] * 4);
              auVar26._8_8_ = auVar25._8_8_;
              auVar26._4_4_ = *(undefined4 *)(lVar5 + (longlong)piVar13[-1] * 4);
              auVar26._0_4_ = uVar2;
              auVar26 = pmulld(auVar26,*(undefined1 (*) [16])(param_2 + lVar10));
              iVar23 = auVar26._0_4_ + iVar23;
              iVar29 = auVar26._4_4_ + iVar29;
              iVar31 = auVar26._8_4_ + iVar31;
              iVar33 = auVar26._12_4_ + iVar33;
              uVar1 = *(undefined4 *)(lVar5 + (longlong)piVar13[2] * 4);
              uVar2 = *(undefined4 *)(lVar5 + (longlong)piVar13[4] * 4);
              auVar28._4_4_ = uVar2;
              auVar28._0_4_ = uVar1;
              auVar28._8_4_ = uVar2;
              auVar28._12_4_ = *(undefined4 *)(lVar5 + (longlong)piVar13[5] * 4);
              auVar27._8_8_ = auVar28._8_8_;
              auVar27._4_4_ = *(undefined4 *)(lVar5 + (longlong)piVar13[3] * 4);
              auVar27._0_4_ = uVar1;
              auVar26 = pmulld(auVar27,*(undefined1 (*) [16])(param_2 + iVar7));
              iVar24 = auVar26._0_4_ + iVar24;
              iVar30 = auVar26._4_4_ + iVar30;
              iVar32 = auVar26._8_4_ + iVar32;
              iVar34 = auVar26._12_4_ + iVar34;
              piVar13 = piVar13 + 8;
            } while (iVar16 < (int)(param_3 - uVar6));
            iVar16 = iVar24 + iVar23 + iVar32 + iVar31 + iVar30 + iVar29 + iVar34 + iVar33;
          }
          iVar24 = 0;
          iVar30 = 0;
          if (lVar19 < lVar20) {
            if (1 < lVar20 - lVar19) {
              lVar5 = lVar19 + 1;
              lVar10 = ((lVar20 - lVar19) - 2U >> 1) + 1;
              lVar19 = lVar19 + lVar10 * 2;
              piVar13 = param_2 + lVar5;
              do {
                iVar24 = iVar24 + *(int *)(*(longlong *)(lVar18 + (longlong)plVar15) +
                                          (longlong)
                                          *(int *)((longlong)piVar13 +
                                                  (-0xc - (longlong)param_2) + (longlong)piVar11) *
                                          4) * piVar13[-1];
                iVar30 = iVar30 + *(int *)(*(longlong *)(lVar18 + (longlong)plVar15) +
                                          (longlong)
                                          *(int *)((longlong)piVar11 + (-0x10 - (longlong)param_2) +
                                                  (longlong)(piVar13 + 2)) * 4) * *piVar13;
                lVar10 = lVar10 + -1;
                piVar13 = piVar13 + 2;
              } while (lVar10 != 0);
            }
            if (lVar19 < lVar20) {
              iVar16 = iVar16 + *(int *)(*(longlong *)(lVar18 + (longlong)plVar15) +
                                        (longlong)piVar11[lVar19 + -2] * 4) * param_2[lVar19];
            }
            iVar16 = iVar16 + iVar30 + iVar24;
          }
          lVar21 = lVar21 + 1;
          piVar11 = piVar11 + 1;
          *(int *)(*plVar15 + -4 + lVar21 * 4) = iVar16 + 0x4000 >> 0xf;
          iVar24 = DAT_180046320;
        } while (lVar21 < lVar14);
      }
      plVar15 = plVar15 + 1;
      lVar12 = lVar12 + -1;
    } while (lVar12 != 0);
  }
  FUN_18001d45c(pvVar9);
  FUN_18001d560((undefined8 *)**(undefined8 **)(param_1 + 2),
                (undefined8 *)**(undefined8 **)(piVar8 + 2),(longlong)(*piVar8 * piVar8[1]) << 2);
  iVar24 = (int)param_3 / 2;
  pvVar9 = FUN_18001ed60((longlong)(iVar17 + iVar24 * 2) << 2);
  if (pvVar9 != (LPVOID)0x0) {
    iVar16 = -iVar24;
    if (iVar16 < iVar24 + iVar17) {
      lVar12 = (longlong)iVar16;
      piVar11 = (int *)((longlong)pvVar9 + (iVar24 + lVar12) * 4);
      do {
        if (iVar16 < 0) {
          *piVar11 = 0;
        }
        else if (lVar12 < lVar22) {
          *piVar11 = iVar16;
        }
        else {
          *piVar11 = iVar17 + -1;
        }
        iVar16 = iVar16 + 1;
        lVar12 = lVar12 + 1;
        piVar11 = piVar11 + 1;
      } while (iVar16 < iVar24 + iVar17);
    }
  }
  lVar12 = 0;
  if (0 < lVar14) {
    do {
      lVar18 = 0;
      if (0 < lVar22) {
        lVar21 = (longlong)pvVar9 - (longlong)param_2;
        do {
          iVar17 = 0;
          piVar11 = param_2;
          lVar19 = lVar20;
          if (0 < lVar20) {
            do {
              iVar17 = iVar17 + *(int *)(*(longlong *)
                                          (lVar3 + (longlong)*(int *)(lVar21 + (longlong)piVar11) *
                                                   8) + lVar12 * 4) * *piVar11;
              lVar19 = lVar19 + -1;
              piVar11 = piVar11 + 1;
            } while (lVar19 != 0);
          }
          plVar15 = plVar4 + lVar18;
          lVar18 = lVar18 + 1;
          lVar21 = lVar21 + 4;
          *(int *)(*plVar15 + lVar12 * 4) = iVar17 + 0x4000 >> 0xf;
        } while (lVar18 < lVar22);
      }
      lVar12 = lVar12 + 1;
    } while (lVar12 < lVar14);
  }
  FUN_18001d45c(pvVar9);
  FUN_18001d560((undefined8 *)**(undefined8 **)(param_1 + 2),
                (undefined8 *)**(undefined8 **)(piVar8 + 2),(longlong)(*piVar8 * piVar8[1]) << 2);
  FUN_18001d45c(piVar8);
  return 0;
}



void FUN_180014750(longlong param_1,int *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined1 auStack_48 [32];
  byte local_28 [16];
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStack_48;
  iVar1 = param_2[8];
  if (iVar1 == 1) {
    iVar1 = FUN_180014160(*(int **)(param_1 + 0x28),(longlong)*(int **)(param_1 + 0x28),*param_2);
  }
  else {
    if (iVar1 != 2) {
      if (iVar1 == 3) {
        FUN_18000f6d0(*(uint **)(param_1 + 0x28),(longlong)*(uint **)(param_1 + 0x28));
      }
      goto LAB_1800147fe;
    }
    local_28[0] = 0;
    local_28[1] = 5;
    local_28[2] = 10;
    local_28[3] = 0xf;
    local_28[4] = 0x16;
    local_28[5] = 0x1d;
    local_28[6] = 0x24;
    local_28[7] = 0x2d;
    local_28[8] = 0x36;
    local_28[9] = 0x3f;
    local_28[10] = 0x4a;
    iVar1 = *param_2 + -10;
    if (10 < *param_2 + -10) {
      iVar1 = 10;
    }
    uVar2 = FUN_1800142d0(*(int **)(param_1 + 0x28),
                          (int *)(&UNK_18003ffd0 + (ulonglong)local_28[iVar1] * 4),
                          (uint)(byte)(&DAT_18003eab0)[iVar1]);
    iVar1 = (int)uVar2;
  }
  if (iVar1 != 0) {
    FUN_18001d530(local_18 ^ (ulonglong)auStack_48);
    return;
  }
LAB_1800147fe:
  FUN_18001d530(local_18 ^ (ulonglong)auStack_48);
  return;
}



void FUN_180014820(int *param_1,int *param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar1 = param_5 * 2 + 1;
  iVar4 = (param_5 / 2 + 0x600) / param_5;
  if (param_5 == 1) {
    param_1[0] = 0x600;
    param_1[1] = 0x1400;
    param_1[2] = 0x600;
    param_2[0] = -0x4000;
    param_2[1] = 0;
    param_2[2] = 0x4000;
  }
  else {
    iVar5 = 0;
    do {
      iVar3 = param_4;
      piVar2 = param_2;
      if (iVar5 == 0) {
        iVar3 = param_3;
        piVar2 = param_1;
      }
      piVar2[0] = 0;
      piVar2[1] = 0;
      piVar2[2] = 0;
      piVar2[3] = 0;
      piVar2[4] = 0;
      piVar2[5] = 0;
      piVar2[6] = 0;
      piVar2[7] = 0;
      piVar2[8] = 0;
      piVar2[9] = 0;
      piVar2[10] = 0;
      piVar2[0xb] = 0;
      piVar2[0xc] = 0;
      piVar2[0xd] = 0;
      piVar2[0xe] = 0;
      piVar2[0xf] = 0;
      if (iVar3 == 0) {
        *piVar2 = iVar4;
        piVar2[iVar1 / 2] = (param_5 / 2 + 0x1400) / param_5;
        piVar2[(longlong)iVar1 + -1] = iVar4;
      }
      else if (iVar3 == 1) {
        *piVar2 = -0x4000;
        piVar2[iVar1 / 2] = 0;
        piVar2[(longlong)iVar1 + -1] = 0x4000;
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 < 2);
  }
  return;
}



void FUN_180014960(int *param_1,int *param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  undefined1 auStackY_108 [32];
  int local_c8 [16];
  int local_88 [16];
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStackY_108;
  iVar1 = param_5 * 2 + 1;
  piVar2 = FUN_18000f3c0(iVar1,1);
  piVar3 = FUN_18000f3c0(1,iVar1);
  if (piVar2 != (int *)0x0) {
    if (piVar3 != (int *)0x0) {
      FUN_180014820(local_c8,local_88,param_3,param_4,param_5);
      FUN_18001d560((undefined8 *)**(undefined8 **)(piVar2 + 2),(undefined8 *)local_c8,
                    (longlong)iVar1 << 2);
      FUN_18001d560((undefined8 *)**(undefined8 **)(piVar3 + 2),(undefined8 *)local_88,
                    (longlong)iVar1 << 2);
      FUN_180013fe0(param_1,piVar2,(longlong)param_2,4);
      FUN_180013fe0(param_2,piVar3,(longlong)param_2,4);
    }
    FUN_18001d45c(piVar2);
  }
  if (piVar3 != (int *)0x0) {
    FUN_18001d45c(piVar3);
  }
  FUN_18001d530(local_48 ^ (ulonglong)auStackY_108);
  return;
}



void FUN_180014aa0(longlong *param_1,int *param_2)

{
  int iVar1;
  
  iVar1 = param_2[10];
  if (iVar1 == 0) {
    iVar1 = (*param_2 * 0xf) / 100;
    FUN_180014960((int *)param_1[5],(int *)*param_1,1,0,iVar1);
    FUN_180014960((int *)param_1[5],(int *)param_1[1],0,1,iVar1);
    FUN_180014960((int *)*param_1,(int *)param_1[2],1,0,iVar1);
    FUN_180014960((int *)param_1[1],(int *)param_1[4],0,1,iVar1);
    FUN_180014960((int *)*param_1,(int *)param_1[3],0,1,iVar1);
    return;
  }
  if (iVar1 == 1) {
    FUN_18000fc20((int *)param_1[5],*param_1,param_1[1]);
    FUN_18000fc20((int *)*param_1,param_1[2],param_1[3]);
    FUN_18000fc20((int *)param_1[1],0,param_1[4]);
    return;
  }
  if (iVar1 == 2) {
    FUN_18000fde0((uint *)param_1[5],*param_1,param_1[1]);
    FUN_18000fde0((uint *)*param_1,param_1[2],param_1[3]);
    FUN_18000fde0((uint *)param_1[1],0,param_1[4]);
    return;
  }
  return;
}



undefined8 FUN_180014bd0(longlong *param_1,int *param_2)

{
  int *piVar1;
  undefined8 uVar2;
  longlong lVar3;
  longlong lVar4;
  char *pcVar5;
  int iVar6;
  int iVar7;
  longlong lVar8;
  longlong lVar9;
  
  iVar7 = *(int *)param_1[5];
  iVar6 = ((int *)param_1[5])[1];
  pcVar5 = *(char **)param_1[7];
  piVar1 = FUN_18000f3c0(iVar7,iVar6);
  *param_1 = (longlong)piVar1;
  piVar1 = FUN_18000f3c0(iVar7,iVar6);
  param_1[1] = (longlong)piVar1;
  piVar1 = FUN_18000f3c0(iVar7,iVar6);
  param_1[2] = (longlong)piVar1;
  piVar1 = FUN_18000f3c0(iVar7,iVar6);
  param_1[3] = (longlong)piVar1;
  piVar1 = FUN_18000f3c0(iVar7,iVar6);
  param_1[4] = (longlong)piVar1;
  if ((((*param_1 == 0) || (param_1[1] == 0)) || (param_1[2] == 0)) ||
     ((param_1[3] == 0 || (piVar1 == (int *)0x0)))) {
    uVar2 = 0xfffffc18;
  }
  else {
    FUN_180014aa0(param_1,param_2);
    lVar8 = (longlong)(iVar6 * iVar7);
    piVar1 = (int *)**(undefined8 **)(param_1[4] + 8);
    if (0 < iVar6 * iVar7) {
      lVar9 = **(longlong **)(param_1[3] + 8) - (longlong)piVar1;
      lVar4 = **(longlong **)(param_1[3] + 8) - (longlong)piVar1;
      lVar3 = **(longlong **)(param_1[2] + 8) - (longlong)piVar1;
      do {
        iVar7 = *(int *)(lVar4 + (longlong)piVar1);
        iVar6 = *piVar1 * *(int *)((longlong)piVar1 + lVar3);
        iVar7 = iVar7 * iVar7;
        *(int *)(lVar9 + (longlong)piVar1) = (int)((((0 < iVar6 - iVar7) + 7) - iVar7) + iVar6) >> 4
        ;
        if (*pcVar5 != -1) {
          *pcVar5 = *(int *)((longlong)piVar1 + lVar3) < 0;
        }
        piVar1 = piVar1 + 1;
        pcVar5 = pcVar5 + 1;
        lVar8 = lVar8 + -1;
      } while (lVar8 != 0);
    }
    if ((LPVOID)param_1[4] != (LPVOID)0x0) {
      FUN_18001d45c((LPVOID)param_1[4]);
    }
    if ((LPVOID)param_1[2] != (LPVOID)0x0) {
      FUN_18001d45c((LPVOID)param_1[2]);
    }
    param_1[4] = 0;
    param_1[2] = 0;
    param_1[6] = param_1[3];
    uVar2 = 0;
    param_1[3] = 0;
  }
  return uVar2;
}



int * FUN_180014d60(longlong param_1,longlong param_2)

{
  uint *puVar1;
  longlong lVar2;
  undefined8 *puVar3;
  undefined8 uVar4;
  int iVar5;
  int *piVar6;
  int *piVar7;
  int *piVar8;
  int *piVar9;
  uint uVar10;
  longlong lVar11;
  int *piVar12;
  int iVar13;
  uint uVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  longlong lVar18;
  uint *puVar19;
  uint uVar20;
  longlong lVar21;
  int *piVar22;
  longlong lVar23;
  uint uVar24;
  int *piVar25;
  longlong local_res20;
  
  iVar16 = *(int *)(param_2 + 0x10);
  lVar11 = *(longlong *)(param_1 + 0x38);
  piVar25 = (int *)0x0;
  iVar15 = 0;
  uVar24 = 0;
  iVar5 = (*(int *)(param_1 + 0x44) * *(int *)(param_1 + 0x40)) / (iVar16 * iVar16);
  piVar6 = (int *)FUN_18001ee18(0x10,(longlong)iVar5);
  if (piVar6 == (int *)0x0) {
    return (int *)0x0;
  }
  iVar13 = 0xb;
  if (0xb < *(int *)(*(longlong *)(param_1 + 0x30) + 4) + -0xb) {
    lVar11 = lVar11 + -8;
    local_res20 = 0x60;
    piVar12 = piVar25;
    do {
      iVar17 = 0xb;
      lVar21 = *(longlong *)(*(int **)(param_1 + 0x30) + 2);
      lVar23 = 0xb;
      lVar2 = *(longlong *)(lVar21 + -8 + local_res20);
      if (0xb < **(int **)(param_1 + 0x30) + -0xb) {
        lVar18 = *(longlong *)(lVar21 + -0x10 + local_res20) - lVar2;
        lVar21 = *(longlong *)(lVar21 + local_res20) - lVar2;
        piVar7 = (int *)(lVar2 + 0x30);
        do {
          if ((((((*(char *)(lVar23 + *(longlong *)(lVar11 + local_res20)) != -1) &&
                 (uVar20 = piVar7[-1], *(int *)(param_2 + 4) < (int)uVar20)) &&
                (piVar7[-2] < (int)uVar20)) &&
               ((*piVar7 < (int)uVar20 && (*(int *)(lVar18 + -8 + (longlong)piVar7) < (int)uVar20)))
               ) && ((*(int *)((longlong)piVar7 + lVar18 + -4) < (int)uVar20 &&
                     ((*(int *)(lVar18 + (longlong)piVar7) < (int)uVar20 &&
                      (*(int *)(lVar21 + -8 + (longlong)piVar7) < (int)uVar20)))))) &&
             ((*(int *)((longlong)piVar7 + lVar21 + -4) < (int)uVar20 &&
              (*(int *)(lVar21 + (longlong)piVar7) < (int)uVar20)))) {
            uVar14 = (uint)piVar12;
            uVar10 = (uVar20 ^ (int)uVar20 >> 0x1f) - ((int)uVar20 >> 0x1f);
            piVar8 = piVar25;
            piVar9 = piVar6;
            piVar22 = piVar25;
            uVar20 = uVar24;
            if (0 < (int)uVar14) {
              do {
                uVar20 = (uint)piVar22;
                if ((iVar13 - piVar9[1]) * (iVar13 - piVar9[1]) +
                    (iVar17 - *piVar9) * (iVar17 - *piVar9) < iVar16 - (iVar16 >> 2)) {
                  if (uVar10 <= (uint)piVar6[(longlong)piVar8 * 4 + 2]) goto LAB_180014fc6;
                  break;
                }
                piVar8 = (int *)((longlong)piVar8 + 1);
                uVar20 = uVar20 + 1;
                piVar9 = piVar9 + 4;
                piVar22 = (int *)(ulonglong)uVar20;
              } while ((longlong)piVar8 < (longlong)(int)uVar14);
              if ((int)uVar20 < 0) goto LAB_180014fc6;
            }
            piVar8 = piVar6 + (longlong)piVar8 * 4;
            if (uVar20 == uVar14) {
              piVar12 = (int *)(ulonglong)(uVar14 + 1);
            }
            piVar8[2] = uVar10;
            *piVar8 = iVar17;
            piVar8[1] = iVar13;
            *(undefined1 *)(piVar8 + 3) =
                 *(undefined1 *)(lVar23 + *(longlong *)(lVar11 + local_res20));
            iVar15 = (int)piVar12;
            if (iVar5 <= iVar15) goto LAB_180014f68;
          }
LAB_180014fc6:
          iVar17 = iVar17 + 1;
          lVar23 = lVar23 + 1;
          piVar7 = piVar7 + 1;
        } while (iVar17 < **(int **)(param_1 + 0x30) + -0xb);
      }
      iVar15 = (int)piVar12;
      if (iVar5 <= iVar15) break;
      local_res20 = local_res20 + 8;
      iVar13 = iVar13 + 1;
    } while (iVar13 < *(int *)(*(longlong *)(param_1 + 0x30) + 4) + -0xb);
  }
LAB_180014f68:
  FUN_18001d45c(*(LPVOID *)(param_1 + 0x38));
  *(undefined8 *)(param_1 + 0x38) = 0;
  if (*(int *)(param_2 + 0x38) != 0) {
    uVar24 = iVar15 * 2;
  }
  iVar16 = uVar24 + iVar15;
  piVar7 = (int *)FUN_18001ee18(1,(longlong)(iVar16 * 0x58 + 0x20));
  piVar12 = piVar25;
  if (piVar7 != (int *)0x0) {
    piVar8 = piVar7 + 8 + (longlong)iVar16 * 2;
    *(int **)(piVar7 + 6) = piVar7 + 8;
    piVar9 = piVar25;
    piVar12 = piVar7;
    if (0 < iVar16) {
      do {
        piVar9 = (int *)((longlong)piVar9 + 1);
        *(int **)(*(longlong *)(piVar7 + 6) + -8 + (longlong)piVar9 * 8) = piVar8;
        piVar8 = piVar8 + 0x14;
      } while ((longlong)piVar9 < (longlong)iVar16);
    }
  }
  *piVar12 = iVar15;
  if (0 < iVar15) {
    puVar19 = (uint *)(piVar6 + 2);
    do {
      if (0x1fff < *puVar19) {
        *puVar19 = 0x1fff;
      }
      puVar1 = puVar19 + -2;
      uVar4 = *(undefined8 *)puVar19;
      piVar25 = (int *)((longlong)piVar25 + 1);
      puVar3 = *(undefined8 **)(*(longlong *)(piVar12 + 6) + -8 + (longlong)piVar25 * 8);
      puVar19 = puVar19 + 4;
      *puVar3 = *(undefined8 *)puVar1;
      puVar3[1] = uVar4;
    } while ((longlong)piVar25 < (longlong)iVar15);
  }
  FUN_18001d45c(piVar6);
  return piVar12;
}



undefined8 FUN_1800150b0(longlong param_1,int param_2,int param_3,int *param_4,int *param_5)

{
  longlong lVar1;
  longlong lVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  longlong lVar9;
  int iVar10;
  uint uVar11;
  longlong lVar12;
  
  lVar9 = (longlong)param_3;
  lVar12 = (longlong)param_2;
  lVar1 = *(longlong *)(param_1 + lVar12 * 8);
  lVar2 = *(longlong *)(param_1 + -8 + lVar12 * 8);
  lVar12 = *(longlong *)(param_1 + 8 + lVar12 * 8);
  iVar3 = *(int *)(lVar1 + -4 + lVar9 * 4);
  iVar4 = *(int *)(lVar2 + lVar9 * 4);
  iVar5 = *(int *)(lVar1 + lVar9 * 4);
  iVar6 = iVar3 + iVar5 * -2 + *(int *)(lVar1 + 4 + lVar9 * 4);
  iVar3 = ((*(int *)(lVar1 + 4 + lVar9 * 4) - iVar3) + 1) / 2;
  iVar10 = iVar4 + iVar5 * -2 + *(int *)(lVar12 + lVar9 * 4);
  iVar4 = ((*(int *)(lVar12 + lVar9 * 4) - iVar4) + 1) / 2;
  iVar5 = *(int *)(lVar2 + -4 + lVar9 * 4) + 2 +
          ((*(int *)(lVar12 + 4 + lVar9 * 4) - *(int *)(lVar2 + 4 + lVar9 * 4)) -
          *(int *)(lVar12 + -4 + lVar9 * 4));
  iVar5 = (int)(iVar5 + (iVar5 >> 0x1f & 3U)) >> 2;
  uVar8 = iVar5 * iVar5 - iVar10 * iVar6;
  if (uVar8 != 0) {
    uVar11 = iVar10 * iVar3 - iVar5 * iVar4;
    uVar7 = iVar6 * iVar4 - iVar5 * iVar3;
    iVar3 = (uVar8 ^ (int)uVar8 >> 0x1f) - ((int)uVar8 >> 0x1f);
    if (((int)((uVar11 ^ (int)uVar11 >> 0x1f) - ((int)uVar11 >> 0x1f)) <= iVar3) &&
       ((int)((uVar7 ^ (int)uVar7 >> 0x1f) - ((int)uVar7 >> 0x1f)) <= iVar3)) {
      iVar3 = (int)uVar8 >> 0x10;
      if (iVar3 != 0) {
        *param_4 = (int)(iVar3 / 2 + uVar11) / iVar3;
        *param_5 = (int)(iVar3 / 2 + uVar7) / iVar3;
        return 1;
      }
      *param_5 = 0;
      *param_4 = 0;
      return 1;
    }
  }
  return 0;
}



void FUN_1800151f0(int *param_1,longlong param_2)

{
  int iVar1;
  LPVOID pvVar2;
  undefined8 uVar3;
  int iVar4;
  ulonglong uVar5;
  uint uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  int local_res8 [2];
  int local_res10 [2];
  longlong local_res18;
  longlong local_res20;
  
  local_res20 = *(longlong *)(param_2 + 0x30);
  uVar5 = 0;
  iVar4 = 0;
  if (*param_1 != 0) {
    pvVar2 = FUN_18001ed60((longlong)*param_1 << 2);
    *(LPVOID *)(param_2 + 0x48) = pvVar2;
    pvVar2 = FUN_18001ed60((longlong)*param_1 << 2);
    *(LPVOID *)(param_2 + 0x50) = pvVar2;
    if (0 < *param_1) {
      local_res18 = 0;
      uVar7 = uVar5;
      uVar8 = uVar5;
      uVar10 = uVar5;
      do {
        iVar4 = **(int **)(uVar7 + *(longlong *)(param_1 + 6));
        iVar1 = (*(int **)(uVar7 + *(longlong *)(param_1 + 6)))[1];
        uVar3 = FUN_1800150b0(*(longlong *)(local_res20 + 8),iVar1,iVar4,local_res8,local_res10);
        uVar9 = uVar8;
        if ((int)uVar3 != 0) {
          *(int *)(local_res18 + *(longlong *)(param_2 + 0x48)) = iVar4 * 0x10000 + local_res8[0];
          *(int *)(local_res18 + *(longlong *)(param_2 + 0x50)) = iVar1 * 0x10000 + local_res10[0];
          uVar10 = (ulonglong)((int)uVar10 + 1);
          *(undefined2 *)(*(longlong *)(uVar8 + *(longlong *)(param_1 + 6)) + 0xe) = 0;
          uVar9 = uVar8 + 8;
          *(undefined4 *)(*(longlong *)(uVar8 + *(longlong *)(param_1 + 6)) + 8) =
               *(undefined4 *)(*(longlong *)(uVar7 + *(longlong *)(param_1 + 6)) + 8);
          *(undefined1 *)(*(longlong *)(uVar8 + *(longlong *)(param_1 + 6)) + 0xc) =
               *(undefined1 *)(*(longlong *)(uVar7 + *(longlong *)(param_1 + 6)) + 0xc);
          local_res18 = local_res18 + 4;
        }
        iVar4 = (int)uVar10;
        uVar6 = (int)uVar5 + 1;
        uVar5 = (ulonglong)uVar6;
        uVar7 = uVar7 + 8;
        uVar8 = uVar9;
      } while ((int)uVar6 < *param_1);
    }
    *param_1 = iVar4;
  }
  return;
}



int FUN_180015360(uint param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  
  uVar3 = (param_2 ^ (int)param_2 >> 0x1f) - ((int)param_2 >> 0x1f);
  uVar2 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  if (uVar3 == 0) {
    iVar1 = 0x10e;
    if (0 < (int)param_1) {
      iVar1 = 0x5a;
    }
    return iVar1;
  }
  if (uVar2 == 0) {
    iVar1 = 0xb4;
    if (0 < (int)param_2) {
      iVar1 = 0;
    }
    return iVar1;
  }
  if (uVar3 < uVar2) {
    uVar2 = 0x2d0 - *(ushort *)
                     (&DAT_180040320 +
                     ((ulonglong)((uVar2 >> 1) + uVar3 * 0x80) / (ulonglong)uVar2) * 2);
  }
  else {
    uVar2 = (uint)*(ushort *)
                   (&DAT_180040320 +
                   ((ulonglong)((uVar3 >> 1) + uVar2 * 0x80) / (ulonglong)uVar3) * 2);
  }
  if ((int)param_2 < 1) {
    iVar1 = 0x5a0;
    if ((int)param_1 < 0) {
      return (int)(uVar2 + 0x5a4) >> 3;
    }
  }
  else {
    if (-1 < (int)param_1) goto LAB_180015410;
    if ((int)uVar2 < 5) {
      return 0;
    }
    iVar1 = 0xb40;
  }
  uVar2 = iVar1 - uVar2;
LAB_180015410:
  return (int)(uVar2 + 4) >> 3;
}



void FUN_180015430(short *param_1,longlong *param_2,int param_3,longlong param_4,uint param_5,
                  longlong param_6)

{
  undefined8 *puVar1;
  int *piVar2;
  longlong lVar3;
  longlong lVar4;
  short sVar5;
  ushort uVar6;
  uint uVar7;
  undefined8 *puVar8;
  uint uVar9;
  int iVar10;
  longlong lVar11;
  uint uVar12;
  int iVar13;
  short sVar14;
  uint uVar15;
  int iVar16;
  short sVar17;
  longlong lVar18;
  uint uVar19;
  uint uVar20;
  short sVar21;
  short sVar22;
  longlong lVar23;
  uint auStack_20428 [124];
  uint auStack_20238 [32620];
  undefined1 auStack_488 [36];
  int local_464;
  uint local_460;
  uint local_45c;
  uint local_458;
  longlong local_450;
  short *local_448;
  longlong local_440;
  longlong local_438;
  uint auStack_428 [124];
  uint auStack_238 [124];
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStack_488;
  sVar14 = (short)param_3;
  sVar21 = *param_1;
  lVar18 = 0;
  lVar23 = *(longlong *)(*param_2 + 8);
  lVar11 = *(longlong *)(param_2[1] + 8);
  iVar13 = param_3 * 5 + (int)param_1[2];
  local_45c = 0;
  local_458 = *(int *)(param_6 + 0x34) * *(int *)(param_6 + 0x34);
  local_464 = -1;
  uVar15 = param_5 & 0xff;
  sVar22 = 0;
  sVar17 = param_1[2] + sVar14 * -5;
  local_450 = lVar11;
  local_448 = param_1;
  local_440 = param_4;
  local_438 = lVar23;
  if (sVar17 <= iVar13) {
    local_460 = uVar15;
    do {
      lVar3 = *(longlong *)(lVar11 + (longlong)sVar17 * 8);
      lVar4 = *(longlong *)(lVar23 + (longlong)sVar17 * 8);
      uVar7 = (uint)(short)(sVar21 + sVar14 * -5);
      uVar15 = local_460;
      uVar9 = uVar7;
      while (local_460 = uVar15, (int)uVar9 <= (int)sVar21 + param_3 * 5) {
        sVar5 = (short)uVar7;
        uVar6 = sVar5 + sVar14;
        uVar7 = (uint)uVar6;
        lVar23 = (longlong)sVar5 * 4;
        lVar11 = (longlong)sVar22;
        sVar22 = sVar22 + 1;
        auStack_238[lVar11] = *(int *)(lVar23 + lVar4) * *(int *)(&DAT_180040130 + lVar11 * 4);
        auStack_428[lVar11] = *(int *)(lVar23 + lVar3) * *(int *)(&DAT_180040130 + lVar11 * 4);
        lVar11 = local_450;
        lVar23 = local_438;
        uVar15 = local_460;
        uVar9 = (uint)(short)uVar6;
      }
      sVar17 = sVar17 + sVar14;
    } while (sVar17 <= iVar13);
  }
  param_5._0_1_ = (byte)(param_5 >> 0x10);
  local_460 = 0x168 >> ((byte)param_5 & 0x1f);
  iVar16 = (int)uVar15 >> ((byte)param_5 & 0x1f);
  iVar13 = iVar16 + local_460;
  puVar8 = (undefined8 *)FUN_18001ee18((longlong)(iVar13 * 2),4);
  lVar23 = 0x79;
  puVar1 = (undefined8 *)((longlong)puVar8 + (longlong)iVar13 * 4);
  do {
    uVar15 = *(uint *)((longlong)auStack_238 + lVar18);
    if ((uVar15 != 0) || (*(int *)((longlong)auStack_428 + lVar18) != 0)) {
      uVar7 = *(uint *)((longlong)auStack_428 + lVar18);
      iVar13 = FUN_180015360(uVar7,uVar15);
      lVar11 = (longlong)(short)(iVar13 >> ((byte)param_5 & 0x1f));
      piVar2 = (int *)((longlong)puVar8 + lVar11 * 4);
      *piVar2 = *piVar2 + uVar15;
      piVar2 = (int *)((longlong)puVar1 + lVar11 * 4);
      *piVar2 = *piVar2 + uVar7;
    }
    uVar15 = local_460;
    lVar18 = lVar18 + 4;
    lVar23 = lVar23 + -1;
  } while (lVar23 != 0);
  lVar23 = (longlong)(int)local_460;
  FUN_18001d560((undefined8 *)(lVar23 * 4 + (longlong)puVar8),puVar8,(longlong)iVar16 << 2);
  FUN_18001d560((undefined8 *)(lVar23 * 4 + (longlong)puVar1),puVar1,(longlong)iVar16 << 2);
  uVar7 = 0;
  uVar19 = 0;
  uVar20 = 0;
  sVar21 = 1 - (short)iVar16;
  uVar9 = 0;
  if (0 < (int)(uVar15 + iVar16)) {
    sVar14 = (short)iVar16 + -1 + sVar21;
    uVar9 = 0;
    do {
      uVar20 = uVar20 + *(int *)((longlong)puVar8 + (longlong)sVar14 * 4);
      uVar19 = uVar19 + *(int *)((longlong)puVar1 + (longlong)sVar14 * 4);
      if (-1 < sVar21) {
        iVar13 = -0x1000;
        if (-1 < (int)uVar20) {
          iVar13 = 0x1000;
        }
        iVar10 = (int)(((int)(iVar13 + uVar20) >> 0x1f & 0x1fffU) + iVar13 + uVar20) >> 0xd;
        iVar13 = -0x1000;
        if (-1 < (int)uVar19) {
          iVar13 = 0x1000;
        }
        iVar13 = (int)(((int)(iVar13 + uVar19) >> 0x1f & 0x1fffU) + iVar13 + uVar19) >> 0xd;
        uVar12 = iVar13 * iVar13 + iVar10 * iVar10;
        if (local_440 != 0) {
          lVar23 = (longlong)sVar21;
          *(uint *)(local_440 + lVar23 * 0xc) = uVar20;
          *(uint *)(local_440 + 4 + lVar23 * 0xc) = uVar19;
          *(uint *)(local_440 + 8 + lVar23 * 0xc) = uVar12;
        }
        if (uVar9 < uVar12) {
          local_464 = (int)sVar21;
          uVar7 = uVar20;
          uVar9 = uVar12;
          local_45c = uVar19;
        }
        uVar20 = uVar20 - *(int *)((longlong)puVar8 + (longlong)sVar21 * 4);
        uVar19 = uVar19 - *(int *)((longlong)puVar1 + (longlong)sVar21 * 4);
      }
      sVar14 = sVar14 + 1;
      sVar21 = sVar21 + 1;
    } while ((int)sVar14 < (int)(uVar15 + iVar16));
  }
  FUN_18001d45c(puVar8);
  if ((((int)local_458 < 1) || (local_458 <= uVar9)) && ((uVar7 != 0 || (local_45c != 0)))) {
    iVar13 = FUN_180015360(local_45c,uVar7);
    sVar21 = (short)iVar13;
  }
  else {
    sVar21 = -1;
  }
  local_448[7] = sVar21;
  FUN_18001d530(local_48 ^ (ulonglong)auStack_488);
  return;
}



undefined8
FUN_180015770(longlong param_1,int param_2,int param_3,int param_4,int param_5,int param_6,
             undefined8 *param_7,longlong param_8)

{
  longlong lVar1;
  int iVar2;
  int *piVar3;
  longlong lVar4;
  longlong lVar5;
  int iVar6;
  ulonglong uVar7;
  longlong lVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  ulonglong uVar17;
  int iVar18;
  int iVar19;
  longlong lVar20;
  int iVar21;
  int iVar22;
  int iVar23;
  int iVar24;
  int iVar25;
  int iVar26;
  int iVar27;
  int *local_68;
  longlong local_60;
  
  iVar2 = *(int *)(param_8 + 0x10);
  lVar20 = (longlong)*(int *)(param_8 + 0xc);
  piVar3 = (int *)*param_7;
  iVar21 = -iVar2;
  if (iVar21 < iVar2) {
    lVar4 = param_7[1];
    lVar5 = param_7[2];
    lVar8 = 0;
    iVar14 = iVar21 * param_6;
    iVar12 = iVar21 * param_5;
    local_60 = 0;
    iVar24 = iVar21;
    do {
      if (iVar21 < iVar2) {
        local_68 = (int *)(param_1 + 8 + lVar8 * 4);
        iVar9 = iVar21 * param_5 + iVar14 + param_4;
        iVar18 = (iVar12 - iVar21 * param_6) + param_3;
        iVar16 = iVar21;
        iVar22 = iVar21;
        do {
          iVar22 = iVar22 + param_2;
          iVar26 = 0;
          iVar13 = 0;
          iVar27 = 0;
          iVar15 = 0;
          if (iVar24 + param_2 <= iVar24) {
            return 0xffffffff;
          }
          uVar7 = (ulonglong)(uint)((iVar24 + param_2) - iVar24);
          iVar11 = iVar9;
          iVar19 = iVar18;
          do {
            if (iVar16 < iVar22) {
              uVar17 = (ulonglong)(uint)(iVar22 - iVar16);
              iVar23 = iVar11;
              iVar25 = iVar19;
              do {
                iVar6 = (int)((0 < iVar23) + 0x7fff + iVar23) >> 0x10;
                iVar10 = (int)((0 < iVar25) + 0x7fff + iVar25) >> 0x10;
                if ((((-1 < iVar10) && (-1 < iVar6)) && (iVar10 < *piVar3)) && (iVar6 < piVar3[1]))
                {
                  lVar8 = (longlong)iVar10 * 4;
                  lVar1 = (longlong)iVar6 * 8;
                  iVar26 = iVar26 + *(int *)(*(longlong *)
                                              (*(longlong *)(piVar3 + 2) + (longlong)iVar6 * 8) +
                                            lVar8);
                  if (1 < lVar20) {
                    iVar6 = *(int *)(lVar8 + *(longlong *)(*(longlong *)(lVar4 + 8) + lVar1));
                    iVar10 = *(int *)(lVar8 + *(longlong *)(*(longlong *)(lVar5 + 8) + lVar1));
                    if (lVar20 == 2) {
                      iVar13 = iVar13 + iVar6 * iVar6 + iVar10 * iVar10;
                    }
                    else {
                      iVar13 = iVar13 + iVar6;
                      iVar27 = iVar27 + iVar10;
                    }
                  }
                  iVar15 = iVar15 + 1;
                }
                iVar23 = iVar23 + param_5;
                iVar25 = iVar25 - param_6;
                uVar17 = uVar17 - 1;
              } while (uVar17 != 0);
            }
            iVar11 = iVar11 + param_6;
            iVar19 = iVar19 + param_5;
            uVar7 = uVar7 - 1;
          } while (uVar7 != 0);
          if (iVar15 < 0xc) {
            return 0xffffffff;
          }
          if (lVar20 == 3) {
            iVar19 = (int)((0 < iVar13) + 7 + iVar13) >> 4;
            iVar11 = (int)((0 < iVar27) + 7 + iVar27) >> 4;
            iVar27 = iVar11 * param_6;
            iVar13 = iVar19 * param_5;
            iVar19 = iVar19 * param_6;
            iVar11 = iVar11 * param_5;
            iVar13 = (int)((0 < iVar13 + iVar27) + 0x7ff + iVar13 + iVar27) >> 0xc;
            iVar27 = (int)((((0 < iVar11 - iVar19) + 0x7ff) - iVar19) + iVar11) >> 0xc;
          }
          local_68[-2] = iVar26 / iVar15;
          if (1 < lVar20) {
            local_68[-1] = iVar13 / iVar15;
          }
          if (2 < lVar20) {
            *local_68 = iVar27 / iVar15;
          }
          iVar9 = iVar9 + param_2 * param_5;
          iVar18 = iVar18 - param_2 * param_6;
          iVar16 = iVar16 + param_2;
          local_68 = local_68 + lVar20;
          lVar8 = local_60 + lVar20;
          local_60 = lVar8;
        } while (iVar16 < iVar2);
      }
      iVar24 = iVar24 + param_2;
      iVar14 = iVar14 + param_2 * param_6;
      iVar12 = iVar12 + param_2 * param_5;
    } while (iVar24 < iVar2);
  }
  return 1;
}



void FUN_180015b70(longlong param_1,undefined8 *param_2,int param_3,int param_4,longlong param_5)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  byte bVar4;
  undefined8 uVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  longlong lVar10;
  int *piVar11;
  longlong lVar12;
  int *piVar13;
  longlong lVar14;
  longlong lVar15;
  longlong lVar16;
  longlong lVar17;
  int *piVar18;
  undefined1 auStackY_1a8 [32];
  int local_168;
  longlong local_150;
  int local_128 [4];
  int local_118 [48];
  ulonglong local_58;
  
  local_58 = DAT_1800461a0 ^ (ulonglong)auStackY_1a8;
  iVar9 = 0;
  iVar2 = *(int *)(&DAT_18003f060 + (longlong)*(short *)(param_1 + 0xe) * 4);
  iVar3 = *(int *)(&DAT_18003eac0 + (longlong)*(short *)(param_1 + 0xe) * 4);
  local_128[0] = 0x4000;
  local_128[1] = 0x2aab;
  local_128[2] = 0x2000;
  local_150 = 0;
  local_168 = 2;
  do {
    iVar7 = local_128[local_150] * *(int *)(param_5 + 0x10);
    iVar8 = iVar7 >> 0xe;
    if (iVar8 << 0xe < iVar7) {
      iVar8 = iVar8 + 1;
    }
    uVar5 = FUN_180015770((longlong)local_118,iVar8,param_3,param_4,iVar2,iVar3,param_2,param_5);
    if ((int)uVar5 < 1) {
      *(undefined2 *)(param_1 + 0xe) = 0xffff;
      break;
    }
    lVar16 = (longlong)*(int *)(param_5 + 0xc);
    lVar10 = (longlong)(local_168 * local_168);
    if (0 < lVar16) {
      piVar18 = local_118;
      lVar15 = lVar16;
      do {
        if (0 < lVar10) {
          lVar14 = 1;
          piVar11 = piVar18;
          lVar17 = lVar10;
          do {
            iVar7 = *piVar11;
            if (lVar14 < lVar10) {
              lVar6 = lVar10 - lVar14;
              piVar13 = piVar11;
              do {
                piVar13 = piVar13 + lVar16;
                lVar12 = (longlong)iVar9;
                bVar4 = (byte)iVar9;
                iVar9 = iVar9 + 1;
                pbVar1 = (byte *)((lVar12 >> 3) + 0x10 + param_1);
                *pbVar1 = *pbVar1 | (*piVar13 < iVar7) << (bVar4 & 7);
                lVar6 = lVar6 + -1;
              } while (lVar6 != 0);
            }
            piVar11 = piVar11 + lVar16;
            lVar14 = lVar14 + 1;
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
        }
        piVar18 = piVar18 + 1;
        lVar15 = lVar15 + -1;
      } while (lVar15 != 0);
    }
    local_150 = local_150 + 1;
    local_168 = local_168 + 1;
  } while (local_150 < 3);
  FUN_18001d530(local_58 ^ (ulonglong)auStackY_1a8);
  return;
}



void FUN_180015d70(int *param_1,longlong *param_2,longlong param_3)

{
  int iVar1;
  undefined8 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  LPVOID pvVar6;
  longlong lVar7;
  uint *puVar8;
  undefined8 *puVar9;
  uint uVar10;
  LPVOID pvVar11;
  undefined8 *puVar12;
  uint uVar13;
  int *piVar15;
  longlong lVar16;
  longlong lVar17;
  undefined4 *puVar18;
  int iVar19;
  uint uVar20;
  short sVar21;
  int iVar22;
  LPVOID pvVar24;
  int iVar25;
  int local_res8;
  int local_res10;
  int local_res20;
  int local_94;
  longlong local_88;
  longlong local_68;
  longlong local_60;
  longlong local_58;
  LPVOID pvVar14;
  LPVOID pvVar23;
  
  pvVar14 = (LPVOID)0x0;
  iVar25 = 0;
  piVar15 = (int *)**(undefined8 **)(param_1 + 6);
  local_68 = param_2[5];
  local_60 = *param_2;
  local_58 = param_2[1];
  iVar22 = 2;
  if (*(int *)(param_3 + 0x10) < 7) {
    iVar22 = 1;
  }
  uVar10 = 0;
  uVar13 = *(int *)(param_3 + 0x3c) / 10;
  iVar19 = *(int *)(param_3 + 0x3c) % 10;
  if (uVar13 == 0) {
    uVar13 = 0x40;
  }
  pvVar6 = pvVar14;
  for (iVar3 = iVar19; 1 < iVar3; iVar3 = iVar3 >> 1) {
    uVar10 = (int)pvVar6 + 1;
    pvVar6 = (LPVOID)(ulonglong)uVar10;
  }
  if (*(int *)(param_3 + 0x38) == 0) {
    local_res10 = (int)param_2;
    local_res20 = local_res10;
    pvVar6 = pvVar14;
    iVar3 = local_res10;
  }
  else {
    local_res20 = (int)(uVar13 + 0x168) / iVar19;
    pvVar6 = FUN_18001ed60((longlong)local_res20 * 0xc);
    local_res10 = *param_1;
    iVar3 = local_res10 * 3;
  }
  local_94 = 0;
  if (0 < *param_1) {
    local_88 = (longlong)local_res10;
    pvVar24 = pvVar14;
    local_res8 = local_res10;
    do {
      *piVar15 = (int)((uint)(0 < *(int *)((longlong)pvVar24 + param_2[9])) +
                      *(int *)((longlong)pvVar24 + param_2[9]) + 0x7fff) >> 0x10;
      piVar15[1] = (int)((uint)(0 < *(int *)((longlong)pvVar24 + param_2[10])) +
                        *(int *)((longlong)pvVar24 + param_2[10]) + 0x7fff) >> 0x10;
      iVar4 = FUN_180015430((short *)piVar15,param_2,iVar22,(longlong)pvVar6,
                            iVar19 * 0x100 | uVar13 | uVar10 << 0x10,param_3);
      lVar16 = (longlong)iVar4;
      if (-1 < *(short *)((longlong)piVar15 + 0xe)) {
        FUN_180015b70((longlong)piVar15,&local_68,*(int *)((longlong)pvVar24 + param_2[9]),
                      *(int *)((longlong)pvVar24 + param_2[10]),param_3);
        iVar4 = *(int *)(param_3 + 0x38);
        if ((iVar4 != 0) && (local_88 < iVar3)) {
          lVar17 = (longlong)local_res20;
          iVar1 = *(int *)((longlong)pvVar6 + lVar16 * 0xc + 8);
          do {
            pvVar23 = (LPVOID)0xffffffff;
            sVar21 = -1;
            lVar7 = 0x41;
            lVar16 = (longlong)((int)(short)lVar16 - (int)(0x20 / (longlong)iVar19));
            puVar18 = (undefined4 *)((longlong)pvVar6 + lVar16 * 0xc + 8);
            do {
              if (lVar16 < 0) {
                lVar16 = lVar16 + lVar17;
                puVar18 = puVar18 + lVar17 * 3;
              }
              if (lVar17 <= lVar16) {
                lVar16 = lVar16 - lVar17;
                puVar18 = puVar18 + lVar17 * -3;
              }
              *puVar18 = 0;
              puVar18 = puVar18 + 3;
              lVar16 = lVar16 + 1;
              lVar7 = lVar7 + -1;
            } while (lVar7 != 0);
            if (0 < lVar17) {
              puVar8 = (uint *)((longlong)pvVar6 + 8);
              pvVar11 = pvVar14;
              lVar16 = lVar17;
              uVar20 = (uint)(iVar1 * iVar4) >> 10;
              do {
                if (uVar20 <= *puVar8) {
                  pvVar23 = pvVar11;
                  uVar20 = *puVar8;
                }
                sVar21 = (short)pvVar23;
                pvVar11 = (LPVOID)(ulonglong)((int)pvVar11 + 1);
                puVar8 = puVar8 + 3;
                lVar16 = lVar16 + -1;
              } while (lVar16 != 0);
            }
            lVar16 = (longlong)sVar21;
            if (sVar21 < 0) break;
            local_res8 = local_res8 + 1;
            puVar9 = *(undefined8 **)(*(longlong *)(param_1 + 6) + local_88 * 8);
            local_88 = local_88 + 1;
            uVar2 = *(undefined8 *)(piVar15 + 2);
            puVar8 = (uint *)((longlong)pvVar6 + lVar16 * 0xc);
            *puVar9 = *(undefined8 *)piVar15;
            puVar9[1] = uVar2;
            iVar5 = FUN_180015360(puVar8[1],*puVar8);
            *(short *)((longlong)puVar9 + 0xe) = (short)iVar5;
            FUN_180015b70((longlong)puVar9,&local_68,*(int *)((longlong)pvVar24 + param_2[9]),
                          *(int *)((longlong)pvVar24 + param_2[10]),param_3);
          } while (local_88 != iVar3);
        }
      }
      local_94 = local_94 + 1;
      piVar15 = piVar15 + 0x14;
      pvVar24 = (LPVOID)((longlong)pvVar24 + 4);
      local_res10 = local_res8;
    } while (local_94 < *param_1);
  }
  if (pvVar6 != (LPVOID)0x0) {
    *param_1 = local_res10;
    FUN_18001d45c(pvVar6);
  }
  puVar9 = (undefined8 *)**(undefined8 **)(param_1 + 6);
  puVar12 = puVar9;
  pvVar6 = pvVar14;
  if (0 < *param_1) {
    do {
      if (*(short *)((longlong)puVar9 + 0xe) < 0) {
        pvVar6 = (LPVOID)(ulonglong)((int)pvVar6 + 1);
      }
      else {
        if (puVar12 != puVar9) {
          uVar2 = puVar9[1];
          *puVar12 = *puVar9;
          puVar12[1] = uVar2;
          uVar2 = puVar9[3];
          puVar12[2] = puVar9[2];
          puVar12[3] = uVar2;
          uVar2 = puVar9[5];
          puVar12[4] = puVar9[4];
          puVar12[5] = uVar2;
          uVar2 = puVar9[7];
          puVar12[6] = puVar9[6];
          puVar12[7] = uVar2;
          uVar2 = puVar9[9];
          puVar12[8] = puVar9[8];
          puVar12[9] = uVar2;
        }
        puVar12 = puVar12 + 10;
      }
      iVar25 = (int)pvVar6;
      uVar13 = (int)pvVar14 + 1;
      pvVar14 = (LPVOID)(ulonglong)uVar13;
      puVar9 = puVar9 + 10;
    } while ((int)uVar13 < *param_1);
  }
  *param_1 = *param_1 - iVar25;
  return;
}



int * FUN_1800161b0(longlong *param_1,int *param_2)

{
  undefined8 uVar1;
  int *piVar2;
  
  uVar1 = FUN_180014bd0(param_1,param_2);
  if ((int)uVar1 != 0) {
    return (int *)0x0;
  }
  piVar2 = FUN_180014d60((longlong)param_1,(longlong)param_2);
  if (piVar2 == (int *)0x0) {
    return (int *)0x0;
  }
  FUN_1800151f0(piVar2,(longlong)param_1);
  if ((LPVOID)param_1[6] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[6]);
  }
  param_1[6] = 0;
  FUN_180015d70(piVar2,param_1,(longlong)param_2);
  if ((LPVOID)param_1[9] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[9]);
  }
  if ((LPVOID)param_1[10] != (LPVOID)0x0) {
    FUN_18001d45c((LPVOID)param_1[10]);
  }
  return piVar2;
}



undefined8
FUN_180016260(longlong *param_1,int param_2,uint param_3,undefined8 *param_4,int *param_5)

{
  int iVar1;
  int *piVar2;
  undefined1 uVar3;
  int iVar4;
  ulonglong *puVar5;
  longlong *plVar6;
  ulonglong uVar7;
  longlong *plVar8;
  int *piVar9;
  undefined1 *puVar10;
  int *piVar11;
  undefined8 uVar12;
  uint uVar13;
  uint uVar14;
  
  uVar3 = 0x80;
  if (param_5[0xb] == 1) {
    FUN_180012ef0(param_1,param_2,param_3);
  }
  else if (param_5[0xb] == 2) {
    FUN_180012820(param_1,param_2,param_3);
  }
  iVar4 = param_5[5] * param_2;
  uVar14 = (int)((uint)(0 < iVar4) + iVar4 + 0x1ff) >> 10;
  iVar4 = param_5[5] * param_3;
  uVar13 = (int)((uint)(0 < iVar4) + iVar4 + 0x1ff) >> 10;
  puVar5 = (ulonglong *)FUN_180011900((longlong)param_1,param_2,param_3,uVar14,uVar13);
  if (param_5[0x27] != 0) {
    FUN_18001d45c(param_1);
  }
  plVar6 = (longlong *)FUN_1800076f0(uVar14,uVar13);
  iVar4 = param_5[6];
  if (iVar4 < 1) {
    FUN_18001dbc0((undefined1 (*) [16])*plVar6,0,(longlong)(int)(uVar13 * uVar14));
  }
  else if (iVar4 == 1) {
    uVar3 = FUN_1800120b0(puVar5,uVar14,uVar13,plVar6);
  }
  else if (iVar4 == 2) {
    uVar7 = FUN_1800122c0((longlong *)puVar5,uVar14,uVar13,plVar6);
    uVar3 = (undefined1)uVar7;
  }
  if (param_5[7] == 1) {
    FUN_180011880(puVar5,uVar14,uVar13);
  }
  else if (param_5[7] == 2) {
    FUN_180011bc0(puVar5,uVar14,uVar13);
  }
  plVar8 = (longlong *)FUN_18001ee18(1,0x58);
  *(uint *)(plVar8 + 8) = uVar14;
  *(uint *)((longlong)plVar8 + 0x44) = uVar13;
  plVar8[7] = (longlong)plVar6;
  piVar9 = FUN_18000f3c0(uVar14,uVar13);
  FUN_180013690(**(ulonglong **)(piVar9 + 2),*puVar5,uVar13 * uVar14);
  plVar8[5] = (longlong)piVar9;
  FUN_18001d45c(puVar5);
  FUN_180014750((longlong)plVar8,param_5);
  piVar9 = FUN_1800161b0(plVar8,param_5);
  if (param_4 != (undefined8 *)0x0) {
    *param_4 = piVar9;
  }
  if (piVar9 != (int *)0x0) {
    *(short *)(piVar9 + 1) = (short)uVar14;
    *(short *)((longlong)piVar9 + 6) = (short)uVar13;
    iVar4 = param_5[3];
    *(undefined1 *)((longlong)piVar9 + 9) = uVar3;
    *(undefined1 *)((longlong)piVar9 + 10) = 0;
    *(char *)(piVar9 + 2) = (char)iVar4;
    if (param_5[2] != 0) {
      puVar10 = (undefined1 *)FUN_18001ed60((longlong)(int)(uVar13 * uVar14));
      iVar4 = 0;
      *(undefined1 **)(piVar9 + 4) = puVar10;
      piVar2 = (int *)plVar8[5];
      piVar11 = (int *)**(undefined8 **)(piVar2 + 2);
      if (0 < piVar2[1] * *piVar2) {
        do {
          iVar1 = *piVar11;
          iVar4 = iVar4 + 1;
          piVar11 = piVar11 + 1;
          *puVar10 = (char)((uint)(iVar1 * 0x7f8 + 0x8000) >> 0x10);
          puVar10 = puVar10 + 1;
        } while (iVar4 < piVar2[1] * *piVar2);
      }
    }
    if (*(longlong *)(param_5 + 0x28) != 0) {
      piVar11 = FUN_18000f670((int *)plVar8[5]);
      **(undefined8 **)(param_5 + 0x28) = piVar11;
      piVar11 = FUN_18000f670((int *)*plVar8);
      *(int **)(*(longlong *)(param_5 + 0x28) + 8) = piVar11;
      piVar11 = FUN_18000f670((int *)plVar8[1]);
      *(int **)(*(longlong *)(param_5 + 0x28) + 0x10) = piVar11;
    }
  }
  FUN_180013600(plVar8);
  uVar12 = 0xfffffc18;
  if (piVar9 != (int *)0x0) {
    uVar12 = 0;
  }
  return uVar12;
}



int FUN_180016510(longlong param_1,longlong param_2,uint param_3)

{
  int iVar1;
  longlong lVar2;
  uint uVar3;
  longlong lVar4;
  int *piVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  undefined1 auVar13 [16];
  int iVar18;
  int iVar19;
  
  iVar9 = 0;
  iVar8 = 0;
  lVar7 = (longlong)(int)param_3;
  iVar15 = 0;
  iVar10 = 0;
  iVar12 = iVar10;
  if (((0 < (int)param_3) && (iVar12 = 0, 7 < param_3)) && (1 < DAT_180046320)) {
    uVar3 = param_3 & 0x80000007;
    if ((int)uVar3 < 0) {
      uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
    }
    iVar11 = 0;
    iVar14 = 0;
    iVar16 = 0;
    iVar18 = 0;
    iVar12 = iVar11;
    iVar15 = iVar14;
    iVar17 = iVar16;
    iVar19 = iVar18;
    do {
      lVar4 = (longlong)iVar10;
      iVar1 = iVar10 + 4;
      iVar10 = iVar10 + 8;
      auVar13 = pmulld(*(undefined1 (*) [16])(param_1 + lVar4 * 4),
                       *(undefined1 (*) [16])(param_2 + lVar4 * 4));
      iVar11 = auVar13._0_4_ + iVar11;
      iVar14 = auVar13._4_4_ + iVar14;
      iVar16 = auVar13._8_4_ + iVar16;
      iVar18 = auVar13._12_4_ + iVar18;
      auVar13 = pmulld(*(undefined1 (*) [16])(param_1 + (longlong)iVar1 * 4),
                       *(undefined1 (*) [16])(param_2 + (longlong)iVar1 * 4));
      iVar12 = auVar13._0_4_ + iVar12;
      iVar15 = auVar13._4_4_ + iVar15;
      iVar17 = auVar13._8_4_ + iVar17;
      iVar19 = auVar13._12_4_ + iVar19;
    } while (iVar10 < (int)(param_3 - uVar3));
    iVar15 = iVar12 + iVar11 + iVar17 + iVar16 + iVar15 + iVar14 + iVar19 + iVar18;
    iVar12 = iVar10;
  }
  lVar4 = (longlong)iVar12;
  if (lVar4 < lVar7) {
    if (1 < lVar7 - lVar4) {
      lVar2 = lVar4 * 4;
      lVar6 = ((lVar7 - lVar4) - 2U >> 1) + 1;
      lVar4 = lVar4 + lVar6 * 2;
      piVar5 = (int *)(param_2 + 4 + lVar2);
      do {
        iVar9 = iVar9 + *(int *)((param_1 - param_2) + -4 + (longlong)piVar5) * piVar5[-1];
        iVar8 = iVar8 + *(int *)((param_1 - param_2) + -8 + (longlong)(piVar5 + 2)) * *piVar5;
        lVar6 = lVar6 + -1;
        piVar5 = piVar5 + 2;
      } while (lVar6 != 0);
    }
    if (lVar4 < lVar7) {
      iVar15 = iVar15 + *(int *)(param_1 + lVar4 * 4) * *(int *)(param_2 + lVar4 * 4);
    }
    iVar15 = iVar8 + iVar9 + iVar15;
  }
  return iVar15;
}



ulonglong FUN_180016680(uint *param_1)

{
  uint uVar1;
  byte bVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  longlong lVar6;
  longlong lVar7;
  longlong lVar8;
  ulonglong uVar9;
  int *piVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  int *piVar13;
  ulonglong uVar14;
  int iVar15;
  longlong lVar16;
  
  uVar1 = *param_1;
  piVar4 = (int *)FUN_18001ed60((longlong)(int)(uVar1 * 4));
  uVar11 = (ulonglong)(int)param_1[1];
  piVar5 = (int *)FUN_18001ee18(uVar11,4);
  uVar9 = (ulonglong)(int)*param_1;
  lVar8 = *(longlong *)(param_1 + 10);
  iVar15 = 0;
  lVar6 = *(longlong *)(param_1 + 0xc);
  lVar7 = lVar8;
  if (0 < (int)*param_1) {
    lVar6 = *(longlong *)(param_1 + 6);
    lVar7 = *(longlong *)(param_1 + 8);
    piVar13 = piVar4;
    do {
      iVar3 = *(int *)((longlong)piVar13 + (lVar7 - (longlong)piVar4));
      if (iVar3 < 0) {
        bVar2 = (byte)(iVar3 >> 0x1f);
        *piVar13 = *(int *)((lVar6 - (longlong)piVar4) + (longlong)piVar13) >>
                   (((byte)iVar3 ^ bVar2) - bVar2 & 0x1f);
      }
      else {
        *piVar13 = *(int *)((lVar6 - (longlong)piVar4) + (longlong)piVar13) << ((byte)iVar3 & 0x1f);
      }
      piVar13 = piVar13 + 1;
      uVar9 = uVar9 - 1;
    } while (uVar9 != 0);
    uVar9 = (ulonglong)*param_1;
    lVar6 = *(longlong *)(param_1 + 0xc);
    lVar7 = *(longlong *)(param_1 + 10);
  }
  lVar16 = (longlong)(int)param_1[4];
  if (0 < lVar16) {
    piVar13 = *(int **)(param_1 + 2);
    uVar12 = 1;
    lVar6 = lVar6 - (longlong)piVar13;
    uVar14 = 1;
    piVar10 = piVar5;
    do {
      iVar3 = FUN_180016510(lVar7 + (longlong)iVar15 * 4,(longlong)piVar4,(uint)uVar9);
      iVar3 = iVar3 - *(int *)(lVar6 + (longlong)piVar13);
      *piVar13 = iVar3;
      if (iVar3 < 1) {
        piVar5[uVar12] = piVar5[uVar12] + 1;
      }
      else {
        *piVar10 = *piVar10 + 1;
      }
      uVar12 = uVar12 + 1;
      if (uVar12 == uVar11) {
        piVar10 = piVar10 + 1;
        uVar12 = uVar14 + 1;
        uVar14 = uVar12;
      }
      uVar9 = (ulonglong)uVar1;
      piVar13 = piVar13 + 1;
      iVar15 = iVar15 + uVar1;
      lVar16 = lVar16 + -1;
      lVar7 = lVar8;
    } while (lVar16 != 0);
  }
  uVar9 = 0;
  uVar12 = 1;
  lVar8 = 1;
  uVar14 = uVar9;
  if (1 < (longlong)uVar11) {
    do {
      if (*(int *)(uVar14 + (longlong)piVar5) < piVar5[lVar8]) {
        uVar9 = uVar12;
        uVar14 = lVar8 * 4;
      }
      lVar8 = lVar8 + 1;
      uVar12 = (ulonglong)((int)uVar12 + 1);
    } while (lVar8 < (longlong)uVar11);
  }
  FUN_18001d45c(piVar5);
  FUN_18001d45c(piVar4);
  return uVar9;
}



undefined4 * FUN_180016850(void)

{
  undefined4 *puVar1;
  LPVOID pvVar2;
  LPVOID pvVar3;
  
  puVar1 = (undefined4 *)FUN_18001ed60(0x38);
  *puVar1 = 8;
  puVar1[1] = 6;
  puVar1[4] = 0xf;
  pvVar2 = FUN_18001ed60(0x3c);
  *(LPVOID *)(puVar1 + 2) = pvVar2;
  pvVar2 = FUN_18001ed60(0x20);
  *(LPVOID *)(puVar1 + 6) = pvVar2;
  pvVar3 = FUN_18001ed60(0x20);
  *(LPVOID *)(puVar1 + 8) = pvVar3;
  if ((pvVar2 != (LPVOID)0x0) && (pvVar3 != (LPVOID)0x0)) {
    return puVar1;
  }
  return (undefined4 *)0x0;
}



undefined8 FUN_1800168d0(void)

{
  return 0;
}



LPCRITICAL_SECTION FUN_1800168e0(LPCRITICAL_SECTION param_1,LPCWSTR param_2)

{
  int iVar1;
  HANDLE pvVar2;
  
  InitializeCriticalSection(param_1);
  *(undefined4 *)&param_1[1].OwningThread = 0;
  param_1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  pvVar2 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
  *(HANDLE *)&param_1[1].LockCount = pvVar2;
  pvVar2 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
  param_1[1].LockSemaphore = pvVar2;
  pvVar2 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
  param_1[2].OwningThread = (HANDLE)0x0;
  param_1[2].LockCount = 0;
  param_1[2].RecursionCount = 0;
  param_1[2].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  param_1[1].SpinCount = (ULONG_PTR)pvVar2;
  param_1[2].LockSemaphore = (HANDLE)0x0;
  iVar1 = lstrlenW(param_2);
  WideCharToMultiByte(0,0,param_2,iVar1 + 1,(LPSTR)&param_1[2].SpinCount,0x104,(LPCSTR)0x0,
                      (LPBOOL)0x0);
  iVar1 = lstrlenW(param_2);
  FUN_1800012f0("u",0xe,param_2,iVar1 * 2,(PUCHAR)&param_1[0xf].SpinCount);
  param_1[0x10].LockSemaphore = (HANDLE)0x0;
  param_1[0x10].SpinCount = 0;
  param_1[0x11].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  param_1[0x11].LockCount = 0;
  param_1[0x11].RecursionCount = 0;
  param_1[0x11].OwningThread = &param_1[0xf].SpinCount;
  param_1[0x11].LockSemaphore = &DAT_18002c560;
  return param_1;
}



void FUN_180016a10(LPCRITICAL_SECTION param_1)

{
  PRTL_CRITICAL_SECTION_DEBUG p_Var1;
  undefined8 uVar2;
  longlong lVar3;
  ULONG_PTR *pUVar4;
  HANDLE *ppvVar5;
  
  if (param_1[1].DebugInfo != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    *(undefined4 *)&param_1[1].OwningThread = 1;
    SetEvent(*(HANDLE *)&param_1[1].LockCount);
    WaitForSingleObject(param_1[1].DebugInfo,0xffffffff);
    CloseHandle(param_1[1].DebugInfo);
    param_1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  }
  CloseHandle(*(HANDLE *)&param_1[1].LockCount);
  DeleteCriticalSection(param_1);
  CloseHandle(param_1[1].LockSemaphore);
  CloseHandle((HANDLE)param_1[1].SpinCount);
  if (param_1[2].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    param_1[2].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)param_1[2].OwningThread;
  }
  else {
    **(undefined8 **)&param_1[2].LockCount = (PRTL_CRITICAL_SECTION_DEBUG)param_1[2].OwningThread;
  }
  p_Var1 = param_1[2].DebugInfo;
  while (p_Var1 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    p_Var1 = param_1[2].DebugInfo;
    uVar2._0_2_ = p_Var1->Type;
    uVar2._2_2_ = p_Var1->CreatorBackTraceIndex;
    uVar2._4_4_ = *(undefined4 *)&p_Var1->field_0x4;
    param_1[2].LockCount = (int)uVar2;
    param_1[2].RecursionCount = (int)((ulonglong)uVar2 >> 0x20);
    LocalFree(p_Var1);
    p_Var1 = *(PRTL_CRITICAL_SECTION_DEBUG *)&param_1[2].LockCount;
    param_1[2].DebugInfo = p_Var1;
  }
  pUVar4 = &param_1[0xf].SpinCount;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    *(undefined1 *)pUVar4 = 0;
    pUVar4 = (ULONG_PTR *)((longlong)pUVar4 + 1);
  }
  if (*(HLOCAL *)&param_1[0x11].LockCount != (HLOCAL)0x0) {
    FUN_180001b80(*(HLOCAL *)&param_1[0x11].LockCount);
  }
  ppvVar5 = &param_1[0x10].LockSemaphore;
  for (lVar3 = 0x30; lVar3 != 0; lVar3 = lVar3 + -1) {
    *(undefined1 *)ppvVar5 = 0;
    ppvVar5 = (HANDLE *)((longlong)ppvVar5 + 1);
  }
  return;
}



bool FUN_180016b00(longlong param_1,PUCHAR param_2,ULONG param_3,PUCHAR param_4,ULONG param_5,
                  ULONG *param_6)

{
  int *piVar1;
  bool bVar2;
  uint uVar3;
  
  piVar1 = *(int **)(param_1 + 0x18);
  uVar3 = FUN_180001b70((longlong)piVar1);
  if (param_3 + 0x42 <= uVar3 >> 3) {
    if ((param_4 != (PUCHAR)0x0) || (param_5 != 0)) {
      bVar2 = FUN_180001b90(piVar1,*(ULONG *)(param_1 + 0x10),param_2,param_3,param_4,param_5,
                            param_6);
      return bVar2;
    }
    if (param_6 != (ULONG *)0x0) {
      uVar3 = FUN_180001b70((longlong)piVar1);
      *param_6 = uVar3 >> 3;
      return true;
    }
  }
  return false;
}



void FUN_180016bb0(longlong *param_1)

{
  longlong lVar1;
  LPCRITICAL_SECTION p_Var2;
  
  if (*param_1 != 0) {
    PTR_FUN_180046018 = FUN_1800168d0;
    PTR_FUN_180046020 = FUN_1800168d0;
    lVar1 = *param_1;
    if (*(longlong *)(lVar1 + 0x28) != 0) {
      *(undefined4 *)(lVar1 + 0x38) = 1;
      SetEvent(*(HANDLE *)(lVar1 + 0x30));
      WaitForSingleObject(*(HANDLE *)(lVar1 + 0x28),0xffffffff);
      CloseHandle(*(HANDLE *)(lVar1 + 0x28));
      *(undefined8 *)(lVar1 + 0x28) = 0;
    }
    p_Var2 = (LPCRITICAL_SECTION)*param_1;
    if (p_Var2 != (LPCRITICAL_SECTION)0x0) {
      FUN_180016a10(p_Var2);
      thunk_FUN_18001d45c(p_Var2);
    }
    *param_1 = 0;
  }
  return;
}



void FUN_180016c50(longlong *param_1,LPCWSTR param_2)

{
  LPCRITICAL_SECTION p_Var1;
  LPCRITICAL_SECTION lpParameter;
  PRTL_CRITICAL_SECTION_DEBUG p_Var2;
  
  if (*param_1 == 0) {
    p_Var1 = (LPCRITICAL_SECTION)FUN_18001d1c0(0x2c8);
    lpParameter = (LPCRITICAL_SECTION)0x0;
    if (p_Var1 != (LPCRITICAL_SECTION)0x0) {
      lpParameter = FUN_1800168e0(p_Var1,param_2);
    }
    *param_1 = (longlong)lpParameter;
    if (lpParameter[1].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      ResetEvent(*(HANDLE *)&lpParameter[1].LockCount);
      *(undefined4 *)&lpParameter[1].OwningThread = 0;
      p_Var2 = (PRTL_CRITICAL_SECTION_DEBUG)
               CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_180017250,lpParameter,0,(LPDWORD)0x0);
      lpParameter[1].DebugInfo = p_Var2;
      if (p_Var2 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
        p_Var1 = (LPCRITICAL_SECTION)*param_1;
        if (p_Var1 != (LPCRITICAL_SECTION)0x0) {
          FUN_180016a10(p_Var1);
          thunk_FUN_18001d45c(p_Var1);
        }
        *param_1 = 0;
      }
    }
  }
  return;
}



bool FUN_180016d10(longlong param_1)

{
  LPBYTE lpData;
  bool bVar1;
  int iVar2;
  LSTATUS LVar3;
  BOOL BVar4;
  uint *puVar5;
  uint *hMem;
  undefined8 uVar6;
  LPBYTE pBVar7;
  char *lpString1;
  DWORD local_res8 [2];
  DWORD local_res10 [2];
  uint local_res18 [2];
  HKEY local_res20;
  
  bVar1 = true;
  local_res20 = (HKEY)0x0;
  iVar2 = RegOpenKeyExA((HKEY)0xffffffff80000002,(LPCSTR)(param_1 + 0x70),0,3,&local_res20);
  if (iVar2 == 5) {
    iVar2 = RegOpenKeyExA((HKEY)0xffffffff80000002,(LPCSTR)(param_1 + 0x70),0,1,&local_res20);
  }
  if (iVar2 != 0) goto LAB_180016ff7;
  local_res10[0] = 3;
  local_res8[0] = 0;
  LVar3 = RegQueryValueExA(local_res20,PTR_s_SecurityLogParameter_180046000,(LPDWORD)0x0,local_res10
                           ,(LPBYTE)0x0,local_res8);
  puVar5 = (uint *)0x0;
  if (((LVar3 == 0) || (LVar3 == 0xea)) && (local_res10[0] == 3)) {
    puVar5 = (uint *)LocalAlloc(0,(ulonglong)local_res8[0]);
    LVar3 = RegQueryValueExA(local_res20,PTR_s_SecurityLogParameter_180046000,(LPDWORD)0x0,
                             local_res10,(LPBYTE)puVar5,local_res8);
    if (LVar3 != 0) goto LAB_180016fa2;
    local_res18[0] = FUN_1800028c0((int *)puVar5,(int *)0x0);
    if (local_res18[0] == 0) goto LAB_180016fa2;
    hMem = (uint *)LocalAlloc(0,(ulonglong)local_res18[0]);
    if (hMem == (uint *)0x0) goto LAB_180016fa2;
    uVar6 = FUN_180002bb0((int *)puVar5,(uint *)0x0,(uint *)0x0,hMem,local_res18,param_1 + 0x278);
    if ((int)uVar6 == 0) {
      LocalFree(hMem);
      goto LAB_180016fa2;
    }
    LocalFree(puVar5);
    local_res8[0] = local_res18[0];
    iVar2 = FUN_1800036b0(hMem,local_res18[0]);
    puVar5 = hMem;
    if (iVar2 != 0) goto LAB_180016fa2;
    local_res8[0] = 4;
    local_res10[0] = 4;
    LVar3 = RegQueryValueExA(local_res20,PTR_s_SecurityLogMask_180046008,(LPDWORD)0x0,local_res10,
                             (LPBYTE)(param_1 + 0x6c),local_res8);
    if ((LVar3 != 0) || (*(int *)(param_1 + 0x6c) == 0)) goto LAB_180016fa2;
    lpData = (LPBYTE)(param_1 + 0x174);
    local_res8[0] = 0x104;
    local_res10[0] = 1;
    LVar3 = RegQueryValueExA(local_res20,PTR_s_SecurityLogPath_180046010,(LPDWORD)0x0,local_res10,
                             lpData,local_res8);
    if (LVar3 == 0) {
      iVar2 = lstrlenA((LPCSTR)lpData);
      pBVar7 = (LPBYTE)(param_1 + 0x174 + (longlong)iVar2);
      if ((lpData < pBVar7) && ((pBVar7[-1] == '\\' || (pBVar7[-1] == '/')))) {
        pBVar7[-1] = '\0';
      }
    }
    else {
      GetSystemDirectoryA((LPSTR)lpData,0x104);
      lpString1 = FUN_18001d3d0((ulonglong)lpData,'\\');
      lstrcpyA(lpString1,"\\Temp2\\WBF");
    }
    BVar4 = PathFileExistsA((LPCSTR)lpData);
    if (BVar4 == 0) goto LAB_180016fa2;
    PTR_FUN_180046018 = &LAB_180016d00;
    PTR_FUN_180046020 = FUN_180017010;
    bVar1 = false;
  }
  else {
LAB_180016fa2:
    RegDeleteValueA(local_res20,PTR_s_SecurityLogParameter_180046000);
    RegDeleteValueA(local_res20,PTR_s_SecurityLogMask_180046008);
    RegDeleteValueA(local_res20,PTR_s_SecurityLogPath_180046010);
  }
  if (puVar5 != (uint *)0x0) {
    LocalFree(puVar5);
  }
  RegCloseKey(local_res20);
LAB_180016ff7:
  return !bVar1;
}



void FUN_180017010(undefined8 *param_1,undefined8 param_2,undefined8 *param_3,int param_4,
                  DWORD param_5)

{
  LPCRITICAL_SECTION lpCriticalSection;
  HANDLE pvVar1;
  DWORD DVar2;
  PRTL_CRITICAL_SECTION_DEBUG p_Var3;
  undefined1 auStack_e8 [32];
  uint local_c8;
  uint local_c0;
  uint local_b8;
  uint local_b0;
  uint local_a8;
  uint local_a0;
  uint local_98;
  undefined8 *local_88;
  undefined8 *local_80;
  undefined8 local_78;
  HANDLE local_70;
  HANDLE local_68;
  _SYSTEMTIME local_60;
  ulonglong local_50;
  
  local_50 = DAT_1800461a0 ^ (ulonglong)auStack_e8;
  lpCriticalSection = (LPCRITICAL_SECTION)*param_1;
  local_88 = param_3;
  local_80 = param_1;
  local_78 = param_2;
  GetLocalTime(&local_60);
  while (EnterCriticalSection(lpCriticalSection), lpCriticalSection[2].OwningThread == (HANDLE)0x0)
  {
    if (*(uint *)&lpCriticalSection[2].LockSemaphore < 5) {
      *(int *)&lpCriticalSection[2].LockSemaphore = *(int *)&lpCriticalSection[2].LockSemaphore + 1;
      LeaveCriticalSection(lpCriticalSection);
      p_Var3 = (PRTL_CRITICAL_SECTION_DEBUG)LocalAlloc(0,(longlong)(int)(param_5 * param_4) + 0x118)
      ;
      goto LAB_18001710b;
    }
    LeaveCriticalSection(lpCriticalSection);
    local_70 = *(HANDLE *)&lpCriticalSection[1].LockCount;
    local_68 = lpCriticalSection[1].LockSemaphore;
    DVar2 = WaitForMultipleObjects(2,&local_70,0,0xffffffff);
    if ((DVar2 != 1) || (*(int *)&lpCriticalSection[1].OwningThread != 0)) goto LAB_180017224;
  }
  p_Var3 = (PRTL_CRITICAL_SECTION_DEBUG)lpCriticalSection[2].OwningThread;
  pvVar1 = *(HANDLE *)p_Var3;
  lpCriticalSection[2].OwningThread = pvVar1;
  if (pvVar1 == (HANDLE)0x0) {
    ResetEvent((HANDLE)lpCriticalSection[1].SpinCount);
  }
  LeaveCriticalSection(lpCriticalSection);
LAB_18001710b:
  if (p_Var3 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    local_98 = (uint)local_60.wMilliseconds;
    local_a0 = (uint)local_60.wSecond;
    local_a8 = (uint)local_60.wMinute;
    local_b0 = (uint)local_60.wHour;
    local_b8 = (uint)local_60.wDay;
    local_c0 = (uint)local_60.wMonth;
    local_c8 = (uint)local_60.wYear;
    wsprintfA((LPSTR)&p_Var3->CriticalSection,"%s\\%s_%4d%02d%02d_%02d%02d%02d.%03d.efl");
    p_Var3[5].EntryCount = param_5;
    *(int *)((longlong)&p_Var3[5].ProcessLocksList.Blink + 4) = param_4;
    FUN_18001d560((undefined8 *)&p_Var3[5].ContentionCount,local_88,
                  (longlong)(int)(param_5 * param_4));
    EnterCriticalSection(lpCriticalSection);
    p_Var3->Type = 0;
    p_Var3->CreatorBackTraceIndex = 0;
    *(undefined4 *)&p_Var3->field_0x4 = 0;
    if (lpCriticalSection[2].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      pvVar1 = lpCriticalSection[1].LockSemaphore;
      *(PRTL_CRITICAL_SECTION_DEBUG *)&lpCriticalSection[2].LockCount = p_Var3;
      lpCriticalSection[2].DebugInfo = p_Var3;
      SetEvent(pvVar1);
    }
    else {
      **(undefined8 **)&lpCriticalSection[2].LockCount = p_Var3;
      *(PRTL_CRITICAL_SECTION_DEBUG *)&lpCriticalSection[2].LockCount = p_Var3;
    }
    LeaveCriticalSection(lpCriticalSection);
  }
LAB_180017224:
  FUN_18001d530(local_50 ^ (ulonglong)auStack_e8);
  return;
}



undefined8 FUN_180017250(LPCRITICAL_SECTION param_1)

{
  FUN_1800172e0(param_1);
  return 0;
}



undefined8 FUN_180017260(undefined8 param_1,LPCWSTR param_2,LPCVOID param_3,DWORD param_4)

{
  HANDLE hFile;
  DWORD local_res20 [2];
  
  local_res20[0] = param_4;
  hFile = CreateFileW(param_2,0x120116,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,(HANDLE)0x0);
  if (hFile != (HANDLE)0xffffffffffffffff) {
    WriteFile(hFile,param_3,local_res20[0],local_res20,(LPOVERLAPPED)0x0);
    CloseHandle(hFile);
  }
  return 1;
}



void FUN_1800172e0(LPCRITICAL_SECTION param_1)

{
  longlong lVar1;
  longlong lVar2;
  bool bVar3;
  DWORD DVar4;
  undefined7 extraout_var;
  PRTL_CRITICAL_SECTION_DEBUG p_Var5;
  HANDLE local_38;
  HANDLE local_30;
  code *local_28;
  code *local_20;
  HANDLE *local_18;
  HANDLE *local_10;
  
  bVar3 = FUN_180016d10((longlong)param_1);
  if (((int)CONCAT71(extraout_var,bVar3) != 0) &&
     (lVar1._0_4_ = param_1[0x11].LockCount, lVar1._4_4_ = param_1[0x11].RecursionCount, lVar1 != 0)
     ) {
    local_28 = FUN_180016b00;
    local_20 = FUN_180017260;
    local_18 = &param_1[0x10].LockSemaphore;
    local_38 = *(HANDLE *)&param_1[1].LockCount;
    local_30 = param_1[1].LockSemaphore;
    local_10 = local_18;
    DVar4 = WaitForMultipleObjects(2,&local_38,0,0xffffffff);
    while (DVar4 == 1) {
      EnterCriticalSection(param_1);
      p_Var5 = param_1[2].DebugInfo;
      param_1[2].DebugInfo = *(PRTL_CRITICAL_SECTION_DEBUG *)p_Var5;
      LeaveCriticalSection(param_1);
      do {
        FUN_180003e00(&local_28,(LPCSTR)&p_Var5->CriticalSection,&p_Var5[5].ContentionCount,
                      *(int *)((longlong)&p_Var5[5].ProcessLocksList.Blink + 4),p_Var5[5].EntryCount
                     );
        EnterCriticalSection(param_1);
        *(HANDLE *)p_Var5 = param_1[2].OwningThread;
        param_1[2].OwningThread = p_Var5;
        lVar2._0_2_ = p_Var5->Type;
        lVar2._2_2_ = p_Var5->CreatorBackTraceIndex;
        lVar2._4_4_ = *(undefined4 *)&p_Var5->field_0x4;
        if (lVar2 == 0) {
          SetEvent((HANDLE)param_1[1].SpinCount);
        }
        p_Var5 = param_1[2].DebugInfo;
        if (p_Var5 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
          ResetEvent(param_1[1].LockSemaphore);
        }
        else {
          param_1[2].DebugInfo = *(PRTL_CRITICAL_SECTION_DEBUG *)p_Var5;
        }
        LeaveCriticalSection(param_1);
      } while ((p_Var5 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) &&
              (*(int *)&param_1[1].OwningThread == 0));
      DVar4 = WaitForMultipleObjects(2,&local_38,0,0xffffffff);
    }
  }
  return;
}



undefined8 * FUN_180017430(undefined8 *param_1)

{
  param_1[1] = 0;
  *param_1 = CSecureDataExchange::vftable;
  return param_1;
}



void FUN_180017450(undefined8 *param_1)

{
  SIZE_T SVar1;
  undefined1 *puVar2;
  
  *param_1 = CSecureDataExchange::vftable;
  if ((HLOCAL)param_1[1] != (HLOCAL)0x0) {
    SVar1 = LocalSize((HLOCAL)param_1[1]);
    puVar2 = (undefined1 *)param_1[1];
    for (; SVar1 != 0; SVar1 = SVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    LocalFree((HLOCAL)param_1[1]);
  }
  return;
}



undefined8 * FUN_1800174a0(undefined8 *param_1,uint param_2)

{
  SIZE_T SVar1;
  undefined1 *puVar2;
  
  *param_1 = CSecureDataExchange::vftable;
  if ((HLOCAL)param_1[1] != (HLOCAL)0x0) {
    SVar1 = LocalSize((HLOCAL)param_1[1]);
    puVar2 = (undefined1 *)param_1[1];
    for (; SVar1 != 0; SVar1 = SVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    LocalFree((HLOCAL)param_1[1]);
  }
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001d45c(param_1);
  }
  return param_1;
}



void FUN_180017510(longlong param_1,longlong *param_2,int param_3,longlong *param_4,int param_5,
                  undefined4 *param_6)

{
  int *piVar1;
  bool bVar2;
  int iVar3;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  undefined7 extraout_var_07;
  undefined7 extraout_var_08;
  undefined7 extraout_var_09;
  undefined7 extraout_var_10;
  undefined7 extraout_var_11;
  undefined7 extraout_var_12;
  undefined7 extraout_var_13;
  longlong lVar4;
  UCHAR *pUVar5;
  undefined1 *puVar6;
  longlong *plVar7;
  undefined8 *puVar8;
  undefined1 auStackY_278 [32];
  int *local_238;
  int local_230 [2];
  UCHAR local_228 [8];
  longlong local_220;
  longlong lStack_218;
  longlong local_210;
  longlong lStack_208;
  longlong local_200;
  longlong lStack_1f8;
  longlong local_1f0;
  longlong lStack_1e8;
  undefined8 local_1e0 [5];
  undefined1 local_1b8 [4];
  undefined8 local_1b4;
  undefined8 uStack_1ac;
  undefined8 local_1a4;
  undefined8 uStack_19c;
  uint local_194 [8];
  undefined8 local_174;
  undefined8 uStack_16c;
  undefined8 local_164;
  undefined8 uStack_15c;
  undefined1 local_134 [64];
  undefined8 local_f4 [5];
  longlong local_c8;
  longlong lStack_c0;
  UCHAR local_b8 [16];
  UCHAR local_a8 [16];
  UCHAR local_98 [16];
  undefined8 local_88;
  undefined8 uStack_80;
  undefined8 local_78;
  undefined8 uStack_70;
  UCHAR local_68 [16];
  UCHAR local_58 [16];
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStackY_278;
  if (((param_3 == 0xd0) && (param_5 == 0xd0)) &&
     (piVar1 = *(int **)(param_1 + 8), piVar1 != (int *)0x0)) {
    local_238 = piVar1;
    bVar2 = FUN_1800012f0((PUCHAR)&local_238,8,piVar1 + 1,0x20,local_a8);
    if ((int)CONCAT71(extraout_var,bVar2) != 0) {
      bVar2 = thunk_FUN_180002170(local_a8,local_98,(uint *)(piVar1 + 9),local_194,0xc0);
      pUVar5 = local_a8;
      for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
        *pUVar5 = '\0';
        pUVar5 = pUVar5 + 1;
      }
      if ((int)CONCAT71(extraout_var_00,bVar2) != 0) {
        iVar3 = FUN_1800011b0(&local_174,0x40,(PUCHAR)&local_c8);
        if (((iVar3 != 0) && (*param_2 == local_c8)) && (param_2[1] == lStack_c0)) {
          local_230[0] = 0;
          bVar2 = FUN_180001820(&local_174,param_2,0x90,(PUCHAR)(param_2 + 0x12),local_230);
          if ((((int)CONCAT71(extraout_var_01,bVar2) != 0) && (local_230[0] != 0)) &&
             ((bVar2 = thunk_FUN_180002170(local_b8,(PUCHAR)&local_c8,(uint *)(param_2 + 2),
                                           (uint *)(param_2 + 2),0x80),
              (int)CONCAT71(extraout_var_02,bVar2) != 0 &&
              ((((bVar2 = FUN_1800019c0(local_228,1), (int)CONCAT71(extraout_var_03,bVar2) != 0 &&
                 (bVar2 = FUN_180001020((PUCHAR)&local_88,0x20),
                 (int)CONCAT71(extraout_var_04,bVar2) != 0)) &&
                (bVar2 = FUN_180001d20(local_1e0,0x20,param_2 + 6,0x40,param_2 + 0xe,0x20,local_68,
                                       0x20), (int)CONCAT71(extraout_var_05,bVar2) != 0)) &&
               (bVar2 = FUN_180001020((PUCHAR)(param_4 + 2),0x20),
               (int)CONCAT71(extraout_var_06,bVar2) != 0)))))) {
            param_4[6] = local_220;
            param_4[7] = lStack_218;
            param_4[8] = local_210;
            param_4[9] = lStack_208;
            param_4[10] = local_200;
            param_4[0xb] = lStack_1f8;
            param_4[0xc] = local_1f0;
            param_4[0xd] = lStack_1e8;
            bVar2 = FUN_180002170(local_68,local_58,(uint *)&local_88,(uint *)(param_4 + 0xe),0x20);
            if (((int)CONCAT71(extraout_var_07,bVar2) != 0) &&
               (iVar3 = FUN_1800011b0(local_134,0x40,(PUCHAR)&local_c8), iVar3 != 0)) {
              *param_4 = local_c8;
              param_4[1] = lStack_c0;
              bVar2 = FUN_180002170(local_b8,(PUCHAR)&local_c8,(uint *)(param_4 + 2),
                                    (uint *)(param_4 + 2),0x80);
              if (((int)CONCAT71(extraout_var_08,bVar2) != 0) &&
                 (bVar2 = FUN_180001790(local_f4,param_4,0x90,(PUCHAR)(param_4 + 0x12)),
                 (int)CONCAT71(extraout_var_09,bVar2) != 0)) {
                *param_6 = 0xd0;
                bVar2 = FUN_180001020((PUCHAR)local_194,0x20);
                if ((int)CONCAT71(extraout_var_10,bVar2) != 0) {
                  local_174 = local_88;
                  uStack_16c = uStack_80;
                  local_164 = local_78;
                  uStack_15c = uStack_70;
                  bVar2 = FUN_180001020((PUCHAR)&local_1b4,0x20);
                  piVar1 = local_238;
                  if (((int)CONCAT71(extraout_var_11,bVar2) != 0) &&
                     (bVar2 = FUN_1800012f0((PUCHAR)&local_238,8,&local_1b4,0x20,local_a8),
                     (int)CONCAT71(extraout_var_12,bVar2) != 0)) {
                    bVar2 = thunk_FUN_180002170(local_a8,local_98,local_194,(uint *)(piVar1 + 9),
                                                0x40);
                    pUVar5 = local_a8;
                    for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
                      *pUVar5 = '\0';
                      pUVar5 = pUVar5 + 1;
                    }
                    if ((int)CONCAT71(extraout_var_13,bVar2) != 0) {
                      *(undefined8 *)(local_238 + 1) = local_1b4;
                      *(undefined8 *)(local_238 + 3) = uStack_1ac;
                      *(undefined8 *)(local_238 + 5) = local_1a4;
                      *(undefined8 *)(local_238 + 7) = uStack_19c;
                      *local_238 = 1;
                    }
                  }
                }
              }
            }
          }
        }
        puVar6 = local_1b8;
        for (lVar4 = 0xe4; lVar4 != 0; lVar4 = lVar4 + -1) {
          *puVar6 = 0;
          puVar6 = puVar6 + 1;
        }
        pUVar5 = local_228;
        for (lVar4 = 0x68; lVar4 != 0; lVar4 = lVar4 + -1) {
          *pUVar5 = '\0';
          pUVar5 = pUVar5 + 1;
        }
        plVar7 = &local_c8;
        for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
          *(undefined1 *)plVar7 = 0;
          plVar7 = (longlong *)((longlong)plVar7 + 1);
        }
        pUVar5 = local_68;
        for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
          *pUVar5 = '\0';
          pUVar5 = pUVar5 + 1;
        }
        puVar8 = &local_88;
        for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
          *(undefined1 *)puVar8 = 0;
          puVar8 = (undefined8 *)((longlong)puVar8 + 1);
        }
      }
    }
  }
  FUN_18001d530(local_48 ^ (ulonglong)auStackY_278);
  return;
}



void FUN_180017940(longlong param_1,uint *param_2,uint *param_3,uint param_4)

{
  bool bVar1;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  longlong lVar2;
  UCHAR *pUVar3;
  uint *puVar4;
  undefined1 auStackY_d8 [32];
  int *local_a8;
  UCHAR local_a0 [4];
  int aiStack_9c [3];
  UCHAR local_90 [24];
  uint local_78 [8];
  UCHAR aUStack_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_d8;
  local_a8 = *(int **)(param_1 + 8);
  if ((local_a8 != (int *)0x0) && (*local_a8 != 0)) {
    puVar4 = (uint *)(local_a8 + 9);
    bVar1 = FUN_1800012f0((PUCHAR)&local_a8,8,local_a8 + 1,0x20,local_a0);
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      bVar1 = thunk_FUN_180002170(local_a0,local_90,puVar4,local_78,0x40);
      pUVar3 = local_a0;
      for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
        *pUVar3 = '\0';
        pUVar3 = pUVar3 + 1;
      }
      if ((int)CONCAT71(extraout_var_00,bVar1) != 0) {
        local_a8 = aiStack_9c;
        thunk_FUN_180002170(aUStack_58,local_48,param_2,param_3,param_4);
        puVar4 = local_78;
        for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
          *(undefined1 *)puVar4 = 0;
          puVar4 = (uint *)((longlong)puVar4 + 1);
        }
      }
    }
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_d8);
  return;
}



void FUN_180017a50(longlong param_1,uint *param_2,uint *param_3,uint param_4)

{
  bool bVar1;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  longlong lVar2;
  UCHAR *pUVar3;
  uint *puVar4;
  undefined1 auStackY_d8 [32];
  int *local_a8;
  UCHAR local_a0 [4];
  int aiStack_9c [3];
  UCHAR local_90 [24];
  uint local_78 [8];
  UCHAR aUStack_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_d8;
  local_a8 = *(int **)(param_1 + 8);
  if ((local_a8 != (int *)0x0) && (*local_a8 != 0)) {
    puVar4 = (uint *)(local_a8 + 9);
    bVar1 = FUN_1800012f0((PUCHAR)&local_a8,8,local_a8 + 1,0x20,local_a0);
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      bVar1 = thunk_FUN_180002170(local_a0,local_90,puVar4,local_78,0x40);
      pUVar3 = local_a0;
      for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
        *pUVar3 = '\0';
        pUVar3 = pUVar3 + 1;
      }
      if ((int)CONCAT71(extraout_var_00,bVar1) != 0) {
        local_a8 = aiStack_9c;
        FUN_180002170(aUStack_58,local_48,param_2,param_3,param_4);
        puVar4 = local_78;
        for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
          *(undefined1 *)puVar4 = 0;
          puVar4 = (uint *)((longlong)puVar4 + 1);
        }
      }
    }
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_d8);
  return;
}



void FUN_180017b60(longlong param_1,undefined8 param_2,undefined *param_3)

{
  uint *puVar1;
  int *piVar2;
  bool bVar3;
  int iVar4;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  undefined7 extraout_var_07;
  undefined7 extraout_var_08;
  undefined7 extraout_var_09;
  undefined7 extraout_var_10;
  undefined7 extraout_var_11;
  undefined7 extraout_var_12;
  undefined7 extraout_var_13;
  longlong lVar5;
  UCHAR *pUVar6;
  undefined1 *puVar7;
  longlong *plVar8;
  undefined8 *puVar9;
  undefined1 auStackY_408 [32];
  int *local_3c8;
  int local_3c0;
  int local_3bc;
  longlong local_3b8;
  longlong lStack_3b0;
  uint local_3a8 [8];
  undefined8 local_388;
  undefined8 uStack_380;
  undefined8 local_378;
  undefined8 uStack_370;
  undefined8 local_368;
  undefined8 uStack_360;
  undefined8 local_358;
  undefined8 uStack_350;
  undefined8 local_348;
  undefined8 uStack_340;
  undefined8 local_338;
  undefined8 uStack_330;
  UCHAR local_328 [64];
  UCHAR local_2e8 [8];
  undefined8 local_2e0;
  undefined8 uStack_2d8;
  undefined8 local_2d0;
  undefined8 uStack_2c8;
  undefined8 local_2c0;
  undefined8 uStack_2b8;
  undefined8 local_2b0;
  undefined8 uStack_2a8;
  undefined8 local_2a0 [5];
  undefined1 local_278 [4];
  undefined8 local_274;
  undefined8 uStack_26c;
  undefined8 local_264;
  undefined8 uStack_25c;
  uint local_254 [8];
  uint local_234 [16];
  undefined1 local_1f4 [64];
  undefined8 local_1b4 [5];
  longlong local_188;
  longlong local_180;
  uint local_178 [8];
  undefined8 local_158 [8];
  uint local_118 [8];
  UCHAR local_f8 [64];
  longlong local_b8;
  longlong lStack_b0;
  UCHAR local_a8 [16];
  UCHAR local_98 [16];
  UCHAR local_88 [16];
  undefined8 local_78;
  undefined8 uStack_70;
  undefined8 local_68;
  undefined8 uStack_60;
  UCHAR local_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_408;
  local_3c8 = *(int **)(param_1 + 8);
  if ((param_3 != (undefined *)0x0) && (local_3c8 != (int *)0x0)) {
    puVar1 = (uint *)(local_3c8 + 9);
    bVar3 = FUN_1800012f0((PUCHAR)&local_3c8,8,local_3c8 + 1,0x20,local_98);
    if ((int)CONCAT71(extraout_var,bVar3) != 0) {
      bVar3 = thunk_FUN_180002170(local_98,local_88,puVar1,local_254,0xc0);
      pUVar6 = local_98;
      for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
        *pUVar6 = '\0';
        pUVar6 = pUVar6 + 1;
      }
      if ((int)CONCAT71(extraout_var_00,bVar3) != 0) {
        bVar3 = FUN_1800019c0(local_2e8,1);
        if (((int)CONCAT71(extraout_var_01,bVar3) != 0) &&
           (bVar3 = FUN_180001020((PUCHAR)local_3a8,0x20), (int)CONCAT71(extraout_var_02,bVar3) != 0
           )) {
          local_388 = local_2e0;
          uStack_380 = uStack_2d8;
          local_378 = local_2d0;
          uStack_370 = uStack_2c8;
          local_368 = local_2c0;
          uStack_360 = uStack_2b8;
          local_358 = local_2b0;
          uStack_350 = uStack_2a8;
          bVar3 = FUN_180001020((PUCHAR)&local_78,0x20);
          if ((int)CONCAT71(extraout_var_03,bVar3) != 0) {
            local_348 = local_78;
            uStack_340 = uStack_70;
            local_338 = local_68;
            uStack_330 = uStack_60;
            iVar4 = FUN_1800011b0(local_1f4,0x40,(PUCHAR)&local_b8);
            if (iVar4 != 0) {
              local_3b8 = local_b8;
              lStack_3b0 = lStack_b0;
              bVar3 = FUN_180002170(local_a8,(PUCHAR)&local_b8,local_3a8,local_3a8,0x80);
              if (((int)CONCAT71(extraout_var_04,bVar3) != 0) &&
                 (bVar3 = FUN_180001790(local_1b4,&local_3b8,0x90,local_328),
                 (int)CONCAT71(extraout_var_05,bVar3) != 0)) {
                local_3c0 = 0;
                iVar4 = (*(code *)param_3)(param_2,&local_3b8,0xd0,&local_188);
                if ((iVar4 != 0) &&
                   ((((local_3c0 == 0xd0 &&
                      (iVar4 = FUN_1800011b0(local_234,0x40,(PUCHAR)&local_b8), iVar4 != 0)) &&
                     (local_188 == local_b8)) && (local_180 == lStack_b0)))) {
                  local_3bc = 0;
                  bVar3 = FUN_180001820((undefined8 *)local_234,&local_188,0x90,local_f8,&local_3bc)
                  ;
                  if ((((((int)CONCAT71(extraout_var_06,bVar3) != 0) && (local_3bc != 0)) &&
                       (bVar3 = thunk_FUN_180002170(local_a8,(PUCHAR)&local_b8,local_178,local_178,
                                                    0x80), (int)CONCAT71(extraout_var_07,bVar3) != 0
                       )) && ((bVar3 = FUN_180001d20(local_2a0,0x20,local_158,0x40,&local_78,0x20,
                                                     local_58,0x20),
                              (int)CONCAT71(extraout_var_08,bVar3) != 0 &&
                              (bVar3 = thunk_FUN_180002170(local_58,local_48,local_118,local_234,
                                                           0x20),
                              (int)CONCAT71(extraout_var_09,bVar3) != 0)))) &&
                     ((bVar3 = FUN_180001020((PUCHAR)local_254,0x20),
                      (int)CONCAT71(extraout_var_10,bVar3) != 0 &&
                      ((bVar3 = FUN_180001020((PUCHAR)&local_274,0x20), piVar2 = local_3c8,
                       (int)CONCAT71(extraout_var_11,bVar3) != 0 &&
                       (bVar3 = FUN_1800012f0((PUCHAR)&local_3c8,8,&local_274,0x20,local_98),
                       (int)CONCAT71(extraout_var_12,bVar3) != 0)))))) {
                    bVar3 = FUN_180002170(local_98,local_88,local_254,(uint *)(piVar2 + 9),0x40);
                    pUVar6 = local_98;
                    for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
                      *pUVar6 = '\0';
                      pUVar6 = pUVar6 + 1;
                    }
                    if ((int)CONCAT71(extraout_var_13,bVar3) != 0) {
                      *(undefined8 *)(local_3c8 + 1) = local_274;
                      *(undefined8 *)(local_3c8 + 3) = uStack_26c;
                      *(undefined8 *)(local_3c8 + 5) = local_264;
                      *(undefined8 *)(local_3c8 + 7) = uStack_25c;
                      *local_3c8 = 1;
                    }
                  }
                }
              }
            }
          }
        }
        puVar7 = local_278;
        for (lVar5 = 0xe4; lVar5 != 0; lVar5 = lVar5 + -1) {
          *puVar7 = 0;
          puVar7 = puVar7 + 1;
        }
        pUVar6 = local_2e8;
        for (lVar5 = 0x68; lVar5 != 0; lVar5 = lVar5 + -1) {
          *pUVar6 = '\0';
          pUVar6 = pUVar6 + 1;
        }
        plVar8 = &local_3b8;
        for (lVar5 = 0xd0; lVar5 != 0; lVar5 = lVar5 + -1) {
          *(undefined1 *)plVar8 = 0;
          plVar8 = (longlong *)((longlong)plVar8 + 1);
        }
        plVar8 = &local_188;
        for (lVar5 = 0xd0; lVar5 != 0; lVar5 = lVar5 + -1) {
          *(undefined1 *)plVar8 = 0;
          plVar8 = (longlong *)((longlong)plVar8 + 1);
        }
        plVar8 = &local_b8;
        for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
          *(undefined1 *)plVar8 = 0;
          plVar8 = (longlong *)((longlong)plVar8 + 1);
        }
        pUVar6 = local_58;
        for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
          *pUVar6 = '\0';
          pUVar6 = pUVar6 + 1;
        }
        puVar9 = &local_78;
        for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
          *(undefined1 *)puVar9 = 0;
          puVar9 = (undefined8 *)((longlong)puVar9 + 1);
        }
      }
    }
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_408);
  return;
}



void FUN_180018000(longlong param_1,undefined8 *param_2,int param_3,undefined8 *param_4,int param_5)

{
  uint *puVar1;
  undefined8 uVar2;
  bool bVar3;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  SIZE_T SVar4;
  longlong lVar5;
  UCHAR *pUVar6;
  undefined1 *puVar7;
  undefined1 auStackY_f8 [32];
  undefined1 *local_c8 [2];
  UCHAR local_b8 [16];
  undefined8 uStack_a8;
  undefined8 local_a0;
  undefined8 uStack_98;
  undefined8 local_90;
  undefined8 uStack_88;
  undefined8 local_80;
  undefined8 uStack_78;
  undefined8 local_70;
  undefined8 uStack_68;
  undefined8 local_60;
  undefined8 uStack_58;
  UCHAR local_48 [16];
  UCHAR local_38 [16];
  ulonglong local_28;
  
  local_28 = DAT_1800461a0 ^ (ulonglong)auStackY_f8;
  if (((param_3 == 0x40) && (param_5 == 0x20)) &&
     (local_c8[0] = (undefined1 *)LocalAlloc(0,0xe4), local_c8[0] != (undefined1 *)0x0)) {
    bVar3 = FUN_180001020(local_c8[0] + 4,0x20);
    if (((int)CONCAT71(extraout_var,bVar3) != 0) &&
       (bVar3 = FUN_180001020(local_c8[0] + 0x24,0x20), (int)CONCAT71(extraout_var_00,bVar3) != 0))
    {
      FUN_18001dbc0((undefined1 (*) [16])local_b8,0,0x68);
      builtin_memcpy(local_b8,"ECS2",4);
      local_70 = *param_4;
      uStack_68 = param_4[1];
      local_60 = param_4[2];
      uStack_58 = param_4[3];
      local_b8[4] = ' ';
      local_b8[5] = '\0';
      local_b8[6] = '\0';
      local_b8[7] = '\0';
      bVar3 = FUN_1800018e0(local_b8);
      if ((int)CONCAT71(extraout_var_01,bVar3) != 0) {
        uVar2 = param_2[1];
        *(undefined8 *)(local_c8[0] + 0x44) = *param_2;
        *(undefined8 *)(local_c8[0] + 0x4c) = uVar2;
        uVar2 = param_2[3];
        *(undefined8 *)(local_c8[0] + 0x54) = param_2[2];
        *(undefined8 *)(local_c8[0] + 0x5c) = uVar2;
        uVar2 = param_2[5];
        *(undefined8 *)(local_c8[0] + 100) = param_2[4];
        *(undefined8 *)(local_c8[0] + 0x6c) = uVar2;
        uVar2 = param_2[7];
        *(undefined8 *)(local_c8[0] + 0x74) = param_2[6];
        *(undefined8 *)(local_c8[0] + 0x7c) = uVar2;
        *(undefined8 *)(local_c8[0] + 0x84) = local_b8._8_8_;
        *(undefined8 *)(local_c8[0] + 0x8c) = uStack_a8;
        *(undefined8 *)(local_c8[0] + 0x94) = local_a0;
        *(undefined8 *)(local_c8[0] + 0x9c) = uStack_98;
        *(undefined8 *)(local_c8[0] + 0xa4) = local_90;
        *(undefined8 *)(local_c8[0] + 0xac) = uStack_88;
        *(undefined8 *)(local_c8[0] + 0xb4) = local_80;
        *(undefined8 *)(local_c8[0] + 0xbc) = uStack_78;
        *(undefined8 *)(local_c8[0] + 0xc4) = local_70;
        *(undefined8 *)(local_c8[0] + 0xcc) = uStack_68;
        *(undefined8 *)(local_c8[0] + 0xd4) = local_60;
        *(undefined8 *)(local_c8[0] + 0xdc) = uStack_58;
        puVar1 = (uint *)(local_c8[0] + 0x24);
        bVar3 = FUN_1800012f0((PUCHAR)local_c8,8,local_c8[0] + 4,0x20,local_48);
        if ((int)CONCAT71(extraout_var_02,bVar3) != 0) {
          bVar3 = FUN_180002170(local_48,local_38,puVar1,puVar1,0xc0);
          pUVar6 = local_48;
          for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
            *pUVar6 = '\0';
            pUVar6 = pUVar6 + 1;
          }
          if ((int)CONCAT71(extraout_var_03,bVar3) != 0) {
            if (*(HLOCAL *)(param_1 + 8) != (HLOCAL)0x0) {
              SVar4 = LocalSize(*(HLOCAL *)(param_1 + 8));
              puVar7 = *(undefined1 **)(param_1 + 8);
              for (; SVar4 != 0; SVar4 = SVar4 - 1) {
                *puVar7 = 0;
                puVar7 = puVar7 + 1;
              }
              LocalFree(*(HLOCAL *)(param_1 + 8));
            }
            *(undefined1 **)(param_1 + 8) = local_c8[0];
            local_c8[0] = (undefined1 *)0x0;
          }
        }
      }
    }
    pUVar6 = local_b8;
    for (lVar5 = 0x68; lVar5 != 0; lVar5 = lVar5 + -1) {
      *pUVar6 = '\0';
      pUVar6 = pUVar6 + 1;
    }
    pUVar6 = local_48;
    for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
      *pUVar6 = '\0';
      pUVar6 = pUVar6 + 1;
    }
    if (local_c8[0] != (undefined1 *)0x0) {
      puVar7 = local_c8[0];
      for (lVar5 = 0xe4; lVar5 != 0; lVar5 = lVar5 + -1) {
        *puVar7 = 0;
        puVar7 = puVar7 + 1;
      }
      LocalFree(local_c8[0]);
    }
  }
  FUN_18001d530(local_28 ^ (ulonglong)auStackY_f8);
  return;
}



void FUN_180018220(void)

{
  return;
}



DWORD FUN_180018230(void)

{
  DWORD DVar1;
  LSTATUS LVar2;
  DWORD local_res8 [2];
  DWORD local_res10 [2];
  HKEY local_res18;
  
  DVar1 = RegOpenKeyA((HKEY)0xffffffff80000002,"SOFTWARE\\EgisSDKDBG",&local_res18);
  if (DVar1 == 0) {
    local_res8[0] = 4;
    LVar2 = RegQueryValueExA(local_res18,"EnableBlock",(LPDWORD)0x0,local_res10,&DAT_180048a80,
                             local_res8);
    DVar1 = local_res8[0];
    if (LVar2 == 0) {
      DVar1 = 1;
    }
    local_res8[0] = 4;
    LVar2 = RegQueryValueExA(local_res18,"DisplayFlag ",(LPDWORD)0x0,local_res10,
                             (LPBYTE)&DAT_180048a84,local_res8);
    if (LVar2 == 0) {
      DVar1 = 1;
    }
    RegCloseKey(local_res18);
    DAT_180048a88 = 1;
  }
  return DVar1;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180018310(uint param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  DWORD DVar1;
  int iVar2;
  char *pcVar3;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined1 auStack_378 [32];
  uint local_358;
  uint local_350;
  uint local_348;
  uint local_340;
  DWORD local_338;
  DWORD local_330;
  longlong local_328;
  _SYSTEMTIME local_318;
  undefined1 local_308 [31];
  char cStack_2e9;
  undefined2 local_2e8;
  undefined1 auStack_2e6 [350];
  undefined1 local_188 [352];
  ulonglong local_28;
  
  local_28 = DAT_1800461a0 ^ (ulonglong)auStack_378;
  local_res18 = param_3;
  local_res20 = param_4;
  if (DAT_180048a88 == 0) {
    FUN_180018230();
  }
  if (((_DAT_180048a80 & param_1) != 0) && (param_2 != 0)) {
    GetLocalTime(&local_318);
    if (param_1 == 1) {
      pcVar3 = "EngineAdapter";
    }
    else {
      pcVar3 = "SensorAdapter";
      if (param_1 != 2) {
        pcVar3 = "WBF";
      }
    }
    FUN_18001de48(local_308,0x1e,pcVar3);
    DVar1 = GetCurrentThreadId();
    local_338 = GetCurrentProcessId();
    local_340 = (uint)local_318.wMilliseconds;
    local_348 = (uint)local_318.wSecond;
    local_350 = (uint)local_318.wMinute;
    local_358 = (uint)local_318.wHour;
    local_330 = DVar1;
    local_328 = param_2;
    FUN_18001df18(local_188,0x15e,0x18002c648,local_308);
    iVar2 = FUN_18001e094((undefined1 *)&local_2e8,0x15e,(longlong)local_188,&local_res18);
    if ((&cStack_2e9)[iVar2] != '\n') {
      *(undefined2 *)((longlong)&local_2e8 + (longlong)iVar2) = 0xa0d;
      auStack_2e6[iVar2] = 0;
    }
    if (0 < DAT_180048a84) {
      OutputDebugStringA((LPCSTR)&local_2e8);
    }
    if (1 < DAT_180048a84) {
      FUN_1800184c0(param_1,(LPCSTR)&local_2e8);
    }
  }
  FUN_18001d530(local_28 ^ (ulonglong)auStack_378);
  return;
}



void FUN_1800184c0(int param_1,LPCSTR param_2)

{
  DWORD nNumberOfBytesToWrite;
  BOOL BVar1;
  HANDLE hFile;
  char *pcVar2;
  undefined1 auStackY_198 [32];
  DWORD local_158 [2];
  undefined1 local_150 [40];
  CHAR local_128 [272];
  ulonglong local_18;
  
  if (param_2 != (LPCSTR)0x0) {
    local_18 = DAT_1800461a0 ^ (ulonglong)auStackY_198;
    if (param_1 == 1) {
      pcVar2 = "EngineAdapter";
    }
    else {
      pcVar2 = "SensorAdapter";
      if (param_1 != 2) {
        pcVar2 = "WBF";
      }
    }
    FUN_18001de48(local_150,0x1e,pcVar2);
    FUN_18001df18(local_128,0x104,0x18002c6c0,"C:\\Temp2\\WBF");
    hFile = CreateFileA(local_128,0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,4,0x80,(HANDLE)0x0);
    if (hFile != (HANDLE)0xffffffffffffffff) {
      SetFilePointer(hFile,0,(PLONG)0x0,2);
      nNumberOfBytesToWrite = lstrlenA(param_2);
      BVar1 = WriteFile(hFile,param_2,nNumberOfBytesToWrite,local_158,(LPOVERLAPPED)0x0);
      if (BVar1 == 0) {
        OutputDebugStringA("=SDK-DBG= Write File fail\r\n");
      }
      CloseHandle(hFile);
    }
    FUN_18001d530(local_18 ^ (ulonglong)auStackY_198);
  }
  return;
}



uint FUN_180018600(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong *lpMem;
  longlong *plVar1;
  HANDLE hHeap;
  uint uVar2;
  
  FUN_180018310(1,0x18002c880,param_3,param_4);
  uVar2 = 0;
  if (param_1 == 0) {
    uVar2 = 0x80004003;
  }
  else {
    lpMem = *(longlong **)(param_1 + 0x38);
    if (lpMem != (longlong *)0x0) {
      FUN_180018310(1,0x18002c898,param_3,param_4);
      FUN_18001bdf0(param_1);
      plVar1 = (longlong *)*lpMem;
      if (plVar1 != (longlong *)0x0) {
        (**(code **)(*plVar1 + 0x38))(plVar1,param_1);
        FUN_18001ae90((undefined8 *)*lpMem);
      }
      if ((HANDLE)lpMem[0x83a] != (HANDLE)0x0) {
        CloseHandle((HANDLE)lpMem[0x83a]);
      }
      hHeap = GetProcessHeap();
      HeapFree(hHeap,0,lpMem);
      *(undefined8 *)(param_1 + 0x38) = 0;
    }
  }
  FUN_180018310(1,0x18002c8c8,(ulonglong)uVar2,param_4);
  FUN_180018220();
  return uVar2;
}



undefined8 FUN_1800186d0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong *plVar1;
  
  FUN_180018310(1,0x18002c8f8,param_3,param_4);
  if (param_1 == 0) {
    FUN_180018310(1,0x18002c918,param_3,param_4);
    return 0x80004003;
  }
  plVar1 = *(longlong **)(param_1 + 0x38);
  if (plVar1 == (longlong *)0x0) {
    FUN_180018310(1,0x18002c950,param_3,param_4);
    return 0x80004003;
  }
  *(undefined4 *)(plVar1 + 2) = 0x8009800f;
  plVar1[1] = 0;
  if ((longlong *)*plVar1 != (longlong *)0x0) {
    (**(code **)(*(longlong *)*plVar1 + 0x70))();
    (**(code **)(*(longlong *)*plVar1 + 0x78))();
  }
  FUN_180018310(1,0x18002c988,param_3,param_4);
  return 0;
}



undefined8
FUN_180018770(longlong param_1,undefined4 *param_2,undefined8 *param_3,undefined8 param_4)

{
  if (((param_1 != 0) && (param_2 != (undefined4 *)0x0)) && (param_3 != (undefined8 *)0x0)) {
    *param_2 = 0x401001b;
    *param_3 = 0x427b0651895fd2a7;
    param_3[1] = 0xd6e86d0d3715d0a8;
    return 0;
  }
  FUN_180018310(1,0x18002c9a8,param_3,param_4);
  return 0x80004003;
}



undefined8 FUN_1800187e0(longlong param_1,longlong param_2,longlong param_3,longlong param_4)

{
  if ((((param_1 != 0) && (param_2 != 0)) && (param_3 != 0)) && (param_4 != 0)) {
    FUN_180018310(1,0x18002c9e8,param_3,param_4);
    return 0x80004001;
  }
  return 0x80004003;
}



undefined8 FUN_180018820(longlong param_1,undefined8 param_2,longlong param_3,undefined8 param_4)

{
  longlong lVar1;
  
  lVar1 = param_3;
  FUN_180018310(1,0x18002ca28,param_3,param_4);
  if ((param_1 != 0) && (param_3 != 0)) {
    FUN_180018310(1,0x18002ca88,lVar1,param_4);
    return 0x80004001;
  }
  FUN_180018310(1,0x18002ca50,lVar1,param_4);
  return 0x80004003;
}



undefined8 FUN_180018890(longlong param_1,ulonglong *param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  
  FUN_180018310(1,0x18002cac8,param_3,param_4);
  if ((param_1 != 0) && (param_2 != (ulonglong *)0x0)) {
    uVar1 = (**(code **)(*(longlong *)**(undefined8 **)(param_1 + 0x38) + 0x80))();
    *param_2 = (ulonglong)uVar1;
    FUN_180018310(1,0x18002cb28,param_3,param_4);
    return 0;
  }
  FUN_180018310(1,0x18002caf0,param_3,param_4);
  return 0x80004003;
}



uint FUN_180018910(undefined8 *param_1,longlong param_2,longlong param_3,ulonglong param_4,
                  undefined4 *param_5)

{
  ushort uVar1;
  undefined8 *puVar2;
  int iVar3;
  uint uVar4;
  ulonglong uVar5;
  char *pcVar6;
  uint *puVar7;
  int iVar8;
  ushort *puVar9;
  uint *puVar10;
  ulonglong uVar11;
  longlong lVar12;
  
  lVar12 = param_3;
  uVar11 = param_4;
  FUN_180018310(1,0x18002cb50,param_3,param_4);
  uVar4 = 0;
  if (((param_1 == (undefined8 *)0x0) || (param_2 == 0)) || (param_5 == (undefined4 *)0x0)) {
    uVar4 = 0x80004003;
  }
  else {
    *param_5 = 0;
    if ((param_3 != 0) && ((char)param_4 != '\0')) {
      puVar2 = (undefined8 *)param_1[7];
      puVar9 = (ushort *)((ulonglong)*(uint *)(param_2 + 4) + param_2);
      if (((puVar9[0x14] == 0x1b) && ((puVar9[0x15] == 0x401 && (puVar9[0x16] == 0x1b)))) &&
         (puVar9[0x17] == 0x401)) {
        uVar5 = (ulonglong)*(uint *)(param_2 + 0x14);
        if (*(int *)(uVar5 + param_2) == 0) {
          *(undefined4 *)(puVar2 + 3) = 0;
          *(undefined2 *)((longlong)puVar2 + 0x1c) = 0;
          pcVar6 = "EngineAdapterAcceptSampleData : Do non-PBA flow. ";
        }
        else {
          *(undefined4 *)(puVar2 + 3) = 1;
          *(undefined2 *)((longlong)puVar2 + 0x1c) = *(undefined2 *)(uVar5 + 4 + param_2);
          uVar1 = *(ushort *)(uVar5 + 4 + param_2);
          if (uVar1 != 0xffff) {
            FUN_180018310(1,0x18002cbc0,(ulonglong)uVar1,uVar11);
            goto LAB_180018aed;
          }
          pcVar6 = "EngineAdapterAcceptSampleData : LogonFingerReady, Do POA Logon";
        }
        FUN_180018310(1,(longlong)pcVar6,lVar12,uVar11);
        if (((*puVar9 & 0x1000) == 0) || (0x3b < (byte)puVar9[7])) {
          iVar8 = 0;
          lVar12 = (ulonglong)*(uint *)(param_2 + 0xc) + param_2;
          puVar7 = (uint *)(lVar12 + 0x28);
          if (*(char *)(lVar12 + 0x20) != '\0') {
            do {
              puVar10 = puVar7 + 4;
              uVar11 = (ulonglong)(*puVar7 - 0x10);
              iVar3 = (**(code **)(*(longlong *)*puVar2 + 0x28))();
              if (iVar3 == 0) {
                FUN_180018310(1,0x18002cc50,puVar10,uVar11);
                uVar4 = 0x8000ffff;
                goto LAB_180018aed;
              }
              iVar8 = iVar8 + 1;
              puVar7 = (uint *)((longlong)puVar7 + (ulonglong)*puVar7);
            } while (iVar8 < (int)(uint)*(byte *)(lVar12 + 0x20));
          }
          uVar5 = (ulonglong)*(ushort *)(lVar12 + 0x2e);
          uVar11 = (ulonglong)*(ushort *)(lVar12 + 0x2c);
          lVar12 = lVar12 + 0x38;
          uVar4 = (**(code **)(*(longlong *)*puVar2 + 0x40))();
          if (((int)uVar4 < 0) && (*(int *)(puVar2 + 3) != 0)) {
            *(undefined4 *)(puVar2 + 3) = 0;
            FUN_18001b660(param_1,lVar12,uVar11,uVar5);
          }
        }
        else {
          *param_5 = 9;
          uVar4 = 0x80098008;
        }
        goto LAB_180018aed;
      }
    }
    uVar4 = 0x80070057;
  }
LAB_180018aed:
  FUN_180018310(1,0x18002cc80,(ulonglong)uVar4,param_4 & 0xff);
  return uVar4;
}



uint FUN_180018b30(longlong param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4)

{
  undefined4 uVar1;
  undefined8 *puVar2;
  uint uVar3;
  
  FUN_180018310(1,0x18002ccc0,param_3,param_4);
  if ((param_1 == 0) || (param_2 == (undefined4 *)0x0)) {
    uVar3 = 0x80004003;
  }
  else {
    *param_2 = 0;
    puVar2 = *(undefined8 **)(param_1 + 0x38);
    if (*(int *)(puVar2 + 1) == 0) {
      uVar3 = 0x8009800f;
    }
    else {
      uVar3 = (**(code **)(*(longlong *)*puVar2 + 0x60))((longlong *)*puVar2,param_2);
      if (uVar3 == 0) {
        *(undefined4 *)(puVar2 + 1) = 0xffffffff;
      }
      uVar1 = *param_2;
      *(uint *)(puVar2 + 2) = uVar3;
      *(undefined4 *)((longlong)puVar2 + 0xc) = uVar1;
    }
  }
  FUN_180018310(1,0x18002cce8,(ulonglong)uVar3,param_4);
  return uVar3;
}



uint FUN_180018bd0(longlong param_1,byte param_2,longlong param_3,longlong param_4)

{
  longlong lVar1;
  uint uVar2;
  ulonglong uVar3;
  longlong lVar4;
  
  lVar4 = param_4;
  FUN_180018310(1,0x18002cd20,param_3,param_4);
  if (((param_1 == 0) || (param_3 == 0)) || (param_4 == 0)) {
    uVar2 = 0x80004003;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x38);
    uVar3 = (ulonglong)param_2;
    FUN_180018310(1,0x18002cd50,uVar3,lVar4);
    if ((param_2 & 0xe0) == 0) {
      FUN_180018310(1,0x18002cd90,uVar3,lVar4);
      uVar2 = 0x80070057;
    }
    else if ((((param_2 & 2) == 0) && ((param_2 & 1) == 0)) &&
            (((param_2 & 4) == 0 && (param_2 != 0)))) {
      if ((*(longlong *)(lVar1 + 0x4160) == 0) || (*(int *)(lVar1 + 0x4168) == 0)) {
        uVar2 = 0x8009800f;
      }
      else {
        uVar2 = 0x80004001;
      }
    }
    else {
      FUN_180018310(1,0x18002ce20,uVar3,lVar4);
      uVar2 = 0x80070057;
    }
  }
  FUN_180018310(1,0x18002cea8,(ulonglong)uVar2,lVar4);
  return uVar2;
}



void FUN_180018cd0(longlong param_1,longlong param_2,ulonglong param_3,undefined8 **param_4,
                  undefined8 **param_5,undefined8 *param_6,undefined8 *param_7,undefined8 *param_8,
                  int *param_9)

{
  undefined8 *puVar1;
  code *pcVar2;
  ushort *puVar3;
  undefined8 *puVar4;
  uint uVar5;
  int iVar6;
  undefined4 uVar7;
  undefined8 uVar8;
  byte bVar9;
  ulonglong uVar10;
  undefined1 auStack_148 [32];
  undefined8 *local_128;
  int *local_120;
  longlong local_118;
  uint local_110;
  undefined8 *local_108;
  int local_100 [2];
  undefined8 local_f8;
  undefined8 **local_f0;
  undefined8 *local_e8;
  undefined1 local_e0;
  undefined8 local_c8;
  undefined8 *local_c0;
  undefined8 local_a8;
  undefined8 uStack_a0;
  undefined8 local_98;
  undefined8 uStack_90;
  undefined8 local_88;
  undefined8 uStack_80;
  undefined4 local_78;
  undefined4 uStack_74;
  undefined4 uStack_70;
  undefined4 uStack_6c;
  undefined8 local_68;
  undefined4 local_60;
  ulonglong local_58;
  
  local_58 = DAT_1800461a0 ^ (ulonglong)auStack_148;
  local_108 = param_8;
  bVar9 = (byte)param_3;
  uVar10 = param_3;
  local_f0 = param_4;
  FUN_180018310(1,0x18002ced8,param_3,param_4);
  if ((((param_1 == 0) || (param_2 == 0)) || (local_f0 == (undefined8 **)0x0)) ||
     (((param_5 == (undefined8 **)0x0 || (param_6 == (undefined8 *)0x0)) ||
      ((param_7 == (undefined8 *)0x0 ||
       ((local_108 == (undefined8 *)0x0 || (param_9 == (int *)0x0)))))))) {
    local_110 = (uint)bVar9;
    local_120 = param_9;
    local_128 = param_7;
    local_118 = param_2;
    FUN_180018310(1,0x18002cf00,param_1,param_5);
    param_4 = param_5;
LAB_1800190fd:
    uVar5 = 0x80004003;
  }
  else {
    if (bVar9 == 0) goto LAB_180019118;
    puVar1 = *(undefined8 **)(param_1 + 0x38);
    if (*(int *)(puVar1 + 1) == 1) {
      local_108 = puVar1;
      FUN_180018310(1,0x18002cf90,uVar10,param_4);
      uVar5 = 0x80098007;
    }
    else {
      *(undefined1 *)local_f0 = 0;
      *param_5 = (undefined8 *)0x0;
      *param_6 = 0;
      *param_7 = 0;
      *local_108 = 0;
      *param_9 = 0;
      local_108 = puVar1;
      if (*(longlong *)(param_1 + 0x28) == 0) goto LAB_1800190fd;
      pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x78);
      if (pcVar2 == (code *)0x0) {
LAB_180018df2:
        uVar5 = 0x80004001;
      }
      else {
        uVar5 = (*pcVar2)(param_1,param_2,param_3 & 0xff);
        puVar1 = local_108;
        if ((int)uVar5 < 0) {
LAB_1800190b5:
          if (uVar5 == 0) {
            *(undefined1 *)local_f0 = 1;
          }
          else if (uVar5 == 0x8009801f) {
            uVar5 = 0x80098005;
          }
        }
        else {
          while( true ) {
            if (*(longlong *)(param_1 + 0x28) == 0) goto LAB_1800190fd;
            pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0xa0);
            if (pcVar2 == (code *)0x0) goto LAB_180018df2;
            uVar5 = (*pcVar2)(param_1,&local_e8);
            if ((int)uVar5 < 0) goto LAB_1800190b5;
            local_120 = local_100;
            local_100[0] = 0;
            param_4 = (undefined8 **)0x0;
            local_128 = (undefined8 *)((ulonglong)local_128 & 0xffffffff00000000);
            iVar6 = (**(code **)(*(longlong *)*puVar1 + 0x48))
                              ((longlong *)*puVar1,local_c8,(ulonglong)local_c0 & 0xffffffff);
            puVar4 = local_c0;
            if (-1 < iVar6) break;
            uVar5 = 0x80098005;
            if ((bVar9 != 0xff) ||
               (uVar8 = FUN_18001acb0(param_1), uVar5 = 0x80098005, (int)uVar8 < 0))
            goto LAB_180019102;
          }
          if (local_100[0] != 0) {
            local_a8 = *local_e8;
            uStack_a0 = local_e8[1];
            local_98 = local_e8[2];
            uStack_90 = local_e8[3];
            local_88 = local_e8[4];
            uStack_80 = local_e8[5];
            local_78 = *(undefined4 *)(local_e8 + 6);
            uStack_74 = *(undefined4 *)((longlong)local_e8 + 0x34);
            uStack_70 = *(undefined4 *)(local_e8 + 7);
            uStack_6c = *(undefined4 *)((longlong)local_e8 + 0x3c);
            local_68 = local_e8[8];
            local_60 = *(undefined4 *)(local_e8 + 9);
            local_f8 = 0;
            local_108 = (undefined8 *)0x0;
            iVar6 = (**(code **)(*(longlong *)*puVar1 + 0x68))
                              ((longlong *)*puVar1,&local_f8,&local_108);
            if (-1 < iVar6) {
              puVar3 = *(ushort **)(param_1 + 0x28);
              uVar7 = 0x80004001;
              if (((4 < *puVar3) && (*(code **)(puVar3 + 0x80) != (code *)0x0)) &&
                 (*(longlong *)(puVar3 + 0x84) != 0)) {
                if (puVar3 == (ushort *)0x0) {
                  uVar5 = 0x80004003;
                }
                else {
                  param_4 = &local_e8;
                  uVar5 = (**(code **)(puVar3 + 0x80))(param_1,&local_a8,local_e0);
                  if (-1 < (int)uVar5) {
                    local_c8 = local_f8;
                    local_c0 = local_108;
                    if (*(longlong *)(param_1 + 0x28) == 0) {
                      iVar6 = -0x7fffbffd;
                    }
                    else {
                      pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x108);
                      if (pcVar2 == (code *)0x0) {
                        iVar6 = -0x7fffbfff;
                      }
                      else {
                        iVar6 = (*pcVar2)(param_1,&local_e8);
                      }
                    }
                    param_4 = (undefined8 **)((ulonglong)local_c0 & 0xffffffff);
                    local_128 = (undefined8 *)CONCAT44(local_128._4_4_,iVar6);
                    FUN_180018310(1,0x18002d010,(ulonglong)puVar4 & 0xffffffff,param_4);
                    if (-1 < iVar6) goto LAB_18001909f;
                    local_e8 = &local_a8;
                    goto LAB_180018fec;
                  }
                }
                FUN_180018310(1,0x18002cfd0,(ulonglong)uVar5,param_4);
                local_e8 = &local_a8;
              }
LAB_180018fec:
              if (*(longlong *)(param_1 + 0x28) == 0) {
                uVar5 = 0x80004003;
              }
              else {
                param_4 = *(undefined8 ***)(*(longlong *)(param_1 + 0x28) + 0x70);
                if (param_4 == (undefined8 **)0x0) {
                  uVar5 = 0x80004001;
                }
                else {
                  uVar5 = (*(code *)param_4)(param_1,local_e8,local_e0);
                  if (-1 < (int)uVar5) {
                    local_c8 = local_f8;
                    local_c0 = local_108;
                    if (*(longlong *)(param_1 + 0x28) == 0) {
                      uVar7 = 0x80004003;
                    }
                    else {
                      pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x68);
                      if (pcVar2 != (code *)0x0) {
                        uVar7 = (*pcVar2)(param_1,&local_e8);
                      }
                    }
                    param_4 = (undefined8 **)((ulonglong)local_c0 & 0xffffffff);
                    local_128 = (undefined8 *)CONCAT44(local_128._4_4_,uVar7);
                    FUN_180018310(1,0x18002d0b0,(ulonglong)puVar4 & 0xffffffff,param_4);
                    (**(code **)(*(longlong *)*puVar1 + 0x70))();
                    *(undefined1 *)local_f0 = 1;
                    uVar5 = 0;
                    goto LAB_180019102;
                  }
                }
              }
              FUN_180018310(1,0x18002d060,(ulonglong)uVar5,param_4);
            }
LAB_18001909f:
            (**(code **)(*(longlong *)*puVar1 + 0x70))();
          }
          *(undefined1 *)local_f0 = 1;
          uVar5 = 0;
        }
      }
    }
  }
LAB_180019102:
  FUN_180018310(1,0x18002d100,(ulonglong)uVar5,param_4);
LAB_180019118:
  FUN_18001d530(local_58 ^ (ulonglong)auStack_148);
  return;
}



void FUN_180019140(undefined8 *param_1,undefined8 *param_2,byte *param_3,int **param_4,
                  longlong *param_5,undefined8 *param_6,undefined8 *param_7,int *param_8)

{
  ushort uVar1;
  code *pcVar2;
  ushort *puVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  BOOL BVar9;
  undefined4 uVar10;
  ulonglong uVar11;
  undefined8 uVar12;
  HANDLE pvVar13;
  char *pcVar14;
  int **ppiVar15;
  ulonglong uVar16;
  byte *pbVar17;
  undefined8 *puVar18;
  ulonglong *puVar19;
  undefined1 auStack_198 [32];
  undefined8 *local_178;
  int *local_170;
  undefined8 *local_168;
  byte *local_160;
  byte *local_158;
  int local_150 [2];
  ulonglong *local_148;
  uint local_140 [2];
  undefined8 *local_138;
  undefined8 *local_130;
  longlong local_128 [2];
  int *local_118;
  byte local_110;
  longlong local_f8;
  undefined8 *local_f0;
  int *local_e8;
  longlong local_e0;
  int **local_d8;
  undefined8 *local_d0;
  longlong local_c8;
  undefined8 *local_c0;
  longlong *local_b8;
  undefined8 local_a8;
  undefined8 uStack_a0;
  undefined8 local_98;
  undefined8 uStack_90;
  undefined8 local_88;
  undefined8 uStack_80;
  int local_78;
  int iStack_74;
  int iStack_70;
  int iStack_6c;
  undefined8 local_68;
  int local_60;
  ulonglong local_58;
  
  local_58 = DAT_1800461a0 ^ (ulonglong)auStack_198;
  local_130 = param_7;
  local_b8 = param_5;
  local_d0 = param_6;
  local_148 = (ulonglong *)0x0;
  local_140[0] = 0;
  pbVar17 = param_3;
  ppiVar15 = param_4;
  local_158 = param_3;
  local_d8 = param_4;
  local_c0 = param_2;
  FUN_180018310(1,0x18002d130,param_3,param_4);
  if ((((param_1 == (undefined8 *)0x0) || (param_4 == (int **)0x0)) || (param_5 == (longlong *)0x0))
     || (((param_6 == (undefined8 *)0x0 || (local_130 == (undefined8 *)0x0)) ||
         ((param_8 == (int *)0x0 || ((param_2 == (undefined8 *)0x0 || (param_3 == (byte *)0x0)))))))
     ) {
    local_170 = param_8;
    local_178 = param_6;
    local_168 = param_2;
    local_160 = param_3;
    FUN_180018310(1,0x18002d160,param_1,param_4);
  }
  else {
    uVar16 = 0;
    *param_8 = 0;
    puVar18 = (undefined8 *)param_1[7];
    param_4 = ppiVar15;
    uVar8 = 0xffffffff;
    local_138 = puVar18;
    if (*(int *)(puVar18 + 3) != 0) {
      pcVar14 = "EngineAdapterIdentifyFeatureSet : CleanSSO";
      FUN_180018310(1,0x18002d1f0,pbVar17,ppiVar15);
      FUN_18001b660(param_1,pcVar14,pbVar17,ppiVar15);
      uVar1 = *(ushort *)((longlong)puVar18 + 0x1c);
      *(undefined4 *)(puVar18 + 3) = 0;
      param_4 = ppiVar15;
      uVar8 = 0xffffffff;
      if (uVar1 != 0xffff) {
        uVar8 = (uint)uVar1;
        param_4 = (int **)local_140;
        uVar11 = FUN_18001b980((longlong)param_1,(uint)uVar1,&local_148,(uint *)param_4);
        if ((int)uVar11 < 0) {
          uVar6 = 0x80098003;
          goto LAB_180019811;
        }
      }
    }
    if (param_1[5] != 0) {
      pcVar2 = *(code **)(param_1[5] + 0x80);
      if (pcVar2 == (code *)0x0) {
        uVar6 = 0x80004001;
        goto LAB_180019811;
      }
      param_4 = (int **)0x0;
      uVar6 = (*pcVar2)(param_1,0xff,0);
      if ((int)uVar6 < 0) goto LAB_180019811;
      if (param_1[5] != 0) {
        pcVar2 = *(code **)(param_1[5] + 0x88);
        if (pcVar2 == (code *)0x0) {
          uVar6 = 0x80004001;
        }
        else {
          uVar6 = (*pcVar2)(param_1,&local_c8);
          if ((-1 < (int)uVar6) && (FUN_180018310(1,0x18002d220,local_c8,param_4), local_c8 != 0)) {
            uVar12 = FUN_18001ac80((longlong)param_1);
            uVar6 = (uint)uVar12;
            if (-1 < (int)uVar6) {
              uVar10 = 0x80004001;
LAB_180019322:
              if (param_1[5] == 0) {
                ppiVar15 = (int **)0x80004003;
LAB_180019526:
                param_4 = ppiVar15;
                FUN_180018310(1,0x18002d260,uVar16,ppiVar15);
                if ((int)ppiVar15 != -0x7ff67fe1) goto LAB_18001980c;
              }
              else {
                pcVar2 = *(code **)(param_1[5] + 0xa0);
                if (pcVar2 == (code *)0x0) {
                  ppiVar15 = (int **)0x80004001;
                  goto LAB_180019526;
                }
                uVar6 = (*pcVar2)(param_1,&local_118);
                ppiVar15 = (int **)(ulonglong)uVar6;
                if ((int)uVar6 < 0) goto LAB_180019526;
                if (local_118 != (int *)0x0) {
                  uVar11 = (ulonglong)local_110;
                  FUN_180018310(1,0x18002d2c0,uVar11,param_4);
                  if ((int)uVar8 < 0) {
                    local_170 = local_150;
                    local_150[0] = 0;
                    param_4 = (int **)0x0;
                    local_178 = (undefined8 *)((ulonglong)local_178 & 0xffffffff00000000);
                    iVar7 = (**(code **)(*(longlong *)*puVar18 + 0x48))
                                      ((longlong *)*puVar18,local_f8,
                                       (ulonglong)local_f0 & 0xffffffff);
                    if (-1 < iVar7) {
                      if (local_150[0] != 0) {
                        uVar16 = (ulonglong)local_f0 & 0xffffffff;
                        local_a8 = *(undefined8 *)local_118;
                        uStack_a0 = *(undefined8 *)(local_118 + 2);
                        local_98 = *(undefined8 *)(local_118 + 4);
                        uStack_90 = *(undefined8 *)(local_118 + 6);
                        local_88 = *(undefined8 *)(local_118 + 8);
                        uStack_80 = *(undefined8 *)(local_118 + 10);
                        local_78 = local_118[0xc];
                        iStack_74 = local_118[0xd];
                        iStack_70 = local_118[0xe];
                        iStack_6c = local_118[0xf];
                        local_68 = *(undefined8 *)(local_118 + 0x10);
                        local_60 = local_118[0x12];
                        local_128[0] = 0;
                        local_138 = (undefined8 *)0x0;
                        iVar7 = (**(code **)(*(longlong *)*puVar18 + 0x68))
                                          ((longlong *)*puVar18,local_128,&local_138);
                        if (-1 < iVar7) {
                          puVar3 = (ushort *)param_1[5];
                          if (((4 < *puVar3) && (*(code **)(puVar3 + 0x80) != (code *)0x0)) &&
                             (*(longlong *)(puVar3 + 0x84) != 0)) {
                            if (puVar3 == (ushort *)0x0) {
                              uVar8 = 0x80004003;
                            }
                            else {
                              param_4 = &local_118;
                              uVar8 = (**(code **)(puVar3 + 0x80))(param_1,&local_a8,local_110);
                              if (-1 < (int)uVar8) {
                                local_f8 = local_128[0];
                                local_f0 = local_138;
                                if (param_1[5] == 0) {
                                  iVar7 = -0x7fffbffd;
                                }
                                else {
                                  pcVar2 = *(code **)(param_1[5] + 0x108);
                                  if (pcVar2 == (code *)0x0) {
                                    iVar7 = -0x7fffbfff;
                                  }
                                  else {
                                    iVar7 = (*pcVar2)(param_1,&local_118);
                                  }
                                }
                                param_4 = (int **)((ulonglong)local_f0 & 0xffffffff);
                                local_178 = (undefined8 *)CONCAT44(local_178._4_4_,iVar7);
                                FUN_180018310(1,0x18002d350,uVar16,param_4);
                                if (-1 < iVar7) goto LAB_1800196b8;
                                local_118 = (int *)&local_a8;
                                goto LAB_18001961e;
                              }
                            }
                            FUN_180018310(1,0x18002d300,(ulonglong)uVar8,param_4);
                            local_118 = (int *)&local_a8;
                          }
LAB_18001961e:
                          if (param_1[5] == 0) {
                            uVar8 = 0x80004003;
                          }
                          else {
                            param_4 = *(int ***)(param_1[5] + 0x70);
                            if (param_4 == (int **)0x0) {
                              uVar8 = 0x80004001;
                            }
                            else {
                              uVar8 = (*(code *)param_4)(param_1,local_118,local_110);
                              if (-1 < (int)uVar8) {
                                local_f8 = local_128[0];
                                local_f0 = local_138;
                                if (param_1[5] == 0) {
                                  uVar10 = 0x80004003;
                                }
                                else {
                                  pcVar2 = *(code **)(param_1[5] + 0x68);
                                  if (pcVar2 != (code *)0x0) {
                                    uVar10 = (*pcVar2)(param_1,&local_118);
                                  }
                                }
                                param_4 = (int **)((ulonglong)local_f0 & 0xffffffff);
                                local_178 = (undefined8 *)CONCAT44(local_178._4_4_,uVar10);
                                FUN_180018310(1,0x18002d3f0,uVar16,param_4);
                                goto LAB_1800196b8;
                              }
                            }
                          }
                          FUN_180018310(1,0x18002d3a0,(ulonglong)uVar8,param_4);
                        }
LAB_1800196b8:
                        (**(code **)(*(longlong *)*puVar18 + 0x70))();
                      }
                      uVar12 = *(undefined8 *)(local_118 + 2);
                      *local_c0 = *(undefined8 *)local_118;
                      local_c0[1] = uVar12;
                      uVar12 = *(undefined8 *)(local_118 + 6);
                      local_c0[2] = *(undefined8 *)(local_118 + 4);
                      local_c0[3] = uVar12;
                      uVar12 = *(undefined8 *)(local_118 + 10);
                      local_c0[4] = *(undefined8 *)(local_118 + 8);
                      local_c0[5] = uVar12;
                      uVar12 = *(undefined8 *)(local_118 + 0xe);
                      local_c0[6] = *(undefined8 *)(local_118 + 0xc);
                      local_c0[7] = uVar12;
                      local_c0[8] = *(undefined8 *)(local_118 + 0x10);
                      *(int *)(local_c0 + 9) = local_118[0x12];
                      *local_158 = local_110;
                      *local_d8 = local_e8;
                      *local_b8 = local_e0;
                      *local_d0 = 0;
                      *local_130 = 0;
                      FUN_180018310(1,0x18002d440,(ulonglong)*local_158,param_4);
                      goto LAB_1800198bf;
                    }
                  }
                  else if ((*local_118 == 3) && (BVar9 = IsValidSid(local_118 + 2), BVar9 != 0)) {
                    FUN_180018310(1,0x18002d4c8,uVar11,param_4);
                    if ((local_e0 == 0) || (local_e8 == (int *)0x0)) {
                      FUN_180018310(1,0x18002d508,uVar11,param_4);
                    }
                    else {
                      if ((short)*local_e8 == (short)uVar8) {
                        puVar18 = (undefined8 *)(ulonglong)local_140[0];
                        if ((puVar18 == local_f0) &&
                           (iVar7 = FUN_18001dae0(local_148,local_f8,(ulonglong)puVar18), iVar7 == 0
                           )) {
                          uVar12 = *(undefined8 *)(local_118 + 2);
                          *local_c0 = *(undefined8 *)local_118;
                          local_c0[1] = uVar12;
                          uVar12 = *(undefined8 *)(local_118 + 6);
                          local_c0[2] = *(undefined8 *)(local_118 + 4);
                          local_c0[3] = uVar12;
                          uVar12 = *(undefined8 *)(local_118 + 10);
                          local_c0[4] = *(undefined8 *)(local_118 + 8);
                          local_c0[5] = uVar12;
                          iVar7 = local_118[0xd];
                          iVar4 = local_118[0xe];
                          iVar5 = local_118[0xf];
                          *(int *)(local_c0 + 6) = local_118[0xc];
                          *(int *)((longlong)local_c0 + 0x34) = iVar7;
                          *(int *)(local_c0 + 7) = iVar4;
                          *(int *)((longlong)local_c0 + 0x3c) = iVar5;
                          local_c0[8] = *(undefined8 *)(local_118 + 0x10);
                          *(int *)(local_c0 + 9) = local_118[0x12];
                          *local_158 = local_110;
                          *local_d8 = local_e8;
                          *local_b8 = local_e0;
                          *local_d0 = 0;
                          *local_130 = 0;
                          pvVar13 = GetProcessHeap();
                          puVar19 = local_148;
                          HeapFree(pvVar13,0,local_148);
                          FUN_180018310(1,0x18002d5d8,puVar19,param_4);
                          goto LAB_1800198bf;
                        }
                        FUN_180018310(1,0x18002d590,puVar18,param_4);
LAB_18001980c:
                        uVar6 = (uint)ppiVar15;
                        param_3 = local_158;
                        goto LAB_180019811;
                      }
                      FUN_180018310(1,0x18002d550,uVar11,param_4);
                    }
                  }
                  else {
                    FUN_180018310(1,0x18002d480,uVar11,param_4);
                  }
                }
              }
              uVar11 = FUN_18001acb0((longlong)param_1);
              iVar7 = (int)uVar11;
              uVar6 = (uint)uVar16;
              while( true ) {
                uVar16 = (ulonglong)(uVar6 + 1);
                if (-1 < iVar7) break;
                ppiVar15 = (int **)(uVar11 & 0xffffffff);
                param_4 = ppiVar15;
                FUN_180018310(1,0x18002d610,(ulonglong)uVar6,ppiVar15);
                if ((int)uVar11 != -0x7ff67fe1) {
                  if ((int)uVar11 == -0x7ff67fe0) {
                    ppiVar15 = (int **)0x0;
                  }
                  goto LAB_18001980c;
                }
                uVar11 = FUN_18001acb0((longlong)param_1);
                iVar7 = (int)uVar11;
                uVar6 = uVar6 + 1;
              }
              FUN_180018310(1,0x18002d680,(ulonglong)uVar6,param_4);
              puVar18 = local_138;
              goto LAB_180019322;
            }
          }
        }
        goto LAB_180019811;
      }
    }
  }
  uVar6 = 0x80004003;
LAB_180019811:
  puVar19 = (ulonglong *)(ulonglong)uVar6;
  FUN_180018310(1,0x18002d6c8,puVar19,param_4);
  if (param_3 != (byte *)0x0) {
    *param_3 = 0;
  }
  if (local_148 != (ulonglong *)0x0) {
    pvVar13 = GetProcessHeap();
    puVar19 = local_148;
    HeapFree(pvVar13,0,local_148);
  }
  if (uVar6 == 0x80004003) {
    FUN_180018310(1,0x18002d708,puVar19,param_4);
  }
  else {
    FUN_180018310(1,0x18002d740,(ulonglong)uVar6,param_4);
  }
LAB_1800198bf:
  FUN_18001d530(local_58 ^ (ulonglong)auStack_198);
  return;
}



void FUN_1800198e0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined *param_4)

{
  undefined8 *puVar1;
  code *pcVar2;
  uint uVar3;
  undefined1 auStack_58 [32];
  ulonglong local_38;
  undefined1 local_30 [8];
  undefined1 local_28 [16];
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStack_58;
  FUN_180018310(1,0x18002d790,param_3,param_4);
  if (param_1 == 0) {
    uVar3 = 0x80004003;
    goto LAB_180019a36;
  }
  puVar1 = *(undefined8 **)(param_1 + 0x38);
  if (*(int *)(puVar1 + 1) == 1) {
    puVar1[1] = 0;
    *(undefined4 *)(puVar1 + 2) = 0x8009800f;
    (**(code **)(*(longlong *)*puVar1 + 0x70))();
    (**(code **)(*(longlong *)*puVar1 + 0x78))();
  }
  if (*(longlong *)(param_1 + 0x28) == 0) {
LAB_180019a27:
    uVar3 = 0x80004003;
  }
  else {
    param_4 = *(undefined **)(*(longlong *)(param_1 + 0x28) + 0x58);
    if ((code *)param_4 != (code *)0x0) {
      uVar3 = (*(code *)param_4)(param_1,local_28,local_30);
      if ((int)uVar3 < 0) goto LAB_180019a36;
      local_38 = 0;
      if (*(longlong *)(param_1 + 0x28) == 0) goto LAB_180019a27;
      pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x80);
      if (pcVar2 != (code *)0x0) {
        param_4 = (code *)0x0;
        uVar3 = (*pcVar2)(param_1,0xff,0);
        if ((int)uVar3 < 0) {
          if (uVar3 != 0x8009801f) goto LAB_180019a36;
        }
        else {
          if (*(longlong *)(param_1 + 0x28) == 0) goto LAB_180019a27;
          pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x88);
          if (pcVar2 == (code *)0x0) goto LAB_1800199cf;
          uVar3 = (*pcVar2)(param_1,&local_38);
          if ((int)uVar3 < 0) goto LAB_180019a36;
        }
        uVar3 = (**(code **)(*(longlong *)*puVar1 + 0x90))();
        if ((uVar3 == 0) || (local_38 < uVar3)) {
          uVar3 = (**(code **)(*(longlong *)*puVar1 + 0x58))();
          if (-1 < (int)uVar3) {
            puVar1[1] = 1;
            *(undefined4 *)(puVar1 + 2) = 0x90001;
          }
        }
        else {
          uVar3 = 0x80098018;
        }
        goto LAB_180019a36;
      }
    }
LAB_1800199cf:
    uVar3 = 0x80004001;
  }
LAB_180019a36:
  FUN_180018310(1,0x18002d7b8,(ulonglong)uVar3,param_4);
  FUN_18001d530(local_18 ^ (ulonglong)auStack_58);
  return;
}



uint FUN_180019a70(longlong param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4)

{
  longlong lVar1;
  uint uVar2;
  
  FUN_180018310(1,0x18002d7f0,param_3,param_4);
  if ((param_1 == 0) || (param_2 == (undefined4 *)0x0)) {
    uVar2 = 0x80004003;
  }
  else {
    *param_2 = 0;
    lVar1 = *(longlong *)(param_1 + 0x38);
    if (*(int *)(lVar1 + 8) == 0) {
      uVar2 = 0x8009800f;
    }
    else {
      *param_2 = *(undefined4 *)(lVar1 + 0xc);
      uVar2 = *(uint *)(lVar1 + 0x10);
    }
  }
  FUN_180018310(1,0x18002d818,(ulonglong)uVar2,param_4);
  return uVar2;
}



ulonglong FUN_180019b20(longlong param_1,undefined8 *param_2,byte *param_3,LPDWORD param_4)

{
  undefined8 *puVar1;
  code *pcVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  BOOL BVar6;
  DWORD DVar7;
  undefined8 uVar8;
  ulonglong uVar9;
  LPDWORD cchName;
  uint uVar10;
  DWORD local_res8 [2];
  ulonglong in_stack_ffffffffffffff68;
  DWORD local_78;
  _SID_NAME_USE local_74;
  ulonglong local_70;
  int *local_68;
  byte local_60;
  undefined8 local_48;
  undefined4 local_40;
  
  cchName = param_4;
  FUN_180018310(1,0x18002d850,param_3,param_4);
  uVar10 = 0;
  if ((((param_1 != 0) && (param_2 != (undefined8 *)0x0)) && (param_3 != (byte *)0x0)) &&
     (param_4 != (LPDWORD)0x0)) {
    puVar1 = *(undefined8 **)(param_1 + 0x38);
    if (*(int *)(puVar1 + 1) == 0) {
      uVar4 = 0x8009800f;
      goto LAB_180019db7;
    }
    *param_2 = 0;
    param_2[1] = 0;
    param_2[2] = 0;
    param_2[3] = 0;
    param_2[4] = 0;
    param_2[5] = 0;
    param_2[6] = 0;
    param_2[7] = 0;
    param_2[8] = 0;
    *(undefined4 *)(param_2 + 9) = 0;
    *(undefined4 *)param_2 = 0;
    *param_3 = 0;
    *(undefined1 *)param_4 = 0;
    if (*(longlong *)(param_1 + 0x28) != 0) {
      pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x80);
      if (pcVar2 != (code *)0x0) {
        cchName = (LPDWORD)0x0;
        uVar4 = (*pcVar2)(param_1,0xff,0);
        if ((int)uVar4 < 0) goto LAB_180019db7;
        if (*(longlong *)(param_1 + 0x28) == 0) goto LAB_180019db2;
        pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x88);
        if (pcVar2 != (code *)0x0) {
          uVar4 = (*pcVar2)(param_1,&local_70);
          if (-1 < (int)uVar4) {
            uVar8 = FUN_18001ac80(param_1);
            uVar4 = 0;
            if ((uint)uVar8 != 0x8009801f) {
              uVar9 = 0;
              uVar3 = (uint)uVar8;
              if (local_70 != 0) {
                do {
                  if (((*(longlong *)(param_1 + 0x28) != 0) &&
                      (pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0xa0),
                      pcVar2 != (code *)0x0)) &&
                     ((iVar5 = (*pcVar2)(param_1,&local_68), -1 < iVar5 && (local_68 != (int *)0x0))
                     )) {
                    if (*local_68 == 3) {
                      cchName = &local_78;
                      local_78 = 0;
                      in_stack_ffffffffffffff68 = 0;
                      local_res8[0] = 0;
                      BVar6 = LookupAccountSidA((LPCSTR)0x0,local_68 + 2,(LPSTR)0x0,cchName,
                                                (LPSTR)0x0,local_res8,&local_74);
                      if ((BVar6 == 0) && (DVar7 = GetLastError(), DVar7 != 0x7a))
                      goto LAB_180019d0a;
                    }
                    cchName = (LPDWORD)0x0;
                    in_stack_ffffffffffffff68 = in_stack_ffffffffffffff68 & 0xffffffff00000000;
                    iVar5 = (**(code **)(*(longlong *)*puVar1 + 0x50))
                                      ((longlong *)*puVar1,local_48,local_40,0,
                                       in_stack_ffffffffffffff68);
                    if (-1 < iVar5) {
                      FUN_180018310(1,0x18002d880,(ulonglong)local_60,cchName);
                      uVar8 = *(undefined8 *)(local_68 + 2);
                      *param_2 = *(undefined8 *)local_68;
                      param_2[1] = uVar8;
                      uVar8 = *(undefined8 *)(local_68 + 6);
                      param_2[2] = *(undefined8 *)(local_68 + 4);
                      param_2[3] = uVar8;
                      uVar8 = *(undefined8 *)(local_68 + 10);
                      param_2[4] = *(undefined8 *)(local_68 + 8);
                      param_2[5] = uVar8;
                      uVar8 = *(undefined8 *)(local_68 + 0xe);
                      param_2[6] = *(undefined8 *)(local_68 + 0xc);
                      param_2[7] = uVar8;
                      param_2[8] = *(undefined8 *)(local_68 + 0x10);
                      *(int *)(param_2 + 9) = local_68[0x12];
                      *param_3 = local_60;
                      *(undefined1 *)param_4 = 1;
                      goto LAB_180019d34;
                    }
                  }
LAB_180019d0a:
                  uVar8 = FUN_18001acb0(param_1);
                  if ((int)(uint)uVar8 < 0) goto LAB_180019db7;
                  uVar9 = uVar9 + 1;
                  uVar3 = (uint)uVar8;
                } while (uVar9 < local_70);
              }
              uVar10 = uVar3;
              uVar4 = uVar10;
              if ((char)*param_4 != '\0') {
LAB_180019d34:
                (**(code **)(*(longlong *)*puVar1 + 0x70))();
                puVar1[1] = 0;
                *(undefined4 *)(puVar1 + 2) = 0x8009800f;
                uVar4 = uVar10;
              }
            }
          }
          goto LAB_180019db7;
        }
      }
      uVar4 = 0x80004001;
      goto LAB_180019db7;
    }
  }
LAB_180019db2:
  uVar4 = 0x80004003;
LAB_180019db7:
  FUN_180018310(1,0x18002d8c8,(ulonglong)uVar4,cchName);
  uVar9 = (ulonglong)uVar4;
  if (uVar4 == 0x8009801f) {
    uVar9 = 0;
  }
  return uVar9;
}



uint FUN_180019e00(longlong param_1,longlong param_2,undefined8 param_3,undefined8 param_4,
                  undefined8 param_5)

{
  undefined8 *puVar1;
  code *pcVar2;
  uint uVar3;
  uint uVar4;
  ulonglong uVar5;
  char cVar6;
  undefined8 uVar7;
  ulonglong local_res8;
  longlong local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  undefined8 local_30;
  
  cVar6 = (char)param_3;
  local_68 = 0;
  local_60 = 0;
  local_58 = 0;
  local_50 = 0;
  local_48 = 0;
  local_40 = 0;
  local_38 = 0;
  local_30 = 0;
  uVar7 = param_4;
  FUN_180018310(1,0x18002d8f8,param_3,param_4);
  if ((param_1 == 0) || (param_2 == 0)) {
    uVar4 = 0x80004003;
    goto LAB_18001a008;
  }
  if (cVar6 == '\0') {
    uVar4 = 0x80070057;
    goto LAB_18001a008;
  }
  puVar1 = *(undefined8 **)(param_1 + 0x38);
  if (*(int *)(puVar1 + 1) != -1) {
    FUN_180018310(1,0x18002d920,param_3,uVar7);
    uVar4 = 0x8009800f;
    goto LAB_18001a008;
  }
  uVar3 = (**(code **)(*(longlong *)*puVar1 + 0x90))();
  if (uVar3 == 0) {
LAB_180019f62:
    local_60 = CONCAT71(local_60._1_7_,cVar6);
    local_58 = 0;
    local_50 = 0;
    local_48 = 0;
    local_30 = param_5;
    local_40 = 0;
    local_68 = param_2;
    local_38 = param_4;
    uVar4 = (**(code **)(*(longlong *)*puVar1 + 0x68))((longlong *)*puVar1,&local_48,&local_40);
    if (-1 < (int)uVar4) {
      if (*(longlong *)(param_1 + 0x28) == 0) {
        uVar5 = 0x80004003;
LAB_180019fdc:
        uVar4 = (uint)uVar5;
        FUN_180018310(1,0x18002d998,uVar5,uVar7);
      }
      else {
        pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x68);
        if (pcVar2 == (code *)0x0) {
          uVar5 = 0x80004001;
          goto LAB_180019fdc;
        }
        uVar4 = (*pcVar2)(param_1,&local_68);
        uVar5 = (ulonglong)uVar4;
        if ((int)uVar4 < 0) goto LAB_180019fdc;
      }
      (**(code **)(*(longlong *)*puVar1 + 0x70))();
      puVar1[1] = 0;
      *(undefined4 *)(puVar1 + 2) = 0;
      goto LAB_18001a008;
    }
  }
  else {
    local_res8 = 0;
    if (*(longlong *)(param_1 + 0x28) == 0) {
LAB_180019f48:
      uVar4 = 0x80004003;
    }
    else {
      pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x80);
      if (pcVar2 != (code *)0x0) {
        uVar7 = 0;
        uVar4 = (*pcVar2)(param_1,0xff,0);
        if ((int)uVar4 < 0) {
          if (uVar4 != 0x8009801f) {
LAB_180019f1f:
            if ((int)uVar4 < 0) goto LAB_180019f4d;
          }
          if (local_res8 < uVar3) goto LAB_180019f62;
          FUN_180018310(1,0x18002d950,local_res8,uVar7);
          uVar4 = 0x80098018;
          goto LAB_180019f4d;
        }
        if (*(longlong *)(param_1 + 0x28) == 0) goto LAB_180019f48;
        pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x88);
        if (pcVar2 != (code *)0x0) {
          uVar4 = (*pcVar2)(param_1,&local_res8);
          goto LAB_180019f1f;
        }
      }
      uVar4 = 0x80004001;
    }
  }
LAB_180019f4d:
  (**(code **)(*(longlong *)*puVar1 + 0x70))();
  puVar1[1] = 0;
  *(uint *)(puVar1 + 2) = uVar4;
LAB_18001a008:
  FUN_180018310(1,0x18002d9d0,(ulonglong)uVar4,uVar7);
  return uVar4;
}



uint FUN_18001a040(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 *puVar1;
  uint uVar2;
  
  uVar2 = 0;
  if (param_1 == 0) {
    uVar2 = 0x80004003;
  }
  else {
    puVar1 = *(undefined8 **)(param_1 + 0x38);
    if (*(int *)(puVar1 + 1) == 0) {
      uVar2 = 0x8009800f;
    }
    else {
      (**(code **)(*(longlong *)*puVar1 + 0x70))();
      puVar1[1] = 0;
      *(undefined4 *)(puVar1 + 2) = 0x8009800f;
    }
  }
  FUN_180018310(1,0x18002da00,(ulonglong)uVar2,param_4);
  return uVar2;
}



uint FUN_18001a0a0(longlong param_1,undefined8 param_2,longlong param_3,undefined8 param_4,
                  longlong param_5,undefined8 param_6,longlong param_7,longlong param_8)

{
  uint uVar1;
  
  FUN_180018310(1,0x18002da30,param_3,param_4);
  if ((((param_1 == 0) || (param_3 == 0)) || (param_5 == 0)) ||
     ((param_7 == 0 || (uVar1 = 0x80098009, param_8 == 0)))) {
    uVar1 = 0x80004003;
  }
  FUN_180018310(1,0x18002da50,(ulonglong)uVar1,param_4);
  return uVar1;
}



undefined8
FUN_18001a110(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002da88,param_3,param_4);
  return 0;
}



undefined8 FUN_18001a130(longlong param_1,uint param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002dab8,(ulonglong)param_2,param_4);
  if (param_1 == 0) {
    return 0x80004003;
  }
  if ((param_2 < 0x13) && ((0x40410U >> (param_2 & 0x1f) & 1) != 0)) {
    return 0;
  }
  return 0x80070057;
}



undefined8
FUN_18001a1a0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002dae8,param_3,param_4);
  return 0;
}



undefined8 FUN_18001a1c0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  
  FUN_180018310(1,0x18002db10,param_3,param_4);
  uVar1 = 0;
  if (param_1 == 0) {
    uVar1 = 0x80004003;
  }
  return uVar1;
}



undefined8 FUN_18001a1f0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  
  FUN_180018310(1,0x18002db38,param_3,param_4);
  uVar1 = 0;
  if (param_1 == 0) {
    uVar1 = 0x80004003;
  }
  return uVar1;
}



undefined8 FUN_18001a220(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  
  FUN_180018310(1,0x18002db58,param_3,param_4);
  uVar1 = 0;
  if (param_1 == 0) {
    uVar1 = 0x80004003;
  }
  return uVar1;
}



undefined8 FUN_18001a250(longlong param_1,longlong param_2,ulonglong param_3,undefined8 param_4)

{
  ulonglong uVar1;
  
  uVar1 = param_3;
  FUN_180018310(1,0x18002db78,param_3,param_4);
  if (param_1 == 0) {
    return 0x80004003;
  }
  if (param_3 < 0x24) {
    return 0x80070057;
  }
  *(undefined8 *)(param_2 + 4) = 8;
  *(undefined4 *)(param_2 + 0xc) = 10;
  *(undefined4 *)(param_2 + 0x10) = 6;
  *(undefined4 *)(param_2 + 0x14) = 1;
  *(undefined4 *)(param_2 + 0x18) = 1;
  *(undefined4 *)(param_2 + 0x1c) = 1;
  *(undefined4 *)(param_2 + 0x20) = 1;
  FUN_180018310(1,0x18002dba0,uVar1,param_4);
  return 0;
}



undefined8
FUN_18001a310(undefined8 param_1,undefined8 *param_2,undefined8 *param_3,undefined8 param_4)

{
  undefined8 *puVar1;
  
  puVar1 = param_3;
  FUN_180018310(1,0x18002dbc8,param_3,param_4);
  if ((param_2 != (undefined8 *)0x0) && (param_3 != (undefined8 *)0x0)) {
    *param_2 = 0;
    *param_3 = 0;
    FUN_180018310(1,0x18002dbe8,puVar1,param_4);
    return 0;
  }
  return 0x80004003;
}



undefined8 FUN_18001a370(longlong param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002dc08,param_3,param_4);
  if (param_1 == 0) {
    return 0x80004003;
  }
  if (param_2 != 0) {
    return 0x80070057;
  }
  FUN_180018310(1,0x18002dc30,param_3,param_4);
  return 0;
}



undefined8 FUN_18001a3e0(longlong param_1,longlong *param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002dc58,param_3,param_4);
  if (param_1 == 0) {
    return 0x80004003;
  }
  if (*param_2 == 0) {
    return 0x80070057;
  }
  *(char *)(*(longlong *)(param_1 + 0x38) + 0x41d8) = (char)param_2[1];
  FUN_180018310(1,0x18002dc88,param_3,param_4);
  return 0;
}



undefined8 FUN_18001a460(longlong param_1,undefined4 *param_2,ulonglong param_3,undefined8 param_4)

{
  undefined1 uVar1;
  undefined4 uVar2;
  longlong lVar3;
  ulonglong uVar4;
  
  uVar4 = param_3;
  FUN_180018310(1,0x18002dcb8,param_3,param_4);
  if ((param_1 == 0) || (param_2 == (undefined4 *)0x0)) {
    return 0x80004003;
  }
  lVar3 = *(longlong *)(param_1 + 0x38);
  if (param_3 < 0x170) {
    return 0x80070057;
  }
  if (*(int *)(lVar3 + 8) == 0) {
    return 0x8009802c;
  }
  *param_2 = *(undefined4 *)(lVar3 + 0x10);
  uVar2 = *(undefined4 *)(lVar3 + 0xc);
  param_2[3] = 8;
  param_2[1] = uVar2;
  uVar1 = *(undefined1 *)(lVar3 + 0x41d8);
  param_2[6] = 10;
  param_2[7] = 6;
  param_2[8] = 1;
  *(undefined1 *)(param_2 + 4) = uVar1;
  param_2[9] = 1;
  param_2[10] = 1;
  param_2[0xb] = 1;
  FUN_180018310(1,0x18002dce8,uVar4,param_4);
  return 0;
}



undefined8
FUN_18001a560(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002dd18,param_3,param_4);
  return 0;
}



undefined8
FUN_18001a580(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002dd40,param_3,param_4);
  return 0x80004001;
}



undefined8
FUN_18001a5a0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002dd70,param_3,param_4);
  return 0x80004001;
}



undefined8
FUN_18001a5c0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002dda0,param_3,param_4);
  return 0x80004001;
}



void FUN_18001a5e0(longlong *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  LPOVERLAPPED lpOverlapped;
  longlong *plVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  HANDLE pvVar5;
  longlong *lpMem;
  HLOCAL lpOutBuffer;
  undefined8 *puVar6;
  undefined1 auStackY_268 [32];
  DWORD local_228;
  DWORD local_224 [3];
  undefined8 local_218 [64];
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStackY_268;
  FUN_180018310(1,0x18002c808,param_3,param_4);
  if (param_1 == (longlong *)0x0) {
    DVar2 = 0x80004003;
    goto LAB_18001a8c5;
  }
  if ((param_1[7] == 0) && (param_1[1] == -1)) {
    if (*param_1 - 1U < 0xfffffffffffffffe) {
      FUN_180018220();
      pvVar5 = GetProcessHeap();
      lpMem = (longlong *)HeapAlloc(pvVar5,8,0x41e0);
      param_4 = 0;
      pvVar5 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCSTR)0x0);
      lpMem[0x83a] = (longlong)pvVar5;
      if (pvVar5 == (HANDLE)0x0) {
        DVar2 = GetLastError();
        if ((int)DVar2 < 1) {
          DVar2 = GetLastError();
        }
        else {
          DVar2 = GetLastError();
          DVar2 = DVar2 & 0xffff | 0x80070000;
        }
LAB_18001a846:
        if (-1 < (int)DVar2) goto LAB_18001a8c5;
      }
      else {
        *(undefined4 *)(lpMem + 1) = 0;
        lpOutBuffer = LocalAlloc(0,0x62c);
        if (lpOutBuffer != (HLOCAL)0x0) {
          lpOverlapped = (LPOVERLAPPED)(lpMem + 0x837);
          param_4 = 0;
          BVar3 = DeviceIoControl((HANDLE)*param_1,0x440004,(LPVOID)0x0,0,lpOutBuffer,0x62c,
                                  &local_228,lpOverlapped);
          if (BVar3 == 0) {
            DVar2 = GetLastError();
            if (DVar2 == 0x3e5) {
              param_4 = 1;
              BVar3 = GetOverlappedResult((HANDLE)*param_1,lpOverlapped,&local_228,1);
              if (BVar3 != 0) {
                ResetEvent((HANDLE)lpMem[0x83a]);
                goto LAB_18001a753;
              }
            }
LAB_18001a767:
            DVar2 = 0x8000ffff;
          }
          else {
LAB_18001a753:
            puVar6 = FUN_18001ad60((LPCWSTR)((longlong)lpOutBuffer + 0x21c));
            *lpMem = (longlong)puVar6;
            if (puVar6 == (undefined8 *)0x0) goto LAB_18001a767;
            param_4 = 0;
            BVar3 = DeviceIoControl((HANDLE)*param_1,0x220000,(LPVOID)0x0,0,local_218,0x200,
                                    &local_228,lpOverlapped);
            if (BVar3 == 0) {
              DVar2 = GetLastError();
              if (DVar2 == 0x3e5) {
                param_4 = 1;
                BVar3 = GetOverlappedResult((HANDLE)*param_1,lpOverlapped,&local_228,1);
                if (BVar3 != 0) {
                  ResetEvent((HANDLE)lpMem[0x83a]);
                  goto LAB_18001a7df;
                }
              }
LAB_18001a7ff:
              puVar6 = (undefined8 *)0x0;
            }
            else {
LAB_18001a7df:
              iVar4 = FUN_18001a910(local_218,local_218,0x100);
              if (iVar4 == 0) goto LAB_18001a7ff;
              puVar6 = local_218;
            }
            DVar2 = (**(code **)(*(longlong *)*lpMem + 0x30))((longlong *)*lpMem,param_1);
            if (-1 < (int)DVar2) {
              iVar4 = FUN_18001ab40(*param_1,(longlong *)*lpMem);
              if (iVar4 == 0) {
                FUN_180018310(1,0x18002c820,puVar6,param_4);
                DVar2 = 0x8000ffff;
              }
              else {
                param_1[7] = (longlong)lpMem;
              }
            }
          }
          LocalFree(lpOutBuffer);
          goto LAB_18001a846;
        }
        DVar2 = 0x8007000e;
      }
      plVar1 = (longlong *)*lpMem;
      if (plVar1 != (longlong *)0x0) {
        (**(code **)(*plVar1 + 0x38))(plVar1,param_1);
        FUN_18001ae90((undefined8 *)*lpMem);
      }
      if ((HANDLE)lpMem[0x83a] != (HANDLE)0x0) {
        CloseHandle((HANDLE)lpMem[0x83a]);
      }
      if (*lpMem != 0) {
        pvVar5 = GetProcessHeap();
        HeapFree(pvVar5,0,lpMem);
      }
      param_1[7] = 0;
      goto LAB_18001a8c5;
    }
    DVar2 = GetCurrentProcessId();
    BVar3 = ProcessIdToSessionId(DVar2,local_224);
    if (BVar3 != 0) {
      DVar2 = WTSGetActiveConsoleSessionId();
      if (local_224[0] == DVar2) {
        DVar2 = 0;
        goto LAB_18001a8c5;
      }
    }
  }
  DVar2 = 0x8009800f;
LAB_18001a8c5:
  FUN_180018310(1,0x18002c850,(ulonglong)DVar2,param_4);
  FUN_18001d530(local_18 ^ (ulonglong)auStackY_268);
  return;
}



void FUN_18001a910(undefined8 param_1,undefined8 *param_2,uint param_3)

{
  LPWSTR lpName;
  uint uVar1;
  LSTATUS LVar2;
  int iVar3;
  DWORD dwIndex;
  undefined1 auStackY_278 [32];
  HKEY local_248 [2];
  WCHAR local_238 [256];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_278;
  uVar1 = wsprintfW(local_238,L"SYSTEM\\CurrentControlSet\\Enum\\%s\\Device Parameters");
  dwIndex = 0;
  local_248[0] = (HKEY)0x0;
  LVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,local_238,0,8,local_248);
  if (LVar2 == 0) {
    local_238[uVar1] = L'\\';
    uVar1 = uVar1 + 1;
    lpName = local_238 + uVar1;
    while ((LVar2 = RegEnumKeyW(local_248[0],dwIndex,lpName,0x100 - uVar1), LVar2 != 0 ||
           (iVar3 = StrCmpNIW(lpName,L"Egis",4), iVar3 != 0))) {
      dwIndex = dwIndex + 1;
    }
    iVar3 = lstrlenW(lpName);
    if (uVar1 + iVar3 < param_3) {
      FUN_18001d560(param_2,(undefined8 *)local_238,(ulonglong)(uVar1 + iVar3 + 1) * 2);
      RegCloseKey(local_248[0]);
    }
    else {
      RegCloseKey(local_248[0]);
    }
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_278);
  return;
}



BOOL FUN_18001aa60(HANDLE param_1,LPVOID param_2,DWORD param_3,LPVOID param_4,DWORD param_5,
                  LPDWORD param_6)

{
  BOOL BVar1;
  DWORD DVar2;
  _OVERLAPPED local_28;
  
  local_28.Internal = 0;
  local_28.InternalHigh = 0;
  local_28.u.Pointer = (PVOID)0x0;
  local_28.hEvent = (HANDLE)0x0;
  local_28.hEvent = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
  BVar1 = DeviceIoControl(param_1,0x4427c0,param_2,param_3,param_4,param_5,param_6,&local_28);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 == 0x3e5) {
      BVar1 = GetOverlappedResult(param_1,&local_28,param_6,1);
    }
  }
  CloseHandle(local_28.hEvent);
  return BVar1;
}



void FUN_18001ab40(undefined8 param_1,longlong *param_2)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  longlong lVar3;
  UCHAR *pUVar4;
  undefined1 auStackY_68 [32];
  UCHAR local_38 [32];
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStackY_68;
  bVar1 = FUN_1800012f0("U2Vj",0x24,&DAT_18002c728,0x20,local_38);
  if ((int)CONCAT71(extraout_var,bVar1) != 0) {
    iVar2 = (**(code **)(*param_2 + 8))(param_2,&DAT_18002c750,0x40,local_38);
    pUVar4 = local_38;
    for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
      *pUVar4 = '\0';
      pUVar4 = pUVar4 + 1;
    }
    if (iVar2 != 0) {
      (**(code **)(*param_2 + 0x10))(param_2,param_1,FUN_18001aa60);
    }
  }
  FUN_18001d530(local_18 ^ (ulonglong)auStackY_68);
  return;
}



undefined8 FUN_18001ac10(void)

{
  return 1;
}



undefined8 WbioQueryEngineInterface(undefined8 *param_1)

{
  ulonglong uVar1;
  undefined8 uVar2;
  
                    // 0x1ac20  1  WbioQueryEngineInterface
  if (param_1 == (undefined8 *)0x0) {
    return 0x80004003;
  }
  uVar1 = (ulonglong)DAT_180046030;
  uVar2 = DAT_180046038;
  FUN_180018310(1,0x18002ddc8,uVar1,DAT_180046038);
  *param_1 = &DAT_180046030;
  FUN_180018310(1,0x18002ddf8,uVar1,uVar2);
  return 0;
}



undefined8 FUN_18001ac80(longlong param_1)

{
  code *UNRECOVERED_JUMPTABLE;
  undefined8 uVar1;
  
  if ((param_1 != 0) && (*(longlong *)(param_1 + 0x28) != 0)) {
    UNRECOVERED_JUMPTABLE = *(code **)(*(longlong *)(param_1 + 0x28) + 0x90);
    if (UNRECOVERED_JUMPTABLE == (code *)0x0) {
      return 0x80004001;
    }
                    // WARNING: Could not recover jumptable at 0x00018001aca0. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*UNRECOVERED_JUMPTABLE)();
    return uVar1;
  }
  return 0x80004003;
}



undefined8 FUN_18001acb0(longlong param_1)

{
  code *UNRECOVERED_JUMPTABLE;
  undefined8 uVar1;
  
  if ((param_1 != 0) && (*(longlong *)(param_1 + 0x28) != 0)) {
    UNRECOVERED_JUMPTABLE = *(code **)(*(longlong *)(param_1 + 0x28) + 0x98);
    if (UNRECOVERED_JUMPTABLE == (code *)0x0) {
      return 0x80004001;
    }
                    // WARNING: Could not recover jumptable at 0x00018001acd0. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*UNRECOVERED_JUMPTABLE)();
    return uVar1;
  }
  return 0x80004003;
}



undefined8 * FUN_18001ace0(undefined8 *param_1,LPCWSTR param_2,int param_3,int param_4)

{
  LPWSTR pWVar1;
  ulonglong uVar2;
  
  FUN_18001c070(param_1,param_3,param_4);
  *param_1 = CET510Sensor::vftable;
  pWVar1 = StrStrIW(param_2,L"Rev");
  if (((pWVar1 != (LPWSTR)0x0) &&
      (uVar2 = FUN_18001e294(pWVar1 + 3,(undefined8 *)0x0,0x10), (uVar2 & 0xffff0000) == 0)) &&
     (((byte)uVar2 & 0xf) == 1)) {
    *(undefined4 *)(param_1 + 0xe) = 0x14;
    return param_1;
  }
  return param_1;
}



undefined8 * FUN_18001ad60(LPCWSTR param_1)

{
  LPWSTR pWVar1;
  undefined8 *puVar2;
  
  pWVar1 = StrStrW(param_1,L"ET310");
  if (pWVar1 == (LPWSTR)0x0) {
    pWVar1 = StrStrW(param_1,L"ET320");
    if (pWVar1 == (LPWSTR)0x0) {
      pWVar1 = StrStrW(param_1,L"ET510");
      if (pWVar1 == (LPWSTR)0x0) {
        puVar2 = (undefined8 *)FUN_18001d1c0(0x198);
        if (puVar2 == (undefined8 *)0x0) {
          puVar2 = (undefined8 *)0x0;
        }
        else {
          puVar2 = FUN_18001c070(puVar2,0x80,0x80);
        }
      }
      else {
        puVar2 = (undefined8 *)FUN_18001d1c0(0x198);
        if (puVar2 == (undefined8 *)0x0) {
          puVar2 = (undefined8 *)0x0;
        }
        else {
          puVar2 = FUN_18001ace0(puVar2,param_1,0x67,0x34);
        }
      }
    }
    else {
      puVar2 = (undefined8 *)FUN_18001d1c0(0x198);
      if (puVar2 == (undefined8 *)0x0) {
        puVar2 = (undefined8 *)0x0;
      }
      else {
        FUN_18001c070(puVar2,0x72,0x39);
        *puVar2 = CET320Sensor::vftable;
      }
    }
  }
  else {
    puVar2 = (undefined8 *)FUN_18001d1c0(0x198);
    if (puVar2 == (undefined8 *)0x0) {
      puVar2 = (undefined8 *)0x0;
    }
    else {
      FUN_18001c070(puVar2,0x90,0x40);
      *puVar2 = CET310Sensor::vftable;
    }
  }
  return puVar2;
}



void FUN_18001ae90(undefined8 *param_1)

{
  if (param_1 != (undefined8 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018001ae9d. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)*param_1)(param_1,1);
    return;
  }
  return;
}



char * FUN_18001aeb0(void)

{
  return "SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters";
}



char * FUN_18001aec0(void)

{
  return "SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters\\Area\\ET310";
}



char * FUN_18001aed0(void)

{
  return "SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters\\Area\\ET320";
}



char * FUN_18001aee0(void)

{
  return "SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters\\Area\\ET510";
}



char * FUN_18001aef0(void)

{
  return "SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters\\Area\\ET300";
}



undefined8 FUN_18001af00(void)

{
  return 2;
}



undefined8 FUN_18001af10(void)

{
  return 3;
}



undefined8 FUN_18001af20(void)

{
  return 5;
}



uint FUN_18001af30(uint *param_1,uint param_2)

{
  uint *puVar1;
  byte bVar2;
  uint uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  
  uVar4 = 0;
  puVar1 = (uint *)((ulonglong)(param_2 & 3) + (longlong)param_1);
  bVar2 = 0;
  uVar6 = (longlong)puVar1 - (longlong)param_1;
  if (puVar1 < param_1) {
    uVar6 = uVar4;
  }
  uVar5 = uVar4;
  if (uVar6 != 0) {
    do {
      bVar2 = bVar2 ^ (byte)*param_1;
      uVar5 = uVar5 + 1;
      param_1 = (uint *)((longlong)param_1 + 1);
    } while (uVar5 < uVar6);
    uVar5 = (ulonglong)bVar2;
  }
  uVar6 = (ulonglong)((longlong)((ulonglong)param_2 + (longlong)param_1) + (3 - (longlong)param_1))
          >> 2;
  if ((uint *)((ulonglong)param_2 + (longlong)param_1) < param_1) {
    uVar6 = uVar4;
  }
  if (uVar6 != 0) {
    do {
      uVar3 = (uint)uVar5 ^ *param_1;
      uVar5 = (ulonglong)uVar3;
      uVar4 = uVar4 + 1;
      param_1 = param_1 + 1;
    } while (uVar4 < uVar6);
    bVar2 = (byte)uVar3;
  }
  return (uint)(uVar5 >> 0x18) ^ (uint)(uVar5 >> 0x10) ^ (uint)uVar5 >> 8 ^ (uint)bVar2;
}



undefined8 FUN_18001afe0(undefined8 *param_1,undefined8 *param_2)

{
  undefined8 uVar1;
  undefined1 (*pauVar2) [16];
  
  pauVar2 = (undefined1 (*) [16])LocalAlloc(0,0x58);
  FUN_18001dbc0(pauVar2,0,0x58);
  if (param_1 != (undefined8 *)0x0) {
    uVar1 = param_1[1];
    *(undefined8 *)*pauVar2 = *param_1;
    *(undefined8 *)(*pauVar2 + 8) = uVar1;
    *(undefined8 *)pauVar2[1] = param_1[2];
    if (param_1[1] != 0) {
      *(undefined4 *)(pauVar2[1] + 8) = 1;
    }
  }
  *(undefined4 *)pauVar2[2] = 0xffffffff;
  *param_2 = pauVar2;
  return 1;
}



void FUN_18001b060(HLOCAL param_1)

{
  undefined8 *hMem;
  undefined8 *hMem_00;
  
  if (*(HLOCAL *)((longlong)param_1 + 0x28) != (HLOCAL)0x0) {
    LocalFree(*(HLOCAL *)((longlong)param_1 + 0x28));
  }
  if (*(HLOCAL *)((longlong)param_1 + 0x30) != (HLOCAL)0x0) {
    LocalFree(*(HLOCAL *)((longlong)param_1 + 0x30));
  }
  hMem = *(undefined8 **)((longlong)param_1 + 0x40);
  while (hMem != (undefined8 *)0x0) {
    *(undefined8 *)((longlong)param_1 + 0x40) = *hMem;
    hMem_00 = (undefined8 *)hMem[1];
    while (hMem_00 != (undefined8 *)0x0) {
      hMem[1] = *hMem_00;
      LocalFree(hMem_00);
      hMem_00 = (undefined8 *)hMem[1];
    }
    LocalFree(hMem);
    hMem = *(undefined8 **)((longlong)param_1 + 0x40);
  }
                    // WARNING: Could not recover jumptable at 0x00018001b0e8. Too many branches
                    // WARNING: Treating indirect jump as call
  LocalFree(param_1);
  return;
}



bool FUN_18001b0f0(undefined8 param_1,longlong param_2,longlong param_3,uint *param_4)

{
  undefined8 *puVar1;
  longlong lVar2;
  
  if ((param_3 != 0) && (*(uint *)(param_2 + 0x10) <= *param_4)) {
    *param_4 = 0;
    for (puVar1 = *(undefined8 **)(param_2 + 8); puVar1 != (undefined8 *)0x0;
        puVar1 = (undefined8 *)*puVar1) {
      lVar2 = puVar1[1];
      FUN_18001d560((undefined8 *)((ulonglong)*param_4 + param_3),
                    (undefined8 *)(lVar2 + -0xff0 + (ulonglong)*(ushort *)(lVar2 + 10)),
                    (ulonglong)*(ushort *)(lVar2 + 0xc));
      *param_4 = *param_4 + (uint)*(ushort *)(lVar2 + 0xc);
    }
    return true;
  }
  *param_4 = *(uint *)(param_2 + 0x10);
  return param_3 == 0;
}



undefined8 FUN_18001b1a0(longlong param_1,int param_2,longlong *param_3)

{
  undefined8 *puVar1;
  
  puVar1 = *(undefined8 **)(param_1 + 0x40);
  if (param_2 == 0) {
    if (puVar1 != (undefined8 *)0x0) {
LAB_18001b1ad:
      *param_3 = (longlong)puVar1;
      return 1;
    }
  }
  else {
    for (; puVar1 != (undefined8 *)0x0; puVar1 = (undefined8 *)*puVar1) {
      if (*(int *)((longlong)puVar1 + 0x14) == param_2) goto LAB_18001b1ad;
    }
  }
  return 0;
}



bool FUN_18001b1d0(longlong param_1,undefined8 *param_2,uint *param_3)

{
  ushort uVar1;
  uint uVar2;
  
  uVar1 = *(ushort *)(*(longlong *)(param_1 + 0x28) + 2);
  if (uVar1 == 0) {
    return false;
  }
  if (param_2 != (undefined8 *)0x0) {
    uVar2 = (uint)uVar1;
    if (uVar2 <= *param_3) {
      if (uVar2 < *param_3) {
        *param_3 = uVar2;
      }
      FUN_18001d560(param_2,(undefined8 *)
                            (*(longlong *)(param_1 + 0x28) + 0x10 +
                            (ulonglong)*(ushort *)(*(longlong *)(param_1 + 0x28) + 0xe) * 2),
                    (ulonglong)*param_3);
      return true;
    }
  }
  *param_3 = (uint)uVar1;
  return param_2 == (undefined8 *)0x0;
}



undefined8 FUN_18001b240(longlong param_1,ushort param_2,longlong param_3)

{
  longlong lVar1;
  uint uVar2;
  uint uVar3;
  undefined8 *puVar4;
  undefined1 (*hMem) [16];
  undefined8 *puVar5;
  uint *puVar6;
  undefined8 *puVar7;
  undefined8 *puVar8;
  longlong *plVar9;
  ushort uVar10;
  undefined8 *puVar11;
  ushort uVar12;
  uint uVar13;
  ushort uVar14;
  ushort uVar15;
  ushort uVar16;
  ulonglong uVar17;
  int iVar18;
  ulonglong uVar19;
  uint *puVar20;
  
  puVar20 = (uint *)0x0;
  uVar13 = 0xffffffff;
  iVar18 = 0;
  if ((((param_3 == 0) || (param_2 == 0)) || (param_1 == 0)) || (*(longlong *)(param_1 + 0x50) != 0)
     ) {
    return 0;
  }
  if (param_2 != 0) {
    puVar6 = (uint *)(param_3 + 0xff4);
    uVar17 = (ulonglong)(((uint)param_2 * 0x1000 - 1 >> 0xc) + 1);
    do {
      uVar2 = puVar6[-1];
      if (((uVar2 == 0x4b4c42) || (uVar2 == 0x424154)) &&
         ((*(char *)((longlong)puVar6 + 0xb) == '\0' &&
          ((uVar3 = FUN_18001af30(puVar6 + -0x3fd,0x1000), (char)uVar3 == '\0' &&
           (uVar2 == 0x424154)))))) {
        if ((iVar18 == 0) || ((uVar2 = *puVar6, uVar13 < uVar2 && (uVar2 - uVar13 < 0x7fffffff)))) {
          uVar13 = *puVar6;
LAB_18001b343:
          puVar20 = puVar6 + -0x3fd;
        }
        else if ((uVar2 == uVar13) &&
                ((*(ushort *)
                   ((longlong)puVar6 +
                   ((ulonglong)((longlong)puVar6 + (-0xff4 - param_3)) >> 0xc) * 2 + -0xfe4) &
                 0x9000) == 0x1000)) goto LAB_18001b343;
        iVar18 = iVar18 + 1;
      }
      puVar6 = puVar6 + 0x400;
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
    if (iVar18 != 0) {
      *(uint *)(param_1 + 0x1c) = uVar13;
      *(longlong *)(param_1 + 0x50) = param_3;
      uVar16 = 0;
      uVar15 = 0;
      uVar14 = 0;
      uVar10 = 0;
      *(int *)(param_1 + 0x20) =
           (int)((longlong)
                 (((longlong)puVar20 - param_3) +
                 (ulonglong)((uint)((longlong)puVar20 - param_3 >> 0x3f) & 0xfff)) >> 0xc);
      uVar12 = uVar16;
      if (*(ushort *)((longlong)puVar20 + 0xe) != 0) {
        puVar6 = puVar20 + 4;
        uVar17 = (ulonglong)*(ushort *)((longlong)puVar20 + 0xe);
        do {
          uVar13 = *puVar6;
          if ((uVar13 & 0x8000) == 0) {
            if ((uVar13 & 0x1000) == 0) {
LAB_18001b3eb:
              if (((uVar13 & 0x2000) != 0) && (uVar12 = uVar12 + 1, (uVar13 & 0x4000) != 0)) {
                uVar10 = uVar10 + 1;
              }
            }
            else {
              uVar16 = uVar16 + 1;
              if ((uVar13 & 0x2000) != 0) {
                uVar15 = uVar15 + 1;
                goto LAB_18001b3eb;
              }
            }
            uVar14 = uVar14 + 1;
          }
          puVar6 = (uint *)((longlong)puVar6 + 2);
          uVar17 = uVar17 - 1;
        } while (uVar17 != 0);
      }
      uVar17 = 0;
      if (((((ushort)puVar20[1] != uVar16) || (*(ushort *)((longlong)puVar20 + 6) != uVar15)) ||
          ((ushort)puVar20[2] != uVar12)) ||
         ((*(ushort *)((longlong)puVar20 + 10) != uVar10 || ((ushort)puVar20[3] != uVar14)))) {
        *(ushort *)(puVar20 + 1) = uVar16;
        *(ushort *)((longlong)puVar20 + 6) = uVar15;
        *(ushort *)(puVar20 + 2) = uVar12;
        *(ushort *)((longlong)puVar20 + 10) = uVar10;
        *(ushort *)(puVar20 + 3) = uVar14;
      }
      puVar4 = (undefined8 *)LocalAlloc(0,(ulonglong)(ushort)*puVar20);
      *(undefined8 **)(param_1 + 0x28) = puVar4;
      FUN_18001d560(puVar4,(undefined8 *)puVar20,(ulonglong)(ushort)*puVar20);
      puVar4 = (undefined8 *)LocalAlloc(0,(ulonglong)(ushort)*puVar20);
      *(undefined8 **)(param_1 + 0x30) = puVar4;
      FUN_18001d560(puVar4,(undefined8 *)puVar20,(ulonglong)(ushort)*puVar20);
      hMem = (undefined1 (*) [16])LocalAlloc(0,0x8000);
      FUN_18001dbc0(hMem,0,0x8000);
      uVar19 = uVar17;
      if (*(ushort *)((longlong)puVar20 + 0xe) != 0) {
        do {
          uVar12 = *(ushort *)((longlong)puVar20 + uVar19 * 2 + 0x10);
          if ((uVar12 & 0x9000) == 0x1000) {
            lVar1 = uVar17 + *(longlong *)(param_1 + 0x50) + 0xff0;
            uVar13 = uVar12 & 0xffff0fff;
            if (((uVar12 & 0xfff) != 0) && (*(short *)(lVar1 + 0xc) != 0)) {
              puVar4 = *(undefined8 **)(*hMem + (ulonglong)uVar13 * 8);
              if (puVar4 == (undefined8 *)0x0) {
                puVar4 = (undefined8 *)LocalAlloc(0,0x20);
                *(undefined8 **)(*hMem + (ulonglong)uVar13 * 8) = puVar4;
                *puVar4 = 0;
                puVar4[1] = 0;
                puVar4[2] = 0;
                puVar4[3] = 0;
                *(uint *)((longlong)puVar4 + 0x14) = uVar13;
                puVar11 = (undefined8 *)(param_1 + 0x40);
                for (puVar8 = *(undefined8 **)(param_1 + 0x40);
                    (puVar8 != (undefined8 *)0x0 && (*(uint *)((longlong)puVar8 + 0x14) <= uVar13));
                    puVar8 = (undefined8 *)*puVar8) {
                  puVar11 = puVar8;
                }
                *puVar4 = puVar8;
                *puVar11 = puVar4;
                *(int *)(param_1 + 0x48) = *(int *)(param_1 + 0x48) + 1;
              }
              puVar5 = (undefined8 *)LocalAlloc(0,0x10);
              puVar11 = puVar4 + 1;
              *puVar5 = 0;
              puVar5[1] = lVar1;
              puVar8 = (undefined8 *)*puVar11;
              if (puVar8 != (undefined8 *)0x0) {
                do {
                  puVar7 = puVar8;
                  puVar8 = puVar7;
                  if (*(ushort *)(lVar1 + 8) < *(ushort *)(puVar7[1] + 8)) break;
                  puVar8 = (undefined8 *)*puVar7;
                  puVar11 = puVar7;
                } while (puVar8 != (undefined8 *)0x0);
              }
              *puVar5 = puVar8;
              *puVar11 = puVar5;
              *(uint *)(puVar4 + 2) = *(int *)(puVar4 + 2) + (uint)*(ushort *)(lVar1 + 0xc);
              *(int *)(puVar4 + 3) = *(int *)(puVar4 + 3) + 1;
            }
          }
          uVar13 = (int)uVar19 + 1;
          uVar17 = (ulonglong)((int)uVar17 + 0x1000);
          uVar19 = (ulonglong)uVar13;
        } while (uVar13 < *(ushort *)((longlong)puVar20 + 0xe));
      }
      LocalFree(hMem);
      plVar9 = *(longlong **)(param_1 + 0x40);
      *(undefined4 *)(param_1 + 0x4c) = 1;
      if (plVar9 != (longlong *)0x0) {
        iVar18 = 1;
        do {
          if (iVar18 == *(int *)((longlong)plVar9 + 0x14)) {
            iVar18 = iVar18 + 1;
            *(int *)(param_1 + 0x4c) = iVar18;
          }
          plVar9 = (longlong *)*plVar9;
        } while (plVar9 != (longlong *)0x0);
      }
      if (0xfff < *(uint *)(param_1 + 0x4c)) {
        *(undefined4 *)(param_1 + 0x4c) = 0;
      }
      return 1;
    }
  }
  return 0;
}



uint FUN_18001b660(undefined8 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD local_res8 [2];
  
  FUN_180018310(4,0x18002e240,param_3,param_4);
  DVar2 = 0;
  if ((HANDLE)*param_1 == (HANDLE)0x0) {
    DVar2 = 0x80070006;
  }
  else {
    param_4 = 0;
    BVar1 = DeviceIoControl((HANDLE)*param_1,0x44200c,(LPVOID)0x0,0,(LPVOID)0x0,0,local_res8,
                            (LPOVERLAPPED)0x0);
    if ((BVar1 == 0) && (DVar2 = GetLastError(), 0 < (int)DVar2)) {
      DVar2 = DVar2 & 0xffff | 0x80070000;
    }
  }
  FUN_180018310(4,0x18002e250,(ulonglong)DVar2,param_4);
  return DVar2;
}



void FUN_18001b700(void)

{
  DWORD dwErrCode;
  BOOL BVar1;
  DWORD DVar2;
  HDEVINFO DeviceInfoSet;
  PSP_DEVICE_INTERFACE_DETAIL_DATA_A DeviceInterfaceDetailData;
  HANDLE pvVar3;
  undefined1 auStackY_198 [32];
  DWORD local_158 [2];
  _SP_DEVICE_INTERFACE_DATA local_150;
  CHAR local_128 [272];
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStackY_198;
  dwErrCode = 0;
  DeviceInfoSet = SetupDiGetClassDevsA((GUID *)&DAT_18002e210,(PCSTR)0x0,(HWND)0x0,0x12);
  if (DeviceInfoSet == (HDEVINFO)0xffffffffffffffff) {
    dwErrCode = GetLastError();
    goto LAB_18001b860;
  }
  local_150.cbSize = 0x20;
  BVar1 = SetupDiEnumDeviceInterfaces
                    (DeviceInfoSet,(PSP_DEVINFO_DATA)0x0,(GUID *)&DAT_18002e210,0,&local_150);
  DeviceInterfaceDetailData = (PSP_DEVICE_INTERFACE_DETAIL_DATA_A)0x0;
  if (BVar1 == 0) {
LAB_18001b842:
    dwErrCode = GetLastError();
  }
  else {
    SetupDiGetDeviceInterfaceDetailA
              (DeviceInfoSet,&local_150,(PSP_DEVICE_INTERFACE_DETAIL_DATA_A)0x0,0,local_158,
               (PSP_DEVINFO_DATA)0x0);
    DVar2 = GetLastError();
    DeviceInterfaceDetailData = (PSP_DEVICE_INTERFACE_DETAIL_DATA_A)0x0;
    if (DVar2 != 0x7a) goto LAB_18001b842;
    DeviceInterfaceDetailData =
         (PSP_DEVICE_INTERFACE_DETAIL_DATA_A)FUN_18001d1c0((ulonglong)(local_158[0] + 1));
    if (DeviceInterfaceDetailData == (PSP_DEVICE_INTERFACE_DETAIL_DATA_A)0x0) goto LAB_18001b842;
    DeviceInterfaceDetailData->cbSize = 8;
    BVar1 = SetupDiGetDeviceInterfaceDetailA
                      (DeviceInfoSet,&local_150,DeviceInterfaceDetailData,local_158[0],(PDWORD)0x0,
                       (PSP_DEVINFO_DATA)0x0);
    if (BVar1 == 0) goto LAB_18001b842;
    FUN_18001de48(local_128,0x104,DeviceInterfaceDetailData->DevicePath);
    pvVar3 = CreateFileA(local_128,0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
    if (pvVar3 == (HANDLE)0xffffffffffffffff) goto LAB_18001b842;
  }
  SetupDiDestroyDeviceInfoList(DeviceInfoSet);
  if (DeviceInterfaceDetailData != (PSP_DEVICE_INTERFACE_DETAIL_DATA_A)0x0) {
    thunk_FUN_18001d45c(DeviceInterfaceDetailData);
  }
LAB_18001b860:
  SetLastError(dwErrCode);
  FUN_18001d530(local_18 ^ (ulonglong)auStackY_198);
  return;
}



undefined1 FUN_18001b8a0(longlong param_1,undefined1 param_2)

{
  bool bVar1;
  undefined8 *hMem;
  undefined7 extraout_var;
  ulonglong uVar2;
  undefined1 *puVar3;
  uint local_res18 [2];
  
  local_res18[0] = 0;
  FUN_18001b1d0(param_1,(undefined8 *)0x0,local_res18);
  if (local_res18[0] != 0) {
    hMem = (undefined8 *)LocalAlloc(0,(ulonglong)local_res18[0]);
    bVar1 = FUN_18001b1d0(param_1,hMem,local_res18);
    if (((int)CONCAT71(extraout_var,bVar1) != 0) && (local_res18[0] != 0)) {
      puVar3 = (undefined1 *)((longlong)hMem + 4);
      uVar2 = (ulonglong)((local_res18[0] - 1) / 5 + 1);
      do {
        if (*(int *)(puVar3 + -4) == 0x4d414730) {
          param_2 = *puVar3;
        }
        puVar3 = puVar3 + 5;
        uVar2 = uVar2 - 1;
      } while (uVar2 != 0);
    }
    LocalFree(hMem);
  }
  return param_2;
}



ulonglong FUN_18001b980(longlong param_1,int param_2,undefined8 *param_3,uint *param_4)

{
  undefined1 uVar1;
  undefined1 uVar2;
  BOOL BVar3;
  DWORD DVar4;
  undefined8 uVar5;
  undefined8 *puVar6;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  ulonglong dwBytes;
  LPVOID pvVar7;
  HANDLE pvVar8;
  LPDWORD pDVar9;
  longlong lVar10;
  uint uVar11;
  char *pcVar12;
  ulonglong uVar13;
  LPDWORD lpBuffer;
  LPDWORD lpMem;
  HANDLE hFile;
  undefined8 uVar14;
  LPDWORD pDVar15;
  LPDWORD lpNumberOfBytesRead;
  uint *puVar16;
  uint local_res8 [2];
  DWORD local_48 [2];
  HLOCAL local_40;
  HLOCAL local_38;
  longlong local_30;
  
  lVar10 = *(longlong *)(param_1 + 0x38);
  pDVar9 = (LPDWORD)0x0;
  pcVar12 = (char *)(lVar10 + 0x20);
  lpMem = (LPDWORD)0x0;
  local_40 = (HLOCAL)0x0;
  local_38 = (HLOCAL)0x0;
  lpBuffer = (LPDWORD)0x0;
  if (*pcVar12 == '\0') {
    uVar5 = 1;
    BVar3 = SHGetSpecialFolderPathA((HWND)0x0,pcVar12,0x23,1);
    if (BVar3 != 0) {
      FUN_18001e970(pcVar12,0x104,"\\EgisTec\\Common\\BackupFile.bin");
      goto LAB_18001b9f6;
    }
    hFile = (HANDLE)0xffffffffffffffff;
  }
  else {
LAB_18001b9f6:
    uVar5 = 0;
    hFile = CreateFileA(pcVar12,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,2,(HANDLE)0x0);
    if (hFile != (HANDLE)0xffffffffffffffff) {
      pvVar8 = GetProcessHeap();
      uVar14 = 0x400000;
      lpBuffer = (LPDWORD)HeapAlloc(pvVar8,8,0x400000);
      if (lpBuffer == (LPDWORD)0x0) {
        FUN_180018310(4,0x18002e2b0,uVar14,uVar5);
        uVar13 = 0x8007000e;
        goto LAB_18001bd66;
      }
      lpNumberOfBytesRead = (LPDWORD)0x0;
      DVar4 = SetFilePointer(hFile,4,(PLONG)0x0,0);
      if (DVar4 != 0xffffffff) {
        lpNumberOfBytesRead = local_48;
        pDVar15 = (LPDWORD)0x400000;
        BVar3 = ReadFile(hFile,lpBuffer,0x400000,lpNumberOfBytesRead,(LPOVERLAPPED)0x0);
        if (BVar3 != 0) {
          uVar5 = FUN_18001afe0((undefined8 *)0x0,&local_38);
          if (((int)uVar5 == 0) ||
             (pDVar15 = lpBuffer, uVar5 = FUN_18001b240((longlong)local_38,0x400,(longlong)lpBuffer)
             , (int)uVar5 == 0)) {
            pcVar12 = "PBACheckFPIDValid : CreateFlashControl( Backup ) Fail";
LAB_18001bd57:
            uVar13 = 0xa0098010;
            lpMem = pDVar9;
          }
          else {
            pvVar8 = GetProcessHeap();
            pDVar15 = (LPDWORD)0x400000;
            lpMem = (LPDWORD)HeapAlloc(pvVar8,8,0x400000);
            if (lpMem == (LPDWORD)0x0) {
              FUN_180018310(4,0x18002e350,pDVar15,lpNumberOfBytesRead);
              uVar13 = 0x8007000e;
              goto LAB_18001bd66;
            }
            puVar6 = *(undefined8 **)(lVar10 + 0x4148);
            if (puVar6 == (undefined8 *)0x0) {
              pDVar15 = (LPDWORD)0x400;
              lpNumberOfBytesRead = lpMem;
              uVar11 = FUN_18001be60(param_1,0,0x400,(undefined8 *)lpMem);
              if (0 < (int)uVar11) {
                uVar11 = uVar11 & 0xffff | 0x80070000;
              }
              uVar13 = (ulonglong)uVar11;
              if ((int)uVar11 < 0) goto LAB_18001bd66;
            }
            else {
              lVar10 = 0x8000;
              pDVar9 = lpMem;
              do {
                uVar5 = puVar6[1];
                *(undefined8 *)pDVar9 = *puVar6;
                *(undefined8 *)(pDVar9 + 2) = uVar5;
                uVar5 = puVar6[3];
                *(undefined8 *)(pDVar9 + 4) = puVar6[2];
                *(undefined8 *)(pDVar9 + 6) = uVar5;
                uVar5 = puVar6[5];
                *(undefined8 *)(pDVar9 + 8) = puVar6[4];
                *(undefined8 *)(pDVar9 + 10) = uVar5;
                uVar5 = puVar6[7];
                *(undefined8 *)(pDVar9 + 0xc) = puVar6[6];
                *(undefined8 *)(pDVar9 + 0xe) = uVar5;
                uVar5 = puVar6[9];
                *(undefined8 *)(pDVar9 + 0x10) = puVar6[8];
                *(undefined8 *)(pDVar9 + 0x12) = uVar5;
                uVar5 = puVar6[0xb];
                *(undefined8 *)(pDVar9 + 0x14) = puVar6[10];
                *(undefined8 *)(pDVar9 + 0x16) = uVar5;
                uVar5 = puVar6[0xd];
                *(undefined8 *)(pDVar9 + 0x18) = puVar6[0xc];
                *(undefined8 *)(pDVar9 + 0x1a) = uVar5;
                uVar5 = puVar6[0xf];
                *(undefined8 *)(pDVar9 + 0x1c) = puVar6[0xe];
                *(undefined8 *)(pDVar9 + 0x1e) = uVar5;
                lVar10 = lVar10 + -1;
                puVar6 = puVar6 + 0x10;
                pDVar9 = pDVar9 + 0x20;
              } while (lVar10 != 0);
            }
            uVar5 = FUN_18001afe0((undefined8 *)0x0,&local_40);
            if (((int)uVar5 == 0) ||
               (pDVar15 = lpMem, uVar5 = FUN_18001b240((longlong)local_40,0x400,(longlong)lpMem),
               (int)uVar5 == 0)) {
              pcVar12 = "PBACheckFPIDValid : CreateFlashControl( Flash ) Fail";
              pDVar9 = lpMem;
              goto LAB_18001bd57;
            }
            uVar1 = FUN_18001b8a0((longlong)local_38,0xff);
            uVar2 = FUN_18001b8a0((longlong)local_40,0);
            if ((int)CONCAT71(extraout_var_00,uVar2) == (int)CONCAT71(extraout_var,uVar1)) {
              pDVar15 = (LPDWORD)&local_30;
              uVar13 = 0;
              local_30 = 0;
              uVar5 = FUN_18001b1a0((longlong)local_40,param_2,(longlong *)pDVar15);
              if ((int)uVar5 != 0) {
                if ((param_3 != (undefined8 *)0x0) || (param_4 != (uint *)0x0)) {
                  puVar16 = local_res8;
                  local_res8[0] = 0;
                  FUN_18001b0f0(local_40,local_30,0,puVar16);
                  dwBytes = (ulonglong)local_res8[0];
                  if (param_4 != (uint *)0x0) {
                    *param_4 = local_res8[0];
                  }
                  if (param_3 != (undefined8 *)0x0) {
                    pvVar8 = GetProcessHeap();
                    pvVar7 = HeapAlloc(pvVar8,8,dwBytes);
                    *param_3 = pvVar7;
                    if (pvVar7 == (LPVOID)0x0) {
                      FUN_180018310(4,0x18002e420,dwBytes,puVar16);
                      uVar13 = 0x8007000e;
                    }
                    else {
                      FUN_18001b0f0(local_40,local_30,(longlong)pvVar7,local_res8);
                    }
                  }
                }
                goto LAB_18001bd66;
              }
              uVar13 = 0xa0098012;
              pcVar12 = "PBACheckFPIDValid : FPID is incorrect, Fail";
            }
            else {
              uVar13 = 0xa0098012;
              pcVar12 = "PBACheckFPIDValid : DB is incorrect, Fail";
            }
          }
          FUN_180018310(4,(longlong)pcVar12,pDVar15,lpNumberOfBytesRead);
          goto LAB_18001bd66;
        }
      }
      uVar11 = GetLastError();
      if (0 < (int)uVar11) {
        uVar11 = uVar11 & 0xffff | 0x80070000;
      }
      uVar13 = (ulonglong)uVar11;
      FUN_180018310(4,0x18002e2e8,uVar13,lpNumberOfBytesRead);
      goto LAB_18001bd66;
    }
  }
  DVar4 = GetLastError();
  uVar13 = (ulonglong)DVar4;
  if (DVar4 - 2 < 2) {
    uVar13 = 0xa0098010;
  }
  else if (0 < (int)DVar4) {
    uVar11 = DVar4 & 0xffff | 0x80070000;
    uVar13 = (ulonglong)uVar11;
    FUN_180018310(4,0x18002e278,(ulonglong)uVar11,uVar5);
    lpBuffer = pDVar9;
    lpMem = pDVar9;
    goto LAB_18001bd66;
  }
  FUN_180018310(4,0x18002e278,uVar13,uVar5);
LAB_18001bd66:
  if (local_40 != (HLOCAL)0x0) {
    FUN_18001b060(local_40);
  }
  if (lpMem != (LPDWORD)0x0) {
    pvVar8 = GetProcessHeap();
    HeapFree(pvVar8,0,lpMem);
  }
  if (local_38 != (HLOCAL)0x0) {
    FUN_18001b060(local_38);
  }
  if (lpBuffer != (LPDWORD)0x0) {
    pvVar8 = GetProcessHeap();
    HeapFree(pvVar8,0,lpBuffer);
  }
  if (hFile != (HANDLE)0xffffffffffffffff) {
    CloseHandle(hFile);
  }
  return uVar13;
}



undefined8 FUN_18001bdf0(longlong param_1)

{
  longlong lVar1;
  LPVOID lpMem;
  HANDLE hHeap;
  
  lVar1 = *(longlong *)(param_1 + 0x38);
  lpMem = *(LPVOID *)(lVar1 + 0x4148);
  if (lpMem != (LPVOID)0x0) {
    hHeap = GetProcessHeap();
    HeapFree(hHeap,0,lpMem);
    *(undefined8 *)(lVar1 + 0x4148) = 0;
  }
  if (*(HLOCAL *)(lVar1 + 0x128) != (HLOCAL)0x0) {
    FUN_18001b060(*(HLOCAL *)(lVar1 + 0x128));
    *(undefined8 *)(lVar1 + 0x128) = 0;
  }
  *(uint *)(lVar1 + 0x4158) = *(uint *)(lVar1 + 0x4158) & 0xfffffffb;
  return 0;
}



DWORD FUN_18001be60(longlong param_1,short param_2,ushort param_3,undefined8 *param_4)

{
  longlong lVar1;
  DWORD DVar2;
  BOOL BVar3;
  HANDLE hDevice;
  uint uVar4;
  uint uVar5;
  DWORD local_38 [2];
  longlong local_30;
  
  hDevice = (HANDLE)FUN_18001b700();
  if (hDevice == (HANDLE)0xffffffffffffffff) {
    DVar2 = GetLastError();
    return DVar2;
  }
  lVar1 = *(longlong *)(param_1 + 0x38);
  uVar5 = (uint)param_3 << 0xc;
  DVar2 = 0;
  local_30 = lVar1;
  if (param_3 != 0) {
    while( true ) {
      uVar4 = uVar5;
      if (0x4000 < uVar5) {
        uVar4 = 0x4000;
      }
      *(undefined2 *)(lVar1 + 0x138) = 0;
      *(short *)(lVar1 + 0x13a) = param_2;
      *(short *)(lVar1 + 0x13c) = (short)uVar4;
      *(undefined4 *)(lVar1 + 0x140) = 0;
      BVar3 = DeviceIoControl(hDevice,0x80102048,(LPVOID)(lVar1 + 0x130),0x4014,
                              (LPVOID)(lVar1 + 0x130),0x4014,local_38,(LPOVERLAPPED)0x0);
      if (BVar3 == 0) break;
      FUN_18001d560(param_4,(undefined8 *)(local_30 + 0x144),(ulonglong)uVar4);
      param_4 = (undefined8 *)((longlong)param_4 + (ulonglong)uVar4);
      param_2 = param_2 + (short)(uVar4 >> 0xc);
      uVar5 = uVar5 - uVar4;
      DVar2 = 0;
      if (uVar5 == 0) goto LAB_18001bf72;
      FUN_18001bfb0(1000);
    }
    DVar2 = GetLastError();
  }
LAB_18001bf72:
  CloseHandle(hDevice);
  SetLastError(DVar2);
  return DVar2;
}



ulonglong FUN_18001bfb0(longlong param_1)

{
  undefined1 auVar1 [16];
  undefined1 auVar2 [16];
  undefined1 auVar3 [16];
  undefined1 auVar4 [16];
  BOOL BVar5;
  ulonglong uVar6;
  undefined4 extraout_var;
  LARGE_INTEGER LVar7;
  LARGE_INTEGER local_res8;
  LARGE_INTEGER local_res10 [3];
  
  QueryPerformanceFrequency(local_res10);
  QueryPerformanceCounter(&local_res8);
  auVar3._8_8_ = 0;
  auVar3._0_8_ = local_res10[0].QuadPart * param_1;
  auVar4 = ZEXT816(0x431bde82d7b634db) * auVar3;
  LVar7.QuadPart = (ulonglong)(local_res10[0].QuadPart * param_1) / 1000000 + local_res8.QuadPart;
  do {
    if ((ulonglong)LVar7 <= (ulonglong)local_res8) {
      return auVar4._0_8_;
    }
    uVar6 = (LVar7.QuadPart - (longlong)local_res8) * 1000;
    auVar1._8_8_ = 0;
    auVar1._0_8_ = local_res10[0].QuadPart;
    auVar2._8_8_ = 0;
    auVar2._0_8_ = uVar6;
    uVar6 = uVar6 % (ulonglong)local_res10[0].QuadPart;
    if (10 < SUB168(auVar2 / auVar1,0)) {
      Sleep(SUB164(auVar2 / auVar1,0) - 5);
    }
    BVar5 = QueryPerformanceCounter(&local_res8);
    auVar4._8_8_ = uVar6;
    auVar4._0_8_ = CONCAT44(extraout_var,BVar5);
  } while (BVar5 != 0);
  return CONCAT44(extraout_var,BVar5);
}



void FUN_18001c040(undefined1 *param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res18;
  undefined8 local_res20;
  
  local_res18 = param_3;
  local_res20 = param_4;
  FUN_18001e094(param_1,0x104,param_2,&local_res18);
  return;
}



undefined8 * FUN_18001c070(undefined8 *param_1,int param_2,int param_3)

{
  HLOCAL pvVar1;
  
  FUN_180017430(param_1);
  param_1[2] = 0;
  *(int *)(param_1 + 4) = param_2;
  *param_1 = CTouchSensor::vftable;
  *(undefined8 *)((longlong)param_1 + 0x74) = 1;
  *(int *)((longlong)param_1 + 0x24) = param_3;
  *(int *)(param_1 + 5) = param_2 * param_3;
  pvVar1 = LocalAlloc(0,(longlong)(param_2 * param_3));
  param_1[3] = pvVar1;
  pvVar1 = LocalAlloc(0,0x3c000);
  param_1[6] = pvVar1;
  *(undefined4 *)(param_1 + 7) = 0;
  pvVar1 = LocalAlloc(0,(longlong)*(int *)(param_1 + 5));
  param_1[9] = 0;
  param_1[8] = pvVar1;
  pvVar1 = LocalAlloc(0,0x3c000);
  param_1[0xd] = pvVar1;
  pvVar1 = LocalAlloc(0,0x3c000);
  *(undefined4 *)(param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 10) = 0;
  *(undefined4 *)(param_1 + 0xe) = 0;
  param_1[0xb] = pvVar1;
  *(undefined4 *)(param_1 + 0x32) = 0x40;
  pvVar1 = LocalAlloc(0x40,0x40);
  param_1[0x31] = pvVar1;
  return param_1;
}



void FUN_18001c150(undefined8 *param_1)

{
  *param_1 = CTouchSensor::vftable;
  LocalFree((HLOCAL)param_1[3]);
  LocalFree((HLOCAL)param_1[6]);
  LocalFree((HLOCAL)param_1[8]);
  LocalFree((HLOCAL)param_1[0xd]);
  LocalFree((HLOCAL)param_1[0xb]);
  LocalFree((HLOCAL)param_1[0x31]);
  *param_1 = CEngineBase::vftable;
  FUN_180017450(param_1);
  return;
}



undefined8 * FUN_18001c1c0(undefined8 *param_1,uint param_2)

{
  *param_1 = CEngineBase::vftable;
  FUN_180017450(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001d45c(param_1);
  }
  return param_1;
}



undefined8 * FUN_18001c200(undefined8 *param_1,uint param_2)

{
  FUN_18001c150(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001d45c(param_1);
  }
  return param_1;
}



void FUN_18001c230(longlong *param_1,undefined8 *param_2,ulonglong param_3,undefined8 param_4,
                  byte param_5,undefined4 *param_6)

{
  uint *puVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  uint uVar5;
  SIZE_T SVar6;
  ulonglong uVar7;
  undefined1 auStackY_188 [32];
  uint local_158;
  int local_154;
  uint local_150;
  DWORD local_14c;
  undefined1 local_148 [272];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_188;
  FUN_180018310(1,0x18002ef20,param_3,param_4);
  FUN_180018310(1,0x18002ef50,param_3 & 0xffffffff,(ulonglong)*(uint *)(param_1 + 4));
  FUN_18001d560((undefined8 *)param_1[8],param_2,(longlong)(int)((int)param_4 * (uint)param_3));
  FUN_180004540(param_1[8],(uint)param_3,(int)param_4,(int)param_1[4],
                *(uint *)((longlong)param_1 + 0x24));
  FUN_18001d560((undefined8 *)param_1[3],(undefined8 *)param_1[8],(longlong)(int)param_1[5]);
  puVar1 = (uint *)(param_1 + 7);
  SVar6 = LocalSize((HLOCAL)param_1[6]);
  *puVar1 = (uint)SVar6;
  uVar7 = thunk_FUN_180007060((undefined8 *)param_1[3],(int)param_1[4],
                              (ulonglong)*(uint *)((longlong)param_1 + 0x24),(uint **)param_1[6],
                              puVar1,(longlong)&local_158);
  iVar4 = (int)uVar7;
  FUN_180018310(1,0x18002efb0,uVar7 & 0xffffffff,(ulonglong)local_158);
  if (iVar4 == 0) {
    DVar2 = GetCurrentProcessId();
    BVar3 = ProcessIdToSessionId(DVar2,&local_14c);
    if (BVar3 != 0) {
      DVar2 = WTSGetActiveConsoleSessionId();
      if (local_14c == DVar2) {
        FUN_18001d560((undefined8 *)param_1[3],(undefined8 *)param_1[8],(longlong)(int)param_1[5]);
        iVar4 = (**(code **)(*param_1 + 0x98))(param_1);
        uVar5 = FUN_180004410((undefined8 *)param_1[3],*(uint *)(param_1 + 4),
                              *(int *)((longlong)param_1 + 0x24),(int *)&local_150,&local_154,iVar4)
        ;
        FUN_180018310(1,0x18002f000,(ulonglong)uVar5,(ulonglong)local_150);
        if (uVar5 != 3) {
          *param_6 = 5;
          goto LAB_18001c3da;
        }
      }
    }
    uVar5 = 0;
  }
  else {
    if ((iVar4 == 1) || ((iVar4 != 2 && (iVar4 == 4)))) {
      *param_6 = 9;
    }
    else {
      *param_6 = 7;
    }
LAB_18001c3da:
    uVar5 = 0x80098008;
  }
  if (param_5 == 4) {
    uVar7 = (ulonglong)*puVar1;
    FUN_180018310(1,0x18002f070,(ulonglong)*(uint *)(param_1 + 10),uVar7);
    iVar4 = (*(code *)PTR_FUN_180046018)(param_1 + 2,1);
    if (iVar4 != 0) {
      FUN_18001c040(local_148,0x18002f0b8,(ulonglong)*(uint *)(param_1 + 10),uVar7);
      (*(code *)PTR_FUN_180046020)(param_1 + 2,local_148,param_1[3],(int)param_1[4]);
      uVar7 = (ulonglong)local_158;
      FUN_180018310(1,0x18002f0d0,local_148,uVar7);
    }
    iVar4 = (*(code *)PTR_FUN_180046018)(param_1 + 2,2);
    if (iVar4 != 0) {
      FUN_18001c040(local_148,0x18002f110,(ulonglong)*(uint *)(param_1 + 10),uVar7);
      (*(code *)PTR_FUN_180046020)(param_1 + 2,local_148,param_1[8],(int)param_1[4]);
      FUN_180018310(1,0x18002f0d0,local_148,(ulonglong)local_158);
    }
  }
  else if ((byte)(param_5 - 1) < 2) {
    iVar4 = (*(code *)PTR_FUN_180046018)(param_1 + 2,0x100);
    if (iVar4 != 0) {
      uVar7 = (ulonglong)*(uint *)(param_1 + 4);
      (*(code *)PTR_FUN_180046020)(param_1 + 2,"Verify_Skeleton",param_1[3]);
      FUN_180018310(1,0x18002f140,(ulonglong)local_158,uVar7);
    }
    iVar4 = (*(code *)PTR_FUN_180046018)(param_1 + 2,0x200);
    if (iVar4 != 0) {
      uVar7 = (ulonglong)*(uint *)(param_1 + 4);
      (*(code *)PTR_FUN_180046020)(param_1 + 2,"Verify_Orininal",param_1[8]);
      FUN_180018310(1,0x18002f1a0,(ulonglong)local_158,uVar7);
    }
  }
  FUN_180018310(1,0x18002f1f0,(ulonglong)uVar5,(ulonglong)param_5);
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_188);
  return;
}



undefined8 FUN_18001c5b0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong lVar1;
  undefined1 *puVar2;
  
  FUN_180018310(1,0x18002ed90,param_3,param_4);
  puVar2 = *(undefined1 **)(param_1 + 0x18);
  for (lVar1 = (longlong)*(int *)(param_1 + 0x28); lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = *(undefined1 **)(param_1 + 0x40);
  for (lVar1 = (longlong)*(int *)(param_1 + 0x28); lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = *(undefined1 **)(param_1 + 0x30);
  for (lVar1 = (longlong)*(int *)(param_1 + 0x38); lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = *(undefined1 **)(param_1 + 0x58);
  for (lVar1 = (longlong)*(int *)(param_1 + 0x60); lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  FUN_180018310(1,0x18002edc0,param_3,param_4);
  return 0;
}



undefined8 FUN_18001c620(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  char *pcVar1;
  
  pcVar1 = ">>> CTouchSensor::ClearEnrollment";
  FUN_180018310(1,0x18002ed40,param_3,param_4);
  if (*(char **)(param_1 + 0x48) != (char *)0x0) {
    thunk_FUN_180006270(*(char **)(param_1 + 0x48),pcVar1,param_3,param_4);
    *(undefined8 *)(param_1 + 0x48) = 0;
  }
  *(undefined4 *)(param_1 + 0x50) = 0;
  FUN_180018310(1,0x18002ed68,param_3,param_4);
  return 0;
}



undefined8 FUN_18001c670(longlong *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  int iVar2;
  LSTATUS LVar3;
  undefined2 *puVar4;
  LPCSTR lpSubKey;
  HKEY pHVar5;
  undefined4 uVar6;
  char *pcVar7;
  ulonglong uVar8;
  undefined8 uVar9;
  DWORD local_res8 [2];
  int local_res10 [2];
  HKEY local_res18;
  HKEY local_res20;
  
  FUN_180018310(1,0x18002e9d0,param_3,param_4);
  uVar9 = 0x20019;
  local_res8[0] = 4;
  local_res18 = (HKEY)0x0;
  uVar1 = RegOpenKeyExA((HKEY)0xffffffff80000002,
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WinBio",0,0x20019,
                        &local_res18);
  if (uVar1 == 0) {
    pcVar7 = "Minimum Fingerprint Samples";
    uVar9 = 0;
    uVar8 = 0;
    uVar1 = RegQueryValueExA(local_res18,"Minimum Fingerprint Samples",(LPDWORD)0x0,(LPDWORD)0x0,
                             (LPBYTE)local_res10,local_res8);
    if (uVar1 == 0) {
      if (local_res10[0] - 8U < 0xd) {
        *(int *)((longlong)param_1 + 0x7c) = local_res10[0];
      }
      else {
        *(undefined4 *)((longlong)param_1 + 0x7c) = 0x10;
      }
      if ((*(byte *)(param_1 + 0xf) & 1) == 0) {
        *(int *)((longlong)param_1 + 0x7c) = *(int *)((longlong)param_1 + 0x7c) + -2;
      }
      else {
        *(int *)((longlong)param_1 + 0x7c) = *(int *)((longlong)param_1 + 0x7c) + -1;
      }
      pHVar5 = local_res18;
      RegCloseKey(local_res18);
    }
    else {
      pcVar7 = 
      ">>> CTouchSensor::EngineAdapterCreateEnrollment : Call RegQueryValueEx fail, return %d";
      uVar8 = (ulonglong)uVar1;
      pHVar5 = (HKEY)0x1;
      FUN_180018310(1,0x18002eac0,uVar8,uVar9);
    }
  }
  else {
    pcVar7 = ">>> CTouchSensor::EngineAdapterCreateEnrollment : Call RegOpenKeyEx fail, return %d";
    pHVar5 = (HKEY)0x1;
    uVar8 = (ulonglong)uVar1;
    FUN_180018310(1,0x18002ea40,uVar8,uVar9);
  }
  puVar4 = thunk_FUN_180005360(pHVar5,pcVar7,uVar8,uVar9);
  param_1[9] = (longlong)puVar4;
  if (puVar4 == (undefined2 *)0x0) goto LAB_18001c82e;
  iVar2 = (**(code **)(*param_1 + 0x98))(param_1);
  if (iVar2 == 5) {
    uVar8 = 10;
LAB_18001c7c0:
    thunk_FUN_180005510((char *)param_1[9],0x4bf,uVar8,uVar9);
    uVar8 = 1;
    uVar6 = 0x4cd;
  }
  else {
    iVar2 = (**(code **)(*param_1 + 0x98))(param_1);
    if (iVar2 == 7) {
LAB_18001c7ba:
      uVar8 = 0x10;
      goto LAB_18001c7c0;
    }
    iVar2 = (**(code **)(*param_1 + 0x98))(param_1);
    if (iVar2 == 8) goto LAB_18001c7ba;
    thunk_FUN_180005510((char *)param_1[9],0x4bd,0x10,uVar9);
    uVar8 = 0;
    uVar6 = 0x4b4;
  }
  thunk_FUN_180005510((char *)param_1[9],uVar6,uVar8,uVar9);
  lpSubKey = (LPCSTR)(**(code **)(*param_1 + 0xa8))(param_1);
  uVar9 = 0x20019;
  LVar3 = RegOpenKeyExA((HKEY)0xffffffff80000002,lpSubKey,0,0x20019,&local_res20);
  if (LVar3 == 0) {
    FUN_18001caf0((char *)param_1[9],local_res20);
    RegCloseKey(local_res20);
  }
LAB_18001c82e:
  FUN_180018310(1,0x18002eb20,(ulonglong)*(uint *)((longlong)param_1 + 0x7c),uVar9);
  uVar9 = 0x8000ffff;
  if (param_1[9] != 0) {
    uVar9 = 0;
  }
  return uVar9;
}



undefined8 FUN_18001c860(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180018310(1,0x18002eef0,param_3,param_4);
  thunk_FUN_1800052c0(*(undefined8 **)(param_1 + 0x188),*(uint *)(param_1 + 400),param_3,param_4);
  FUN_180016bb0((longlong *)(param_1 + 0x10));
  FUN_180018310(1,0x18002ef08,param_3,param_4);
  return 0;
}



undefined8
FUN_18001c8b0(longlong param_1,undefined8 *param_2,undefined4 *param_3,undefined8 param_4)

{
  undefined4 *puVar1;
  
  puVar1 = param_3;
  FUN_180018310(1,0x18002ecf0,param_3,param_4);
  *param_2 = *(undefined8 *)(param_1 + 0x58);
  *param_3 = *(undefined4 *)(param_1 + 0x60);
  FUN_180018310(1,0x18002ed18,puVar1,param_4);
  return 0;
}



undefined4 FUN_18001c910(longlong param_1)

{
  return *(undefined4 *)(param_1 + 0x70);
}



undefined8 FUN_18001c920(void)

{
  return 0x3c000;
}



undefined8 FUN_18001c930(void)

{
  return 0x14;
}



undefined8 FUN_18001c940(longlong *param_1,undefined8 param_2,LPCWSTR param_3,undefined8 param_4)

{
  uint uVar1;
  LSTATUS LVar2;
  LPCSTR lpSubKey;
  undefined8 uVar3;
  undefined8 uVar4;
  int local_res8 [2];
  DWORD local_res18 [2];
  HKEY local_res20;
  
  FUN_180018310(1,0x18002ee18,param_3,param_4);
  if (param_3 != (LPCWSTR)0x0) {
    FUN_180016c50(param_1 + 2,param_3);
  }
  uVar1 = (**(code **)(*param_1 + 0x98))(param_1);
  FUN_180004200((undefined8 *)param_1[0x31],(ulonglong)*(uint *)(param_1 + 0x32),(ulonglong)uVar1,0)
  ;
  local_res20 = (HKEY)0x0;
  lpSubKey = (LPCSTR)(**(code **)(*param_1 + 0xa0))(param_1);
  uVar4 = 0x2001b;
  uVar3 = 0;
  LVar2 = RegOpenKeyExA((HKEY)0xffffffff80000002,lpSubKey,0,0x2001b,&local_res20);
  if (LVar2 == 0) {
    local_res18[0] = 4;
    LVar2 = RegQueryValueExA(local_res20,"Optimization",(LPDWORD)0x0,(LPDWORD)0x0,(LPBYTE)local_res8
                             ,local_res18);
    if (LVar2 == 0) {
      *(int *)(param_1 + 0xf) = local_res8[0];
    }
    uVar4 = 0;
    uVar3 = 0;
    LVar2 = RegQueryValueExA(local_res20,"SmartLearn",(LPDWORD)0x0,(LPDWORD)0x0,(LPBYTE)local_res8,
                             local_res18);
    if (LVar2 == 0) {
      *(uint *)((longlong)param_1 + 0x74) = (uint)(local_res8[0] != 0);
    }
    RegCloseKey(local_res20);
  }
  else {
    FUN_180018310(1,0x18002ee70,uVar3,uVar4);
  }
  *(uint *)((longlong)param_1 + 0x7c) = *(uint *)(param_1 + 0xf) & 1 | 0xe;
  FUN_180018310(1,0x18002eec0,uVar3,uVar4);
  return 0;
}



undefined8
FUN_18001caa0(longlong param_1,undefined8 *param_2,ulonglong param_3,undefined8 *param_4,
             uint param_5)

{
  uint uVar1;
  undefined8 uVar2;
  
  if (param_4 == (undefined8 *)0x0) {
    param_4 = *(undefined8 **)(param_1 + 0x58);
    param_5 = *(uint *)(param_1 + 0x60);
  }
  uVar1 = thunk_FUN_180006010(param_2,param_4,param_3,(ulonglong)param_5,(int *)0x0);
  uVar2 = 0x80098005;
  if (uVar1 == 0x65) {
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_18001caf0(char *param_1,HKEY param_2)

{
  char cVar1;
  char cVar2;
  LSTATUS LVar3;
  char *pcVar4;
  undefined8 uVar5;
  ulonglong uVar6;
  longlong lVar7;
  undefined **ppuVar8;
  uint uVar9;
  ulonglong uVar11;
  ulonglong uVar12;
  undefined1 auStackY_2f8 [32];
  uint local_298;
  DWORD local_294;
  uint local_290;
  DWORD local_28c [4];
  DWORD local_27c;
  DWORD local_278;
  DWORD local_274;
  DWORD local_270;
  DWORD local_26c;
  _FILETIME local_268 [2];
  CHAR local_258 [272];
  CHAR local_148;
  undefined1 local_147 [271];
  ulonglong local_38;
  ulonglong uVar10;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_2f8;
  local_148 = '\0';
  FUN_18001dbc0((undefined1 (*) [16])local_147,0,0x103);
  uVar12 = 0;
  local_28c[2] = 0x104;
  local_28c[0] = 0;
  local_294 = 0x104;
  RegQueryInfoKeyA(param_2,&local_148,local_28c + 2,(LPDWORD)0x0,local_28c,&local_278,&local_270,
                   &local_290,&local_26c,&local_274,&local_27c,local_268);
  uVar6 = uVar12;
  if (local_290 != 0) {
    do {
      local_294 = 0x104;
      local_258[0] = '\0';
      local_28c[1] = 4;
      LVar3 = RegEnumValueA(param_2,(DWORD)uVar6,local_258,&local_294,(LPDWORD)0x0,local_28c + 3,
                            (LPBYTE)&local_298,local_28c + 1);
      if ((LVar3 == 0) && (local_28c[3] == 4)) {
        ppuVar8 = &PTR_s_ENROLL_CTX_ENROLL_POLICY_18002e5b8;
        uVar10 = uVar12;
        uVar11 = uVar12;
        do {
          pcVar4 = local_258;
          lVar7 = (longlong)*ppuVar8 - (longlong)pcVar4;
          do {
            cVar1 = *pcVar4;
            cVar2 = pcVar4[lVar7];
            if (cVar1 != cVar2) break;
            pcVar4 = pcVar4 + 1;
          } while (cVar2 != '\0');
          if (cVar1 == cVar2) {
            uVar5 = thunk_FUN_180005510(param_1,*(undefined4 *)(&DAT_18002e5b0 + uVar11 * 0x10),
                                        (ulonglong)local_298,ppuVar8);
            if ((int)uVar5 != -0x761) {
              FUN_180018310(1,0x18002e9b0,local_258,(ulonglong)local_298);
            }
            break;
          }
          uVar9 = (int)uVar10 + 1;
          uVar10 = (ulonglong)uVar9;
          uVar11 = uVar11 + 1;
          ppuVar8 = ppuVar8 + 2;
        } while (uVar9 < 0x14);
      }
      uVar9 = (DWORD)uVar6 + 1;
      uVar6 = (ulonglong)uVar9;
    } while (uVar9 < local_290);
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_2f8);
  return;
}



uint FUN_18001cd10(longlong param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4)

{
  int iVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  uint uVar4;
  uint **ppuVar5;
  uint local_res8 [2];
  uint local_res18 [2];
  
  FUN_180018310(1,0x18002eb70,param_3,param_4);
  uVar4 = 0x90001;
  FUN_180018310(1,0x18002eba0,(ulonglong)*(uint *)(param_1 + 0x50),param_4);
  FUN_18001d560(*(undefined8 **)(param_1 + 0x18),*(undefined8 **)(param_1 + 0x40),
                (longlong)*(int *)(param_1 + 0x28));
  ppuVar5 = *(uint ***)(param_1 + 0x48);
  uVar3 = (ulonglong)*(uint *)(param_1 + 0x24);
  iVar1 = thunk_FUN_180005b10(*(undefined8 **)(param_1 + 0x18),*(int *)(param_1 + 0x20),uVar3,
                              ppuVar5,local_res18);
  if (iVar1 < 0) {
    switch(iVar1) {
    case -8:
    case -7:
      *param_2 = 10;
      uVar4 = 0x80098008;
      break;
    case -6:
    case -3:
      *param_2 = 0;
      uVar4 = 0x80004005;
      break;
    case -5:
    case -2:
    case -1:
      *param_2 = 7;
      uVar4 = 0x80098008;
      break;
    default:
      *param_2 = 0;
      uVar4 = 0x8000ffff;
    }
  }
  else if (iVar1 == 2) {
    puVar2 = (undefined8 *)
             thunk_FUN_180006ed0(*(char **)(param_1 + 0x48),local_res8,uVar3,(undefined *)ppuVar5);
    if (puVar2 == (undefined8 *)0x0) {
      *param_2 = 10;
      *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
      uVar4 = 0x8000ffff;
    }
    else {
      uVar3 = (ulonglong)(int)local_res8[0];
      *(uint *)(param_1 + 0x60) = local_res8[0];
      FUN_18001d560(*(undefined8 **)(param_1 + 0x58),puVar2,uVar3);
      thunk_FUN_180006270(*(char **)(param_1 + 0x48),puVar2,uVar3,ppuVar5);
      uVar4 = 0;
      *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
      *(undefined8 *)(param_1 + 0x48) = 0;
    }
  }
  else {
    if (iVar1 == 1) {
      FUN_180018310(1,0x18002ec70,uVar3,ppuVar5);
    }
    else {
      if (iVar1 == 3) {
        FUN_180018310(1,0x18002ec30,uVar3,ppuVar5);
        *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
        goto LAB_18001ce7d;
      }
      if (iVar1 == 4) {
        FUN_180018310(1,0x18002ebe8,uVar3,ppuVar5);
        *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
        goto LAB_18001ce7d;
      }
    }
    *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
  }
LAB_18001ce7d:
  FUN_180018310(1,0x18002ecb0,(ulonglong)uVar4,ppuVar5);
  return uVar4;
}



undefined8
FUN_18001ced0(longlong param_1,ulonglong *param_2,ulonglong param_3,byte *param_4,uint param_5,
             undefined4 *param_6)

{
  int iVar1;
  ulonglong uVar2;
  byte **ppbVar3;
  longlong lVar4;
  undefined1 *puVar5;
  ulonglong *local_res10;
  int local_res18 [2];
  ulonglong **local_68;
  int *local_60;
  undefined8 local_58;
  byte *local_50;
  ulonglong local_48;
  undefined1 *local_40;
  ulonglong local_38;
  int local_30;
  int iStack_2c;
  undefined4 local_28;
  undefined4 uStack_24;
  
  local_res18[0] = (int)param_3;
  if (param_4 == (byte *)0x0) {
    param_4 = *(byte **)(param_1 + 0x30);
    param_5 = *(uint *)(param_1 + 0x38);
  }
  local_68 = &local_res10;
  local_58 = 1;
  local_60 = local_res18;
  local_48 = (ulonglong)param_5;
  local_40 = *(undefined1 **)(param_1 + 0x68);
  iStack_2c = 0;
  local_28 = 0;
  local_38 = 0;
  local_30 = -1;
  uStack_24 = 0;
  local_res10 = param_2;
  local_50 = param_4;
  thunk_FUN_1800065e0((longlong *)&local_68,param_2,param_3,param_4);
  ppbVar3 = &local_50;
  uVar2 = thunk_FUN_180006a50(ppbVar3,param_2,param_3,(ulonglong)param_4);
  FUN_180004390(ppbVar3,param_2,param_3,param_4);
  FUN_180018310(1,0x18002edf0,uVar2 & 0xffffffff,local_38 >> 0x20);
  if ((-1 < (int)uVar2) && (-1 < local_30)) {
    if (param_6 != (undefined4 *)0x0) {
      if (*(int *)(param_1 + 0x74) != 0) {
        lVar4 = (longlong)(int)local_38;
        if ((iStack_2c != 0) &&
           ((local_res18[0] != (int)local_38 ||
            (iVar1 = FUN_18001dae0(local_res10,(longlong)local_40,(longlong)local_res18[0]),
            iVar1 != 0)))) {
          puVar5 = *(undefined1 **)(param_1 + 0x58);
          for (lVar4 = (longlong)*(int *)(param_1 + 0x60); lVar4 != 0; lVar4 = lVar4 + -1) {
            *puVar5 = 0;
            puVar5 = puVar5 + 1;
          }
          *(undefined8 *)(param_1 + 0x68) = *(undefined8 *)(param_1 + 0x58);
          *(undefined1 **)(param_1 + 0x58) = local_40;
          *(int *)(param_1 + 0x60) = (int)local_38;
          *param_6 = 1;
          return 0;
        }
        for (; lVar4 != 0; lVar4 = lVar4 + -1) {
          *local_40 = 0;
          local_40 = local_40 + 1;
        }
        *param_6 = 0;
        return 0;
      }
      *param_6 = 0;
    }
    if (iStack_2c != 0) {
      for (lVar4 = (longlong)(int)local_38; lVar4 != 0; lVar4 = lVar4 + -1) {
        *local_40 = 0;
        local_40 = local_40 + 1;
      }
    }
    return 0;
  }
  if (param_6 != (undefined4 *)0x0) {
    *param_6 = 0;
  }
  return 0x80098005;
}



undefined4 * FUN_18001d0a8(undefined4 *param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  DWORD DVar3;
  
  FUN_18001dbc0((undefined1 (*) [16])(param_1 + 10),0,0x28);
  *(undefined8 *)(param_1 + 0x14) = 0;
  param_1[0x16] = 0;
  param_1[0x17] = 0;
  *(undefined8 *)(param_1 + 4) = 0x180000000;
  *(undefined8 *)(param_1 + 2) = 0x180000000;
  *param_1 = 0x60;
  *(undefined **)(param_1 + 8) = &DAT_18002f238;
  param_1[6] = 0xc00;
  BVar2 = InitializeCriticalSectionEx((LPCRITICAL_SECTION)(param_1 + 10),0,0);
  if (BVar2 == 0) {
    DVar3 = GetLastError();
    DVar1 = DVar3 & 0xffff | 0x80070000;
    if ((int)DVar3 < 1) {
      DVar1 = DVar3;
    }
    if ((int)DVar1 < 0) {
      BVar2 = IsDebuggerPresent();
      if (BVar2 != 0) {
        OutputDebugStringW(L"ERROR : Unable to initialize critical section in CAtlBaseModule\n");
      }
      DAT_180049f19 = 1;
    }
  }
  return param_1;
}



void FUN_18001d150(longlong param_1)

{
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x28));
  if (*(LPVOID *)(param_1 + 0x50) != (LPVOID)0x0) {
    FUN_18001d45c(*(LPVOID *)(param_1 + 0x50));
    *(undefined8 *)(param_1 + 0x50) = 0;
  }
  *(undefined4 *)(param_1 + 0x58) = 0;
  *(undefined4 *)(param_1 + 0x5c) = 0;
  return;
}



void thunk_FUN_18001d45c(LPVOID param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  if ((param_1 != (LPVOID)0x0) && (BVar1 = HeapFree(DAT_180048c88,0,param_1), BVar1 == 0)) {
    pDVar3 = FUN_18001fa28();
    DVar2 = GetLastError();
    DVar2 = FUN_18001fa48(DVar2);
    *pDVar3 = DVar2;
  }
  return;
}



undefined8 * FUN_18001d18c(undefined8 *param_1,longlong param_2)

{
  FUN_18001eea8(param_1,param_2);
  *param_1 = std::bad_alloc::vftable;
  return param_1;
}



void FUN_18001d1c0(ulonglong param_1)

{
  code *pcVar1;
  undefined8 uVar2;
  LPVOID pvVar3;
  char *local_res10 [3];
  undefined **local_28 [4];
  
  do {
    pvVar3 = FUN_18001ed60(param_1);
    if (pvVar3 != (LPVOID)0x0) {
      return;
    }
    uVar2 = FUN_18001effc(param_1);
  } while ((int)uVar2 != 0);
  local_res10[0] = "bad allocation";
  FUN_18001ee8c(local_28,local_res10);
  local_28[0] = std::bad_alloc::vftable;
  FUN_18001f038((longlong *)local_28,&DAT_180044738);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined8 * FUN_18001d22c(undefined8 *param_1,uint param_2)

{
  *param_1 = std::bad_alloc::vftable;
  FUN_18001eed4(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001d45c(param_1);
  }
  return param_1;
}



undefined4 FUN_18001d268(void)

{
  undefined4 uVar1;
  undefined8 *Ptr;
  
  Ptr = (undefined8 *)FUN_18001f654(0x20,8);
  DAT_18004b098 = EncodePointer(Ptr);
  DAT_18004b0a0 = DAT_18004b098;
  if (Ptr == (undefined8 *)0x0) {
    uVar1 = 0x18;
  }
  else {
    *Ptr = 0;
    uVar1 = 0;
  }
  return uVar1;
}



PVOID FUN_18001d2ac(PVOID param_1)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  PVOID pvVar4;
  ulonglong uVar5;
  PVOID pvVar6;
  
  FUN_18001f468();
  puVar1 = (undefined8 *)DecodePointer(DAT_18004b0a0);
  puVar2 = (undefined8 *)DecodePointer(DAT_18004b098);
  if (puVar1 <= puVar2) {
    uVar5 = ((longlong)puVar2 - (longlong)puVar1) + 8;
    if (7 < uVar5) {
      uVar3 = FUN_18001f618((longlong)puVar1);
      if (uVar3 < uVar5) {
        uVar5 = 0x1000;
        if (uVar3 < 0x1000) {
          uVar5 = uVar3;
        }
        if ((uVar5 + uVar3 < uVar3) ||
           (pvVar4 = FUN_18001f750(puVar1,uVar5 + uVar3), pvVar4 == (LPVOID)0x0)) {
          pvVar6 = (PVOID)0x0;
          if ((uVar3 + 0x20 < uVar3) ||
             (pvVar4 = FUN_18001f750(puVar1,uVar3 + 0x20), pvVar4 == (LPVOID)0x0))
          goto LAB_18001d394;
        }
        puVar2 = (undefined8 *)((longlong)pvVar4 + ((longlong)puVar2 - (longlong)puVar1 >> 3) * 8);
        DAT_18004b0a0 = EncodePointer(pvVar4);
      }
      pvVar4 = EncodePointer(param_1);
      *puVar2 = pvVar4;
      DAT_18004b098 = EncodePointer(puVar2 + 1);
      pvVar6 = param_1;
      goto LAB_18001d394;
    }
  }
  pvVar6 = (PVOID)0x0;
LAB_18001d394:
  FUN_18001f474();
  return pvVar6;
}



int FUN_18001d3b8(PVOID param_1)

{
  PVOID pvVar1;
  
  pvVar1 = FUN_18001d2ac(param_1);
  return (pvVar1 != (PVOID)0x0) - 1;
}



char * FUN_18001d3d0(ulonglong param_1,char param_2)

{
  uint uVar1;
  ushort uVar2;
  uint uVar3;
  char *pcVar4;
  char *pcVar5;
  undefined1 auVar6 [16];
  char cVar7;
  char cVar11;
  char cVar12;
  char cVar13;
  undefined1 in_XMM1 [16];
  undefined1 auVar8 [16];
  undefined1 auVar9 [16];
  undefined1 auVar10 [16];
  
  pcVar4 = (char *)(param_1 & 0xfffffffffffffff0);
  auVar8 = pshuflw(in_XMM1,ZEXT216(CONCAT11(param_2,param_2)),0);
  auVar6[0] = -(*pcVar4 == '\0');
  auVar6[1] = -(pcVar4[1] == '\0');
  auVar6[2] = -(pcVar4[2] == '\0');
  auVar6[3] = -(pcVar4[3] == '\0');
  auVar6[4] = -(pcVar4[4] == '\0');
  auVar6[5] = -(pcVar4[5] == '\0');
  auVar6[6] = -(pcVar4[6] == '\0');
  auVar6[7] = -(pcVar4[7] == '\0');
  auVar6[8] = -(pcVar4[8] == '\0');
  auVar6[9] = -(pcVar4[9] == '\0');
  auVar6[10] = -(pcVar4[10] == '\0');
  auVar6[0xb] = -(pcVar4[0xb] == '\0');
  auVar6[0xc] = -(pcVar4[0xc] == '\0');
  auVar6[0xd] = -(pcVar4[0xd] == '\0');
  auVar6[0xe] = -(pcVar4[0xe] == '\0');
  auVar6[0xf] = -(pcVar4[0xf] == '\0');
  cVar7 = auVar8[0];
  auVar9[0] = -(cVar7 == *pcVar4);
  cVar11 = auVar8[1];
  auVar9[1] = -(cVar11 == pcVar4[1]);
  cVar12 = auVar8[2];
  auVar9[2] = -(cVar12 == pcVar4[2]);
  cVar13 = auVar8[3];
  auVar9[3] = -(cVar13 == pcVar4[3]);
  auVar9[4] = -(cVar7 == pcVar4[4]);
  auVar9[5] = -(cVar11 == pcVar4[5]);
  auVar9[6] = -(cVar12 == pcVar4[6]);
  auVar9[7] = -(cVar13 == pcVar4[7]);
  auVar9[8] = -(cVar7 == pcVar4[8]);
  auVar9[9] = -(cVar11 == pcVar4[9]);
  auVar9[10] = -(cVar12 == pcVar4[10]);
  auVar9[0xb] = -(cVar13 == pcVar4[0xb]);
  auVar9[0xc] = -(cVar7 == pcVar4[0xc]);
  auVar9[0xd] = -(cVar11 == pcVar4[0xd]);
  auVar9[0xe] = -(cVar12 == pcVar4[0xe]);
  auVar9[0xf] = -(cVar13 == pcVar4[0xf]);
  auVar9 = auVar9 | auVar6;
  uVar3 = (uint)(ushort)((ushort)(SUB161(auVar9 >> 7,0) & 1) |
                         (ushort)(SUB161(auVar9 >> 0xf,0) & 1) << 1 |
                         (ushort)(SUB161(auVar9 >> 0x17,0) & 1) << 2 |
                         (ushort)(SUB161(auVar9 >> 0x1f,0) & 1) << 3 |
                         (ushort)(SUB161(auVar9 >> 0x27,0) & 1) << 4 |
                         (ushort)(SUB161(auVar9 >> 0x2f,0) & 1) << 5 |
                         (ushort)(SUB161(auVar9 >> 0x37,0) & 1) << 6 |
                         (ushort)(SUB161(auVar9 >> 0x3f,0) & 1) << 7 |
                         (ushort)(SUB161(auVar9 >> 0x47,0) & 1) << 8 |
                         (ushort)(SUB161(auVar9 >> 0x4f,0) & 1) << 9 |
                         (ushort)(SUB161(auVar9 >> 0x57,0) & 1) << 10 |
                         (ushort)(SUB161(auVar9 >> 0x5f,0) & 1) << 0xb |
                         (ushort)(SUB161(auVar9 >> 0x67,0) & 1) << 0xc |
                         (ushort)(SUB161(auVar9 >> 0x6f,0) & 1) << 0xd |
                         (ushort)(SUB161(auVar9 >> 0x77,0) & 1) << 0xe |
                        (ushort)(byte)(auVar9[0xf] >> 7) << 0xf) & -1 << ((byte)param_1 & 0xf);
  pcVar5 = pcVar4;
  if (uVar3 == 0) {
    do {
      pcVar4 = pcVar5 + 0x10;
      auVar10[0] = -(cVar7 == *pcVar4);
      auVar10[1] = -(cVar11 == pcVar5[0x11]);
      auVar10[2] = -(cVar12 == pcVar5[0x12]);
      auVar10[3] = -(cVar13 == pcVar5[0x13]);
      auVar10[4] = -(cVar7 == pcVar5[0x14]);
      auVar10[5] = -(cVar11 == pcVar5[0x15]);
      auVar10[6] = -(cVar12 == pcVar5[0x16]);
      auVar10[7] = -(cVar13 == pcVar5[0x17]);
      auVar10[8] = -(cVar7 == pcVar5[0x18]);
      auVar10[9] = -(cVar11 == pcVar5[0x19]);
      auVar10[10] = -(cVar12 == pcVar5[0x1a]);
      auVar10[0xb] = -(cVar13 == pcVar5[0x1b]);
      auVar10[0xc] = -(cVar7 == pcVar5[0x1c]);
      auVar10[0xd] = -(cVar11 == pcVar5[0x1d]);
      auVar10[0xe] = -(cVar12 == pcVar5[0x1e]);
      auVar10[0xf] = -(cVar13 == pcVar5[0x1f]);
      auVar8[0] = -(*pcVar4 == '\0');
      auVar8[1] = -(pcVar5[0x11] == '\0');
      auVar8[2] = -(pcVar5[0x12] == '\0');
      auVar8[3] = -(pcVar5[0x13] == '\0');
      auVar8[4] = -(pcVar5[0x14] == '\0');
      auVar8[5] = -(pcVar5[0x15] == '\0');
      auVar8[6] = -(pcVar5[0x16] == '\0');
      auVar8[7] = -(pcVar5[0x17] == '\0');
      auVar8[8] = -(pcVar5[0x18] == '\0');
      auVar8[9] = -(pcVar5[0x19] == '\0');
      auVar8[10] = -(pcVar5[0x1a] == '\0');
      auVar8[0xb] = -(pcVar5[0x1b] == '\0');
      auVar8[0xc] = -(pcVar5[0x1c] == '\0');
      auVar8[0xd] = -(pcVar5[0x1d] == '\0');
      auVar8[0xe] = -(pcVar5[0x1e] == '\0');
      auVar8[0xf] = -(pcVar5[0x1f] == '\0');
      auVar10 = auVar10 | auVar8;
      uVar2 = (ushort)(SUB161(auVar10 >> 7,0) & 1) | (ushort)(SUB161(auVar10 >> 0xf,0) & 1) << 1 |
              (ushort)(SUB161(auVar10 >> 0x17,0) & 1) << 2 |
              (ushort)(SUB161(auVar10 >> 0x1f,0) & 1) << 3 |
              (ushort)(SUB161(auVar10 >> 0x27,0) & 1) << 4 |
              (ushort)(SUB161(auVar10 >> 0x2f,0) & 1) << 5 |
              (ushort)(SUB161(auVar10 >> 0x37,0) & 1) << 6 |
              (ushort)(SUB161(auVar10 >> 0x3f,0) & 1) << 7 |
              (ushort)(SUB161(auVar10 >> 0x47,0) & 1) << 8 |
              (ushort)(SUB161(auVar10 >> 0x4f,0) & 1) << 9 |
              (ushort)(SUB161(auVar10 >> 0x57,0) & 1) << 10 |
              (ushort)(SUB161(auVar10 >> 0x5f,0) & 1) << 0xb |
              (ushort)(SUB161(auVar10 >> 0x67,0) & 1) << 0xc |
              (ushort)(SUB161(auVar10 >> 0x6f,0) & 1) << 0xd |
              (ushort)(SUB161(auVar10 >> 0x77,0) & 1) << 0xe |
              (ushort)(byte)(auVar10[0xf] >> 7) << 0xf;
      uVar3 = (uint)uVar2;
      pcVar5 = pcVar4;
    } while (uVar2 == 0);
  }
  uVar1 = 0;
  if (uVar3 != 0) {
    for (; (uVar3 >> uVar1 & 1) == 0; uVar1 = uVar1 + 1) {
    }
  }
  pcVar5 = (char *)0x0;
  if (pcVar4[uVar1] == param_2) {
    pcVar5 = pcVar4 + uVar1;
  }
  return pcVar5;
}



void FUN_18001d45c(LPVOID param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  if ((param_1 != (LPVOID)0x0) && (BVar1 = HeapFree(DAT_180048c88,0,param_1), BVar1 == 0)) {
    pDVar3 = FUN_18001fa28();
    DVar2 = GetLastError();
    DVar2 = FUN_18001fa48(DVar2);
    *pDVar3 = DVar2;
  }
  return;
}



undefined8 FUN_18001d49c(undefined8 param_1,ulonglong param_2,undefined8 param_3,longlong param_4)

{
  FUN_18001d4bc(param_2,param_4,*(uint **)(param_4 + 0x38));
  return 1;
}



void FUN_18001d4bc(ulonglong param_1,longlong param_2,uint *param_3)

{
  longlong lVar1;
  ulonglong uVar2;
  
  uVar2 = param_1;
  if ((*param_3 & 4) != 0) {
    uVar2 = (longlong)(int)param_3[1] + param_1 & (longlong)(int)-param_3[2];
  }
  lVar1 = (ulonglong)*(uint *)(*(longlong *)(param_2 + 0x10) + 8) + *(longlong *)(param_2 + 8);
  if ((*(byte *)(lVar1 + 3) & 0xf) != 0) {
    param_1 = param_1 + (longlong)(int)(*(byte *)(lVar1 + 3) & 0xfffffff0);
  }
  FUN_18001d530(param_1 ^ *(ulonglong *)((longlong)(int)(*param_3 & 0xfffffff8) + uVar2));
  return;
}



void FUN_18001d530(longlong param_1)

{
  if ((param_1 == DAT_1800461a0) && ((short)((ulonglong)param_1 >> 0x30) == 0)) {
    return;
  }
  FUN_18001fb10();
  return;
}



undefined8 * FUN_18001d560(undefined8 *param_1,undefined8 *param_2,ulonglong param_3)

{
  undefined4 *puVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined8 *puVar7;
  undefined8 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  longlong lVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  
  if (0x10 < param_3) {
    lVar11 = (longlong)param_2 - (longlong)param_1;
    if ((param_2 < param_1) && ((longlong)param_1 < (longlong)((longlong)param_2 + param_3))) {
      if ((DAT_180049204 >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          uVar12 = (longlong)param_1 + param_3;
          if ((uVar12 & 0xf) == 0) {
            puVar9 = (undefined4 *)(uVar12 - 0x10);
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar9);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            uVar12 = param_3 - 0x10;
          }
          else {
            puVar7 = (undefined8 *)(uVar12 - 0x10);
            uVar4 = ((undefined8 *)(lVar11 + (longlong)puVar7))[1];
            puVar9 = (undefined4 *)((ulonglong)puVar7 & 0xfffffffffffffff0);
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar9);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            *puVar7 = *(undefined8 *)(lVar11 + (longlong)puVar7);
            *(undefined8 *)(uVar12 - 8) = uVar4;
            uVar12 = (longlong)puVar9 - (longlong)param_1;
          }
          uVar13 = uVar12 >> 7;
          if (uVar13 != 0) {
            *puVar9 = uVar14;
            puVar9[1] = uVar15;
            puVar9[2] = uVar16;
            puVar9[3] = uVar17;
            puVar10 = puVar9;
            while( true ) {
              puVar7 = (undefined8 *)(lVar11 + -0x10 + (longlong)puVar10);
              uVar4 = puVar7[1];
              puVar8 = (undefined8 *)(lVar11 + -0x20 + (longlong)puVar10);
              uVar5 = *puVar8;
              uVar6 = puVar8[1];
              puVar9 = puVar10 + -0x20;
              *(undefined8 *)(puVar10 + -4) = *puVar7;
              *(undefined8 *)(puVar10 + -2) = uVar4;
              *(undefined8 *)(puVar10 + -8) = uVar5;
              *(undefined8 *)(puVar10 + -6) = uVar6;
              puVar7 = (undefined8 *)(lVar11 + 0x50 + (longlong)puVar9);
              uVar4 = puVar7[1];
              puVar8 = (undefined8 *)(lVar11 + 0x40 + (longlong)puVar9);
              uVar5 = *puVar8;
              uVar6 = puVar8[1];
              uVar13 = uVar13 - 1;
              *(undefined8 *)(puVar10 + -0xc) = *puVar7;
              *(undefined8 *)(puVar10 + -10) = uVar4;
              *(undefined8 *)(puVar10 + -0x10) = uVar5;
              *(undefined8 *)(puVar10 + -0xe) = uVar6;
              puVar7 = (undefined8 *)(lVar11 + 0x30 + (longlong)puVar9);
              uVar4 = puVar7[1];
              puVar8 = (undefined8 *)(lVar11 + 0x20 + (longlong)puVar9);
              uVar5 = *puVar8;
              uVar6 = puVar8[1];
              *(undefined8 *)(puVar10 + -0x14) = *puVar7;
              *(undefined8 *)(puVar10 + -0x12) = uVar4;
              *(undefined8 *)(puVar10 + -0x18) = uVar5;
              *(undefined8 *)(puVar10 + -0x16) = uVar6;
              puVar7 = (undefined8 *)(lVar11 + 0x10 + (longlong)puVar9);
              uVar4 = *puVar7;
              uVar5 = puVar7[1];
              puVar1 = (undefined4 *)(lVar11 + (longlong)puVar9);
              uVar14 = *puVar1;
              uVar15 = puVar1[1];
              uVar16 = puVar1[2];
              uVar17 = puVar1[3];
              if (uVar13 == 0) break;
              *(undefined8 *)(puVar10 + -0x1c) = uVar4;
              *(undefined8 *)(puVar10 + -0x1a) = uVar5;
              *puVar9 = uVar14;
              puVar10[-0x1f] = uVar15;
              puVar10[-0x1e] = uVar16;
              puVar10[-0x1d] = uVar17;
              puVar10 = puVar9;
            }
            *(undefined8 *)(puVar10 + -0x1c) = uVar4;
            *(undefined8 *)(puVar10 + -0x1a) = uVar5;
            uVar12 = uVar12 & 0x7f;
          }
          for (uVar13 = uVar12 >> 4; uVar13 != 0; uVar13 = uVar13 - 1) {
            *puVar9 = uVar14;
            puVar9[1] = uVar15;
            puVar9[2] = uVar16;
            puVar9[3] = uVar17;
            puVar9 = puVar9 + -4;
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar9);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
          }
          if ((uVar12 & 0xf) != 0) {
            uVar4 = param_2[1];
            *param_1 = *param_2;
            param_1[1] = uVar4;
          }
          *puVar9 = uVar14;
          puVar9[1] = uVar15;
          puVar9[2] = uVar16;
          puVar9[3] = uVar17;
          return param_1;
        }
LAB_18001d8f0:
        uVar4 = param_2[1];
        puVar7 = (undefined8 *)((param_3 - 0x10) + (longlong)param_1);
        uVar5 = *(undefined8 *)(lVar11 + (longlong)puVar7);
        uVar6 = ((undefined8 *)(lVar11 + (longlong)puVar7))[1];
        *param_1 = *param_2;
        param_1[1] = uVar4;
        *puVar7 = uVar5;
        puVar7[1] = uVar6;
        return param_1;
      }
      puVar7 = (undefined8 *)((longlong)param_1 + param_3);
      if (((ulonglong)puVar7 & 7) != 0) {
        if (((ulonglong)puVar7 & 1) != 0) {
          puVar7 = (undefined8 *)((longlong)puVar7 + -1);
          param_3 = param_3 - 1;
          *(undefined1 *)puVar7 = *(undefined1 *)(lVar11 + (longlong)puVar7);
        }
        if (((ulonglong)puVar7 & 2) != 0) {
          puVar7 = (undefined8 *)((longlong)puVar7 + -2);
          param_3 = param_3 - 2;
          *(undefined2 *)puVar7 = *(undefined2 *)(lVar11 + (longlong)puVar7);
        }
        if (((ulonglong)puVar7 & 4) != 0) {
          puVar7 = (undefined8 *)((longlong)puVar7 + -4);
          param_3 = param_3 - 4;
          *(undefined4 *)puVar7 = *(undefined4 *)(lVar11 + (longlong)puVar7);
        }
      }
      uVar12 = param_3 >> 5;
      puVar8 = puVar7;
      if (uVar12 != 0) {
        do {
          uVar4 = *(undefined8 *)(lVar11 + -0x10 + (longlong)puVar8);
          puVar7 = puVar8 + -4;
          puVar8[-1] = *(undefined8 *)(lVar11 + -8 + (longlong)puVar8);
          puVar8[-2] = uVar4;
          uVar4 = *(undefined8 *)(lVar11 + (longlong)puVar7);
          uVar12 = uVar12 - 1;
          puVar8[-3] = *(undefined8 *)(lVar11 + 8 + (longlong)puVar7);
          *puVar7 = uVar4;
          puVar8 = puVar7;
        } while (uVar12 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar12 = param_3 >> 3;
      if (uVar12 != 0) {
        do {
          puVar7 = puVar7 + -1;
          uVar12 = uVar12 - 1;
          *puVar7 = *(undefined8 *)(lVar11 + (longlong)puVar7);
        } while (uVar12 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_1 = (undefined8 *)((longlong)puVar7 - param_3);
      param_2 = (undefined8 *)(lVar11 + (longlong)param_1);
    }
    else {
      puVar7 = param_1;
      if ((DAT_180049204 >> 1 & 1) != 0) {
        for (; param_3 != 0; param_3 = param_3 - 1) {
          *(undefined1 *)puVar7 = *(undefined1 *)param_2;
          param_2 = (undefined8 *)((longlong)param_2 + 1);
          puVar7 = (undefined8 *)((longlong)puVar7 + 1);
        }
        return param_1;
      }
      if ((DAT_180049204 >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          if (((ulonglong)param_1 & 0xf) == 0) {
            puVar10 = (undefined4 *)(lVar11 + (longlong)param_1);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            puVar7 = param_1 + 2;
            uVar12 = param_3 - 0x10;
          }
          else {
            uVar4 = ((undefined8 *)(lVar11 + (longlong)param_1))[1];
            puVar7 = (undefined8 *)((ulonglong)(param_1 + 4) & 0xfffffffffffffff0);
            puVar10 = (undefined4 *)(lVar11 + -0x10 + (longlong)puVar7);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            *param_1 = *(undefined8 *)(lVar11 + (longlong)param_1);
            param_1[1] = uVar4;
            uVar12 = param_3 - ((longlong)puVar7 - (longlong)param_1);
          }
          uVar13 = uVar12 >> 7;
          if (uVar13 != 0) {
            *(undefined4 *)(puVar7 + -2) = uVar14;
            *(undefined4 *)((longlong)puVar7 + -0xc) = uVar15;
            *(undefined4 *)(puVar7 + -1) = uVar16;
            *(undefined4 *)((longlong)puVar7 + -4) = uVar17;
            puVar8 = puVar7;
            while( true ) {
              uVar4 = ((undefined8 *)(lVar11 + (longlong)puVar8))[1];
              puVar7 = (undefined8 *)(lVar11 + 0x10 + (longlong)puVar8);
              uVar5 = *puVar7;
              uVar6 = puVar7[1];
              puVar7 = puVar8 + 0x10;
              *puVar8 = *(undefined8 *)(lVar11 + (longlong)puVar8);
              puVar8[1] = uVar4;
              puVar8[2] = uVar5;
              puVar8[3] = uVar6;
              puVar2 = (undefined8 *)(lVar11 + -0x60 + (longlong)puVar7);
              uVar4 = puVar2[1];
              puVar3 = (undefined8 *)(lVar11 + -0x50 + (longlong)puVar7);
              uVar5 = *puVar3;
              uVar6 = puVar3[1];
              uVar13 = uVar13 - 1;
              puVar8[4] = *puVar2;
              puVar8[5] = uVar4;
              puVar8[6] = uVar5;
              puVar8[7] = uVar6;
              puVar2 = (undefined8 *)(lVar11 + -0x40 + (longlong)puVar7);
              uVar4 = puVar2[1];
              puVar3 = (undefined8 *)(lVar11 + -0x30 + (longlong)puVar7);
              uVar5 = *puVar3;
              uVar6 = puVar3[1];
              puVar8[8] = *puVar2;
              puVar8[9] = uVar4;
              puVar8[10] = uVar5;
              puVar8[0xb] = uVar6;
              puVar2 = (undefined8 *)(lVar11 + -0x20 + (longlong)puVar7);
              uVar4 = *puVar2;
              uVar5 = puVar2[1];
              puVar10 = (undefined4 *)(lVar11 + -0x10 + (longlong)puVar7);
              uVar14 = *puVar10;
              uVar15 = puVar10[1];
              uVar16 = puVar10[2];
              uVar17 = puVar10[3];
              if (uVar13 == 0) break;
              puVar8[0xc] = uVar4;
              puVar8[0xd] = uVar5;
              *(undefined4 *)(puVar8 + 0xe) = uVar14;
              *(undefined4 *)((longlong)puVar8 + 0x74) = uVar15;
              *(undefined4 *)(puVar8 + 0xf) = uVar16;
              *(undefined4 *)((longlong)puVar8 + 0x7c) = uVar17;
              puVar8 = puVar7;
            }
            puVar8[0xc] = uVar4;
            puVar8[0xd] = uVar5;
            uVar12 = uVar12 & 0x7f;
          }
          for (uVar13 = uVar12 >> 4; uVar13 != 0; uVar13 = uVar13 - 1) {
            *(undefined4 *)(puVar7 + -2) = uVar14;
            *(undefined4 *)((longlong)puVar7 + -0xc) = uVar15;
            *(undefined4 *)(puVar7 + -1) = uVar16;
            *(undefined4 *)((longlong)puVar7 + -4) = uVar17;
            puVar10 = (undefined4 *)(lVar11 + (longlong)puVar7);
            uVar14 = *puVar10;
            uVar15 = puVar10[1];
            uVar16 = puVar10[2];
            uVar17 = puVar10[3];
            puVar7 = puVar7 + 2;
          }
          uVar12 = uVar12 & 0xf;
          if (uVar12 != 0) {
            puVar8 = (undefined8 *)((longlong)puVar7 + lVar11 + -0x10 + uVar12);
            uVar4 = puVar8[1];
            *(undefined8 *)((longlong)puVar7 + (uVar12 - 0x10)) = *puVar8;
            *(undefined8 *)((longlong)puVar7 + (uVar12 - 8)) = uVar4;
          }
          *(undefined4 *)(puVar7 + -2) = uVar14;
          *(undefined4 *)((longlong)puVar7 + -0xc) = uVar15;
          *(undefined4 *)(puVar7 + -1) = uVar16;
          *(undefined4 *)((longlong)puVar7 + -4) = uVar17;
          return param_1;
        }
        goto LAB_18001d8f0;
      }
      if (((ulonglong)param_1 & 7) != 0) {
        if (((ulonglong)param_1 & 1) != 0) {
          param_3 = param_3 - 1;
          *(undefined1 *)param_1 = *(undefined1 *)(lVar11 + (longlong)param_1);
          puVar7 = (undefined8 *)((longlong)param_1 + 1);
        }
        if (((ulonglong)puVar7 & 2) != 0) {
          param_3 = param_3 - 2;
          *(undefined2 *)puVar7 = *(undefined2 *)(lVar11 + (longlong)puVar7);
          puVar7 = (undefined8 *)((longlong)puVar7 + 2);
        }
        if (((ulonglong)puVar7 & 4) != 0) {
          param_3 = param_3 - 4;
          *(undefined4 *)puVar7 = *(undefined4 *)(lVar11 + (longlong)puVar7);
          puVar7 = (undefined8 *)((longlong)puVar7 + 4);
        }
      }
      uVar12 = param_3 >> 5;
      puVar8 = puVar7;
      if (uVar12 != 0) {
        do {
          uVar4 = *(undefined8 *)(lVar11 + 8 + (longlong)puVar8);
          puVar7 = puVar8 + 4;
          *puVar8 = *(undefined8 *)(lVar11 + (longlong)puVar8);
          puVar8[1] = uVar4;
          uVar4 = *(undefined8 *)(lVar11 + -8 + (longlong)puVar7);
          uVar12 = uVar12 - 1;
          puVar8[2] = *(undefined8 *)(lVar11 + -0x10 + (longlong)puVar7);
          puVar8[3] = uVar4;
          puVar8 = puVar7;
        } while (uVar12 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar12 = param_3 >> 3;
      if (uVar12 != 0) {
        do {
          *puVar7 = *(undefined8 *)(lVar11 + (longlong)puVar7);
          puVar7 = puVar7 + 1;
          uVar12 = uVar12 - 1;
        } while (uVar12 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_2 = (undefined8 *)(lVar11 + (longlong)puVar7);
      param_1 = puVar7;
    }
  }
                    // WARNING: Could not recover jumptable at 0x00018001d63e. Too many branches
                    // WARNING: Treating indirect jump as call
  puVar7 = (undefined8 *)
           (*(code *)((ulonglong)*(uint *)(&DAT_18001d640 + param_3 * 4) + 0x180000000))
                     (param_1,param_2);
  return puVar7;
}



int FUN_18001dae0(ulonglong *param_1,longlong param_2,ulonglong param_3)

{
  uint uVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong uVar4;
  bool bVar5;
  
  lVar3 = param_2 - (longlong)param_1;
  if (7 < param_3) {
    uVar4 = (ulonglong)param_1 & 7;
    while (uVar4 != 0) {
      bVar5 = (byte)*param_1 < *(byte *)(lVar3 + (longlong)param_1);
      if ((byte)*param_1 != *(byte *)(lVar3 + (longlong)param_1)) goto LAB_18001db23;
      param_1 = (ulonglong *)((longlong)param_1 + 1);
      param_3 = param_3 - 1;
      uVar4 = (ulonglong)param_1 & 7;
    }
    if (param_3 >> 3 != 0) {
      uVar4 = param_3 >> 5;
      if (uVar4 != 0) {
        do {
          uVar2 = *param_1;
          if (uVar2 != *(ulonglong *)(lVar3 + (longlong)param_1)) goto LAB_18001db94;
          uVar2 = param_1[1];
          if (uVar2 != *(ulonglong *)(lVar3 + 8 + (longlong)param_1)) {
LAB_18001db90:
            param_1 = param_1 + 1;
            goto LAB_18001db94;
          }
          uVar2 = param_1[2];
          if (uVar2 != *(ulonglong *)(lVar3 + 0x10 + (longlong)param_1)) {
LAB_18001db8c:
            param_1 = param_1 + 1;
            goto LAB_18001db90;
          }
          uVar2 = param_1[3];
          if (uVar2 != *(ulonglong *)(lVar3 + 0x18 + (longlong)param_1)) {
            param_1 = param_1 + 1;
            goto LAB_18001db8c;
          }
          param_1 = param_1 + 4;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar4 = param_3 >> 3;
      if (uVar4 != 0) {
        do {
          uVar2 = *param_1;
          if (uVar2 != *(ulonglong *)(lVar3 + (longlong)param_1)) {
LAB_18001db94:
            uVar4 = *(ulonglong *)((longlong)param_1 + lVar3);
            uVar1 = (uint)((uVar2 >> 0x38 | (uVar2 & 0xff000000000000) >> 0x28 |
                            (uVar2 & 0xff0000000000) >> 0x18 | (uVar2 & 0xff00000000) >> 8 |
                            (uVar2 & 0xff000000) << 8 | (uVar2 & 0xff0000) << 0x18 |
                            (uVar2 & 0xff00) << 0x28 | uVar2 << 0x38) <
                          (uVar4 >> 0x38 | (uVar4 & 0xff000000000000) >> 0x28 |
                           (uVar4 & 0xff0000000000) >> 0x18 | (uVar4 & 0xff00000000) >> 8 |
                           (uVar4 & 0xff000000) << 8 | (uVar4 & 0xff0000) << 0x18 |
                           (uVar4 & 0xff00) << 0x28 | uVar4 << 0x38));
            return (1 - uVar1) - (uint)(uVar1 != 0);
          }
          param_1 = param_1 + 1;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        param_3 = param_3 & 7;
      }
    }
  }
  while( true ) {
    if (param_3 == 0) {
      return 0;
    }
    bVar5 = (byte)*param_1 < *(byte *)(lVar3 + (longlong)param_1);
    if ((byte)*param_1 != *(byte *)(lVar3 + (longlong)param_1)) break;
    param_1 = (ulonglong *)((longlong)param_1 + 1);
    param_3 = param_3 - 1;
  }
LAB_18001db23:
  return (1 - (uint)bVar5) - (uint)(bVar5 != 0);
}



undefined1 (*) [16] FUN_18001dbc0(undefined1 (*param_1) [16],byte param_2,ulonglong param_3)

{
  uint uVar1;
  undefined1 (*pauVar2) [16];
  undefined1 (*pauVar3) [16];
  undefined1 uVar4;
  ulonglong uVar7;
  longlong lVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  undefined1 auVar11 [16];
  undefined2 uVar5;
  undefined4 uVar6;
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 uVar19;
  
  if (0xf < param_3) {
    pauVar2 = param_1;
    if ((DAT_180049204 >> 1 & 1) == 0) {
      uVar7 = (ulonglong)param_2 * 0x101010101010101;
      uVar4 = (undefined1)uVar7;
      if ((DAT_180049204 >> 2 & 1) != 0) {
        uVar19 = (undefined1)(uVar7 >> 0x38);
        auVar18._8_6_ = 0;
        auVar18._0_8_ = uVar7;
        auVar18[0xe] = uVar19;
        auVar18[0xf] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x30);
        auVar17._14_2_ = auVar18._14_2_;
        auVar17._8_5_ = 0;
        auVar17._0_8_ = uVar7;
        auVar17[0xd] = uVar19;
        auVar16._13_3_ = auVar17._13_3_;
        auVar16._8_4_ = 0;
        auVar16._0_8_ = uVar7;
        auVar16[0xc] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x28);
        auVar15._12_4_ = auVar16._12_4_;
        auVar15._8_3_ = 0;
        auVar15._0_8_ = uVar7;
        auVar15[0xb] = uVar19;
        auVar14._11_5_ = auVar15._11_5_;
        auVar14._8_2_ = 0;
        auVar14._0_8_ = uVar7;
        auVar14[10] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x20);
        auVar13._10_6_ = auVar14._10_6_;
        auVar13[8] = 0;
        auVar13._0_8_ = uVar7;
        auVar13[9] = uVar19;
        auVar12._9_7_ = auVar13._9_7_;
        auVar12[8] = uVar19;
        auVar12._0_8_ = uVar7;
        uVar19 = (undefined1)(uVar7 >> 0x18);
        auVar11._8_8_ = auVar12._8_8_;
        auVar11[7] = uVar19;
        auVar11[6] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 0x10);
        auVar11[5] = uVar19;
        auVar11[4] = uVar19;
        uVar19 = (undefined1)(uVar7 >> 8);
        auVar11[3] = uVar19;
        auVar11[2] = uVar19;
        auVar11[1] = uVar4;
        auVar11[0] = uVar4;
        if (((ulonglong)param_1 & 0xf) != 0) {
          *param_1 = auVar11;
          pauVar2 = (undefined1 (*) [16])((longlong)param_1 + (0x10 - ((ulonglong)param_1 & 0xf)));
          param_3 = (((ulonglong)param_1 & 0xf) - 0x10) + param_3;
        }
        uVar7 = param_3 >> 7;
        pauVar3 = pauVar2;
        if (uVar7 != 0) {
          do {
            *pauVar2 = auVar11;
            pauVar2[1] = auVar11;
            pauVar3 = pauVar2 + 8;
            pauVar2[2] = auVar11;
            pauVar2[3] = auVar11;
            uVar7 = uVar7 - 1;
            pauVar2[4] = auVar11;
            pauVar2[5] = auVar11;
            pauVar2[6] = auVar11;
            pauVar2[7] = auVar11;
            pauVar2 = pauVar3;
          } while (uVar7 != 0);
          param_3 = param_3 & 0x7f;
        }
        for (uVar7 = param_3 >> 4; uVar7 != 0; uVar7 = uVar7 - 1) {
          *pauVar3 = auVar11;
          pauVar3 = pauVar3 + 1;
        }
        if ((param_3 & 0xf) != 0) {
          *(undefined1 (*) [16])(pauVar3[-1] + (param_3 & 0xf)) = auVar11;
        }
        return param_1;
      }
      if (0x3f < param_3) {
        uVar1 = -(int)param_1 & 7;
        uVar9 = param_3;
        if (uVar1 != 0) {
          uVar9 = param_3 - uVar1;
          *(ulonglong *)*param_1 = uVar7;
        }
        param_3 = uVar9 & 0x3f;
        pauVar2 = (undefined1 (*) [16])(*param_1 + uVar1);
        for (uVar9 = uVar9 >> 6; uVar9 != 0; uVar9 = uVar9 - 1) {
          *(ulonglong *)*pauVar2 = uVar7;
          *(ulonglong *)(*pauVar2 + 8) = uVar7;
          *(ulonglong *)pauVar2[1] = uVar7;
          *(ulonglong *)(pauVar2[1] + 8) = uVar7;
          *(ulonglong *)pauVar2[2] = uVar7;
          *(ulonglong *)(pauVar2[2] + 8) = uVar7;
          *(ulonglong *)pauVar2[3] = uVar7;
          *(ulonglong *)(pauVar2[3] + 8) = uVar7;
          pauVar2 = pauVar2 + 4;
        }
      }
      uVar10 = param_3 & 7;
      for (uVar9 = param_3 >> 3; uVar9 != 0; uVar9 = uVar9 - 1) {
        *(ulonglong *)*pauVar2 = uVar7;
        pauVar2 = (undefined1 (*) [16])(*pauVar2 + 8);
      }
      for (; uVar10 != 0; uVar10 = uVar10 - 1) {
        (*pauVar2)[0] = uVar4;
        pauVar2 = (undefined1 (*) [16])(*pauVar2 + 1);
      }
    }
    else {
      for (; param_3 != 0; param_3 = param_3 - 1) {
        (*pauVar2)[0] = param_2;
        pauVar2 = (undefined1 (*) [16])(*pauVar2 + 1);
      }
    }
    return param_1;
  }
  lVar8 = (ulonglong)param_2 * 0x101010101010101;
  uVar4 = (undefined1)lVar8;
  uVar5 = (undefined2)lVar8;
  uVar6 = (undefined4)lVar8;
  switch(param_3) {
  case 0:
    return param_1;
  case 1:
    goto switchD_18001dd52_caseD_1;
  case 8:
    *(longlong *)(param_1[-1] + param_3 + 8) = lVar8;
    return param_1;
  case 9:
    *(longlong *)(param_1[-1] + param_3 + 7) = lVar8;
    param_1[-1][param_3 + 0xf] = uVar4;
    return param_1;
  case 10:
    *(longlong *)(param_1[-1] + param_3 + 6) = lVar8;
    *(undefined2 *)(param_1[-1] + param_3 + 0xe) = uVar5;
    return param_1;
  case 0xb:
    *(longlong *)(param_1[-1] + param_3 + 5) = lVar8;
    break;
  case 0xc:
    *(longlong *)(param_1[-1] + param_3 + 4) = lVar8;
  case 4:
    *(undefined4 *)(param_1[-1] + param_3 + 0xc) = uVar6;
    return param_1;
  case 0xd:
    *(longlong *)(param_1[-1] + param_3 + 3) = lVar8;
  case 5:
    *(undefined4 *)(param_1[-1] + param_3 + 0xb) = uVar6;
    param_1[-1][param_3 + 0xf] = uVar4;
    return param_1;
  case 0xe:
    *(longlong *)(param_1[-1] + param_3 + 2) = lVar8;
  case 6:
    *(undefined4 *)(param_1[-1] + param_3 + 10) = uVar6;
  case 2:
    *(undefined2 *)(param_1[-1] + param_3 + 0xe) = uVar5;
    return param_1;
  case 0xf:
    *(longlong *)(param_1[-1] + param_3 + 1) = lVar8;
  case 7:
    *(undefined4 *)(param_1[-1] + param_3 + 9) = uVar6;
  }
  *(undefined2 *)(param_1[-1] + param_3 + 0xd) = uVar5;
switchD_18001dd52_caseD_1:
  param_1[-1][param_3 + 0xf] = uVar4;
  return param_1;
}



bool FUN_18001ddec(longlong param_1,longlong param_2)

{
  ulonglong uVar1;
  
  uVar1 = FUN_18001fda0((ulonglong *)(param_2 + 0x11),param_1 + 0x11);
  return (int)uVar1 == 0;
}



undefined8 * FUN_18001de0c(undefined8 *param_1,uint param_2)

{
  *param_1 = type_info::vftable;
  FUN_18001fe08((longlong)param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001d45c(param_1);
  }
  return param_1;
}



DWORD FUN_18001de48(undefined1 *param_1,longlong param_2,char *param_3)

{
  char cVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  longlong lVar4;
  
  if ((param_1 != (undefined1 *)0x0) && (param_2 != 0)) {
    if (param_3 != (char *)0x0) {
      lVar4 = (longlong)param_1 - (longlong)param_3;
      do {
        cVar1 = *param_3;
        param_3[lVar4] = cVar1;
        param_3 = param_3 + 1;
        if (cVar1 == '\0') break;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        return 0;
      }
      *param_1 = 0;
      pDVar2 = FUN_18001fa28();
      DVar3 = 0x22;
      goto LAB_18001de6a;
    }
    *param_1 = 0;
  }
  pDVar2 = FUN_18001fa28();
  DVar3 = 0x16;
LAB_18001de6a:
  *pDVar2 = DVar3;
  FUN_18001ffd8();
  return DVar3;
}



DWORD FUN_18001deac(undefined2 *param_1,longlong param_2,short *param_3)

{
  short sVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  longlong lVar4;
  
  if ((param_1 != (undefined2 *)0x0) && (param_2 != 0)) {
    if (param_3 != (short *)0x0) {
      lVar4 = (longlong)param_1 - (longlong)param_3;
      do {
        sVar1 = *param_3;
        *(short *)(lVar4 + (longlong)param_3) = sVar1;
        param_3 = param_3 + 1;
        if (sVar1 == 0) break;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        return 0;
      }
      *param_1 = 0;
      pDVar2 = FUN_18001fa28();
      DVar3 = 0x22;
      goto LAB_18001ded2;
    }
    *param_1 = 0;
  }
  pDVar2 = FUN_18001fa28();
  DVar3 = 0x16;
LAB_18001ded2:
  *pDVar2 = DVar3;
  FUN_18001ffd8();
  return DVar3;
}



void FUN_18001df18(undefined1 *param_1,ulonglong param_2,longlong param_3,undefined8 param_4)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  FUN_18001e024(param_1,param_2,param_3,0,&local_res20);
  return;
}



ulonglong FUN_18001df3c(undefined *param_1,undefined1 *param_2,ulonglong param_3,longlong param_4,
                       undefined8 param_5,undefined8 param_6)

{
  DWORD *pDVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined *local_48;
  int local_40 [2];
  undefined1 *local_38;
  undefined4 local_30;
  
  local_48 = (undefined *)0x0;
  FUN_18001dbc0((undefined1 (*) [16])local_40,0,0x28);
  if ((param_4 == 0) || ((param_3 != 0 && (param_2 == (undefined1 *)0x0)))) {
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 0x16;
    FUN_18001ffd8();
    uVar2 = 0xffffffff;
  }
  else {
    local_40[0] = (int)param_3;
    if (0x7fffffff < param_3) {
      local_40[0] = 0x7fffffff;
    }
    local_30 = 0x42;
    local_48 = param_2;
    local_38 = param_2;
    uVar2 = (*(code *)param_1)(&local_48,param_4,param_5,param_6);
    if (param_2 != (undefined1 *)0x0) {
      if (-1 < (int)uVar2) {
        local_40[0] = local_40[0] + -1;
        if (-1 < local_40[0]) {
          *local_48 = 0;
          return uVar2 & 0xffffffff;
        }
        uVar3 = FUN_180020034(0,&local_48);
        if ((int)uVar3 != -1) {
          return uVar2 & 0xffffffff;
        }
      }
      param_2[param_3 - 1] = 0;
      uVar2 = (ulonglong)((-1 < local_40[0]) - 2);
    }
  }
  return uVar2;
}



ulonglong FUN_18001e024(undefined1 *param_1,ulonglong param_2,longlong param_3,undefined8 param_4,
                       undefined8 param_5)

{
  ulonglong uVar1;
  DWORD *pDVar2;
  
  if (((param_3 == 0) || (param_1 == (undefined1 *)0x0)) || (param_2 == 0)) {
    pDVar2 = FUN_18001fa28();
    *pDVar2 = 0x16;
  }
  else {
    uVar1 = FUN_18001df3c(FUN_180020268,param_1,param_2,param_3,param_4,param_5);
    if ((int)uVar1 < 0) {
      *param_1 = 0;
    }
    if ((int)uVar1 != -2) {
      return uVar1;
    }
    pDVar2 = FUN_18001fa28();
    *pDVar2 = 0x22;
  }
  FUN_18001ffd8();
  return 0xffffffff;
}



void FUN_18001e094(undefined1 *param_1,ulonglong param_2,longlong param_3,undefined8 param_4)

{
  FUN_18001e024(param_1,param_2,param_3,0,param_4);
  return;
}



uint FUN_18001e0ac(WCHAR *param_1,undefined8 *param_2,uint param_3,uint param_4)

{
  ushort uVar1;
  int iVar2;
  uint uVar3;
  DWORD *pDVar4;
  undefined6 extraout_var;
  WCHAR *pWVar5;
  WCHAR WVar6;
  uint uVar7;
  uint uVar8;
  
  if (param_2 != (undefined8 *)0x0) {
    *param_2 = param_1;
  }
  if ((param_1 == (WCHAR *)0x0) || ((param_3 != 0 && (0x22 < param_3 - 2)))) {
    pDVar4 = FUN_18001fa28();
    *pDVar4 = 0x16;
    FUN_18001ffd8();
    return 0;
  }
  WVar6 = *param_1;
  uVar7 = 0;
  pWVar5 = param_1 + 1;
  while (uVar1 = FUN_180020dc0(WVar6,8), (int)CONCAT62(extraout_var,uVar1) != 0) {
    WVar6 = *pWVar5;
    pWVar5 = pWVar5 + 1;
  }
  if (WVar6 == L'-') {
    param_4 = param_4 | 2;
LAB_18001e136:
    WVar6 = *pWVar5;
    pWVar5 = pWVar5 + 1;
  }
  else if (WVar6 == L'+') goto LAB_18001e136;
  if (param_3 == 0) {
    iVar2 = FUN_180020e28(WVar6);
    if (iVar2 != 0) {
      param_3 = 10;
      goto LAB_18001e19e;
    }
    if ((*pWVar5 + L'' & 0xffdfU) != 0) {
      param_3 = 8;
      goto LAB_18001e19e;
    }
    param_3 = 0x10;
  }
  if (((param_3 == 0x10) && (iVar2 = FUN_180020e28(WVar6), iVar2 == 0)) &&
     ((*pWVar5 + L'' & 0xffdfU) == 0)) {
    WVar6 = pWVar5[1];
    pWVar5 = pWVar5 + 2;
  }
LAB_18001e19e:
  do {
    uVar3 = FUN_180020e28(WVar6);
    if (uVar3 == 0xffffffff) {
      if ((0x19 < (ushort)(WVar6 + L'')) && (0x19 < (ushort)(WVar6 + L''))) {
LAB_18001e1f9:
        pWVar5 = pWVar5 + -1;
        if ((param_4 & 8) == 0) {
          if (param_2 != (undefined8 *)0x0) {
            pWVar5 = param_1;
          }
          uVar7 = 0;
        }
        else if (((param_4 & 4) != 0) ||
                (((param_4 & 1) == 0 &&
                 ((((param_4 & 2) != 0 && (0x80000000 < uVar7)) ||
                  (((param_4 & 2) == 0 && (0x7fffffff < uVar7)))))))) {
          pDVar4 = FUN_18001fa28();
          *pDVar4 = 0x22;
          if ((param_4 & 1) == 0) {
            uVar7 = ((param_4 & 2) != 0) + 0x7fffffff;
          }
          else {
            uVar7 = 0xffffffff;
          }
        }
        if (param_2 != (undefined8 *)0x0) {
          *param_2 = pWVar5;
        }
        if ((param_4 & 2) != 0) {
          uVar7 = -uVar7;
        }
        return uVar7;
      }
      uVar3 = (uint)(ushort)WVar6;
      if ((ushort)(WVar6 + L'') < 0x1a) {
        uVar3 = (ushort)WVar6 - 0x20;
      }
      uVar3 = uVar3 - 0x37;
    }
    if (param_3 <= uVar3) goto LAB_18001e1f9;
    uVar8 = (uint)(0xffffffff / (ulonglong)param_3);
    if ((uVar7 < uVar8) || ((uVar7 == uVar8 && (uVar3 <= (uint)(0xffffffff % (ulonglong)param_3)))))
    {
      uVar7 = uVar7 * param_3 + uVar3;
      param_4 = param_4 | 8;
    }
    else {
      param_4 = param_4 | 0xc;
      if (param_2 == (undefined8 *)0x0) goto LAB_18001e1f9;
    }
    WVar6 = *pWVar5;
    pWVar5 = pWVar5 + 1;
  } while( true );
}



void FUN_18001e294(WCHAR *param_1,undefined8 *param_2,uint param_3)

{
  FUN_18001e0ac(param_1,param_2,param_3,0);
  return;
}



longlong * FUN_18001e29c(longlong *param_1,DWORD64 *param_2,longlong param_3,longlong *param_4)

{
  uint uVar1;
  int iVar2;
  PRUNTIME_FUNCTION p_Var3;
  uint uVar4;
  ulonglong uVar5;
  int *piVar6;
  longlong lVar7;
  ulonglong uVar8;
  ulonglong local_res8;
  
  uVar8 = (ulonglong)*(uint *)(param_3 + 0xc);
  iVar2 = FUN_1800227e0(param_3,(longlong *)param_2);
  *param_4 = *param_1;
  do {
    do {
      if ((int)uVar8 == 0) {
        return param_4;
      }
      uVar8 = (ulonglong)((int)uVar8 - 1);
      lVar7 = (longlong)*(int *)(param_3 + 0x10) + uVar8 * 0x14 + param_2[1];
    } while ((iVar2 <= *(int *)(lVar7 + 4)) || (*(int *)(lVar7 + 8) < iVar2));
    p_Var3 = RtlLookupFunctionEntry(*param_2,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    uVar1 = *(uint *)(lVar7 + 0xc);
    lVar7 = (longlong)*(int *)(lVar7 + 0x10) + local_res8;
    uVar5 = 0;
    if (uVar1 != 0) {
      piVar6 = (int *)(lVar7 + 0xc);
      do {
        if ((longlong)*piVar6 == (ulonglong)p_Var3->BeginAddress) break;
        uVar4 = (int)uVar5 + 1;
        uVar5 = (ulonglong)uVar4;
        piVar6 = piVar6 + 5;
      } while (uVar4 < uVar1);
    }
    if ((uint)uVar5 < uVar1) {
      *param_4 = *(longlong *)((longlong)*(int *)(lVar7 + 0x10 + uVar5 * 0x14) + *param_1);
      return param_4;
    }
  } while( true );
}



longlong FUN_18001e368(undefined8 param_1,longlong param_2,undefined8 param_3,int param_4,
                      uint *param_5,int *param_6,longlong *param_7)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong lVar6;
  uint uVar7;
  longlong lVar8;
  
  uVar1 = *(uint *)(param_2 + 0xc);
  lVar6 = 0;
  iVar2 = FUN_1800227e0(param_2,param_7);
  if (uVar1 == 0) {
    FUN_180022874();
  }
  uVar5 = (ulonglong)uVar1;
  *param_6 = -1;
  *param_5 = 0xffffffff;
  uVar4 = uVar1;
  if (uVar1 != 0) {
    do {
      uVar4 = (uint)uVar5;
      uVar7 = uVar4 - 1;
      uVar5 = (ulonglong)uVar7;
      lVar8 = param_7[1] + uVar5 * 0x14;
      if ((*(int *)(lVar8 + 4 + (longlong)*(int *)(param_2 + 0x10)) < iVar2) &&
         (iVar2 <= *(int *)(lVar8 + 8 + (longlong)*(int *)(param_2 + 0x10)))) break;
      uVar4 = uVar7;
    } while (uVar7 != 0);
  }
  if (uVar4 != 0) {
    lVar6 = (longlong)*(int *)(param_2 + 0x10) + (ulonglong)(uVar4 - 1) * 0x14 + param_7[1];
  }
  uVar4 = 0;
  if (uVar1 != 0) {
    lVar8 = 0;
    do {
      piVar3 = (int *)(*(int *)(param_2 + 0x10) + lVar8 + param_7[1]);
      if ((((lVar6 == 0) || ((*(int *)(lVar6 + 4) < *piVar3 && (piVar3[1] <= *(int *)(lVar6 + 8)))))
          && (*piVar3 <= param_4)) && (param_4 <= piVar3[1])) {
        if (*param_5 == 0xffffffff) {
          *param_5 = uVar4;
        }
        *param_6 = uVar4 + 1;
      }
      uVar4 = uVar4 + 1;
      lVar8 = lVar8 + 0x14;
    } while (uVar4 < uVar1);
    if (*param_5 != 0xffffffff) {
      return (longlong)*(int *)(param_2 + 0x10) + (ulonglong)*param_5 * 0x14 + param_7[1];
    }
  }
  *param_5 = 0;
  *param_6 = 0;
  return 0;
}



void FUN_18001e494(longlong *param_1,DWORD64 *param_2,longlong param_3)

{
  int iVar1;
  longlong *plVar2;
  DWORD *pDVar3;
  longlong lVar4;
  ulonglong uVar5;
  longlong local_res18 [2];
  
  plVar2 = FUN_18001e29c(param_1,param_2,param_3,local_res18);
  iVar1 = FUN_1800227e0(param_3,(longlong *)param_2);
  uVar5 = (ulonglong)*(uint *)(param_3 + 0xc);
  do {
    if ((int)uVar5 == 0) {
      lVar4 = 0;
      break;
    }
    uVar5 = (ulonglong)((int)uVar5 - 1);
    pDVar3 = FUN_180021130();
    lVar4 = *(longlong *)(pDVar3 + 0x4a) + uVar5 * 0x14 + (longlong)*(int *)(param_3 + 0x10);
  } while ((iVar1 <= *(int *)(lVar4 + 4)) || (*(int *)(lVar4 + 8) < iVar1));
  if (lVar4 == 0) {
    iVar1 = -1;
  }
  else {
    iVar1 = *(int *)(lVar4 + 4);
  }
  FUN_18002225c(plVar2,(longlong *)param_2,param_3,iVar1);
  return;
}



undefined8
FUN_18001e528(longlong *param_1,undefined8 param_2,longlong *param_3,ULONG_PTR param_4,
             DWORD64 *param_5,uint *param_6,undefined4 *param_7)

{
  longlong lVar1;
  DWORD *pDVar2;
  
  pDVar2 = FUN_180021130();
  *(undefined8 *)(pDVar2 + 0x4e) = param_2;
  lVar1 = *param_1;
  pDVar2 = FUN_180021130();
  *(undefined8 *)(pDVar2 + 0x4c) = *(undefined8 *)(lVar1 + 0x38);
  FUN_1800223f0((int *)*param_1,param_3,param_4,param_5,param_6,0,0,1);
  pDVar2 = FUN_180021130();
  pDVar2[0x4e] = 0;
  pDVar2[0x4f] = 0;
  *param_7 = 1;
  return 1;
}



undefined4 FUN_18001e5cc(undefined4 *param_1,undefined8 param_2,undefined8 param_3)

{
  DWORD *pDVar1;
  undefined4 *local_20;
  undefined8 local_18;
  
  local_20 = param_1;
  local_18 = param_3;
  pDVar1 = FUN_180021130();
  (**(code **)(pDVar1 + 0x38))(*param_1,&local_20);
  return 0;
}



undefined8 * FUN_18001e620(undefined8 *param_1,undefined8 param_2)

{
  DWORD *pDVar1;
  undefined8 uVar2;
  
  *param_1 = param_2;
  pDVar1 = FUN_180021130();
  if (param_1 < *(undefined8 **)(pDVar1 + 0x48)) {
    pDVar1 = FUN_180021130();
    uVar2 = *(undefined8 *)(pDVar1 + 0x48);
  }
  else {
    uVar2 = 0;
  }
  param_1[1] = uVar2;
  pDVar1 = FUN_180021130();
  *(undefined8 **)(pDVar1 + 0x48) = param_1;
  return param_1;
}



void FUN_18001e664(longlong param_1)

{
  DWORD *pDVar1;
  longlong lVar2;
  
  pDVar1 = FUN_180021130();
  if (param_1 != *(longlong *)(pDVar1 + 0x48)) {
    FUN_180022874();
  }
  pDVar1 = FUN_180021130();
  lVar2 = *(longlong *)(pDVar1 + 0x48);
  while( true ) {
    if (lVar2 == 0) {
      FUN_180022874();
      return;
    }
    if (param_1 == lVar2) break;
    lVar2 = *(longlong *)(lVar2 + 8);
  }
  pDVar1 = FUN_180021130();
  *(undefined8 *)(pDVar1 + 0x48) = *(undefined8 *)(lVar2 + 8);
  return;
}



undefined8 FUN_18001e6c4(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180021130();
  return *(undefined8 *)(pDVar1 + 0x4a);
}



undefined8 FUN_18001e6dc(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180021130();
  return *(undefined8 *)(pDVar1 + 0x4c);
}



undefined4 FUN_18001e6f4(longlong param_1)

{
  DWORD *pDVar1;
  longlong *plVar2;
  
  pDVar1 = FUN_180021130();
  plVar2 = *(longlong **)(pDVar1 + 0x48);
  while( true ) {
    if (plVar2 == (longlong *)0x0) {
      return 1;
    }
    if (*plVar2 == param_1) break;
    plVar2 = (longlong *)plVar2[1];
  }
  return 0;
}



void FUN_18001e728(undefined8 param_1)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180021130();
  *(undefined8 *)(pDVar1 + 0x4a) = param_1;
  return;
}



void FUN_18001e744(undefined8 param_1)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180021130();
  *(undefined8 *)(pDVar1 + 0x4c) = param_1;
  return;
}



void FUN_18001e760(undefined8 *param_1,ULONG_PTR param_2,ULONG_PTR param_3,ULONG_PTR param_4,
                  ULONG_PTR param_5,int param_6,ULONG_PTR param_7,undefined8 *param_8,byte param_9)

{
  undefined1 auStackY_5b8 [32];
  EXCEPTION_RECORD local_588;
  _CONTEXT local_4e8;
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStackY_5b8;
  local_588.ExceptionCode = 0x80000029;
  local_588.ExceptionFlags = 1;
  local_588.ExceptionRecord = (_EXCEPTION_RECORD *)0x0;
  local_588.ExceptionAddress = (PVOID)0x0;
  local_588.NumberParameters = 0xf;
  local_588._28_4_ = 0;
  local_588.ExceptionInformation[9] = 0;
  local_588.ExceptionInformation[10]._0_4_ = 0;
  local_588.ExceptionInformation[10]._4_4_ = 0;
  local_588.ExceptionInformation[0xb]._0_4_ = 0;
  local_588.ExceptionInformation[0xb]._4_4_ = 0;
  local_588.ExceptionInformation[0xc]._0_4_ = 0;
  local_588.ExceptionInformation[0xc]._4_4_ = 0;
  local_588.ExceptionInformation[0xd]._0_4_ = 0;
  local_588.ExceptionInformation[0xd]._4_4_ = 0;
  local_588.ExceptionInformation[0xe] = 0;
  local_588.ExceptionInformation[0] = (ULONG_PTR)FUN_180022004;
  local_588.ExceptionInformation[2] = param_5;
  local_588.ExceptionInformation[3] = (ULONG_PTR)param_6;
  local_588.ExceptionInformation[5] = param_7;
  local_588.ExceptionInformation[7] = (ULONG_PTR)param_9;
  local_588.ExceptionInformation[8] = 0x19930520;
  local_588.ExceptionInformation[1] = param_4;
  local_588.ExceptionInformation[4] = param_3;
  local_588.ExceptionInformation[6] = param_2;
  RtlUnwindEx((PVOID)*param_1,(PVOID)*param_8,&local_588,(PVOID)0x0,&local_4e8,
              (PUNWIND_HISTORY_TABLE)param_8[8]);
  FUN_18001d530(local_18 ^ (ulonglong)auStackY_5b8);
  return;
}



void FUN_18001e884(int *param_1,longlong param_2,ULONG_PTR param_3,DWORD64 *param_4)

{
  DWORD *pDVar1;
  longlong local_res8;
  
  local_res8 = param_2;
  pDVar1 = FUN_180021130();
  *(DWORD64 *)(pDVar1 + 0x4a) = param_4[1];
  pDVar1 = FUN_180021130();
  *(undefined8 *)(pDVar1 + 0x4c) = *(undefined8 *)(param_1 + 0xe);
  pDVar1 = FUN_180021130();
  FUN_1800223f0(param_1,&local_res8,param_3,param_4,
                (uint *)((ulonglong)*(uint *)param_4[7] + *(longlong *)(pDVar1 + 0x4a)),0,0,0);
  return;
}



void FUN_18001e920(void)

{
  undefined1 *in_RAX;
  undefined1 *puVar1;
  undefined1 *puVar2;
  undefined1 local_res8 [32];
  
  puVar1 = local_res8 + -(longlong)in_RAX;
  if (local_res8 < in_RAX) {
    puVar1 = (undefined1 *)0x0;
  }
  if (puVar1 < StackLimit) {
    puVar2 = (undefined1 *)StackLimit;
    do {
      puVar2 = puVar2 + -0x1000;
      *puVar2 = 0;
    } while ((undefined1 *)((ulonglong)puVar1 & 0xfffffffffffff000) != puVar2);
  }
  return;
}



DWORD FUN_18001e970(char *param_1,longlong param_2,char *param_3)

{
  char cVar1;
  DWORD *pDVar2;
  char *pcVar3;
  longlong lVar4;
  DWORD DVar5;
  
  if ((param_1 != (char *)0x0) && (param_2 != 0)) {
    pcVar3 = param_1;
    if (param_3 == (char *)0x0) {
      *param_1 = '\0';
    }
    else {
      do {
        if (*pcVar3 == '\0') break;
        pcVar3 = pcVar3 + 1;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        lVar4 = (longlong)pcVar3 - (longlong)param_3;
        do {
          cVar1 = *param_3;
          param_3[lVar4] = cVar1;
          param_3 = param_3 + 1;
          if (cVar1 == '\0') break;
          param_2 = param_2 + -1;
        } while (param_2 != 0);
        if (param_2 != 0) {
          return 0;
        }
        *param_1 = '\0';
        pDVar2 = FUN_18001fa28();
        DVar5 = 0x22;
        goto LAB_18001e998;
      }
      *param_1 = '\0';
    }
  }
  pDVar2 = FUN_18001fa28();
  DVar5 = 0x16;
LAB_18001e998:
  *pDVar2 = DVar5;
  FUN_18001ffd8();
  return DVar5;
}



void FUN_18001e9ec(void)

{
  code *pcVar1;
  
  pcVar1 = (code *)DecodePointer(DAT_180049230);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
  }
  FUN_1800228d4(0,1);
  FUN_1800228f0();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined8 FUN_18001ea18(undefined8 param_1,int param_2,longlong param_3)

{
  bool bVar1;
  int iVar2;
  DWORD DVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  longlong lVar5;
  DWORD *pDVar6;
  
  if (param_2 == 1) {
    bVar1 = FUN_18001fa98();
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      uVar4 = FUN_18002129c();
      if ((int)uVar4 != 0) {
        FUN_180023a74();
        DAT_18004b0b0 = GetCommandLineA();
        DAT_180048c10 = FUN_180023370();
        uVar4 = FUN_180022b30();
        if (-1 < (int)uVar4) {
          uVar4 = FUN_180022ed4();
          if (((-1 < (int)uVar4) && (uVar4 = FUN_180023190(), -1 < (int)uVar4)) &&
             (uVar4 = FUN_18001f2dc(), (int)uVar4 == 0)) {
            DAT_180048c08 = DAT_180048c08 + 1;
            goto LAB_18001eb6c;
          }
          FUN_180022e60();
        }
        FUN_18002131c();
      }
      FUN_18001fab8();
    }
LAB_18001ea33:
    uVar4 = 0;
  }
  else {
    if (param_2 == 0) {
      if (DAT_180048c08 < 1) goto LAB_18001ea33;
      DAT_180048c08 = DAT_180048c08 + -1;
      if (DAT_180048c68 == 0) {
        FUN_18001f2cc();
      }
      FUN_18001f15c();
      if (param_3 == 0) {
        FUN_180022e60();
        FUN_18002131c();
        FUN_18001fab8();
        if (DAT_180046340 != -1) {
          FUN_18002131c();
        }
      }
    }
    else if (param_2 == 2) {
      lVar5 = FUN_180023580();
      if (lVar5 == 0) {
        pDVar6 = (DWORD *)FUN_18001f654(1,0x478);
        if (pDVar6 != (DWORD *)0x0) {
          iVar2 = FUN_18002359c();
          if (iVar2 != 0) {
            FUN_1800211d8((longlong)pDVar6,0);
            DVar3 = GetCurrentThreadId();
            *pDVar6 = DVar3;
            pDVar6[2] = 0xffffffff;
            pDVar6[3] = 0xffffffff;
            goto LAB_18001eb6c;
          }
          FUN_18001d45c(pDVar6);
        }
        goto LAB_18001ea33;
      }
    }
    else if (param_2 == 3) {
      FUN_1800210f4((LPVOID)0x0);
    }
LAB_18001eb6c:
    uVar4 = 1;
  }
  return uVar4;
}



void entry(undefined8 param_1,int param_2,longlong param_3,undefined8 param_4)

{
  if (param_2 == 1) {
    FUN_1800232c4();
  }
  FUN_18001ebb8(param_1,param_2,param_3,param_4);
  return;
}



// WARNING: Removing unreachable block (ram,0x00018001ec77)
// WARNING: Removing unreachable block (ram,0x00018001ec09)
// WARNING: Removing unreachable block (ram,0x00018001ecb1)

ulonglong FUN_18001ebb8(undefined8 param_1,int param_2,longlong param_3,undefined8 param_4)

{
  ulonglong uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  
  if ((param_2 == 0) && (DAT_180048c08 == 0)) {
    uVar1 = 0;
  }
  else if ((param_2 - 1U < 2) && (uVar2 = FUN_18001ea18(param_1,param_2,param_3), (int)uVar2 == 0))
  {
    uVar1 = 0;
  }
  else {
    uVar3 = FUN_18001ac10();
    uVar1 = uVar3 & 0xffffffff;
    if ((param_2 == 1) && ((uint)uVar3 == 0)) {
      FUN_18001ac10();
      FUN_18001ea18(param_1,0,param_3);
    }
    if ((param_2 == 0) || (param_2 == 3)) {
      uVar2 = FUN_18001ea18(param_1,param_2,param_3);
      uVar1 = (ulonglong)(-(uint)((int)uVar2 != 0) & (uint)uVar3);
    }
  }
  return uVar1;
}



LPVOID FUN_18001ecd8(LPVOID param_1,ulonglong param_2,ulonglong param_3)

{
  DWORD *pDVar1;
  ulonglong uVar2;
  LPVOID pvVar3;
  ulonglong uVar4;
  
  uVar2 = 0;
  if ((param_2 == 0) || (param_3 <= 0xffffffffffffffe0 / param_2)) {
    uVar4 = param_2 * param_3;
    if (param_1 != (LPVOID)0x0) {
      uVar2 = FUN_18001f618((longlong)param_1);
    }
    pvVar3 = FUN_180023ae4(param_1,uVar4);
    if ((pvVar3 != (LPVOID)0x0) && (uVar2 < uVar4)) {
      FUN_18001dbc0((undefined1 (*) [16])(uVar2 + (longlong)pvVar3),0,uVar4 - uVar2);
    }
  }
  else {
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 0xc;
    pvVar3 = (LPVOID)0x0;
  }
  return pvVar3;
}



LPVOID FUN_18001ed60(ulonglong param_1)

{
  LPVOID pvVar1;
  undefined8 uVar2;
  DWORD *pDVar3;
  SIZE_T dwBytes;
  
  if (param_1 < 0xffffffffffffffe1) {
    dwBytes = 1;
    if (param_1 != 0) {
      dwBytes = param_1;
    }
    do {
      if (DAT_180048c88 == (HANDLE)0x0) {
        FUN_180023bb8();
        FUN_180023c2c(0x1e);
        FUN_18001f144(0xff);
      }
      pvVar1 = HeapAlloc(DAT_180048c88,0,dwBytes);
      if (pvVar1 != (LPVOID)0x0) {
        return pvVar1;
      }
      if (DAT_180049b88 == 0) {
        pDVar3 = FUN_18001fa28();
        *pDVar3 = 0xc;
        break;
      }
      uVar2 = FUN_18001effc(param_1);
    } while ((int)uVar2 != 0);
    pDVar3 = FUN_18001fa28();
    *pDVar3 = 0xc;
  }
  else {
    FUN_18001effc(param_1);
    pDVar3 = FUN_18001fa28();
    *pDVar3 = 0xc;
  }
  return (LPVOID)0x0;
}



LPVOID FUN_18001ee18(ulonglong param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  DWORD *pDVar2;
  DWORD local_res18 [4];
  
  local_res18[0] = 0;
  pvVar1 = FUN_180023e9c(param_1,param_2,local_res18);
  if ((pvVar1 == (LPVOID)0x0) && (local_res18[0] != 0)) {
    pDVar2 = FUN_18001fa28();
    if (pDVar2 != (DWORD *)0x0) {
      pDVar2 = FUN_18001fa28();
      *pDVar2 = local_res18[0];
    }
  }
  return pvVar1;
}



undefined8 * FUN_18001ee5c(undefined8 *param_1,undefined8 *param_2)

{
  param_1[1] = 0;
  *(undefined1 *)(param_1 + 2) = 0;
  *param_1 = std::exception::vftable;
  FUN_18001ef64((longlong)param_1,(ulonglong *)*param_2);
  return param_1;
}



undefined8 * FUN_18001ee8c(undefined8 *param_1,undefined8 *param_2)

{
  undefined8 uVar1;
  
  *param_1 = std::exception::vftable;
  uVar1 = *param_2;
  *(undefined1 *)(param_1 + 2) = 0;
  param_1[1] = uVar1;
  return param_1;
}



undefined8 * FUN_18001eea8(undefined8 *param_1,longlong param_2)

{
  param_1[1] = 0;
  *param_1 = std::exception::vftable;
  *(undefined1 *)(param_1 + 2) = 0;
  FUN_18001eee4((longlong)param_1,param_2);
  return param_1;
}



void FUN_18001eed4(undefined8 *param_1)

{
  *param_1 = std::exception::vftable;
  FUN_18001efc0((longlong)param_1);
  return;
}



longlong FUN_18001eee4(longlong param_1,longlong param_2)

{
  if (param_1 != param_2) {
    FUN_18001efc0(param_1);
    if (*(char *)(param_2 + 0x10) == '\0') {
      *(undefined8 *)(param_1 + 8) = *(undefined8 *)(param_2 + 8);
    }
    else {
      FUN_18001ef64(param_1,*(ulonglong **)(param_2 + 8));
    }
  }
  return param_1;
}



undefined8 * FUN_18001ef28(undefined8 *param_1,uint param_2)

{
  *param_1 = std::exception::vftable;
  FUN_18001efc0((longlong)param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001d45c(param_1);
  }
  return param_1;
}



void FUN_18001ef64(longlong param_1,ulonglong *param_2)

{
  char *pcVar1;
  undefined1 *puVar2;
  
  if (param_2 != (ulonglong *)0x0) {
    pcVar1 = FUN_180023f50(param_2);
    puVar2 = (undefined1 *)FUN_18001ed60((ulonglong)(pcVar1 + 1));
    *(undefined1 **)(param_1 + 8) = puVar2;
    if (puVar2 != (undefined1 *)0x0) {
      FUN_18001de48(puVar2,(longlong)(pcVar1 + 1),(char *)param_2);
      *(undefined1 *)(param_1 + 0x10) = 1;
    }
  }
  return;
}



void FUN_18001efc0(longlong param_1)

{
  if (*(char *)(param_1 + 0x10) != '\0') {
    FUN_18001d45c(*(LPVOID *)(param_1 + 8));
  }
  *(undefined8 *)(param_1 + 8) = 0;
  *(undefined1 *)(param_1 + 0x10) = 0;
  return;
}



char * FUN_18001efe8(longlong param_1)

{
  char *pcVar1;
  
  pcVar1 = "Unknown exception";
  if (*(longlong *)(param_1 + 8) != 0) {
    pcVar1 = *(char **)(param_1 + 8);
  }
  return pcVar1;
}



undefined8 FUN_18001effc(undefined8 param_1)

{
  int iVar1;
  code *pcVar2;
  
  pcVar2 = (code *)DecodePointer(DAT_180048c20);
  if ((pcVar2 != (code *)0x0) && (iVar1 = (*pcVar2)(param_1), iVar1 != 0)) {
    return 1;
  }
  return 0;
}



void FUN_18001f030(undefined8 param_1)

{
  DAT_180048c20 = param_1;
  return;
}



void FUN_18001f038(longlong *param_1,byte *param_2)

{
  PVOID local_res8;
  undefined4 local_28;
  undefined4 uStack_24;
  longlong *plStack_20;
  byte *local_18;
  PVOID pvStack_10;
  
  local_28 = 0x19930520;
  uStack_24 = 0;
  plStack_20 = (longlong *)0x0;
  local_18 = (byte *)0x0;
  pvStack_10 = (PVOID)0x0;
  if ((param_2 != (byte *)0x0) && ((*param_2 & 0x10) != 0)) {
    param_2 = *(byte **)(*(longlong *)(*param_1 + -8) + 0x30);
    (**(code **)(*(longlong *)(*param_1 + -8) + 0x40))();
  }
  plStack_20 = param_1;
  local_18 = param_2;
  local_res8 = RtlPcToFileHeader(param_2,&local_res8);
  if (param_2 != (byte *)0x0) {
    if ((*param_2 & 8) == 0) {
      if (local_res8 == (PVOID)0x0) {
        local_28 = 0x1994000;
      }
    }
    else {
      local_28 = 0x1994000;
    }
  }
  pvStack_10 = local_res8;
  RaiseException(0xe06d7363,1,4,(ULONG_PTR *)&local_28);
  return;
}



void FUN_18001f100(uint param_1)

{
  BOOL BVar1;
  FARPROC pFVar2;
  HMODULE local_res10 [3];
  
  BVar1 = GetModuleHandleExW(0,L"mscoree.dll",local_res10);
  if (BVar1 != 0) {
    pFVar2 = GetProcAddress(local_res10[0],"CorExitProcess");
    if (pFVar2 != (FARPROC)0x0) {
      (*pFVar2)((ulonglong)param_1);
    }
  }
  return;
}



void FUN_18001f144(uint param_1)

{
  FUN_18001f100(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



void FUN_18001f15c(void)

{
  int iVar1;
  PVOID pvVar2;
  undefined8 *puVar3;
  
  pvVar2 = DecodePointer(DAT_18004b0a0);
  for (puVar3 = DAT_180048c48; (puVar3 != (undefined8 *)0x0 && ((LPVOID)*puVar3 != (LPVOID)0x0));
      puVar3 = puVar3 + 1) {
    FUN_18001d45c((LPVOID)*puVar3);
  }
  FUN_18001d45c(DAT_180048c48);
  DAT_180048c48 = (undefined8 *)0x0;
  for (puVar3 = DAT_180048c40; (puVar3 != (undefined8 *)0x0 && ((LPVOID)*puVar3 != (LPVOID)0x0));
      puVar3 = puVar3 + 1) {
    FUN_18001d45c((LPVOID)*puVar3);
  }
  FUN_18001d45c(DAT_180048c40);
  DAT_180048c40 = (undefined8 *)0x0;
  FUN_18001d45c(DAT_180048c38);
  FUN_18001d45c(DAT_180048c30);
  DAT_180048c38 = (LPVOID)0x0;
  DAT_180048c30 = (LPVOID)0x0;
  if ((pvVar2 != (PVOID)0xffffffffffffffff) && (DAT_18004b0a0 != (PVOID)0x0)) {
    FUN_18001d45c(pvVar2);
  }
  DAT_18004b0a0 = EncodePointer((PVOID)0xffffffffffffffff);
  if (DAT_180049e18 != (LPVOID)0x0) {
    FUN_18001d45c(DAT_180049e18);
    DAT_180049e18 = (LPVOID)0x0;
  }
  if (DAT_180049e20 != (LPVOID)0x0) {
    FUN_18001d45c(DAT_180049e20);
    DAT_180049e20 = (LPVOID)0x0;
  }
  LOCK();
  iVar1 = *(int *)PTR_DAT_180046b70;
  *(int *)PTR_DAT_180046b70 = *(int *)PTR_DAT_180046b70 + -1;
  UNLOCK();
  if ((iVar1 == 1) && ((undefined4 *)PTR_DAT_180046b70 != &DAT_180046850)) {
    FUN_18001d45c(PTR_DAT_180046b70);
    PTR_DAT_180046b70 = (undefined *)&DAT_180046850;
  }
  return;
}



void FUN_18001f2a4(int param_1)

{
  code *pcVar1;
  
  FUN_180023bb8();
  FUN_180023c2c(param_1);
  FUN_18001f480(0xff,1,0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_18001f2cc(void)

{
  FUN_18001f480(0,0,1);
  return;
}



undefined8 FUN_18001f2dc(void)

{
  ulonglong uVar1;
  undefined8 uVar2;
  
  uVar1 = FUN_180024250(0x180034e78);
  if ((int)uVar1 != 0) {
    thunk_FUN_180027e64();
  }
  FUN_1800242d0();
  uVar2 = FUN_18001f42c((undefined8 *)&DAT_18002c480,(undefined8 *)&DAT_18002c4a8);
  if ((int)uVar2 == 0) {
    FUN_18001d3b8(FUN_180023aac);
    FUN_18001f3cc((undefined8 *)&DAT_18002c468,(undefined8 *)&DAT_18002c478);
    if ((DAT_18004b090 != (code *)0x0) && (uVar1 = FUN_180024250(0x18004b090), (int)uVar1 != 0)) {
      (*DAT_18004b090)(0,2);
    }
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_18001f374(UINT param_1)

{
  FUN_18001f480(param_1,1,0);
  return;
}



void FUN_18001f380(void)

{
  PVOID pvVar1;
  
  pvVar1 = EncodePointer((PVOID)0x0);
  FUN_18001f030(pvVar1);
  FUN_18001ff68(pvVar1);
  FUN_180022948(pvVar1);
  FUN_18002431c(pvVar1);
  FUN_1800228b4();
  FUN_180024570(pvVar1);
  FUN_180023630();
  return;
}



void FUN_18001f3cc(undefined8 *param_1,undefined8 *param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar2 = 0;
  uVar1 = (ulonglong)((longlong)param_2 + (7 - (longlong)param_1)) >> 3;
  if (param_2 < param_1) {
    uVar1 = uVar2;
  }
  if (uVar1 != 0) {
    do {
      if ((code *)*param_1 != (code *)0x0) {
        (*(code *)*param_1)();
      }
      uVar2 = uVar2 + 1;
      param_1 = param_1 + 1;
    } while (uVar2 < uVar1);
  }
  return;
}



void FUN_18001f42c(undefined8 *param_1,undefined8 *param_2)

{
  int iVar1;
  
  iVar1 = 0;
  if (param_1 < param_2) {
    do {
      if (iVar1 != 0) {
        return;
      }
      if ((code *)*param_1 != (code *)0x0) {
        iVar1 = (*(code *)*param_1)();
      }
      param_1 = param_1 + 1;
    } while (param_1 < param_2);
  }
  return;
}



void FUN_18001f468(void)

{
  FUN_180023ff8(8);
  return;
}



void FUN_18001f474(void)

{
  FUN_1800241e8(8);
  return;
}



void FUN_18001f480(UINT param_1,int param_2,int param_3)

{
  longlong *plVar1;
  longlong *plVar2;
  PVOID pvVar3;
  code *pcVar4;
  longlong *plVar5;
  longlong *plVar6;
  longlong *plVar7;
  longlong *plVar8;
  
  FUN_180023ff8(8);
  if (DAT_180048c28 != 1) {
    DAT_180048c68 = 1;
    DAT_180048c64 = (undefined1)param_3;
    if (param_2 == 0) {
      plVar1 = (longlong *)DecodePointer(DAT_18004b0a0);
      if (plVar1 != (longlong *)0x0) {
        plVar2 = (longlong *)DecodePointer(DAT_18004b098);
        plVar7 = plVar1;
        plVar8 = plVar2;
        while (plVar2 = plVar2 + -1, plVar1 <= plVar2) {
          pvVar3 = EncodePointer((PVOID)0x0);
          if ((PVOID)*plVar2 != pvVar3) {
            if (plVar2 < plVar1) break;
            pcVar4 = (code *)DecodePointer((PVOID)*plVar2);
            pvVar3 = EncodePointer((PVOID)0x0);
            *plVar2 = (longlong)pvVar3;
            (*pcVar4)();
            plVar5 = (longlong *)DecodePointer(DAT_18004b0a0);
            plVar6 = (longlong *)DecodePointer(DAT_18004b098);
            if ((plVar7 != plVar5) || (plVar8 != plVar6)) {
              plVar1 = plVar5;
              plVar2 = plVar6;
              plVar7 = plVar5;
              plVar8 = plVar6;
            }
          }
        }
      }
      FUN_18001f3cc((undefined8 *)&DAT_18002c4b0,(undefined8 *)&DAT_18002c4d0);
    }
    FUN_18001f3cc((undefined8 *)&DAT_18002c4d8,(undefined8 *)&DAT_18002c4e0);
  }
  if ((param_3 != 0) && (FUN_1800241e8(8), param_3 != 0)) {
    return;
  }
  DAT_180048c28 = 1;
  FUN_1800241e8(8);
  FUN_18001f100(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



undefined8 FUN_18001f618(longlong param_1)

{
  DWORD *pDVar1;
  undefined8 uVar2;
  
  if (param_1 == 0) {
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 0x16;
    FUN_18001ffd8();
    return 0xffffffffffffffff;
  }
                    // WARNING: Could not recover jumptable at 0x00018001f64a. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar2 = HeapSize(DAT_180048c88,0,param_1);
  return uVar2;
}



LPVOID FUN_18001f654(ulonglong param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    pvVar1 = FUN_180023e9c(param_1,param_2,(undefined4 *)0x0);
    if (pvVar1 != (LPVOID)0x0) {
      return pvVar1;
    }
    if (DAT_180048c80 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_180048c80 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (LPVOID)0x0;
    }
  }
  return (LPVOID)0x0;
}



LPVOID FUN_18001f6d4(ulonglong param_1)

{
  uint uVar1;
  LPVOID pvVar2;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    uVar1 = DAT_180048c80;
    pvVar2 = FUN_18001ed60(param_1);
    if (pvVar2 != (LPVOID)0x0) {
      return pvVar2;
    }
    if (uVar1 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_180048c80 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (LPVOID)0x0;
    }
  }
  return (LPVOID)0x0;
}



LPVOID FUN_18001f750(LPVOID param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  do {
    pvVar1 = FUN_180023ae4(param_1,param_2);
    if (pvVar1 != (LPVOID)0x0) {
      return pvVar1;
    }
    if (param_2 == 0) {
      return (LPVOID)0x0;
    }
    if (DAT_180048c80 == 0) {
      return (LPVOID)0x0;
    }
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_180048c80 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
  } while (dwMilliseconds != 0xffffffff);
  return (LPVOID)0x0;
}



undefined8
FUN_18001f7d4(PEXCEPTION_RECORD param_1,PVOID param_2,undefined8 param_3,longlong *param_4)

{
  uint uVar1;
  longlong lVar2;
  uint *puVar3;
  int iVar4;
  ulonglong uVar5;
  uint uVar6;
  ulonglong uVar7;
  uint uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  PEXCEPTION_RECORD local_38;
  undefined8 local_30;
  
  lVar2 = param_4[1];
  puVar3 = (uint *)param_4[7];
  uVar10 = *param_4 - lVar2;
  if ((param_1->ExceptionFlags & 0x66) == 0) {
    local_38 = param_1;
    local_30 = param_3;
    for (uVar6 = *(uint *)(param_4 + 9); uVar6 < *puVar3; uVar6 = uVar6 + 1) {
      uVar7 = (ulonglong)uVar6;
      if (((puVar3[uVar7 * 4 + 1] <= uVar10) && (uVar10 < puVar3[uVar7 * 4 + 2])) &&
         (puVar3[uVar7 * 4 + 4] != 0)) {
        if (puVar3[uVar7 * 4 + 3] != 1) {
          iVar4 = (*(code *)((ulonglong)puVar3[uVar7 * 4 + 3] + lVar2))(&local_38,param_2);
          if (iVar4 < 0) {
            return 0;
          }
          if (iVar4 < 1) goto LAB_18001f8e1;
        }
        if ((param_1->ExceptionCode == 0xe06d7363) &&
           (uVar5 = FUN_180024250(0x18002f530), (int)uVar5 != 0)) {
          FUN_180021340((int *)param_1);
        }
        FUN_180024e90();
        RtlUnwindEx(param_2,(PVOID)((ulonglong)puVar3[uVar7 * 4 + 4] + lVar2),param_1,
                    (PVOID)(ulonglong)param_1->ExceptionCode,(PCONTEXT)param_4[5],
                    (PUNWIND_HISTORY_TABLE)param_4[8]);
        FUN_180024ec0();
      }
LAB_18001f8e1:
    }
  }
  else {
    uVar7 = param_4[4] - lVar2;
    for (uVar6 = *(uint *)(param_4 + 9); uVar1 = *puVar3, uVar6 < uVar1; uVar6 = uVar6 + 1) {
      uVar5 = (ulonglong)uVar6;
      if ((puVar3[uVar5 * 4 + 1] <= uVar10) && (uVar10 < puVar3[uVar5 * 4 + 2])) {
        if ((param_1->ExceptionFlags & 0x20) != 0) {
          uVar9 = 0;
          if (uVar1 != 0) {
            do {
              if ((((puVar3[uVar9 * 4 + 1] <= uVar7) && (uVar7 < puVar3[uVar9 * 4 + 2])) &&
                  (puVar3[uVar9 * 4 + 4] == puVar3[uVar5 * 4 + 4])) &&
                 (puVar3[uVar9 * 4 + 3] == puVar3[uVar5 * 4 + 3])) break;
              uVar8 = (int)uVar9 + 1;
              uVar9 = (ulonglong)uVar8;
            } while (uVar8 < uVar1);
          }
          if ((uint)uVar9 != uVar1) {
            return 1;
          }
        }
        if (puVar3[uVar5 * 4 + 4] == 0) {
          *(uint *)(param_4 + 9) = uVar6 + 1;
          (*(code *)((ulonglong)puVar3[uVar5 * 4 + 3] + lVar2))
                    (CONCAT71((int7)(uVar5 * 2 >> 8),1),param_2);
        }
        else if (uVar7 == puVar3[uVar5 * 4 + 4]) {
          return 1;
        }
      }
    }
  }
  return 1;
}



DWORD * FUN_18001f9b8(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180021154();
  if (pDVar1 == (DWORD *)0x0) {
    pDVar1 = &DAT_18004631c;
  }
  else {
    pDVar1 = pDVar1 + 5;
  }
  return pDVar1;
}



void FUN_18001f9d8(DWORD param_1)

{
  DWORD DVar1;
  DWORD *pDVar2;
  DWORD *pDVar3;
  
  pDVar2 = FUN_180021154();
  if (pDVar2 == (DWORD *)0x0) {
    pDVar2 = &DAT_18004631c;
  }
  else {
    pDVar2 = pDVar2 + 5;
  }
  *pDVar2 = param_1;
  pDVar3 = FUN_180021154();
  pDVar2 = (DWORD *)&DAT_180046318;
  if (pDVar3 != (DWORD *)0x0) {
    pDVar2 = pDVar3 + 4;
  }
  DVar1 = FUN_18001fa48(param_1);
  *pDVar2 = DVar1;
  return;
}



DWORD * FUN_18001fa28(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180021154();
  if (pDVar1 == (DWORD *)0x0) {
    pDVar1 = (DWORD *)&DAT_180046318;
  }
  else {
    pDVar1 = pDVar1 + 4;
  }
  return pDVar1;
}



undefined4 FUN_18001fa48(int param_1)

{
  undefined4 uVar1;
  uint uVar2;
  int *piVar3;
  
  uVar2 = 0;
  piVar3 = &DAT_1800461b0;
  do {
    if (param_1 == *piVar3) {
      return *(undefined4 *)(&DAT_1800461b4 + (longlong)(int)uVar2 * 8);
    }
    uVar2 = uVar2 + 1;
    piVar3 = piVar3 + 2;
  } while (uVar2 < 0x2d);
  if (param_1 - 0x13U < 0x12) {
    return 0xd;
  }
  uVar1 = 0x16;
  if (param_1 - 0xbcU < 0xf) {
    uVar1 = 8;
  }
  return uVar1;
}



bool FUN_18001fa98(void)

{
  DAT_180048c88 = GetProcessHeap();
  return DAT_180048c88 != (HANDLE)0x0;
}



void FUN_18001fab8(void)

{
  DAT_180048c88 = 0;
  return;
}



void FUN_18001fac4(undefined8 param_1)

{
  DAT_180049200 = IsDebuggerPresent();
  FUN_180024ec4();
  FUN_180023a54(param_1);
  if (DAT_180049200 == 0) {
    FUN_180024ec4();
  }
  FUN_180023a34(0xc0000409);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18001fb10(void)

{
  code *pcVar1;
  BOOL BVar2;
  undefined1 *puVar3;
  undefined1 auStack_38 [8];
  undefined1 auStack_30 [48];
  
  puVar3 = auStack_38;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(2);
    puVar3 = auStack_30;
  }
  *(undefined8 *)(puVar3 + -8) = 0x18001fb3a;
  FUN_1800234d4((PCONTEXT)&DAT_180048d30);
  _DAT_180048ca0 = *(undefined8 *)(puVar3 + 0x38);
  _DAT_180048dc8 = puVar3 + 0x40;
  _DAT_180048db0 = *(undefined8 *)(puVar3 + 0x40);
  _DAT_180048c90 = 0xc0000409;
  _DAT_180048c94 = 1;
  _DAT_180048ca8 = 1;
  DAT_180048cb0 = 2;
  *(undefined8 *)(puVar3 + 0x20) = DAT_1800461a0;
  *(undefined8 *)(puVar3 + 0x28) = DAT_1800461a8;
  *(undefined8 *)(puVar3 + -8) = 0x18001fbdc;
  DAT_180048e28 = _DAT_180048ca0;
  FUN_18001fac4(&PTR_DAT_18002f448);
  return;
}



// WARNING: Removing unreachable block (ram,0x00018001fcfa)
// WARNING: Removing unreachable block (ram,0x00018001fc64)
// WARNING: Removing unreachable block (ram,0x00018001fbfe)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18001fbe4(void)

{
  int *piVar1;
  uint *puVar2;
  longlong lVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar6 = 0;
  piVar1 = (int *)cpuid_basic_info(0);
  _DAT_180046324 = 2;
  DAT_180046320 = 1;
  puVar2 = (uint *)cpuid_Version_info(1);
  uVar4 = puVar2[3];
  if (((piVar1[2] == 0x49656e69 && piVar1[3] == 0x6c65746e) && piVar1[1] == 0x756e6547) &&
     ((((uVar5 = *puVar2 & 0xfff3ff0, uVar5 == 0x106c0 || (uVar5 == 0x20660)) || (uVar5 == 0x20670))
      || ((uVar5 - 0x30650 < 0x21 &&
          ((0x100010001U >> ((ulonglong)(uVar5 - 0x30650) & 0x3f) & 1) != 0)))))) {
    DAT_180049204 = DAT_180049204 | 1;
  }
  if (((piVar1[1] == 0x68747541 && piVar1[2] == 0x69746e65) && piVar1[3] == 0x444d4163) &&
     (0x600eff < (*puVar2 & 0xff00f00))) {
    DAT_180049204 = DAT_180049204 | 4;
  }
  if (6 < *piVar1) {
    lVar3 = cpuid_Extended_Feature_Enumeration_info(7);
    uVar6 = *(uint *)(lVar3 + 4);
    if ((uVar6 >> 9 & 1) != 0) {
      DAT_180049204 = DAT_180049204 | 2;
    }
  }
  if ((uVar4 >> 0x14 & 1) != 0) {
    DAT_180046320 = 2;
    _DAT_180046324 = 6;
    if (((uVar4 >> 0x1b & 1) != 0) && ((uVar4 >> 0x1c & 1) != 0)) {
      DAT_180046320 = 3;
      _DAT_180046324 = 0xe;
      if ((uVar6 & 0x20) != 0) {
        DAT_180046320 = 5;
        _DAT_180046324 = 0x2e;
      }
    }
  }
  return 0;
}



ulonglong FUN_18001fda0(ulonglong *param_1,longlong param_2)

{
  byte bVar1;
  ulonglong uVar2;
  longlong lVar3;
  
  lVar3 = param_2 - (longlong)param_1;
  uVar2 = (ulonglong)param_1 & 7;
  while( true ) {
    if (uVar2 == 0) {
      while ((((int)param_1 + (int)lVar3 & 0xfffU) < 0xff9 &&
             (uVar2 = *param_1, uVar2 == *(ulonglong *)((longlong)param_1 + lVar3)))) {
        param_1 = param_1 + 1;
        if ((~uVar2 & uVar2 + 0xfefefefefefefeff & 0x8080808080808080) != 0) {
          return 0;
        }
      }
    }
    bVar1 = (byte)*param_1;
    if (bVar1 != *(byte *)((longlong)param_1 + lVar3)) break;
    param_1 = (ulonglong *)((longlong)param_1 + 1);
    if (bVar1 == 0) {
      return 0;
    }
    uVar2 = (ulonglong)param_1 & 7;
  }
  return -(ulonglong)(bVar1 < *(byte *)((longlong)param_1 + lVar3)) | 1;
}



void FUN_18001fe08(longlong param_1)

{
  longlong *plVar1;
  longlong *plVar2;
  longlong *plVar3;
  
  FUN_180023ff8(0xe);
  plVar1 = DAT_180049210;
  if (*(longlong *)(param_1 + 8) != 0) {
    plVar2 = (longlong *)&DAT_180049208;
    do {
      plVar3 = plVar2;
      if (DAT_180049210 == (longlong *)0x0) goto LAB_18001fe56;
      plVar2 = DAT_180049210;
    } while (*DAT_180049210 != *(longlong *)(param_1 + 8));
    plVar3[1] = DAT_180049210[1];
    FUN_18001d45c(plVar1);
LAB_18001fe56:
    FUN_18001d45c(*(LPVOID *)(param_1 + 8));
    *(undefined8 *)(param_1 + 8) = 0;
  }
  FUN_1800241e8(0xe);
  return;
}



void FUN_18001fe74(int param_1,undefined4 param_2,undefined4 param_3)

{
  BOOL BVar1;
  int iVar2;
  undefined1 auStackX_8 [8];
  undefined1 auStack_5b8 [32];
  undefined4 *local_598;
  _CONTEXT *local_590;
  undefined4 local_588;
  undefined1 local_584 [156];
  _CONTEXT local_4e8;
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStack_5b8;
  if (param_1 != -1) {
    FUN_180024ec4();
  }
  local_588 = 0;
  FUN_18001dbc0((undefined1 (*) [16])local_584,0,0x94);
  local_598 = &local_588;
  local_590 = &local_4e8;
  FUN_180023464(&local_4e8);
  local_4e8.Rsp = (DWORD64)auStackX_8;
  local_588 = param_2;
  local_584._0_4_ = param_3;
  BVar1 = IsDebuggerPresent();
  iVar2 = FUN_180023a54(&local_598);
  if (((iVar2 == 0) && (BVar1 == 0)) && (param_1 != -1)) {
    FUN_180024ec4();
  }
  FUN_18001d530(local_18 ^ (ulonglong)auStack_5b8);
  return;
}



void FUN_18001ff68(undefined8 param_1)

{
  DAT_180049218 = param_1;
  return;
}



void FUN_18001ff70(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)DecodePointer(DAT_180049218);
  if (UNRECOVERED_JUMPTABLE != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018001ffc2. Too many branches
                    // WARNING: Treating indirect jump as call
    (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
    return;
  }
  FUN_18001fff8();
  UNRECOVERED_JUMPTABLE = (code *)swi(3);
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void FUN_18001ffd8(void)

{
  FUN_18001ff70(0,0,0,0);
  return;
}



void FUN_18001fff8(void)

{
  code *pcVar1;
  BOOL BVar2;
  undefined1 *puVar3;
  undefined1 auStack_28 [8];
  undefined1 auStack_20 [32];
  
  puVar3 = auStack_28;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(5);
    puVar3 = auStack_20;
  }
  *(undefined8 *)(puVar3 + -8) = 0x180020025;
  FUN_18001fe74(2,0xc0000417,1);
  FUN_180023a34(0xc0000417);
  return;
}



ulonglong FUN_180020034(undefined4 param_1,undefined **param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  DWORD *pDVar4;
  undefined **ppuVar5;
  undefined7 extraout_var;
  longlong lVar6;
  undefined *puVar7;
  uint uVar8;
  undefined4 local_res8 [2];
  
  local_res8[0] = param_1;
  uVar2 = FUN_1800250a8((longlong)param_2);
  uVar8 = *(uint *)(param_2 + 3);
  if ((uVar8 & 0x82) == 0) {
    pDVar4 = FUN_18001fa28();
    *pDVar4 = 9;
  }
  else if ((uVar8 & 0x40) == 0) {
    uVar3 = 0;
    if ((uVar8 & 1) != 0) {
      *(undefined4 *)(param_2 + 1) = 0;
      if ((uVar8 & 0x10) == 0) {
        *(uint *)(param_2 + 3) = uVar8 | 0x20;
        return 0xffffffff;
      }
      *param_2 = param_2[2];
      *(uint *)(param_2 + 3) = uVar8 & 0xfffffffe;
    }
    uVar8 = *(uint *)(param_2 + 3);
    *(undefined4 *)(param_2 + 1) = 0;
    *(uint *)(param_2 + 3) = uVar8 & 0xffffffef | 2;
    if (((uVar8 & 0x10c) == 0) &&
       (((ppuVar5 = FUN_180024f94(), param_2 != ppuVar5 + 6 &&
         (ppuVar5 = FUN_180024f94(), param_2 != ppuVar5 + 0xc)) ||
        (bVar1 = FUN_1800250d0(uVar2), (int)CONCAT71(extraout_var,bVar1) == 0)))) {
      FUN_180025b84(param_2);
    }
    if (((ulonglong)param_2[3] & 0x108) == 0) {
      uVar8 = 1;
      uVar3 = FUN_180025130(uVar2,(WCHAR *)local_res8,1);
    }
    else {
      uVar8 = *(int *)param_2 - *(int *)(param_2 + 2);
      *param_2 = (undefined *)((longlong)param_2[2] + 1);
      *(int *)(param_2 + 1) = *(int *)((longlong)param_2 + 0x24) + -1;
      if ((int)uVar8 < 1) {
        if (uVar2 + 2 < 2) {
          puVar7 = &DAT_180046350;
        }
        else {
          puVar7 = (undefined *)
                   ((ulonglong)(uVar2 & 0x1f) * 0x58 + (&DAT_180049240)[(longlong)(int)uVar2 >> 5]);
        }
        if (((puVar7[8] & 0x20) != 0) &&
           (lVar6 = FUN_180025a08(uVar2,(LARGE_INTEGER)0x0,2), lVar6 == -1)) goto LAB_18002006c;
      }
      else {
        uVar3 = FUN_180025130(uVar2,(WCHAR *)param_2[2],uVar8);
      }
      *param_2[2] = (byte)local_res8[0];
    }
    if (uVar3 == uVar8) {
      return (ulonglong)(byte)local_res8[0];
    }
  }
  else {
    pDVar4 = FUN_18001fa28();
    *pDVar4 = 0x22;
  }
LAB_18002006c:
  *(uint *)(param_2 + 3) = *(uint *)(param_2 + 3) | 0x20;
  return 0xffffffff;
}



longlong * FUN_1800201c0(longlong *param_1,longlong *param_2)

{
  uint uVar1;
  undefined *puVar2;
  longlong lVar3;
  DWORD *pDVar4;
  int *piVar5;
  
  *(undefined1 *)(param_1 + 3) = 0;
  if (param_2 == (longlong *)0x0) {
    pDVar4 = FUN_180021130();
    param_1[2] = (longlong)pDVar4;
    puVar2 = *(undefined **)(pDVar4 + 0x30);
    *param_1 = (longlong)puVar2;
    param_1[1] = *(longlong *)(pDVar4 + 0x2e);
    if ((puVar2 != PTR_DAT_180047210) && ((DAT_180047378 & pDVar4[0x32]) == 0)) {
      piVar5 = FUN_180025ea0();
      *param_1 = (longlong)piVar5;
    }
    if (((undefined *)param_1[1] != PTR_DAT_180046b70) &&
       ((DAT_180047378 & *(uint *)(param_1[2] + 200)) == 0)) {
      piVar5 = FUN_180024894();
      param_1[1] = (longlong)piVar5;
    }
    uVar1 = *(uint *)(param_1[2] + 200);
    if ((uVar1 & 2) == 0) {
      *(uint *)(param_1[2] + 200) = uVar1 | 2;
      *(undefined1 *)(param_1 + 3) = 1;
    }
  }
  else {
    lVar3 = param_2[1];
    *param_1 = *param_2;
    param_1[1] = lVar3;
  }
  return param_1;
}



// WARNING: Removing unreachable block (ram,0x00018002067e)
// WARNING: Removing unreachable block (ram,0x000180020662)
// WARNING: Removing unreachable block (ram,0x0001800207b7)
// WARNING: Removing unreachable block (ram,0x0001800207bb)
// WARNING: Removing unreachable block (ram,0x0001800207c4)

void FUN_180020268(undefined **param_1,byte *param_2,longlong *param_3,WCHAR *param_4)

{
  byte bVar1;
  short *psVar2;
  uint *puVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  bool bVar8;
  bool bVar9;
  bool bVar10;
  bool bVar11;
  char cVar12;
  ushort uVar13;
  uint uVar14;
  int iVar15;
  undefined7 extraout_var;
  code *pcVar16;
  char *pcVar17;
  undefined6 extraout_var_00;
  DWORD *pDVar18;
  uint uVar19;
  int iVar20;
  WCHAR *pWVar21;
  uint uVar22;
  WCHAR *pWVar23;
  int iVar24;
  byte *pbVar25;
  undefined *puVar26;
  ulonglong uVar27;
  undefined *puVar28;
  uint uVar29;
  uint uVar30;
  byte bVar31;
  undefined **ppuVar32;
  undefined1 auStackY_318 [32];
  uint local_2d8;
  int local_2d4;
  uint local_2d0;
  byte local_2cc [4];
  int local_2c8;
  int local_2c4;
  int local_2c0;
  uint local_2bc;
  undefined4 local_2b8;
  undefined **local_2b0;
  undefined4 local_2a8;
  WCHAR *local_2a0;
  DWORD *local_298;
  WCHAR *local_290;
  int local_288 [2];
  byte *local_280;
  undefined8 local_278;
  longlong local_270 [2];
  longlong local_260;
  char local_258;
  WCHAR local_248 [255];
  char local_49 [9];
  ulonglong local_40;
  
  local_40 = DAT_1800461a0 ^ (ulonglong)auStackY_318;
  local_2a8 = 0;
  uVar30 = 0;
  bVar10 = false;
  bVar9 = false;
  bVar8 = false;
  bVar7 = false;
  bVar6 = false;
  bVar4 = false;
  bVar5 = false;
  local_2c4 = 0;
  uVar29 = 0;
  local_2d0 = 0;
  local_2b8 = 0;
  local_2c0 = 0;
  pWVar23 = (WCHAR *)0x0;
  local_2c8 = 0;
  local_2b0 = param_1;
  FUN_1800201c0(local_270,param_3);
  local_298 = FUN_18001fa28();
  if (param_1 != (undefined **)0x0) {
    if (((ulonglong)param_1[3] & 0x40) == 0) {
      uVar14 = FUN_1800250a8((longlong)param_1);
      puVar26 = &DAT_180046350;
      if (uVar14 + 2 < 2) {
        puVar28 = &DAT_180046350;
      }
      else {
        puVar28 = (undefined *)
                  ((ulonglong)(uVar14 & 0x1f) * 0x58 + (&DAT_180049240)[(longlong)(int)uVar14 >> 5])
        ;
      }
      if ((puVar28[0x38] & 0x7f) == 0) {
        if (1 < uVar14 + 2) {
          puVar26 = (undefined *)
                    ((ulonglong)(uVar14 & 0x1f) * 0x58 +
                    (&DAT_180049240)[(longlong)(int)uVar14 >> 5]);
        }
        if ((puVar26[0x38] & 0x80) == 0) goto LAB_180020384;
      }
    }
    else {
LAB_180020384:
      uVar14 = 0;
      if (param_2 != (byte *)0x0) {
        bVar31 = *param_2;
        local_2d8 = 0;
        local_2d4 = 0;
        local_290 = (WCHAR *)0x0;
        uVar22 = uVar14;
        if (bVar31 == 0) goto LAB_180020c52;
        do {
          pbVar25 = param_2 + 1;
          local_280 = pbVar25;
          if ((int)uVar14 < 0) break;
          uVar19 = 0;
          if ((byte)(bVar31 - 0x20) < 0x59) {
            uVar19 = (byte)(&DAT_18002f4b0)[(char)bVar31] & 0xf;
          }
          local_2bc = (uint)((byte)(&DAT_18002f4d0)
                                   [(longlong)(int)uVar19 * 9 + (longlong)(int)uVar22] >> 4);
          if (local_2bc == 8) goto LAB_180020c38;
          uVar22 = uVar29;
          if (local_2bc == 0) {
LAB_180020af1:
            local_2c8 = 0;
            uVar13 = FUN_180025f7c((uint)bVar31,local_270);
            if ((int)CONCAT62(extraout_var_00,uVar13) != 0) {
              FUN_180020c90(bVar31,local_2b0,(int *)&local_2d8);
              bVar31 = *pbVar25;
              pbVar25 = param_2 + 2;
              if (bVar31 == 0) goto LAB_180020c38;
            }
            FUN_180020c90(bVar31,local_2b0,(int *)&local_2d8);
            uVar22 = uVar29;
            uVar14 = local_2d8;
          }
          else if (local_2bc == 1) {
            local_2b8 = 0;
            local_2c0 = 0;
            local_2c4 = 0;
            local_2d0 = 0;
            uVar30 = 0;
            bVar10 = false;
            bVar9 = false;
            bVar8 = false;
            bVar7 = false;
            bVar6 = false;
            bVar4 = false;
            bVar5 = false;
            local_2c8 = 0;
            uVar22 = 0xffffffff;
          }
          else if (local_2bc == 2) {
            if (bVar31 == 0x20) {
              bVar10 = true;
            }
            else if (bVar31 == 0x23) {
              bVar9 = true;
            }
            else if (bVar31 == 0x2b) {
              bVar6 = true;
            }
            else if (bVar31 == 0x2d) {
              uVar30 = uVar30 | 4;
            }
            else if (bVar31 == 0x30) {
              uVar30 = uVar30 | 8;
            }
          }
          else if (local_2bc == 3) {
            if (bVar31 == 0x2a) {
              local_2c4 = *(int *)param_4;
              param_4 = param_4 + 4;
              if (local_2c4 < 0) {
                uVar30 = uVar30 | 4;
                local_2c4 = -local_2c4;
              }
            }
            else {
              local_2c4 = (int)(char)bVar31 + local_2c4 * 10 + -0x30;
            }
          }
          else {
            uVar22 = 0;
            if (local_2bc != 4) {
              if (local_2bc == 5) {
                if (bVar31 == 0x2a) {
                  uVar22 = *(uint *)param_4;
                  param_4 = param_4 + 4;
                  if ((int)uVar22 < 0) {
                    uVar22 = 0xffffffff;
                  }
                }
                else {
                  uVar22 = (int)(char)bVar31 + (uVar29 * 5 + -0x18) * 2;
                }
              }
              else if (local_2bc == 6) {
                if (bVar31 == 0x49) {
                  bVar1 = *pbVar25;
                  bVar7 = true;
                  if ((bVar1 == 0x36) && (param_2[2] == 0x34)) {
                    bVar7 = true;
                    pbVar25 = param_2 + 3;
                    uVar22 = uVar29;
                  }
                  else if ((bVar1 == 0x33) && (param_2[2] == 0x32)) {
                    bVar7 = false;
                    pbVar25 = param_2 + 3;
                    uVar22 = uVar29;
                  }
                  else if ((0x20 < (byte)(bVar1 + 0xa8)) ||
                          (uVar22 = uVar29,
                          (0x120821001U >> ((ulonglong)(byte)(bVar1 + 0xa8) & 0x3f) & 1) == 0)) {
                    local_2bc = 0;
                    goto LAB_180020af1;
                  }
                }
                else if (bVar31 == 0x68) {
                  uVar30 = uVar30 | 0x20;
                  uVar22 = uVar29;
                }
                else if (bVar31 == 0x6c) {
                  if (*pbVar25 == 0x6c) {
                    bVar5 = true;
                    pbVar25 = param_2 + 2;
                    uVar22 = uVar29;
                  }
                  else {
                    uVar30 = uVar30 | 0x10;
                    uVar22 = uVar29;
                  }
                }
                else {
                  uVar22 = uVar29;
                  if (bVar31 == 0x77) {
                    uVar30 = uVar30 | 0x800;
                  }
                }
              }
              else {
                uVar22 = uVar29;
                if (local_2bc == 7) {
                  iVar20 = (int)(char)bVar31;
                  if (iVar20 < 0x65) {
                    if (iVar20 == 100) {
LAB_1800206b5:
                      bVar8 = true;
LAB_1800206b9:
                      iVar20 = 10;
LAB_1800206c3:
                      if ((bVar7) || (bVar5)) {
                        uVar27 = *(ulonglong *)param_4;
                      }
                      else if ((uVar30 & 0x20) == 0) {
                        if (bVar8) {
                          uVar27 = (ulonglong)*(int *)param_4;
                        }
                        else {
                          uVar27 = (ulonglong)*(uint *)param_4;
                        }
                      }
                      else if (bVar8) {
                        uVar27 = (ulonglong)*param_4;
                      }
                      else {
                        uVar27 = (ulonglong)(ushort)*param_4;
                      }
                      local_2a0 = param_4 + 4;
                      if ((bVar8) && ((longlong)uVar27 < 0)) {
                        uVar27 = -uVar27;
                        bVar4 = true;
                      }
                      if ((!bVar7) && (!bVar5)) {
                        uVar27 = uVar27 & 0xffffffff;
                      }
                      if ((int)uVar29 < 0) {
                        uVar29 = 1;
                      }
                      else {
                        uVar30 = uVar30 & 0xfffffff7;
                        if (0x200 < (int)uVar29) {
                          uVar29 = 0x200;
                        }
                      }
                      pcVar17 = local_49;
                      local_2d0 = -(uint)(uVar27 != 0) & local_2d0;
                      uVar14 = uVar29;
                      while ((uVar29 = uVar14 - 1, 0 < (int)uVar14 || (uVar27 != 0))) {
                        uVar14 = (int)(uVar27 % (ulonglong)(longlong)iVar20) + 0x30;
                        cVar12 = (char)uVar14;
                        if (0x39 < uVar14) {
                          cVar12 = cVar12 + (char)local_2a8;
                        }
                        *pcVar17 = cVar12;
                        pcVar17 = pcVar17 + -1;
                        uVar27 = uVar27 / (ulonglong)(longlong)iVar20;
                        uVar14 = uVar29;
                      }
                      local_2d4 = (int)local_49 - (int)pcVar17;
                      pWVar23 = (WCHAR *)(pcVar17 + 1);
                      param_4 = local_2a0;
                    }
                    else {
                      if (iVar20 == 0x41) {
LAB_180020592:
                        local_2b8 = 1;
                        bVar31 = bVar31 + 0x20;
                        goto LAB_18002059e;
                      }
                      if (iVar20 != 0x43) {
                        if ((iVar20 - 0x45U & 0xfffffffd) == 0) goto LAB_180020592;
                        if (iVar20 == 0x53) {
                          if ((uVar30 & 0x830) == 0) {
                            uVar30 = uVar30 | 0x800;
                          }
LAB_1800204fa:
                          pWVar21 = *(WCHAR **)param_4;
                          uVar14 = uVar29;
                          if (uVar29 == 0xffffffff) {
                            uVar14 = 0x7fffffff;
                          }
                          param_4 = param_4 + 4;
                          pWVar23 = pWVar21;
                          if ((uVar30 & 0x810) == 0) {
                            if (pWVar21 == (WCHAR *)0x0) {
                              pWVar21 = (WCHAR *)PTR_s__null__180046330;
                              pWVar23 = (WCHAR *)PTR_s__null__180046330;
                            }
                            for (; (uVar14 != 0 && (uVar14 = uVar14 - 1, (char)*pWVar21 != '\0'));
                                pWVar21 = (WCHAR *)((longlong)pWVar21 + 1)) {
                            }
                            local_2d4 = (int)pWVar21 - (int)pWVar23;
                          }
                          else {
                            local_2c8 = 1;
                            if (pWVar21 == (WCHAR *)0x0) {
                              pWVar21 = (WCHAR *)PTR_u__null__180046338;
                              pWVar23 = (WCHAR *)PTR_u__null__180046338;
                            }
                            for (; (uVar14 != 0 && (uVar14 = uVar14 - 1, *pWVar21 != L'\0'));
                                pWVar21 = pWVar21 + 1) {
                            }
                            local_2d4 = (int)((longlong)pWVar21 - (longlong)pWVar23 >> 1);
                          }
                          goto LAB_1800208c0;
                        }
                        if (iVar20 == 0x58) goto LAB_18002064e;
                        if (iVar20 != 0x5a) {
                          if (iVar20 == 0x61) goto LAB_18002059e;
                          if (iVar20 != 99) goto LAB_1800208c0;
                          goto LAB_180020546;
                        }
                        psVar2 = *(short **)param_4;
                        pWVar21 = (WCHAR *)PTR_s__null__180046330;
                        if ((psVar2 == (short *)0x0) ||
                           (pWVar23 = *(WCHAR **)(psVar2 + 4), pWVar23 == (WCHAR *)0x0))
                        goto LAB_1800208b1;
                        local_2d4 = (int)*psVar2;
                        if (uVar30 >> 0xb == 0) {
                          local_2c8 = 0;
                        }
                        else {
                          local_2c8 = 1;
                          local_2d4 = local_2d4 / 2;
                        }
                        goto LAB_1800208bc;
                      }
                      if ((uVar30 & 0x830) == 0) {
                        uVar30 = uVar30 | 0x800;
                      }
LAB_180020546:
                      if ((uVar30 & 0x810) == 0) {
                        local_2d4 = 1;
                        local_248[0]._0_1_ = (char)*param_4;
                      }
                      else {
                        iVar20 = FUN_1800261ac(&local_2d4,(undefined1 (*) [16])local_248,0x200,
                                               *param_4);
                        if (iVar20 != 0) {
                          local_2c0 = 1;
                        }
                      }
                      pWVar23 = local_248;
                      param_4 = param_4 + 4;
                    }
LAB_1800208c0:
                    ppuVar32 = local_2b0;
                    if (local_2c0 == 0) {
                      if (bVar8) {
                        if (bVar4) {
                          local_2cc[0] = 0x2d;
                        }
                        else if (bVar6) {
                          local_2cc[0] = 0x2b;
                        }
                        else {
                          if (!bVar10) goto LAB_180020906;
                          local_2cc[0] = 0x20;
                        }
                        local_2d0 = 1;
                      }
LAB_180020906:
                      uVar14 = local_2d0;
                      iVar20 = (local_2c4 - local_2d4) - local_2d0;
                      if ((uVar30 & 0xc) == 0) {
                        FUN_180020cd8(0x20,iVar20,local_2b0,(int *)&local_2d8);
                      }
                      FUN_180020d2c(local_2cc,uVar14,ppuVar32,(int *)&local_2d8,(int *)local_298);
                      if (((uVar30 & 8) != 0) && ((uVar30 & 4) == 0)) {
                        FUN_180020cd8(0x30,iVar20,ppuVar32,(int *)&local_2d8);
                      }
                      if ((local_2c8 == 0) || (pWVar21 = pWVar23, iVar24 = local_2d4, local_2d4 < 1)
                         ) {
                        FUN_180020d2c((byte *)pWVar23,local_2d4,ppuVar32,(int *)&local_2d8,
                                      (int *)local_298);
                      }
                      else {
                        do {
                          iVar24 = iVar24 + -1;
                          iVar15 = FUN_1800261ac(local_288,(undefined1 (*) [16])(local_49 + 1),6,
                                                 *pWVar21);
                          if ((iVar15 != 0) || (local_288[0] == 0)) {
                            local_2d8 = 0xffffffff;
                            ppuVar32 = local_2b0;
                            break;
                          }
                          FUN_180020d2c((byte *)(local_49 + 1),local_288[0],local_2b0,
                                        (int *)&local_2d8,(int *)local_298);
                          ppuVar32 = local_2b0;
                          pWVar21 = pWVar21 + 1;
                        } while (iVar24 != 0);
                      }
                      if ((-1 < (int)local_2d8) && ((uVar30 & 4) != 0)) {
                        FUN_180020cd8(0x20,iVar20,ppuVar32,(int *)&local_2d8);
                      }
                    }
                  }
                  else {
                    if (iVar20 < 0x68) {
LAB_18002059e:
                      bVar8 = true;
                      iVar20 = 0x200;
                      pWVar21 = local_248;
                      if ((int)uVar29 < 0) {
                        uVar29 = 6;
                        iVar24 = 0x200;
                      }
                      else {
                        iVar24 = iVar20;
                        if (uVar29 == 0) {
                          if (bVar31 == 0x67) {
                            uVar29 = 1;
                          }
                        }
                        else {
                          if (0x200 < (int)uVar29) {
                            uVar29 = 0x200;
                          }
                          if (0xa3 < (int)uVar29) {
                            iVar24 = uVar29 + 0x15d;
                            local_290 = (WCHAR *)FUN_18001f6d4((longlong)iVar24);
                            pWVar21 = local_290;
                            if (local_290 == (WCHAR *)0x0) {
                              uVar29 = 0xa3;
                              pWVar21 = local_248;
                              iVar24 = iVar20;
                            }
                          }
                        }
                      }
                      local_278 = *(undefined8 *)param_4;
                      pcVar16 = (code *)DecodePointer(PTR_LAB_180046620);
                      (*pcVar16)(&local_278,pWVar21,(longlong)iVar24,(int)(char)bVar31);
                      if ((bVar9) && (uVar29 == 0)) {
                        pcVar16 = (code *)DecodePointer(PTR_LAB_180046638);
                        (*pcVar16)(pWVar21,local_270);
                      }
                      if ((bVar31 == 0x67) && (!bVar9)) {
                        pcVar16 = (code *)DecodePointer(PTR_LAB_180046630);
                        (*pcVar16)(pWVar21,local_270);
                      }
                      if ((char)*pWVar21 == '-') {
                        bVar8 = true;
                        bVar4 = true;
                        pWVar21 = (WCHAR *)((longlong)pWVar21 + 1);
                      }
LAB_1800208b1:
                      pcVar17 = FUN_180023f50((ulonglong *)pWVar21);
                      local_2d4 = (int)pcVar17;
                      pWVar23 = pWVar21;
LAB_1800208bc:
                      param_4 = param_4 + 4;
                      goto LAB_1800208c0;
                    }
                    if (iVar20 == 0x69) goto LAB_1800206b5;
                    if (iVar20 != 0x6e) {
                      if (iVar20 == 0x6f) {
                        iVar20 = 8;
                      }
                      else {
                        if (iVar20 == 0x70) {
                          uVar29 = 0x10;
                          bVar7 = true;
LAB_18002064e:
                          local_2a8 = 7;
                        }
                        else {
                          if (iVar20 == 0x73) goto LAB_1800204fa;
                          if (iVar20 == 0x75) goto LAB_1800206b9;
                          if (iVar20 != 0x78) goto LAB_1800208c0;
                          local_2a8 = 0x27;
                        }
                        iVar20 = 0x10;
                      }
                      goto LAB_1800206c3;
                    }
                    puVar3 = *(uint **)param_4;
                    param_4 = param_4 + 4;
                    bVar11 = FUN_180026008();
                    if ((int)CONCAT71(extraout_var,bVar11) == 0) goto LAB_180020c38;
                    if ((uVar30 & 0x20) == 0) {
                      *puVar3 = uVar14;
                    }
                    else {
                      *(short *)puVar3 = (short)uVar14;
                    }
                    local_2c0 = 1;
                  }
                  pbVar25 = local_280;
                  uVar22 = uVar29;
                  uVar14 = local_2d8;
                  if (local_290 != (WCHAR *)0x0) {
                    FUN_18001d45c(local_290);
                    local_290 = (WCHAR *)0x0;
                    pbVar25 = local_280;
                    uVar14 = local_2d8;
                  }
                }
              }
            }
          }
          uVar29 = uVar22;
          bVar31 = *pbVar25;
          param_2 = pbVar25;
          uVar22 = local_2bc;
        } while (bVar31 != 0);
        if ((uVar22 == 0) || (uVar22 == 7)) goto LAB_180020c52;
      }
    }
  }
LAB_180020c38:
  pDVar18 = FUN_18001fa28();
  *pDVar18 = 0x16;
  FUN_18001ffd8();
LAB_180020c52:
  if (local_258 != '\0') {
    *(uint *)(local_260 + 200) = *(uint *)(local_260 + 200) & 0xfffffffd;
  }
  FUN_18001d530(local_40 ^ (ulonglong)auStackY_318);
  return;
}



void FUN_180020c90(byte param_1,undefined **param_2,int *param_3)

{
  undefined **ppuVar1;
  uint uVar2;
  ulonglong uVar3;
  
  if ((((ulonglong)param_2[3] & 0x40) == 0) || (param_2[2] != (undefined *)0x0)) {
    ppuVar1 = param_2 + 1;
    *(int *)ppuVar1 = *(int *)ppuVar1 + -1;
    if (*(int *)ppuVar1 < 0) {
      uVar3 = FUN_180020034((int)(char)param_1,param_2);
      uVar2 = (uint)uVar3;
    }
    else {
      **param_2 = param_1;
      *param_2 = *param_2 + 1;
      uVar2 = (uint)param_1;
    }
    if (uVar2 == 0xffffffff) {
      *param_3 = -1;
    }
    else {
      *param_3 = *param_3 + 1;
    }
  }
  else {
    *param_3 = *param_3 + 1;
  }
  return;
}



void FUN_180020cd8(byte param_1,int param_2,undefined **param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      FUN_180020c90(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



void FUN_180020d2c(byte *param_1,int param_2,undefined **param_3,int *param_4,int *param_5)

{
  int iVar1;
  
  iVar1 = *param_5;
  if ((((ulonglong)param_3[3] & 0x40) == 0) || (param_3[2] != (undefined *)0x0)) {
    *param_5 = 0;
    if (0 < param_2) {
      do {
        param_2 = param_2 + -1;
        FUN_180020c90(*param_1,param_3,param_4);
        param_1 = param_1 + 1;
        if (*param_4 == -1) {
          if (*param_5 != 0x2a) break;
          FUN_180020c90(0x3f,param_3,param_4);
        }
      } while (0 < param_2);
      if (*param_5 != 0) {
        return;
      }
    }
    *param_5 = iVar1;
  }
  else {
    *param_4 = *param_4 + param_2;
  }
  return;
}



ushort FUN_180020dc0(WCHAR param_1,ushort param_2)

{
  ushort uVar1;
  BOOL BVar2;
  WCHAR local_res8 [8];
  ushort local_res18 [8];
  
  if (param_1 == L'\xffff') {
    uVar1 = 0;
  }
  else {
    if ((ushort)param_1 < 0x100) {
      uVar1 = *(ushort *)(PTR_DAT_180047388 + (ulonglong)(ushort)param_1 * 2);
    }
    else {
      local_res8[0] = param_1;
      BVar2 = GetStringTypeW(1,local_res8,1,local_res18);
      uVar1 = 0;
      if (BVar2 != 0) {
        uVar1 = local_res18[0];
      }
    }
    uVar1 = uVar1 & param_2;
  }
  return uVar1;
}



int FUN_180020e28(ushort param_1)

{
  ushort uVar1;
  int iVar2;
  
  iVar2 = 0x30;
  if (param_1 < 0x30) {
    return -1;
  }
  if (param_1 < 0x3a) goto LAB_180020e3c;
  iVar2 = 0xff10;
  if (param_1 < 0xff10) {
    iVar2 = 0x660;
    if (param_1 < 0x660) {
      return -1;
    }
    if (param_1 < 0x66a) goto LAB_180020e3c;
    iVar2 = 0x6f0;
    if (param_1 < 0x6f0) {
      return -1;
    }
    if (param_1 < 0x6fa) goto LAB_180020e3c;
    iVar2 = 0x966;
    if (param_1 < 0x966) {
      return -1;
    }
    if (param_1 < 0x970) goto LAB_180020e3c;
    iVar2 = 0x9e6;
    if (param_1 < 0x9e6) {
      return -1;
    }
    if (param_1 < 0x9f0) goto LAB_180020e3c;
    iVar2 = 0xa66;
    if (param_1 < 0xa66) {
      return -1;
    }
    if (param_1 < 0xa70) goto LAB_180020e3c;
    iVar2 = 0xae6;
    if (param_1 < 0xae6) {
      return -1;
    }
    if (param_1 < 0xaf0) goto LAB_180020e3c;
    iVar2 = 0xb66;
    if (param_1 < 0xb66) {
      return -1;
    }
    if (param_1 < 0xb70) goto LAB_180020e3c;
    iVar2 = 0xc66;
    if (param_1 < 0xc66) {
      return -1;
    }
    if (param_1 < 0xc70) goto LAB_180020e3c;
    iVar2 = 0xce6;
    if (param_1 < 0xce6) {
      return -1;
    }
    if (param_1 < 0xcf0) goto LAB_180020e3c;
    iVar2 = 0xd66;
    if (param_1 < 0xd66) {
      return -1;
    }
    if (param_1 < 0xd70) goto LAB_180020e3c;
    iVar2 = 0xe50;
    if (param_1 < 0xe50) {
      return -1;
    }
    if (param_1 < 0xe5a) goto LAB_180020e3c;
    iVar2 = 0xed0;
    if (param_1 < 0xed0) {
      return -1;
    }
    if (param_1 < 0xeda) goto LAB_180020e3c;
    iVar2 = 0xf20;
    if (param_1 < 0xf20) {
      return -1;
    }
    if (param_1 < 0xf2a) goto LAB_180020e3c;
    iVar2 = 0x1040;
    if (param_1 < 0x1040) {
      return -1;
    }
    if (param_1 < 0x104a) goto LAB_180020e3c;
    iVar2 = 0x17e0;
    if (param_1 < 0x17e0) {
      return -1;
    }
    if (param_1 < 0x17ea) goto LAB_180020e3c;
    iVar2 = 0x1810;
    if (param_1 < 0x1810) {
      return -1;
    }
    uVar1 = 0x181a;
  }
  else {
    uVar1 = 0xff1a;
  }
  if (uVar1 <= param_1) {
    return -1;
  }
LAB_180020e3c:
  return (uint)param_1 - iVar2;
}



void FUN_180020fc0(LPVOID param_1)

{
  int *piVar1;
  
  if (param_1 != (LPVOID)0x0) {
    if (*(LPVOID *)((longlong)param_1 + 0x38) != (LPVOID)0x0) {
      FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x38));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x48) != (LPVOID)0x0) {
      FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x48));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x58) != (LPVOID)0x0) {
      FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x58));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x68) != (LPVOID)0x0) {
      FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x68));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x70) != (LPVOID)0x0) {
      FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x70));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x78) != (LPVOID)0x0) {
      FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x78));
    }
    if (*(LPVOID *)((longlong)param_1 + 0x80) != (LPVOID)0x0) {
      FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x80));
    }
    if (*(undefined **)((longlong)param_1 + 0xa0) != &DAT_18002f560) {
      FUN_18001d45c(*(undefined **)((longlong)param_1 + 0xa0));
    }
    FUN_180023ff8(0xd);
    piVar1 = *(int **)((longlong)param_1 + 0xb8);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
      UNLOCK();
      if ((*piVar1 == 0) && (piVar1 != &DAT_180046850)) {
        FUN_18001d45c(piVar1);
      }
    }
    FUN_1800241e8(0xd);
    FUN_180023ff8(0xc);
    piVar1 = *(int **)((longlong)param_1 + 0xc0);
    if (piVar1 != (int *)0x0) {
      FUN_180025dfc(piVar1);
      if (((piVar1 != (int *)PTR_DAT_180047210) && (piVar1 != (int *)&DAT_180047220)) &&
         (*piVar1 == 0)) {
        FUN_180025c64(piVar1);
      }
    }
    FUN_1800241e8(0xc);
    FUN_18001d45c(param_1);
  }
  return;
}



void FUN_1800210f4(LPVOID param_1)

{
  if (DAT_180046340 != -1) {
    if (param_1 == (LPVOID)0x0) {
      param_1 = (LPVOID)FUN_180023580();
    }
    FUN_18002359c();
    FUN_180020fc0(param_1);
  }
  return;
}



DWORD * FUN_180021130(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180021154();
  if (pDVar1 == (DWORD *)0x0) {
    FUN_18001f2a4(0x10);
  }
  return pDVar1;
}



DWORD * FUN_180021154(void)

{
  DWORD dwErrCode;
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  dwErrCode = GetLastError();
  pDVar3 = (DWORD *)FUN_180023580();
  if (pDVar3 == (DWORD *)0x0) {
    pDVar3 = (DWORD *)FUN_18001f654(1,0x478);
    if (pDVar3 != (DWORD *)0x0) {
      iVar1 = FUN_18002359c();
      if (iVar1 == 0) {
        FUN_18001d45c(pDVar3);
        pDVar3 = (DWORD *)0x0;
      }
      else {
        FUN_1800211d8((longlong)pDVar3,0);
        DVar2 = GetCurrentThreadId();
        pDVar3[2] = 0xffffffff;
        pDVar3[3] = 0xffffffff;
        *pDVar3 = DVar2;
      }
    }
  }
  SetLastError(dwErrCode);
  return pDVar3;
}



void FUN_1800211d8(longlong param_1,longlong param_2)

{
  *(undefined **)(param_1 + 0xa0) = &DAT_18002f560;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 1;
  *(undefined4 *)(param_1 + 200) = 1;
  *(undefined2 *)(param_1 + 0x164) = 0x43;
  *(undefined2 *)(param_1 + 0x26a) = 0x43;
  *(undefined4 **)(param_1 + 0xb8) = &DAT_180046850;
  *(undefined8 *)(param_1 + 0x470) = 0;
  FUN_180023ff8(0xd);
  LOCK();
  **(int **)(param_1 + 0xb8) = **(int **)(param_1 + 0xb8) + 1;
  UNLOCK();
  FUN_1800241e8(0xd);
  FUN_180023ff8(0xc);
  *(longlong *)(param_1 + 0xc0) = param_2;
  if (param_2 == 0) {
    *(undefined **)(param_1 + 0xc0) = PTR_DAT_180047210;
  }
  FUN_180025bd8(*(int **)(param_1 + 0xc0));
  FUN_1800241e8(0xc);
  return;
}



undefined8 FUN_18002129c(void)

{
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  FUN_18001f380();
  iVar1 = FUN_180024184();
  if ((((iVar1 != 0) && (DAT_180046340 = FUN_180023548(), DAT_180046340 != -1)) &&
      (pDVar3 = (DWORD *)FUN_18001f654(1,0x478), pDVar3 != (DWORD *)0x0)) &&
     (iVar1 = FUN_18002359c(), iVar1 != 0)) {
    FUN_1800211d8((longlong)pDVar3,0);
    DVar2 = GetCurrentThreadId();
    pDVar3[2] = 0xffffffff;
    pDVar3[3] = 0xffffffff;
    *pDVar3 = DVar2;
    return 1;
  }
  FUN_18002131c();
  return 0;
}



void FUN_18002131c(void)

{
  if (DAT_180046340 != -1) {
    FUN_180023564();
    DAT_180046340 = -1;
  }
  FUN_18002403c();
  return;
}



void FUN_180021340(int *param_1)

{
  byte *pbVar1;
  
  if ((((param_1 != (int *)0x0) && (*param_1 == -0x1f928c9d)) && (param_1[6] == 4)) &&
     ((param_1[8] + 0xe66cfae0U < 3 && (pbVar1 = *(byte **)(param_1 + 0xc), pbVar1 != (byte *)0x0)))
     ) {
    if (*(int *)(pbVar1 + 4) == 0) {
      if (((*pbVar1 & 0x10) != 0) && ((longlong *)**(longlong **)(param_1 + 10) != (longlong *)0x0))
      {
        (**(code **)(*(longlong *)**(longlong **)(param_1 + 10) + 0x10))();
      }
    }
    else {
      (*(code *)(*(longlong *)(param_1 + 0xe) + (longlong)*(int *)(pbVar1 + 4)))
                (*(undefined8 *)(param_1 + 10));
    }
  }
  return;
}



undefined8 * FUN_1800213b0(undefined8 *param_1,longlong param_2)

{
  FUN_18001eea8(param_1,param_2);
  *param_1 = std::bad_exception::vftable;
  return param_1;
}



undefined8 * FUN_1800213e4(undefined8 *param_1,uint param_2)

{
  *param_1 = std::bad_exception::vftable;
  FUN_18001eed4(param_1);
  if ((param_2 & 1) != 0) {
    thunk_FUN_18001d45c(param_1);
  }
  return param_1;
}



void FUN_180021420(ULONG_PTR param_1,longlong *param_2,ULONG_PTR param_3,DWORD64 *param_4,
                  ULONG_PTR param_5,uint *param_6,byte *param_7,int *param_8)

{
  longlong *plVar1;
  longlong lVar2;
  longlong local_res10;
  byte in_stack_00000060;
  
  plVar1 = FUN_18001e29c(param_2,param_4,param_5,&local_res10);
  if (param_7 != (byte *)0x0) {
    FUN_180021cfc(param_1,plVar1,param_6,param_7);
  }
  lVar2 = FUN_18001e6c4();
  FUN_18001e760(param_2,param_1,param_3,(ULONG_PTR)plVar1,lVar2 + (int)param_6[3],*param_8,param_5,
                param_4,in_stack_00000060);
  return;
}



void FUN_1800214e4(int *param_1,longlong *param_2,ULONG_PTR param_3,DWORD64 *param_4,uint *param_5,
                  byte param_6,uint param_7)

{
  code *pcVar1;
  byte bVar2;
  char cVar3;
  bool bVar4;
  int iVar5;
  int iVar6;
  DWORD *pDVar7;
  undefined7 extraout_var;
  longlong lVar8;
  ulonglong uVar9;
  undefined8 uVar10;
  int *piVar11;
  longlong *plVar12;
  int *piVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  uint *puVar16;
  uint uVar17;
  ulonglong uVar18;
  char *local_res8;
  ULONG_PTR local_res18;
  uint local_84;
  uint local_80;
  int local_7c;
  int local_78;
  int *local_70;
  byte *local_68;
  longlong local_60;
  undefined **local_58 [4];
  
  uVar15 = 0;
  local_res8 = (char *)((ulonglong)local_res8 & 0xffffffffffffff00);
  bVar4 = false;
  iVar5 = FUN_1800227e0((longlong)param_5,(longlong *)param_4);
  FUN_18001e29c(param_2,param_4,(longlong)param_5,&local_60);
  iVar6 = FUN_18002276c(param_2,param_4,(longlong)param_5);
  if (iVar6 < iVar5) {
    FUN_180022798(&local_60,param_4,(longlong)param_5,iVar5);
    FUN_1800227a4(param_2,param_4,(longlong)param_5,iVar5);
  }
  else {
    iVar5 = FUN_18002276c(param_2,param_4,(longlong)param_5);
  }
  if ((iVar5 < -1) || ((int)param_5[1] <= iVar5)) {
    FUN_180022874();
  }
  if (*param_1 == -0x1f928c9d) {
    local_res18 = param_3;
    if (((param_1[6] == 4) && (param_1[8] + 0xe66cfae0U < 3)) && (*(longlong *)(param_1 + 0xc) == 0)
       ) {
      pDVar7 = FUN_180021130();
      if (*(longlong *)(pDVar7 + 0x3c) == 0) {
        return;
      }
      pDVar7 = FUN_180021130();
      param_1 = *(int **)(pDVar7 + 0x3c);
      pDVar7 = FUN_180021130();
      local_res18 = *(ULONG_PTR *)(pDVar7 + 0x3e);
      local_res8 = (char *)CONCAT71(local_res8._1_7_,1);
      FUN_18001e744(*(undefined8 *)(param_1 + 0xe));
      bVar2 = FUN_18002631c((longlong)param_1);
      if ((int)CONCAT71(extraout_var,bVar2) == 0) {
        FUN_180022874();
      }
      if (((*param_1 == -0x1f928c9d) && (param_1[6] == 4)) &&
         ((param_1[8] + 0xe66cfae0U < 3 && (*(longlong *)(param_1 + 0xc) == 0)))) {
        FUN_180022874();
      }
      pDVar7 = FUN_180021130();
      if (*(longlong *)(pDVar7 + 0x42) != 0) {
        pDVar7 = FUN_180021130();
        piVar13 = *(int **)(pDVar7 + 0x42);
        pDVar7 = FUN_180021130();
        pDVar7[0x42] = 0;
        pDVar7[0x43] = 0;
        cVar3 = FUN_180021c00((longlong)param_1,piVar13);
        if (cVar3 == '\0') {
          uVar14 = uVar15;
          uVar18 = uVar15;
          if (0 < *piVar13) {
            do {
              lVar8 = FUN_18001e6c4();
              uVar9 = uVar15;
              if (*(int *)((longlong)piVar13[1] + 4 + lVar8 + uVar14) != 0) {
                lVar8 = FUN_18001e6c4();
                iVar5 = *(int *)((longlong)piVar13[1] + 4 + lVar8 + uVar14);
                lVar8 = FUN_18001e6c4();
                uVar9 = lVar8 + iVar5;
              }
              bVar4 = FUN_18001ddec(uVar9,0x180048a18);
              if (bVar4) {
                FUN_180021340(param_1);
                local_res8 = "bad exception";
                FUN_18001ee5c(local_58,&local_res8);
                local_58[0] = std::bad_exception::vftable;
                FUN_18001f038((longlong *)local_58,&DAT_1800447c0);
                pcVar1 = (code *)swi(3);
                (*pcVar1)();
                return;
              }
              uVar17 = (int)uVar18 + 1;
              uVar14 = uVar14 + 0x14;
              uVar18 = (ulonglong)uVar17;
            } while ((int)uVar17 < *piVar13);
          }
          FUN_180022894();
          pcVar1 = (code *)swi(3);
          (*pcVar1)();
          return;
        }
      }
    }
    param_3 = local_res18;
    if (((*param_1 == -0x1f928c9d) && (param_1[6] == 4)) && (param_1[8] + 0xe66cfae0U < 3)) {
      if ((param_5[3] != 0) &&
         (lVar8 = FUN_18001e368(param_2,(longlong)param_5,(ulonglong)param_7,iVar5,&local_84,
                                (int *)&local_80,(longlong *)param_4), local_84 < local_80)) {
        piVar13 = (int *)(lVar8 + 0x10);
        uVar17 = local_80;
        do {
          if ((piVar13[-4] <= iVar5) && (iVar5 <= piVar13[-3])) {
            lVar8 = FUN_18001e6c4();
            puVar16 = (uint *)(*piVar13 + lVar8);
            for (local_7c = piVar13[-1]; uVar17 = local_80, 0 < local_7c; local_7c = local_7c + -1)
            {
              lVar8 = FUN_18001e6dc();
              local_70 = (int *)(lVar8 + 4 + (longlong)*(int *)(*(longlong *)(param_1 + 0xc) + 0xc))
              ;
              lVar8 = FUN_18001e6dc();
              for (local_78 = *(int *)(lVar8 + *(int *)(*(longlong *)(param_1 + 0xc) + 0xc));
                  0 < local_78; local_78 = local_78 + -1) {
                lVar8 = FUN_18001e6dc();
                local_68 = (byte *)(lVar8 + *local_70);
                uVar10 = FUN_180022614((byte *)puVar16,local_68,*(byte **)(param_1 + 0xc));
                if ((int)uVar10 != 0) {
                  bVar4 = true;
                  FUN_180021420((ULONG_PTR)param_1,param_2,local_res18,param_4,(ULONG_PTR)param_5,
                                puVar16,local_68,piVar13 + -4);
                  uVar17 = local_80;
                  goto LAB_18002183d;
                }
                local_70 = local_70 + 1;
              }
              puVar16 = puVar16 + 5;
            }
          }
LAB_18002183d:
          local_84 = local_84 + 1;
          piVar13 = piVar13 + 5;
        } while (local_84 < uVar17);
        if (bVar4) goto LAB_1800218e8;
      }
      piVar13 = (int *)0x0;
      if (0x19930520 < (*param_5 & 0x1fffffff)) {
        uVar17 = param_5[8];
        piVar11 = piVar13;
        if (uVar17 != 0) {
          lVar8 = FUN_18001e6c4();
          piVar11 = (int *)(lVar8 + (int)uVar17);
        }
        if (piVar11 != (int *)0x0) {
          if (uVar17 != 0) {
            lVar8 = FUN_18001e6c4();
            piVar13 = (int *)(lVar8 + (int)param_5[8]);
          }
          cVar3 = FUN_180021c00((longlong)param_1,piVar13);
          if (cVar3 == '\0') {
            plVar12 = FUN_18001e29c(param_2,param_4,(longlong)param_5,(longlong *)&local_res8);
            FUN_18001e760(param_2,(ULONG_PTR)param_1,local_res18,(ULONG_PTR)plVar12,0,-1,
                          (ULONG_PTR)param_5,param_4,param_6);
          }
        }
      }
      goto LAB_1800218e8;
    }
  }
  if (param_5[3] != 0) {
    if (param_6 != 0) {
      FUN_180022894();
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    FUN_180021998(param_1,param_2,param_3,param_4,(ULONG_PTR)param_5,iVar5,param_7);
  }
LAB_1800218e8:
  pDVar7 = FUN_180021130();
  if (*(longlong *)(pDVar7 + 0x42) != 0) {
    FUN_180022874();
  }
  return;
}



void FUN_180021998(int *param_1,longlong *param_2,ULONG_PTR param_3,DWORD64 *param_4,
                  ULONG_PTR param_5,int param_6,uint param_7)

{
  int iVar1;
  DWORD *pDVar2;
  PVOID pvVar3;
  longlong lVar4;
  int *piVar5;
  uint local_res8 [2];
  uint local_48 [4];
  
  if (*param_1 != -0x7ffffffd) {
    pDVar2 = FUN_180021130();
    if (*(longlong *)(pDVar2 + 0x38) != 0) {
      pvVar3 = EncodePointer((PVOID)0x0);
      pDVar2 = FUN_180021130();
      if ((((*(PVOID *)(pDVar2 + 0x38) != pvVar3) && (*param_1 != -0x1fbcb0b3)) &&
          (*param_1 != -0x1fbcbcae)) && (iVar1 = FUN_18001e5cc(param_1,param_2,param_3), iVar1 != 0)
         ) {
        return;
      }
    }
    if (*(int *)(param_5 + 0xc) == 0) {
      FUN_180022874();
    }
    lVar4 = FUN_18001e368(param_2,param_5,(ulonglong)param_7,param_6,local_res8,(int *)local_48,
                          (longlong *)param_4);
    if (local_res8[0] < local_48[0]) {
      piVar5 = (int *)(lVar4 + 0xc);
      do {
        if ((piVar5[-3] <= param_6) && (param_6 <= piVar5[-2])) {
          lVar4 = FUN_18001e6c4();
          if (*(int *)(lVar4 + -0x10 + (longlong)piVar5[1] + (longlong)*piVar5 * 0x14) == 0) {
            lVar4 = 0;
          }
          else {
            lVar4 = FUN_18001e6c4();
            iVar1 = *(int *)(lVar4 + -0x10 + (longlong)piVar5[1] + (longlong)*piVar5 * 0x14);
            lVar4 = FUN_18001e6c4();
            lVar4 = lVar4 + iVar1;
          }
          if (lVar4 != 0) {
            lVar4 = FUN_18001e6c4();
            if (*(int *)(lVar4 + -0x10 + (longlong)piVar5[1] + (longlong)*piVar5 * 0x14) == 0) {
              lVar4 = 0;
            }
            else {
              lVar4 = FUN_18001e6c4();
              iVar1 = *(int *)(lVar4 + -0x10 + (longlong)piVar5[1] + (longlong)*piVar5 * 0x14);
              lVar4 = FUN_18001e6c4();
              lVar4 = lVar4 + iVar1;
            }
            if (*(char *)(lVar4 + 0x10) != '\0') goto LAB_180021bce;
          }
          lVar4 = FUN_18001e6c4();
          if ((*(byte *)(lVar4 + -0x14 + (longlong)piVar5[1] + (longlong)*piVar5 * 0x14) & 0x40) ==
              0) {
            lVar4 = FUN_18001e6c4();
            FUN_180021420((ULONG_PTR)param_1,param_2,param_3,param_4,param_5,
                          (uint *)(lVar4 + (longlong)(*piVar5 + -1) * 0x14 + (longlong)piVar5[1]),
                          (byte *)0x0,piVar5 + -3);
          }
        }
LAB_180021bce:
        local_res8[0] = local_res8[0] + 1;
        piVar5 = piVar5 + 5;
      } while (local_res8[0] < local_48[0]);
    }
  }
  return;
}



undefined1 FUN_180021c00(longlong param_1,int *param_2)

{
  int iVar1;
  code *pcVar2;
  undefined1 uVar3;
  longlong lVar4;
  longlong lVar5;
  undefined8 uVar6;
  int iVar7;
  int iVar8;
  int *piVar9;
  
  if (param_2 == (int *)0x0) {
    FUN_180022874();
    FUN_180022894();
    pcVar2 = (code *)swi(3);
    uVar3 = (*pcVar2)();
    return uVar3;
  }
  iVar8 = 0;
  uVar3 = 0;
  if (0 < *param_2) {
    do {
      lVar4 = FUN_18001e6dc();
      piVar9 = (int *)((longlong)*(int *)(*(longlong *)(param_1 + 0x30) + 0xc) + 4 + lVar4);
      lVar4 = FUN_18001e6dc();
      iVar7 = *(int *)(lVar4 + *(int *)(*(longlong *)(param_1 + 0x30) + 0xc));
      if (0 < iVar7) {
        do {
          lVar4 = FUN_18001e6dc();
          iVar1 = *piVar9;
          lVar5 = FUN_18001e6c4();
          uVar6 = FUN_180022614((byte *)((longlong)param_2[1] + lVar5 + (longlong)iVar8 * 0x14),
                                (byte *)(lVar4 + iVar1),*(byte **)(param_1 + 0x30));
          if ((int)uVar6 != 0) {
            uVar3 = 1;
            break;
          }
          iVar7 = iVar7 + -1;
          piVar9 = piVar9 + 1;
        } while (0 < iVar7);
      }
      iVar8 = iVar8 + 1;
    } while (iVar8 < *param_2);
  }
  return uVar3;
}



longlong FUN_180021cd8(longlong param_1,int *param_2)

{
  longlong lVar1;
  
  lVar1 = *param_2 + param_1;
  if (-1 < param_2[1]) {
    lVar1 = lVar1 + (longlong)*(int *)((longlong)param_2[2] + *(longlong *)(param_2[1] + param_1)) +
                    (longlong)param_2[1];
  }
  return lVar1;
}



void FUN_180021cfc(longlong param_1,longlong *param_2,uint *param_3,byte *param_4)

{
  char cVar1;
  int iVar2;
  undefined7 extraout_var;
  longlong lVar3;
  code *pcVar4;
  longlong *plVar5;
  
  plVar5 = param_2;
  if ((*param_3 & 0x80000000) == 0) {
    plVar5 = (longlong *)((longlong)(int)param_3[2] + *param_2);
  }
  cVar1 = FUN_180021db4(param_1,param_2,param_3,param_4);
  iVar2 = (int)CONCAT71(extraout_var,cVar1);
  if (iVar2 == 1) {
    pcVar4 = (code *)0x0;
    if (*(int *)(param_4 + 0x18) != 0) {
      lVar3 = FUN_18001e6dc();
      pcVar4 = (code *)(*(int *)(param_4 + 0x18) + lVar3);
    }
    lVar3 = FUN_180021cd8(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
    (*pcVar4)(plVar5,lVar3);
  }
  else if (iVar2 == 2) {
    pcVar4 = (code *)0x0;
    if (*(int *)(param_4 + 0x18) != 0) {
      lVar3 = FUN_18001e6dc();
      pcVar4 = (code *)(lVar3 + *(int *)(param_4 + 0x18));
    }
    lVar3 = FUN_180021cd8(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
    (*pcVar4)(plVar5,lVar3,1);
  }
  return;
}



char FUN_180021db4(longlong param_1,longlong *param_2,uint *param_3,byte *param_4)

{
  uint uVar1;
  int iVar2;
  byte bVar3;
  longlong lVar4;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  undefined8 *puVar5;
  undefined7 extraout_var_07;
  undefined7 extraout_var_08;
  undefined7 extraout_var_09;
  ulonglong uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  
  uVar8 = 0;
  uVar1 = param_3[1];
  uVar6 = uVar8;
  if (uVar1 != 0) {
    lVar4 = FUN_18001e6c4();
    uVar6 = (int)uVar1 + lVar4;
  }
  if (uVar6 == 0) {
    return '\0';
  }
  uVar6 = uVar8;
  if (uVar1 != 0) {
    lVar4 = FUN_18001e6c4();
    uVar6 = lVar4 + (int)param_3[1];
  }
  if (*(char *)(uVar6 + 0x10) == '\0') {
    return '\0';
  }
  if ((param_3[2] == 0) && ((*param_3 & 0x80000000) == 0)) {
    return '\0';
  }
  uVar1 = *param_3;
  if (-1 < (int)uVar1) {
    param_2 = (longlong *)((longlong)(int)param_3[2] + *param_2);
  }
  uVar6 = uVar8;
  if ((((char)uVar1 < '\0') && ((*param_4 & 0x10) != 0)) && (DAT_180049220 != (code *)0x0)) {
    lVar4 = (*DAT_180049220)();
    bVar3 = FUN_18002631c(lVar4);
    if (((int)CONCAT71(extraout_var,bVar3) != 0) &&
       (bVar3 = FUN_18002631c((longlong)param_2), (int)CONCAT71(extraout_var_00,bVar3) != 0)) {
      *param_2 = lVar4;
LAB_180021e8c:
      lVar4 = FUN_180021cd8(lVar4,(int *)(param_4 + 8));
      *param_2 = lVar4;
      uVar6 = uVar8;
      goto LAB_180021fdd;
    }
  }
  else if ((uVar1 & 8) == 0) {
    if ((*param_4 & 1) == 0) {
      uVar7 = uVar8;
      if (*(int *)(param_4 + 0x18) != 0) {
        lVar4 = FUN_18001e6dc();
        uVar7 = lVar4 + *(int *)(param_4 + 0x18);
      }
      if (uVar7 == 0) {
        bVar3 = FUN_18002631c(*(longlong *)(param_1 + 0x28));
        if (((int)CONCAT71(extraout_var_05,bVar3) != 0) &&
           (bVar3 = FUN_18002631c((longlong)param_2), (int)CONCAT71(extraout_var_06,bVar3) != 0)) {
          iVar2 = *(int *)(param_4 + 0x14);
          puVar5 = (undefined8 *)FUN_180021cd8(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
          FUN_18001d560(param_2,puVar5,(longlong)iVar2);
          uVar6 = 0;
          goto LAB_180021fdd;
        }
      }
      else {
        bVar3 = FUN_18002631c(*(longlong *)(param_1 + 0x28));
        if (((int)CONCAT71(extraout_var_07,bVar3) != 0) &&
           (bVar3 = FUN_18002631c((longlong)param_2), (int)CONCAT71(extraout_var_08,bVar3) != 0)) {
          if (*(int *)(param_4 + 0x18) != 0) {
            lVar4 = FUN_18001e6dc();
            uVar8 = lVar4 + *(int *)(param_4 + 0x18);
          }
          bVar3 = FUN_18002631c(uVar8);
          if ((int)CONCAT71(extraout_var_09,bVar3) != 0) {
            uVar6 = (ulonglong)(((*param_4 & 4) != 0) + 1);
            goto LAB_180021fdd;
          }
        }
      }
    }
    else {
      bVar3 = FUN_18002631c(*(longlong *)(param_1 + 0x28));
      if (((int)CONCAT71(extraout_var_03,bVar3) != 0) &&
         (bVar3 = FUN_18002631c((longlong)param_2), (int)CONCAT71(extraout_var_04,bVar3) != 0)) {
        FUN_18001d560(param_2,*(undefined8 **)(param_1 + 0x28),(longlong)*(int *)(param_4 + 0x14));
        if ((*(int *)(param_4 + 0x14) != 8) || (uVar6 = 0, *param_2 == 0)) goto LAB_180021fdd;
        lVar4 = *param_2;
        goto LAB_180021e8c;
      }
    }
  }
  else {
    bVar3 = FUN_18002631c(*(longlong *)(param_1 + 0x28));
    if (((int)CONCAT71(extraout_var_01,bVar3) != 0) &&
       (bVar3 = FUN_18002631c((longlong)param_2), (int)CONCAT71(extraout_var_02,bVar3) != 0)) {
      lVar4 = *(longlong *)(param_1 + 0x28);
      *param_2 = lVar4;
      goto LAB_180021e8c;
    }
  }
  FUN_180022874();
LAB_180021fdd:
  return (char)uVar6;
}



undefined8 FUN_180022004(longlong param_1)

{
  undefined8 uVar1;
  undefined8 uVar2;
  int *piVar3;
  longlong lVar4;
  longlong *plVar5;
  int iVar6;
  DWORD *pDVar7;
  undefined8 *puVar8;
  undefined8 uVar9;
  undefined8 local_50 [3];
  
  pDVar7 = FUN_180021130();
  uVar1 = *(undefined8 *)(pDVar7 + 0x3e);
  pDVar7 = FUN_180021130();
  uVar2 = *(undefined8 *)(pDVar7 + 0x3c);
  piVar3 = *(int **)(param_1 + 0x50);
  lVar4 = *(longlong *)(param_1 + 0x48);
  uVar9 = *(undefined8 *)(param_1 + 0x40);
  plVar5 = *(longlong **)(param_1 + 0x28);
  pDVar7 = FUN_180021130();
  *(int **)(pDVar7 + 0x3c) = piVar3;
  pDVar7 = FUN_180021130();
  *(undefined8 *)(pDVar7 + 0x3e) = uVar9;
  pDVar7 = FUN_180021130();
  puVar8 = FUN_18001e620(local_50,*(undefined8 *)(*(longlong *)(pDVar7 + 0x3c) + 0x28));
  if (*(longlong *)(param_1 + 0x58) != 0) {
    FUN_180021130();
  }
  uVar9 = FUN_180026340();
  FUN_18001e664((longlong)puVar8);
  if ((((*piVar3 == -0x1f928c9d) && (piVar3[6] == 4)) && (piVar3[8] + 0xe66cfae0U < 3)) &&
     (iVar6 = FUN_18001e6f4(*(longlong *)(piVar3 + 10)), iVar6 != 0)) {
    FUN_180021340(piVar3);
  }
  pDVar7 = FUN_180021130();
  *(undefined8 *)(pDVar7 + 0x3c) = uVar2;
  pDVar7 = FUN_180021130();
  *(undefined8 *)(pDVar7 + 0x3e) = uVar1;
  *(undefined8 *)((longlong)*(int *)(lVar4 + 0x1c) + *plVar5) = 0xfffffffffffffffe;
  return uVar9;
}



undefined8 FUN_180022208(undefined8 *param_1)

{
  int *piVar1;
  code *pcVar2;
  DWORD *pDVar3;
  undefined8 uVar4;
  
  piVar1 = (int *)*param_1;
  if ((*piVar1 == -0x1fbcbcae) || (*piVar1 == -0x1fbcb0b3)) {
    pDVar3 = FUN_180021130();
    if (0 < (int)pDVar3[0x40]) {
      pDVar3 = FUN_180021130();
      pDVar3[0x40] = pDVar3[0x40] - 1;
    }
  }
  else if (*piVar1 == -0x1f928c9d) {
    pDVar3 = FUN_180021130();
    pDVar3[0x40] = 0;
    FUN_180022894();
    pcVar2 = (code *)swi(3);
    uVar4 = (*pcVar2)();
    return uVar4;
  }
  return 0;
}



void FUN_18002225c(longlong *param_1,longlong *param_2,longlong param_3,int param_4)

{
  int iVar1;
  int iVar2;
  undefined8 uVar3;
  DWORD *pDVar4;
  longlong lVar5;
  longlong lVar6;
  
  uVar3 = FUN_18001e6c4();
  iVar2 = FUN_180022744(param_1,param_2,param_3);
  pDVar4 = FUN_180021130();
  pDVar4[0x40] = pDVar4[0x40] + 1;
  while ((iVar2 != -1 && (param_4 < iVar2))) {
    if ((iVar2 < 0) || (*(int *)(param_3 + 4) <= iVar2)) {
      FUN_180022874();
    }
    lVar6 = (longlong)iVar2;
    lVar5 = FUN_18001e6c4();
    iVar2 = *(int *)((longlong)*(int *)(param_3 + 8) + lVar5 + lVar6 * 8);
    lVar5 = FUN_18001e6c4();
    if (*(int *)((longlong)*(int *)(param_3 + 8) + 4 + lVar5 + lVar6 * 8) == 0) {
      lVar5 = 0;
    }
    else {
      lVar5 = FUN_18001e6c4();
      iVar1 = *(int *)((longlong)*(int *)(param_3 + 8) + 4 + lVar5 + lVar6 * 8);
      lVar5 = FUN_18001e6c4();
      lVar5 = lVar5 + iVar1;
    }
    if (lVar5 != 0) {
      FUN_180022798(param_1,param_2,param_3,iVar2);
      lVar5 = FUN_18001e6c4();
      if (*(int *)((longlong)*(int *)(param_3 + 8) + 4 + lVar5 + lVar6 * 8) != 0) {
        FUN_18001e6c4();
        FUN_18001e6c4();
      }
      FUN_180026340();
      FUN_18001e728(uVar3);
    }
  }
  pDVar4 = FUN_180021130();
  if (0 < (int)pDVar4[0x40]) {
    pDVar4 = FUN_180021130();
    pDVar4[0x40] = pDVar4[0x40] - 1;
  }
  if ((iVar2 != -1) && (param_4 < iVar2)) {
    FUN_180022874();
  }
  FUN_180022798(param_1,param_2,param_3,iVar2);
  return;
}



undefined8
FUN_1800223f0(int *param_1,longlong *param_2,ULONG_PTR param_3,DWORD64 *param_4,uint *param_5,
             uint param_6,undefined8 param_7,byte param_8)

{
  uint uVar1;
  int iVar2;
  DWORD *pDVar3;
  longlong lVar4;
  undefined8 uVar5;
  code *pcVar6;
  undefined8 in_stack_ffffffffffffffe0;
  undefined4 uVar7;
  
  uVar7 = (undefined4)((ulonglong)in_stack_ffffffffffffffe0 >> 0x20);
  pDVar3 = FUN_180021130();
  if (((((pDVar3[0x118] != 0) || (*param_1 == -0x1f928c9d)) ||
       ((*param_1 == -0x7fffffd7 &&
        ((param_1[6] == 0xf && (*(longlong *)(param_1 + 0x18) == 0x19930520)))))) ||
      (*param_1 == -0x7fffffda)) ||
     (((*param_5 & 0x1fffffff) < 0x19930522 || ((param_5[9] & 1) == 0)))) {
    if ((param_1[1] & 0x66U) == 0) {
      if (param_5[3] == 0) {
        if ((*param_5 & 0x1fffffff) < 0x19930521) {
          return 1;
        }
        if (param_5[8] == 0) {
          lVar4 = 0;
        }
        else {
          lVar4 = FUN_18001e6c4();
          lVar4 = lVar4 + (int)param_5[8];
        }
        if (lVar4 == 0) {
          return 1;
        }
      }
      if (((*param_1 == -0x1f928c9d) && (2 < (uint)param_1[6])) && (0x19930522 < (uint)param_1[8]))
      {
        if (*(int *)(*(longlong *)(param_1 + 0xc) + 8) == 0) {
          pcVar6 = (code *)0x0;
        }
        else {
          lVar4 = FUN_18001e6dc();
          pcVar6 = (code *)(*(int *)(*(longlong *)(param_1 + 0xc) + 8) + lVar4);
        }
        if (pcVar6 != (code *)0x0) {
          uVar5 = (*pcVar6)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,
                            CONCAT44(uVar7,(uint)param_8));
          return uVar5;
        }
      }
      FUN_1800214e4(param_1,param_2,param_3,param_4,param_5,param_8,param_6);
    }
    else if ((param_5[1] != 0) && (param_6 == 0)) {
      uVar1 = param_1[1] & 0x20;
      if ((uVar1 == 0) || (*param_1 != -0x7fffffda)) {
        if ((uVar1 == 0) || (*param_1 != -0x7fffffd7)) {
          FUN_18001e494(param_2,param_4,(longlong)param_5);
          return 1;
        }
        iVar2 = param_1[0xe];
        if ((iVar2 < -1) || ((int)param_5[1] <= iVar2)) {
          FUN_180022874();
        }
        param_2 = *(longlong **)(param_1 + 10);
      }
      else {
        iVar2 = FUN_1800227e8((longlong)param_5,(longlong)param_4,*(longlong *)(param_3 + 0xf8));
        if ((iVar2 < -1) || ((int)param_5[1] <= iVar2)) {
          FUN_180022874();
        }
      }
      FUN_18002225c(param_2,(longlong *)param_4,(longlong)param_5,iVar2);
    }
  }
  return 1;
}



undefined8 FUN_180022614(byte *param_1,byte *param_2,byte *param_3)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  ulonglong uVar4;
  int iVar5;
  
  iVar5 = *(int *)(param_1 + 4);
  lVar3 = 0;
  lVar1 = lVar3;
  if (iVar5 != 0) {
    lVar1 = FUN_18001e6c4();
    lVar1 = iVar5 + lVar1;
  }
  if (lVar1 != 0) {
    if (iVar5 == 0) {
      iVar5 = 0;
      lVar1 = lVar3;
    }
    else {
      iVar5 = *(int *)(param_1 + 4);
      lVar1 = FUN_18001e6c4();
      lVar1 = iVar5 + lVar1;
    }
    if ((*(char *)(lVar1 + 0x10) != '\0') && (((*param_1 & 0x80) == 0 || ((*param_2 & 0x10) == 0))))
    {
      lVar1 = lVar3;
      if (iVar5 != 0) {
        lVar1 = FUN_18001e6c4();
        lVar1 = lVar1 + *(int *)(param_1 + 4);
      }
      lVar2 = FUN_18001e6dc();
      if (lVar1 != lVar2 + *(int *)(param_2 + 4)) {
        if (*(int *)(param_1 + 4) != 0) {
          lVar3 = FUN_18001e6c4();
          lVar3 = lVar3 + *(int *)(param_1 + 4);
        }
        lVar1 = FUN_18001e6dc();
        uVar4 = FUN_18001fda0((ulonglong *)(lVar3 + 0x10),
                              (longlong)*(int *)(param_2 + 4) + 0x10 + lVar1);
        if ((int)uVar4 != 0) {
          return 0;
        }
      }
      if (((*param_2 & 2) != 0) && ((*param_1 & 8) == 0)) {
        return 0;
      }
      if (((*param_3 & 1) != 0) && ((*param_1 & 1) == 0)) {
        return 0;
      }
      if (((*param_3 & 4) != 0) && ((*param_1 & 4) == 0)) {
        return 0;
      }
      if (((*param_3 & 2) != 0) && ((*param_1 & 2) == 0)) {
        return 0;
      }
      return 1;
    }
  }
  return 1;
}



void FUN_180022744(longlong *param_1,longlong *param_2,longlong param_3)

{
  if (*(int *)((longlong)*(int *)(param_3 + 0x1c) + *param_1) == -2) {
    FUN_1800227e8(param_3,(longlong)param_2,*param_2);
  }
  return;
}



undefined4 FUN_18002276c(longlong *param_1,DWORD64 *param_2,longlong param_3)

{
  longlong *plVar1;
  longlong local_res18 [2];
  
  plVar1 = FUN_18001e29c(param_1,param_2,param_3,local_res18);
  return *(undefined4 *)((longlong)*(int *)(param_3 + 0x1c) + 4 + *plVar1);
}



void FUN_180022798(longlong *param_1,undefined8 param_2,longlong param_3,undefined4 param_4)

{
  *(undefined4 *)((longlong)*(int *)(param_3 + 0x1c) + *param_1) = param_4;
  return;
}



void FUN_1800227a4(longlong *param_1,DWORD64 *param_2,longlong param_3,int param_4)

{
  longlong *plVar1;
  longlong local_res18 [2];
  
  plVar1 = FUN_18001e29c(param_1,param_2,param_3,local_res18);
  if (*(int *)((longlong)*(int *)(param_3 + 0x1c) + 4 + *plVar1) < param_4) {
    *(int *)((longlong)*(int *)(param_3 + 0x1c) + 4 + *plVar1) = param_4;
  }
  return;
}



void FUN_1800227e0(longlong param_1,longlong *param_2)

{
  FUN_1800227e8(param_1,(longlong)param_2,*param_2);
  return;
}



undefined4 FUN_1800227e8(longlong param_1,longlong param_2,longlong param_3)

{
  uint uVar1;
  longlong lVar2;
  uint uVar3;
  ulonglong uVar4;
  
  if (param_1 == 0) {
    FUN_180022874();
  }
  uVar1 = *(uint *)(param_1 + 0x14);
  if ((longlong)*(int *)(param_1 + 0x18) + *(longlong *)(param_2 + 8) == 0) {
    FUN_180022874();
  }
  uVar4 = 0;
  if (uVar1 != 0) {
    lVar2 = *(longlong *)(param_2 + 8);
    do {
      if (param_3 < *(int *)(lVar2 + uVar4 * 8 + (longlong)*(int *)(param_1 + 0x18)) + lVar2) break;
      uVar3 = (int)uVar4 + 1;
      uVar4 = (ulonglong)uVar3;
    } while (uVar3 < uVar1);
    if ((int)uVar4 != 0) {
      return *(undefined4 *)
              (lVar2 + (ulonglong)((int)uVar4 - 1) * 8 + 4 + (longlong)*(int *)(param_1 + 0x18));
    }
  }
  return 0xffffffff;
}



void FUN_180022874(void)

{
  code *pcVar1;
  DWORD *pDVar2;
  
  pcVar1 = (code *)DecodePointer(DAT_180049228);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
  }
  FUN_180022894();
  pDVar2 = FUN_180021130();
  if (*(code **)(pDVar2 + 0x34) != (code *)0x0) {
    (**(code **)(pDVar2 + 0x34))();
  }
  FUN_1800228f0();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_180022894(void)

{
  code *pcVar1;
  DWORD *pDVar2;
  
  pDVar2 = FUN_180021130();
  if (*(code **)(pDVar2 + 0x34) != (code *)0x0) {
    (**(code **)(pDVar2 + 0x34))();
  }
  FUN_1800228f0();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_1800228b4(void)

{
  DAT_180049228 = EncodePointer(FUN_180022894);
  return;
}



void FUN_1800228d4(uint param_1,uint param_2)

{
  DAT_180046344 = ~param_2 & DAT_180046344 | param_1 & param_2;
  return;
}



void FUN_1800228f0(void)

{
  code *pcVar1;
  BOOL BVar2;
  longlong lVar3;
  undefined1 *puVar4;
  undefined1 auStack_28 [8];
  undefined1 auStack_20 [32];
  
  puVar4 = auStack_28;
  lVar3 = FUN_18002430c();
  if (lVar3 != 0) {
    FUN_18002433c(0x16);
  }
  if (((byte)DAT_180046344 & 2) != 0) {
    BVar2 = IsProcessorFeaturePresent(0x17);
    puVar4 = auStack_28;
    if (BVar2 != 0) {
      pcVar1 = (code *)swi(0x29);
      (*pcVar1)(7);
      puVar4 = auStack_20;
    }
    *(undefined8 *)(puVar4 + -8) = 0x18002293a;
    FUN_18001fe74(3,0x40000015,1);
  }
  *(undefined8 *)(puVar4 + -8) = 0x180022944;
  FUN_18001f374(3);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_180022948(undefined8 param_1)

{
  DAT_180049230 = param_1;
  return;
}



undefined4 FUN_180022950(int param_1,undefined8 param_2)

{
  DWORD DVar1;
  int *piVar2;
  code *pcVar3;
  undefined8 uVar4;
  DWORD *pDVar5;
  int *piVar6;
  longlong lVar7;
  longlong lVar8;
  
  pDVar5 = FUN_180021154();
  if (pDVar5 != (DWORD *)0x0) {
    piVar2 = *(int **)(pDVar5 + 0x28);
    piVar6 = piVar2;
    do {
      if (*piVar6 == param_1) break;
      piVar6 = piVar6 + 4;
    } while (piVar6 < piVar2 + 0x30);
    if ((piVar2 + 0x30 <= piVar6) || (*piVar6 != param_1)) {
      piVar6 = (int *)0x0;
    }
    if ((piVar6 != (int *)0x0) && (pcVar3 = *(code **)(piVar6 + 2), pcVar3 != (code *)0x0)) {
      if (pcVar3 == (code *)0x5) {
        piVar6[2] = 0;
        piVar6[3] = 0;
        return 1;
      }
      if (pcVar3 != (code *)0x1) {
        uVar4 = *(undefined8 *)(pDVar5 + 0x2a);
        *(undefined8 *)(pDVar5 + 0x2a) = param_2;
        if (piVar6[1] == 8) {
          lVar7 = 0x30;
          do {
            lVar8 = lVar7 + 0x10;
            *(undefined8 *)(lVar7 + 8 + *(longlong *)(pDVar5 + 0x28)) = 0;
            lVar7 = lVar8;
          } while (lVar8 < 0xc0);
          DVar1 = pDVar5[0x2c];
          if (*piVar6 == -0x3fffff72) {
            pDVar5[0x2c] = 0x83;
          }
          else if (*piVar6 == -0x3fffff70) {
            pDVar5[0x2c] = 0x81;
          }
          else if (*piVar6 == -0x3fffff6f) {
            pDVar5[0x2c] = 0x84;
          }
          else if (*piVar6 == -0x3fffff6d) {
            pDVar5[0x2c] = 0x85;
          }
          else if (*piVar6 == -0x3fffff73) {
            pDVar5[0x2c] = 0x82;
          }
          else if (*piVar6 == -0x3fffff71) {
            pDVar5[0x2c] = 0x86;
          }
          else if (*piVar6 == -0x3fffff6e) {
            pDVar5[0x2c] = 0x8a;
          }
          else if (*piVar6 == -0x3ffffd4b) {
            pDVar5[0x2c] = 0x8d;
          }
          else if (*piVar6 == -0x3ffffd4c) {
            pDVar5[0x2c] = 0x8e;
          }
          (*pcVar3)(8,pDVar5[0x2c]);
          pDVar5[0x2c] = DVar1;
        }
        else {
          piVar6[2] = 0;
          piVar6[3] = 0;
          (*pcVar3)(piVar6[1]);
        }
        *(undefined8 *)(pDVar5 + 0x2a) = uVar4;
      }
      return 0xffffffff;
    }
  }
  return 0;
}



undefined4 FUN_180022b1c(int param_1,undefined8 param_2)

{
  undefined4 uVar1;
  
  if (param_1 == -0x1f928c9d) {
    uVar1 = FUN_180022950(-0x1f928c9d,param_2);
    return uVar1;
  }
  return 0;
}



undefined8 FUN_180022b30(void)

{
  uint uVar1;
  byte bVar2;
  DWORD DVar3;
  undefined8 uVar4;
  HANDLE hFile;
  int iVar5;
  longlong *plVar6;
  byte *pbVar7;
  longlong lVar8;
  byte *pbVar9;
  int iVar10;
  int iVar11;
  undefined1 auStack_d8 [32];
  uint local_b8;
  longlong *local_b0;
  int local_a8;
  byte *local_a0;
  byte *local_98;
  undefined1 *local_90;
  _STARTUPINFOW local_88;
  
  local_90 = auStack_d8;
  FUN_180023ff8(0xb);
  local_b0 = (longlong *)FUN_18001f654(0x20,0x58);
  if (local_b0 == (longlong *)0x0) {
    FUN_180024e60(auStack_d8,(PVOID)0x180022b94);
    uVar4 = 0xffffffff;
  }
  else {
    DAT_18004b088 = 0x20;
    DAT_180049240 = local_b0;
    for (; local_b0 < DAT_180049240 + 0x160; local_b0 = local_b0 + 0xb) {
      *(undefined2 *)(local_b0 + 1) = 0xa00;
      *local_b0 = -1;
      *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x7f;
      *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
      *(undefined4 *)(local_b0 + 10) = 0;
      *(undefined1 *)((longlong)local_b0 + 0x4c) = 0;
    }
    GetStartupInfoW(&local_88);
    if ((local_88.cbReserved2 != 0) && ((int *)local_88.lpReserved2 != (int *)0x0)) {
      pbVar9 = (byte *)((longlong)local_88.lpReserved2 + 4);
      pbVar7 = pbVar9 + *(int *)local_88.lpReserved2;
      iVar10 = 0x800;
      if (*(int *)local_88.lpReserved2 < 0x800) {
        iVar10 = *(int *)local_88.lpReserved2;
      }
      iVar5 = 1;
      local_a0 = pbVar9;
      local_98 = pbVar7;
      while ((iVar11 = iVar10, local_a8 = iVar5, DAT_18004b088 < iVar10 &&
             (local_b0 = (longlong *)FUN_18001f654(0x20,0x58), iVar11 = DAT_18004b088,
             local_b0 != (longlong *)0x0))) {
        (&DAT_180049240)[iVar5] = local_b0;
        DAT_18004b088 = DAT_18004b088 + 0x20;
        for (; local_b0 < (longlong *)((longlong)(&DAT_180049240)[iVar5] + 0xb00);
            local_b0 = local_b0 + 0xb) {
          *(undefined2 *)(local_b0 + 1) = 0xa00;
          *local_b0 = -1;
          *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
          *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
          *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
          *(undefined4 *)(local_b0 + 10) = 0;
          *(undefined1 *)((longlong)local_b0 + 0x4c) = 0;
        }
        iVar5 = iVar5 + 1;
      }
      local_b8 = 0;
      while (uVar1 = local_b8, (int)local_b8 < iVar11) {
        if (((1 < (longlong)*(HANDLE *)pbVar7 + 2U) && ((*pbVar9 & 1) != 0)) &&
           (((*pbVar9 & 8) != 0 || (DVar3 = GetFileType(*(HANDLE *)pbVar7), DVar3 != 0)))) {
          plVar6 = (longlong *)
                   ((ulonglong)(uVar1 & 0x1f) * 0x58 +
                   (longlong)(&DAT_180049240)[(longlong)(int)uVar1 >> 5]);
          *plVar6 = *(longlong *)pbVar7;
          *(byte *)(plVar6 + 1) = *pbVar9;
          local_b0 = plVar6;
          FUN_1800235b8((LPCRITICAL_SECTION)(plVar6 + 2),4000);
          *(int *)((longlong)plVar6 + 0xc) = *(int *)((longlong)plVar6 + 0xc) + 1;
        }
        pbVar9 = pbVar9 + 1;
        pbVar7 = pbVar7 + 8;
        local_a0 = pbVar9;
        local_98 = pbVar7;
        local_b8 = uVar1 + 1;
      }
    }
    local_b8 = 0;
    while (uVar1 = local_b8, (int)local_b8 < 3) {
      lVar8 = (longlong)(int)local_b8;
      plVar6 = DAT_180049240 + lVar8 * 0xb;
      local_b0 = plVar6;
      if (*plVar6 + 2U < 2) {
        *(undefined1 *)(plVar6 + 1) = 0x81;
        DVar3 = 0xfffffff5 - (local_b8 != 1);
        if (local_b8 == 0) {
          DVar3 = 0xfffffff6;
        }
        hFile = GetStdHandle(DVar3);
        if (((longlong)hFile + 1U < 2) || (DVar3 = GetFileType(hFile), DVar3 == 0)) {
          *(byte *)(plVar6 + 1) = *(byte *)(plVar6 + 1) | 0x40;
          *plVar6 = -2;
          if (DAT_180049f48 != 0) {
            *(undefined4 *)(*(longlong *)(DAT_180049f48 + lVar8 * 8) + 0x1c) = 0xfffffffe;
          }
        }
        else {
          *plVar6 = (longlong)hFile;
          if ((DVar3 & 0xff) == 2) {
            bVar2 = *(byte *)(plVar6 + 1) | 0x40;
LAB_180022dea:
            *(byte *)(plVar6 + 1) = bVar2;
          }
          else if ((DVar3 & 0xff) == 3) {
            bVar2 = *(byte *)(plVar6 + 1) | 8;
            goto LAB_180022dea;
          }
          FUN_1800235b8((LPCRITICAL_SECTION)(plVar6 + 2),4000);
          *(int *)((longlong)plVar6 + 0xc) = *(int *)((longlong)plVar6 + 0xc) + 1;
        }
      }
      else {
        *(byte *)(plVar6 + 1) = *(byte *)(plVar6 + 1) | 0x80;
      }
      local_b8 = uVar1 + 1;
    }
    FUN_1800241e8(0xb);
    uVar4 = 0;
  }
  return uVar4;
}



void FUN_180022e60(void)

{
  ulonglong uVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong *puVar4;
  
  puVar4 = &DAT_180049240;
  lVar3 = 0x40;
  do {
    uVar2 = *puVar4;
    uVar1 = uVar2;
    if (uVar2 != 0) {
      for (; uVar2 < uVar1 + 0xb00; uVar2 = uVar2 + 0x58) {
        if (*(int *)(uVar2 + 0xc) != 0) {
          DeleteCriticalSection((LPCRITICAL_SECTION)(uVar2 + 0x10));
        }
        uVar1 = *puVar4;
      }
      FUN_18001d45c((LPVOID)*puVar4);
      *puVar4 = 0;
    }
    puVar4 = puVar4 + 1;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180022ed4(void)

{
  ulonglong uVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  byte *pbVar4;
  ulonglong uVar5;
  int local_res8 [2];
  int local_res10 [2];
  
  if (DAT_18004b0a8 == 0) {
    FUN_180024578();
  }
  DAT_180049544 = 0;
  GetModuleFileNameA((HMODULE)0x0,&DAT_180049440,0x104);
  _DAT_180048c50 = &DAT_180049440;
  if ((DAT_18004b0b0 == (byte *)0x0) || (pbVar4 = DAT_18004b0b0, *DAT_18004b0b0 == 0)) {
    pbVar4 = &DAT_180049440;
  }
  FUN_180022fc8(pbVar4,(undefined8 *)0x0,(byte *)0x0,local_res8,local_res10);
  uVar5 = (ulonglong)local_res8[0];
  if ((((uVar5 < 0x1fffffffffffffff) &&
       (uVar3 = (ulonglong)local_res10[0], uVar3 != 0xffffffffffffffff)) &&
      (uVar1 = uVar3 + uVar5 * 8, uVar3 <= uVar1)) &&
     (puVar2 = (undefined8 *)FUN_18001f6d4(uVar1), puVar2 != (undefined8 *)0x0)) {
    FUN_180022fc8(pbVar4,puVar2,(byte *)(puVar2 + uVar5),local_res8,local_res10);
    _DAT_180048c2c = local_res8[0] + -1;
    DAT_180048c30 = puVar2;
    return 0;
  }
  return 0xffffffff;
}



void FUN_180022fc8(byte *param_1,undefined8 *param_2,byte *param_3,int *param_4,int *param_5)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  uint uVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte bVar7;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (undefined8 *)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  bVar2 = false;
  do {
    if (*param_1 == 0x22) {
      bVar2 = !bVar2;
      bVar7 = 0x22;
      pbVar5 = param_1 + 1;
    }
    else {
      *param_5 = *param_5 + 1;
      if (param_3 != (byte *)0x0) {
        *param_3 = *param_1;
        param_3 = param_3 + 1;
      }
      bVar7 = *param_1;
      pbVar5 = param_1 + 1;
      iVar3 = FUN_1800265ac((uint)bVar7);
      if (iVar3 != 0) {
        *param_5 = *param_5 + 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        pbVar5 = param_1 + 2;
      }
      if (bVar7 == 0) {
        pbVar5 = pbVar5 + -1;
        goto LAB_18002307a;
      }
    }
    param_1 = pbVar5;
  } while ((bVar2) || ((bVar7 != 0x20 && (bVar7 != 9))));
  if (param_3 != (byte *)0x0) {
    param_3[-1] = 0;
  }
LAB_18002307a:
  bVar2 = false;
  while (pbVar6 = pbVar5, *pbVar5 != 0) {
    for (; (*pbVar6 == 0x20 || (*pbVar6 == 9)); pbVar6 = pbVar6 + 1) {
    }
    if (*pbVar6 == 0) break;
    if (param_2 != (undefined8 *)0x0) {
      *param_2 = param_3;
      param_2 = param_2 + 1;
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      bVar1 = true;
      uVar4 = 0;
      for (; *pbVar6 == 0x5c; pbVar6 = pbVar6 + 1) {
        uVar4 = uVar4 + 1;
      }
      pbVar5 = pbVar6;
      if (*pbVar6 == 0x22) {
        if (((uVar4 & 1) == 0) && ((!bVar2 || (pbVar5 = pbVar6 + 1, *pbVar5 != 0x22)))) {
          bVar1 = false;
          bVar2 = !bVar2;
          pbVar5 = pbVar6;
        }
        uVar4 = uVar4 >> 1;
      }
      while (uVar4 != 0) {
        uVar4 = uVar4 - 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = 0x5c;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      bVar7 = *pbVar5;
      if ((bVar7 == 0) || ((!bVar2 && ((bVar7 == 0x20 || (bVar7 == 9)))))) break;
      if (bVar1) {
        iVar3 = FUN_1800265ac((int)(char)bVar7);
        if (param_3 == (byte *)0x0) {
          if (iVar3 != 0) {
            pbVar5 = pbVar5 + 1;
            *param_5 = *param_5 + 1;
          }
        }
        else {
          if (iVar3 != 0) {
            bVar7 = *pbVar5;
            pbVar5 = pbVar5 + 1;
            *param_3 = bVar7;
            param_3 = param_3 + 1;
            *param_5 = *param_5 + 1;
          }
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      pbVar6 = pbVar5 + 1;
    }
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    *param_5 = *param_5 + 1;
  }
  if (param_2 != (undefined8 *)0x0) {
    *param_2 = 0;
  }
  *param_4 = *param_4 + 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180023190(void)

{
  char cVar1;
  code *pcVar2;
  DWORD DVar3;
  char *pcVar4;
  undefined1 *puVar5;
  undefined8 uVar6;
  ulonglong *puVar7;
  int iVar8;
  undefined8 *puVar9;
  
  if (DAT_18004b0a8 == 0) {
    FUN_180024578();
  }
  iVar8 = 0;
  puVar7 = DAT_180048c10;
  if (DAT_180048c10 != (ulonglong *)0x0) {
    for (; (char)*puVar7 != '\0'; puVar7 = (ulonglong *)(pcVar4 + (longlong)puVar7 + 1)) {
      if ((char)*puVar7 != '=') {
        iVar8 = iVar8 + 1;
      }
      pcVar4 = FUN_180023f50(puVar7);
    }
    DAT_180048c40 = (undefined8 *)FUN_18001f654((longlong)(iVar8 + 1),8);
    if (DAT_180048c40 != (undefined8 *)0x0) {
      cVar1 = (char)*DAT_180048c10;
      puVar9 = DAT_180048c40;
      puVar7 = DAT_180048c10;
      do {
        if (cVar1 == '\0') {
          FUN_18001d45c(DAT_180048c10);
          DAT_180048c10 = (ulonglong *)0x0;
          *puVar9 = 0;
          _DAT_18004b0ac = 1;
          return 0;
        }
        pcVar4 = FUN_180023f50(puVar7);
        iVar8 = (int)pcVar4 + 1;
        if ((char)*puVar7 != '=') {
          puVar5 = (undefined1 *)FUN_18001f654((longlong)iVar8,1);
          *puVar9 = puVar5;
          if (puVar5 == (undefined1 *)0x0) {
            FUN_18001d45c(DAT_180048c40);
            DAT_180048c40 = (undefined8 *)0x0;
            return 0xffffffff;
          }
          DVar3 = FUN_18001de48(puVar5,(longlong)iVar8,(char *)puVar7);
          if (DVar3 != 0) {
            FUN_18001fff8();
            pcVar2 = (code *)swi(3);
            uVar6 = (*pcVar2)();
            return uVar6;
          }
          puVar9 = puVar9 + 1;
        }
        puVar7 = (ulonglong *)((longlong)puVar7 + (longlong)iVar8);
        cVar1 = (char)*puVar7;
      } while( true );
    }
  }
  return 0xffffffff;
}



void FUN_1800232c4(void)

{
  DWORD DVar1;
  _FILETIME local_res8;
  _FILETIME local_res10;
  LARGE_INTEGER local_res18;
  
  local_res10.dwLowDateTime = 0;
  local_res10.dwHighDateTime = 0;
  if (DAT_1800461a0 == 0x2b992ddfa232) {
    GetSystemTimeAsFileTime(&local_res10);
    local_res8 = local_res10;
    DVar1 = GetCurrentThreadId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    DVar1 = GetCurrentProcessId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    QueryPerformanceCounter(&local_res18);
    DAT_1800461a0 =
         ((ulonglong)local_res18.s.LowPart << 0x20 ^
          CONCAT44(local_res18.s.HighPart,local_res18.s.LowPart) ^ (ulonglong)local_res8 ^
         (ulonglong)&local_res8) & 0xffffffffffff;
    if (DAT_1800461a0 == 0x2b992ddfa232) {
      DAT_1800461a0 = 0x2b992ddfa233;
    }
  }
  DAT_1800461a8 = ~DAT_1800461a0;
  return;
}



LPSTR FUN_180023370(void)

{
  WCHAR WVar1;
  int cbMultiByte;
  int iVar2;
  LPWCH lpWideCharStr;
  LPSTR lpMultiByteStr;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  
  lpWideCharStr = GetEnvironmentStringsW();
  if (lpWideCharStr != (LPWCH)0x0) {
    WVar1 = *lpWideCharStr;
    pWVar3 = lpWideCharStr;
    while (WVar1 != L'\0') {
      do {
        pWVar4 = pWVar3;
        pWVar3 = pWVar4 + 1;
      } while (*pWVar3 != L'\0');
      pWVar3 = pWVar4 + 2;
      WVar1 = *pWVar3;
    }
    iVar2 = (int)((longlong)pWVar3 - (longlong)lpWideCharStr >> 1);
    cbMultiByte = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,(LPSTR)0x0,0,(LPCSTR)0x0,
                                      (LPBOOL)0x0);
    if ((cbMultiByte != 0) &&
       (lpMultiByteStr = (LPSTR)FUN_18001f6d4((longlong)cbMultiByte), lpMultiByteStr != (LPSTR)0x0))
    {
      iVar2 = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,lpMultiByteStr,cbMultiByte,(LPCSTR)0x0
                                  ,(LPBOOL)0x0);
      if (iVar2 == 0) {
        FUN_18001d45c(lpMultiByteStr);
        lpMultiByteStr = (LPSTR)0x0;
      }
      FreeEnvironmentStringsW(lpWideCharStr);
      return lpMultiByteStr;
    }
    FreeEnvironmentStringsW(lpWideCharStr);
  }
  return (LPSTR)0x0;
}



void FUN_180023464(PCONTEXT param_1)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18;
  
  RtlCaptureContext();
  ControlPc = param_1->Rip;
  FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
  if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,&local_res18,&local_res10,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
  }
  return;
}



void FUN_1800234d4(PCONTEXT param_1)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  int iVar1;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18 [2];
  
  RtlCaptureContext();
  ControlPc = param_1->Rip;
  iVar1 = 0;
  do {
    FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    if (FunctionEntry == (PRUNTIME_FUNCTION)0x0) {
      return;
    }
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,local_res18,&local_res10,
                     (PKNONVOLATILE_CONTEXT_POINTERS)0x0);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 2);
  return;
}



void FUN_180023548(void)

{
  if ((code *)(DAT_18004af80 ^ DAT_1800461a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180023558. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004af80 ^ DAT_1800461a0))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002355b. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsAlloc();
  return;
}



void FUN_180023564(void)

{
  if ((code *)(DAT_18004af88 ^ DAT_1800461a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180023574. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004af88 ^ DAT_1800461a0))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180023577. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsFree();
  return;
}



void FUN_180023580(void)

{
  if ((code *)(DAT_18004af90 ^ DAT_1800461a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180023590. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004af90 ^ DAT_1800461a0))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180023593. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsGetValue();
  return;
}



void FUN_18002359c(void)

{
  if ((code *)(DAT_18004af98 ^ DAT_1800461a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800235ac. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004af98 ^ DAT_1800461a0))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800235af. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsSetValue();
  return;
}



undefined8 FUN_1800235b8(LPCRITICAL_SECTION param_1,DWORD param_2)

{
  undefined8 uVar1;
  
  if ((code *)(DAT_18004afa0 ^ DAT_1800461a0) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800235d0. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*(code *)(DAT_18004afa0 ^ DAT_1800461a0))();
    return uVar1;
  }
  InitializeCriticalSectionAndSpinCount(param_1,param_2);
  return 1;
}



bool FUN_1800235e4(void)

{
  int iVar1;
  bool bVar2;
  undefined4 local_res8 [8];
  
  bVar2 = DAT_1800463a8 < 0;
  if (!bVar2) goto LAB_180023625;
  local_res8[0] = 0;
  if ((code *)(DAT_18004b068 ^ DAT_1800461a0) == (code *)0x0) {
LAB_18002361b:
    DAT_1800463a8 = 0;
  }
  else {
    iVar1 = (*(code *)(DAT_18004b068 ^ DAT_1800461a0))(local_res8,0);
    DAT_1800463a8 = 1;
    if (iVar1 != 0x7a) goto LAB_18002361b;
  }
  bVar2 = false;
LAB_180023625:
  return DAT_1800463a8 != 0 && !bVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180023630(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  
  hModule = GetModuleHandleW(L"kernel32.dll");
  pFVar1 = GetProcAddress(hModule,"FlsAlloc");
  DAT_18004af80 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"FlsFree");
  DAT_18004af88 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"FlsGetValue");
  DAT_18004af90 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"FlsSetValue");
  DAT_18004af98 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"InitializeCriticalSectionEx");
  DAT_18004afa0 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"CreateEventExW");
  _DAT_18004afa8 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"CreateSemaphoreExW");
  _DAT_18004afb0 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"SetThreadStackGuarantee");
  _DAT_18004afb8 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"CreateThreadpoolTimer");
  _DAT_18004afc0 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"SetThreadpoolTimer");
  _DAT_18004afc8 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"WaitForThreadpoolTimerCallbacks");
  _DAT_18004afd0 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"CloseThreadpoolTimer");
  _DAT_18004afd8 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"CreateThreadpoolWait");
  _DAT_18004afe0 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"SetThreadpoolWait");
  _DAT_18004afe8 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"CloseThreadpoolWait");
  _DAT_18004aff0 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"FlushProcessWriteBuffers");
  _DAT_18004aff8 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"FreeLibraryWhenCallbackReturns");
  _DAT_18004b000 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"GetCurrentProcessorNumber");
  _DAT_18004b008 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"GetLogicalProcessorInformation");
  _DAT_18004b010 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"CreateSymbolicLinkW");
  _DAT_18004b018 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"SetDefaultDllDirectories");
  _DAT_18004b020 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"EnumSystemLocalesEx");
  _DAT_18004b030 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"CompareStringEx");
  _DAT_18004b028 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"GetDateFormatEx");
  _DAT_18004b038 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"GetLocaleInfoEx");
  _DAT_18004b040 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"GetTimeFormatEx");
  _DAT_18004b048 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"GetUserDefaultLocaleName");
  _DAT_18004b050 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"IsValidLocaleName");
  _DAT_18004b058 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"LCMapStringEx");
  DAT_18004b060 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"GetCurrentPackageId");
  DAT_18004b068 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"GetTickCount64");
  _DAT_18004b070 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"GetFileInformationByHandleExW");
  _DAT_18004b078 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  pFVar1 = GetProcAddress(hModule,"SetFileInformationByHandleW");
  _DAT_18004b080 = (ulonglong)pFVar1 ^ DAT_1800461a0;
  return;
}



void __stdcall Sleep(DWORD dwMilliseconds)

{
                    // WARNING: Could not recover jumptable at 0x000180023a2c. Too many branches
                    // WARNING: Treating indirect jump as call
  Sleep(dwMilliseconds);
  return;
}



void FUN_180023a34(undefined4 param_1)

{
  HANDLE pvVar1;
  
  pvVar1 = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x000180023a4c. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess(pvVar1,param_1);
  return;
}



void FUN_180023a54(undefined8 param_1)

{
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
                    // WARNING: Could not recover jumptable at 0x000180023a6d. Too many branches
                    // WARNING: Treating indirect jump as call
  UnhandledExceptionFilter(param_1);
  return;
}



void FUN_180023a74(void)

{
  undefined8 *puVar1;
  
  for (puVar1 = &DAT_180041558; puVar1 < &DAT_180041558; puVar1 = puVar1 + 1) {
    if ((code *)*puVar1 != (code *)0x0) {
      (*(code *)*puVar1)();
    }
  }
  return;
}



void FUN_180023aac(void)

{
  undefined8 *puVar1;
  
  for (puVar1 = &DAT_180041568; puVar1 < &DAT_180041568; puVar1 = puVar1 + 1) {
    if ((code *)*puVar1 != (code *)0x0) {
      (*(code *)*puVar1)();
    }
  }
  return;
}



LPVOID FUN_180023ae4(LPVOID param_1,ulonglong param_2)

{
  DWORD DVar1;
  LPVOID pvVar2;
  undefined8 uVar3;
  DWORD *pDVar4;
  
  if (param_1 == (LPVOID)0x0) {
    pvVar2 = FUN_18001ed60(param_2);
  }
  else {
    if (param_2 == 0) {
      FUN_18001d45c(param_1);
    }
    else {
      if (param_2 < 0xffffffffffffffe1) {
        do {
          if (param_2 == 0) {
            param_2 = 1;
          }
          pvVar2 = HeapReAlloc(DAT_180048c88,0,param_1,param_2);
          if (pvVar2 != (LPVOID)0x0) {
            return pvVar2;
          }
          if (DAT_180049b88 == 0) {
            pDVar4 = FUN_18001fa28();
            DVar1 = GetLastError();
            DVar1 = FUN_18001fa48(DVar1);
            *pDVar4 = DVar1;
            return (LPVOID)0x0;
          }
          uVar3 = FUN_18001effc(param_2);
          if ((int)uVar3 == 0) {
            pDVar4 = FUN_18001fa28();
            DVar1 = GetLastError();
            DVar1 = FUN_18001fa48(DVar1);
            *pDVar4 = DVar1;
            goto LAB_180023b70;
          }
        } while (param_2 < 0xffffffffffffffe1);
      }
      FUN_18001effc(param_2);
      pDVar4 = FUN_18001fa28();
      *pDVar4 = 0xc;
    }
LAB_180023b70:
    pvVar2 = (LPVOID)0x0;
  }
  return pvVar2;
}



void FUN_180023bb8(void)

{
  int iVar1;
  
  iVar1 = FUN_180026730(3);
  if (iVar1 != 1) {
    iVar1 = FUN_180026730(3);
    if (iVar1 != 0) {
      return;
    }
    if (DAT_180049550 != 1) {
      return;
    }
  }
  FUN_180023c2c(0xfc);
  FUN_180023c2c(0xff);
  return;
}



undefined * FUN_180023bfc(int param_1)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = &DAT_18002f960;
  do {
    if (param_1 == *piVar2) {
      return (&PTR_u_R6002___floating_point_support_n_18002f968)[(longlong)(int)uVar1 * 2];
    }
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 4;
  } while (uVar1 < 0x17);
  return (undefined *)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180023c2c(int param_1)

{
  code *pcVar1;
  int iVar2;
  DWORD DVar3;
  short *psVar4;
  longlong lVar5;
  HANDLE hFile;
  char *pcVar6;
  ulonglong *puVar7;
  uint uVar8;
  undefined1 auStackY_268 [32];
  DWORD local_238 [4];
  ulonglong local_228 [62];
  undefined1 local_35;
  ulonglong local_28;
  
  local_28 = DAT_1800461a0 ^ (ulonglong)auStackY_268;
  psVar4 = (short *)FUN_180023bfc(param_1);
  uVar8 = 0;
  if (psVar4 != (short *)0x0) {
    iVar2 = FUN_180026730(3);
    if (iVar2 != 1) {
      iVar2 = FUN_180026730(3);
      if ((iVar2 != 0) || (DAT_180049550 != 1)) {
        if (param_1 != 0xfc) {
          iVar2 = FUN_18001deac((undefined2 *)&DAT_180049560,0x314,L"Runtime Error!\n\nProgram: ");
          if (iVar2 != 0) {
            FUN_18001fff8();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          _DAT_18004979a = 0;
          DVar3 = GetModuleFileNameW((HMODULE)0x0,(LPWSTR)&DAT_180049592,0x104);
          if (DVar3 == 0) {
            iVar2 = FUN_18001deac((undefined2 *)&DAT_180049592,0x2fb,L"<program name unknown>");
            if (iVar2 != 0) {
              FUN_18001fff8();
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          lVar5 = FUN_180026648((short *)&DAT_180049592);
          if (0x3c < lVar5 + 1U) {
            lVar5 = FUN_180026648((short *)&DAT_180049592);
            iVar2 = FUN_180026664((short *)(&DAT_18004951c + lVar5 * 2),
                                  0x2fb - (lVar5 * 2 + -0x76 >> 1),(short *)&DAT_180030468,3);
            if (iVar2 != 0) {
              FUN_18001fff8();
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          iVar2 = FUN_1800265c0((short *)&DAT_180049560,0x314,(short *)&DAT_180030470);
          if (iVar2 != 0) {
            FUN_18001fff8();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          iVar2 = FUN_1800265c0((short *)&DAT_180049560,0x314,psVar4);
          if (iVar2 != 0) {
            FUN_18001fff8();
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          FUN_180026770((LPCWSTR)&DAT_180049560,L"Microsoft Visual C++ Runtime Library",0x12010);
        }
        goto LAB_180023e07;
      }
    }
    hFile = GetStdHandle(0xfffffff4);
    if ((longlong)hFile - 1U < 0xfffffffffffffffe) {
      puVar7 = local_228;
      do {
        *(char *)puVar7 = (char)*psVar4;
        if (*psVar4 == 0) break;
        uVar8 = uVar8 + 1;
        puVar7 = (ulonglong *)((longlong)puVar7 + 1);
        psVar4 = psVar4 + 1;
      } while (uVar8 < 500);
      local_35 = 0;
      pcVar6 = FUN_180023f50(local_228);
      WriteFile(hFile,local_228,(DWORD)pcVar6,local_238,(LPOVERLAPPED)0x0);
    }
  }
LAB_180023e07:
  FUN_18001d530(local_28 ^ (ulonglong)auStackY_268);
  return;
}



LPVOID FUN_180023e9c(ulonglong param_1,ulonglong param_2,undefined4 *param_3)

{
  DWORD *pDVar1;
  LPVOID pvVar2;
  undefined8 uVar3;
  ulonglong dwBytes;
  
  if ((param_1 == 0) || (param_2 <= 0xffffffffffffffe0 / param_1)) {
    dwBytes = param_2 * param_1;
    if (dwBytes == 0) {
      dwBytes = 1;
    }
    do {
      pvVar2 = (LPVOID)0x0;
      if ((dwBytes < 0xffffffffffffffe1) &&
         (pvVar2 = HeapAlloc(DAT_180048c88,8,dwBytes), pvVar2 != (LPVOID)0x0)) {
        return pvVar2;
      }
      if (DAT_180049b88 == 0) {
        if (param_3 == (undefined4 *)0x0) {
          return pvVar2;
        }
        *param_3 = 0xc;
        return pvVar2;
      }
      uVar3 = FUN_18001effc(dwBytes);
    } while ((int)uVar3 != 0);
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = 0xc;
    }
  }
  else {
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 0xc;
  }
  return (LPVOID)0x0;
}



char * FUN_180023f50(ulonglong *param_1)

{
  ulonglong uVar1;
  ulonglong *puVar2;
  longlong lVar3;
  
  lVar3 = -(longlong)param_1;
  uVar1 = (ulonglong)param_1 & 7;
  while (uVar1 != 0) {
    uVar1 = *param_1;
    param_1 = (ulonglong *)((longlong)param_1 + 1);
    if ((char)uVar1 == '\0') goto LAB_180023fc8;
    uVar1 = (ulonglong)param_1 & 7;
  }
  do {
    do {
      puVar2 = param_1;
      param_1 = puVar2 + 1;
    } while (((~*puVar2 ^ *puVar2 + 0x7efefefefefefeff) & 0x8101010101010100) == 0);
    uVar1 = *puVar2;
    if ((char)uVar1 == '\0') {
      return (char *)(lVar3 + -8 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 8) == '\0') {
      return (char *)(lVar3 + -7 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x10) == '\0') {
      return (char *)(lVar3 + -6 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x18) == '\0') {
      return (char *)(lVar3 + -5 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x20) == '\0') {
      return (char *)(lVar3 + -4 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x28) == '\0') {
      return (char *)(lVar3 + -3 + (longlong)param_1);
    }
    if ((char)(uVar1 >> 0x30) == '\0') {
      return (char *)(lVar3 + -2 + (longlong)param_1);
    }
  } while ((char)(uVar1 >> 0x38) != '\0');
LAB_180023fc8:
  return (char *)(lVar3 + -1 + (longlong)param_1);
}



void FUN_180023ff8(int param_1)

{
  undefined8 uVar1;
  
  if ((&DAT_1800463b0)[(longlong)param_1 * 2] == 0) {
    uVar1 = FUN_1800240c4(param_1);
    if ((int)uVar1 == 0) {
      FUN_18001f2a4(0x11);
    }
  }
                    // WARNING: Could not recover jumptable at 0x000180024035. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(&DAT_1800463b0)[(longlong)param_1 * 2]);
  return;
}



void FUN_18002403c(void)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined8 *puVar1;
  int *piVar2;
  longlong lVar3;
  longlong lVar4;
  
  lVar4 = 0x24;
  puVar1 = &DAT_1800463b0;
  lVar3 = 0x24;
  do {
    lpCriticalSection = (LPCRITICAL_SECTION)*puVar1;
    if ((lpCriticalSection != (LPCRITICAL_SECTION)0x0) && (*(int *)(puVar1 + 1) != 1)) {
      DeleteCriticalSection(lpCriticalSection);
      FUN_18001d45c(lpCriticalSection);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 2;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  piVar2 = &DAT_1800463b8;
  do {
    if ((*(LPCRITICAL_SECTION *)(piVar2 + -2) != (LPCRITICAL_SECTION)0x0) && (*piVar2 == 1)) {
      DeleteCriticalSection(*(LPCRITICAL_SECTION *)(piVar2 + -2));
    }
    piVar2 = piVar2 + 4;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return;
}



undefined8 FUN_1800240c4(int param_1)

{
  LPCRITICAL_SECTION p_Var1;
  DWORD *pDVar2;
  longlong lVar3;
  
  lVar3 = (longlong)param_1;
  if (DAT_180048c88 == 0) {
    FUN_180023bb8();
    FUN_180023c2c(0x1e);
    FUN_18001f144(0xff);
  }
  if ((&DAT_1800463b0)[lVar3 * 2] == 0) {
    p_Var1 = (LPCRITICAL_SECTION)FUN_18001f6d4(0x28);
    if (p_Var1 == (LPCRITICAL_SECTION)0x0) {
      pDVar2 = FUN_18001fa28();
      *pDVar2 = 0xc;
      return 0;
    }
    FUN_180023ff8(10);
    if ((&DAT_1800463b0)[lVar3 * 2] == 0) {
      FUN_1800235b8(p_Var1,4000);
      (&DAT_1800463b0)[lVar3 * 2] = p_Var1;
    }
    else {
      FUN_18001d45c(p_Var1);
    }
    LeaveCriticalSection(DAT_180046450);
  }
  return 1;
}



undefined4 FUN_180024184(void)

{
  longlong lVar1;
  undefined8 *puVar2;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  puVar2 = &DAT_1800463b0;
  lVar4 = 0x24;
  do {
    if (*(int *)(puVar2 + 1) == 1) {
      lVar1 = (longlong)iVar3;
      iVar3 = iVar3 + 1;
      *puVar2 = (LPCRITICAL_SECTION)(&DAT_180049b90 + lVar1 * 0x28);
      FUN_1800235b8((LPCRITICAL_SECTION)(&DAT_180049b90 + lVar1 * 0x28),4000);
    }
    puVar2 = puVar2 + 2;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return 1;
}



void FUN_1800241e8(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x0001800241f9. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(&DAT_1800463b0)[(longlong)param_1 * 2]);
  return;
}



longlong FUN_180024200(longlong param_1,ulonglong param_2)

{
  longlong lVar1;
  longlong lVar2;
  uint uVar3;
  
  uVar3 = 0;
  lVar2 = *(int *)(param_1 + 0x3c) + param_1;
  lVar1 = (ulonglong)*(ushort *)(lVar2 + 0x14) + 0x18 + lVar2;
  if (*(ushort *)(lVar2 + 6) != 0) {
    do {
      if ((*(uint *)(lVar1 + 0xc) <= param_2) &&
         (param_2 < *(int *)(lVar1 + 8) + *(uint *)(lVar1 + 0xc))) {
        return lVar1;
      }
      uVar3 = uVar3 + 1;
      lVar1 = lVar1 + 0x28;
    } while (uVar3 < *(ushort *)(lVar2 + 6));
  }
  return 0;
}



ulonglong FUN_180024250(longlong param_1)

{
  bool bVar1;
  undefined7 extraout_var;
  ulonglong uVar2;
  
  bVar1 = FUN_1800242a0((short *)&IMAGE_DOS_HEADER_180000000);
  uVar2 = CONCAT71(extraout_var,bVar1);
  if ((int)uVar2 != 0) {
    uVar2 = FUN_180024200(0x180000000,param_1 - 0x180000000);
    if (uVar2 != 0) {
      uVar2 = (ulonglong)(~(*(uint *)(uVar2 + 0x24) >> 0x1f) & 1);
    }
  }
  return uVar2;
}



bool FUN_1800242a0(short *param_1)

{
  bool bVar1;
  
  if (*param_1 != 0x5a4d) {
    return false;
  }
  bVar1 = false;
  if (*(int *)((longlong)*(int *)(param_1 + 0x1e) + (longlong)param_1) == 0x4550) {
    bVar1 = (short)((int *)((longlong)*(int *)(param_1 + 0x1e) + (longlong)param_1))[6] == 0x20b;
  }
  return bVar1;
}



void FUN_1800242d0(void)

{
  undefined *puVar1;
  undefined **ppuVar2;
  uint uVar3;
  
  uVar3 = 0;
  ppuVar2 = &PTR_LAB_1800465f0;
  do {
    puVar1 = (undefined *)EncodePointer(*ppuVar2);
    uVar3 = uVar3 + 1;
    *ppuVar2 = puVar1;
    ppuVar2 = ppuVar2 + 1;
  } while (uVar3 < 10);
  return;
}



void FUN_18002430c(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024313. Too many branches
                    // WARNING: Treating indirect jump as call
  DecodePointer(DAT_180049dd0);
  return;
}



void FUN_18002431c(undefined8 param_1)

{
  DAT_180049dc0 = param_1;
  DAT_180049dc8 = param_1;
  DAT_180049dd0 = param_1;
  DAT_180049dd8 = param_1;
  return;
}



undefined8 FUN_18002433c(uint param_1)

{
  ulonglong uVar1;
  bool bVar2;
  DWORD *pDVar3;
  code *pcVar4;
  undefined8 uVar5;
  PVOID pvVar6;
  ulonglong uVar7;
  int iVar8;
  undefined8 *puVar9;
  DWORD local_res10;
  
  uVar5 = 0;
  local_res10 = 0;
  bVar2 = false;
  pDVar3 = (DWORD *)0x0;
  if (param_1 == 2) {
    puVar9 = &DAT_180049dc0;
    pvVar6 = DAT_180049dc0;
    goto LAB_180024442;
  }
  if (param_1 == 4) {
LAB_1800243d7:
    pDVar3 = FUN_180021154();
    if (pDVar3 == (DWORD *)0x0) {
      return 0xffffffff;
    }
    uVar1 = *(ulonglong *)(pDVar3 + 0x28);
    uVar7 = uVar1;
    do {
      if (*(uint *)(uVar7 + 4) == param_1) break;
      uVar7 = uVar7 + 0x10;
    } while (uVar7 < uVar1 + 0xc0);
    if ((uVar1 + 0xc0 <= uVar7) || (*(uint *)(uVar7 + 4) != param_1)) {
      uVar7 = 0;
    }
    puVar9 = (undefined8 *)(uVar7 + 8);
    pcVar4 = (code *)*puVar9;
  }
  else {
    if (param_1 == 6) {
LAB_1800243c7:
      puVar9 = &DAT_180049dd0;
      pvVar6 = DAT_180049dd0;
    }
    else {
      if ((param_1 == 8) || (param_1 == 0xb)) goto LAB_1800243d7;
      if (param_1 == 0xf) {
        puVar9 = &DAT_180049dd8;
        pvVar6 = DAT_180049dd8;
      }
      else {
        if (param_1 != 0x15) {
          if (param_1 != 0x16) {
            pDVar3 = FUN_18001fa28();
            *pDVar3 = 0x16;
            FUN_18001ffd8();
            return 0xffffffff;
          }
          goto LAB_1800243c7;
        }
        puVar9 = &DAT_180049dc8;
        pvVar6 = DAT_180049dc8;
      }
    }
LAB_180024442:
    bVar2 = true;
    pcVar4 = (code *)DecodePointer(pvVar6);
  }
  if (pcVar4 == (code *)0x1) {
    return 0;
  }
  if (pcVar4 == (code *)0x0) {
    FUN_18001f374(3);
    pcVar4 = (code *)swi(3);
    uVar5 = (*pcVar4)();
    return uVar5;
  }
  if (bVar2) {
    FUN_180023ff8(0);
  }
  if ((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) {
    uVar5 = *(undefined8 *)(pDVar3 + 0x2a);
    pDVar3[0x2a] = 0;
    pDVar3[0x2b] = 0;
    if (param_1 == 8) {
      local_res10 = pDVar3[0x2c];
      pDVar3[0x2c] = 0x8c;
      goto LAB_1800244ba;
    }
  }
  else {
LAB_1800244ba:
    if (param_1 == 8) {
      for (iVar8 = 3; iVar8 < 0xc; iVar8 = iVar8 + 1) {
        *(undefined8 *)(*(longlong *)(pDVar3 + 0x28) + 8 + (longlong)iVar8 * 0x10) = 0;
      }
      goto LAB_180024503;
    }
  }
  pvVar6 = EncodePointer((PVOID)0x0);
  *puVar9 = pvVar6;
LAB_180024503:
  if (bVar2) {
    FUN_1800241e8(0);
  }
  if (param_1 == 8) {
    (*pcVar4)(8,pDVar3[0x2c]);
  }
  else {
    (*pcVar4)(param_1);
  }
  if (((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) &&
     (*(undefined8 *)(pDVar3 + 0x2a) = uVar5, param_1 == 8)) {
    pDVar3[0x2c] = local_res10;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180024570(undefined8 param_1)

{
  _DAT_180049de8 = param_1;
  return;
}



undefined8 FUN_180024578(void)

{
  if (DAT_18004b0a8 == 0) {
    FUN_180024950(0xfffffffd);
    DAT_18004b0a8 = 1;
  }
  return 0;
}



UINT FUN_1800245a0(UINT param_1)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_1800201c0(local_28,(longlong *)0x0);
  DAT_180049e10 = 0;
  if (param_1 == 0xfffffffe) {
    DAT_180049e10 = 1;
    param_1 = GetOEMCP();
  }
  else if (param_1 == 0xfffffffd) {
    DAT_180049e10 = 1;
    param_1 = GetACP();
  }
  else if (param_1 == 0xfffffffc) {
    DAT_180049e10 = 1;
    param_1 = *(UINT *)(local_28[0] + 4);
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return param_1;
}



void FUN_180024620(longlong param_1)

{
  longlong lVar1;
  undefined1 *puVar2;
  undefined1 (*pauVar3) [16];
  longlong lVar4;
  undefined2 *puVar5;
  
  pauVar3 = (undefined1 (*) [16])(param_1 + 0x18);
  lVar4 = 0x101;
  FUN_18001dbc0(pauVar3,0,0x101);
  *(undefined8 *)(param_1 + 4) = 0;
  *(undefined8 *)(param_1 + 0x220) = 0;
  puVar5 = (undefined2 *)(param_1 + 0xc);
  for (lVar1 = 6; lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  do {
    (*pauVar3)[0] = *(undefined1 *)(((longlong)&DAT_180046850 - param_1) + (longlong)pauVar3);
    pauVar3 = (undefined1 (*) [16])(*pauVar3 + 1);
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  puVar2 = (undefined1 *)(param_1 + 0x119);
  lVar1 = 0x100;
  do {
    *puVar2 = puVar2[(longlong)&DAT_180046850 - param_1];
    puVar2 = puVar2 + 1;
    lVar1 = lVar1 + -1;
  } while (lVar1 != 0);
  return;
}



void FUN_1800246b0(longlong param_1)

{
  byte bVar1;
  BOOL BVar2;
  uint uVar3;
  CHAR *pCVar4;
  ulonglong uVar5;
  byte *pbVar6;
  BYTE *pBVar7;
  WORD *pWVar8;
  longlong lVar9;
  undefined1 auStackY_588 [32];
  _cpinfo local_538;
  CHAR local_518 [231];
  byte abStack_431 [25];
  undefined1 local_418 [231];
  byte abStack_331 [25];
  undefined1 local_318 [256];
  WORD local_218 [256];
  ulonglong local_18;
  
  local_18 = DAT_1800461a0 ^ (ulonglong)auStackY_588;
  BVar2 = GetCPInfo(*(UINT *)(param_1 + 4),&local_538);
  lVar9 = 0x100;
  if (BVar2 == 0) {
    uVar3 = 0;
    pbVar6 = (byte *)(param_1 + 0x19);
    do {
      if (uVar3 - 0x41 < 0x1a) {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = (char)uVar3 + 0x20;
LAB_180024855:
        pbVar6[0x100] = bVar1;
      }
      else {
        if (uVar3 - 0x61 < 0x1a) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = (char)uVar3 - 0x20;
          goto LAB_180024855;
        }
        pbVar6[0x100] = 0;
      }
      uVar3 = uVar3 + 1;
      pbVar6 = pbVar6 + 1;
    } while (uVar3 < 0x100);
  }
  else {
    uVar3 = 0;
    pCVar4 = local_518;
    do {
      *pCVar4 = (CHAR)uVar3;
      uVar3 = uVar3 + 1;
      pCVar4 = pCVar4 + 1;
    } while (uVar3 < 0x100);
    local_518[0] = ' ';
    pBVar7 = local_538.LeadByte;
    while (local_538.LeadByte[0] != 0) {
      bVar1 = pBVar7[1];
      uVar5 = (ulonglong)local_538.LeadByte[0];
      while ((uVar3 = (uint)uVar5, uVar3 <= bVar1 && (uVar3 < 0x100))) {
        local_518[uVar5] = ' ';
        uVar5 = (ulonglong)(uVar3 + 1);
      }
      pBVar7 = pBVar7 + 2;
      local_538.LeadByte[0] = *pBVar7;
    }
    FUN_180026eec((longlong *)0x0,1,local_518,0x100,local_218,*(UINT *)(param_1 + 4),0);
    FUN_180026cdc((longlong *)0x0,*(longlong *)(param_1 + 0x220),0x100,local_518,0x100,local_418,
                  0x100,*(UINT *)(param_1 + 4),0);
    FUN_180026cdc((longlong *)0x0,*(longlong *)(param_1 + 0x220),0x200,local_518,0x100,local_318,
                  0x100,*(UINT *)(param_1 + 4),0);
    pWVar8 = local_218;
    pbVar6 = (byte *)(param_1 + 0x19);
    do {
      if ((*pWVar8 & 1) == 0) {
        if ((*pWVar8 & 2) != 0) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = pbVar6[(longlong)(abStack_331 + -param_1)];
          goto LAB_180024811;
        }
        pbVar6[0x100] = 0;
      }
      else {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = pbVar6[(longlong)(abStack_431 + -param_1)];
LAB_180024811:
        pbVar6[0x100] = bVar1;
      }
      pbVar6 = pbVar6 + 1;
      pWVar8 = pWVar8 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
  }
  FUN_18001d530(local_18 ^ (ulonglong)auStackY_588);
  return;
}



int * FUN_180024894(void)

{
  DWORD *pDVar1;
  int *piVar2;
  
  pDVar1 = FUN_180021130();
  if (((pDVar1[0x32] & DAT_180047378) == 0) || (*(longlong *)(pDVar1 + 0x30) == 0)) {
    FUN_180023ff8(0xd);
    piVar2 = *(int **)(pDVar1 + 0x2e);
    if (piVar2 != (int *)PTR_DAT_180046b70) {
      if (piVar2 != (int *)0x0) {
        LOCK();
        *piVar2 = *piVar2 + -1;
        UNLOCK();
        if ((*piVar2 == 0) && (piVar2 != &DAT_180046850)) {
          FUN_18001d45c(piVar2);
        }
      }
      *(undefined **)(pDVar1 + 0x2e) = PTR_DAT_180046b70;
      piVar2 = (int *)PTR_DAT_180046b70;
      LOCK();
      *(int *)PTR_DAT_180046b70 = *(int *)PTR_DAT_180046b70 + 1;
      UNLOCK();
    }
    FUN_1800241e8(0xd);
  }
  else {
    piVar2 = *(int **)(pDVar1 + 0x2e);
  }
  if (piVar2 == (int *)0x0) {
    FUN_18001f2a4(0x20);
  }
  return piVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_180024950(UINT param_1)

{
  int *piVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  UINT UVar4;
  int iVar5;
  DWORD *pDVar6;
  int *piVar7;
  undefined8 *puVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  longlong lVar12;
  int iVar13;
  
  iVar5 = -1;
  pDVar6 = FUN_180021130();
  FUN_180024894();
  lVar12 = *(longlong *)(pDVar6 + 0x2e);
  UVar4 = FUN_1800245a0(param_1);
  if (UVar4 == *(UINT *)(lVar12 + 4)) {
    iVar5 = 0;
  }
  else {
    piVar7 = (int *)FUN_18001f6d4(0x228);
    iVar13 = 0;
    if (piVar7 != (int *)0x0) {
      lVar12 = 4;
      puVar3 = *(undefined8 **)(pDVar6 + 0x2e);
      piVar1 = piVar7;
      do {
        piVar9 = piVar1;
        puVar8 = puVar3;
        uVar2 = puVar8[1];
        *(undefined8 *)piVar9 = *puVar8;
        *(undefined8 *)(piVar9 + 2) = uVar2;
        uVar2 = puVar8[3];
        *(undefined8 *)(piVar9 + 4) = puVar8[2];
        *(undefined8 *)(piVar9 + 6) = uVar2;
        uVar2 = puVar8[5];
        *(undefined8 *)(piVar9 + 8) = puVar8[4];
        *(undefined8 *)(piVar9 + 10) = uVar2;
        uVar2 = puVar8[7];
        *(undefined8 *)(piVar9 + 0xc) = puVar8[6];
        *(undefined8 *)(piVar9 + 0xe) = uVar2;
        uVar2 = puVar8[9];
        *(undefined8 *)(piVar9 + 0x10) = puVar8[8];
        *(undefined8 *)(piVar9 + 0x12) = uVar2;
        uVar2 = puVar8[0xb];
        *(undefined8 *)(piVar9 + 0x14) = puVar8[10];
        *(undefined8 *)(piVar9 + 0x16) = uVar2;
        uVar2 = puVar8[0xd];
        *(undefined8 *)(piVar9 + 0x18) = puVar8[0xc];
        *(undefined8 *)(piVar9 + 0x1a) = uVar2;
        uVar2 = puVar8[0xf];
        *(undefined8 *)(piVar9 + 0x1c) = puVar8[0xe];
        *(undefined8 *)(piVar9 + 0x1e) = uVar2;
        lVar12 = lVar12 + -1;
        puVar3 = puVar8 + 0x10;
        piVar1 = piVar9 + 0x20;
      } while (lVar12 != 0);
      uVar2 = puVar8[0x11];
      *(undefined8 *)(piVar9 + 0x20) = puVar8[0x10];
      *(undefined8 *)(piVar9 + 0x22) = uVar2;
      uVar2 = puVar8[0x13];
      *(undefined8 *)(piVar9 + 0x24) = puVar8[0x12];
      *(undefined8 *)(piVar9 + 0x26) = uVar2;
      *(undefined8 *)(piVar9 + 0x28) = puVar8[0x14];
      *piVar7 = 0;
      iVar5 = FUN_180024b94(UVar4,(longlong)piVar7);
      if (iVar5 == 0) {
        piVar1 = *(int **)(pDVar6 + 0x2e);
        LOCK();
        *piVar1 = *piVar1 + -1;
        UNLOCK();
        if ((*piVar1 == 0) && (*(undefined4 **)(pDVar6 + 0x2e) != &DAT_180046850)) {
          FUN_18001d45c(*(undefined4 **)(pDVar6 + 0x2e));
        }
        *(int **)(pDVar6 + 0x2e) = piVar7;
        LOCK();
        *piVar7 = *piVar7 + 1;
        UNLOCK();
        if (((pDVar6[0x32] & 2) == 0) && (((byte)DAT_180047378 & 1) == 0)) {
          FUN_180023ff8(0xd);
          _DAT_180049df0 = piVar7[1];
          _DAT_180049df4 = piVar7[2];
          _DAT_180049e08 = *(undefined8 *)(piVar7 + 0x88);
          for (iVar10 = iVar13; iVar11 = iVar13, iVar10 < 5; iVar10 = iVar10 + 1) {
            *(undefined2 *)(&DAT_180049df8 + (longlong)iVar10 * 2) =
                 *(undefined2 *)((longlong)piVar7 + (longlong)iVar10 * 2 + 0xc);
          }
          for (; iVar11 < 0x101; iVar11 = iVar11 + 1) {
            (&DAT_180046640)[iVar11] = *(undefined1 *)((longlong)iVar11 + 0x18 + (longlong)piVar7);
          }
          for (; iVar13 < 0x100; iVar13 = iVar13 + 1) {
            (&DAT_180046750)[iVar13] = *(undefined1 *)((longlong)iVar13 + 0x119 + (longlong)piVar7);
          }
          LOCK();
          iVar13 = *(int *)PTR_DAT_180046b70;
          *(int *)PTR_DAT_180046b70 = *(int *)PTR_DAT_180046b70 + -1;
          UNLOCK();
          if ((iVar13 == 1) && ((undefined4 *)PTR_DAT_180046b70 != &DAT_180046850)) {
            FUN_18001d45c(PTR_DAT_180046b70);
          }
          LOCK();
          PTR_DAT_180046b70 = (undefined *)piVar7;
          *piVar7 = *piVar7 + 1;
          UNLOCK();
          FUN_1800241e8(0xd);
        }
      }
      else if (iVar5 == -1) {
        if (piVar7 != &DAT_180046850) {
          FUN_18001d45c(piVar7);
        }
        pDVar6 = FUN_18001fa28();
        *pDVar6 = 0x16;
      }
    }
  }
  return iVar5;
}



void FUN_180024b94(UINT param_1,longlong param_2)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  UINT CodePage;
  BOOL BVar4;
  UINT *pUVar5;
  byte *pbVar6;
  wchar_t *pwVar7;
  ulonglong uVar8;
  longlong lVar9;
  undefined2 *puVar10;
  BYTE *pBVar11;
  byte *pbVar12;
  uint uVar13;
  uint uVar15;
  byte *pbVar16;
  undefined1 auStack_68 [32];
  _cpinfo local_48;
  ulonglong local_30;
  wchar_t *pwVar14;
  
  local_30 = DAT_1800461a0 ^ (ulonglong)auStack_68;
  CodePage = FUN_1800245a0(param_1);
  pwVar7 = (wchar_t *)0x0;
  if (CodePage != 0) {
    pUVar5 = &DAT_180046a80;
    pwVar14 = pwVar7;
LAB_180024be8:
    if (*pUVar5 != CodePage) goto code_r0x000180024bf0;
    FUN_18001dbc0((undefined1 (*) [16])(param_2 + 0x18),0,0x101);
    pbVar16 = &DAT_180046a78;
    lVar9 = 4;
    pbVar6 = &DAT_180046a90 + (longlong)pwVar14 * 0x30;
    do {
      bVar2 = *pbVar6;
      pbVar12 = pbVar6;
      while ((bVar2 != 0 && (pbVar12[1] != 0))) {
        bVar2 = *pbVar12;
        uVar13 = (uint)bVar2;
        if (bVar2 <= pbVar12[1]) {
          uVar15 = (uint)bVar2;
          do {
            uVar15 = uVar15 + 1;
            if (0x100 < uVar15) break;
            uVar13 = uVar13 + 1;
            pbVar1 = (byte *)((ulonglong)uVar15 + 0x18 + param_2);
            *pbVar1 = *pbVar1 | *pbVar16;
          } while (uVar13 <= pbVar12[1]);
        }
        pbVar12 = pbVar12 + 2;
        bVar2 = *pbVar12;
      }
      pbVar6 = pbVar6 + 8;
      pbVar16 = pbVar16 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
    *(UINT *)(param_2 + 4) = CodePage;
    *(undefined4 *)(param_2 + 8) = 1;
    if (CodePage == 0x3a4) {
      pwVar7 = L"ja-JP";
    }
    else if (CodePage == 0x3a8) {
      pwVar7 = L"zh-CN";
    }
    else if (CodePage == 0x3b5) {
      pwVar7 = L"ko-KR";
    }
    else if (CodePage == 0x3b6) {
      pwVar7 = L"zh-TW";
    }
    *(wchar_t **)(param_2 + 0x220) = pwVar7;
    puVar10 = (undefined2 *)(param_2 + 0xc);
    lVar9 = 6;
    do {
      *puVar10 = *(undefined2 *)
                  (&DAT_180046a78 + ((longlong)pwVar14 * 0x30 - param_2) + (longlong)puVar10);
      puVar10 = puVar10 + 1;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
    goto LAB_180024e12;
  }
LAB_180024bc9:
  FUN_180024620(param_2);
LAB_180024e1c:
  FUN_18001d530(local_30 ^ (ulonglong)auStack_68);
  return;
code_r0x000180024bf0:
  uVar13 = (int)pwVar14 + 1;
  pwVar14 = (wchar_t *)(ulonglong)uVar13;
  pUVar5 = pUVar5 + 0xc;
  if (4 < uVar13) goto code_r0x000180024bfc;
  goto LAB_180024be8;
code_r0x000180024bfc:
  if ((CodePage - 65000 < 2) || (BVar4 = IsValidCodePage(CodePage & 0xffff), BVar4 == 0))
  goto LAB_180024e1c;
  BVar4 = GetCPInfo(CodePage,&local_48);
  if (BVar4 != 0) {
    FUN_18001dbc0((undefined1 (*) [16])(param_2 + 0x18),0,0x101);
    *(UINT *)(param_2 + 4) = CodePage;
    *(undefined8 *)(param_2 + 0x220) = 0;
    if (local_48.MaxCharSize < 2) {
      *(undefined4 *)(param_2 + 8) = 0;
    }
    else {
      pBVar11 = local_48.LeadByte;
      while ((local_48.LeadByte[0] != 0 && (pBVar11[1] != 0))) {
        bVar2 = *pBVar11;
        if ((uint)bVar2 <= (uint)pBVar11[1]) {
          pbVar6 = (byte *)(param_2 + 0x18 + (ulonglong)(bVar2 + 1));
          uVar8 = (ulonglong)(((uint)pBVar11[1] - (uint)bVar2) + 1);
          do {
            *pbVar6 = *pbVar6 | 4;
            pbVar6 = pbVar6 + 1;
            uVar8 = uVar8 - 1;
          } while (uVar8 != 0);
        }
        pBVar11 = pBVar11 + 2;
        local_48.LeadByte[0] = *pBVar11;
      }
      pbVar6 = (byte *)(param_2 + 0x1a);
      lVar9 = 0xfe;
      do {
        *pbVar6 = *pbVar6 | 8;
        pbVar6 = pbVar6 + 1;
        lVar9 = lVar9 + -1;
      } while (lVar9 != 0);
      iVar3 = *(int *)(param_2 + 4);
      if (iVar3 == 0x3a4) {
        pwVar7 = L"ja-JP";
      }
      else if (iVar3 == 0x3a8) {
        pwVar7 = L"zh-CN";
      }
      else if (iVar3 == 0x3b5) {
        pwVar7 = L"ko-KR";
      }
      else if (iVar3 == 0x3b6) {
        pwVar7 = L"zh-TW";
      }
      *(wchar_t **)(param_2 + 0x220) = pwVar7;
      *(undefined4 *)(param_2 + 8) = 1;
    }
    puVar10 = (undefined2 *)(param_2 + 0xc);
    for (lVar9 = 6; lVar9 != 0; lVar9 = lVar9 + -1) {
      *puVar10 = 0;
      puVar10 = puVar10 + 1;
    }
LAB_180024e12:
    FUN_1800246b0(param_2);
    goto LAB_180024e1c;
  }
  if (DAT_180049e10 == 0) goto LAB_180024e1c;
  goto LAB_180024bc9;
}



void FUN_180024e60(PVOID param_1,PVOID param_2)

{
  RtlUnwindEx(param_1,param_2,(PEXCEPTION_RECORD)0x0,(PVOID)0x0,(PCONTEXT)&stack0xfffffffffffffb28,
              (PUNWIND_HISTORY_TABLE)0x0);
  return;
}



void FUN_180024e90(void)

{
  FUN_180024eb0();
  return;
}



void FUN_180024eb0(void)

{
  return;
}



void FUN_180024ec0(void)

{
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180024ec4(void)

{
  _DAT_18004af60 = 0;
  return;
}



undefined8 FUN_180024ecc(void)

{
  undefined **ppuVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar2 = 0;
  lVar3 = 0x14;
  if (DAT_180049f50 == 0) {
    DAT_180049f50 = 0x200;
  }
  else if (DAT_180049f50 < 0x14) {
    DAT_180049f50 = 0x14;
  }
  DAT_180049f48 = FUN_18001f654((longlong)DAT_180049f50,8);
  if (DAT_180049f48 == (LPVOID)0x0) {
    DAT_180049f50 = 0x14;
    DAT_180049f48 = FUN_18001f654(0x14,8);
    if (DAT_180049f48 == (LPVOID)0x0) {
      return 0x1a;
    }
  }
  ppuVar1 = &PTR_DAT_180046b80;
  do {
    *(undefined ***)(lVar2 + (longlong)DAT_180049f48) = ppuVar1;
    ppuVar1 = ppuVar1 + 6;
    lVar2 = lVar2 + 8;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  return 0;
}



void FUN_180024f64(void)

{
  FUN_180027030();
  if (DAT_180048c64 != '\0') {
    FUN_180027124();
  }
  FUN_18001d45c(DAT_180049f48);
  DAT_180049f48 = (LPVOID)0x0;
  return;
}



undefined ** FUN_180024f94(void)

{
  return &PTR_DAT_180046b80;
}



void FUN_180024f9c(ulonglong param_1)

{
  if ((0x180046b7f < param_1) && (param_1 < 0x180046f11)) {
    FUN_180023ff8((int)((longlong)(param_1 - 0x180046b80) / 0x30) + 0x10);
    *(uint *)(param_1 + 0x18) = *(uint *)(param_1 + 0x18) | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180024ffa. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x30));
  return;
}



void FUN_180025004(int param_1,longlong param_2)

{
  if (param_1 < 0x14) {
    FUN_180023ff8(param_1 + 0x10);
    *(uint *)(param_2 + 0x18) = *(uint *)(param_2 + 0x18) | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002502e. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x30));
  return;
}



void FUN_180025038(ulonglong param_1)

{
  if ((0x180046b7f < param_1) && (param_1 < 0x180046f11)) {
    *(uint *)(param_1 + 0x18) = *(uint *)(param_1 + 0x18) & 0xffff7fff;
    FUN_1800241e8((int)((longlong)(param_1 - 0x180046b80) / 0x30) + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002507f. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x30));
  return;
}



void FUN_180025088(int param_1,longlong param_2)

{
  if (param_1 < 0x14) {
    *(uint *)(param_2 + 0x18) = *(uint *)(param_2 + 0x18) & 0xffff7fff;
    FUN_1800241e8(param_1 + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002509e. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x30));
  return;
}



undefined4 FUN_1800250a8(longlong param_1)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  
  if (param_1 == 0) {
    pDVar2 = FUN_18001fa28();
    *pDVar2 = 0x16;
    FUN_18001ffd8();
    uVar1 = 0xffffffff;
  }
  else {
    uVar1 = *(undefined4 *)(param_1 + 0x1c);
  }
  return uVar1;
}



byte FUN_1800250d0(uint param_1)

{
  DWORD *pDVar1;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004b088)) {
      return *(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 +
                      (ulonglong)(param_1 & 0x1f) * 0x58) & 0x40;
    }
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 9;
    FUN_18001ffd8();
  }
  return 0;
}



undefined4 FUN_180025130(uint param_1,WCHAR *param_2,uint param_3)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    pDVar2 = FUN_18001f9b8();
    *pDVar2 = 0;
    pDVar2 = FUN_18001fa28();
    *pDVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004b088)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) != 0) {
        FUN_1800271cc(param_1);
        if ((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) == 0) {
          pDVar2 = FUN_18001fa28();
          *pDVar2 = 9;
          pDVar2 = FUN_18001f9b8();
          *pDVar2 = 0;
          uVar1 = 0xffffffff;
        }
        else {
          uVar1 = FUN_180025214(param_1,param_2,(ulonglong)param_3);
        }
        FUN_180027384(param_1);
        return uVar1;
      }
    }
    pDVar2 = FUN_18001f9b8();
    *pDVar2 = 0;
    pDVar2 = FUN_18001fa28();
    *pDVar2 = 9;
    FUN_18001ffd8();
  }
  return 0xffffffff;
}



void FUN_180025214(uint param_1,WCHAR *param_2,ulonglong param_3)

{
  char cVar1;
  undefined1 uVar2;
  HANDLE pvVar3;
  byte bVar4;
  WCHAR WVar5;
  ushort uVar6;
  WCHAR WVar7;
  BOOL BVar8;
  UINT UVar9;
  int iVar10;
  DWORD DVar11;
  DWORD DVar12;
  uint uVar13;
  longlong lVar14;
  DWORD *pDVar15;
  undefined7 extraout_var;
  undefined6 extraout_var_00;
  uint uVar16;
  uint uVar17;
  DWORD DVar18;
  int iVar19;
  WCHAR *pWVar20;
  longlong lVar21;
  WCHAR *pWVar22;
  uint nNumberOfBytesToWrite;
  ulonglong uVar23;
  char cVar24;
  uint uVar25;
  longlong lVar26;
  int iVar27;
  bool bVar28;
  int iStackX_8;
  WCHAR aWStackX_c [2];
  longlong lStackX_10;
  DWORD aDStackX_18 [2];
  WCHAR local_1af8 [856];
  WCHAR local_1448 [2560];
  ulonglong local_48;
  undefined8 uStack_40;
  
  uStack_40 = 0x180025236;
  lVar14 = FUN_18001e920();
  lVar14 = -lVar14;
  local_48 = DAT_1800461a0 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar14);
  uVar16 = 0;
  DVar12 = 0;
  uVar13 = 0;
  nNumberOfBytesToWrite = (uint)param_3;
  uVar25 = 0;
  *(undefined4 *)((longlong)&iStackX_8 + lVar14) = 0;
  DVar18 = 0;
  if (nNumberOfBytesToWrite == 0) goto LAB_1800259db;
  if (param_2 == (WCHAR *)0x0) {
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025277;
    pDVar15 = FUN_18001f9b8();
    *pDVar15 = 0;
LAB_18002527a:
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002527f;
    pDVar15 = FUN_18001fa28();
    *pDVar15 = 0x16;
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002528a;
    FUN_18001ffd8();
    goto LAB_1800259db;
  }
  *(longlong *)((longlong)&lStackX_10 + lVar14) = (longlong)(int)param_1 >> 5;
  lVar21 = (&DAT_180049240)[(longlong)(int)param_1 >> 5];
  lVar26 = (ulonglong)(param_1 & 0x1f) * 0x58;
  cVar24 = *(char *)(lVar26 + 0x38 + lVar21);
  *(longlong *)(&stack0x00000020 + lVar14) = lVar26;
  cVar24 = (char)(cVar24 * '\x02') >> 1;
  if (((byte)(cVar24 - 1U) < 2) && ((~nNumberOfBytesToWrite & 1) == 0)) {
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800252da;
    pDVar15 = FUN_18001f9b8();
    *pDVar15 = 0;
    goto LAB_18002527a;
  }
  if ((*(byte *)(lVar26 + 8 + lVar21) & 0x20) != 0) {
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800252f5;
    FUN_180025af0(param_1,(LARGE_INTEGER)0x0,2);
  }
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800252fc;
  bVar4 = FUN_1800250d0(param_1);
  lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
  iVar27 = (int)param_2;
  if (((int)CONCAT71(extraout_var,bVar4) == 0) ||
     ((*(byte *)(lVar26 + 8 + (&DAT_180049240)[lVar21]) & 0x80) == 0)) {
LAB_18002564b:
    DVar12 = 0;
    if ((*(byte *)(lVar26 + 8 + (&DAT_180049240)[lVar21]) & 0x80) != 0) {
      DVar11 = 0;
      if (cVar24 == '\0') {
        pWVar20 = param_2;
        if (nNumberOfBytesToWrite != 0) {
          do {
            uVar23 = 0;
            iVar10 = *(int *)((longlong)&iStackX_8 + lVar14);
            pWVar22 = local_1448;
            do {
              if (nNumberOfBytesToWrite <= (uint)((int)pWVar20 - iVar27)) break;
              WVar5 = *pWVar20;
              pWVar20 = (WCHAR *)((longlong)pWVar20 + 1);
              if ((char)WVar5 == '\n') {
                *(char *)pWVar22 = '\r';
                iVar10 = iVar10 + 1;
                pWVar22 = (WCHAR *)((longlong)pWVar22 + 1);
                uVar23 = uVar23 + 1;
              }
              uVar23 = uVar23 + 1;
              *(char *)pWVar22 = (char)WVar5;
              pWVar22 = (WCHAR *)((longlong)pWVar22 + 1);
            } while (uVar23 < 0x13ff);
            *(int *)((longlong)&iStackX_8 + lVar14) = iVar10;
            lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
            pvVar3 = *(HANDLE *)
                      (lVar26 + (&DAT_180049240)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
            *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025701;
            BVar8 = WriteFile(pvVar3,local_1448,(int)pWVar22 - (int)local_1448,
                              (LPDWORD)((longlong)aDStackX_18 + lVar14),
                              *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
            if (BVar8 == 0) goto LAB_1800255eb;
            uVar16 = uVar16 + *(int *)((longlong)aDStackX_18 + lVar14);
          } while (((longlong)pWVar22 - (longlong)local_1448 <=
                    (longlong)*(int *)((longlong)aDStackX_18 + lVar14)) &&
                  ((uint)((int)pWVar20 - iVar27) < nNumberOfBytesToWrite));
          goto LAB_180025602;
        }
      }
      else if (cVar24 == '\x02') {
        pWVar20 = param_2;
        if (nNumberOfBytesToWrite != 0) {
          do {
            uVar23 = 0;
            iVar10 = *(int *)((longlong)&iStackX_8 + lVar14);
            pWVar22 = local_1448;
            do {
              if (nNumberOfBytesToWrite <= (uint)((int)pWVar20 - iVar27)) break;
              WVar5 = *pWVar20;
              pWVar20 = pWVar20 + 1;
              if (WVar5 == L'\n') {
                *pWVar22 = L'\r';
                iVar10 = iVar10 + 2;
                pWVar22 = pWVar22 + 1;
                uVar23 = uVar23 + 2;
              }
              uVar23 = uVar23 + 2;
              *pWVar22 = WVar5;
              pWVar22 = pWVar22 + 1;
            } while (uVar23 < 0x13fe);
            *(int *)((longlong)&iStackX_8 + lVar14) = iVar10;
            lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
            pvVar3 = *(HANDLE *)
                      (lVar26 + (&DAT_180049240)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
            *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800257ee;
            BVar8 = WriteFile(pvVar3,local_1448,(int)pWVar22 - (int)local_1448,
                              (LPDWORD)((longlong)aDStackX_18 + lVar14),
                              *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
            if (BVar8 == 0) goto LAB_1800255eb;
            uVar16 = uVar16 + *(int *)((longlong)aDStackX_18 + lVar14);
          } while (((longlong)pWVar22 - (longlong)local_1448 <=
                    (longlong)*(int *)((longlong)aDStackX_18 + lVar14)) &&
                  ((uint)((int)pWVar20 - iVar27) < nNumberOfBytesToWrite));
          goto LAB_180025602;
        }
      }
      else {
        pWVar20 = param_2;
        if (nNumberOfBytesToWrite != 0) {
          do {
            uVar23 = 0;
            pWVar22 = local_1af8;
            do {
              if (nNumberOfBytesToWrite <= (uint)((int)pWVar20 - iVar27)) break;
              WVar5 = *pWVar20;
              pWVar20 = pWVar20 + 1;
              if (WVar5 == L'\n') {
                *pWVar22 = L'\r';
                pWVar22 = pWVar22 + 1;
                uVar23 = uVar23 + 2;
              }
              uVar23 = uVar23 + 2;
              *pWVar22 = WVar5;
              pWVar22 = pWVar22 + 1;
            } while (uVar23 < 0x6a8);
            iVar19 = 0;
            *(undefined8 *)(&stack0x00000000 + lVar14) = 0;
            *(undefined8 *)(&stack0xfffffffffffffff8 + lVar14) = 0;
            *(undefined4 *)(&stack0xfffffffffffffff0 + lVar14) = 0xd55;
            *(WCHAR **)(&stack0xffffffffffffffe8 + lVar14) = local_1448;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800258c7;
            iVar10 = WideCharToMultiByte(0xfde9,0,local_1af8,((int)pWVar22 - (int)local_1af8) / 2,
                                         *(LPSTR *)(&stack0xffffffffffffffe8 + lVar14),
                                         *(int *)(&stack0xfffffffffffffff0 + lVar14),
                                         *(LPCSTR *)(&stack0xfffffffffffffff8 + lVar14),
                                         *(LPBOOL *)(&stack0x00000000 + lVar14));
            uVar17 = uVar16;
            if (iVar10 == 0) goto LAB_1800255f5;
            do {
              lVar21 = (&DAT_180049240)[*(longlong *)((longlong)&lStackX_10 + lVar14)];
              *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
              pvVar3 = *(HANDLE *)(*(longlong *)(&stack0x00000020 + lVar14) + lVar21);
              *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025910;
              BVar8 = WriteFile(pvVar3,(LPCVOID)((longlong)local_1448 + (longlong)iVar19),
                                iVar10 - iVar19,(LPDWORD)((longlong)aDStackX_18 + lVar14),
                                *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
              if (BVar8 == 0) {
                *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025925;
                DVar12 = GetLastError();
                break;
              }
              iVar19 = iVar19 + *(int *)((longlong)aDStackX_18 + lVar14);
            } while (iVar19 < iVar10);
          } while ((iVar10 <= iVar19) &&
                  (uVar16 = (int)pWVar20 - iVar27, uVar16 < nNumberOfBytesToWrite));
          goto LAB_1800255fd;
        }
      }
      goto LAB_1800259a3;
    }
    pvVar3 = *(HANDLE *)(lVar26 + (&DAT_180049240)[lVar21]);
    *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
    *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025965;
    BVar8 = WriteFile(pvVar3,param_2,nNumberOfBytesToWrite,(LPDWORD)((longlong)aDStackX_18 + lVar14)
                      ,*(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
    if (BVar8 == 0) {
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002597a;
      uVar13 = GetLastError();
      uVar16 = uVar25;
    }
    else {
      uVar16 = *(uint *)((longlong)aDStackX_18 + lVar14);
      uVar13 = uVar25;
    }
    goto LAB_18002560b;
  }
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025325;
  pDVar15 = FUN_180021130();
  lVar21 = *(longlong *)(*(longlong *)(pDVar15 + 0x30) + 0x138);
  pvVar3 = *(HANDLE *)(lVar26 + (&DAT_180049240)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002535b;
  BVar8 = GetConsoleMode(pvVar3,(LPDWORD)(&stack0x0000002c + lVar14));
  if (BVar8 == 0) {
    lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
    goto LAB_18002564b;
  }
  if ((lVar21 == 0) && (cVar24 == '\0')) {
    lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
    goto LAB_18002564b;
  }
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002537a;
  UVar9 = GetConsoleCP();
  *(UINT *)(&stack0x00000030 + lVar14) = UVar9;
  WVar5 = L'\0';
  *(undefined2 *)((longlong)aWStackX_c + lVar14) = 0;
  *(undefined4 *)(&stack0x00000028 + lVar14) = 0;
  pWVar20 = param_2;
  if (nNumberOfBytesToWrite != 0) {
    do {
      bVar28 = false;
      uVar17 = uVar16;
      if (cVar24 == '\0') {
        cVar1 = (char)*pWVar20;
        lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
        *(uint *)(&stack0x0000002c + lVar14) = (uint)(cVar1 == '\n');
        lVar21 = (&DAT_180049240)[*(longlong *)((longlong)&lStackX_10 + lVar14)];
        if (*(int *)(lVar26 + 0x50 + lVar21) == 0) {
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800253f6;
          uVar6 = FUN_180025fc0((int)cVar1);
          if ((int)CONCAT62(extraout_var_00,uVar6) == 0) {
            uVar23 = 1;
            pWVar22 = pWVar20;
            goto LAB_180025437;
          }
          if ((longlong)(((param_3 & 0xffffffff) - (longlong)pWVar20) + (longlong)param_2) < 2) {
            lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
            uVar16 = uVar16 + 1;
            *(char *)(lVar26 + 0x4c + (&DAT_180049240)[lVar21]) = (char)*pWVar20;
            *(undefined4 *)(lVar26 + 0x50 + (&DAT_180049240)[lVar21]) = 1;
            goto LAB_18002560b;
          }
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025420;
          iVar10 = FUN_180026314((LPWSTR)((longlong)aWStackX_c + lVar14),(byte *)pWVar20,2);
          DVar11 = DVar18;
          if (iVar10 == -1) break;
          pWVar20 = (WCHAR *)((longlong)pWVar20 + 1);
        }
        else {
          uVar2 = *(undefined1 *)(lVar26 + 0x4c + lVar21);
          (&stack0x00000035)[lVar14] = cVar1;
          (&stack0x00000034)[lVar14] = uVar2;
          *(undefined4 *)(lVar26 + 0x50 + lVar21) = 0;
          uVar23 = 2;
          pWVar22 = (WCHAR *)(&stack0x00000034 + lVar14);
LAB_180025437:
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025441;
          iVar10 = FUN_180026314((LPWSTR)((longlong)aWStackX_c + lVar14),(byte *)pWVar22,uVar23);
          DVar11 = 0;
          if (iVar10 == -1) break;
        }
        *(undefined8 *)(&stack0x00000000 + lVar14) = 0;
        *(undefined8 *)(&stack0xfffffffffffffff8 + lVar14) = 0;
        *(undefined4 *)(&stack0xfffffffffffffff0 + lVar14) = 5;
        *(undefined1 **)(&stack0xffffffffffffffe8 + lVar14) = &stack0x00000034 + lVar14;
        pWVar20 = (WCHAR *)((longlong)pWVar20 + 1);
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025482;
        DVar11 = WideCharToMultiByte(*(UINT *)(&stack0x00000030 + lVar14),0,
                                     (LPCWSTR)((longlong)aWStackX_c + lVar14),1,
                                     *(LPSTR *)(&stack0xffffffffffffffe8 + lVar14),
                                     *(int *)(&stack0xfffffffffffffff0 + lVar14),
                                     *(LPCSTR *)(&stack0xfffffffffffffff8 + lVar14),
                                     *(LPBOOL *)(&stack0x00000000 + lVar14));
        if (DVar11 == 0) goto LAB_1800255fd;
        lVar21 = (&DAT_180049240)[*(longlong *)((longlong)&lStackX_10 + lVar14)];
        *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
        pvVar3 = *(HANDLE *)(*(longlong *)(&stack0x00000020 + lVar14) + lVar21);
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800254c0;
        BVar8 = WriteFile(pvVar3,&stack0x00000034 + lVar14,DVar11,
                          (LPDWORD)(&stack0x00000028 + lVar14),
                          *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
        if (BVar8 == 0) goto LAB_1800255f5;
        uVar16 = ((int)pWVar20 - iVar27) + *(int *)((longlong)&iStackX_8 + lVar14);
        if (*(int *)(&stack0x00000028 + lVar14) < (int)DVar11) {
          lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
          lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
          uVar13 = uVar25;
          goto LAB_18002560b;
        }
        if (*(int *)(&stack0x0000002c + lVar14) == 0) {
          WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
          uVar17 = uVar16;
          goto LAB_1800255aa;
        }
        (&stack0x00000034)[lVar14] = 0xd;
        *(undefined8 *)(&stack0xffffffffffffffe8 + lVar14) = 0;
        lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
        pvVar3 = *(HANDLE *)
                  (lVar26 + (&DAT_180049240)[*(longlong *)((longlong)&lStackX_10 + lVar14)]);
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025520;
        BVar8 = WriteFile(pvVar3,&stack0x00000034 + lVar14,1,(LPDWORD)(&stack0x00000028 + lVar14),
                          *(LPOVERLAPPED *)(&stack0xffffffffffffffe8 + lVar14));
        if (BVar8 == 0) goto LAB_1800255eb;
        DVar11 = DVar18;
        if (*(int *)(&stack0x00000028 + lVar14) < 1) break;
        *(int *)((longlong)&iStackX_8 + lVar14) = *(int *)((longlong)&iStackX_8 + lVar14) + 1;
        WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
        uVar16 = uVar16 + 1;
      }
      else {
        if ((byte)(cVar24 - 1U) < 2) {
          WVar5 = *pWVar20;
          bVar28 = WVar5 == L'\n';
          *(WCHAR *)((longlong)aWStackX_c + lVar14) = WVar5;
          pWVar20 = pWVar20 + 1;
        }
        if ((byte)(cVar24 - 1U) < 2) {
          *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025577;
          WVar7 = FUN_1800273b0(WVar5);
          WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
          if (WVar7 != WVar5) goto LAB_1800255f5;
          uVar17 = uVar16 + 2;
          if (bVar28) {
            *(undefined2 *)((longlong)aWStackX_c + lVar14) = 0xd;
            *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002559a;
            WVar7 = FUN_1800273b0(0xd);
            WVar5 = *(WCHAR *)((longlong)aWStackX_c + lVar14);
            if (WVar7 != WVar5) goto LAB_1800255f5;
            uVar17 = uVar16 + 3;
            *(int *)((longlong)&iStackX_8 + lVar14) = *(int *)((longlong)&iStackX_8 + lVar14) + 1;
          }
        }
LAB_1800255aa:
        lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
        uVar16 = uVar17;
      }
      DVar11 = DVar18;
    } while ((uint)((int)pWVar20 - iVar27) < nNumberOfBytesToWrite);
    goto LAB_180025602;
  }
  lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
  goto LAB_1800259a3;
LAB_1800255f5:
  uVar16 = uVar17;
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800255fb;
  DVar12 = GetLastError();
LAB_1800255fd:
  lVar26 = *(longlong *)(&stack0x00000020 + lVar14);
  DVar11 = DVar12;
  goto LAB_180025602;
LAB_1800255eb:
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800255f1;
  DVar11 = GetLastError();
LAB_180025602:
  uVar13 = DVar11;
  lVar21 = *(longlong *)((longlong)&lStackX_10 + lVar14);
LAB_18002560b:
  if (uVar16 == 0) {
    if (uVar13 == 0) {
LAB_1800259a3:
      if (((*(byte *)(lVar26 + 8 + (&DAT_180049240)[lVar21]) & 0x40) == 0) ||
         ((char)*param_2 != '\x1a')) {
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800259c5;
        pDVar15 = FUN_18001fa28();
        *pDVar15 = 0x1c;
        *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800259d0;
        pDVar15 = FUN_18001f9b8();
        *pDVar15 = 0;
      }
    }
    else if (uVar13 == 5) {
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x18002562b;
      pDVar15 = FUN_18001fa28();
      *pDVar15 = 9;
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025636;
      pDVar15 = FUN_18001f9b8();
      *pDVar15 = 5;
    }
    else {
      *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x180025999;
      FUN_18001f9d8(uVar13);
    }
  }
LAB_1800259db:
  *(undefined8 *)((longlong)&uStack_40 + lVar14) = 0x1800259ea;
  FUN_18001d530(local_48 ^ (ulonglong)(&stack0xffffffffffffffc8 + lVar14));
  return;
}



undefined8 FUN_180025a08(uint param_1,LARGE_INTEGER param_2,DWORD param_3)

{
  DWORD *pDVar1;
  undefined8 uVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_18001f9b8();
    *pDVar1 = 0;
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004b088)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) != 0) {
        FUN_1800271cc(param_1);
        if ((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) == 0) {
          pDVar1 = FUN_18001fa28();
          *pDVar1 = 9;
          pDVar1 = FUN_18001f9b8();
          *pDVar1 = 0;
          uVar2 = 0xffffffffffffffff;
        }
        else {
          uVar2 = FUN_180025af0(param_1,param_2,param_3);
        }
        FUN_180027384(param_1);
        return uVar2;
      }
    }
    pDVar1 = FUN_18001f9b8();
    *pDVar1 = 0;
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 9;
    FUN_18001ffd8();
  }
  return 0xffffffffffffffff;
}



undefined8 FUN_180025af0(uint param_1,LARGE_INTEGER param_2,DWORD param_3)

{
  byte *pbVar1;
  BOOL BVar2;
  DWORD DVar3;
  HANDLE hFile;
  DWORD *pDVar4;
  LARGE_INTEGER local_res20;
  
  hFile = (HANDLE)FUN_180027310(param_1);
  if (hFile == (HANDLE)0xffffffffffffffff) {
    pDVar4 = FUN_18001fa28();
    *pDVar4 = 9;
  }
  else {
    BVar2 = SetFilePointerEx(hFile,param_2,&local_res20,param_3);
    if (BVar2 != 0) {
      pbVar1 = (byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 +
                       (ulonglong)(param_1 & 0x1f) * 0x58);
      *pbVar1 = *pbVar1 & 0xfd;
      return local_res20.QuadPart;
    }
    DVar3 = GetLastError();
    FUN_18001f9d8(DVar3);
  }
  return 0xffffffffffffffff;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180025b84(undefined8 *param_1)

{
  LPVOID pvVar1;
  
  _DAT_180049e98 = _DAT_180049e98 + 1;
  pvVar1 = FUN_18001f6d4(0x1000);
  param_1[2] = pvVar1;
  if (pvVar1 == (LPVOID)0x0) {
    *(uint *)(param_1 + 3) = *(uint *)(param_1 + 3) | 4;
    *(undefined4 *)((longlong)param_1 + 0x24) = 2;
    param_1[2] = param_1 + 4;
  }
  else {
    *(uint *)(param_1 + 3) = *(uint *)(param_1 + 3) | 8;
    *(undefined4 *)((longlong)param_1 + 0x24) = 0x1000;
  }
  *(undefined4 *)(param_1 + 1) = 0;
  *param_1 = param_1[2];
  return;
}



void FUN_180025bd8(int *param_1)

{
  int *piVar1;
  int *piVar2;
  longlong lVar3;
  
  LOCK();
  *param_1 = *param_1 + 1;
  UNLOCK();
  piVar2 = *(int **)(param_1 + 0x36);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = *(int **)(param_1 + 0x3a);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = *(int **)(param_1 + 0x38);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = *(int **)(param_1 + 0x3e);
  if (piVar2 != (int *)0x0) {
    LOCK();
    *piVar2 = *piVar2 + 1;
    UNLOCK();
  }
  piVar2 = param_1 + 10;
  lVar3 = 6;
  do {
    if ((*(undefined **)(piVar2 + -4) != &DAT_180046f44) &&
       (piVar1 = *(int **)piVar2, piVar1 != (int *)0x0)) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    if ((*(longlong *)(piVar2 + -6) != 0) && (piVar1 = *(int **)(piVar2 + -2), piVar1 != (int *)0x0)
       ) {
      LOCK();
      *piVar1 = *piVar1 + 1;
      UNLOCK();
    }
    piVar2 = piVar2 + 8;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  LOCK();
  *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
       *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + 1;
  UNLOCK();
  return;
}



void FUN_180025c64(LPVOID param_1)

{
  int *piVar1;
  undefined **ppuVar2;
  longlong lVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;
  
  if ((((*(undefined ***)((longlong)param_1 + 0xf0) != (undefined **)0x0) &&
       (*(undefined ***)((longlong)param_1 + 0xf0) != &PTR_DAT_180047390)) &&
      (*(int **)((longlong)param_1 + 0xd8) != (int *)0x0)) &&
     (**(int **)((longlong)param_1 + 0xd8) == 0)) {
    piVar1 = *(int **)((longlong)param_1 + 0xe8);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      FUN_18001d45c(piVar1);
      FUN_18002740c(*(longlong *)((longlong)param_1 + 0xf0));
    }
    piVar1 = *(int **)((longlong)param_1 + 0xe0);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      FUN_18001d45c(piVar1);
      FUN_180027518(*(undefined8 **)((longlong)param_1 + 0xf0));
    }
    FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0xd8));
    FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0xf0));
  }
  if ((*(int **)((longlong)param_1 + 0xf8) != (int *)0x0) &&
     (**(int **)((longlong)param_1 + 0xf8) == 0)) {
    FUN_18001d45c((LPVOID)(*(longlong *)((longlong)param_1 + 0x100) + -0xfe));
    FUN_18001d45c((LPVOID)(*(longlong *)((longlong)param_1 + 0x110) + -0x80));
    FUN_18001d45c((LPVOID)(*(longlong *)((longlong)param_1 + 0x118) + -0x80));
    FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0xf8));
  }
  ppuVar2 = *(undefined ***)((longlong)param_1 + 0x120);
  if ((ppuVar2 != &PTR_DAT_180046f50) && (*(int *)((longlong)ppuVar2 + 0x15c) == 0)) {
    FUN_180027584(ppuVar2);
    FUN_18001d45c(*(LPVOID *)((longlong)param_1 + 0x120));
  }
  puVar4 = (undefined8 *)((longlong)param_1 + 0x128);
  puVar5 = (undefined8 *)((longlong)param_1 + 0x28);
  lVar3 = 6;
  do {
    if ((((undefined *)puVar5[-2] != &DAT_180046f44) &&
        (piVar1 = (int *)*puVar5, piVar1 != (int *)0x0)) && (*piVar1 == 0)) {
      FUN_18001d45c(piVar1);
      FUN_18001d45c((LPVOID)*puVar4);
    }
    if (((puVar5[-3] != 0) && (piVar1 = (int *)puVar5[-1], piVar1 != (int *)0x0)) && (*piVar1 == 0))
    {
      FUN_18001d45c(piVar1);
    }
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 4;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  FUN_18001d45c(param_1);
  return;
}



int * FUN_180025dfc(int *param_1)

{
  int *piVar1;
  int *piVar2;
  longlong lVar3;
  
  if (param_1 != (int *)0x0) {
    LOCK();
    *param_1 = *param_1 + -1;
    UNLOCK();
    piVar2 = *(int **)(param_1 + 0x36);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = *(int **)(param_1 + 0x3a);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = *(int **)(param_1 + 0x38);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = *(int **)(param_1 + 0x3e);
    if (piVar2 != (int *)0x0) {
      LOCK();
      *piVar2 = *piVar2 + -1;
      UNLOCK();
    }
    piVar2 = param_1 + 10;
    lVar3 = 6;
    do {
      if ((*(undefined **)(piVar2 + -4) != &DAT_180046f44) &&
         (piVar1 = *(int **)piVar2, piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
        UNLOCK();
      }
      if ((*(longlong *)(piVar2 + -6) != 0) &&
         (piVar1 = *(int **)(piVar2 + -2), piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
        UNLOCK();
      }
      piVar2 = piVar2 + 8;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    LOCK();
    *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
         *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + -1;
    UNLOCK();
  }
  return param_1;
}



int * FUN_180025ea0(void)

{
  DWORD *pDVar1;
  int *piVar2;
  
  pDVar1 = FUN_180021130();
  if (((pDVar1[0x32] & DAT_180047378) == 0) || (*(longlong *)(pDVar1 + 0x30) == 0)) {
    FUN_180023ff8(0xc);
    piVar2 = FUN_180025f18((undefined8 *)(pDVar1 + 0x30),(int *)PTR_DAT_180047210);
    FUN_1800241e8(0xc);
  }
  else {
    pDVar1 = FUN_180021130();
    piVar2 = *(int **)(pDVar1 + 0x30);
  }
  if (piVar2 == (int *)0x0) {
    FUN_18001f2a4(0x20);
  }
  return piVar2;
}



int * FUN_180025f18(undefined8 *param_1,int *param_2)

{
  int *piVar1;
  
  if ((param_2 == (int *)0x0) || (param_1 == (undefined8 *)0x0)) {
    param_2 = (int *)0x0;
  }
  else {
    piVar1 = (int *)*param_1;
    if (piVar1 != param_2) {
      *param_1 = param_2;
      FUN_180025bd8(param_2);
      if (((piVar1 != (int *)0x0) && (FUN_180025dfc(piVar1), *piVar1 == 0)) &&
         (piVar1 != (int *)&DAT_180047220)) {
        FUN_180025c64(piVar1);
      }
    }
  }
  return param_2;
}



ushort FUN_180025f7c(uint param_1,longlong *param_2)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_1800201c0(local_28,param_2);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(param_1 & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1 & 0x8000;
}



ushort FUN_180025fc0(uint param_1)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_1800201c0(local_28,(longlong *)0x0);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(param_1 & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1 & 0x8000;
}



bool FUN_180026008(void)

{
  return DAT_180049ea0 == (DAT_1800461a0 | 1);
}



DWORD FUN_180026020(int *param_1,undefined1 (*param_2) [16],ulonglong param_3,WCHAR param_4,
                   longlong *param_5)

{
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  DWORD unaff_EBX;
  BOOL local_res10 [2];
  WCHAR local_res20 [4];
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if ((param_2 == (undefined1 (*) [16])0x0) && (param_3 != 0)) {
    if (param_1 == (int *)0x0) {
      return unaff_EBX;
    }
    *param_1 = 0;
    return unaff_EBX;
  }
  if (param_1 != (int *)0x0) {
    *param_1 = -1;
  }
  local_res20[0] = param_4;
  if (0x7fffffff < param_3) {
    pDVar3 = FUN_18001fa28();
    *pDVar3 = 0x16;
    FUN_18001ffd8();
    return unaff_EBX;
  }
  FUN_1800201c0(local_28,param_5);
  if (*(longlong *)(local_28[0] + 0x138) == 0) {
    if ((ushort)local_res20[0] < 0x100) {
      if (param_2 != (undefined1 (*) [16])0x0) {
        if (param_3 == 0) goto LAB_180026194;
        (*param_2)[0] = (char)local_res20[0];
      }
      if (param_1 != (int *)0x0) {
        *param_1 = 1;
      }
      goto LAB_1800260d6;
    }
    if ((param_2 != (undefined1 (*) [16])0x0) && (param_3 != 0)) {
      FUN_18001dbc0(param_2,0,param_3);
    }
  }
  else {
    local_res10[0] = 0;
    iVar1 = WideCharToMultiByte(*(UINT *)(local_28[0] + 4),0,local_res20,1,(LPSTR)param_2,
                                (int)param_3,(LPCSTR)0x0,local_res10);
    if (iVar1 == 0) {
      DVar2 = GetLastError();
      if (DVar2 == 0x7a) {
        if ((param_2 != (undefined1 (*) [16])0x0) && (param_3 != 0)) {
          FUN_18001dbc0(param_2,0,param_3);
        }
LAB_180026194:
        pDVar3 = FUN_18001fa28();
        *pDVar3 = 0x22;
        FUN_18001ffd8();
        goto LAB_1800260d6;
      }
    }
    else if (local_res10[0] == 0) {
      if (param_1 != (int *)0x0) {
        *param_1 = iVar1;
      }
      goto LAB_1800260d6;
    }
  }
  pDVar3 = FUN_18001fa28();
  *pDVar3 = 0x2a;
  FUN_18001fa28();
LAB_1800260d6:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return unaff_EBX;
}



void FUN_1800261ac(int *param_1,undefined1 (*param_2) [16],ulonglong param_3,WCHAR param_4)

{
  FUN_180026020(param_1,param_2,param_3,param_4,(longlong *)0x0);
  return;
}



undefined4 FUN_1800261c0(LPWSTR param_1,byte *param_2,ulonglong param_3,longlong *param_4)

{
  ushort uVar1;
  int iVar2;
  undefined6 extraout_var;
  DWORD *pDVar3;
  undefined4 uVar4;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if ((param_2 != (byte *)0x0) && (param_3 != 0)) {
    if (*param_2 != 0) {
      FUN_1800201c0(local_28,param_4);
      if (*(longlong *)(local_28[0] + 0x138) == 0) {
        if (param_1 != (LPWSTR)0x0) {
          *param_1 = (ushort)*param_2;
        }
        uVar4 = 1;
      }
      else {
        uVar1 = FUN_180025f7c((uint)*param_2,local_28);
        uVar4 = 1;
        if ((int)CONCAT62(extraout_var,uVar1) == 0) {
          iVar2 = MultiByteToWideChar(*(UINT *)(local_28[0] + 4),9,(LPCSTR)param_2,1,param_1,
                                      (uint)(param_1 != (LPWSTR)0x0));
          if (iVar2 != 0) goto LAB_1800262f7;
        }
        else {
          iVar2 = *(int *)(local_28[0] + 0xd4);
          if ((((1 < iVar2) && (iVar2 <= (int)param_3)) &&
              (iVar2 = MultiByteToWideChar(*(UINT *)(local_28[0] + 4),9,(LPCSTR)param_2,iVar2,
                                           param_1,(uint)(param_1 != (LPWSTR)0x0)), iVar2 != 0)) ||
             (((ulonglong)(longlong)*(int *)(local_28[0] + 0xd4) <= param_3 && (param_2[1] != 0))))
          {
            uVar4 = *(undefined4 *)(local_28[0] + 0xd4);
            goto LAB_1800262f7;
          }
        }
        pDVar3 = FUN_18001fa28();
        uVar4 = 0xffffffff;
        *pDVar3 = 0x2a;
      }
LAB_1800262f7:
      if (local_10 == '\0') {
        return uVar4;
      }
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
      return uVar4;
    }
    if (param_1 != (LPWSTR)0x0) {
      *param_1 = L'\0';
    }
  }
  return 0;
}



void FUN_180026314(LPWSTR param_1,byte *param_2,ulonglong param_3)

{
  FUN_1800261c0(param_1,param_2,param_3,(longlong *)0x0);
  return;
}



byte FUN_18002631c(longlong param_1)

{
  return -(param_1 != 0) & 1;
}



void FUN_180026340(void)

{
  code *pcVar1;
  
  pcVar1 = (code *)FUN_180024e90();
  (*pcVar1)();
  FUN_180024ec0();
  FUN_180024e90();
  return;
}



undefined4 FUN_180026388(longlong param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  iVar3 = 0xe3;
  do {
    iVar1 = (iVar3 + iVar4) / 2;
    iVar2 = FUN_1800264d8(param_1,(ushort *)(&PTR_DAT_1800328a0)[(longlong)iVar1 * 2],0x55);
    if (iVar2 == 0) {
      return *(undefined4 *)(&DAT_1800328a8 + (longlong)iVar1 * 0x10);
    }
    if (iVar2 < 0) {
      iVar3 = iVar1 + -1;
    }
    else {
      iVar4 = iVar1 + 1;
    }
  } while (iVar4 <= iVar3);
  return 0xffffffff;
}



undefined4 FUN_180026414(longlong param_1)

{
  int iVar1;
  
  if (((param_1 != 0) && (iVar1 = FUN_180026388(param_1), -1 < iVar1)) &&
     ((ulonglong)(longlong)iVar1 < 0xe4)) {
    return *(undefined4 *)(&DAT_180031a60 + (longlong)iVar1 * 0x10);
  }
  return 0;
}



void FUN_180026448(longlong param_1,DWORD param_2,LPCWSTR param_3,int param_4,LPWSTR param_5,
                  int param_6)

{
  LCID Locale;
  
  if ((code *)(DAT_18004b060 ^ DAT_1800461a0) == (code *)0x0) {
    Locale = FUN_180026414(param_1);
    LCMapStringW(Locale,param_2,param_3,param_4,param_5,param_6);
  }
  else {
    (*(code *)(DAT_18004b060 ^ DAT_1800461a0))();
  }
  return;
}



int FUN_1800264d8(longlong param_1,ushort *param_2,longlong param_3)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  if (param_3 != 0) {
    lVar4 = param_1 - (longlong)param_2;
    do {
      uVar1 = *(ushort *)(lVar4 + (longlong)param_2);
      if ((ushort)(uVar1 - 0x41) < 0x1a) {
        uVar1 = uVar1 + 0x20;
      }
      uVar2 = *param_2;
      if ((ushort)(uVar2 - 0x41) < 0x1a) {
        uVar2 = uVar2 + 0x20;
      }
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (((param_3 != 0) && (uVar1 != 0)) && (uVar1 == uVar2));
    iVar3 = (uint)uVar1 - (uint)uVar2;
  }
  return iVar3;
}



uint FUN_180026530(longlong *param_1,uint param_2,uint param_3,byte param_4)

{
  uint uVar1;
  longlong local_28;
  longlong local_20;
  longlong local_18;
  char local_10;
  
  FUN_1800201c0(&local_28,param_1);
  if ((*(byte *)((ulonglong)(param_2 & 0xff) + 0x19 + local_20) & param_4) == 0) {
    if (param_3 == 0) {
      uVar1 = 0;
    }
    else {
      uVar1 = *(ushort *)(*(longlong *)(local_28 + 0x108) + (ulonglong)(param_2 & 0xff) * 2) &
              param_3;
    }
    if (uVar1 == 0) goto LAB_180026586;
  }
  uVar1 = 1;
LAB_180026586:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1;
}



void FUN_1800265ac(uint param_1)

{
  FUN_180026530((longlong *)0x0,param_1,0,4);
  return;
}



DWORD FUN_1800265c0(short *param_1,longlong param_2,short *param_3)

{
  short sVar1;
  DWORD *pDVar2;
  short *psVar3;
  longlong lVar4;
  DWORD DVar5;
  
  if ((param_1 != (short *)0x0) && (param_2 != 0)) {
    psVar3 = param_1;
    if (param_3 == (short *)0x0) {
      *param_1 = 0;
    }
    else {
      do {
        if (*psVar3 == 0) break;
        psVar3 = psVar3 + 1;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      if (param_2 != 0) {
        lVar4 = (longlong)psVar3 - (longlong)param_3;
        do {
          sVar1 = *param_3;
          *(short *)(lVar4 + (longlong)param_3) = sVar1;
          param_3 = param_3 + 1;
          if (sVar1 == 0) break;
          param_2 = param_2 + -1;
        } while (param_2 != 0);
        if (param_2 != 0) {
          return 0;
        }
        *param_1 = 0;
        pDVar2 = FUN_18001fa28();
        DVar5 = 0x22;
        goto LAB_1800265e9;
      }
      *param_1 = 0;
    }
  }
  pDVar2 = FUN_18001fa28();
  DVar5 = 0x16;
LAB_1800265e9:
  *pDVar2 = DVar5;
  FUN_18001ffd8();
  return DVar5;
}



longlong FUN_180026648(short *param_1)

{
  short sVar1;
  short *psVar2;
  
  psVar2 = param_1;
  do {
    sVar1 = *psVar2;
    psVar2 = psVar2 + 1;
  } while (sVar1 != 0);
  return ((longlong)psVar2 - (longlong)param_1 >> 1) + -1;
}



DWORD FUN_180026664(short *param_1,longlong param_2,short *param_3,longlong param_4)

{
  short sVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  longlong lVar4;
  longlong lVar5;
  short *psVar6;
  
  if (param_4 == 0) {
    if (param_1 == (short *)0x0) {
      if (param_2 == 0) {
        return 0;
      }
    }
    else {
LAB_180026684:
      if (param_2 != 0) {
        if (param_4 == 0) {
          *param_1 = 0;
          return 0;
        }
        if (param_3 != (short *)0x0) {
          lVar4 = param_2;
          if (param_4 == -1) {
            lVar5 = (longlong)param_1 - (longlong)param_3;
            do {
              sVar1 = *param_3;
              *(short *)(lVar5 + (longlong)param_3) = sVar1;
              param_3 = param_3 + 1;
              if (sVar1 == 0) break;
              lVar4 = lVar4 + -1;
            } while (lVar4 != 0);
          }
          else {
            psVar6 = param_1;
            do {
              sVar1 = *(short *)(((longlong)param_3 - (longlong)param_1) + (longlong)psVar6);
              *psVar6 = sVar1;
              psVar6 = psVar6 + 1;
              if ((sVar1 == 0) || (lVar4 = lVar4 + -1, lVar4 == 0)) break;
              param_4 = param_4 + -1;
            } while (param_4 != 0);
            if (param_4 == 0) {
              *psVar6 = 0;
            }
          }
          if (lVar4 != 0) {
            return 0;
          }
          if (param_4 == -1) {
            param_1[param_2 + -1] = 0;
            return 0x50;
          }
          *param_1 = 0;
          pDVar2 = FUN_18001fa28();
          DVar3 = 0x22;
          goto LAB_1800266a5;
        }
        *param_1 = 0;
      }
    }
  }
  else if (param_1 != (short *)0x0) goto LAB_180026684;
  pDVar2 = FUN_18001fa28();
  DVar3 = 0x16;
LAB_1800266a5:
  *pDVar2 = DVar3;
  FUN_18001ffd8();
  return DVar3;
}



int FUN_180026730(int param_1)

{
  int iVar1;
  int iVar2;
  DWORD *pDVar3;
  
  if ((param_1 < 0) ||
     ((iVar2 = DAT_180049eb0, iVar1 = param_1, 2 < param_1 && (iVar1 = DAT_180049eb0, param_1 != 3))
     )) {
    pDVar3 = FUN_18001fa28();
    *pDVar3 = 0x16;
    FUN_18001ffd8();
    iVar2 = -1;
    iVar1 = DAT_180049eb0;
  }
  DAT_180049eb0 = iVar1;
  return iVar2;
}



void FUN_180026770(LPCWSTR param_1,undefined8 param_2,uint param_3)

{
  bool bVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  PVOID pvVar5;
  undefined7 extraout_var;
  HMODULE hModule;
  FARPROC pFVar6;
  code *pcVar7;
  code *pcVar8;
  longlong lVar9;
  longlong lVar10;
  undefined1 auStack_88 [32];
  undefined1 *local_68;
  undefined1 local_58 [8];
  undefined1 local_50 [8];
  byte local_48;
  ulonglong local_40;
  
  local_40 = DAT_1800461a0 ^ (ulonglong)auStack_88;
  pvVar5 = EncodePointer((PVOID)0x0);
  lVar10 = 0;
  bVar1 = FUN_1800235e4();
  if (DAT_180049eb8 == (PVOID)0x0) {
    hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0x800);
    if (((hModule == (HMODULE)0x0) &&
        ((DVar2 = GetLastError(), DVar2 != 0x57 ||
         (hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0), hModule == (HMODULE)0x0)))) ||
       (pFVar6 = GetProcAddress(hModule,"MessageBoxW"), pFVar6 == (FARPROC)0x0)) goto LAB_1800269c7;
    DAT_180049eb8 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetActiveWindow");
    DAT_180049ec0 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetLastActivePopup");
    DAT_180049ec8 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetUserObjectInformationW");
    DAT_180049ed8 = EncodePointer(pFVar6);
    if (DAT_180049ed8 != (PVOID)0x0) {
      pFVar6 = GetProcAddress(hModule,"GetProcessWindowStation");
      DAT_180049ed0 = EncodePointer(pFVar6);
    }
  }
  BVar3 = IsDebuggerPresent();
  iVar4 = (int)CONCAT71(extraout_var,bVar1);
  if (BVar3 == 0) {
    if (iVar4 != 0) {
      DecodePointer(DAT_180049eb8);
      goto LAB_1800269c7;
    }
  }
  else {
    if (param_1 != (LPCWSTR)0x0) {
      OutputDebugStringW(param_1);
    }
    if (iVar4 != 0) goto LAB_1800269c7;
  }
  if ((DAT_180049ed0 == pvVar5) || (DAT_180049ed8 == pvVar5)) {
LAB_180026963:
    if (((DAT_180049ec0 != pvVar5) &&
        (((pcVar7 = (code *)DecodePointer(DAT_180049ec0), pcVar7 != (code *)0x0 &&
          (lVar10 = (*pcVar7)(), lVar10 != 0)) && (DAT_180049ec8 != pvVar5)))) &&
       (pcVar7 = (code *)DecodePointer(DAT_180049ec8), pcVar7 != (code *)0x0)) {
      lVar10 = (*pcVar7)(lVar10);
    }
  }
  else {
    pcVar7 = (code *)DecodePointer(DAT_180049ed0);
    pcVar8 = (code *)DecodePointer(DAT_180049ed8);
    if ((pcVar7 == (code *)0x0) || (pcVar8 == (code *)0x0)) goto LAB_180026963;
    lVar9 = (*pcVar7)();
    if (lVar9 != 0) {
      local_68 = local_58;
      iVar4 = (*pcVar8)(lVar9,1,local_50);
      if ((iVar4 != 0) && ((local_48 & 1) != 0)) goto LAB_180026963;
    }
    param_3 = param_3 | 0x200000;
  }
  pcVar7 = (code *)DecodePointer(DAT_180049eb8);
  if (pcVar7 != (code *)0x0) {
    (*pcVar7)(lVar10,param_1,param_2,param_3);
  }
LAB_1800269c7:
  FUN_18001d530(local_40 ^ (ulonglong)auStack_88);
  return;
}



void FUN_1800269f0(longlong *param_1,longlong param_2,uint param_3,LPCSTR param_4,int param_5,
                  undefined8 param_6,int param_7,UINT param_8,int param_9)

{
  int iVar1;
  char *pcVar2;
  longlong lVar3;
  LPCWSTR pWVar4;
  longlong lVar5;
  LPCWSTR lpWideCharStr;
  undefined1 *puVar6;
  undefined1 *puVar7;
  undefined1 *puVar8;
  int iVar9;
  ulonglong uVar10;
  undefined1 auStackY_78 [32];
  longlong local_38;
  ulonglong local_30;
  
  puVar7 = auStackY_78;
  puVar6 = auStackY_78;
  local_30 = DAT_1800461a0 ^ (ulonglong)&local_38;
  pWVar4 = (LPCWSTR)0x0;
  pcVar2 = param_4;
  iVar9 = param_5;
  if (0 < param_5) {
    do {
      iVar9 = iVar9 + -1;
      if (*pcVar2 == '\0') goto LAB_180026a4a;
      pcVar2 = pcVar2 + 1;
    } while (iVar9 != 0);
    iVar9 = -1;
LAB_180026a4a:
    iVar1 = (param_5 - iVar9) + -1;
    iVar9 = param_5 - iVar9;
    if (param_5 <= iVar1) {
      iVar9 = iVar1;
    }
  }
  if (param_8 == 0) {
    param_8 = *(UINT *)(*param_1 + 4);
  }
  local_38 = param_2;
  iVar1 = MultiByteToWideChar(param_8,(-(uint)(param_9 != 0) & 8) + 1,param_4,iVar9,(LPWSTR)0x0,0);
  uVar10 = (ulonglong)iVar1;
  if (iVar1 == 0) goto LAB_180026cb6;
  puVar7 = auStackY_78;
  if (((0 < iVar1) && (puVar7 = auStackY_78, 1 < 0xffffffffffffffe0 / uVar10)) &&
     (puVar7 = auStackY_78, uVar10 * 2 < uVar10 * 2 + 0x10)) {
    uVar10 = uVar10 * 2 + 0x10;
    if (uVar10 < 0x401) {
      lVar3 = FUN_18001e920();
      lVar3 = -lVar3;
      puVar7 = auStackY_78 + lVar3;
      puVar6 = auStackY_78 + lVar3;
      pWVar4 = (LPCWSTR)((longlong)&local_38 + lVar3);
      if (pWVar4 == (LPCWSTR)0x0) goto LAB_180026cb6;
      pWVar4[0] = L'';
      pWVar4[1] = L'\0';
    }
    else {
      pWVar4 = (LPCWSTR)FUN_18001ed60(uVar10);
      puVar7 = auStackY_78;
      if (pWVar4 == (LPCWSTR)0x0) goto LAB_180026b1b;
      pWVar4[0] = L'\xdddd';
      pWVar4[1] = L'\0';
    }
    pWVar4 = pWVar4 + 8;
    puVar7 = puVar6;
  }
LAB_180026b1b:
  if (pWVar4 == (LPCWSTR)0x0) goto LAB_180026cb6;
  *(int *)(puVar7 + 0x28) = iVar1;
  *(LPCWSTR *)(puVar7 + 0x20) = pWVar4;
  *(undefined8 *)(puVar7 + -8) = 0x180026b42;
  iVar9 = MultiByteToWideChar(param_8,1,param_4,iVar9,*(LPWSTR *)(puVar7 + 0x20),
                              *(int *)(puVar7 + 0x28));
  lVar3 = local_38;
  puVar8 = puVar7;
  if (iVar9 != 0) {
    *(undefined4 *)(puVar7 + 0x28) = 0;
    *(undefined8 *)(puVar7 + 0x20) = 0;
    *(undefined8 *)(puVar7 + -8) = 0x180026b68;
    iVar9 = FUN_180026448(lVar3,param_3,pWVar4,iVar1,*(LPWSTR *)(puVar7 + 0x20),
                          *(int *)(puVar7 + 0x28));
    uVar10 = (ulonglong)iVar9;
    if (iVar9 != 0) {
      if ((param_3 & 0x400) == 0) {
        if (((iVar9 < 1) || (0xffffffffffffffe0 / uVar10 < 2)) || (uVar10 * 2 + 0x10 <= uVar10 * 2))
        {
          lpWideCharStr = (LPCWSTR)0x0;
        }
        else {
          uVar10 = uVar10 * 2 + 0x10;
          if (uVar10 < 0x401) {
            *(undefined8 *)(puVar7 + -8) = 0x180026bfd;
            lVar5 = FUN_18001e920();
            lVar5 = -lVar5;
            puVar8 = puVar7 + lVar5;
            lpWideCharStr = (LPCWSTR)(puVar7 + lVar5 + 0x40);
            if (lpWideCharStr == (LPCWSTR)0x0) goto LAB_180026ca3;
            lpWideCharStr[0] = L'';
            lpWideCharStr[1] = L'\0';
            puVar7 = puVar7 + lVar5;
          }
          else {
            *(undefined8 *)(puVar7 + -8) = 0x180026c1b;
            lpWideCharStr = (LPCWSTR)FUN_18001ed60(uVar10);
            if (lpWideCharStr == (LPCWSTR)0x0) goto LAB_180026c31;
            lpWideCharStr[0] = L'\xdddd';
            lpWideCharStr[1] = L'\0';
          }
          lpWideCharStr = lpWideCharStr + 8;
          puVar8 = puVar7;
        }
LAB_180026c31:
        if (lpWideCharStr != (LPCWSTR)0x0) {
          *(int *)(puVar8 + 0x28) = iVar9;
          *(LPCWSTR *)(puVar8 + 0x20) = lpWideCharStr;
          *(undefined8 *)(puVar8 + -8) = 0x180026c50;
          iVar1 = FUN_180026448(lVar3,param_3,pWVar4,iVar1,*(LPWSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28));
          if (iVar1 != 0) {
            *(undefined8 *)(puVar8 + 0x38) = 0;
            *(undefined8 *)(puVar8 + 0x30) = 0;
            if (param_7 == 0) {
              *(undefined4 *)(puVar8 + 0x28) = 0;
              *(undefined8 *)(puVar8 + 0x20) = 0;
            }
            else {
              *(int *)(puVar8 + 0x28) = param_7;
              *(undefined8 *)(puVar8 + 0x20) = param_6;
            }
            *(undefined8 *)(puVar8 + -8) = 0x180026c90;
            WideCharToMultiByte(param_8,0,lpWideCharStr,iVar9,*(LPSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28),*(LPCSTR *)(puVar8 + 0x30),
                                *(LPBOOL *)(puVar8 + 0x38));
          }
          if (*(int *)(lpWideCharStr + -8) == 0xdddd) {
            *(undefined8 *)(puVar8 + -8) = 0x180026ca3;
            FUN_18001d45c(lpWideCharStr + -8);
          }
        }
      }
      else if ((param_7 != 0) && (iVar9 <= param_7)) {
        *(int *)(puVar7 + 0x28) = param_7;
        *(undefined8 *)(puVar7 + 0x20) = param_6;
        *(undefined8 *)(puVar7 + -8) = 0x180026baf;
        FUN_180026448(lVar3,param_3,pWVar4,iVar1,*(LPWSTR *)(puVar7 + 0x20),*(int *)(puVar7 + 0x28))
        ;
      }
    }
  }
LAB_180026ca3:
  puVar7 = puVar8;
  if (*(int *)(pWVar4 + -8) == 0xdddd) {
    *(undefined8 *)(puVar8 + -8) = 0x180026cb4;
    FUN_18001d45c(pWVar4 + -8);
  }
LAB_180026cb6:
  uVar10 = local_30 ^ (ulonglong)&local_38;
  *(undefined8 *)(puVar7 + -8) = 0x180026cc2;
  FUN_18001d530(uVar10);
  return;
}



void FUN_180026cdc(longlong *param_1,longlong param_2,uint param_3,LPCSTR param_4,int param_5,
                  undefined8 param_6,int param_7,UINT param_8,int param_9)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_1800201c0(local_28,param_1);
  FUN_1800269f0(local_28,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_180026d74(longlong *param_1,DWORD param_2,LPCSTR param_3,int param_4,LPWORD param_5,
                  UINT param_6,int param_7)

{
  ulonglong uVar1;
  int iVar2;
  longlong lVar3;
  undefined1 (*lpSrcStr) [16];
  undefined1 *puVar4;
  undefined1 *puVar5;
  ulonglong uVar6;
  undefined1 auStackY_68 [32];
  ulonglong local_38 [2];
  
  puVar5 = auStackY_68;
  puVar4 = auStackY_68;
  local_38[0] = DAT_1800461a0 ^ (ulonglong)local_38;
  lpSrcStr = (undefined1 (*) [16])0x0;
  if (param_6 == 0) {
    param_6 = *(UINT *)(*param_1 + 4);
  }
  iVar2 = MultiByteToWideChar(param_6,(-(uint)(param_7 != 0) & 8) + 1,param_3,param_4,(LPWSTR)0x0,0)
  ;
  uVar6 = (ulonglong)iVar2;
  if (iVar2 == 0) goto LAB_180026ec4;
  puVar5 = auStackY_68;
  if (((0 < iVar2) && (puVar5 = auStackY_68, uVar6 < 0x7ffffffffffffff1)) &&
     (puVar5 = auStackY_68, uVar6 * 2 < uVar6 * 2 + 0x10)) {
    uVar1 = uVar6 * 2 + 0x10;
    if (uVar1 < 0x401) {
      lVar3 = FUN_18001e920();
      lVar3 = -lVar3;
      puVar5 = auStackY_68 + lVar3;
      puVar4 = auStackY_68 + lVar3;
      lpSrcStr = (undefined1 (*) [16])((longlong)local_38 + lVar3);
      if (lpSrcStr == (undefined1 (*) [16])0x0) goto LAB_180026ec4;
      *(undefined4 *)*lpSrcStr = 0xcccc;
    }
    else {
      lpSrcStr = (undefined1 (*) [16])FUN_18001ed60(uVar1);
      puVar5 = auStackY_68;
      if (lpSrcStr == (undefined1 (*) [16])0x0) goto LAB_180026e62;
      *(undefined4 *)*lpSrcStr = 0xdddd;
    }
    lpSrcStr = lpSrcStr + 1;
    puVar5 = puVar4;
  }
LAB_180026e62:
  if (lpSrcStr != (undefined1 (*) [16])0x0) {
    *(undefined8 *)(puVar5 + -8) = 0x180026e7b;
    FUN_18001dbc0(lpSrcStr,0,uVar6 * 2);
    *(int *)(puVar5 + 0x28) = iVar2;
    *(undefined1 (**) [16])(puVar5 + 0x20) = lpSrcStr;
    *(undefined8 *)(puVar5 + -8) = 0x180026e98;
    iVar2 = MultiByteToWideChar(param_6,1,param_3,param_4,*(LPWSTR *)(puVar5 + 0x20),
                                *(int *)(puVar5 + 0x28));
    if (iVar2 != 0) {
      *(undefined8 *)(puVar5 + -8) = 0x180026eaf;
      GetStringTypeW(param_2,(LPCWSTR)lpSrcStr,iVar2,param_5);
    }
    if (*(int *)lpSrcStr[-1] == 0xdddd) {
      *(undefined8 *)(puVar5 + -8) = 0x180026ec2;
      FUN_18001d45c(lpSrcStr + -1);
    }
  }
LAB_180026ec4:
  uVar6 = local_38[0] ^ (ulonglong)local_38;
  *(undefined8 *)(puVar5 + -8) = 0x180026ed0;
  FUN_18001d530(uVar6);
  return;
}



void FUN_180026eec(longlong *param_1,DWORD param_2,LPCSTR param_3,int param_4,LPWORD param_5,
                  UINT param_6,int param_7)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_1800201c0(local_28,param_1);
  FUN_180026d74(local_28,param_2,param_3,param_4,param_5,param_6,param_7);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



ulonglong FUN_180026f68(int *param_1)

{
  int iVar1;
  uint uVar2;
  DWORD DVar3;
  undefined4 extraout_var;
  undefined8 uVar4;
  ulonglong uVar5;
  
  if (param_1 == (int *)0x0) {
    iVar1 = FUN_18002703c(0);
    return CONCAT44(extraout_var,iVar1);
  }
  uVar4 = FUN_180026fb4(param_1);
  if ((int)uVar4 == 0) {
    if ((param_1[6] & 0x4000U) == 0) {
      uVar5 = 0;
    }
    else {
      uVar2 = FUN_1800250a8((longlong)param_1);
      DVar3 = FUN_180027aa4(uVar2);
      uVar5 = (ulonglong)-(uint)(DVar3 != 0);
    }
  }
  else {
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



undefined8 FUN_180026fb4(int *param_1)

{
  uint uVar1;
  undefined8 uVar2;
  uint uVar3;
  
  uVar2 = 0;
  if (((((byte)param_1[6] & 3) == 2) && ((param_1[6] & 0x108U) != 0)) &&
     (uVar3 = *param_1 - param_1[4], 0 < (int)uVar3)) {
    uVar1 = FUN_1800250a8((longlong)param_1);
    uVar1 = FUN_180025130(uVar1,*(WCHAR **)(param_1 + 4),uVar3);
    if (uVar1 == uVar3) {
      uVar2 = 0;
      if ((char)param_1[6] < '\0') {
        param_1[6] = param_1[6] & 0xfffffffd;
      }
    }
    else {
      param_1[6] = param_1[6] | 0x20;
      uVar2 = 0xffffffff;
    }
  }
  param_1[2] = 0;
  *(undefined8 *)param_1 = *(undefined8 *)(param_1 + 4);
  return uVar2;
}



void FUN_180027030(void)

{
  FUN_18002703c(1);
  return;
}



int FUN_18002703c(int param_1)

{
  longlong lVar1;
  int *piVar2;
  ulonglong uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  
  iVar5 = 0;
  iVar6 = 0;
  FUN_180023ff8(1);
  for (iVar4 = 0; iVar4 < DAT_180049f50; iVar4 = iVar4 + 1) {
    lVar7 = (longlong)iVar4;
    lVar1 = *(longlong *)(DAT_180049f48 + lVar7 * 8);
    if ((lVar1 != 0) && ((*(byte *)(lVar1 + 0x18) & 0x83) != 0)) {
      FUN_180025004(iVar4,lVar1);
      piVar2 = *(int **)(DAT_180049f48 + lVar7 * 8);
      if ((*(byte *)(piVar2 + 6) & 0x83) != 0) {
        if (param_1 == 1) {
          uVar3 = FUN_180026f68(piVar2);
          if ((int)uVar3 != -1) {
            iVar5 = iVar5 + 1;
          }
        }
        else if (((param_1 == 0) && ((*(byte *)(piVar2 + 6) & 2) != 0)) &&
                (uVar3 = FUN_180026f68(piVar2), (int)uVar3 == -1)) {
          iVar6 = -1;
        }
      }
      FUN_180025088(iVar4,*(longlong *)(DAT_180049f48 + lVar7 * 8));
    }
  }
  FUN_1800241e8(1);
  if (param_1 == 1) {
    iVar6 = iVar5;
  }
  return iVar6;
}



int FUN_180027124(void)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  int iVar5;
  
  iVar5 = 0;
  FUN_180023ff8(1);
  for (iVar3 = 3; iVar3 < DAT_180049f50; iVar3 = iVar3 + 1) {
    lVar4 = (longlong)iVar3;
    piVar1 = *(int **)(DAT_180049f48 + lVar4 * 8);
    if (piVar1 != (int *)0x0) {
      if ((*(byte *)(piVar1 + 6) & 0x83) != 0) {
        iVar2 = FUN_180027bf8(piVar1);
        if (iVar2 != -1) {
          iVar5 = iVar5 + 1;
        }
      }
      if (0x13 < iVar3) {
        DeleteCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(DAT_180049f48 + lVar4 * 8) + 0x30))
        ;
        FUN_18001d45c(*(LPVOID *)(DAT_180049f48 + lVar4 * 8));
        *(undefined8 *)(DAT_180049f48 + lVar4 * 8) = 0;
      }
    }
  }
  FUN_1800241e8(1);
  return iVar5;
}



undefined8 FUN_1800271cc(uint param_1)

{
  int *piVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
  lVar2 = (&DAT_180049240)[(longlong)(int)param_1 >> 5];
  if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
    FUN_180023ff8(10);
    if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
      FUN_1800235b8((LPCRITICAL_SECTION)(lVar3 + 0x10 + lVar2),4000);
      piVar1 = (int *)(lVar3 + 0xc + lVar2);
      *piVar1 = *piVar1 + 1;
    }
    FUN_1800241e8(10);
  }
  EnterCriticalSection
            ((LPCRITICAL_SECTION)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 0x10 + lVar3));
  return 1;
}



undefined8 FUN_180027264(uint param_1)

{
  DWORD *pDVar1;
  DWORD nStdHandle;
  longlong lVar2;
  
  if ((-1 < (int)param_1) && (param_1 < DAT_18004b088)) {
    lVar2 = (ulonglong)(param_1 & 0x1f) * 0x58;
    if (((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar2) & 1) != 0) &&
       (*(longlong *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + lVar2) != -1)) {
      if (DAT_180049550 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_1800272da;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_1800272da:
      *(undefined8 *)(lVar2 + (&DAT_180049240)[(longlong)(int)param_1 >> 5]) = 0xffffffffffffffff;
      return 0;
    }
  }
  pDVar1 = FUN_18001fa28();
  *pDVar1 = 9;
  pDVar1 = FUN_18001f9b8();
  *pDVar1 = 0;
  return 0xffffffff;
}



undefined8 FUN_180027310(uint param_1)

{
  DWORD *pDVar1;
  longlong lVar2;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_18001f9b8();
    *pDVar1 = 0;
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004b088)) {
      lVar2 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar2) & 1) != 0) {
        return *(undefined8 *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + lVar2);
      }
    }
    pDVar1 = FUN_18001f9b8();
    *pDVar1 = 0;
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 9;
    FUN_18001ffd8();
  }
  return 0xffffffffffffffff;
}



void FUN_180027384(uint param_1)

{
                    // WARNING: Could not recover jumptable at 0x0001800273a7. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((ulonglong)(param_1 & 0x1f) * 0x58 + 0x10 +
             (&DAT_180049240)[(longlong)(int)param_1 >> 5]));
  return;
}



undefined2 FUN_1800273b0(undefined2 param_1)

{
  BOOL BVar1;
  undefined2 local_res8 [4];
  DWORD local_res10 [6];
  
  local_res8[0] = param_1;
  if (DAT_180047440 == (HANDLE)0xfffffffffffffffe) {
    FUN_180027c80();
  }
  if ((DAT_180047440 == (HANDLE)0xffffffffffffffff) ||
     (BVar1 = WriteConsoleW(DAT_180047440,local_res8,1,local_res10,(LPVOID)0x0), BVar1 == 0)) {
    local_res8[0] = 0xffff;
  }
  return local_res8[0];
}



void FUN_18002740c(longlong param_1)

{
  if (param_1 != 0) {
    if (*(undefined **)(param_1 + 0x18) != PTR_DAT_1800473a8) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x18));
    }
    if (*(undefined **)(param_1 + 0x20) != PTR_DAT_1800473b0) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x20));
    }
    if (*(undefined **)(param_1 + 0x28) != PTR_DAT_1800473b8) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x28));
    }
    if (*(undefined **)(param_1 + 0x30) != PTR_DAT_1800473c0) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x30));
    }
    if (*(undefined **)(param_1 + 0x38) != PTR_DAT_1800473c8) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x38));
    }
    if (*(undefined **)(param_1 + 0x40) != PTR_DAT_1800473d0) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x40));
    }
    if (*(undefined **)(param_1 + 0x48) != PTR_DAT_1800473d8) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x48));
    }
    if (*(undefined **)(param_1 + 0x68) != PTR_DAT_1800473f8) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x68));
    }
    if (*(undefined **)(param_1 + 0x70) != PTR_DAT_180047400) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x70));
    }
    if (*(undefined **)(param_1 + 0x78) != PTR_DAT_180047408) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x78));
    }
    if (*(undefined **)(param_1 + 0x80) != PTR_DAT_180047410) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x80));
    }
    if (*(undefined **)(param_1 + 0x88) != PTR_DAT_180047418) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x88));
    }
    if (*(undefined **)(param_1 + 0x90) != PTR_DAT_180047420) {
      FUN_18001d45c(*(undefined **)(param_1 + 0x90));
    }
  }
  return;
}



void FUN_180027518(undefined8 *param_1)

{
  if (param_1 != (undefined8 *)0x0) {
    if ((undefined *)*param_1 != PTR_DAT_180047390) {
      FUN_18001d45c((undefined *)*param_1);
    }
    if ((undefined *)param_1[1] != PTR_DAT_180047398) {
      FUN_18001d45c((undefined *)param_1[1]);
    }
    if ((undefined *)param_1[2] != PTR_DAT_1800473a0) {
      FUN_18001d45c((undefined *)param_1[2]);
    }
    if ((undefined *)param_1[0xb] != PTR_DAT_1800473e8) {
      FUN_18001d45c((undefined *)param_1[0xb]);
    }
    if ((undefined *)param_1[0xc] != PTR_DAT_1800473f0) {
      FUN_18001d45c((undefined *)param_1[0xc]);
    }
  }
  return;
}



void FUN_180027584(undefined8 *param_1)

{
  if (param_1 != (undefined8 *)0x0) {
    FUN_18001d45c((LPVOID)param_1[1]);
    FUN_18001d45c((LPVOID)param_1[2]);
    FUN_18001d45c((LPVOID)param_1[3]);
    FUN_18001d45c((LPVOID)param_1[4]);
    FUN_18001d45c((LPVOID)param_1[5]);
    FUN_18001d45c((LPVOID)param_1[6]);
    FUN_18001d45c((LPVOID)*param_1);
    FUN_18001d45c((LPVOID)param_1[8]);
    FUN_18001d45c((LPVOID)param_1[9]);
    FUN_18001d45c((LPVOID)param_1[10]);
    FUN_18001d45c((LPVOID)param_1[0xb]);
    FUN_18001d45c((LPVOID)param_1[0xc]);
    FUN_18001d45c((LPVOID)param_1[0xd]);
    FUN_18001d45c((LPVOID)param_1[7]);
    FUN_18001d45c((LPVOID)param_1[0xe]);
    FUN_18001d45c((LPVOID)param_1[0xf]);
    FUN_18001d45c((LPVOID)param_1[0x10]);
    FUN_18001d45c((LPVOID)param_1[0x11]);
    FUN_18001d45c((LPVOID)param_1[0x12]);
    FUN_18001d45c((LPVOID)param_1[0x13]);
    FUN_18001d45c((LPVOID)param_1[0x14]);
    FUN_18001d45c((LPVOID)param_1[0x15]);
    FUN_18001d45c((LPVOID)param_1[0x16]);
    FUN_18001d45c((LPVOID)param_1[0x17]);
    FUN_18001d45c((LPVOID)param_1[0x18]);
    FUN_18001d45c((LPVOID)param_1[0x19]);
    FUN_18001d45c((LPVOID)param_1[0x1a]);
    FUN_18001d45c((LPVOID)param_1[0x1b]);
    FUN_18001d45c((LPVOID)param_1[0x1c]);
    FUN_18001d45c((LPVOID)param_1[0x1d]);
    FUN_18001d45c((LPVOID)param_1[0x1e]);
    FUN_18001d45c((LPVOID)param_1[0x1f]);
    FUN_18001d45c((LPVOID)param_1[0x20]);
    FUN_18001d45c((LPVOID)param_1[0x21]);
    FUN_18001d45c((LPVOID)param_1[0x22]);
    FUN_18001d45c((LPVOID)param_1[0x23]);
    FUN_18001d45c((LPVOID)param_1[0x24]);
    FUN_18001d45c((LPVOID)param_1[0x25]);
    FUN_18001d45c((LPVOID)param_1[0x26]);
    FUN_18001d45c((LPVOID)param_1[0x27]);
    FUN_18001d45c((LPVOID)param_1[0x28]);
    FUN_18001d45c((LPVOID)param_1[0x29]);
    FUN_18001d45c((LPVOID)param_1[0x2a]);
    FUN_18001d45c((LPVOID)param_1[0x2d]);
    FUN_18001d45c((LPVOID)param_1[0x2e]);
    FUN_18001d45c((LPVOID)param_1[0x2f]);
    FUN_18001d45c((LPVOID)param_1[0x30]);
    FUN_18001d45c((LPVOID)param_1[0x31]);
    FUN_18001d45c((LPVOID)param_1[0x32]);
    FUN_18001d45c((LPVOID)param_1[0x2c]);
    FUN_18001d45c((LPVOID)param_1[0x34]);
    FUN_18001d45c((LPVOID)param_1[0x35]);
    FUN_18001d45c((LPVOID)param_1[0x36]);
    FUN_18001d45c((LPVOID)param_1[0x37]);
    FUN_18001d45c((LPVOID)param_1[0x38]);
    FUN_18001d45c((LPVOID)param_1[0x39]);
    FUN_18001d45c((LPVOID)param_1[0x33]);
    FUN_18001d45c((LPVOID)param_1[0x3a]);
    FUN_18001d45c((LPVOID)param_1[0x3b]);
    FUN_18001d45c((LPVOID)param_1[0x3c]);
    FUN_18001d45c((LPVOID)param_1[0x3d]);
    FUN_18001d45c((LPVOID)param_1[0x3e]);
    FUN_18001d45c((LPVOID)param_1[0x3f]);
    FUN_18001d45c((LPVOID)param_1[0x40]);
    FUN_18001d45c((LPVOID)param_1[0x41]);
    FUN_18001d45c((LPVOID)param_1[0x42]);
    FUN_18001d45c((LPVOID)param_1[0x43]);
    FUN_18001d45c((LPVOID)param_1[0x44]);
    FUN_18001d45c((LPVOID)param_1[0x45]);
    FUN_18001d45c((LPVOID)param_1[0x46]);
    FUN_18001d45c((LPVOID)param_1[0x47]);
    FUN_18001d45c((LPVOID)param_1[0x48]);
    FUN_18001d45c((LPVOID)param_1[0x49]);
    FUN_18001d45c((LPVOID)param_1[0x4a]);
    FUN_18001d45c((LPVOID)param_1[0x4b]);
    FUN_18001d45c((LPVOID)param_1[0x4c]);
    FUN_18001d45c((LPVOID)param_1[0x4d]);
    FUN_18001d45c((LPVOID)param_1[0x4e]);
    FUN_18001d45c((LPVOID)param_1[0x4f]);
    FUN_18001d45c((LPVOID)param_1[0x50]);
    FUN_18001d45c((LPVOID)param_1[0x51]);
    FUN_18001d45c((LPVOID)param_1[0x52]);
    FUN_18001d45c((LPVOID)param_1[0x53]);
    FUN_18001d45c((LPVOID)param_1[0x54]);
    FUN_18001d45c((LPVOID)param_1[0x55]);
    FUN_18001d45c((LPVOID)param_1[0x56]);
    FUN_18001d45c((LPVOID)param_1[0x57]);
  }
  return;
}



ushort FUN_180027980(int param_1,ushort param_2,longlong *param_3)

{
  ushort uVar1;
  undefined6 extraout_var;
  int iVar2;
  ushort local_res8 [4];
  CHAR local_res20;
  CHAR local_res21;
  undefined1 local_res22;
  longlong local_38 [2];
  longlong local_28;
  char local_20;
  
  FUN_1800201c0(local_38,param_3);
  if (param_1 + 1U < 0x101) {
    local_res8[0] = *(ushort *)(*(longlong *)(local_38[0] + 0x108) + (longlong)param_1 * 2);
  }
  else {
    uVar1 = FUN_180025f7c(param_1 >> 8 & 0xff,local_38);
    iVar2 = 1;
    if ((int)CONCAT62(extraout_var,uVar1) == 0) {
      local_res21 = '\0';
      local_res20 = (CHAR)param_1;
    }
    else {
      local_res22 = 0;
      iVar2 = 2;
      local_res20 = (CHAR)((uint)param_1 >> 8);
      local_res21 = (CHAR)param_1;
    }
    iVar2 = FUN_180026eec(local_38,1,&local_res20,iVar2,local_res8,*(UINT *)(local_38[0] + 4),1);
    if (iVar2 == 0) {
      if (local_20 != '\0') {
        *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
      }
      return 0;
    }
  }
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return local_res8[0] & param_2;
}



void FUN_180027a5c(void)

{
  if (PTR_DAT_180047210 != &DAT_180047220) {
    FUN_180023ff8(0xc);
    PTR_DAT_180047210 = (undefined *)FUN_180025f18(&PTR_DAT_180047210,(int *)&DAT_180047220);
    FUN_1800241e8(0xc);
  }
  return;
}



DWORD FUN_180027aa4(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  HANDLE hFile;
  longlong lVar4;
  
  if (param_1 == 0xfffffffe) {
    pDVar3 = FUN_18001fa28();
    *pDVar3 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004b088)) {
      lVar4 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar4) & 1) != 0) {
        FUN_1800271cc(param_1);
        if ((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar4) & 1) != 0) {
          hFile = (HANDLE)FUN_180027310(param_1);
          BVar1 = FlushFileBuffers(hFile);
          if (BVar1 == 0) {
            DVar2 = GetLastError();
          }
          else {
            DVar2 = 0;
          }
          if (DVar2 == 0) goto LAB_180027b4f;
          pDVar3 = FUN_18001f9b8();
          *pDVar3 = DVar2;
        }
        pDVar3 = FUN_18001fa28();
        *pDVar3 = 9;
        DVar2 = 0xffffffff;
LAB_180027b4f:
        FUN_180027384(param_1);
        return DVar2;
      }
    }
    pDVar3 = FUN_18001fa28();
    *pDVar3 = 9;
    FUN_18001ffd8();
  }
  return 0xffffffff;
}



undefined4 FUN_180027b7c(int *param_1)

{
  undefined4 uVar1;
  uint uVar2;
  DWORD *pDVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  
  uVar1 = 0xffffffff;
  if (param_1 == (int *)0x0) {
    pDVar3 = FUN_18001fa28();
    *pDVar3 = 0x16;
    FUN_18001ffd8();
    uVar1 = 0xffffffff;
  }
  else {
    if ((*(byte *)(param_1 + 6) & 0x83) != 0) {
      uVar4 = FUN_180026fb4(param_1);
      uVar1 = (undefined4)uVar4;
      FUN_18002806c((undefined8 *)param_1);
      uVar2 = FUN_1800250a8((longlong)param_1);
      uVar5 = FUN_180027eec(uVar2);
      if ((int)uVar5 < 0) {
        uVar1 = 0xffffffff;
      }
      else if (*(LPVOID *)(param_1 + 10) != (LPVOID)0x0) {
        FUN_18001d45c(*(LPVOID *)(param_1 + 10));
        param_1[10] = 0;
        param_1[0xb] = 0;
      }
    }
    param_1[6] = 0;
  }
  return uVar1;
}



undefined4 FUN_180027bf8(int *param_1)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  
  uVar1 = 0xffffffff;
  if (param_1 == (int *)0x0) {
    pDVar2 = FUN_18001fa28();
    *pDVar2 = 0x16;
    FUN_18001ffd8();
    uVar1 = 0xffffffff;
  }
  else if ((*(byte *)(param_1 + 6) & 0x40) == 0) {
    FUN_180024f9c((ulonglong)param_1);
    uVar1 = FUN_180027b7c(param_1);
    FUN_180025038((ulonglong)param_1);
  }
  else {
    param_1[6] = 0;
  }
  return uVar1;
}



void FUN_180027c60(void)

{
  if (1 < (longlong)DAT_180047440 + 2U) {
    CloseHandle(DAT_180047440);
  }
  return;
}



void FUN_180027c80(void)

{
  DAT_180047440 = CreateFileW(L"CONOUT$",0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  return;
}



void FUN_180027cbc(uint *param_1,byte *param_2,longlong *param_3,undefined8 *param_4)

{
  undefined1 auStackY_98 [32];
  undefined8 local_58;
  longlong local_50 [2];
  longlong local_40;
  char local_38;
  ushort local_30 [8];
  ulonglong local_20;
  
  local_20 = DAT_1800461a0 ^ (ulonglong)auStackY_98;
  FUN_1800201c0(local_50,param_3);
  FUN_180028c20(local_30,(ushort *)&local_58,param_2,0,0,0,0,local_50);
  if (param_4 != (undefined8 *)0x0) {
    *param_4 = local_58;
  }
  FUN_180028668(local_30,param_1);
  if (local_38 != '\0') {
    *(uint *)(local_40 + 200) = *(uint *)(local_40 + 200) & 0xfffffffd;
  }
  FUN_18001d530(local_20 ^ (ulonglong)auStackY_98);
  return;
}



void FUN_180027d8c(uint *param_1,byte *param_2,longlong *param_3)

{
  undefined1 auStackY_88 [32];
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  ushort local_28 [4];
  ushort local_20 [8];
  ulonglong local_10;
  
  local_10 = DAT_1800461a0 ^ (ulonglong)auStackY_88;
  FUN_1800201c0(local_48,param_3);
  FUN_180028c20(local_20,local_28,param_2,0,0,0,0,local_48);
  FUN_1800280b0(local_20,param_1);
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  FUN_18001d530(local_10 ^ (ulonglong)auStackY_88);
  return;
}



void FUN_180027e54(uint *param_1,byte *param_2,longlong *param_3)

{
  FUN_180027cbc(param_1,param_2,param_3,(undefined8 *)0x0);
  return;
}



void thunk_FUN_180027e64(void)

{
  PTR_LAB_1800465f8 = &LAB_180029f38;
  PTR_LAB_1800465f0 = FUN_180029484;
  PTR_LAB_180046600 = &LAB_180029fd8;
  PTR_LAB_180046618 = FUN_180029484;
  PTR_LAB_180046608 = &LAB_18002a020;
  PTR_LAB_180046610 = &LAB_18002a0a8;
  PTR_LAB_180046620 = FUN_1800294a8;
  PTR_LAB_180046628 = FUN_180029fe0;
  PTR_LAB_180046630 = FUN_180029f40;
  PTR_LAB_180046638 = FUN_18002a028;
  return;
}



void FUN_180027e64(void)

{
  PTR_LAB_1800465f8 = &LAB_180029f38;
  PTR_LAB_1800465f0 = FUN_180029484;
  PTR_LAB_180046600 = &LAB_180029fd8;
  PTR_LAB_180046618 = FUN_180029484;
  PTR_LAB_180046608 = &LAB_18002a020;
  PTR_LAB_180046610 = &LAB_18002a0a8;
  PTR_LAB_180046620 = FUN_1800294a8;
  PTR_LAB_180046628 = FUN_180029fe0;
  PTR_LAB_180046630 = FUN_180029f40;
  PTR_LAB_180046638 = FUN_18002a028;
  return;
}



ulonglong FUN_180027eec(uint param_1)

{
  DWORD *pDVar1;
  ulonglong uVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    pDVar1 = FUN_18001f9b8();
    *pDVar1 = 0;
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004b088)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) != 0) {
        FUN_1800271cc(param_1);
        if ((*(byte *)((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + lVar3) & 1) == 0) {
          pDVar1 = FUN_18001fa28();
          *pDVar1 = 9;
          uVar2 = 0xffffffff;
        }
        else {
          uVar2 = FUN_180027fb0(param_1);
          uVar2 = uVar2 & 0xffffffff;
        }
        FUN_180027384(param_1);
        return uVar2;
      }
    }
    pDVar1 = FUN_18001f9b8();
    *pDVar1 = 0;
    pDVar1 = FUN_18001fa28();
    *pDVar1 = 9;
    FUN_18001ffd8();
  }
  return 0xffffffff;
}



undefined8 FUN_180027fb0(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  longlong lVar3;
  longlong lVar4;
  HANDLE hObject;
  undefined8 uVar5;
  
  lVar3 = FUN_180027310(param_1);
  if (lVar3 != -1) {
    if (((param_1 == 1) && ((*(byte *)(DAT_180049240 + 0xb8) & 1) != 0)) ||
       ((param_1 == 2 && ((*(byte *)(DAT_180049240 + 0x60) & 1) != 0)))) {
      lVar3 = FUN_180027310(2);
      lVar4 = FUN_180027310(1);
      if (lVar4 == lVar3) goto LAB_180028023;
    }
    hObject = (HANDLE)FUN_180027310(param_1);
    BVar1 = CloseHandle(hObject);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      goto LAB_180028025;
    }
  }
LAB_180028023:
  DVar2 = 0;
LAB_180028025:
  FUN_180027264(param_1);
  *(undefined1 *)
   ((&DAT_180049240)[(longlong)(int)param_1 >> 5] + 8 + (ulonglong)(param_1 & 0x1f) * 0x58) = 0;
  if (DVar2 == 0) {
    uVar5 = 0;
  }
  else {
    FUN_18001f9d8(DVar2);
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



void FUN_18002806c(undefined8 *param_1)

{
  if (((*(byte *)(param_1 + 3) & 0x83) != 0) && ((*(byte *)(param_1 + 3) & 8) != 0)) {
    FUN_18001d45c((LPVOID)param_1[2]);
    *(uint *)(param_1 + 3) = *(uint *)(param_1 + 3) & 0xfffffbf7;
    *param_1 = 0;
    param_1[2] = 0;
    *(undefined4 *)(param_1 + 1) = 0;
  }
  return;
}



void FUN_1800280b0(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  uint *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined1 auStack_88 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800461a0 ^ (ulonglong)auStack_88;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_180047460 + -1;
    uVar7 = DAT_180047460 >> 0x1f & 0x1f;
    uVar1 = DAT_180047460 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_1800281d1;
        }
      }
      else {
LAB_1800281d1:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *puVar13 = *puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_18001dbc0((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_18004745c - DAT_180047460) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else if (DAT_18004745c < iVar11) {
      uVar10 = DAT_180047464 >> 0x1f & 0x1f;
      iVar15 = DAT_180047464 + uVar10;
      bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
      iVar15 = iVar15 >> 5;
      uVar10 = ~(-1 << (bVar4 & 0x1f));
      if (iVar11 < DAT_180047458) {
        local_40 = local_40 & 0xffffffff7fffffff;
        iVar2 = DAT_18004746c + iVar11;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = *puVar13;
          *puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = puVar13 + 1;
          uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
      }
      else {
        local_40 = 0x80000000;
        local_38 = 0;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = (uint)uVar3;
          uVar3 = (ulonglong)((uVar10 & *puVar13) << (0x20 - bVar4 & 0x1f));
          *puVar13 = *puVar13 >> (bVar4 & 0x1f) | uVar1;
          puVar13 = puVar13 + 1;
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = DAT_18004746c + DAT_180047458;
      }
    }
    else {
      local_40 = local_48;
      local_38 = local_50;
      uVar10 = DAT_18004745c - local_68 >> 0x1f & 0x1f;
      puVar13 = (uint *)&local_40;
      iVar2 = (DAT_18004745c - local_68) + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      uVar6 = uVar3;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
        puVar13 = puVar13 + 1;
        uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar17 = lVar17 + -1;
      } while (lVar17 != 0);
      lVar16 = (longlong)(iVar2 >> 5);
      lVar17 = 2;
      lVar18 = 3;
      lVar5 = 2;
      do {
        if (lVar5 < lVar16) {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
        }
        lVar5 = lVar5 + -1;
      } while (-1 < lVar5);
      uVar1 = local_60 + 1 >> 0x1f & 0x1f;
      uVar10 = local_60 + 1 + uVar1;
      iVar2 = (int)uVar10 >> 5;
      uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
      bVar4 = (byte)uVar10;
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0) {
          for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
            if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_1800283ab;
          }
        }
        else {
LAB_1800283ab:
          uVar10 = local_60 >> 0x1f & 0x1f;
          iVar11 = local_60 + uVar10;
          iVar15 = iVar11 >> 5;
          uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
          uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
          uVar10 = uVar1 + uVar7;
          if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
            uVar6 = uVar9;
          }
          *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
          lVar5 = (longlong)(iVar15 + -1);
          if (-1 < iVar15 + -1) {
            do {
              if ((int)uVar6 == 0) break;
              uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
              uVar10 = uVar1 + 1;
              if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                uVar6 = uVar9;
              }
              *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
              lVar5 = lVar5 + -1;
            } while (-1 < lVar5);
          }
        }
      }
      puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar2 * 4);
      *puVar13 = *puVar13 & -1 << (bVar4 & 0x1f);
      lVar5 = (longlong)(iVar2 + 1);
      if (lVar5 < 3) {
        FUN_18001dbc0((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
      }
      puVar13 = (uint *)&local_40;
      uVar10 = DAT_180047464 + 1 >> 0x1f & 0x1f;
      iVar2 = DAT_180047464 + 1 + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
        puVar13 = puVar13 + 1;
        uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar18 = lVar18 + -1;
      } while (lVar18 != 0);
      lVar5 = (longlong)(iVar2 >> 5);
      do {
        if (lVar17 < lVar5) {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
        }
        lVar17 = lVar17 + -1;
      } while (-1 < lVar17);
      iVar2 = 0;
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  uVar10 = iVar2 << (0x1fU - (char)DAT_180047464 & 0x1f) | -(uint)bVar19 & 0x80000000 |
           (uint)local_40;
  if (DAT_180047468 == 0x40) {
    local_58[1] = uVar10;
    *local_58 = local_40._4_4_;
  }
  else if (DAT_180047468 == 0x20) {
    *local_58 = uVar10;
  }
  FUN_18001d530(local_30 ^ (ulonglong)auStack_88);
  return;
}



void FUN_180028668(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  uint *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined1 auStack_88 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800461a0 ^ (ulonglong)auStack_88;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_180047478 + -1;
    uVar7 = DAT_180047478 >> 0x1f & 0x1f;
    uVar1 = DAT_180047478 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_180028789;
        }
      }
      else {
LAB_180028789:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *puVar13 = *puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_18001dbc0((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_180047474 - DAT_180047478) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else if (DAT_180047474 < iVar11) {
      uVar10 = DAT_18004747c >> 0x1f & 0x1f;
      iVar15 = DAT_18004747c + uVar10;
      bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
      iVar15 = iVar15 >> 5;
      uVar10 = ~(-1 << (bVar4 & 0x1f));
      if (iVar11 < DAT_180047470) {
        local_40 = local_40 & 0xffffffff7fffffff;
        iVar2 = DAT_180047484 + iVar11;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = *puVar13;
          *puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = puVar13 + 1;
          uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
      }
      else {
        local_40 = 0x80000000;
        local_38 = 0;
        puVar13 = (uint *)&local_40;
        do {
          uVar1 = (uint)uVar3;
          uVar3 = (ulonglong)((uVar10 & *puVar13) << (0x20 - bVar4 & 0x1f));
          *puVar13 = *puVar13 >> (bVar4 & 0x1f) | uVar1;
          puVar13 = puVar13 + 1;
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar17 = 2;
        do {
          if (lVar17 < iVar15) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = DAT_180047484 + DAT_180047470;
      }
    }
    else {
      local_40 = local_48;
      local_38 = local_50;
      uVar10 = DAT_180047474 - local_68 >> 0x1f & 0x1f;
      puVar13 = (uint *)&local_40;
      iVar2 = (DAT_180047474 - local_68) + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      uVar6 = uVar3;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
        puVar13 = puVar13 + 1;
        uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar17 = lVar17 + -1;
      } while (lVar17 != 0);
      lVar16 = (longlong)(iVar2 >> 5);
      lVar17 = 2;
      lVar18 = 3;
      lVar5 = 2;
      do {
        if (lVar5 < lVar16) {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
        }
        lVar5 = lVar5 + -1;
      } while (-1 < lVar5);
      uVar1 = local_60 + 1 >> 0x1f & 0x1f;
      uVar10 = local_60 + 1 + uVar1;
      iVar2 = (int)uVar10 >> 5;
      uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
      bVar4 = (byte)uVar10;
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0) {
          for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
            if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_180028963;
          }
        }
        else {
LAB_180028963:
          uVar10 = local_60 >> 0x1f & 0x1f;
          iVar11 = local_60 + uVar10;
          iVar15 = iVar11 >> 5;
          uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
          uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
          uVar10 = uVar1 + uVar7;
          if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
            uVar6 = uVar9;
          }
          *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
          lVar5 = (longlong)(iVar15 + -1);
          if (-1 < iVar15 + -1) {
            do {
              if ((int)uVar6 == 0) break;
              uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
              uVar10 = uVar1 + 1;
              if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                uVar6 = uVar9;
              }
              *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
              lVar5 = lVar5 + -1;
            } while (-1 < lVar5);
          }
        }
      }
      puVar13 = (uint *)((longlong)&local_40 + (longlong)iVar2 * 4);
      *puVar13 = *puVar13 & -1 << (bVar4 & 0x1f);
      lVar5 = (longlong)(iVar2 + 1);
      if (lVar5 < 3) {
        FUN_18001dbc0((undefined1 (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
      }
      puVar13 = (uint *)&local_40;
      uVar10 = DAT_18004747c + 1 >> 0x1f & 0x1f;
      iVar2 = DAT_18004747c + 1 + uVar10;
      bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
      do {
        uVar10 = *puVar13;
        *puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
        puVar13 = puVar13 + 1;
        uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
        lVar18 = lVar18 + -1;
      } while (lVar18 != 0);
      lVar5 = (longlong)(iVar2 >> 5);
      do {
        if (lVar17 < lVar5) {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
        }
        else {
          *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
               *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
        }
        lVar17 = lVar17 + -1;
      } while (-1 < lVar17);
      iVar2 = 0;
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  uVar10 = iVar2 << (0x1fU - (char)DAT_18004747c & 0x1f) | -(uint)bVar19 & 0x80000000 |
           (uint)local_40;
  if (DAT_180047480 == 0x40) {
    local_58[1] = uVar10;
    *local_58 = local_40._4_4_;
  }
  else if (DAT_180047480 == 0x20) {
    *local_58 = uVar10;
  }
  FUN_18001d530(local_30 ^ (ulonglong)auStack_88);
  return;
}



void FUN_180028c20(ushort *param_1,ushort *param_2,byte *param_3,int param_4,int param_5,int param_6
                  ,int param_7,longlong *param_8)

{
  undefined8 uVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  DWORD *pDVar5;
  byte bVar6;
  ushort uVar7;
  ulonglong uVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  undefined **ppuVar12;
  ushort *puVar13;
  byte *pbVar14;
  ushort *puVar15;
  ushort uVar16;
  byte *pbVar17;
  uint uVar18;
  uint uVar19;
  uint *puVar20;
  int iVar21;
  uint uVar22;
  char *pcVar23;
  ushort uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  undefined1 auStack_d8 [32];
  int local_b8;
  int local_b4;
  uint local_b0;
  int local_ac;
  ushort *local_a8;
  undefined **local_a0;
  ushort *local_98;
  byte local_90;
  undefined1 uStack_8f;
  undefined4 uStack_8e;
  undefined4 uStack_8a;
  ushort uStack_86;
  undefined4 local_80;
  undefined2 uStack_7c;
  undefined2 uStack_7a;
  undefined4 uStack_78;
  undefined8 local_70;
  undefined4 local_68;
  char local_60 [23];
  char local_49;
  ulonglong local_40;
  
  local_40 = DAT_1800461a0 ^ (ulonglong)auStack_d8;
  uVar9 = 0;
  uVar27 = 0;
  pcVar23 = local_60;
  uVar2 = 0;
  local_b0 = local_b0 & 0xffff0000;
  iVar10 = 0;
  local_b4 = 1;
  local_b8 = 0;
  uVar19 = 0;
  pbVar14 = param_3;
  local_ac = param_4;
  local_a8 = param_2;
  local_98 = param_1;
  if (param_8 == (longlong *)0x0) {
    pDVar5 = FUN_18001fa28();
    *pDVar5 = 0x16;
    FUN_18001ffd8();
    goto LAB_18002945a;
  }
  while ((uVar22 = uVar9, uVar3 = uVar9, uVar11 = uVar9, uVar18 = uVar9, uVar25 = uVar9,
         *pbVar14 < 0x21 &&
         (uVar22 = 0, uVar3 = 0, uVar11 = 0, uVar18 = 0, uVar25 = 0,
         (0x100002600U >> ((longlong)(char)*pbVar14 & 0x3fU) & 1) != 0))) {
    pbVar14 = pbVar14 + 1;
  }
LAB_180028cbd:
  do {
    bVar6 = *pbVar14;
    pbVar17 = pbVar14 + 1;
    uVar26 = uVar27;
    if (uVar3 < 6) {
      if (uVar3 == 5) {
        local_b8 = 1;
        pbVar14 = param_3;
        uVar26 = 0;
        if (9 < (byte)(bVar6 - 0x30)) break;
        uVar3 = 4;
      }
      else {
        if (uVar3 != 0) {
          if (uVar3 == 1) {
            uVar22 = 1;
            if ((byte)(bVar6 - 0x31) < 9) {
              uVar3 = 3;
              pbVar14 = param_3;
              goto LAB_180028de0;
            }
            if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) {
LAB_180028dc4:
              uVar22 = 1;
              uVar3 = 4;
              pbVar14 = pbVar17;
              goto LAB_180028cbd;
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) goto LAB_180028d74;
            if (bVar6 == 0x30) goto LAB_180028e18;
          }
          else {
            if (uVar3 == 2) {
              if ((byte)(bVar6 - 0x31) < 9) goto LAB_180028dd5;
              if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) goto LAB_180028df9;
              pbVar14 = param_3;
              if (bVar6 == 0x30) goto LAB_180028e18;
              break;
            }
            if (uVar3 == 3) {
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
                if (uVar18 < 0x19) {
                  uVar18 = uVar18 + 1;
                  *pcVar23 = bVar6 - 0x30;
                  pcVar23 = pcVar23 + 1;
                }
                else {
                  uVar11 = uVar11 + 1;
                }
                bVar6 = *pbVar17;
                pbVar17 = pbVar17 + 1;
              }
              if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) goto LAB_180028dc4;
            }
            else {
              if (uVar3 != 4) goto LAB_180028f9b;
              local_b8 = 1;
              if (uVar18 == 0) {
                while (bVar6 == 0x30) {
                  uVar11 = uVar11 - 1;
                  bVar6 = *pbVar17;
                  pbVar17 = pbVar17 + 1;
                }
              }
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
                if (uVar18 < 0x19) {
                  uVar18 = uVar18 + 1;
                  *pcVar23 = bVar6 - 0x30;
                  pcVar23 = pcVar23 + 1;
                  uVar11 = uVar11 - 1;
                }
                bVar6 = *pbVar17;
                pbVar17 = pbVar17 + 1;
              }
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) {
LAB_180028d74:
              uVar22 = 1;
              uVar3 = 0xb;
              pbVar14 = pbVar17 + -1;
              goto LAB_180028cbd;
            }
          }
          uVar22 = 1;
          uVar26 = 0;
          if (((char)bVar6 < 'D') ||
             (('E' < (char)bVar6 && (uVar26 = uVar19, bVar6 != 100 && bVar6 != 0x65))))
          goto LAB_180028e95;
          uVar3 = 6;
          pbVar14 = pbVar17;
          uVar22 = 1;
          goto LAB_180028cbd;
        }
        if (8 < (byte)(bVar6 - 0x31)) {
          if (bVar6 == *(byte *)**(undefined8 **)(*param_8 + 0xf0)) {
LAB_180028df9:
            uVar3 = 5;
            pbVar14 = pbVar17;
          }
          else if (bVar6 == 0x2b) {
            uVar3 = 2;
            local_b0 = local_b0 & 0xffff0000;
            pbVar14 = pbVar17;
          }
          else if (bVar6 == 0x2d) {
            uVar3 = 2;
            local_b0 = 0x8000;
            pbVar14 = pbVar17;
          }
          else {
            uVar26 = uVar19;
            if (bVar6 != 0x30) goto LAB_180028e95;
LAB_180028e18:
            uVar3 = 1;
            pbVar14 = pbVar17;
          }
          goto LAB_180028cbd;
        }
LAB_180028dd5:
        uVar3 = 3;
        pbVar14 = param_3;
      }
LAB_180028de0:
      param_3 = pbVar14;
      pbVar14 = pbVar17 + -1;
      goto LAB_180028cbd;
    }
    if (uVar3 == 6) {
      pbVar14 = pbVar14 + -1;
      if ((byte)(bVar6 - 0x31) < 9) goto LAB_180028f62;
      if (bVar6 != 0x2b) {
        if (bVar6 != 0x2d) goto LAB_180028f6c;
LAB_180028f17:
        local_b4 = -1;
        uVar3 = 7;
        param_3 = pbVar14;
        pbVar14 = pbVar17;
        goto LAB_180028cbd;
      }
      uVar3 = 7;
      param_3 = pbVar14;
    }
    else {
      if (uVar3 == 7) {
        pbVar14 = param_3;
        if ((byte)(bVar6 - 0x31) < 9) {
LAB_180028f62:
          uVar3 = 9;
          goto LAB_180028de0;
        }
LAB_180028f6c:
        if (bVar6 != 0x30) break;
        uVar3 = 8;
        param_3 = pbVar14;
        pbVar14 = pbVar17;
        goto LAB_180028cbd;
      }
      if (uVar3 == 8) {
        uVar25 = 1;
        while (bVar6 == 0x30) {
          bVar6 = *pbVar17;
          pbVar17 = pbVar17 + 1;
        }
        uVar26 = uVar19;
        if ((byte)(bVar6 - 0x31) < 9) {
          uVar3 = 9;
          pbVar14 = param_3;
          uVar25 = 1;
          goto LAB_180028de0;
        }
        goto LAB_180028e95;
      }
      if (uVar3 == 9) {
        uVar25 = 1;
        uVar26 = uVar9;
        goto LAB_180028fdc;
      }
      if (uVar3 == 0xb) {
        uVar26 = uVar19;
        if (param_7 == 0) goto LAB_180028e95;
        if (bVar6 != 0x2b) {
          uVar26 = uVar27;
          if (bVar6 == 0x2d) goto LAB_180028f17;
          break;
        }
        uVar3 = 7;
        param_3 = pbVar14;
        pbVar14 = pbVar17;
        goto LAB_180028cbd;
      }
    }
LAB_180028f9b:
    pbVar14 = pbVar17;
  } while (uVar3 != 10);
  goto LAB_18002900d;
LAB_180028fdc:
  if (((char)bVar6 < '0') || ('9' < (char)bVar6)) goto LAB_180028ffa;
  uVar26 = (int)(char)bVar6 + (uVar26 * 5 + -0x18) * 2;
  if ((int)uVar26 < 0x1451) {
    bVar6 = *pbVar17;
    pbVar17 = pbVar17 + 1;
    goto LAB_180028fdc;
  }
  uVar26 = 0x1451;
LAB_180028ffa:
  while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
    bVar6 = *pbVar17;
    pbVar17 = pbVar17 + 1;
  }
LAB_180028e95:
  pbVar14 = pbVar17 + -1;
LAB_18002900d:
  *(byte **)param_2 = pbVar14;
  uVar7 = 0;
  uVar16 = uVar7;
  uVar24 = uVar7;
  iVar21 = iVar10;
  uStack_8e = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
  uStack_8a = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
  uStack_78 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
  local_80 = CONCAT22(local_80._2_2_,(ushort)local_80);
  if (uVar22 != 0) {
    if (0x18 < uVar18) {
      if ('\x04' < local_49) {
        local_49 = local_49 + '\x01';
      }
      pcVar23 = pcVar23 + -1;
      uVar18 = 0x18;
      uVar11 = uVar11 + 1;
    }
    uVar16 = uVar2;
    uVar24 = uVar2;
    uStack_8e = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
    uStack_8a = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
    uStack_78 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
    local_80 = CONCAT22(local_80._2_2_,(ushort)local_80);
    if (uVar18 != 0) {
      while (pcVar23 = pcVar23 + -1, *pcVar23 == '\0') {
        uVar18 = uVar18 - 1;
        uVar11 = uVar11 + 1;
      }
      FUN_18002a0bc(local_60,uVar18,&local_80);
      uVar22 = CONCAT22(local_80._2_2_,(ushort)local_80);
      uVar19 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
      iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
      uVar27 = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
      if (local_b4 < 0) {
        uVar26 = -uVar26;
      }
      uVar26 = uVar26 + uVar11;
      if (uVar25 == 0) {
        uVar26 = uVar26 + param_5;
      }
      if (local_b8 == 0) {
        uVar26 = uVar26 - param_6;
      }
      local_80 = uVar22;
      if ((int)uVar26 < 0x1451) {
        if (-0x1451 < (int)uVar26) {
          ppuVar12 = &PTR_PTR_180047430;
          if (uVar26 != 0) {
            if ((int)uVar26 < 0) {
              uVar26 = -uVar26;
              ppuVar12 = (undefined **)0x180047590;
            }
            if (local_ac == 0) {
              local_80._0_2_ = 0;
            }
            uVar27 = uStack_8e;
            iVar4 = uStack_8a;
            uVar19 = uStack_78;
            uVar22 = CONCAT22(local_80._2_2_,(ushort)local_80);
joined_r0x0001800290d5:
            do {
              if (uVar26 == 0) break;
              uStack_78._2_2_ = (ushort)(uVar19 >> 0x10);
              ppuVar12 = (undefined **)((longlong)ppuVar12 + 0x54);
              uVar11 = (int)uVar26 >> 3;
              uVar3 = uVar26 & 7;
              uVar26 = uVar11;
              local_a0 = ppuVar12;
              if (uVar3 != 0) {
                local_a8 = (ushort *)((longlong)ppuVar12 + (longlong)(int)uVar3 * 0xc);
                if (0x7fff < *local_a8) {
                  puVar13 = local_a8 + 4;
                  uVar1 = *(undefined8 *)local_a8;
                  local_a8 = (ushort *)&local_70;
                  local_68 = *(undefined4 *)puVar13;
                  local_70._6_2_ = (undefined2)((ulonglong)uVar1 >> 0x30);
                  local_70._0_6_ = CONCAT42((int)((ulonglong)uVar1 >> 0x10) + -1,(ushort)uVar1);
                }
                local_90 = 0;
                uStack_8f = 0;
                uStack_8e._0_2_ = 0;
                uStack_8e._2_2_ = 0;
                uVar3 = 0;
                uStack_8a._0_2_ = 0;
                uVar2 = local_a8[5] & 0x7fff;
                uStack_8a._2_2_ = 0;
                iVar21 = 0;
                uStack_86 = 0;
                uVar24 = (local_a8[5] ^ uStack_78._2_2_) & 0x8000;
                uVar16 = (uStack_78._2_2_ & 0x7fff) + uVar2;
                uVar27 = 0;
                iVar4 = 0;
                if (((0x7ffe < (uStack_78._2_2_ & 0x7fff)) ||
                    (uVar27 = 0, iVar4 = 0, 0x7ffe < uVar2)) ||
                   (uVar27 = uVar3, iVar4 = iVar21, 0xbffd < uVar16)) {
LAB_1800293db:
                  local_80._0_2_ = 0;
                  local_80._2_2_ = 0;
                  uVar22 = 0;
                  uStack_7c = 0;
                  uStack_7a = 0;
                  uVar19 = (-(uint)(uVar24 != 0) & 0x80000000) + 0x7fff8000;
                  uStack_78._0_2_ = (undefined2)uVar19;
                  uStack_78._2_2_ = (ushort)(uVar19 >> 0x10);
                  goto joined_r0x0001800290d5;
                }
                if (0x3fbf < uVar16) {
                  if ((((uVar19 & 0x7fff0000) == 0) &&
                      (uVar16 = uVar16 + 1, (uVar19 & 0x7fffffff) == 0)) &&
                     ((CONCAT22(uStack_7a,uStack_7c) == 0 && (uVar22 == 0)))) {
                    uStack_78._2_2_ = 0;
                    uVar19 = uVar19 & 0xffff;
                    goto joined_r0x0001800290d5;
                  }
                  if (((uVar2 != 0) ||
                      (uVar16 = uVar16 + 1, (*(uint *)(local_a8 + 4) & 0x7fffffff) != 0)) ||
                     ((*(int *)(local_a8 + 2) != 0 || (*(int *)local_a8 != 0)))) {
                    puVar20 = (uint *)&local_90;
                    iVar21 = 5;
                    uVar27 = uVar9;
                    do {
                      local_b8 = iVar21;
                      if (0 < iVar21) {
                        puVar13 = local_a8 + 4;
                        puVar15 = (ushort *)((longlong)&local_80 + (longlong)(int)(uVar27 * 2));
                        do {
                          uVar19 = *puVar20 + (uint)*puVar13 * (uint)*puVar15;
                          if ((uVar19 < *puVar20) ||
                             (iVar4 = iVar10, uVar19 < (uint)*puVar13 * (uint)*puVar15)) {
                            iVar4 = 1;
                          }
                          *puVar20 = uVar19;
                          if (iVar4 != 0) {
                            *(short *)(puVar20 + 1) = (short)puVar20[1] + 1;
                          }
                          puVar15 = puVar15 + 1;
                          puVar13 = puVar13 + -1;
                          local_b8 = local_b8 + -1;
                        } while (0 < local_b8);
                      }
                      iVar21 = iVar21 + -1;
                      puVar20 = (uint *)((longlong)puVar20 + 2);
                      uVar27 = uVar27 + 1;
                    } while (0 < iVar21);
                    uVar22 = CONCAT22(uStack_86,uStack_8a._2_2_);
                    uVar19 = CONCAT22((undefined2)uStack_8e,CONCAT11(uStack_8f,local_90));
                    uVar16 = uVar16 + 0xc002;
                    uVar27 = uVar19;
                    if ((short)uVar16 < 1) {
LAB_1800292dc:
                      uVar16 = uVar16 - 1;
                      if (-1 < (short)uVar16) goto LAB_180029346;
                      uVar8 = (ulonglong)(ushort)-uVar16;
                      uVar16 = 0;
                      uVar27 = uVar9;
                      do {
                        uVar3 = uVar22;
                        if ((local_90 & 1) != 0) {
                          uVar27 = uVar27 + 1;
                        }
                        uVar11 = CONCAT22((ushort)uStack_8a,uStack_8e._2_2_);
                        uVar18 = uVar19 >> 1;
                        uStack_8a._0_2_ = (ushort)uStack_8a >> 1 | (ushort)((uVar3 << 0x1f) >> 0x10)
                        ;
                        uVar22 = uVar3 >> 1;
                        uVar19 = uVar18 | uVar11 << 0x1f;
                        uStack_8e._2_2_ = (ushort)(uVar11 >> 1);
                        local_90 = (byte)uVar18;
                        uStack_8f = (undefined1)(uVar18 >> 8);
                        uStack_8e._0_2_ = (undefined2)(uVar19 >> 0x10);
                        uVar8 = uVar8 - 1;
                      } while (uVar8 != 0);
                      uStack_8a._2_2_ = (undefined2)uVar22;
                      uStack_86 = (ushort)(uVar3 >> 0x11);
                      if (uVar27 == 0) goto LAB_180029346;
                      uVar2 = (ushort)uVar18 | 1;
                      local_90 = (byte)uVar2;
                      uVar19 = CONCAT22((undefined2)uStack_8e,(ushort)uVar18) | 1;
                    }
                    else {
                      do {
                        uVar19 = uVar27;
                        if ((uVar22 & 0x80000000) != 0) break;
                        uVar3 = uVar22 * 2;
                        uVar19 = uVar27 * 2;
                        iVar21 = CONCAT22((ushort)uStack_8a,uStack_8e._2_2_) * 2;
                        uVar16 = uVar16 - 1;
                        uStack_8e._2_2_ = (ushort)iVar21 | (ushort)(uVar27 >> 0x1f);
                        uVar22 = uVar3 | (ushort)uStack_8a >> 0xf;
                        local_90 = (byte)uVar19;
                        uStack_8f = (undefined1)(uVar19 >> 8);
                        uStack_8e._0_2_ = (undefined2)(uVar19 >> 0x10);
                        uStack_8a._0_2_ = (ushort)((uint)iVar21 >> 0x10);
                        uStack_8a._2_2_ = (undefined2)uVar22;
                        uStack_86 = (ushort)(uVar3 >> 0x10);
                        uVar27 = uVar19;
                      } while (0 < (short)uVar16);
                      if ((short)uVar16 < 1) goto LAB_1800292dc;
LAB_180029346:
                      uVar2 = CONCAT11(uStack_8f,local_90);
                    }
                    uVar27 = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e);
                    if ((0x8000 < uVar2) ||
                       (iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a),
                       (uVar19 & 0x1ffff) == 0x18000)) {
                      if (CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e) == -1) {
                        uStack_8e._0_2_ = 0;
                        uStack_8e._2_2_ = 0;
                        uVar27 = 0;
                        if (CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a) == -1) {
                          uStack_8a._0_2_ = 0;
                          uStack_8a._2_2_ = 0;
                          iVar4 = 0;
                          if (uStack_86 == 0xffff) {
                            uStack_86 = 0x8000;
                            uVar16 = uVar16 + 1;
                            iVar4 = 0;
                          }
                          else {
                            uStack_86 = uStack_86 + 1;
                          }
                        }
                        else {
                          iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a) + 1;
                          uStack_8a._0_2_ = (ushort)iVar4;
                          uStack_8a._2_2_ = (undefined2)((uint)iVar4 >> 0x10);
                        }
                        uStack_8a._2_2_ = (undefined2)((uint)iVar4 >> 0x10);
                        uVar22 = CONCAT22(uStack_86,uStack_8a._2_2_);
                      }
                      else {
                        uVar27 = CONCAT22(uStack_8e._2_2_,(undefined2)uStack_8e) + 1;
                        uStack_8e._0_2_ = (undefined2)uVar27;
                        uStack_8e._2_2_ = (ushort)(uVar27 >> 0x10);
                        iVar4 = CONCAT22(uStack_8a._2_2_,(ushort)uStack_8a);
                      }
                    }
                    uStack_8a._0_2_ = (ushort)iVar4;
                    if (0x7ffe < uVar16) goto LAB_1800293db;
                    uStack_78._2_2_ = uVar16 | uVar24;
                    uStack_7a = (undefined2)uVar22;
                    uStack_78._0_2_ = (undefined2)(uVar22 >> 0x10);
                    uVar19 = CONCAT22(uStack_78._2_2_,(undefined2)uStack_78);
                    local_80 = uVar27;
                    uStack_7c = (ushort)uStack_8a;
                    uVar22 = uVar27;
                    goto joined_r0x0001800290d5;
                  }
                }
                uStack_7c = 0;
                uStack_7a = 0;
                uStack_78._0_2_ = 0;
                uStack_78._2_2_ = 0;
                uVar19 = 0;
                local_80._0_2_ = 0;
                local_80._2_2_ = 0;
                uVar22 = 0;
              }
            } while( true );
          }
          local_80._2_2_ = (undefined2)(uVar22 >> 0x10);
          local_80._0_2_ = (ushort)uVar22;
          uStack_78._2_2_ = (ushort)(uVar19 >> 0x10);
          uStack_78._0_2_ = (undefined2)uVar19;
          iVar10 = CONCAT22(uStack_7c,local_80._2_2_);
          uVar16 = uStack_78._2_2_;
          uVar24 = (ushort)local_80;
          iVar21 = CONCAT22((undefined2)uStack_78,uStack_7a);
          uStack_8e = uVar27;
          uStack_8a = iVar4;
          uStack_78 = uVar19;
          local_80 = uVar22;
        }
      }
      else {
        uVar16 = 0x7fff;
        uVar24 = uVar7;
        iVar21 = -0x80000000;
      }
    }
  }
  local_98[5] = uVar16 | (ushort)local_b0;
  *local_98 = uVar24;
  *(int *)(local_98 + 1) = iVar10;
  *(int *)(local_98 + 3) = iVar21;
LAB_18002945a:
  FUN_18001d530(local_40 ^ (ulonglong)auStack_d8);
  return;
}



void FUN_180029484(ulonglong *param_1,ulonglong *param_2,ulonglong param_3,int param_4,uint param_5,
                  int param_6)

{
  FUN_1800294a8(param_1,param_2,param_3,param_4,param_5,param_6,(longlong *)0x0);
  return;
}



void FUN_1800294a8(ulonglong *param_1,ulonglong *param_2,ulonglong param_3,int param_4,uint param_5,
                  int param_6,longlong *param_7)

{
  if ((param_4 - 0x45U & 0xffffffdf) == 0) {
    FUN_180029ad4(param_1,(undefined1 *)param_2,param_3,param_5,param_6,param_7);
  }
  else if (param_4 == 0x66) {
    FUN_180029d30(param_1,param_2,param_3,param_5,param_7);
  }
  else if ((param_4 - 0x41U & 0xffffffdf) == 0) {
    FUN_180029528(param_1,(undefined1 *)param_2,param_3,param_5,param_6,param_7);
  }
  else {
    FUN_180029e04(param_1,param_2,param_3,param_5,param_6,param_7);
  }
  return;
}



DWORD FUN_180029528(ulonglong *param_1,undefined1 *param_2,ulonglong param_3,uint param_4,
                   int param_5,longlong *param_6)

{
  int iVar1;
  undefined1 (*pauVar2) [16];
  ushort uVar3;
  DWORD DVar4;
  DWORD *pDVar5;
  undefined1 (*pauVar6) [16];
  undefined1 (*pauVar7) [16];
  longlong lVar8;
  short sVar9;
  longlong lVar10;
  ulonglong uVar11;
  short sVar12;
  undefined1 (*pauVar13) [16];
  char *pcVar14;
  char *pcVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  
  uVar17 = 0x3ff;
  sVar12 = 0x30;
  FUN_1800201c0(local_48,param_6);
  uVar11 = (ulonglong)param_4;
  if ((int)param_4 < 0) {
    uVar11 = 0;
  }
  if ((param_2 == (undefined1 *)0x0) || (param_3 == 0)) {
    pDVar5 = FUN_18001fa28();
    DVar4 = 0x16;
  }
  else {
    iVar1 = (int)uVar11;
    *param_2 = 0;
    if ((ulonglong)(longlong)(iVar1 + 0xb) < param_3) {
      if ((*param_1 >> 0x34 & 0x7ff) == 0x7ff) {
        uVar11 = param_3 - 2;
        if (param_3 == 0xffffffffffffffff) {
          uVar11 = 0xffffffffffffffff;
        }
        DVar4 = FUN_180029ad4(param_1,param_2 + 2,uVar11,iVar1,0,(longlong *)0x0);
        if (DVar4 != 0) {
          *param_2 = 0;
          goto LAB_1800298a5;
        }
        if (param_2[2] == '-') {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        pauVar6 = FUN_18002a4d0((undefined1 (*) [16])(param_2 + 2),0x65);
        if (pauVar6 != (undefined1 (*) [16])0x0) {
          (*pauVar6)[0] = (-(param_5 != 0) & 0xe0U) + 0x70;
          (*pauVar6)[3] = 0;
        }
      }
      else {
        if ((*param_1 & 0x8000000000000000) != 0) {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        sVar9 = (-(ushort)(param_5 != 0) & 0xffe0) + 0x27;
        if ((*param_1 & 0x7ff0000000000000) == 0) {
          param_2[2] = 0x30;
          uVar17 = (ulonglong)(-(uint)((*param_1 & 0xfffffffffffff) != 0) & 0x3fe);
        }
        else {
          param_2[2] = 0x31;
        }
        pauVar13 = (undefined1 (*) [16])(param_2 + 3);
        pauVar6 = (undefined1 (*) [16])(param_2 + 4);
        if (iVar1 == 0) {
          (*pauVar13)[0] = 0;
        }
        else {
          (*pauVar13)[0] = *(undefined1 *)**(undefined8 **)(local_48[0] + 0xf0);
        }
        if ((*param_1 & 0xfffffffffffff) != 0) {
          uVar16 = 0xf000000000000;
          do {
            if ((int)uVar11 < 1) break;
            uVar3 = (short)((*param_1 & uVar16) >> ((byte)sVar12 & 0x3f)) + 0x30;
            if (0x39 < uVar3) {
              uVar3 = uVar3 + sVar9;
            }
            (*pauVar6)[0] = (char)uVar3;
            uVar16 = uVar16 >> 4;
            uVar11 = (ulonglong)((int)uVar11 - 1);
            pauVar6 = (undefined1 (*) [16])(*pauVar6 + 1);
            sVar12 = sVar12 + -4;
          } while (-1 < sVar12);
          if ((-1 < sVar12) &&
             (pauVar2 = pauVar6, 8 < (ushort)((*param_1 & uVar16) >> ((byte)sVar12 & 0x3f)))) {
            while (pauVar7 = (undefined1 (*) [16])(pauVar2[-1] + 0xf),
                  ((*pauVar7)[0] + 0xba & 0xdf) == 0) {
              (*pauVar7)[0] = 0x30;
              pauVar2 = pauVar7;
            }
            if (pauVar7 == pauVar13) {
              pauVar2[-1][0xe] = pauVar2[-1][0xe] + '\x01';
            }
            else if ((*pauVar7)[0] == '9') {
              (*pauVar7)[0] = (char)sVar9 + ':';
            }
            else {
              (*pauVar7)[0] = (*pauVar7)[0] + '\x01';
            }
          }
        }
        if (0 < (int)uVar11) {
          FUN_18001dbc0(pauVar6,0x30,uVar11);
          pauVar6 = (undefined1 (*) [16])(*pauVar6 + uVar11);
        }
        if ((*pauVar13)[0] == '\0') {
          pauVar6 = pauVar13;
        }
        (*pauVar6)[0] = (-(param_5 != 0) & 0xe0U) + 0x70;
        lVar8 = ((uint)(*param_1 >> 0x34) & 0x7ff) - uVar17;
        if (lVar8 < 0) {
          (*pauVar6)[1] = 0x2d;
          lVar8 = -lVar8;
        }
        else {
          (*pauVar6)[1] = 0x2b;
        }
        pcVar14 = *pauVar6 + 2;
        *pcVar14 = '0';
        pcVar15 = pcVar14;
        if (lVar8 < 1000) {
LAB_18002982f:
          if (99 < lVar8) goto LAB_180029835;
        }
        else {
          *pcVar14 = (char)(lVar8 / 1000) + '0';
          pcVar15 = *pauVar6 + 3;
          lVar8 = lVar8 % 1000;
          if (pcVar15 == pcVar14) goto LAB_18002982f;
LAB_180029835:
          lVar10 = SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816(lVar8),8) + lVar8;
          lVar10 = (lVar10 >> 6) - (lVar10 >> 0x3f);
          *pcVar15 = (char)lVar10 + '0';
          pcVar15 = pcVar15 + 1;
          lVar8 = lVar8 + lVar10 * -100;
        }
        if ((pcVar15 != pcVar14) || (9 < lVar8)) {
          *pcVar15 = (char)(lVar8 / 10) + '0';
          pcVar15 = pcVar15 + 1;
          lVar8 = lVar8 % 10;
        }
        *pcVar15 = (char)lVar8 + '0';
        pcVar15[1] = '\0';
      }
      DVar4 = 0;
      goto LAB_1800298a5;
    }
    pDVar5 = FUN_18001fa28();
    DVar4 = 0x22;
  }
  *pDVar5 = DVar4;
  FUN_18001ffd8();
LAB_1800298a5:
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  return DVar4;
}



ulonglong FUN_1800298d8(undefined1 *param_1,ulonglong param_2,int param_3,int param_4,int *param_5,
                       char param_6,longlong *param_7)

{
  code *pcVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  char *pcVar4;
  ulonglong uVar5;
  undefined1 *puVar6;
  undefined1 *puVar7;
  uint uVar8;
  ulonglong *puVar9;
  int iVar10;
  longlong local_38 [2];
  longlong local_28;
  char local_20;
  
  FUN_1800201c0(local_38,param_7);
  if ((param_1 == (undefined1 *)0x0) || (param_2 == 0)) {
    pDVar3 = FUN_18001fa28();
    uVar8 = 0x16;
  }
  else {
    iVar10 = 0;
    if (0 < param_3) {
      iVar10 = param_3;
    }
    if ((ulonglong)(longlong)(iVar10 + 9) < param_2) {
      if (param_6 != '\0') {
        puVar9 = (ulonglong *)(param_1 + (*param_5 == 0x2d));
        if (0 < param_3 != 0) {
          pcVar4 = FUN_180023f50(puVar9);
          FUN_18001d560((undefined8 *)((longlong)(int)(uint)(0 < param_3) + (longlong)puVar9),puVar9
                        ,(ulonglong)(pcVar4 + 1));
        }
      }
      puVar6 = param_1;
      if (*param_5 == 0x2d) {
        *param_1 = 0x2d;
        puVar6 = param_1 + 1;
      }
      if (0 < param_3) {
        *puVar6 = puVar6[1];
        puVar6 = puVar6 + 1;
        *puVar6 = *(undefined1 *)**(undefined8 **)(local_38[0] + 0xf0);
      }
      puVar6 = puVar6 + (ulonglong)(param_6 == '\0') + (longlong)param_3;
      puVar7 = param_1 + (param_2 - (longlong)puVar6);
      if (param_2 == 0xffffffffffffffff) {
        puVar7 = (undefined1 *)0xffffffffffffffff;
      }
      DVar2 = FUN_18001de48(puVar6,(longlong)puVar7,"e+000");
      if (DVar2 != 0) {
        FUN_18001fff8();
        pcVar1 = (code *)swi(3);
        uVar5 = (*pcVar1)();
        return uVar5;
      }
      if (param_4 != 0) {
        *puVar6 = 0x45;
      }
      if (**(char **)(param_5 + 4) != '0') {
        iVar10 = param_5[1] + -1;
        if (iVar10 < 0) {
          iVar10 = -iVar10;
          puVar6[1] = 0x2d;
        }
        if (99 < iVar10) {
          puVar6[2] = puVar6[2] + (char)(iVar10 / 100);
          iVar10 = iVar10 % 100;
        }
        if (9 < iVar10) {
          puVar6[3] = puVar6[3] + (char)(iVar10 / 10);
          iVar10 = iVar10 % 10;
        }
        puVar6[4] = puVar6[4] + (char)iVar10;
      }
      if (((DAT_180049ef0 & 1) != 0) && (puVar6[2] == '0')) {
        FUN_18001d560((undefined8 *)(puVar6 + 2),(undefined8 *)(puVar6 + 3),3);
      }
      uVar8 = 0;
      goto LAB_180029a87;
    }
    pDVar3 = FUN_18001fa28();
    uVar8 = 0x22;
  }
  *pDVar3 = uVar8;
  FUN_18001ffd8();
LAB_180029a87:
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return (ulonglong)uVar8;
}



void FUN_180029ad4(undefined8 *param_1,undefined1 *param_2,ulonglong param_3,int param_4,int param_5
                  ,longlong *param_6)

{
  DWORD DVar1;
  DWORD *pDVar2;
  ulonglong uVar3;
  undefined1 auStackY_a8 [32];
  int local_68 [6];
  undefined1 local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_a8;
  FUN_18002a7b0(*param_1,local_68,local_50,0x16);
  if ((param_2 == (undefined1 *)0x0) || (param_3 == 0)) {
    pDVar2 = FUN_18001fa28();
    *pDVar2 = 0x16;
    FUN_18001ffd8();
  }
  else {
    uVar3 = 0xffffffffffffffff;
    if (param_3 != 0xffffffffffffffff) {
      uVar3 = (param_3 - (local_68[0] == 0x2d)) - (ulonglong)(0 < param_4);
    }
    DVar1 = FUN_18002a614(param_2 + (ulonglong)(0 < param_4) + (ulonglong)(local_68[0] == 0x2d),
                          uVar3,param_4 + 1,(longlong)local_68);
    if (DVar1 == 0) {
      FUN_1800298d8(param_2,param_3,param_4,param_5,local_68,'\0',param_6);
    }
    else {
      *param_2 = 0;
    }
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_a8);
  return;
}



undefined4
FUN_180029bcc(ulonglong *param_1,longlong param_2,int param_3,int *param_4,char param_5,
             longlong *param_6)

{
  undefined1 (*pauVar1) [16];
  DWORD *pDVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  ulonglong *puVar7;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  iVar5 = param_4[1];
  FUN_1800201c0(local_28,param_6);
  if ((param_1 == (ulonglong *)0x0) || (param_2 == 0)) {
    pDVar2 = FUN_18001fa28();
    uVar6 = 0x16;
    *pDVar2 = 0x16;
    FUN_18001ffd8();
  }
  else {
    if ((param_5 != '\0') && (iVar5 + -1 == param_3)) {
      *(undefined2 *)((longlong)param_1 + (longlong)(iVar5 + -1) + (ulonglong)(*param_4 == 0x2d)) =
           0x30;
    }
    if (*param_4 == 0x2d) {
      *(undefined1 *)param_1 = 0x2d;
      param_1 = (ulonglong *)((longlong)param_1 + 1);
    }
    if (param_4[1] < 1) {
      pcVar3 = FUN_180023f50(param_1);
      FUN_18001d560((undefined8 *)((longlong)param_1 + 1),param_1,(ulonglong)(pcVar3 + 1));
      *(undefined1 *)param_1 = 0x30;
      puVar7 = (ulonglong *)((longlong)param_1 + 1);
    }
    else {
      puVar7 = (ulonglong *)((longlong)param_1 + (longlong)param_4[1]);
    }
    if (0 < param_3) {
      pauVar1 = (undefined1 (*) [16])((longlong)puVar7 + 1);
      pcVar3 = FUN_180023f50(puVar7);
      FUN_18001d560((undefined8 *)pauVar1,puVar7,(ulonglong)(pcVar3 + 1));
      *(undefined1 *)puVar7 = *(undefined1 *)**(undefined8 **)(local_28[0] + 0xf0);
      if (param_4[1] < 0) {
        iVar4 = -param_4[1];
        iVar5 = iVar4;
        if ((param_5 == '\0') && (iVar5 = param_3, iVar4 <= param_3)) {
          iVar5 = iVar4;
        }
        if (iVar5 != 0) {
          pcVar3 = FUN_180023f50((ulonglong *)pauVar1);
          FUN_18001d560((undefined8 *)(*pauVar1 + iVar5),(undefined8 *)pauVar1,
                        (ulonglong)(pcVar3 + 1));
        }
        FUN_18001dbc0(pauVar1,0x30,(longlong)iVar5);
      }
    }
    uVar6 = 0;
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar6;
}



void FUN_180029d30(undefined8 *param_1,ulonglong *param_2,longlong param_3,int param_4,
                  longlong *param_5)

{
  DWORD DVar1;
  DWORD *pDVar2;
  ulonglong uVar3;
  undefined1 auStackY_98 [32];
  int local_68;
  int local_64;
  undefined1 local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_98;
  FUN_18002a7b0(*param_1,&local_68,local_50,0x16);
  if ((param_2 == (ulonglong *)0x0) || (param_3 == 0)) {
    pDVar2 = FUN_18001fa28();
    *pDVar2 = 0x16;
    FUN_18001ffd8();
  }
  else {
    uVar3 = 0xffffffffffffffff;
    if (param_3 != -1) {
      uVar3 = param_3 - (ulonglong)(local_68 == 0x2d);
    }
    DVar1 = FUN_18002a614((char *)((ulonglong)(local_68 == 0x2d) + (longlong)param_2),uVar3,
                          local_64 + param_4,(longlong)&local_68);
    if (DVar1 == 0) {
      FUN_180029bcc(param_2,param_3,param_4,&local_68,'\0',param_5);
    }
    else {
      *(undefined1 *)param_2 = 0;
    }
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_98);
  return;
}



void FUN_180029e04(undefined8 *param_1,ulonglong *param_2,ulonglong param_3,int param_4,int param_5,
                  longlong *param_6)

{
  char *pcVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  ulonglong uVar4;
  char *pcVar5;
  int iVar6;
  undefined1 auStackY_a8 [32];
  int local_68;
  int local_64;
  undefined1 local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStackY_a8;
  FUN_18002a7b0(*param_1,&local_68,local_50,0x16);
  if ((param_2 == (ulonglong *)0x0) || (param_3 == 0)) {
    pDVar3 = FUN_18001fa28();
    *pDVar3 = 0x16;
    FUN_18001ffd8();
  }
  else {
    iVar6 = local_64 + -1;
    uVar4 = 0xffffffffffffffff;
    pcVar1 = (char *)((ulonglong)(local_68 == 0x2d) + (longlong)param_2);
    if (param_3 != 0xffffffffffffffff) {
      uVar4 = param_3 - (local_68 == 0x2d);
    }
    DVar2 = FUN_18002a614(pcVar1,uVar4,param_4,(longlong)&local_68);
    if (DVar2 == 0) {
      local_64 = local_64 + -1;
      if ((local_64 < -4) || (param_4 <= local_64)) {
        FUN_1800298d8((undefined1 *)param_2,param_3,param_4,param_5,&local_68,'\x01',param_6);
      }
      else {
        if (iVar6 < local_64) {
          do {
            pcVar5 = pcVar1;
            pcVar1 = pcVar5 + 1;
          } while (*pcVar5 != '\0');
          pcVar5[-1] = '\0';
        }
        FUN_180029bcc(param_2,param_3,param_4,&local_68,'\x01',param_6);
      }
    }
    else {
      *(undefined1 *)param_2 = 0;
    }
  }
  FUN_18001d530(local_38 ^ (ulonglong)auStackY_a8);
  return;
}



void FUN_180029f40(char *param_1,longlong *param_2)

{
  char cVar1;
  char *pcVar2;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  char *pcVar3;
  
  FUN_1800201c0(local_28,param_2);
  cVar1 = *param_1;
  if (cVar1 != '\0') {
    do {
      if (cVar1 == *(char *)**(undefined8 **)(local_28[0] + 0xf0)) break;
      param_1 = param_1 + 1;
      cVar1 = *param_1;
    } while (cVar1 != '\0');
  }
  if (*param_1 != '\0') {
    do {
      param_1 = param_1 + 1;
      pcVar2 = param_1;
      if (*param_1 == '\0') break;
    } while ((*param_1 + 0xbbU & 0xdf) != 0);
    do {
      pcVar3 = pcVar2;
      pcVar2 = pcVar3 + -1;
    } while (*pcVar2 == '0');
    if (*pcVar2 == *(char *)**(undefined8 **)(local_28[0] + 0xf0)) {
      pcVar2 = pcVar3 + -2;
    }
    do {
      cVar1 = *param_1;
      pcVar2 = pcVar2 + 1;
      param_1 = param_1 + 1;
      *pcVar2 = cVar1;
    } while (cVar1 != '\0');
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_180029fe0(int param_1,uint *param_2,byte *param_3,longlong *param_4)

{
  uint local_res8 [8];
  undefined8 local_18 [2];
  
  if (param_1 == 0) {
    FUN_180027e54(local_res8,param_3,param_4);
    *param_2 = local_res8[0];
  }
  else {
    FUN_180027d8c((uint *)local_18,param_3,param_4);
    *(undefined8 *)param_2 = local_18[0];
  }
  return;
}



void FUN_18002a028(byte *param_1,longlong *param_2)

{
  byte bVar1;
  uint uVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_1800201c0(local_28,param_2);
  uVar2 = FUN_18002a4b0((int)(char)*param_1);
  if (uVar2 != 0x65) {
    do {
      param_1 = param_1 + 1;
      uVar3 = FUN_18002a2e0((uint)*param_1);
    } while ((int)uVar3 != 0);
  }
  uVar2 = FUN_18002a4b0((int)(char)*param_1);
  if (uVar2 == 0x78) {
    param_1 = param_1 + 2;
  }
  bVar4 = *param_1;
  *param_1 = *(byte *)**(undefined8 **)(local_28[0] + 0xf0);
  do {
    param_1 = param_1 + 1;
    bVar1 = *param_1;
    *param_1 = bVar4;
    bVar4 = bVar1;
  } while (*param_1 != 0);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_18002a0bc(char *param_1,int param_2,uint *param_3)

{
  undefined8 uVar1;
  uint uVar2;
  bool bVar3;
  bool bVar4;
  uint uVar5;
  short sVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint local_28;
  
  *param_3 = 0;
  param_3[1] = 0;
  param_3[2] = 0;
  sVar6 = 0x404e;
  if (param_2 != 0) {
    uVar5 = 0;
    uVar10 = 0;
    uVar8 = 0;
    bVar4 = true;
    do {
      uVar1 = *(undefined8 *)param_3;
      uVar9 = param_3[2];
      uVar2 = uVar5 * 4;
      uVar7 = (uVar10 * 2 | uVar5 >> 0x1f) * 2 | uVar5 * 2 >> 0x1f;
      uVar10 = (uVar8 * 2 | uVar10 >> 0x1f) * 2 | uVar10 * 2 >> 0x1f;
      local_28 = (uint)uVar1;
      *param_3 = uVar2;
      uVar5 = uVar2 + local_28;
      param_3[1] = uVar7;
      param_3[2] = uVar10;
      if ((uVar5 < uVar2) || (bVar3 = false, uVar5 < local_28)) {
        bVar3 = bVar4;
      }
      *param_3 = uVar5;
      uVar8 = uVar7;
      if (bVar3) {
        uVar8 = uVar7 + 1;
        if ((uVar8 < uVar7) || (bVar3 = false, uVar8 == 0)) {
          bVar3 = bVar4;
        }
        param_3[1] = uVar8;
        if (bVar3) {
          uVar10 = uVar10 + 1;
          param_3[2] = uVar10;
        }
      }
      uVar2 = (uint)((ulonglong)uVar1 >> 0x20);
      uVar7 = uVar8 + uVar2;
      if ((uVar7 < uVar8) || (bVar3 = false, uVar7 < uVar2)) {
        bVar3 = bVar4;
      }
      param_3[1] = uVar7;
      if (bVar3) {
        uVar10 = uVar10 + 1;
        param_3[2] = uVar10;
      }
      uVar2 = uVar5 * 2;
      uVar8 = (uVar10 + uVar9) * 2 | uVar7 >> 0x1f;
      *param_3 = uVar2;
      param_3[2] = uVar8;
      uVar9 = uVar7 * 2 | uVar5 >> 0x1f;
      param_3[1] = uVar9;
      uVar5 = uVar2 + (int)*param_1;
      if ((uVar5 < uVar2) || (bVar3 = false, uVar5 < (uint)(int)*param_1)) {
        bVar3 = bVar4;
      }
      *param_3 = uVar5;
      uVar10 = uVar9;
      if (bVar3) {
        uVar10 = uVar9 + 1;
        if ((uVar10 < uVar9) || (bVar3 = false, uVar10 == 0)) {
          bVar3 = bVar4;
        }
        param_3[1] = uVar10;
        if (bVar3) {
          uVar8 = uVar8 + 1;
          param_3[2] = uVar8;
        }
      }
      param_1 = param_1 + 1;
      param_3[1] = uVar10;
      param_3[2] = uVar8;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  if (param_3[2] == 0) {
    uVar5 = param_3[1];
    do {
      uVar10 = *param_3;
      uVar9 = uVar5 >> 0x10;
      *param_3 = uVar10 << 0x10;
      uVar8 = uVar10 >> 0x10 | uVar5 << 0x10;
      sVar6 = sVar6 + -0x10;
      uVar10 = uVar5 >> 0x10;
      uVar5 = uVar8;
    } while (uVar10 == 0);
    param_3[1] = uVar8;
    param_3[2] = uVar9;
  }
  uVar5 = param_3[2];
  if ((uVar5 & 0x8000) == 0) {
    uVar10 = *param_3;
    uVar8 = param_3[1];
    do {
      uVar9 = uVar5 * 2;
      uVar5 = uVar8 >> 0x1f;
      uVar8 = uVar8 * 2 | uVar10 >> 0x1f;
      uVar5 = uVar9 | uVar5;
      sVar6 = sVar6 + -1;
      uVar10 = uVar10 * 2;
    } while ((uVar9 & 0x8000) == 0);
    *param_3 = uVar10;
    param_3[1] = uVar8;
    param_3[2] = uVar5;
  }
  *(short *)((longlong)param_3 + 10) = sVar6;
  return;
}



ulonglong FUN_18002a2e0(int param_1)

{
  ushort uVar1;
  ulonglong uVar2;
  undefined6 extraout_var;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if (DAT_180049ee8 == 0) {
    uVar2 = (ulonglong)(*(ushort *)(PTR_DAT_180047328 + (longlong)param_1 * 2) & 4);
  }
  else {
    FUN_1800201c0(local_28,(longlong *)0x0);
    if (*(int *)(local_28[0] + 0xd4) < 2) {
      uVar2 = (ulonglong)
              (*(ushort *)(*(longlong *)(local_28[0] + 0x108) + (longlong)param_1 * 2) & 4);
    }
    else {
      uVar1 = FUN_180027980(param_1,4,local_28);
      uVar2 = CONCAT62(extraout_var,uVar1) & 0xffffffff;
    }
    if (local_10 != '\0') {
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
    }
  }
  return uVar2;
}



uint FUN_18002a35c(uint param_1,longlong *param_2)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  undefined6 extraout_var;
  undefined6 extraout_var_00;
  DWORD *pDVar4;
  CHAR local_res8;
  CHAR local_res9;
  undefined1 local_resa;
  byte local_res18;
  undefined1 local_res19;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  FUN_1800201c0(local_28,param_2);
  if (param_1 < 0x100) {
    if (*(int *)(local_28[0] + 0xd4) < 2) {
      uVar2 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (longlong)(int)param_1 * 2) & 1;
    }
    else {
      uVar1 = FUN_180027980(param_1,1,local_28);
      uVar2 = (uint)CONCAT62(extraout_var,uVar1);
    }
    if (uVar2 == 0) {
LAB_18002a3c7:
      if (local_10 == '\0') {
        return param_1;
      }
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
      return param_1;
    }
    uVar2 = (uint)*(byte *)(*(longlong *)(local_28[0] + 0x110) + (longlong)(int)param_1);
  }
  else {
    if ((*(int *)(local_28[0] + 0xd4) < 2) ||
       (uVar1 = FUN_180025f7c((int)param_1 >> 8 & 0xff,local_28),
       (int)CONCAT62(extraout_var_00,uVar1) == 0)) {
      pDVar4 = FUN_18001fa28();
      iVar3 = 1;
      *pDVar4 = 0x2a;
      local_res9 = '\0';
      local_res8 = (CHAR)param_1;
    }
    else {
      local_resa = 0;
      iVar3 = 2;
      local_res8 = (CHAR)(param_1 >> 8);
      local_res9 = (CHAR)param_1;
    }
    iVar3 = FUN_180026cdc(local_28,*(longlong *)(local_28[0] + 0x138),0x100,&local_res8,iVar3,
                          &local_res18,3,*(UINT *)(local_28[0] + 4),1);
    if (iVar3 == 0) goto LAB_18002a3c7;
    uVar2 = (uint)local_res18;
    if (iVar3 != 1) {
      uVar2 = (uint)CONCAT11(local_res18,local_res19);
    }
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar2;
}



uint FUN_18002a4b0(uint param_1)

{
  uint uVar1;
  
  if (DAT_180049ee8 == 0) {
    if (param_1 - 0x41 < 0x1a) {
      param_1 = param_1 + 0x20;
    }
    return param_1;
  }
  uVar1 = FUN_18002a35c(param_1,(longlong *)0x0);
  return uVar1;
}



undefined1 (*) [16] FUN_18002a4d0(undefined1 (*param_1) [16],uint param_2)

{
  ushort uVar1;
  ulonglong uVar2;
  uint uVar3;
  undefined1 (*pauVar4) [16];
  int iVar5;
  uint uVar6;
  char *pcVar7;
  char *pcVar8;
  bool bVar9;
  bool bVar10;
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 in_XMM1 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [16];
  char cVar11;
  char cVar16;
  char cVar17;
  char cVar18;
  
  pauVar4 = (undefined1 (*) [16])0x0;
  if (param_2 == 0) {
    pcVar7 = (char *)((ulonglong)param_1 & 0xfffffffffffffff0);
    auVar12[0] = -(*pcVar7 == '\0');
    auVar12[1] = -(pcVar7[1] == '\0');
    auVar12[2] = -(pcVar7[2] == '\0');
    auVar12[3] = -(pcVar7[3] == '\0');
    auVar12[4] = -(pcVar7[4] == '\0');
    auVar12[5] = -(pcVar7[5] == '\0');
    auVar12[6] = -(pcVar7[6] == '\0');
    auVar12[7] = -(pcVar7[7] == '\0');
    auVar12[8] = -(pcVar7[8] == '\0');
    auVar12[9] = -(pcVar7[9] == '\0');
    auVar12[10] = -(pcVar7[10] == '\0');
    auVar12[0xb] = -(pcVar7[0xb] == '\0');
    auVar12[0xc] = -(pcVar7[0xc] == '\0');
    auVar12[0xd] = -(pcVar7[0xd] == '\0');
    auVar12[0xe] = -(pcVar7[0xe] == '\0');
    auVar12[0xf] = -(pcVar7[0xf] == '\0');
    uVar3 = (uint)(ushort)((ushort)(SUB161(auVar12 >> 7,0) & 1) |
                           (ushort)(SUB161(auVar12 >> 0xf,0) & 1) << 1 |
                           (ushort)(SUB161(auVar12 >> 0x17,0) & 1) << 2 |
                           (ushort)(SUB161(auVar12 >> 0x1f,0) & 1) << 3 |
                           (ushort)(SUB161(auVar12 >> 0x27,0) & 1) << 4 |
                           (ushort)(SUB161(auVar12 >> 0x2f,0) & 1) << 5 |
                           (ushort)(SUB161(auVar12 >> 0x37,0) & 1) << 6 |
                           (ushort)(SUB161(auVar12 >> 0x3f,0) & 1) << 7 |
                           (ushort)(SUB161(auVar12 >> 0x47,0) & 1) << 8 |
                           (ushort)(SUB161(auVar12 >> 0x4f,0) & 1) << 9 |
                           (ushort)(SUB161(auVar12 >> 0x57,0) & 1) << 10 |
                           (ushort)(SUB161(auVar12 >> 0x5f,0) & 1) << 0xb |
                           (ushort)(SUB161(auVar12 >> 0x67,0) & 1) << 0xc |
                           (ushort)(SUB161(auVar12 >> 0x6f,0) & 1) << 0xd |
                           (ushort)(SUB161(auVar12 >> 0x77,0) & 1) << 0xe |
                          (ushort)(auVar12[0xf] >> 7) << 0xf) & -1 << ((byte)param_1 & 0xf);
    pcVar8 = pcVar7;
    if (uVar3 == 0) {
      do {
        pcVar7 = pcVar8 + 0x10;
        auVar13[0] = -(*pcVar7 == '\0');
        auVar13[1] = -(pcVar8[0x11] == '\0');
        auVar13[2] = -(pcVar8[0x12] == '\0');
        auVar13[3] = -(pcVar8[0x13] == '\0');
        auVar13[4] = -(pcVar8[0x14] == '\0');
        auVar13[5] = -(pcVar8[0x15] == '\0');
        auVar13[6] = -(pcVar8[0x16] == '\0');
        auVar13[7] = -(pcVar8[0x17] == '\0');
        auVar13[8] = -(pcVar8[0x18] == '\0');
        auVar13[9] = -(pcVar8[0x19] == '\0');
        auVar13[10] = -(pcVar8[0x1a] == '\0');
        auVar13[0xb] = -(pcVar8[0x1b] == '\0');
        auVar13[0xc] = -(pcVar8[0x1c] == '\0');
        auVar13[0xd] = -(pcVar8[0x1d] == '\0');
        auVar13[0xe] = -(pcVar8[0x1e] == '\0');
        auVar13[0xf] = -(pcVar8[0x1f] == '\0');
        uVar1 = (ushort)(SUB161(auVar13 >> 7,0) & 1) | (ushort)(SUB161(auVar13 >> 0xf,0) & 1) << 1 |
                (ushort)(SUB161(auVar13 >> 0x17,0) & 1) << 2 |
                (ushort)(SUB161(auVar13 >> 0x1f,0) & 1) << 3 |
                (ushort)(SUB161(auVar13 >> 0x27,0) & 1) << 4 |
                (ushort)(SUB161(auVar13 >> 0x2f,0) & 1) << 5 |
                (ushort)(SUB161(auVar13 >> 0x37,0) & 1) << 6 |
                (ushort)(SUB161(auVar13 >> 0x3f,0) & 1) << 7 |
                (ushort)(SUB161(auVar13 >> 0x47,0) & 1) << 8 |
                (ushort)(SUB161(auVar13 >> 0x4f,0) & 1) << 9 |
                (ushort)(SUB161(auVar13 >> 0x57,0) & 1) << 10 |
                (ushort)(SUB161(auVar13 >> 0x5f,0) & 1) << 0xb |
                (ushort)(SUB161(auVar13 >> 0x67,0) & 1) << 0xc |
                (ushort)(SUB161(auVar13 >> 0x6f,0) & 1) << 0xd |
                (ushort)(SUB161(auVar13 >> 0x77,0) & 1) << 0xe | (ushort)(auVar13[0xf] >> 7) << 0xf;
        uVar3 = (uint)uVar1;
        pcVar8 = pcVar7;
      } while (uVar1 == 0);
    }
    uVar6 = 0;
    if (uVar3 != 0) {
      for (; (uVar3 >> uVar6 & 1) == 0; uVar6 = uVar6 + 1) {
      }
    }
    pauVar4 = (undefined1 (*) [16])(pcVar7 + uVar6);
  }
  else if (DAT_180046320 < 2) {
    pcVar7 = (char *)((ulonglong)param_1 & 0xfffffffffffffff0);
    uVar3 = -1 << ((byte)param_1 & 0xf);
    auVar19 = pshuflw(in_XMM1,ZEXT416((param_2 & 0xff) << 8 | param_2 & 0xff),0);
    auVar14[0] = -(*pcVar7 == '\0');
    auVar14[1] = -(pcVar7[1] == '\0');
    auVar14[2] = -(pcVar7[2] == '\0');
    auVar14[3] = -(pcVar7[3] == '\0');
    auVar14[4] = -(pcVar7[4] == '\0');
    auVar14[5] = -(pcVar7[5] == '\0');
    auVar14[6] = -(pcVar7[6] == '\0');
    auVar14[7] = -(pcVar7[7] == '\0');
    auVar14[8] = -(pcVar7[8] == '\0');
    auVar14[9] = -(pcVar7[9] == '\0');
    auVar14[10] = -(pcVar7[10] == '\0');
    auVar14[0xb] = -(pcVar7[0xb] == '\0');
    auVar14[0xc] = -(pcVar7[0xc] == '\0');
    auVar14[0xd] = -(pcVar7[0xd] == '\0');
    auVar14[0xe] = -(pcVar7[0xe] == '\0');
    auVar14[0xf] = -(pcVar7[0xf] == '\0');
    cVar11 = auVar19[0];
    auVar15[0] = -(cVar11 == *pcVar7);
    cVar16 = auVar19[1];
    auVar15[1] = -(cVar16 == pcVar7[1]);
    cVar17 = auVar19[2];
    auVar15[2] = -(cVar17 == pcVar7[2]);
    cVar18 = auVar19[3];
    auVar15[3] = -(cVar18 == pcVar7[3]);
    auVar15[4] = -(cVar11 == pcVar7[4]);
    auVar15[5] = -(cVar16 == pcVar7[5]);
    auVar15[6] = -(cVar17 == pcVar7[6]);
    auVar15[7] = -(cVar18 == pcVar7[7]);
    auVar15[8] = -(cVar11 == pcVar7[8]);
    auVar15[9] = -(cVar16 == pcVar7[9]);
    auVar15[10] = -(cVar17 == pcVar7[10]);
    auVar15[0xb] = -(cVar18 == pcVar7[0xb]);
    auVar15[0xc] = -(cVar11 == pcVar7[0xc]);
    auVar15[0xd] = -(cVar16 == pcVar7[0xd]);
    auVar15[0xe] = -(cVar17 == pcVar7[0xe]);
    auVar15[0xf] = -(cVar18 == pcVar7[0xf]);
    uVar6 = (ushort)((ushort)(SUB161(auVar15 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar15 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar15 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar15 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar15 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar15 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar15 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar15 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar15 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar15 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar15 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar15 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar15 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar15 >> 0x6f,0) & 1) << 0xd |
                     (ushort)(SUB161(auVar15 >> 0x77,0) & 1) << 0xe |
                    (ushort)(auVar15[0xf] >> 7) << 0xf) & uVar3;
    uVar3 = (ushort)((ushort)(SUB161(auVar14 >> 7,0) & 1) |
                     (ushort)(SUB161(auVar14 >> 0xf,0) & 1) << 1 |
                     (ushort)(SUB161(auVar14 >> 0x17,0) & 1) << 2 |
                     (ushort)(SUB161(auVar14 >> 0x1f,0) & 1) << 3 |
                     (ushort)(SUB161(auVar14 >> 0x27,0) & 1) << 4 |
                     (ushort)(SUB161(auVar14 >> 0x2f,0) & 1) << 5 |
                     (ushort)(SUB161(auVar14 >> 0x37,0) & 1) << 6 |
                     (ushort)(SUB161(auVar14 >> 0x3f,0) & 1) << 7 |
                     (ushort)(SUB161(auVar14 >> 0x47,0) & 1) << 8 |
                     (ushort)(SUB161(auVar14 >> 0x4f,0) & 1) << 9 |
                     (ushort)(SUB161(auVar14 >> 0x57,0) & 1) << 10 |
                     (ushort)(SUB161(auVar14 >> 0x5f,0) & 1) << 0xb |
                     (ushort)(SUB161(auVar14 >> 0x67,0) & 1) << 0xc |
                     (ushort)(SUB161(auVar14 >> 0x6f,0) & 1) << 0xd |
                     (ushort)(SUB161(auVar14 >> 0x77,0) & 1) << 0xe |
                    (ushort)(auVar14[0xf] >> 7) << 0xf) & uVar3;
    pcVar8 = pcVar7;
    if (uVar3 == 0) {
      do {
        uVar3 = 0x1f;
        if (uVar6 != 0) {
          for (; uVar6 >> uVar3 == 0; uVar3 = uVar3 - 1) {
          }
        }
        if (uVar6 != 0) {
          pauVar4 = (undefined1 (*) [16])(pcVar8 + uVar3);
        }
        pcVar7 = pcVar8 + 0x10;
        auVar20[0] = -(*pcVar7 == '\0');
        auVar20[1] = -(pcVar8[0x11] == '\0');
        auVar20[2] = -(pcVar8[0x12] == '\0');
        auVar20[3] = -(pcVar8[0x13] == '\0');
        auVar20[4] = -(pcVar8[0x14] == '\0');
        auVar20[5] = -(pcVar8[0x15] == '\0');
        auVar20[6] = -(pcVar8[0x16] == '\0');
        auVar20[7] = -(pcVar8[0x17] == '\0');
        auVar20[8] = -(pcVar8[0x18] == '\0');
        auVar20[9] = -(pcVar8[0x19] == '\0');
        auVar20[10] = -(pcVar8[0x1a] == '\0');
        auVar20[0xb] = -(pcVar8[0x1b] == '\0');
        auVar20[0xc] = -(pcVar8[0x1c] == '\0');
        auVar20[0xd] = -(pcVar8[0x1d] == '\0');
        auVar20[0xe] = -(pcVar8[0x1e] == '\0');
        auVar20[0xf] = -(pcVar8[0x1f] == '\0');
        auVar19[0] = -(cVar11 == *pcVar7);
        auVar19[1] = -(cVar16 == pcVar8[0x11]);
        auVar19[2] = -(cVar17 == pcVar8[0x12]);
        auVar19[3] = -(cVar18 == pcVar8[0x13]);
        auVar19[4] = -(cVar11 == pcVar8[0x14]);
        auVar19[5] = -(cVar16 == pcVar8[0x15]);
        auVar19[6] = -(cVar17 == pcVar8[0x16]);
        auVar19[7] = -(cVar18 == pcVar8[0x17]);
        auVar19[8] = -(cVar11 == pcVar8[0x18]);
        auVar19[9] = -(cVar16 == pcVar8[0x19]);
        auVar19[10] = -(cVar17 == pcVar8[0x1a]);
        auVar19[0xb] = -(cVar18 == pcVar8[0x1b]);
        auVar19[0xc] = -(cVar11 == pcVar8[0x1c]);
        auVar19[0xd] = -(cVar16 == pcVar8[0x1d]);
        auVar19[0xe] = -(cVar17 == pcVar8[0x1e]);
        auVar19[0xf] = -(cVar18 == pcVar8[0x1f]);
        uVar1 = (ushort)(SUB161(auVar20 >> 7,0) & 1) | (ushort)(SUB161(auVar20 >> 0xf,0) & 1) << 1 |
                (ushort)(SUB161(auVar20 >> 0x17,0) & 1) << 2 |
                (ushort)(SUB161(auVar20 >> 0x1f,0) & 1) << 3 |
                (ushort)(SUB161(auVar20 >> 0x27,0) & 1) << 4 |
                (ushort)(SUB161(auVar20 >> 0x2f,0) & 1) << 5 |
                (ushort)(SUB161(auVar20 >> 0x37,0) & 1) << 6 |
                (ushort)(SUB161(auVar20 >> 0x3f,0) & 1) << 7 |
                (ushort)(SUB161(auVar20 >> 0x47,0) & 1) << 8 |
                (ushort)(SUB161(auVar20 >> 0x4f,0) & 1) << 9 |
                (ushort)(SUB161(auVar20 >> 0x57,0) & 1) << 10 |
                (ushort)(SUB161(auVar20 >> 0x5f,0) & 1) << 0xb |
                (ushort)(SUB161(auVar20 >> 0x67,0) & 1) << 0xc |
                (ushort)(SUB161(auVar20 >> 0x6f,0) & 1) << 0xd |
                (ushort)(SUB161(auVar20 >> 0x77,0) & 1) << 0xe | (ushort)(auVar20[0xf] >> 7) << 0xf;
        uVar3 = (uint)uVar1;
        uVar6 = (uint)(ushort)((ushort)(SUB161(auVar19 >> 7,0) & 1) |
                               (ushort)(SUB161(auVar19 >> 0xf,0) & 1) << 1 |
                               (ushort)(SUB161(auVar19 >> 0x17,0) & 1) << 2 |
                               (ushort)(SUB161(auVar19 >> 0x1f,0) & 1) << 3 |
                               (ushort)(SUB161(auVar19 >> 0x27,0) & 1) << 4 |
                               (ushort)(SUB161(auVar19 >> 0x2f,0) & 1) << 5 |
                               (ushort)(SUB161(auVar19 >> 0x37,0) & 1) << 6 |
                               (ushort)(SUB161(auVar19 >> 0x3f,0) & 1) << 7 |
                               (ushort)(SUB161(auVar19 >> 0x47,0) & 1) << 8 |
                               (ushort)(SUB161(auVar19 >> 0x4f,0) & 1) << 9 |
                               (ushort)(SUB161(auVar19 >> 0x57,0) & 1) << 10 |
                               (ushort)(SUB161(auVar19 >> 0x5f,0) & 1) << 0xb |
                               (ushort)(SUB161(auVar19 >> 0x67,0) & 1) << 0xc |
                               (ushort)(SUB161(auVar19 >> 0x6f,0) & 1) << 0xd |
                               (ushort)(SUB161(auVar19 >> 0x77,0) & 1) << 0xe |
                              (ushort)(auVar19[0xf] >> 7) << 0xf);
        pcVar8 = pcVar7;
      } while (uVar1 == 0);
    }
    uVar6 = uVar6 & (-uVar3 & uVar3) - 1;
    uVar3 = 0x1f;
    if (uVar6 != 0) {
      for (; uVar6 >> uVar3 == 0; uVar3 = uVar3 - 1) {
      }
    }
    if (uVar6 != 0) {
      pauVar4 = (undefined1 (*) [16])(pcVar7 + uVar3);
    }
  }
  else {
    uVar2 = (ulonglong)param_1 & 0xf;
    while (bVar10 = uVar2 == 0, !bVar10) {
      if ((int)(char)(*param_1)[0] == param_2) {
        pauVar4 = param_1;
      }
      if ((*param_1)[0] == '\0') {
        return pauVar4;
      }
      param_1 = (undefined1 (*) [16])(*param_1 + 1);
      uVar2 = (ulonglong)param_1 & 0xf;
    }
    bVar9 = false;
    while( true ) {
      iVar5 = pcmpistri(ZEXT416(param_2 & 0xff),*param_1,0x40);
      if (bVar9) {
        pauVar4 = (undefined1 (*) [16])(*param_1 + iVar5);
        bVar10 = pauVar4 == (undefined1 (*) [16])0x0;
        pcmpistri(ZEXT416(param_2 & 0xff),*param_1,0x40);
      }
      if (bVar10) break;
      bVar9 = (undefined1 (*) [16])0xffffffffffffffef < param_1;
      param_1 = param_1 + 1;
      bVar10 = param_1 == (undefined1 (*) [16])0x0;
    }
  }
  return pauVar4;
}



DWORD FUN_18002a614(char *param_1,ulonglong param_2,int param_3,longlong param_4)

{
  ulonglong *puVar1;
  int iVar2;
  DWORD *pDVar3;
  ulonglong *puVar4;
  char *pcVar5;
  char cVar6;
  DWORD DVar7;
  
  pcVar5 = *(char **)(param_4 + 0x10);
  if ((param_1 == (char *)0x0) || (param_2 == 0)) {
    pDVar3 = FUN_18001fa28();
    DVar7 = 0x16;
  }
  else {
    *param_1 = '\0';
    iVar2 = 0;
    if (0 < param_3) {
      iVar2 = param_3;
    }
    if ((ulonglong)(longlong)(iVar2 + 1) < param_2) {
      puVar1 = (ulonglong *)(param_1 + 1);
      *param_1 = '0';
      puVar4 = puVar1;
      for (; 0 < param_3; param_3 = param_3 + -1) {
        if (*pcVar5 == '\0') {
          cVar6 = '0';
        }
        else {
          cVar6 = *pcVar5;
          pcVar5 = pcVar5 + 1;
        }
        *(char *)puVar4 = cVar6;
        puVar4 = (ulonglong *)((longlong)puVar4 + 1);
      }
      *(undefined1 *)puVar4 = 0;
      if ((-1 < param_3) && ('4' < *pcVar5)) {
        while (puVar4 = (ulonglong *)((longlong)puVar4 + -1), *(char *)puVar4 == '9') {
          *(undefined1 *)puVar4 = 0x30;
        }
        *(char *)puVar4 = *(char *)puVar4 + '\x01';
      }
      if (*param_1 == '1') {
        *(int *)(param_4 + 4) = *(int *)(param_4 + 4) + 1;
      }
      else {
        pcVar5 = FUN_180023f50(puVar1);
        FUN_18001d560((undefined8 *)param_1,puVar1,(ulonglong)(pcVar5 + 1));
      }
      return 0;
    }
    pDVar3 = FUN_18001fa28();
    DVar7 = 0x22;
  }
  *pDVar3 = DVar7;
  FUN_18001ffd8();
  return DVar7;
}



void FUN_18002a6e0(uint *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  ushort uVar3;
  uint uVar4;
  ushort uVar5;
  
  uVar4 = param_2[1];
  uVar5 = *(ushort *)((longlong)param_2 + 6) & 0x8000;
  uVar1 = *param_2;
  uVar3 = *(ushort *)((longlong)param_2 + 6) >> 4 & 0x7ff;
  uVar2 = 0x80000000;
  if (uVar3 == 0) {
    if (((uVar4 & 0xfffff) == 0) && (uVar1 == 0)) {
      param_1[1] = 0;
      *param_1 = 0;
      goto LAB_18002a7a2;
    }
    uVar3 = 0x3c01;
    uVar2 = 0;
  }
  else if (uVar3 == 0x7ff) {
    uVar3 = 0x7fff;
  }
  else {
    uVar3 = uVar3 + 0x3c00;
  }
  *param_1 = uVar1 << 0xb;
  uVar4 = uVar1 >> 0x15 | (uVar4 & 0xfffff) << 0xb | uVar2;
  param_1[1] = uVar4;
  if (uVar2 == 0) {
    do {
      uVar4 = *param_1 >> 0x1f | uVar4 * 2;
      *param_1 = *param_1 * 2;
      uVar3 = uVar3 - 1;
    } while (-1 < (int)uVar4);
    param_1[1] = uVar4;
  }
  uVar5 = uVar5 | uVar3;
LAB_18002a7a2:
  *(ushort *)(param_1 + 2) = uVar5;
  return;
}



void FUN_18002a7b0(undefined8 param_1,int *param_2,undefined1 *param_3,longlong param_4)

{
  code *pcVar1;
  int iVar2;
  DWORD DVar3;
  undefined1 auStack_a8 [32];
  undefined8 local_88;
  undefined8 local_78;
  undefined2 local_70;
  undefined8 local_68;
  undefined2 local_60;
  short local_58;
  char local_56;
  char local_54 [28];
  ulonglong local_38;
  
  local_38 = DAT_1800461a0 ^ (ulonglong)auStack_a8;
  local_78 = param_1;
  FUN_18002a6e0((uint *)&local_68,(uint *)&local_78);
  local_78 = local_68;
  local_70 = local_60;
  iVar2 = FUN_18002a868((int *)&local_78,0x11,0,&local_58);
  *param_2 = (int)local_56;
  param_2[1] = (int)local_58;
  param_2[2] = iVar2;
  DVar3 = FUN_18001de48(param_3,param_4,local_54);
  if (DVar3 == 0) {
    *(undefined1 **)(param_2 + 4) = param_3;
    FUN_18001d530(local_38 ^ (ulonglong)auStack_a8);
    return;
  }
  local_88 = 0;
  FUN_18001fff8();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_18002a868(int *param_1,int param_2,uint param_3,short *param_4)

{
  short *psVar1;
  undefined8 uVar2;
  code *pcVar3;
  undefined3 uVar4;
  bool bVar5;
  undefined1 uVar6;
  ushort uVar7;
  DWORD DVar8;
  short sVar9;
  ushort uVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint *puVar14;
  ulonglong uVar15;
  uint uVar16;
  uint uVar17;
  undefined **ppuVar18;
  char cVar19;
  ushort uVar20;
  uint uVar21;
  uint uVar22;
  longlong lVar23;
  short *psVar24;
  short *psVar25;
  int iVar26;
  int iVar27;
  ushort *puVar28;
  ushort *puVar29;
  undefined1 auStack_f8 [32];
  undefined8 local_d8;
  ushort local_c8;
  ushort local_c6;
  int local_c4;
  int local_c0;
  undefined2 local_bc;
  undefined **local_b8;
  undefined4 local_b0;
  int local_ac;
  int local_a8;
  short *local_a0;
  uint local_98;
  ushort *local_90;
  byte local_88;
  undefined1 uStack_87;
  undefined4 uStack_86;
  undefined4 uStack_82;
  ushort uStack_7e;
  undefined4 local_78;
  undefined2 uStack_74;
  undefined2 uStack_72;
  ushort uStack_70;
  undefined1 uStack_6e;
  byte bStack_6d;
  int local_68;
  int local_64;
  undefined4 local_60;
  undefined8 local_58;
  undefined4 local_50;
  ulonglong local_48;
  
  local_48 = DAT_1800461a0 ^ (ulonglong)auStack_f8;
  iVar27 = *param_1;
  uVar21 = param_1[1];
  local_c6 = *(ushort *)(param_1 + 2) & 0x8000;
  uVar20 = *(ushort *)(param_1 + 2) & 0x7fff;
  local_68 = -0x33333334;
  local_64 = -0x33333334;
  local_60 = 0x3ffbcccc;
  if (local_c6 == 0) {
    *(undefined1 *)(param_4 + 1) = 0x20;
  }
  else {
    *(undefined1 *)(param_4 + 1) = 0x2d;
  }
  local_ac = param_2;
  local_a0 = param_4;
  local_98 = param_3;
  if (uVar20 == 0) {
    if ((uVar21 != 0) || (iVar27 != 0)) goto LAB_18002a9fa;
    uVar6 = 0x20;
    local_78 = CONCAT22(local_78._2_2_,(undefined2)local_78);
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
      local_78 = CONCAT22(local_78._2_2_,(undefined2)local_78);
    }
LAB_18002a915:
    *param_4 = 0;
    *(undefined1 *)(param_4 + 1) = uVar6;
    *(undefined2 *)((longlong)param_4 + 3) = 0x3001;
  }
  else {
    if (uVar20 == 0x7fff) {
      *param_4 = 1;
      if (((uVar21 == 0x80000000) && (iVar27 == 0)) || ((uVar21 >> 0x1e & 1) != 0)) {
        if ((local_c6 == 0) || (uVar21 != 0xc0000000)) {
          if ((uVar21 != 0x80000000) || (iVar27 != 0)) goto LAB_18002a9d1;
          DVar8 = FUN_18001de48((undefined1 *)(param_4 + 2),0x16,"1#INF");
          if (DVar8 != 0) {
            local_d8 = 0;
            FUN_18001fff8();
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        else {
          if (iVar27 != 0) {
LAB_18002a9d1:
            DVar8 = FUN_18001de48((undefined1 *)(param_4 + 2),0x16,"1#QNAN");
            if (DVar8 != 0) {
              local_d8 = 0;
              FUN_18001fff8();
              pcVar3 = (code *)swi(3);
              (*pcVar3)();
              return;
            }
            goto LAB_18002a9ee;
          }
          DVar8 = FUN_18001de48((undefined1 *)(param_4 + 2),0x16,"1#IND");
          if (DVar8 != 0) {
            local_d8 = 0;
            FUN_18001fff8();
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        *(undefined1 *)((longlong)param_4 + 3) = 5;
      }
      else {
        DVar8 = FUN_18001de48((undefined1 *)(param_4 + 2),0x16,"1#SNAN");
        if (DVar8 != 0) {
          local_d8 = 0;
          FUN_18001fff8();
          pcVar3 = (code *)swi(3);
          (*pcVar3)();
          return;
        }
LAB_18002a9ee:
        *(undefined1 *)((longlong)param_4 + 3) = 6;
      }
      goto LAB_18002b286;
    }
LAB_18002a9fa:
    local_78._2_2_ = (undefined2)iVar27;
    uStack_74 = (undefined2)((uint)iVar27 >> 0x10);
    uStack_6e = (undefined1)uVar20;
    bStack_6d = (byte)(uVar20 >> 8);
    ppuVar18 = &PTR_PTR_180047430;
    uStack_72 = (undefined2)uVar21;
    uStack_70 = (ushort)(uVar21 >> 0x10);
    local_78._0_2_ = 0;
    uVar22 = iVar27 << 0x10;
    uVar12 = iVar27 << 0x10;
    local_a8 = 5;
    iVar11 = ((uint)(uVar20 >> 8) + (uVar21 >> 0x18) * 2) * 0x4d +
             (uint)uVar20 * 0x4d10 + -0x134312f4;
    local_c0 = iVar11 >> 0x10;
    sVar9 = (short)((uint)iVar11 >> 0x10);
    uVar21 = (uint)sVar9;
    if (-uVar21 == 0) {
LAB_18002add4:
      uVar21 = CONCAT22(uStack_72,uStack_74);
      local_78 = iVar27 << 0x10;
    }
    else {
      uVar16 = -uVar21;
      if (0 < (int)uVar21) {
        ppuVar18 = (undefined **)0x180047590;
        uVar16 = uVar21;
      }
      if (uVar16 == 0) goto LAB_18002add4;
      uVar21 = CONCAT22(uStack_72,uStack_74);
      local_78 = iVar27 << 0x10;
      do {
        iVar27 = 0;
        ppuVar18 = (undefined **)((longlong)ppuVar18 + 0x54);
        uVar22 = (int)uVar16 >> 3;
        if ((uVar16 & 7) != 0) {
          local_90 = (ushort *)((longlong)ppuVar18 + (longlong)(int)(uVar16 & 7) * 0xc);
          if (0x7fff < *local_90) {
            puVar29 = local_90 + 4;
            uVar2 = *(undefined8 *)local_90;
            local_90 = (ushort *)&local_58;
            local_50 = *(undefined4 *)puVar29;
            local_58._6_2_ = (undefined2)((ulonglong)uVar2 >> 0x30);
            local_58._0_6_ = CONCAT42((int)((ulonglong)uVar2 >> 0x10) + -1,(ushort)uVar2);
          }
          local_c4 = 0;
          uVar10 = local_90[5] & 0x7fff;
          local_88 = 0;
          uStack_87 = 0;
          uStack_86._0_2_ = 0;
          uStack_86._2_2_ = 0;
          uStack_86 = 0;
          uStack_82._0_2_ = 0;
          uVar7 = CONCAT11(bStack_6d,uStack_6e) & 0x7fff;
          uStack_82._2_2_ = 0;
          iVar11 = 0;
          uStack_82 = 0;
          uStack_7e = 0;
          local_c8 = (local_90[5] ^ CONCAT11(bStack_6d,uStack_6e)) & 0x8000;
          uVar20 = uVar7 + uVar10;
          if (((uVar7 < 0x7fff) && (uVar10 < 0x7fff)) && (uVar20 < 0xbffe)) {
            if (0x3fbf < uVar20) {
              if (((uVar7 == 0) &&
                  (uVar20 = uVar20 + 1,
                  (CONCAT13(bStack_6d,CONCAT12(uStack_6e,uStack_70)) & 0x7fffffff) == 0)) &&
                 ((uVar21 == 0 && (local_78 == 0)))) {
                uStack_6e = 0;
                bStack_6d = 0;
                uStack_86 = 0;
                goto LAB_18002adbd;
              }
              if (((uVar10 == 0) &&
                  (uVar20 = uVar20 + 1, (*(uint *)(local_90 + 4) & 0x7fffffff) == 0)) &&
                 ((*(int *)(local_90 + 2) == 0 && (*(int *)local_90 == 0)))) goto LAB_18002ab44;
              iVar11 = 5;
              puVar14 = (uint *)&local_88;
              do {
                if (0 < iVar11) {
                  puVar29 = local_90 + 4;
                  puVar28 = (ushort *)((longlong)&local_78 + (longlong)(iVar27 * 2));
                  iVar26 = iVar11;
                  do {
                    uVar21 = *puVar14 + (uint)*puVar28 * (uint)*puVar29;
                    if ((uVar21 < *puVar14) ||
                       (bVar5 = false, uVar21 < (uint)*puVar28 * (uint)*puVar29)) {
                      bVar5 = true;
                    }
                    *puVar14 = uVar21;
                    if (bVar5) {
                      *(short *)(puVar14 + 1) = (short)puVar14[1] + 1;
                    }
                    iVar26 = iVar26 + -1;
                    puVar28 = puVar28 + 1;
                    puVar29 = puVar29 + -1;
                  } while (0 < iVar26);
                }
                iVar11 = iVar11 + -1;
                puVar14 = (uint *)((longlong)puVar14 + 2);
                iVar27 = iVar27 + 1;
              } while (0 < iVar11);
              uVar12 = CONCAT22(uStack_7e,uStack_82._2_2_);
              uVar21 = CONCAT22((undefined2)uStack_86,CONCAT11(uStack_87,local_88));
              uVar20 = uVar20 + 0xc002;
              uVar16 = uVar21;
              if ((short)uVar20 < 1) {
LAB_18002ac76:
                uVar20 = uVar20 - 1;
                if (-1 < (short)uVar20) goto LAB_18002ace3;
                uVar15 = (ulonglong)(ushort)-uVar20;
                local_bc = 0;
                iVar27 = local_c4;
                do {
                  uVar16 = uVar12;
                  if ((local_88 & 1) != 0) {
                    iVar27 = iVar27 + 1;
                  }
                  uVar13 = CONCAT22((ushort)uStack_82,uStack_86._2_2_);
                  uVar17 = uVar21 >> 1;
                  uStack_82._0_2_ = (ushort)uStack_82 >> 1 | (ushort)((uVar16 << 0x1f) >> 0x10);
                  uVar12 = uVar16 >> 1;
                  uVar21 = uVar17 | uVar13 << 0x1f;
                  uStack_86._2_2_ = (ushort)(uVar13 >> 1);
                  local_88 = (byte)uVar17;
                  uStack_87 = (undefined1)(uVar17 >> 8);
                  uStack_86._0_2_ = (undefined2)(uVar21 >> 0x10);
                  uVar15 = uVar15 - 1;
                } while (uVar15 != 0);
                uVar20 = 0;
                uStack_82._2_2_ = (undefined2)uVar12;
                uStack_7e = (ushort)(uVar16 >> 0x11);
                if (iVar27 == 0) goto LAB_18002ace3;
                uVar7 = (ushort)uVar17 | 1;
                local_88 = (byte)uVar7;
                uVar21 = CONCAT22((undefined2)uStack_86,(ushort)uVar17) | 1;
              }
              else {
                do {
                  uVar21 = uVar16;
                  if ((uVar12 & 0x80000000) != 0) break;
                  uVar13 = uVar12 * 2;
                  uVar21 = uVar16 * 2;
                  iVar27 = CONCAT22((ushort)uStack_82,uStack_86._2_2_) * 2;
                  uVar20 = uVar20 - 1;
                  uStack_86._2_2_ = (ushort)iVar27 | (ushort)(uVar16 >> 0x1f);
                  uVar12 = uVar13 | (ushort)uStack_82 >> 0xf;
                  local_88 = (byte)uVar21;
                  uStack_87 = (undefined1)(uVar21 >> 8);
                  uStack_86._0_2_ = (undefined2)(uVar21 >> 0x10);
                  uStack_82._0_2_ = (ushort)((uint)iVar27 >> 0x10);
                  uStack_82._2_2_ = (undefined2)uVar12;
                  uStack_7e = (ushort)(uVar13 >> 0x10);
                  uVar16 = uVar21;
                } while (0 < (short)uVar20);
                if ((short)uVar20 < 1) goto LAB_18002ac76;
LAB_18002ace3:
                uVar7 = CONCAT11(uStack_87,local_88);
              }
              local_78 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86);
              if ((0x8000 < uVar7) ||
                 (uStack_82 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82),
                 (uVar21 & 0x1ffff) == 0x18000)) {
                if (CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) == -1) {
                  uStack_86._0_2_ = 0;
                  uStack_86._2_2_ = 0;
                  local_78 = 0;
                  if (CONCAT22(uStack_82._2_2_,(ushort)uStack_82) == -1) {
                    uStack_82._0_2_ = 0;
                    uStack_82._2_2_ = 0;
                    iVar27 = 0;
                    if (uStack_7e == 0xffff) {
                      uStack_7e = 0x8000;
                      uVar20 = uVar20 + 1;
                      iVar27 = 0;
                    }
                    else {
                      uStack_7e = uStack_7e + 1;
                    }
                  }
                  else {
                    iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82) + 1;
                    uStack_82._0_2_ = (ushort)iVar27;
                    uStack_82._2_2_ = (undefined2)((uint)iVar27 >> 0x10);
                  }
                  uStack_82._2_2_ = (undefined2)((uint)iVar27 >> 0x10);
                  uVar12 = CONCAT22(uStack_7e,uStack_82._2_2_);
                  uStack_82 = iVar27;
                }
                else {
                  local_78 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) + 1;
                  uStack_86._0_2_ = (undefined2)local_78;
                  uStack_86._2_2_ = (ushort)(local_78 >> 0x10);
                  uStack_82 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82);
                }
              }
              uStack_86 = local_78;
              iVar11 = uStack_82;
              if (uVar20 < 0x7fff) {
                bStack_6d = (byte)(uVar20 >> 8) | (byte)(local_c8 >> 8);
                uStack_72 = (undefined2)uVar12;
                uStack_70 = (ushort)(uVar12 >> 0x10);
                uStack_74 = (ushort)uStack_82;
                uVar21 = CONCAT22(uStack_72,(ushort)uStack_82);
                uStack_6e = (undefined1)uVar20;
                uVar12 = local_78;
                goto LAB_18002adbd;
              }
              goto LAB_18002ad9f;
            }
LAB_18002ab44:
            uStack_74 = 0;
            uStack_72 = 0;
            uStack_70 = 0;
            uStack_6e = 0;
            bStack_6d = 0;
            uStack_82 = iVar11;
          }
          else {
LAB_18002ad9f:
            uStack_74 = 0;
            uStack_72 = 0;
            iVar27 = (-(uint)(local_c8 != 0) & 0x80000000) + 0x7fff8000;
            uStack_70 = (ushort)iVar27;
            uStack_6e = (undefined1)((uint)iVar27 >> 0x10);
            bStack_6d = (byte)((uint)iVar27 >> 0x18);
            uStack_82 = iVar11;
          }
          uStack_72 = 0;
          uStack_74 = 0;
          uVar21 = 0;
          local_78._0_2_ = 0;
          local_78._2_2_ = 0;
          local_78 = uVar21;
          uVar12 = 0;
        }
LAB_18002adbd:
        uVar16 = uVar22;
      } while (uVar22 != 0);
      local_b0 = 0;
      local_b8 = ppuVar18;
      uVar22 = uVar12;
    }
    iVar27 = 0;
    uVar12 = CONCAT13(bStack_6d,CONCAT12(uStack_6e,uStack_70));
    uVar20 = (ushort)(uVar12 >> 0x10);
    uVar16 = uVar21;
    if (0x3ffe < uVar20) {
      local_c0 = CONCAT22(sVar9 >> 0xf,sVar9 + 1);
      uVar16 = 0;
      local_c4 = 0;
      local_88 = 0;
      uStack_87 = 0;
      uStack_86._0_2_ = 0;
      uStack_86._2_2_ = 0;
      uStack_86 = 0;
      uStack_82._0_2_ = 0;
      uStack_82._2_2_ = 0;
      uStack_82 = 0;
      uStack_7e = 0;
      uVar10 = (local_60._2_2_ ^ uVar20) & 0x8000;
      uVar7 = (uVar20 & 0x7fff) + (local_60._2_2_ & 0x7fff);
      if ((((uVar20 & 0x7fff) < 0x7fff) && ((local_60._2_2_ & 0x7fff) < 0x7fff)) && (uVar7 < 0xbffe)
         ) {
        if (uVar7 < 0x3fc0) {
LAB_18002ae58:
          uStack_70 = 0;
          uStack_6e = 0;
          bStack_6d = 0;
          local_78 = uVar16;
        }
        else if ((((uVar12 & 0x7fff0000) == 0) &&
                 (uVar7 = uVar7 + 1,
                 (CONCAT13(bStack_6d,CONCAT12(uStack_6e,uStack_70)) & 0x7fffffff) == 0)) &&
                ((uVar21 == 0 && (local_78 == 0)))) {
          uStack_6e = 0;
          bStack_6d = 0;
          uVar16 = uVar21;
          uStack_86 = 0;
          uStack_82 = 0;
        }
        else {
          if ((((local_60 & 0x7fff0000) == 0) && (uVar7 = uVar7 + 1, (local_60 & 0x7fffffff) == 0))
             && ((local_64 == 0 && (local_68 == 0)))) goto LAB_18002ae58;
          puVar14 = (uint *)&local_88;
          uVar21 = uVar22;
          do {
            if (0 < local_a8) {
              puVar29 = (ushort *)&local_60;
              puVar28 = (ushort *)((longlong)&local_78 + (longlong)(iVar27 * 2));
              iVar11 = local_a8;
              do {
                bVar5 = false;
                uVar22 = *puVar14 + (uint)*puVar29 * (uint)*puVar28;
                if ((uVar22 < *puVar14) || (uVar22 < (uint)*puVar29 * (uint)*puVar28)) {
                  bVar5 = true;
                }
                local_78 = uVar21;
                *puVar14 = uVar22;
                uVar21 = local_78;
                if (bVar5) {
                  *(short *)(puVar14 + 1) = (short)puVar14[1] + 1;
                  uVar21 = local_78;
                }
                iVar11 = iVar11 + -1;
                puVar28 = puVar28 + 1;
                puVar29 = puVar29 + -1;
              } while (0 < iVar11);
            }
            local_a8 = local_a8 + -1;
            puVar14 = (uint *)((longlong)puVar14 + 2);
            iVar27 = iVar27 + 1;
          } while (0 < local_a8);
          uVar16 = CONCAT22(uStack_7e,uStack_82._2_2_);
          uVar12 = CONCAT22((undefined2)uStack_86,CONCAT11(uStack_87,local_88));
          uVar7 = uVar7 + 0xc002;
          uVar22 = uVar12;
          if ((short)uVar7 < 1) {
LAB_18002af7d:
            uVar7 = uVar7 - 1;
            if (-1 < (short)uVar7) goto LAB_18002afe2;
            uVar15 = (ulonglong)(ushort)-uVar7;
            uVar7 = 0;
            iVar27 = local_c4;
            do {
              uVar22 = uVar16;
              if ((local_88 & 1) != 0) {
                iVar27 = iVar27 + 1;
              }
              uVar13 = CONCAT22((ushort)uStack_82,uStack_86._2_2_);
              uVar17 = uVar12 >> 1;
              uStack_82._0_2_ = (ushort)uStack_82 >> 1 | (ushort)((uVar22 << 0x1f) >> 0x10);
              uVar16 = uVar22 >> 1;
              uVar12 = uVar17 | uVar13 << 0x1f;
              uStack_86._2_2_ = (ushort)(uVar13 >> 1);
              local_88 = (byte)uVar17;
              uStack_87 = (undefined1)(uVar17 >> 8);
              uStack_86._0_2_ = (undefined2)(uVar12 >> 0x10);
              uVar15 = uVar15 - 1;
            } while (uVar15 != 0);
            uStack_82._2_2_ = (undefined2)uVar16;
            uStack_7e = (ushort)(uVar22 >> 0x11);
            if (iVar27 == 0) goto LAB_18002afe2;
            uVar20 = (ushort)uVar17 | 1;
            local_88 = (byte)uVar20;
            uVar12 = CONCAT22((undefined2)uStack_86,(ushort)uVar17) | 1;
          }
          else {
            do {
              uVar12 = uVar22;
              if ((uVar16 & 0x80000000) != 0) break;
              uVar13 = uVar16 * 2;
              uVar12 = uVar22 * 2;
              iVar27 = CONCAT22((ushort)uStack_82,uStack_86._2_2_) * 2;
              uVar7 = uVar7 - 1;
              uStack_86._2_2_ = (ushort)iVar27 | (ushort)(uVar22 >> 0x1f);
              uVar16 = uVar13 | (ushort)uStack_82 >> 0xf;
              local_88 = (byte)uVar12;
              uStack_87 = (undefined1)(uVar12 >> 8);
              uStack_86._0_2_ = (undefined2)(uVar12 >> 0x10);
              uStack_82._0_2_ = (ushort)((uint)iVar27 >> 0x10);
              uStack_82._2_2_ = (undefined2)uVar16;
              uStack_7e = (ushort)(uVar13 >> 0x10);
              uVar22 = uVar12;
            } while (0 < (short)uVar7);
            if ((short)uVar7 < 1) goto LAB_18002af7d;
LAB_18002afe2:
            uVar20 = CONCAT11(uStack_87,local_88);
          }
          uVar22 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86);
          if ((0x8000 < uVar20) ||
             (iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82), (uVar12 & 0x1ffff) == 0x18000))
          {
            if (CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) == -1) {
              uVar22 = 0;
              if (CONCAT22(uStack_82._2_2_,(ushort)uStack_82) == -1) {
                iVar27 = 0;
                if (uStack_7e == 0xffff) {
                  uStack_7e = 0x8000;
                  uVar7 = uVar7 + 1;
                  iVar27 = 0;
                }
                else {
                  uStack_7e = uStack_7e + 1;
                }
              }
              else {
                iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82) + 1;
              }
              uStack_82._2_2_ = (undefined2)((uint)iVar27 >> 0x10);
              uVar16 = CONCAT22(uStack_7e,uStack_82._2_2_);
            }
            else {
              uVar22 = CONCAT22(uStack_86._2_2_,(undefined2)uStack_86) + 1;
              iVar27 = CONCAT22(uStack_82._2_2_,(ushort)uStack_82);
            }
          }
          uStack_82._0_2_ = (ushort)iVar27;
          uStack_82 = iVar27;
          uStack_86 = uVar22;
          if (uVar7 < 0x7fff) {
            bStack_6d = (byte)(uVar7 >> 8) | (byte)(uVar10 >> 8);
            uStack_72 = (undefined2)uVar16;
            uStack_70 = (ushort)(uVar16 >> 0x10);
            uStack_6e = (undefined1)uVar7;
            uStack_74 = (ushort)uStack_82;
            uVar16 = CONCAT22(uStack_72,(ushort)uStack_82);
            local_78 = uVar22;
          }
          else {
            iVar27 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
            uStack_70 = (ushort)iVar27;
            uStack_6e = (undefined1)((uint)iVar27 >> 0x10);
            bStack_6d = (byte)((uint)iVar27 >> 0x18);
            uVar16 = 0;
            local_78 = 0;
            uVar22 = uVar21;
          }
        }
      }
      else {
        iVar27 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
        uStack_70 = (ushort)iVar27;
        uStack_6e = (undefined1)((uint)iVar27 >> 0x10);
        bStack_6d = (byte)((uint)iVar27 >> 0x18);
        local_78 = uVar16;
      }
    }
    *param_4 = (short)local_c0;
    iVar27 = param_2;
    if (((param_3 & 1) != 0) && (iVar27 = param_2 + (short)local_c0, iVar27 < 1)) {
      uVar6 = 0x20;
      local_78 = uVar22;
      if (local_c6 == 0x8000) {
        uVar6 = 0x2d;
      }
      goto LAB_18002a915;
    }
    uVar4 = CONCAT12(uStack_6e,uStack_70);
    uStack_6e = 0;
    uVar21 = (uint)uStack_70;
    lVar23 = 8;
    if (0x15 < iVar27) {
      iVar27 = 0x15;
    }
    iVar11 = (CONCAT13(bStack_6d,uVar4) >> 0x10) - 0x3ffe;
    do {
      uVar22 = uVar16 * 2;
      uVar12 = uVar16 >> 0x1f;
      uVar16 = uVar22 | local_78 >> 0x1f;
      uVar21 = uVar21 * 2 | uVar12;
      local_78 = local_78 * 2;
      lVar23 = lVar23 + -1;
    } while (lVar23 != 0);
    uStack_74 = (undefined2)uVar16;
    uStack_72 = (undefined2)(uVar22 >> 0x10);
    if ((iVar11 < 0) && (uVar22 = -iVar11 & 0xff, uVar22 != 0)) {
      do {
        uVar17 = uVar16 >> 1;
        uVar12 = uVar21 << 0x1f;
        uVar13 = uVar16 << 0x1f;
        uVar22 = uVar22 - 1;
        uVar21 = uVar21 >> 1;
        uVar16 = uVar17 | uVar12;
        local_78 = local_78 >> 1 | uVar13;
      } while (0 < (int)uVar22);
      uStack_74 = (undefined2)uVar17;
      uStack_72 = (undefined2)(uVar16 >> 0x10);
    }
    iVar27 = iVar27 + 1;
    psVar1 = param_4 + 2;
    psVar24 = psVar1;
    if (0 < iVar27) {
      while( true ) {
        local_58 = CONCAT26(uStack_72,CONCAT24(uStack_74,local_78));
        uVar12 = (uVar16 * 2 | local_78 >> 0x1f) * 2 | local_78 * 2 >> 0x1f;
        uVar22 = local_78 * 5;
        uVar13 = (uVar21 * 2 | uVar16 >> 0x1f) * 2 | uVar16 * 2 >> 0x1f;
        if ((uVar22 < local_78 * 4) || (uVar16 = uVar12, uVar22 < local_78)) {
          uVar16 = uVar12 + 1;
          if ((uVar16 < uVar12) || (bVar5 = false, uVar16 == 0)) {
            bVar5 = true;
          }
          if (bVar5) {
            uVar13 = uVar13 + 1;
          }
        }
        uVar12 = (uint)((ulonglong)local_58 >> 0x20);
        uVar17 = uVar16 + uVar12;
        if ((uVar17 < uVar16) || (uVar17 < uVar12)) {
          uVar13 = uVar13 + 1;
        }
        local_78 = local_78 * 10;
        uVar16 = uVar17 * 2 | uVar22 >> 0x1f;
        uVar21 = (uVar13 + uVar21) * 2;
        iVar27 = iVar27 + -1;
        uStack_70 = (ushort)uVar21 | (ushort)(uVar17 >> 0x1f);
        uStack_74 = (undefined2)uVar16;
        uStack_72 = (undefined2)(uVar17 * 2 >> 0x10);
        uStack_6e = (undefined1)(uVar21 >> 0x10);
        *(char *)psVar24 = (char)(uVar21 >> 0x18) + '0';
        psVar24 = (short *)((longlong)psVar24 + 1);
        if (iVar27 < 1) break;
        uVar21 = uVar21 & 0xffffff | uVar17 >> 0x1f;
      }
    }
    bStack_6d = 0;
    psVar25 = psVar24 + -1;
    if ('4' < *(char *)((longlong)psVar24 + -1)) {
      for (; (psVar1 <= psVar25 && ((char)*psVar25 == '9'));
          psVar25 = (short *)((longlong)psVar25 + -1)) {
        *(char *)psVar25 = '0';
      }
      if (psVar25 < psVar1) {
        psVar25 = (short *)((longlong)psVar25 + 1);
        *param_4 = *param_4 + 1;
      }
      *(char *)psVar25 = (char)*psVar25 + '\x01';
LAB_18002b272:
      cVar19 = ((char)psVar25 - (char)param_4) + -3;
      *(char *)((longlong)param_4 + 3) = cVar19;
      *(undefined1 *)((longlong)cVar19 + 4 + (longlong)param_4) = 0;
      goto LAB_18002b286;
    }
    for (; (psVar1 <= psVar25 && ((char)*psVar25 == '0'));
        psVar25 = (short *)((longlong)psVar25 + -1)) {
    }
    if (psVar1 <= psVar25) goto LAB_18002b272;
    *param_4 = 0;
    *(undefined1 *)((longlong)param_4 + 3) = 1;
    uVar6 = 0x20;
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
    }
    *(undefined1 *)(param_4 + 1) = uVar6;
    *(char *)psVar1 = '0';
  }
  *(undefined1 *)((longlong)param_4 + 5) = 0;
LAB_18002b286:
  FUN_18001d530(local_48 ^ (ulonglong)auStack_f8);
  return;
}



void __stdcall
RtlUnwindEx(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue,
           PCONTEXT ContextRecord,PUNWIND_HISTORY_TABLE HistoryTable)

{
                    // WARNING: Could not recover jumptable at 0x00018002b340. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnwindEx(TargetFrame,TargetIp,ExceptionRecord,ReturnValue,ContextRecord,HistoryTable);
  return;
}



BOOL __stdcall IsProcessorFeaturePresent(DWORD ProcessorFeature)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018002b346. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsProcessorFeaturePresent(ProcessorFeature);
  return BVar1;
}



void Unwind_18002b350(undefined8 param_1,longlong param_2)

{
  thunk_FUN_18001d45c(*(LPVOID *)(param_2 + 0x48));
  return;
}



void Unwind_18002b35c(undefined8 param_1,longlong param_2)

{
  thunk_FUN_18001d45c(*(LPVOID *)(param_2 + 0x48));
  return;
}



void Unwind_18002b368(undefined8 param_1,longlong param_2)

{
  thunk_FUN_18001d45c(*(LPVOID *)(param_2 + 0x48));
  return;
}



void Unwind_18002b374(undefined8 param_1,longlong param_2)

{
  thunk_FUN_18001d45c(*(LPVOID *)(param_2 + 0x48));
  return;
}



void FUN_18002b380(void)

{
  FUN_18001f474();
  return;
}



void FUN_18002b394(longlong *param_1,longlong param_2)

{
  FUN_18001e528(param_1,*(undefined8 *)(param_2 + 0x70),*(longlong **)(param_2 + 0x78),
                *(ULONG_PTR *)(param_2 + 0x80),*(DWORD64 **)(param_2 + 0x88),
                *(uint **)(param_2 + 0x90),(undefined4 *)(param_2 + 0x40));
  return;
}



void FUN_18002b3da(undefined8 param_1,longlong param_2)

{
  if ((*(longlong *)(param_2 + 0x40) == 0) && (DAT_180046340 != -1)) {
    FUN_18002131c();
  }
  return;
}



void FUN_18002b400(undefined8 *param_1,longlong param_2)

{
  undefined4 uVar1;
  
  *(undefined8 **)(param_2 + 0x40) = param_1;
  uVar1 = *(undefined4 *)*param_1;
  *(undefined4 *)(param_2 + 0x30) = uVar1;
  *(undefined8 **)(param_2 + 0x38) = param_1;
  *(undefined4 *)(param_2 + 0x28) = uVar1;
  if (*(int *)(param_2 + 0x78) == 1) {
    FUN_18001ea18(*(undefined8 *)(param_2 + 0x70),0,*(longlong *)(param_2 + 0x80));
  }
  FUN_180022b1c(*(int *)(param_2 + 0x28),*(undefined8 *)(param_2 + 0x38));
  return;
}



void FUN_18002b449(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x80) != 0) {
    FUN_1800241e8(8);
  }
  return;
}



void FUN_18002b46d(void)

{
  FUN_1800241e8(0xe);
  return;
}



void FUN_18002b486(void)

{
  FUN_1800241e8(0xd);
  return;
}



void FUN_18002b49f(void)

{
  FUN_1800241e8(0xc);
  return;
}



undefined4 FUN_18002b4b8(undefined8 param_1,longlong param_2)

{
  DWORD *pDVar1;
  
  *(undefined8 *)(param_2 + 0x70) = param_1;
  *(undefined8 *)(param_2 + 0x68) = param_1;
  *(undefined8 *)(param_2 + 0x28) = **(undefined8 **)(param_2 + 0x68);
  *(undefined4 *)(param_2 + 0x20) = 0;
  if ((((**(int **)(param_2 + 0x28) == -0x1f928c9d) &&
       (*(int *)(*(longlong *)(param_2 + 0x28) + 0x18) == 4)) &&
      ((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930520 ||
       ((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930521 ||
        (*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930522)))))) &&
     (*(longlong *)(*(longlong *)(param_2 + 0x28) + 0x28) ==
      *(longlong *)(*(longlong *)(param_2 + 0xd8) + 0x28))) {
    *(undefined4 *)(param_2 + 0x20) = 1;
  }
  if (((**(int **)(param_2 + 0x28) == -0x1f928c9d) &&
      (*(int *)(*(longlong *)(param_2 + 0x28) + 0x18) == 4)) &&
     (((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930520 ||
       ((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930521 ||
        (*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930522)))) &&
      (*(longlong *)(*(longlong *)(param_2 + 0x28) + 0x30) == 0)))) {
    pDVar1 = FUN_180021130();
    pDVar1[0x118] = 1;
    *(undefined4 *)(param_2 + 0x20) = 1;
    *(undefined4 *)(param_2 + 0x30) = 1;
  }
  else {
    *(undefined4 *)(param_2 + 0x30) = 0;
  }
  return *(undefined4 *)(param_2 + 0x30);
}



void FUN_18002b5ac(undefined8 param_1,longlong param_2)

{
  int *piVar1;
  int iVar2;
  DWORD *pDVar3;
  
  FUN_18001e664(*(longlong *)(param_2 + 0x38));
  if ((((*(int *)(param_2 + 0x20) == 0) &&
       (piVar1 = *(int **)(param_2 + 0xd8), *piVar1 == -0x1f928c9d)) && (piVar1[6] == 4)) &&
     (piVar1[8] + 0xe66cfae0U < 3)) {
    iVar2 = FUN_18001e6f4(*(longlong *)(piVar1 + 10));
    if (iVar2 != 0) {
      FUN_180021340(piVar1);
    }
  }
  pDVar3 = FUN_180021130();
  *(undefined8 *)(pDVar3 + 0x3c) = *(undefined8 *)(param_2 + 0xe0);
  pDVar3 = FUN_180021130();
  *(undefined8 *)(pDVar3 + 0x3e) = *(undefined8 *)(param_2 + 0x50);
  return;
}



bool FUN_18002b62a(undefined8 param_1,longlong param_2)

{
  return *(char *)(param_2 + 0x38) != '\0';
}



void FUN_18002b642(undefined8 *param_1)

{
  FUN_180022208(param_1);
  return;
}



void FUN_18002b658(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_180021130();
  if (0 < (int)pDVar1[0x40]) {
    pDVar1 = FUN_180021130();
    pDVar1[0x40] = pDVar1[0x40] - 1;
  }
  return;
}



void FUN_18002b681(void)

{
  FUN_1800241e8(0xb);
  return;
}



void FUN_18002b69c(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002b6b1. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection(DAT_180046450);
  return;
}



bool FUN_18002b6c0(undefined8 *param_1)

{
  return *(int *)*param_1 == -0x3ffffffb;
}



void FUN_18002b6e0(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x60) != 0) {
    FUN_1800241e8(0);
  }
  return;
}



void FUN_18002b6fe(void)

{
  FUN_1800241e8(0xd);
  return;
}



void FUN_18002b717(undefined8 param_1,longlong param_2)

{
  FUN_180027384(*(uint *)(param_2 + 0x50));
  return;
}



void FUN_18002b72e(void)

{
  FUN_1800241e8(0xc);
  return;
}



void FUN_18002b747(undefined8 param_1,longlong param_2)

{
  FUN_180025088(*(int *)(param_2 + 0x20),
                *(longlong *)(DAT_180049f48 + (longlong)*(int *)(param_2 + 0x20) * 8));
  return;
}



void FUN_18002b76f(void)

{
  FUN_1800241e8(1);
  return;
}



void FUN_18002b788(void)

{
  FUN_1800241e8(1);
  return;
}



void FUN_18002b7a1(void)

{
  FUN_1800241e8(10);
  return;
}



void FUN_18002b7ba(undefined8 param_1,longlong param_2)

{
  FUN_180027384(*(uint *)(param_2 + 0x40));
  return;
}



void FUN_18002b7d1(undefined8 param_1,longlong param_2)

{
  FUN_180025038(*(ulonglong *)(param_2 + 0x30));
  return;
}


